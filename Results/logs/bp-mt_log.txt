True False False False False
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.300-droplayer0.000.t7
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
No specific indices are determined, so try to include whatever we find
In total, we found 118 images of target 1
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', eval_poisons_root='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=False, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=1, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/1/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115]
# Targets: 20, # Poisons: 5
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-12 22:10:42 Iteration 0 	 Training Loss: 9.857e-01 	 Loss in Target Net: 2.367e+00	  
 2021-06-12 22:11:28 Iteration 50 	 Training Loss: 2.218e-01 	 Loss in Target Net: 5.687e-01	  
 2021-06-12 22:12:15 Iteration 100 	 Training Loss: 1.875e-01 	 Loss in Target Net: 5.564e-01	  
 2021-06-12 22:13:01 Iteration 150 	 Training Loss: 1.804e-01 	 Loss in Target Net: 5.163e-01	  
 2021-06-12 22:13:50 Iteration 200 	 Training Loss: 1.756e-01 	 Loss in Target Net: 5.561e-01	  
 2021-06-12 22:14:37 Iteration 250 	 Training Loss: 1.787e-01 	 Loss in Target Net: 5.440e-01	  
 2021-06-12 22:15:25 Iteration 300 	 Training Loss: 1.704e-01 	 Loss in Target Net: 5.564e-01	  
 2021-06-12 22:16:13 Iteration 350 	 Training Loss: 1.738e-01 	 Loss in Target Net: 5.384e-01	  
 2021-06-12 22:17:01 Iteration 400 	 Training Loss: 1.649e-01 	 Loss in Target Net: 5.706e-01	  
 2021-06-12 22:17:51 Iteration 450 	 Training Loss: 1.631e-01 	 Loss in Target Net: 5.932e-01	  
 2021-06-12 22:18:38 Iteration 500 	 Training Loss: 1.665e-01 	 Loss in Target Net: 5.648e-01	  
 2021-06-12 22:19:24 Iteration 550 	 Training Loss: 1.676e-01 	 Loss in Target Net: 6.154e-01	  
 2021-06-12 22:20:10 Iteration 600 	 Training Loss: 1.628e-01 	 Loss in Target Net: 6.245e-01	  
 2021-06-12 22:20:56 Iteration 650 	 Training Loss: 1.598e-01 	 Loss in Target Net: 5.917e-01	  
 2021-06-12 22:21:42 Iteration 700 	 Training Loss: 1.605e-01 	 Loss in Target Net: 5.816e-01	  
 2021-06-12 22:22:28 Iteration 750 	 Training Loss: 1.662e-01 	 Loss in Target Net: 5.946e-01	  
 2021-06-12 22:23:15 Iteration 800 	 Training Loss: 1.594e-01 	 Loss in Target Net: 5.668e-01	  
 2021-06-12 22:24:01 Iteration 850 	 Training Loss: 1.604e-01 	 Loss in Target Net: 6.038e-01	  
 2021-06-12 22:24:47 Iteration 900 	 Training Loss: 1.593e-01 	 Loss in Target Net: 5.685e-01	  
 2021-06-12 22:25:34 Iteration 950 	 Training Loss: 1.550e-01 	 Loss in Target Net: 6.079e-01	  
 2021-06-12 22:26:19 Iteration 999 	 Training Loss: 1.551e-01 	 Loss in Target Net: 6.154e-01	  
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 22:26:24, Val iteration 0, acc 94.200 (94.200)
2021-06-12 22:26:34, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-12 22:26:40, Epoch 0, Iteration 7, loss 0.166 (0.566), acc 94.231 (90.400)
2021-06-12 22:27:40, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[3.5944276, -0.22318436, -5.718527, -3.3952358, -1.9494537, -2.4697165, 6.4727664, -0.08571774, 1.2972147, 2.7706077]
Target sample: 7, Prediction:6, Target's Score:[2.275422, 5.9000196, -4.2258263, -3.8383012, -3.114076, -2.7513433, 8.144056, 0.5974016, -1.2678695, -1.345286]
Target sample: 13, Prediction:1, Target's Score:[-1.4046826, 15.3638525, -3.1715739, -3.0450778, -3.878061, -2.300799, 2.4916506, -2.4330516, -1.9427457, 0.77409035]
Target sample: 19, Prediction:1, Target's Score:[-1.1225042, 13.1506405, -3.0936043, -2.3908617, -3.6574194, -2.4848955, 3.744762, -1.9107921, -0.6523973, -1.1823944]
Target sample: 25, Prediction:1, Target's Score:[-1.1767309, 13.435276, -3.8099627, -2.5525656, -3.5522745, -2.8087783, 2.8103569, -2.083585, 0.84056205, -0.73484856]
Target sample: 31, Prediction:1, Target's Score:[-0.7620494, 16.401379, -3.6735106, -2.923233, -4.3177233, -3.077248, 2.8830934, -2.1089878, -0.89145154, -1.0923101]
Target sample: 37, Prediction:1, Target's Score:[2.106628, 13.372857, -3.4216633, -3.7317054, -3.9775274, -4.0869384, 5.5202208, -0.7088869, -1.0542879, -3.5923495]
Target sample: 43, Prediction:6, Target's Score:[3.6069472, 1.4242203, -5.5248756, -1.65622, -1.6926901, -3.471986, 6.902954, 2.2356358, 0.8721041, -2.4225802]
Target sample: 49, Prediction:6, Target's Score:[3.8105187, 1.8910997, -5.5515184, -2.2128942, -0.6585819, -3.467285, 7.435947, 0.3038059, 1.5866023, -2.8758454]
Target sample: 55, Prediction:6, Target's Score:[5.5507884, 0.43615144, -5.151863, -2.376617, -2.0595455, -3.8401225, 9.554776, 1.1420565, 0.6649355, -3.6213074]
Target sample: 61, Prediction:1, Target's Score:[3.6163251, 7.6018972, -2.4299555, -1.9254705, -2.780285, -2.8091526, 5.090835, -1.0084559, -1.9775605, -3.025651]
Target sample: 67, Prediction:1, Target's Score:[-0.66063035, 12.780851, -3.6050057, -3.4990318, -3.8943377, -2.9306135, 6.220887, -1.7162143, -1.5467002, -0.72277486]
Target sample: 73, Prediction:1, Target's Score:[0.38863796, 11.010767, -3.8812854, -3.2414362, -3.3912997, -3.1011364, 5.1641903, -1.2719156, 1.0379239, -2.362798]
Target sample: 79, Prediction:1, Target's Score:[-1.1994761, 14.18777, -3.6893613, -2.3221989, -3.5264292, -2.5470643, 2.1289937, -2.3619833, 0.52910024, -0.8215218]
Target sample: 85, Prediction:1, Target's Score:[-0.91943336, 13.42906, -3.1165779, -2.7875917, -3.96287, -2.4427397, 3.742098, -2.4054382, -1.2182436, 0.09931211]
Target sample: 91, Prediction:1, Target's Score:[-1.0491761, 9.214017, -3.6477966, -2.4808388, -2.9972732, -1.5422639, 3.961404, -1.2986794, -1.978435, 2.2112894]
Target sample: 97, Prediction:1, Target's Score:[3.4772317, 5.984223, -3.0773528, -3.1706467, -2.0015116, -0.97198397, 1.523233, -0.4970408, -2.2899263, 1.3925655]
Target sample: 103, Prediction:6, Target's Score:[2.2291336, 0.20508806, -4.5342436, -2.003229, -2.3078117, -1.7930316, 7.607643, 2.7080934, -0.5950064, -1.2530267]
Target sample: 109, Prediction:6, Target's Score:[1.2944939, 2.5383804, -5.834396, -3.0557578, -2.4349554, -2.5224648, 7.9528975, -1.0596534, 1.4878106, 1.9512303]
Target sample: 115, Prediction:6, Target's Score:[3.0359066, -0.6194888, -6.0027494, -3.4352975, -2.0693717, -2.0508842, 9.931248, -0.11524244, -0.16814294, 1.8359994]
Current ATTACK acc on target samples: 40.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 22:28:40 Epoch 59, Val iteration 0, acc 92.800 (92.800)
2021-06-12 22:28:50 Epoch 59, Val iteration 19, acc 93.000 (91.840)
* Prec: 91.84000129699707
Per class accuracy =  [0.92819083 0.95073336 0.83971818 0.87720539 0.91628784 0.87892882
 0.95671547 0.93159582 0.95168335 0.9498686 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 0, 0, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 0, 6, 6, 6, 6, 0, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 0, 9, 6, 6, 6, 6, 6, 6
ATTACK acc: 30.612244897959183
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 22:29:03, Val iteration 0, acc 94.800 (94.800)
2021-06-12 22:29:24, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-12 22:29:38, Epoch 0, Iteration 7, loss 0.358 (0.318), acc 92.308 (90.800)
2021-06-12 22:32:17, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[1.1944726, 0.4073521, -4.0041013, -1.8049179, -1.7080091, -2.284284, 10.504309, -2.35164, 1.2854253, -0.8244589]
Target sample: 7, Prediction:6, Target's Score:[0.27217817, 0.43153703, -3.5206327, -2.2167945, 0.39737654, -1.9225528, 9.3319645, -0.50399965, -0.65362304, -1.2807305]
Target sample: 13, Prediction:1, Target's Score:[-1.5253003, 9.123098, -4.132925, -2.0510383, -1.655732, -0.87923014, 4.1696014, -1.8361964, -0.12959132, -0.5837378]
Target sample: 19, Prediction:1, Target's Score:[-1.3552595, 7.5482917, -4.231214, -1.2106508, -2.5109096, -1.7490085, 5.8226037, -2.1295815, 1.3277403, -1.0203251]
Target sample: 25, Prediction:1, Target's Score:[-1.3364596, 7.680195, -4.2995024, -1.5047086, -2.2298746, -0.80931777, 5.9854517, -2.8272493, 0.6042023, -0.7772616]
Target sample: 31, Prediction:1, Target's Score:[0.84843445, 8.906967, -4.2227664, -0.91427207, -2.3367236, -0.89025676, 3.953019, -2.958546, -0.8590961, -0.98301154]
Target sample: 37, Prediction:1, Target's Score:[1.2257147, 9.262461, -3.5379894, -0.8932301, -2.329917, -1.6184813, 3.8619668, -2.6993625, -0.9818603, -1.7331024]
Target sample: 43, Prediction:6, Target's Score:[1.4757468, -1.8659524, -4.5756955, -0.9376935, 0.9099021, -3.0159574, 7.390792, 0.89843035, 2.172676, -2.0790403]
Target sample: 49, Prediction:6, Target's Score:[0.43322936, -0.48280638, -3.5555081, -1.3813906, -1.0523885, -2.0399184, 10.587854, -2.5225813, 1.7296828, -1.3301704]
Target sample: 55, Prediction:6, Target's Score:[1.8884, -1.2058222, -3.8999026, -1.894066, -0.103496686, -2.5461326, 10.33433, -1.1098633, 1.5427145, -2.60927]
Target sample: 61, Prediction:1, Target's Score:[-0.7797139, 6.7103605, -2.756242, -1.4221896, -1.3306273, -0.23500144, 4.3064914, -2.167102, -0.67023015, -1.2174094]
Target sample: 67, Prediction:1, Target's Score:[-0.9376627, 7.315608, -3.8512022, -1.8773229, -1.7086474, -0.76215005, 5.2506332, -2.3413754, -0.57139266, -0.058133714]
Target sample: 73, Prediction:6, Target's Score:[0.85652685, 0.7051606, -4.261933, -2.0047948, -0.5839157, -2.1158574, 7.360198, -0.14892562, 2.777861, -2.2011273]
Target sample: 79, Prediction:1, Target's Score:[-1.521017, 9.796345, -3.900571, -1.7322998, -2.0576916, -0.061109435, 3.4623377, -3.7273262, 0.856239, -0.5744783]
Target sample: 85, Prediction:1, Target's Score:[-0.22431543, 8.55987, -3.6276805, -1.7558837, -3.2901525, -0.28672442, 6.5506344, -3.8206995, -1.0508875, -0.513922]
Target sample: 91, Prediction:1, Target's Score:[-0.8084008, 9.235898, -3.5433867, -1.9475188, -1.8283231, -1.0432941, 4.0698204, -2.8264701, -0.52781445, -0.25783363]
Target sample: 97, Prediction:1, Target's Score:[-0.094974466, 8.217987, -4.4597697, -1.5103153, 0.15995014, -1.1118197, 0.3403661, -0.419394, -0.18109742, -0.4543568]
Target sample: 103, Prediction:6, Target's Score:[1.659269, -1.3447428, -4.210287, -2.0349445, -0.077846505, -2.0255046, 8.622352, 0.6096526, 1.1661136, -2.0063949]
Target sample: 109, Prediction:6, Target's Score:[1.184228, 1.6452775, -3.9130054, -2.0164182, -1.6269795, -2.2246492, 10.710785, -2.6954641, 1.4897667, -2.1272507]
Target sample: 115, Prediction:6, Target's Score:[0.44542575, -0.34405923, -4.000295, -2.1712663, -0.8536288, -1.7995167, 11.573685, -1.9226669, 1.7409495, -2.2685914]
Current ATTACK acc on target samples: 45.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 22:34:53 Epoch 59, Val iteration 0, acc 92.800 (92.800)
2021-06-12 22:35:14 Epoch 59, Val iteration 19, acc 92.600 (92.930)
* Prec: 92.93000068664551
Per class accuracy =  [0.95253924 0.97312193 0.91068125 0.83614675 0.93002603 0.89718596
 0.96383391 0.92848599 0.97694101 0.92523738]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 46.93877551020408
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 22:35:18, Val iteration 0, acc 92.600 (92.600)
2021-06-12 22:35:24, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-12 22:35:26, Epoch 0, Iteration 7, loss 0.480 (0.347), acc 82.692 (88.200)
2021-06-12 22:35:54, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:9, Target's Score:[-0.70875376, 2.126624, -3.191579, 4.72972, -1.0232918, -3.41476, 1.7839235, -3.5378225, -3.969743, 7.6027317]
Target sample: 7, Prediction:1, Target's Score:[-0.27458394, 7.7722516, -3.904957, -1.749683, -3.2248673, -3.117601, 1.8666726, 0.49057075, -2.8280895, 5.344271]
Target sample: 13, Prediction:1, Target's Score:[-3.0027483, 13.877305, -1.9984124, -2.853115, -2.7589953, -0.023278411, 0.25349835, -1.8186681, -1.7819732, 0.57815295]
Target sample: 19, Prediction:1, Target's Score:[-2.5099547, 13.70738, -3.5561686, -0.78830963, 0.656776, -2.2379596, -1.1880298, -1.5362433, -2.4828324, 0.44226578]
Target sample: 25, Prediction:1, Target's Score:[-1.4412558, 13.661433, -3.8789217, -1.5744572, -1.3812746, -1.2701579, -2.0531666, -2.6358628, -0.8291205, 1.8485544]
Target sample: 31, Prediction:1, Target's Score:[-2.752116, 13.569761, -4.7260528, -1.912404, -1.6434534, -1.2882, 1.6835556, -0.8629018, -2.0965335, 0.48855594]
Target sample: 37, Prediction:1, Target's Score:[-1.1177417, 13.217843, -4.0265956, -1.3864446, -3.5810583, -2.6207044, 3.7082129, -3.293682, -2.8919563, 2.4207098]
Target sample: 43, Prediction:6, Target's Score:[-1.3249574, 3.973365, -4.63067, 0.2724924, 1.6939814, -4.771377, 5.3255, -1.4742867, -1.57513, 2.928413]
Target sample: 49, Prediction:6, Target's Score:[-2.2798471, 6.6446476, -3.6088016, -0.26351357, -1.9846656, -2.8593373, 7.8309402, -3.9903188, -2.2770407, 3.2054052]
Target sample: 55, Prediction:1, Target's Score:[-0.33490896, 7.362605, -4.813574, -0.7692602, -1.2732416, -4.7602825, 6.5536838, -4.362822, 2.7119439, 0.11791163]
Target sample: 61, Prediction:1, Target's Score:[1.4731452, 10.5011425, -3.2638772, -0.8357692, -2.9566019, -2.5791407, 0.08516385, -1.4447325, -2.3933806, 1.7559096]
Target sample: 67, Prediction:1, Target's Score:[-1.8390539, 12.804769, -4.5095167, -0.6025215, -3.7052083, -1.4650441, 2.0617886, -4.0268354, -0.15887159, 1.861394]
Target sample: 73, Prediction:1, Target's Score:[-1.5796639, 10.542154, -4.687283, 0.5034552, -0.88112986, -2.6476672, 1.8474282, -3.6478903, 0.49902847, 0.45614412]
Target sample: 79, Prediction:1, Target's Score:[-1.0725596, 12.507935, -2.6806262, 0.45232415, -1.0871527, -2.5722826, -1.9435676, -2.6175425, -2.133326, 1.5866349]
Target sample: 85, Prediction:1, Target's Score:[-1.390457, 14.458098, -3.200288, -0.62208307, -4.931887, -1.2084745, 0.8814832, -4.4197483, -2.7307978, 3.6064687]
Target sample: 91, Prediction:1, Target's Score:[-1.7576112, 11.406113, -3.28425, -2.2227948, -3.053972, -1.6435404, 4.390896, -2.9487796, -1.7363725, 1.261654]
Target sample: 97, Prediction:1, Target's Score:[0.7186435, 7.6765685, -3.5969098, -2.101067, -1.5984204, -3.1711664, 1.4092875, 0.97207075, -3.1945148, 3.2130675]
Target sample: 103, Prediction:6, Target's Score:[0.47977963, 0.8740913, -1.9318869, -0.4680224, 2.0040915, -4.478524, 5.971042, -0.93701756, -4.450163, 3.283199]
Target sample: 109, Prediction:1, Target's Score:[-2.681467, 6.6214714, -5.850451, 1.9454108, -2.5919127, -3.6536558, 6.180957, -2.5147142, -2.355691, 5.348047]
Target sample: 115, Prediction:9, Target's Score:[-2.4843464, -1.2000436, -4.0408993, 0.78809243, 0.9078508, -5.1954756, 5.0067854, -0.859545, -1.0863172, 8.590341]
Current ATTACK acc on target samples: 15.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 22:36:21 Epoch 59, Val iteration 0, acc 90.000 (90.000)
2021-06-12 22:36:28 Epoch 59, Val iteration 19, acc 90.600 (89.510)
* Prec: 89.51000213623047
Per class accuracy =  [0.92332381 0.92727928 0.8409428  0.82863955 0.89226858 0.82286756
 0.94111423 0.88996857 0.93236043 0.9476465 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 9, 9, 9, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 6, 9, 6, 6, 9, 9, 9, 9, 9, 9, 9, 9
ATTACK acc: 18.367346938775512
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 22:36:35, Val iteration 0, acc 96.200 (96.200)
2021-06-12 22:36:48, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-12 22:36:55, Epoch 0, Iteration 7, loss 0.194 (0.557), acc 96.154 (85.200)
2021-06-12 22:38:06, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:0, Target's Score:[8.526716, -1.8557193, -2.730799, -3.1412215, -0.5072343, -4.5248923, 2.909667, -3.1885397, -0.4318815, 4.986812]
Target sample: 7, Prediction:1, Target's Score:[3.6725411, 5.178653, -2.9352877, -3.031987, -2.4704075, -4.051938, 4.588279, 1.0119675, -2.2101705, 0.28552502]
Target sample: 13, Prediction:1, Target's Score:[-2.005973, 10.35427, -2.4639862, -2.4712899, -1.6751682, -2.2067351, 0.99518067, -1.1796206, -2.9038076, 3.579583]
Target sample: 19, Prediction:1, Target's Score:[-2.1706154, 13.391605, -3.0120902, -2.366702, -2.871872, -4.2900624, 1.5983758, 0.2996552, -2.3891103, 1.8366269]
Target sample: 25, Prediction:1, Target's Score:[0.101309225, 11.407915, -2.8404176, -1.2451712, -2.585175, -3.9721513, -0.5135357, -2.4593244, -1.3842177, 3.5213356]
Target sample: 31, Prediction:1, Target's Score:[-1.5526675, 11.060519, -3.2279823, -0.99541354, -3.0776906, -3.4747488, -0.33378232, -2.7263436, -1.9096154, 6.2651587]
Target sample: 37, Prediction:1, Target's Score:[-0.5363402, 11.50185, -2.9382856, -1.8428098, -2.2839768, -3.9170394, 2.8872886, -1.2482679, -2.3692915, 0.7747915]
Target sample: 43, Prediction:6, Target's Score:[1.9535389, -1.3947052, -3.5655441, -0.8778495, -1.4907551, -3.856103, 7.62602, -0.20012654, 3.270002, -1.4381245]
Target sample: 49, Prediction:6, Target's Score:[1.0111254, 3.028006, -2.9129832, -1.4313346, 0.20081714, -4.3031945, 6.4205065, -2.8763504, -0.058077626, 0.9528687]
Target sample: 55, Prediction:6, Target's Score:[2.4763212, 1.0010446, -3.2707045, -0.78325844, -0.942588, -4.329387, 9.452513, -1.5091786, -0.33112213, -1.729918]
Target sample: 61, Prediction:1, Target's Score:[-0.01650871, 8.016443, -1.5690275, -2.185627, -1.0760663, -3.3632991, 2.4294398, -0.4292954, -2.118452, 0.33615288]
Target sample: 67, Prediction:1, Target's Score:[0.36690626, 7.86964, -1.5904318, -0.81787884, -1.8193231, -3.990566, 2.1235857, -1.9594727, -2.7508395, 2.5975456]
Target sample: 73, Prediction:1, Target's Score:[0.6074331, 9.77471, -3.8365843, -1.7126, -1.8293178, -3.734396, -0.0029374845, -1.8047913, -1.1666676, 3.7356255]
Target sample: 79, Prediction:1, Target's Score:[-1.8415067, 13.141786, -4.4640064, -1.5109353, -3.1831164, -2.719917, 0.3294682, -2.6566975, -1.7360877, 4.669754]
Target sample: 85, Prediction:1, Target's Score:[0.51453185, 10.191116, -2.5926013, -1.9017256, -1.860464, -2.2765994, -0.11109485, -3.017851, -2.821359, 3.9070194]
Target sample: 91, Prediction:1, Target's Score:[0.051542033, 9.137772, -3.4884498, -3.0826495, -1.1715035, -3.9335575, 2.1957002, -0.794537, -1.4256593, 2.5379422]
Target sample: 97, Prediction:1, Target's Score:[1.904275, 11.769728, -5.2652926, -3.927702, -1.8747325, -3.4599042, 2.0142167, 0.056341607, -1.4077388, 0.22503673]
Target sample: 103, Prediction:0, Target's Score:[6.3690495, -1.9369193, -2.3449404, -2.8374555, -3.0823522, 1.0786597, 3.8689947, 0.10530168, 0.7048845, -1.8905551]
Target sample: 109, Prediction:0, Target's Score:[6.056615, 1.0835997, -3.8122697, -3.2588706, -1.1261368, -4.8044434, 2.4905393, -2.7657614, 0.7380107, 5.437452]
Target sample: 115, Prediction:0, Target's Score:[6.5646977, -0.7404354, -4.1554255, -2.127255, -0.1710495, -5.441918, 3.2692883, -2.1726415, -0.27376398, 5.2897716]
Current ATTACK acc on target samples: 15.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 22:39:16 Epoch 59, Val iteration 0, acc 93.000 (93.000)
2021-06-12 22:39:28 Epoch 59, Val iteration 19, acc 94.200 (93.220)
* Prec: 93.22000083923339
Per class accuracy =  [0.96150381 0.94112091 0.89139235 0.8739047  0.95420403 0.89835148
 0.96746096 0.92311793 0.94413804 0.96574585]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 0, 0, 0, 0, 0, 0, 9, 0, 0, 0, 0, 0, 0
ATTACK acc: 16.3265306122449
--------
------SUMMARY PRE DEFENSE------
TIME ELAPSED (mins): 15
TARGET INDEX: 1
ResNet50 40.0 30.612244897959183 95.46000137329102 91.84000129699707
DPN92 45.0 46.93877551020408 95.50000267028808 92.93000068664551
MobileNetV2 15.0 18.367346938775512 91.22000160217286 89.51000213623047
GoogLeNet 15.0 16.3265306122449 95.41000213623047 93.22000083923339
DEFENSE EVALUATION
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
ResNet50
[74, 80, 84, 86, 89] 5
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 22:39:33, Val iteration 0, acc 94.200 (94.200)
2021-06-12 22:39:44, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-12 22:39:46, Epoch 0, Iteration 7, loss 0.426 (0.272), acc 86.538 (94.200)
2021-06-12 22:40:47, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:0, Target's Score:[4.220282, 0.9632933, -1.8280938, -0.9472059, -1.9733647, -2.9414072, 0.7168987, -0.9027261, -0.77628106, 3.6180186]
Target sample: 7, Prediction:1, Target's Score:[0.8076901, 7.724217, -1.9884665, -3.66165, -2.8782172, -1.2432263, -0.4042789, -0.16534801, -1.9152749, 3.9483166]
Target sample: 13, Prediction:1, Target's Score:[-2.320625, 15.247972, -1.491831, -4.9083457, -3.700546, -0.9346524, -2.1262877, -1.2699902, -3.2785676, 5.102803]
Target sample: 19, Prediction:1, Target's Score:[-1.8332363, 13.220206, -1.2172387, -4.4278817, -3.0240223, -1.0491372, -1.5239154, -0.9944434, -2.344357, 3.4673295]
Target sample: 25, Prediction:1, Target's Score:[-1.5267725, 12.946811, -2.0452929, -4.010111, -2.9252863, -1.0946473, -1.4385792, -1.3621507, -1.6290404, 3.3513515]
Target sample: 31, Prediction:1, Target's Score:[-2.3406584, 16.891125, -2.1888423, -4.968833, -3.7791798, -0.9821353, -2.2150433, -1.1770852, -2.6865554, 3.7765493]
Target sample: 37, Prediction:1, Target's Score:[0.35262468, 16.114153, -1.7746344, -5.068318, -3.8347409, -1.8933938, -1.5582213, -1.4400387, -2.6978974, 2.123259]
Target sample: 43, Prediction:0, Target's Score:[7.2873254, 2.857003, -1.9432682, -2.4312584, -0.42932594, -3.1442173, -0.31899697, -0.9062032, -0.6738497, -0.11904005]
Target sample: 49, Prediction:0, Target's Score:[7.4734607, 3.1040065, -2.256072, -2.520244, -0.85853976, -2.749911, 0.6541715, -1.1625361, -0.25945386, -1.2425156]
Target sample: 55, Prediction:0, Target's Score:[11.120493, 0.9858054, -1.5868059, -2.4939277, -1.0764158, -3.6249218, 0.91214424, -1.161179, -0.83722067, -2.0449002]
Target sample: 61, Prediction:1, Target's Score:[1.4408343, 9.992039, -1.2142484, -3.5223217, -2.9128842, -0.8445014, -0.41989958, -1.5219345, -2.6954327, 1.944546]
Target sample: 67, Prediction:1, Target's Score:[-1.8270705, 13.083598, -1.9803082, -4.3805285, -3.5508895, -0.47996464, -0.09672643, -1.5905366, -2.7193348, 3.8330307]
Target sample: 73, Prediction:1, Target's Score:[-0.73062533, 13.082011, -2.1204531, -4.3233924, -3.1218116, -0.6975136, -1.2378029, -1.2916713, -1.6673517, 2.3850486]
Target sample: 79, Prediction:1, Target's Score:[-2.001315, 10.8497305, -1.5862507, -3.542255, -2.711546, -0.6353322, -1.4326333, -1.2657818, -1.861165, 4.4310513]
Target sample: 85, Prediction:1, Target's Score:[-0.99991095, 12.7935915, -1.449091, -4.247381, -3.2165048, -0.9669165, -1.1741952, -1.5764964, -2.3160145, 3.4246671]
Target sample: 91, Prediction:1, Target's Score:[-1.7276248, 9.199258, -0.98888695, -3.52509, -3.3121185, -0.51987094, -0.68267673, -1.1524892, -3.1920478, 6.148989]
Target sample: 97, Prediction:1, Target's Score:[2.020655, 9.830336, -1.4318253, -3.9969969, -2.7460773, -0.5568919, -1.7482059, -1.4003241, -2.8909328, 3.1817698]
Target sample: 103, Prediction:1, Target's Score:[0.9634041, 5.213262, -1.8304697, -3.2101502, -2.4925017, 0.82090753, 1.1062473, 0.3536198, -2.10943, 1.3827657]
Target sample: 109, Prediction:1, Target's Score:[1.1963553, 5.958584, -2.4225657, -2.3822498, -2.1029274, -2.5806675, 0.44072413, -1.4425057, 0.22929469, 3.2804747]
Target sample: 115, Prediction:0, Target's Score:[4.077306, 0.10707094, -1.9548808, -1.6714814, -1.7011106, -3.3427653, 1.9104483, -0.7331707, -0.037434835, 3.497502]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 22:41:46 Epoch 59, Val iteration 0, acc 92.400 (92.400)
2021-06-12 22:41:57 Epoch 59, Val iteration 19, acc 93.800 (91.690)
* Prec: 91.69000091552735
Per class accuracy =  [0.95202342 0.96594808 0.89602511 0.79039569 0.93133042 0.84393668
 0.95848796 0.95619604 0.92420562 0.95251123]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 0, 0, 9, 0, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 9, 0, 9, 9, 9, 9, 0, 0, 9
ATTACK acc: 0.0
DPN92
[74, 80, 84, 86, 89] 27
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 22:42:01, Val iteration 0, acc 94.800 (94.800)
2021-06-12 22:42:22, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-12 22:42:27, Epoch 0, Iteration 7, loss 0.304 (0.350), acc 90.385 (91.800)
2021-06-12 22:45:07, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:9, Target's Score:[5.695198, 2.6764886, -4.735138, -2.4794464, -2.619544, -3.2446887, -2.02739, -1.4651453, 1.9201217, 6.8711915]
Target sample: 7, Prediction:0, Target's Score:[5.5794654, 4.3142934, -3.7570555, -3.802732, -1.9482032, -2.6723018, 0.03790404, -0.27063662, 0.5005745, 2.5662458]
Target sample: 13, Prediction:1, Target's Score:[0.15295073, 14.091732, -3.793125, -1.924334, -2.6630633, -1.8089519, -1.3056208, -2.1961145, -0.8601395, 0.9457438]
Target sample: 19, Prediction:1, Target's Score:[-0.3440561, 13.989249, -3.402476, -0.7435895, -2.8733673, -1.6234113, -1.8523177, -2.905271, -0.74113065, 1.1650047]
Target sample: 25, Prediction:1, Target's Score:[0.372484, 13.8777685, -3.8667438, -1.6845093, -2.5189729, -1.5806867, -1.4204538, -3.0486398, -0.1314463, 0.6412189]
Target sample: 31, Prediction:1, Target's Score:[0.9447244, 14.196789, -4.105628, -1.8126262, -2.642224, -1.6638104, -1.7490108, -2.865441, -1.2029811, 1.5616654]
Target sample: 37, Prediction:1, Target's Score:[2.2705123, 13.275778, -4.005071, -2.1754372, -2.8516603, -2.02248, -1.4526968, -2.5573118, -1.5732569, 1.7348466]
Target sample: 43, Prediction:0, Target's Score:[5.2630825, 1.6956273, -4.7932463, -2.473573, -1.4100152, -2.9974108, -1.6480355, -0.42530933, 3.416504, 3.8890986]
Target sample: 49, Prediction:1, Target's Score:[0.511048, 7.354823, -4.9884486, -1.3595325, -2.2762282, -3.1625926, 0.11471023, -3.2673743, 2.506311, 5.1653223]
Target sample: 55, Prediction:0, Target's Score:[7.5156775, 2.0648875, -3.5961387, -3.9982998, -2.1961565, -3.7256455, -0.16761252, -1.3451527, 4.3360076, 1.69971]
Target sample: 61, Prediction:1, Target's Score:[1.4975955, 9.8405285, -3.1966715, -2.1281335, -1.2044675, -1.3227222, -0.5799638, -2.208125, -1.3826082, 1.2107762]
Target sample: 67, Prediction:1, Target's Score:[1.019341, 12.659526, -4.096825, -1.4391621, -2.605538, -1.7164944, -1.8691369, -2.9636254, -1.761364, 3.419536]
Target sample: 73, Prediction:1, Target's Score:[0.6193082, 12.356777, -4.07786, -1.7281553, -2.0297184, -1.831843, -1.4318302, -2.633919, 0.7561532, 0.60735005]
Target sample: 79, Prediction:1, Target's Score:[-0.09098969, 13.7778635, -3.6008022, -1.4305503, -2.4290953, -1.3673389, -1.4871327, -3.4091856, -0.55434126, 1.2412872]
Target sample: 85, Prediction:1, Target's Score:[0.17046694, 13.928628, -3.1436229, -1.0750092, -3.118535, -1.1584142, -1.7261457, -3.3182623, -1.148319, 1.2573119]
Target sample: 91, Prediction:1, Target's Score:[0.30008852, 13.710681, -3.4185328, -2.0183284, -2.4305685, -1.9310548, -1.2351762, -3.0507164, -0.98217136, 1.6983536]
Target sample: 97, Prediction:1, Target's Score:[1.580523, 10.484347, -4.027573, -2.7319074, -1.5146163, -1.8742355, -1.7798094, -0.8569138, 0.023658365, 1.2528316]
Target sample: 103, Prediction:0, Target's Score:[5.347033, -0.36723566, -4.349468, -4.1194196, -1.0593232, -2.843154, -0.40205577, 1.7182093, 3.1530468, 3.4210033]
Target sample: 109, Prediction:1, Target's Score:[3.650029, 5.934302, -4.861293, -2.8752396, -2.8358061, -3.16395, -0.9219893, -2.0260227, 2.8750489, 4.8183312]
Target sample: 115, Prediction:9, Target's Score:[4.728005, 2.4614987, -4.324942, -3.1380198, -2.3571727, -3.0518568, -0.7995144, -1.0811034, 2.239967, 5.889509]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 22:47:42 Epoch 59, Val iteration 0, acc 93.200 (93.200)
2021-06-12 22:48:03 Epoch 59, Val iteration 19, acc 93.200 (93.150)
* Prec: 93.15000267028809
Per class accuracy =  [0.9327877  0.96304438 0.91155144 0.84080313 0.95871289 0.86927061
 0.95194978 0.95915785 0.97036201 0.95797183]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 0, 9, 9, 0, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 8, 1, 1, 1, 1, 9, 8, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 8, 8, 0, 9, 9, 9, 9, 0, 9, 9, 8
ATTACK acc: 0.0
MobileNetV2
[74, 80, 84, 86, 89] 49
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 22:48:07, Val iteration 0, acc 92.600 (92.600)
2021-06-12 22:48:13, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-12 22:48:13, Epoch 0, Iteration 7, loss 0.264 (0.291), acc 90.385 (90.400)
2021-06-12 22:48:41, Epoch 30, Iteration 7, loss 0.000 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:9, Target's Score:[0.09899295, 4.2425017, -3.9045286, 3.5826054, -1.5388716, -3.127445, -2.364673, -2.8707895, -3.0482862, 9.61036]
Target sample: 7, Prediction:1, Target's Score:[1.296754, 10.314674, -4.114012, -2.4147635, -3.796745, -3.3207743, -3.2156882, 0.5517022, -2.3379605, 7.6513305]
Target sample: 13, Prediction:1, Target's Score:[-2.1653454, 17.221016, -2.5432758, -3.6915772, -3.3187296, -0.0037790388, -4.4403696, -0.76556903, -1.8015084, 2.268101]
Target sample: 19, Prediction:1, Target's Score:[-0.7732915, 16.169125, -3.604897, -1.5499051, -0.78500295, -1.923578, -5.7391624, -1.06289, -2.7024262, 2.7814894]
Target sample: 25, Prediction:1, Target's Score:[-0.18318656, 16.484142, -3.5236738, -2.6456263, -2.6484125, -1.0176688, -6.0031977, -2.022861, -1.3803295, 3.6841047]
Target sample: 31, Prediction:1, Target's Score:[-1.6361462, 16.896854, -4.9040036, -2.8927512, -2.5820289, -0.8968999, -4.0011463, 0.039773367, -1.8704408, 2.5712783]
Target sample: 37, Prediction:1, Target's Score:[0.17699978, 17.23087, -4.453052, -2.546107, -4.234575, -2.5414531, -2.5185606, -2.6086917, -2.2126548, 4.422877]
Target sample: 43, Prediction:1, Target's Score:[0.5350257, 6.290711, -5.0823903, -0.6323452, 0.40008238, -4.9861627, -0.19399796, -1.1575785, -0.26215973, 5.751442]
Target sample: 49, Prediction:1, Target's Score:[-0.617327, 10.616642, -4.442367, -1.3316222, -3.033479, -3.38939, 1.9202455, -3.0125883, -1.7395972, 5.7054987]
Target sample: 55, Prediction:1, Target's Score:[1.4313219, 10.675685, -5.3035407, -1.6559361, -3.054243, -4.9348283, 1.1426095, -4.154575, 3.6299827, 2.8429534]
Target sample: 61, Prediction:1, Target's Score:[2.53432, 12.771589, -3.4402773, -1.6095138, -3.4339812, -2.7816877, -3.838278, -1.4680897, -1.6874026, 3.5293853]
Target sample: 67, Prediction:1, Target's Score:[-0.5224738, 15.372423, -4.385858, -1.4957588, -4.696581, -1.379291, -2.4440532, -3.4668105, -0.35858074, 4.0030437]
Target sample: 73, Prediction:1, Target's Score:[0.10227173, 12.053787, -4.769629, -0.26114902, -1.3488243, -2.1522365, -3.301613, -2.707433, 0.42927366, 2.5625968]
Target sample: 79, Prediction:1, Target's Score:[0.37426078, 13.431275, -2.199754, -0.61108387, -1.1554425, -1.8287686, -5.9878054, -1.6238521, -2.701443, 3.030458]
Target sample: 85, Prediction:1, Target's Score:[-0.0096388385, 16.344904, -3.0870702, -1.291699, -5.1170974, -0.7587763, -4.827122, -3.2355323, -3.1017213, 5.8159957]
Target sample: 91, Prediction:1, Target's Score:[-0.91807455, 15.153158, -3.7046545, -2.9549747, -4.278325, -1.8448129, -1.1793026, -2.2179818, -1.1144259, 3.7112424]
Target sample: 97, Prediction:1, Target's Score:[2.0013974, 10.502277, -3.6164885, -3.0798852, -1.7320089, -3.612129, -2.921545, 0.5101197, -2.7153296, 5.26607]
Target sample: 103, Prediction:9, Target's Score:[1.9378687, 4.2805223, -1.9270725, -1.7420247, -0.009952132, -4.3374004, 1.1478702, -1.1197169, -3.8562987, 6.2522993]
Target sample: 109, Prediction:1, Target's Score:[-1.1021087, 9.051184, -6.3662887, 1.5191785, -3.3023245, -3.9620643, -0.13079189, -1.4696308, -2.5456612, 9.031824]
Target sample: 115, Prediction:9, Target's Score:[-1.0388349, 0.47998047, -3.2948804, -0.3167206, 0.6595109, -5.4629703, 0.47530773, -0.6650898, -0.30515352, 10.129506]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 22:49:09 Epoch 59, Val iteration 0, acc 89.000 (89.000)
2021-06-12 22:49:15 Epoch 59, Val iteration 19, acc 90.400 (89.590)
* Prec: 89.59000091552734
Per class accuracy =  [0.92035037 0.93646845 0.84462266 0.82671407 0.89247738 0.82530265
 0.93275564 0.89180652 0.93494451 0.94977143]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 9, 9, 9, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9
ATTACK acc: 0.0
GoogLeNet
[74, 80, 84, 86, 89] 22
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 22:49:18, Val iteration 0, acc 96.200 (96.200)
2021-06-12 22:49:31, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-12 22:49:33, Epoch 0, Iteration 7, loss 0.452 (0.539), acc 88.462 (85.600)
2021-06-12 22:50:44, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:9, Target's Score:[7.1986217, -1.0837134, -3.321067, -3.3533013, -0.5133434, -3.8571458, -3.038023, -2.5546036, 2.357006, 8.249941]
Target sample: 7, Prediction:1, Target's Score:[2.5146127, 7.5062714, -3.297929, -2.6543326, -2.2369437, -2.4863036, -0.05186808, 0.13000104, -0.9391282, 1.5767164]
Target sample: 13, Prediction:1, Target's Score:[-2.0099595, 15.647782, -3.4664059, -3.315508, -1.2127883, -3.159018, -2.6270096, -1.8549042, -1.7116027, 3.818679]
Target sample: 19, Prediction:1, Target's Score:[-2.0441256, 17.84443, -3.8610904, -2.7387908, -1.7448356, -4.135637, -2.5484931, -1.9426613, -1.2371496, 2.5173311]
Target sample: 25, Prediction:1, Target's Score:[-0.79091024, 16.516699, -3.8166916, -2.058585, -2.402714, -3.5149932, -2.6334696, -2.9298244, -0.537195, 2.271081]
Target sample: 31, Prediction:1, Target's Score:[-1.3650814, 15.35367, -3.553779, -1.6751522, -2.8844724, -3.2358456, -2.8089073, -2.782062, -1.1223958, 4.1854973]
Target sample: 37, Prediction:1, Target's Score:[-0.85826355, 14.969382, -3.2235718, -2.0667348, -2.607368, -3.3809445, -0.96657914, -1.7638838, -1.5113881, 1.4996328]
Target sample: 43, Prediction:8, Target's Score:[1.8207995, 1.4021157, -3.5658529, -1.9196758, -0.9204948, -3.3303978, 1.0960443, -0.71417296, 5.763167, 0.38746887]
Target sample: 49, Prediction:1, Target's Score:[-0.57705015, 9.039936, -3.9809332, -2.119121, -0.7700982, -3.5914912, -0.23878862, -1.9813321, 2.584147, 1.6965272]
Target sample: 55, Prediction:0, Target's Score:[2.6880372, 2.3853836, -3.6077044, -0.46020687, 0.6441942, -3.7828314, 1.850356, -1.666187, 2.3811367, -0.40709767]
Target sample: 61, Prediction:1, Target's Score:[-0.25020403, 11.157748, -2.218867, -2.077006, -1.2883924, -2.4859324, -0.5663408, -1.8087604, -1.3218206, 0.92911226]
Target sample: 67, Prediction:1, Target's Score:[-1.0563458, 13.547437, -3.287839, -2.140548, -1.9217646, -2.8041842, -1.8142236, -2.3905473, -1.1807921, 3.1424463]
Target sample: 73, Prediction:1, Target's Score:[-0.3590409, 13.027502, -3.9308708, -2.5087848, -1.904495, -3.3298144, -2.8575933, -2.3003664, 0.1469371, 4.1152573]
Target sample: 79, Prediction:1, Target's Score:[-2.1202285, 15.210267, -4.2384367, -2.3242538, -2.662877, -2.6577425, -2.518697, -2.4268289, -0.7706731, 4.621505]
Target sample: 85, Prediction:1, Target's Score:[-0.5697675, 13.877511, -3.7316997, -2.507844, -1.7767531, -1.6162082, -2.5025628, -3.0333676, -1.9319959, 3.8992586]
Target sample: 91, Prediction:1, Target's Score:[0.95766413, 11.493078, -3.6690416, -2.6617608, -0.27745718, -3.8180768, -2.066278, -1.3821725, -0.78654, 2.2887437]
Target sample: 97, Prediction:1, Target's Score:[0.9495181, 14.621472, -4.7584596, -3.4585664, -1.3431991, -3.584133, -2.139266, -1.0078785, -0.31215718, 1.1191924]
Target sample: 103, Prediction:0, Target's Score:[5.0079637, -0.23089164, -3.0405884, -2.5344248, -2.564799, 3.1552415, -1.3378444, -0.5574051, 2.175249, -0.050528966]
Target sample: 109, Prediction:9, Target's Score:[4.710216, 4.010764, -3.702477, -2.743175, -1.3974904, -3.9649837, -2.9066336, -2.6550877, 3.232264, 5.4927874]
Target sample: 115, Prediction:9, Target's Score:[4.16696, 2.1302903, -3.9327002, -2.2735212, -0.5085363, -4.486093, -2.2412927, -1.3186436, 2.0502002, 6.493142]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 22:51:54 Epoch 59, Val iteration 0, acc 93.400 (93.400)
2021-06-12 22:52:07 Epoch 59, Val iteration 19, acc 94.200 (93.150)
* Prec: 93.1500030517578
Per class accuracy =  [0.95545786 0.94478475 0.87855969 0.85610149 0.95568674 0.90784592
 0.9604001  0.93384676 0.96420737 0.95816787]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 0, 0, 0, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 1, 1, 1, 1, 9, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 8, 8, 0, 9, 9, 9, 9, 0, 9, 0, 0
ATTACK acc: 1.0204081632653061
------SUMMARY POST DEFENSE------
TIME ELAPSED (mins): 15
TARGET INDEX: 1
ResNet50 0.0 0.0 95.46000137329102 91.69000091552735 100.0
DPN92 0.0 0.0 95.50000267028808 93.15000267028809 100.0
MobileNetV2 0.0 0.0 91.22000160217286 89.59000091552734 100.0
GoogLeNet 0.0 1.0204081632653061 95.41000213623047 93.1500030517578 100.0
True False False False False
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.300-droplayer0.000.t7
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
No specific indices are determined, so try to include whatever we find
In total, we found 84 images of target 5
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', eval_poisons_root='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=False, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=5, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/5/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79]
# Targets: 14, # Poisons: 5
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-12 22:52:23 Iteration 0 	 Training Loss: 9.905e-01 	 Loss in Target Net: 2.423e+00	  
 2021-06-12 22:53:14 Iteration 50 	 Training Loss: 2.342e-01 	 Loss in Target Net: 3.731e-01	  
 2021-06-12 22:54:05 Iteration 100 	 Training Loss: 2.032e-01 	 Loss in Target Net: 3.731e-01	  
 2021-06-12 22:54:56 Iteration 150 	 Training Loss: 1.983e-01 	 Loss in Target Net: 4.145e-01	  
 2021-06-12 22:55:46 Iteration 200 	 Training Loss: 1.862e-01 	 Loss in Target Net: 3.977e-01	  
 2021-06-12 22:56:36 Iteration 250 	 Training Loss: 1.935e-01 	 Loss in Target Net: 3.851e-01	  
 2021-06-12 22:57:26 Iteration 300 	 Training Loss: 1.877e-01 	 Loss in Target Net: 3.251e-01	  
 2021-06-12 22:58:18 Iteration 350 	 Training Loss: 1.789e-01 	 Loss in Target Net: 2.890e-01	  
 2021-06-12 22:59:10 Iteration 400 	 Training Loss: 1.788e-01 	 Loss in Target Net: 2.729e-01	  
 2021-06-12 23:00:03 Iteration 450 	 Training Loss: 1.815e-01 	 Loss in Target Net: 2.773e-01	  
 2021-06-12 23:00:55 Iteration 500 	 Training Loss: 1.813e-01 	 Loss in Target Net: 2.553e-01	  
 2021-06-12 23:01:46 Iteration 550 	 Training Loss: 1.773e-01 	 Loss in Target Net: 2.871e-01	  
 2021-06-12 23:02:39 Iteration 600 	 Training Loss: 1.775e-01 	 Loss in Target Net: 2.564e-01	  
 2021-06-12 23:03:31 Iteration 650 	 Training Loss: 1.691e-01 	 Loss in Target Net: 2.594e-01	  
 2021-06-12 23:04:23 Iteration 700 	 Training Loss: 1.736e-01 	 Loss in Target Net: 2.222e-01	  
 2021-06-12 23:05:14 Iteration 750 	 Training Loss: 1.695e-01 	 Loss in Target Net: 2.106e-01	  
 2021-06-12 23:06:05 Iteration 800 	 Training Loss: 1.781e-01 	 Loss in Target Net: 1.830e-01	  
 2021-06-12 23:06:57 Iteration 850 	 Training Loss: 1.732e-01 	 Loss in Target Net: 2.175e-01	  
 2021-06-12 23:07:49 Iteration 900 	 Training Loss: 1.744e-01 	 Loss in Target Net: 1.687e-01	  
 2021-06-12 23:08:42 Iteration 950 	 Training Loss: 1.753e-01 	 Loss in Target Net: 2.136e-01	  
 2021-06-12 23:09:35 Iteration 999 	 Training Loss: 1.758e-01 	 Loss in Target Net: 1.840e-01	  
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 23:09:40, Val iteration 0, acc 94.200 (94.200)
2021-06-12 23:09:51, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-12 23:09:56, Epoch 0, Iteration 7, loss 0.130 (0.183), acc 96.154 (94.800)
2021-06-12 23:10:58, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-2.153829, 5.8357806, -2.6984649, 0.7783695, -2.6387026, -1.8515855, 2.7106714, -2.7160382, 0.61070347, 2.1689782]
Target sample: 7, Prediction:0, Target's Score:[3.6797855, 0.4536519, -1.3594345, -0.48569113, -1.7598783, -2.4147017, 0.5068274, -1.8329114, 1.1262611, 2.1585417]
Target sample: 13, Prediction:1, Target's Score:[-1.6875683, 8.412743, -2.4297495, -0.80001163, -2.9194531, -1.7920728, 1.453276, -2.3286757, -1.6262058, 3.7677083]
Target sample: 19, Prediction:1, Target's Score:[-1.6337594, 8.630641, -3.6071334, -0.2348085, -3.369821, -2.587599, 3.4629314, -3.014053, 1.747927, 0.6611589]
Target sample: 25, Prediction:6, Target's Score:[-2.1573794, 3.552778, -2.5707438, 1.3488039, -3.0041504, -2.1868613, 4.0312247, -2.6480422, 1.6439177, 2.047093]
Target sample: 31, Prediction:1, Target's Score:[-2.2164896, 11.98118, -3.1791046, -0.934854, -3.397057, -2.1940038, 2.3679593, -2.5463598, -0.08531404, 0.25776905]
Target sample: 37, Prediction:1, Target's Score:[-1.615381, 10.986616, -2.81921, -1.2133799, -3.3806164, -2.435654, 2.683513, -2.242634, 0.98986137, -0.894774]
Target sample: 43, Prediction:8, Target's Score:[-0.7504696, 5.66837, -1.7342542, -1.6623458, -3.170564, -3.0035505, 2.01855, -1.8673596, 6.393878, -1.811379]
Target sample: 49, Prediction:1, Target's Score:[-0.17399316, 6.678773, -2.1000357, -1.7683706, -3.1252785, -2.3852549, 0.85376215, -2.5289168, 4.3776026, 0.24733265]
Target sample: 55, Prediction:1, Target's Score:[-2.223981, 11.6709175, -3.2897735, -1.1877823, -3.2154405, -2.078142, 1.9219683, -2.6997948, -0.5385487, 1.6922996]
Target sample: 61, Prediction:1, Target's Score:[-1.0795823, 10.3321905, -3.0313659, -1.6559224, -2.8299239, -2.4933767, 1.6118046, -2.507579, 0.22693613, 1.481933]
Target sample: 67, Prediction:1, Target's Score:[-2.0215213, 10.734271, -3.1200864, -0.16298296, -3.2280943, -2.354122, 3.139967, -2.8888402, 0.0737211, -0.12211958]
Target sample: 73, Prediction:1, Target's Score:[-1.9435405, 10.62163, -3.3118227, 0.064829245, -3.4837048, -2.3586206, 2.7502565, -3.0492003, 0.55692446, 0.20356427]
Target sample: 79, Prediction:1, Target's Score:[-2.1464605, 7.70509, -2.8156996, 1.0554935, -2.9754088, -1.9233447, 2.999592, -2.9262044, 0.9333383, 0.13991743]
Current ATTACK acc on target samples: 7.143
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 23:12:00 Epoch 59, Val iteration 0, acc 87.800 (87.800)
2021-06-12 23:12:10 Epoch 59, Val iteration 19, acc 91.400 (90.120)
* Prec: 90.12000160217285
Per class accuracy =  [0.92258014 0.93648702 0.81871861 0.7680673  0.88430119 0.88378963
 0.95362248 0.93077982 0.96038977 0.95527078]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 3, 9, 8, 9, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 6, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 6, 6, 6
ATTACK acc: 10.0
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 23:12:22, Val iteration 0, acc 94.800 (94.800)
2021-06-12 23:12:44, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-12 23:12:58, Epoch 0, Iteration 7, loss 0.897 (0.467), acc 86.538 (89.800)
2021-06-12 23:15:43, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-0.8291804, 11.658802, -3.050847, -2.3959408, -4.095994, -2.5261486, 1.1302284, -2.5506208, 2.466849, 0.55088866]
Target sample: 7, Prediction:9, Target's Score:[1.2915125, 2.2304988, -3.5775495, -2.4742203, -3.6706545, -3.9683623, 1.470553, -1.4697795, 3.5376425, 6.9687443]
Target sample: 13, Prediction:9, Target's Score:[-0.9362609, 3.798367, -1.3626753, -1.4632504, -2.5509307, -1.325716, 2.9231017, -2.3045797, -1.8825582, 5.3711443]
Target sample: 19, Prediction:6, Target's Score:[-1.2904252, 4.1625404, -4.547116, -2.915221, -3.098216, -1.034631, 5.751453, -2.3399181, 3.9469388, 1.6586137]
Target sample: 25, Prediction:6, Target's Score:[-0.33628458, 1.1823086, -3.4100025, -1.5558637, -3.3277035, -2.1886609, 5.961726, -1.6820077, 4.535683, 1.10049]
Target sample: 31, Prediction:1, Target's Score:[-0.78052944, 8.856329, -1.8569208, -2.6143594, -3.5632467, -0.99259514, 2.9848018, -2.2286398, -1.0920746, 1.5823803]
Target sample: 37, Prediction:1, Target's Score:[-0.24805127, 8.691545, -3.2819324, -2.5146637, -3.500192, -2.286715, 1.9386746, -2.2204018, 1.0262488, 2.7255814]
Target sample: 43, Prediction:1, Target's Score:[-0.8737046, 9.448931, -3.086764, -3.3431566, -3.270541, -2.436099, 3.804207, -1.7869762, 2.3107681, -0.45548424]
Target sample: 49, Prediction:1, Target's Score:[-0.72501993, 6.9749546, -3.6301963, -3.131658, -3.328922, -1.9253693, 3.0712342, -1.7664398, 4.5375776, 0.23904675]
Target sample: 55, Prediction:9, Target's Score:[-0.50120044, 5.7564197, -2.7341406, -2.600842, -2.9171557, -0.47233358, 1.6864156, -3.0786521, -1.637927, 6.8148513]
Target sample: 61, Prediction:1, Target's Score:[0.76159483, 5.8570876, -3.771846, -1.9130211, -3.2968736, -2.3996167, 3.2814872, -1.1455773, 2.8584175, 0.062869474]
Target sample: 67, Prediction:1, Target's Score:[-0.44799528, 7.0457788, -3.243769, -2.5470464, -3.6047885, -2.1102653, 4.0615444, -2.608783, -0.19144668, 3.9518383]
Target sample: 73, Prediction:1, Target's Score:[-0.25043824, 10.2832985, -3.7920492, -3.5626292, -3.7432735, -2.1455529, 2.47493, -2.5618918, 2.161725, 1.4862994]
Target sample: 79, Prediction:1, Target's Score:[-0.81865126, 11.773906, -3.2478836, -2.6256056, -3.976144, -2.1861753, 1.6330312, -2.3559973, 1.643294, 0.51537156]
Current ATTACK acc on target samples: 14.286
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 23:18:19 Epoch 59, Val iteration 0, acc 92.600 (92.600)
2021-06-12 23:18:41 Epoch 59, Val iteration 19, acc 93.600 (93.410)
* Prec: 93.41000099182129
Per class accuracy =  [0.9408675  0.94653956 0.9259965  0.83810134 0.94471893 0.91545431
 0.96403953 0.94122967 0.96629588 0.96145964]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 8, 9, 9, 1, 1, 1, 9, 6, 6, 9, 6, 6, 6, 6, 8, 8, 6, 6, 6, 8, 9, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 8, 1, 1, 1, 1, 9, 9, 9, 9, 9, 9, 8, 9, 9, 6, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8
ATTACK acc: 14.285714285714286
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 23:18:45, Val iteration 0, acc 92.600 (92.600)
2021-06-12 23:18:51, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-12 23:18:53, Epoch 0, Iteration 7, loss 0.253 (0.358), acc 90.385 (89.200)
2021-06-12 23:19:21, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.935392, 7.618848, -2.5731764, 1.3132935, -3.3770835, -2.6947744, 0.8651358, -4.009, 2.161958, 3.1053197]
Target sample: 7, Prediction:3, Target's Score:[-2.10806, 2.0904841, -1.7897009, 3.3639479, -1.6228718, -3.5519025, -0.33120346, 1.24105, -0.15959033, 3.3125143]
Target sample: 13, Prediction:1, Target's Score:[-1.8570746, 8.094589, -2.6210012, 0.24392658, -3.9787931, -3.4380403, 2.3431787, -0.74244016, -0.73393327, 3.1544175]
Target sample: 19, Prediction:1, Target's Score:[-3.0875814, 9.49883, -4.5287366, 0.5545021, -7.2222505, -1.5160952, 5.7926455, -5.097984, 4.770063, 1.3611419]
Target sample: 25, Prediction:6, Target's Score:[-1.9723352, 5.519501, -3.203355, -0.16887331, -5.2417097, -1.448966, 5.871107, -4.260661, 2.2248552, 3.1244605]
Target sample: 31, Prediction:1, Target's Score:[-0.73141205, 15.164919, -2.070691, -2.307319, -4.5395274, -2.5688725, 1.8291488, -4.467344, -3.112708, 3.4049027]
Target sample: 37, Prediction:1, Target's Score:[-1.0355798, 12.113843, -0.87668437, -0.5230477, -6.3177505, 0.02378038, -4.4104896, -0.22104718, -0.16186063, 1.9699389]
Target sample: 43, Prediction:1, Target's Score:[-1.4889342, 5.780662, -1.0288728, -0.010478556, -5.1094112, -1.7527176, 0.751833, -3.4111629, 4.5847445, 2.1482978]
Target sample: 49, Prediction:1, Target's Score:[-2.2055187, 5.9036136, -2.235355, 1.6076097, -5.942172, 1.7408693, -0.9163051, -5.5054126, 4.198097, 3.8696902]
Target sample: 55, Prediction:1, Target's Score:[-2.0144396, 11.957759, -4.232956, -1.1874466, -6.887454, -0.19575506, 2.4064946, -3.924864, -1.6814338, 6.3137918]
Target sample: 61, Prediction:1, Target's Score:[1.4610678, 7.9077716, -1.4891949, 2.628554, -4.32796, -4.0212035, -0.2369696, -5.476248, 5.174046, -1.121909]
Target sample: 67, Prediction:1, Target's Score:[0.46887138, 13.357056, -2.6437943, -1.9764531, -5.580411, -3.5680103, 1.3874876, -3.3826213, -0.6971367, 3.1934543]
Target sample: 73, Prediction:1, Target's Score:[-0.120376505, 10.037736, -2.8256056, -0.5207831, -6.139357, -2.3372188, -0.05316879, -3.9580867, 4.458312, 1.9870645]
Target sample: 79, Prediction:1, Target's Score:[-0.8913366, 9.030532, -0.32053196, 0.34766662, -3.841866, -2.6402302, -2.4678524, -2.2349694, 1.0618142, 2.4789424]
Current ATTACK acc on target samples: 7.143
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 23:19:48 Epoch 59, Val iteration 0, acc 88.800 (88.800)
2021-06-12 23:19:55 Epoch 59, Val iteration 19, acc 90.600 (89.420)
* Prec: 89.42000122070313
Per class accuracy =  [0.92162407 0.92347391 0.84784667 0.82699793 0.88920895 0.82511217
 0.93732448 0.88685576 0.93378171 0.9456263 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 9, 8, 3, 1, 1, 1, 1, 6, 6, 1, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 9, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 9, 1, 1, 8, 1, 8
ATTACK acc: 18.571428571428573
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 23:20:02, Val iteration 0, acc 96.200 (96.200)
2021-06-12 23:20:14, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-12 23:20:20, Epoch 0, Iteration 7, loss 0.816 (0.881), acc 80.769 (78.600)
2021-06-12 23:21:32, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-5.0751815, 8.076798, -2.9947875, 3.686196, -3.8240914, -2.7853835, 2.1165042, -3.8169382, 2.3082354, 2.3323293]
Target sample: 7, Prediction:8, Target's Score:[-4.468507, 3.0260737, -1.9218093, 2.2219284, -4.491448, -1.5976053, 1.7874643, -4.516889, 7.853479, 2.0946393]
Target sample: 13, Prediction:1, Target's Score:[-4.03862, 7.9542747, -1.9388919, 2.6067922, -4.4387527, -1.6050158, 4.090386, -3.2199645, -2.7583828, 3.3799472]
Target sample: 19, Prediction:6, Target's Score:[-5.692402, 5.3334966, -3.9442277, -0.067766644, -4.151703, -1.1360286, 6.3659587, -3.8601122, 4.836419, 2.2935565]
Target sample: 25, Prediction:8, Target's Score:[-6.76236, 5.882686, -4.850678, -1.0701838, -4.822797, -0.07718362, 6.4632645, -3.907206, 7.4645004, 1.6363282]
Target sample: 31, Prediction:1, Target's Score:[-4.9535804, 12.101977, -3.5210154, 3.108984, -4.0559773, -1.6306157, 2.8231814, -4.031749, -2.0700798, 2.2698698]
Target sample: 37, Prediction:1, Target's Score:[-3.9505765, 11.15774, -2.9883025, 1.2874434, -4.486707, -1.8812438, 1.4979057, -3.9951935, 0.81100726, 2.5774517]
Target sample: 43, Prediction:1, Target's Score:[-5.8029776, 9.6218815, -3.6677184, -0.4685115, -4.776012, -2.0796213, 5.439145, -2.6191287, 2.4966037, 1.8501637]
Target sample: 49, Prediction:1, Target's Score:[-5.632939, 8.4517565, -3.0882542, -0.9091947, -4.229978, -1.1845365, 2.3929408, -4.922254, 5.7231903, 3.3875775]
Target sample: 55, Prediction:1, Target's Score:[-5.048317, 11.586766, -3.8339736, 1.7652385, -5.1517277, -1.7595226, 2.9445958, -3.8389359, -2.0345552, 5.417484]
Target sample: 61, Prediction:8, Target's Score:[-1.6481568, 4.308719, -3.9767926, 1.4233851, -3.5555038, -1.5675062, 2.8763494, -3.43526, 6.706223, -1.1529858]
Target sample: 67, Prediction:1, Target's Score:[-3.5548382, 10.76365, -4.1726985, 0.5471894, -5.8687634, -0.5611036, 4.4161887, -2.7461357, -2.7068336, 3.9127357]
Target sample: 73, Prediction:1, Target's Score:[-4.2307267, 10.975373, -3.7788086, 0.15814057, -4.7363486, -1.1494559, 4.3490853, -4.266367, 0.6900664, 2.0040033]
Target sample: 79, Prediction:1, Target's Score:[-5.096449, 9.621225, -2.822429, 3.3990014, -4.358384, -2.1862183, 1.6359507, -4.3982067, 1.5056282, 2.7328568]
Current ATTACK acc on target samples: 7.143
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 23:22:43 Epoch 59, Val iteration 0, acc 92.600 (92.600)
2021-06-12 23:22:55 Epoch 59, Val iteration 19, acc 90.600 (91.590)
* Prec: 91.59000244140626
Per class accuracy =  [0.94091005 0.93588783 0.87064726 0.78441122 0.95679233 0.88282748
 0.95044448 0.930057   0.94268301 0.95985112]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 8, 8, 8, 1, 1, 1, 1, 1, 6, 1, 9, 6, 9, 6, 6, 8, 8, 8, 8, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 8, 8, 1, 1, 1, 1, 1, 9, 1, 9, 9, 8, 1, 9, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 8
ATTACK acc: 12.857142857142858
--------
------SUMMARY PRE DEFENSE------
TIME ELAPSED (mins): 17
TARGET INDEX: 5
ResNet50 7.142857142857143 10.0 95.46000137329102 90.12000160217285
DPN92 14.285714285714286 14.285714285714286 95.50000267028808 93.41000099182129
MobileNetV2 7.142857142857143 18.571428571428573 91.22000160217286 89.42000122070313
GoogLeNet 7.142857142857143 12.857142857142858 95.41000213623047 91.59000244140626
DEFENSE EVALUATION
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
ResNet50
[74, 80, 84, 86, 89] 5
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 23:23:00, Val iteration 0, acc 94.200 (94.200)
2021-06-12 23:23:11, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-12 23:23:13, Epoch 0, Iteration 7, loss 0.048 (0.377), acc 100.000 (92.800)
2021-06-12 23:24:14, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-0.8348719, 5.039924, -2.2986426, 0.2501098, -3.6600716, -3.044671, -2.4492388, -2.487119, 4.973935, 4.876279]
Target sample: 7, Prediction:8, Target's Score:[2.9916933, 1.6136205, -0.68105805, -0.26750252, -2.9853835, -2.7879987, -1.7588959, -1.5409609, 3.2322538, 2.4630003]
Target sample: 13, Prediction:1, Target's Score:[-0.75029314, 14.754262, -3.089812, -2.0869596, -4.0412006, -3.9390934, -2.5054529, -3.2215474, -2.602, 8.112838]
Target sample: 19, Prediction:1, Target's Score:[3.7783015, 4.297702, -3.5591402, -0.5962006, -3.874202, -2.3230722, -0.9270901, -2.8763273, 4.1140375, 2.3372128]
Target sample: 25, Prediction:1, Target's Score:[1.8131245, 5.3351364, -3.583789, -0.8482418, -4.2864323, -2.2136314, -1.331889, -2.5885947, 5.2409735, 2.852698]
Target sample: 31, Prediction:1, Target's Score:[-2.7616632, 23.533628, -5.218483, -4.0122075, -5.451169, -4.835858, -3.0231311, -4.3447204, -3.1852446, 10.183883]
Target sample: 37, Prediction:1, Target's Score:[-0.11624375, 13.467234, -1.9819959, -2.0490232, -3.7057965, -4.1278257, -2.419583, -3.5758693, 0.20503137, 4.8644767]
Target sample: 43, Prediction:8, Target's Score:[-0.0012972653, 3.6160173, -2.3447568, -1.9326864, -3.5421875, -3.0326092, -2.096991, -2.340919, 11.674264, 0.26750928]
Target sample: 49, Prediction:8, Target's Score:[-0.098801225, 5.315209, -2.3254945, -1.9136505, -3.716043, -3.228661, -2.4838824, -2.6183884, 8.932039, 2.476992]
Target sample: 55, Prediction:1, Target's Score:[-1.9550216, 19.907549, -4.666489, -3.5165062, -5.17764, -4.1810946, -2.7380948, -4.0329037, -2.5007627, 9.632554]
Target sample: 61, Prediction:0, Target's Score:[6.7092037, 6.671641, -2.4333324, -3.4111223, -2.9782093, -3.2064676, -0.7465193, -1.7321085, 2.5348861, -1.0555006]
Target sample: 67, Prediction:1, Target's Score:[-0.44676176, 18.0295, -3.7532206, -2.619348, -4.7331686, -4.3898144, -2.0470297, -3.8460133, -2.1916966, 6.6826386]
Target sample: 73, Prediction:1, Target's Score:[0.40882352, 12.942346, -3.8109326, -1.8926808, -3.2175505, -3.604915, -2.4155226, -3.3498526, -0.23496203, 5.724989]
Target sample: 79, Prediction:1, Target's Score:[-0.6777421, 5.4716315, -1.2456871, 0.110351615, -3.2404406, -2.895658, -2.3024447, -3.1926682, 4.99024, 3.343226]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 23:25:13 Epoch 59, Val iteration 0, acc 90.000 (90.000)
2021-06-12 23:25:24 Epoch 59, Val iteration 19, acc 92.600 (91.570)
* Prec: 91.57000045776367
Per class accuracy =  [0.95253825 0.94044029 0.87017359 0.81657044 0.93064326 0.89103616
 0.95774259 0.9229021  0.94652103 0.9292464 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 8, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 8, 8, 8, 8, 8, 8
ATTACK acc: 0.0
DPN92
[74, 80, 84, 86, 89] 27
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 23:25:28, Val iteration 0, acc 94.800 (94.800)
2021-06-12 23:25:49, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-12 23:25:55, Epoch 0, Iteration 7, loss 0.393 (0.402), acc 88.462 (89.600)
2021-06-12 23:28:34, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-1.0433015, 13.198692, -3.0139143, -1.8899153, -4.245628, -2.4485888, -2.152698, -2.9605002, 4.1248965, 0.9048644]
Target sample: 7, Prediction:8, Target's Score:[0.28284025, 3.2313607, -3.6717603, -2.8911803, -2.9264874, -3.0820653, -2.5828166, -2.6205535, 9.7796135, 4.9944143]
Target sample: 13, Prediction:1, Target's Score:[-1.6002824, 8.448082, -2.8601143, -2.7218053, -3.1348777, -0.6676154, -1.6493295, -2.2748823, -0.7576983, 7.638608]
Target sample: 19, Prediction:9, Target's Score:[-1.7629083, 6.8914266, -4.6985908, -3.108708, -3.8804286, -0.57850647, -2.0616775, -3.624237, 5.1814575, 8.173038]
Target sample: 25, Prediction:8, Target's Score:[-0.8090588, 3.0585124, -3.920309, -0.7170315, -3.4339776, -2.1456997, -0.6923241, -2.92087, 6.795818, 5.3005533]
Target sample: 31, Prediction:1, Target's Score:[-1.0959742, 13.394036, -2.0647588, -2.7377653, -3.4702835, -0.49394098, -1.6865075, -1.8321885, -0.8497288, 1.2677075]
Target sample: 37, Prediction:1, Target's Score:[0.16298042, 14.26874, -3.0980437, -2.5282307, -3.5664241, -1.9594663, -2.0573668, -2.1385071, 0.9145357, 0.45575202]
Target sample: 43, Prediction:1, Target's Score:[-0.64100575, 13.036928, -2.62456, -2.964869, -3.4092257, -2.3536632, -1.6177155, -1.802369, 3.419859, -0.59259105]
Target sample: 49, Prediction:1, Target's Score:[-0.5542614, 9.716849, -2.8033714, -2.8195314, -3.6710541, -2.6769314, -1.7876407, -2.2180638, 7.2169604, 0.08974072]
Target sample: 55, Prediction:9, Target's Score:[-1.590497, 7.5937514, -3.772937, -3.0780194, -3.14485, -0.3783808, -2.1876674, -3.2445307, -0.731448, 11.008252]
Target sample: 61, Prediction:8, Target's Score:[1.999268, 6.5626755, -3.4934032, -2.2357304, -3.2777026, -3.7896984, -1.7441164, -2.3667676, 7.3090563, 1.528711]
Target sample: 67, Prediction:1, Target's Score:[-0.807909, 11.785581, -4.0004363, -2.1660066, -3.3937368, -2.1159494, -2.1143863, -2.994058, 1.0127751, 5.23252]
Target sample: 73, Prediction:1, Target's Score:[-0.16029036, 12.238602, -3.4946966, -3.003102, -3.957266, -2.1886702, -2.1448917, -3.1503901, 3.505385, 2.8415177]
Target sample: 79, Prediction:1, Target's Score:[-1.0726389, 12.847065, -3.457768, -1.9700189, -4.110628, -2.2539926, -1.922242, -2.6135335, 3.1746252, 1.8397138]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 23:31:09 Epoch 59, Val iteration 0, acc 92.600 (92.600)
2021-06-12 23:31:31 Epoch 59, Val iteration 19, acc 92.800 (93.010)
* Prec: 93.01000061035157
Per class accuracy =  [0.92240106 0.94875    0.885207   0.87150185 0.92641121 0.90848164
 0.96293073 0.94792177 0.97217976 0.9563703 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 9, 9, 9, 9, 1, 8, 8, 8, 8, 1, 1, 9, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 8, 1, 1, 1, 1, 9, 9, 9, 9, 9, 9, 8, 9, 9, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 8, 8, 8, 8
ATTACK acc: 0.0
MobileNetV2
[74, 80, 84, 86, 89] 48
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 23:31:34, Val iteration 0, acc 92.600 (92.600)
2021-06-12 23:31:40, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-12 23:31:41, Epoch 0, Iteration 7, loss 0.203 (0.290), acc 90.385 (90.600)
2021-06-12 23:32:10, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-0.64334506, 11.062215, -3.7212555, 0.815914, -4.1837087, -3.1806028, -3.567466, -3.3150096, 2.8505118, 4.5960164]
Target sample: 7, Prediction:1, Target's Score:[-0.59390235, 4.4135036, -2.5948687, 2.7492428, -2.2053761, -3.6428964, -3.6458495, 1.8445954, 0.21751359, 4.064515]
Target sample: 13, Prediction:1, Target's Score:[-0.9795774, 11.876061, -3.7392986, -0.36932862, -4.866886, -3.6194704, -2.2898033, -0.06744445, -0.03465954, 4.778457]
Target sample: 19, Prediction:1, Target's Score:[-2.4027328, 13.663148, -5.8396616, 0.20416921, -8.289107, -2.609978, 1.0817953, -4.402702, 5.6071615, 3.7958019]
Target sample: 25, Prediction:1, Target's Score:[-1.5133175, 9.237126, -4.4029202, -0.27276224, -6.346677, -2.06506, 0.9926968, -3.9579313, 3.7056205, 5.343978]
Target sample: 31, Prediction:1, Target's Score:[0.045244813, 18.409174, -2.7756236, -3.045201, -5.4339867, -2.975801, -2.7912638, -3.6505482, -2.0660307, 5.1704845]
Target sample: 37, Prediction:1, Target's Score:[-0.3807913, 14.563038, -1.8168638, -0.18550491, -6.59763, -0.5690203, -6.489624, -0.23866758, 0.18909815, 2.2968519]
Target sample: 43, Prediction:1, Target's Score:[-0.8326858, 9.311537, -1.9697497, -0.41398138, -5.586019, -2.5761397, -3.4623795, -2.5840015, 4.976638, 3.8286579]
Target sample: 49, Prediction:1, Target's Score:[-1.2461542, 9.195295, -3.2156236, 1.1876311, -6.5654464, 0.9711503, -4.100235, -5.129122, 4.4820895, 5.1971307]
Target sample: 55, Prediction:1, Target's Score:[-1.512219, 15.3740015, -4.576839, -1.7627001, -7.317516, -0.69237494, -2.0910308, -3.260596, -0.7963569, 7.498944]
Target sample: 61, Prediction:1, Target's Score:[2.379946, 11.924178, -2.7539217, 2.0428553, -5.157603, -4.459563, -3.6776505, -4.936437, 4.9285245, 0.40304708]
Target sample: 67, Prediction:1, Target's Score:[0.7917314, 16.344183, -3.0402434, -2.3587651, -6.105461, -3.7839518, -2.8358133, -2.3438547, -0.06807123, 4.202122]
Target sample: 73, Prediction:1, Target's Score:[0.79838496, 13.581572, -3.3394358, -0.97441125, -6.55153, -3.21468, -4.2794843, -3.2099192, 4.721492, 3.2387094]
Target sample: 79, Prediction:1, Target's Score:[0.072841115, 11.678848, -1.2675191, 0.28505108, -3.9843874, -2.9379804, -5.4991903, -1.9654368, 1.2754279, 3.0819457]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 23:32:38 Epoch 59, Val iteration 0, acc 89.800 (89.800)
2021-06-12 23:32:44 Epoch 59, Val iteration 19, acc 89.600 (89.690)
* Prec: 89.69000205993652
Per class accuracy =  [0.91700939 0.93528734 0.85271127 0.83716119 0.89356078 0.82386633
 0.93469016 0.89369002 0.93127178 0.94721342]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 9, 8, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 8, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 9, 1, 1, 8, 1, 1
ATTACK acc: 0.0
GoogLeNet
[74, 80, 84, 86, 89] 22
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 23:32:47, Val iteration 0, acc 96.200 (96.200)
2021-06-12 23:33:00, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-12 23:33:02, Epoch 0, Iteration 7, loss 0.794 (0.848), acc 76.923 (78.400)
2021-06-12 23:34:14, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-3.879332, 14.114689, -2.9220178, 0.7910614, -3.886608, -4.6114163, -2.647463, -3.7332451, 2.8325045, 3.9845304]
Target sample: 7, Prediction:1, Target's Score:[-0.53446054, 7.180906, -1.4581642, -0.6264935, -3.5062783, -3.5365493, -3.5231166, -4.3969393, 5.6475196, 4.803744]
Target sample: 13, Prediction:1, Target's Score:[-1.3104042, 14.25842, -1.0650628, 0.69422376, -3.3875542, -4.3653426, -2.0802147, -3.576555, -1.6091918, 2.467269]
Target sample: 19, Prediction:1, Target's Score:[-2.579695, 8.65361, -2.8652644, 0.5463016, -3.406032, -4.538111, -0.5067673, -3.676785, 5.485626, 2.920463]
Target sample: 25, Prediction:1, Target's Score:[-3.2668526, 11.413107, -3.672756, -2.3808796, -4.310094, -3.7485247, -0.6658017, -3.6718729, 6.16766, 4.1950374]
Target sample: 31, Prediction:1, Target's Score:[-3.1979513, 17.186527, -2.6558526, 0.12433784, -3.3475554, -4.3884125, -2.1875722, -3.5302844, -1.293327, 3.327027]
Target sample: 37, Prediction:1, Target's Score:[-0.7949673, 13.6310425, -2.3781486, -1.1876731, -3.5170426, -3.149235, -2.9736397, -3.2587032, 0.72937536, 2.940167]
Target sample: 43, Prediction:1, Target's Score:[-2.8121781, 14.758202, -2.9695754, -2.261484, -3.309726, -3.8117988, -2.052063, -3.2683887, 2.6757784, 3.097753]
Target sample: 49, Prediction:1, Target's Score:[-3.1164393, 12.974167, -3.3552105, -2.9279335, -3.2079284, -3.1942163, -3.0334399, -4.2743206, 4.5346684, 5.666212]
Target sample: 55, Prediction:1, Target's Score:[-3.3715577, 18.88373, -3.7236493, -2.8641896, -4.479147, -3.3648028, -1.3182511, -3.4405484, -0.66935545, 4.4068594]
Target sample: 61, Prediction:1, Target's Score:[0.7000694, 12.309703, -3.5615194, -2.1545012, -2.5181334, -3.9239385, -2.4385176, -3.71444, 4.1769075, 1.1640052]
Target sample: 67, Prediction:1, Target's Score:[-1.1748421, 16.839602, -3.7907138, -1.951901, -4.5561047, -3.6596363, -1.3121811, -2.8730628, -1.8754104, 4.4026923]
Target sample: 73, Prediction:1, Target's Score:[-0.30481485, 13.372614, -3.7661617, -1.821728, -3.6715617, -3.7661726, -2.3170311, -3.7722943, 1.1839293, 4.911139]
Target sample: 79, Prediction:1, Target's Score:[-3.7055132, 14.977938, -2.8873694, -0.0043975227, -4.3421965, -4.33834, -2.5488744, -3.8650765, 2.3540623, 4.408483]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 23:35:24 Epoch 59, Val iteration 0, acc 92.800 (92.800)
2021-06-12 23:35:36 Epoch 59, Val iteration 19, acc 93.800 (92.890)
* Prec: 92.8900016784668
Per class accuracy =  [0.95133364 0.96853382 0.90040258 0.86929275 0.94539296 0.87686635
 0.9539842  0.92785917 0.95172943 0.94387049]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 8, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8
ATTACK acc: 0.0
------SUMMARY POST DEFENSE------
TIME ELAPSED (mins): 17
TARGET INDEX: 5
ResNet50 0.0 0.0 95.46000137329102 91.57000045776367 100.0
DPN92 0.0 0.0 95.50000267028808 93.01000061035157 100.0
MobileNetV2 0.0 0.0 91.22000160217286 89.69000205993652 100.0
GoogLeNet 0.0 0.0 95.41000213623047 92.8900016784668 100.0
True False False False False
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.300-droplayer0.000.t7
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
No specific indices are determined, so try to include whatever we find
In total, we found 96 images of target 6
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', eval_poisons_root='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=False, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=6, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/6/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
# Targets: 16, # Poisons: 5
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-12 23:35:53 Iteration 0 	 Training Loss: 8.984e-01 	 Loss in Target Net: 2.260e+00	  
 2021-06-12 23:36:46 Iteration 50 	 Training Loss: 2.100e-01 	 Loss in Target Net: 3.491e-01	  
 2021-06-12 23:37:39 Iteration 100 	 Training Loss: 1.906e-01 	 Loss in Target Net: 2.994e-01	  
 2021-06-12 23:38:30 Iteration 150 	 Training Loss: 1.822e-01 	 Loss in Target Net: 3.229e-01	  
 2021-06-12 23:39:20 Iteration 200 	 Training Loss: 1.751e-01 	 Loss in Target Net: 3.803e-01	  
 2021-06-12 23:40:12 Iteration 250 	 Training Loss: 1.755e-01 	 Loss in Target Net: 3.508e-01	  
 2021-06-12 23:41:02 Iteration 300 	 Training Loss: 1.722e-01 	 Loss in Target Net: 3.526e-01	  
 2021-06-12 23:41:51 Iteration 350 	 Training Loss: 1.700e-01 	 Loss in Target Net: 3.413e-01	  
 2021-06-12 23:42:42 Iteration 400 	 Training Loss: 1.686e-01 	 Loss in Target Net: 3.584e-01	  
 2021-06-12 23:43:33 Iteration 450 	 Training Loss: 1.672e-01 	 Loss in Target Net: 3.601e-01	  
 2021-06-12 23:44:24 Iteration 500 	 Training Loss: 1.656e-01 	 Loss in Target Net: 3.221e-01	  
 2021-06-12 23:45:15 Iteration 550 	 Training Loss: 1.643e-01 	 Loss in Target Net: 3.656e-01	  
 2021-06-12 23:46:07 Iteration 600 	 Training Loss: 1.664e-01 	 Loss in Target Net: 3.613e-01	  
 2021-06-12 23:46:57 Iteration 650 	 Training Loss: 1.652e-01 	 Loss in Target Net: 3.560e-01	  
 2021-06-12 23:47:49 Iteration 700 	 Training Loss: 1.686e-01 	 Loss in Target Net: 3.628e-01	  
 2021-06-12 23:48:40 Iteration 750 	 Training Loss: 1.654e-01 	 Loss in Target Net: 3.555e-01	  
 2021-06-12 23:49:31 Iteration 800 	 Training Loss: 1.666e-01 	 Loss in Target Net: 3.787e-01	  
 2021-06-12 23:50:24 Iteration 850 	 Training Loss: 1.623e-01 	 Loss in Target Net: 3.580e-01	  
 2021-06-12 23:51:15 Iteration 900 	 Training Loss: 1.659e-01 	 Loss in Target Net: 3.773e-01	  
 2021-06-12 23:52:06 Iteration 950 	 Training Loss: 1.669e-01 	 Loss in Target Net: 3.866e-01	  
 2021-06-12 23:52:56 Iteration 999 	 Training Loss: 1.658e-01 	 Loss in Target Net: 3.336e-01	  
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 23:53:02, Val iteration 0, acc 94.200 (94.200)
2021-06-12 23:53:12, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-12 23:53:17, Epoch 0, Iteration 7, loss 0.590 (0.846), acc 76.923 (85.600)
2021-06-12 23:54:18, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-2.923165, 13.663147, -3.397361, -1.9143339, -2.795749, -2.9675808, 4.628235, -1.9033915, -1.5902389, -0.5572406]
Target sample: 7, Prediction:1, Target's Score:[-3.071557, 10.206554, -2.9603553, -2.1199899, -1.2548438, -3.1297185, 4.708039, -2.6538024, -2.7163887, 3.22824]
Target sample: 13, Prediction:9, Target's Score:[-1.360724, 5.9252787, -2.3898954, -1.7874672, -3.0640185, -2.7580125, 1.0834739, -2.825813, -3.2355936, 10.616419]
Target sample: 19, Prediction:1, Target's Score:[-2.3960238, 8.275505, -3.3762627, -0.61461824, -1.9817915, -3.0518441, 4.4641495, -1.6871314, 0.7743564, -0.1951333]
Target sample: 25, Prediction:1, Target's Score:[-3.287584, 12.861375, -3.7166817, -0.9071496, -2.7774577, -3.2274325, 4.810775, -2.262792, -0.38645715, -0.85596585]
Target sample: 31, Prediction:1, Target's Score:[-2.4065368, 7.9740453, -2.640722, -1.6020371, -1.9294138, -2.83494, 5.8176446, -1.8386433, -0.62581974, 0.30064294]
Target sample: 37, Prediction:1, Target's Score:[-3.2972286, 15.815433, -3.3315227, -2.0622287, -2.1197376, -3.473112, 2.9667892, -2.6907682, -2.4619632, 0.9197797]
Target sample: 43, Prediction:1, Target's Score:[-1.0289445, 7.5260878, -4.0770855, -0.77320534, 2.5772922, -2.193199, 3.3060377, -1.438509, -1.3394942, -2.3086631]
Target sample: 49, Prediction:1, Target's Score:[-2.0419247, 13.352521, -4.1457906, -1.0739505, -1.3343992, -3.286818, 2.905747, -2.3630235, -0.1781935, -1.5822662]
Target sample: 55, Prediction:1, Target's Score:[-2.1567433, 6.9239726, -2.0962245, -1.8808808, -1.9877877, -3.0613387, 6.648187, -2.7456, -0.33764094, 0.9108751]
Target sample: 61, Prediction:1, Target's Score:[-3.7575302, 12.747121, -3.2022164, -0.70090365, -2.5072205, -3.0605023, 5.8343735, -2.4753535, -1.7063226, -0.9168515]
Target sample: 67, Prediction:1, Target's Score:[-2.1241682, 8.42481, -3.4593208, 0.26690507, 1.3426541, -2.589225, 3.2988129, -2.1361217, -0.6998736, -2.0933046]
Target sample: 73, Prediction:1, Target's Score:[-3.3823457, 12.968945, -3.4712086, -0.82262427, -2.8802605, -3.068089, 5.0458255, -2.197102, -1.0877602, -0.8577941]
Target sample: 79, Prediction:1, Target's Score:[-3.534748, 11.292479, -3.1916337, -1.2946566, -2.8368275, -3.3236127, 4.4377127, -2.667734, -2.7825751, 4.153325]
Target sample: 85, Prediction:9, Target's Score:[-0.46304598, 2.782188, -2.972579, -1.0880005, -1.5571026, -2.7127092, 3.8545432, -1.7259533, -1.408624, 5.473309]
Target sample: 91, Prediction:1, Target's Score:[-2.2294803, 14.156115, -3.718308, -1.6047988, -2.9350598, -2.8769045, 2.396119, -2.38582, -0.8345643, 0.26269412]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 23:55:17 Epoch 59, Val iteration 0, acc 90.600 (90.600)
2021-06-12 23:55:28 Epoch 59, Val iteration 19, acc 91.400 (91.150)
* Prec: 91.15000190734864
Per class accuracy =  [0.96118986 0.94280588 0.7850775  0.83811973 0.94017641 0.85263205
 0.97136705 0.91553748 0.94941764 0.9540305 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 9, 9, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 2.5
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 23:55:39, Val iteration 0, acc 94.800 (94.800)
2021-06-12 23:56:00, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-12 23:56:14, Epoch 0, Iteration 7, loss 0.571 (0.465), acc 90.385 (89.000)
2021-06-12 23:58:54, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-0.109694734, 10.04201, -4.1826262, -2.114814, -2.3583028, -2.8915908, 5.6047945, -3.4943306, 2.7094822, -2.7461731]
Target sample: 7, Prediction:1, Target's Score:[-1.2205509, 11.244848, -4.2513366, -2.5879254, -1.3548386, -3.3627543, 5.1563845, -4.4538455, -0.42914677, 1.8059583]
Target sample: 13, Prediction:1, Target's Score:[-0.95068616, 10.75744, -4.0520353, -2.5196729, -2.1736093, -3.5205913, 5.4712577, -4.2653537, -1.3033106, 3.1109436]
Target sample: 19, Prediction:1, Target's Score:[0.23566134, 7.7765803, -3.9229507, -1.5544316, -1.7341778, -2.6719835, 7.3620234, -3.3431425, 0.94290036, -2.6152864]
Target sample: 25, Prediction:1, Target's Score:[-0.19359401, 12.899256, -4.243208, -3.02087, -2.0935006, -3.3535237, 4.9430623, -3.9219928, 0.062057376, -0.5235002]
Target sample: 31, Prediction:6, Target's Score:[0.80382806, 6.803803, -3.7141893, -1.7359996, -0.39821368, -3.2276335, 7.681106, -3.2787673, 0.1698088, -2.620995]
Target sample: 37, Prediction:1, Target's Score:[-0.3374051, 13.35484, -4.238797, -3.1867094, -1.5800725, -3.1486409, 4.548226, -3.9260702, 0.022019573, -0.9735622]
Target sample: 43, Prediction:1, Target's Score:[-1.2039955, 7.7864695, -3.963648, -1.2926155, 0.1568186, -3.0194407, 7.724676, -4.339816, 0.074934974, -1.4324433]
Target sample: 49, Prediction:1, Target's Score:[-0.1822072, 12.037451, -4.077388, -2.893079, -0.9933043, -3.0420907, 4.641764, -4.4028783, 0.70316625, -1.2986389]
Target sample: 55, Prediction:6, Target's Score:[-0.4952049, 9.482303, -3.6380348, -2.8373914, -0.8586172, -2.7847385, 9.779548, -3.9368036, -1.1595396, -2.9776902]
Target sample: 61, Prediction:1, Target's Score:[-0.33653796, 11.4165, -4.1230335, -2.657823, -1.4155048, -3.2171502, 7.0272303, -3.9267716, 0.095062606, -2.3179436]
Target sample: 67, Prediction:6, Target's Score:[-0.28037578, 7.5885096, -3.8821204, -1.7367744, -0.7818002, -2.8400648, 8.994629, -3.8919566, 0.48876148, -3.153253]
Target sample: 73, Prediction:1, Target's Score:[0.8363175, 10.1824465, -3.956325, -2.2585578, -1.9462407, -3.4872193, 5.1232476, -3.8553786, 0.36457735, -0.48001635]
Target sample: 79, Prediction:1, Target's Score:[0.098601155, 11.462605, -4.245709, -2.4299011, -2.0476494, -3.667758, 4.3023605, -4.1861496, -0.78384334, 2.0458822]
Target sample: 85, Prediction:1, Target's Score:[-1.2656537, 8.999678, -4.3869286, -1.4215299, -1.4998606, -3.669915, 7.0649567, -4.2036633, 0.095621906, 0.8143248]
Target sample: 91, Prediction:1, Target's Score:[0.105149366, 12.420066, -4.4567714, -3.1787934, -2.6842844, -3.1890764, 4.8849096, -3.505674, 1.6538305, -1.5439785]
Current ATTACK acc on target samples: 18.750
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 00:01:30 Epoch 59, Val iteration 0, acc 92.400 (92.400)
2021-06-13 00:01:51 Epoch 59, Val iteration 19, acc 91.800 (92.930)
* Prec: 92.93000106811523
Per class accuracy =  [0.93462464 0.96554235 0.86829075 0.83434972 0.95772329 0.90481688
 0.96102902 0.95439829 0.96448378 0.94840401]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 6, 1, 1, 1, 1, 6, 6, 1, 6, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 15.0
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 00:01:54, Val iteration 0, acc 92.600 (92.600)
2021-06-13 00:02:01, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-13 00:02:03, Epoch 0, Iteration 7, loss 0.456 (0.284), acc 84.615 (90.400)
2021-06-13 00:02:31, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.4976447, 10.735183, -5.975047, 0.3135783, -4.068413, -3.0014172, 5.5608044, -4.509843, 3.3487816, -0.4528991]
Target sample: 7, Prediction:1, Target's Score:[-0.60888493, 7.949614, -3.0988395, -1.1636183, -0.74107313, -2.6246388, 5.460947, -4.1161084, -3.2188551, 2.5931559]
Target sample: 13, Prediction:9, Target's Score:[-2.9491212, 6.604654, -3.3340342, 1.715781, -3.22956, -2.4312873, 5.9570875, -5.7724, -3.6972773, 7.582801]
Target sample: 19, Prediction:1, Target's Score:[-4.041521, 7.7539053, -3.4318187, 3.3033383, -2.7622795, -2.634074, 6.76629, -4.1669407, -0.027438942, -0.3034779]
Target sample: 25, Prediction:6, Target's Score:[-3.2130697, 7.8227563, -4.7358356, 0.8344467, -3.5039272, -2.588341, 8.819213, -2.941869, -1.3964915, 1.341106]
Target sample: 31, Prediction:1, Target's Score:[-3.238861, 8.459324, -5.187979, 0.5495269, 2.1667862, -1.2700465, 5.281992, -3.8344991, -4.001291, 1.5419724]
Target sample: 37, Prediction:1, Target's Score:[-2.6399236, 9.519089, -4.5763316, 0.8407121, 0.0115974955, -2.1916723, 4.889557, -5.1218452, -3.9743967, 3.7184756]
Target sample: 43, Prediction:6, Target's Score:[-1.2650875, 2.345694, -1.4819149, 3.3178084, -3.311523, -3.0518584, 9.842321, -5.819664, 1.6201537, -1.7888736]
Target sample: 49, Prediction:6, Target's Score:[-2.7862864, 4.0478115, -4.3725033, 2.728155, 2.1079857, -3.3307297, 8.479825, -4.9524136, 0.6355833, -2.1291895]
Target sample: 55, Prediction:6, Target's Score:[-3.839116, 7.183232, -4.886647, 1.3640443, -1.9970902, -2.5543332, 15.1418915, -5.881156, -1.3350012, -2.6915755]
Target sample: 61, Prediction:1, Target's Score:[-3.810901, 8.779201, -5.5357018, 1.7510568, 1.107766, -0.57039726, 3.4932504, -4.080535, -2.4945827, 1.8149089]
Target sample: 67, Prediction:6, Target's Score:[-4.028749, 5.482883, -2.8979087, 2.6520042, 5.042155, -1.3735684, 5.5758305, -5.637091, -3.8994892, -0.41160983]
Target sample: 73, Prediction:1, Target's Score:[-2.6903946, 8.650369, -4.257768, 0.40050465, 0.60996324, -2.5070057, 6.5451503, -4.175275, -2.9544635, 0.83354175]
Target sample: 79, Prediction:1, Target's Score:[-1.5407887, 9.970529, -5.0028815, -1.645246, -5.517793, -1.4435707, 5.8611026, -5.7261996, -0.4947534, 5.9965835]
Target sample: 85, Prediction:9, Target's Score:[-3.4666374, -0.03185644, -0.5567863, 0.13925235, -1.549364, -3.5947542, 4.3049, -2.4810915, 0.19504704, 7.450019]
Target sample: 91, Prediction:1, Target's Score:[1.934813, 11.109974, -4.658434, -1.7239792, -4.6341276, -4.059476, 3.3259852, -3.9631827, 3.489788, -0.4070806]
Current ATTACK acc on target samples: 31.250
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 00:02:58 Epoch 59, Val iteration 0, acc 90.400 (90.400)
2021-06-13 00:03:05 Epoch 59, Val iteration 19, acc 90.400 (89.670)
* Prec: 89.67000160217285
Per class accuracy =  [0.92403281 0.92640644 0.85189595 0.82828762 0.88951343 0.82450309
 0.93896533 0.89284256 0.93594706 0.95090161]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 1, 1, 6, 6, 1, 6, 9, 9, 9, 6, 6, 6, 6, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 6, 1, 6, 1, 6, 1, 1, 1, 1, 6, 6, 1, 6, 6, 6, 6, 1, 1, 1, 1, 1, 4, 4, 4, 6, 4, 1, 1, 1, 1, 1, 6, 6, 1, 6, 1, 6, 9, 9, 6, 1, 9, 1, 1, 1, 1, 1, 8, 6, 1
ATTACK acc: 33.75
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 00:03:12, Val iteration 0, acc 96.200 (96.200)
2021-06-13 00:03:25, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-13 00:03:31, Epoch 0, Iteration 7, loss 0.781 (0.753), acc 76.923 (81.000)
2021-06-13 00:04:43, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-4.6600337, 8.925244, -3.7899637, 0.6200482, -2.492329, -2.277243, 10.507454, -4.197821, -0.07206993, -2.614342]
Target sample: 7, Prediction:1, Target's Score:[-4.3950863, 10.195579, -2.569308, 0.54607815, -1.6387447, -3.6239154, 8.96953, -3.9797037, -2.1911922, -1.3572164]
Target sample: 13, Prediction:6, Target's Score:[-4.48148, 4.7999306, -4.7283006, 1.2946095, -3.8343804, -2.959978, 7.963867, -4.0112047, -1.1037792, 7.028005]
Target sample: 19, Prediction:6, Target's Score:[-3.6443808, 3.3877187, -3.8337643, 3.886732, -1.6687516, -2.5580015, 7.664683, -4.1303854, 1.3297313, -0.4650278]
Target sample: 25, Prediction:1, Target's Score:[-4.5710187, 9.555541, -4.255271, 2.371171, -3.8090296, -2.3544495, 9.212117, -4.486478, -2.3386788, 0.6380849]
Target sample: 31, Prediction:6, Target's Score:[-3.9373758, 2.6625228, -3.8269014, 1.570569, -2.2023978, -1.5811728, 9.927077, -4.0112824, -0.5854363, 1.9360209]
Target sample: 37, Prediction:1, Target's Score:[-3.593679, 8.255775, -6.041254, 3.2139802, 1.2842041, -3.5975432, 5.073386, -4.5511193, -1.6921533, 1.624212]
Target sample: 43, Prediction:6, Target's Score:[-2.890086, 7.326325, -4.2160635, 1.1008384, -1.2842702, -0.21744631, 9.186375, -3.9123197, -1.7515799, -3.4031622]
Target sample: 49, Prediction:6, Target's Score:[-4.4784966, 7.385836, -3.872321, 0.41863406, -0.8023878, -3.9884505, 10.222094, -4.582565, 1.8361734, -2.1809075]
Target sample: 55, Prediction:6, Target's Score:[-4.2147694, 8.901809, -4.094459, 1.0322118, -3.2160835, -2.6922038, 11.345563, -3.8275793, -1.5408422, -1.7448467]
Target sample: 61, Prediction:6, Target's Score:[-4.211364, 3.2640376, -4.0800285, 1.5674076, -2.3872678, -3.0229208, 9.84687, -4.0356655, -0.29949766, 3.3160317]
Target sample: 67, Prediction:6, Target's Score:[-4.208648, 6.350246, -3.2788677, 3.249789, -2.67058, -2.5429406, 9.318511, -4.2754645, -1.7212937, -0.26000485]
Target sample: 73, Prediction:1, Target's Score:[-4.297805, 9.970523, -5.498577, 2.7666225, -1.6161202, -2.4778483, 6.121025, -4.46214, -2.037435, 1.5078235]
Target sample: 79, Prediction:9, Target's Score:[-3.7254674, 4.154844, -4.347449, 1.5407746, -2.8537817, -3.9404361, 6.7073426, -4.123546, -1.9895271, 8.549097]
Target sample: 85, Prediction:6, Target's Score:[-4.3660192, 3.4807577, -3.3491783, 3.2509522, -2.3264558, -2.6383383, 8.0175705, -3.3838992, -2.4406366, 3.7192867]
Target sample: 91, Prediction:1, Target's Score:[-4.202825, 12.920578, -4.4099507, -0.35809106, -2.3235838, -3.627964, 8.446799, -4.233585, -0.6391521, -1.6124275]
Current ATTACK acc on target samples: 62.500
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 00:05:53 Epoch 59, Val iteration 0, acc 93.200 (93.200)
2021-06-13 00:06:06 Epoch 59, Val iteration 19, acc 91.600 (92.270)
* Prec: 92.27000122070312
Per class accuracy =  [0.94648581 0.95111492 0.89594222 0.82424833 0.95544056 0.88341101
 0.96183291 0.9117955  0.95243677 0.94249532]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 1, 1, 6, 6, 6, 6, 6, 6, 9, 6, 6, 6, 6, 1, 1, 1, 6, 6, 6, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 6, 1, 1, 1, 1, 6, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 6, 9, 1, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 6
ATTACK acc: 57.5
--------
------SUMMARY PRE DEFENSE------
TIME ELAPSED (mins): 17
TARGET INDEX: 6
ResNet50 0.0 2.5 95.46000137329102 91.15000190734864
DPN92 18.75 15.0 95.50000267028808 92.93000106811523
MobileNetV2 31.25 33.75 91.22000160217286 89.67000160217285
GoogLeNet 62.5 57.5 95.41000213623047 92.27000122070312
DEFENSE EVALUATION
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
ResNet50
[74, 80, 84, 86, 89] 5
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 00:06:11, Val iteration 0, acc 94.200 (94.200)
2021-06-13 00:06:21, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-13 00:06:23, Epoch 0, Iteration 7, loss 0.097 (0.231), acc 94.231 (95.600)
2021-06-13 00:07:24, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-0.7834508, 14.298754, -6.1727595, -2.6323247, -1.3310547, 0.78531826, -2.1115584, -0.8898226, -0.71869546, 0.2623133]
Target sample: 7, Prediction:1, Target's Score:[-2.1057737, 8.539491, -2.7407308, -3.0438442, -1.7704033, -0.2828771, 0.5970057, -2.018577, -2.6602786, 6.044959]
Target sample: 13, Prediction:1, Target's Score:[-2.0200558, 10.975276, -4.12791, -1.7342855, -2.493067, 0.5659023, -1.2769172, -1.7389265, -1.9586322, 4.37666]
Target sample: 19, Prediction:1, Target's Score:[-2.067202, 13.13077, -5.7181687, -2.0161695, -2.1283567, 1.3687637, -1.9020095, -0.96076906, -1.605036, 2.5597382]
Target sample: 25, Prediction:1, Target's Score:[-2.4588194, 15.9478245, -6.122824, -2.3057563, -1.6595362, 0.9352337, -2.5972605, -0.84544843, -2.753572, 2.6252677]
Target sample: 31, Prediction:1, Target's Score:[-2.5110056, 15.544169, -6.2227864, -2.8030252, -1.0365523, -0.007282637, -2.3085213, 0.4264906, -2.3641367, 2.0263016]
Target sample: 37, Prediction:1, Target's Score:[-2.9592621, 19.176271, -7.17061, -3.2498038, -0.9703617, -0.44413432, -3.188746, 0.23887533, -2.665115, 2.1190572]
Target sample: 43, Prediction:1, Target's Score:[-0.14496723, 12.201483, -5.989515, -2.1208928, -0.1915929, 0.97675365, -2.091394, -0.98140013, -1.0929354, 0.10658914]
Target sample: 49, Prediction:1, Target's Score:[-1.6357905, 17.10914, -6.9153447, -2.945459, -0.612909, -0.6838312, -2.8282425, -0.82607436, -0.77537894, 0.9006103]
Target sample: 55, Prediction:1, Target's Score:[-2.9596465, 17.824404, -7.003342, -3.353229, -1.4900057, -0.740565, -0.93813336, -0.34348089, -1.7055802, 1.517262]
Target sample: 61, Prediction:1, Target's Score:[-3.1723044, 18.45716, -6.928145, -2.7342482, -1.3595256, -0.016409295, -2.6868849, -0.040841833, -2.9686449, 2.3009872]
Target sample: 67, Prediction:1, Target's Score:[-2.1148744, 13.887724, -5.3076353, -1.6782324, -1.3405855, 1.5885777, -2.2730882, -1.5570697, -2.185951, 1.6688415]
Target sample: 73, Prediction:1, Target's Score:[-2.7052634, 14.980222, -5.53542, -2.1286101, -1.8175739, 0.71439075, -2.4447281, -0.7047666, -2.6129227, 2.9747252]
Target sample: 79, Prediction:1, Target's Score:[-2.7683783, 13.290468, -4.977256, -2.7501059, -2.0990987, -0.4397757, -2.0575254, -0.72625613, -2.7212536, 5.955263]
Target sample: 85, Prediction:1, Target's Score:[-2.9115233, 9.139298, -3.2564092, -2.1049995, -2.197693, -0.8272393, -0.10682088, -1.8306626, -1.5273308, 6.1420927]
Target sample: 91, Prediction:1, Target's Score:[0.3167565, 13.760708, -6.23093, -2.9498293, -1.1498641, 0.21904632, -2.4920456, -1.0787756, 0.22039999, 0.074031234]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 00:08:24 Epoch 59, Val iteration 0, acc 89.400 (89.400)
2021-06-13 00:08:35 Epoch 59, Val iteration 19, acc 91.000 (90.960)
* Prec: 90.96000175476074
Per class accuracy =  [0.93666029 0.91385979 0.8475078  0.77613206 0.91527897 0.89271233
 0.9693912  0.93601386 0.97555384 0.93447645]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
DPN92
[89] 23
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
496
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 00:08:39, Val iteration 0, acc 94.800 (94.800)
2021-06-13 00:09:00, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-13 00:09:05, Epoch 0, Iteration 7, loss 0.489 (0.457), acc 90.385 (88.400)
2021-06-13 00:11:45, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-0.34208265, 10.488791, -3.4186954, -1.7044518, -1.8262198, -2.5211554, 0.76465595, -2.7039905, 2.1798174, -0.67647564]
Target sample: 7, Prediction:1, Target's Score:[-2.154088, 9.462262, -3.4100676, -1.9136271, -2.2265935, -2.870449, 2.9724529, -3.3597422, -0.38284332, 4.164063]
Target sample: 13, Prediction:1, Target's Score:[-1.8156148, 8.470681, -2.658497, -0.9943958, -3.2342594, -2.6746914, 2.2062917, -3.9739997, -0.78275555, 5.720138]
Target sample: 19, Prediction:1, Target's Score:[-0.8369988, 5.4511805, -2.601344, 0.039545365, -2.4927557, -2.6328332, 4.1044474, -2.7519505, 2.7978246, -0.9070486]
Target sample: 25, Prediction:1, Target's Score:[-0.8348954, 11.178006, -3.5179696, -0.71291894, -2.398836, -3.0362496, 1.0254387, -3.162992, 0.4986816, 1.2358918]
Target sample: 31, Prediction:1, Target's Score:[-0.22903429, 8.217352, -3.5472438, -1.5452834, -1.9935015, -3.2513251, 2.157294, -2.5013244, 2.292639, 0.6095463]
Target sample: 37, Prediction:1, Target's Score:[-0.9722003, 11.889516, -3.4070623, -1.2123058, -1.4854333, -2.883491, 0.34693512, -2.5997725, 0.36115986, 0.23504704]
Target sample: 43, Prediction:1, Target's Score:[-1.9400952, 7.601604, -3.066216, -0.43083993, -1.0534426, -1.6724938, 4.0365486, -3.1367748, -0.51385933, 0.40042067]
Target sample: 49, Prediction:1, Target's Score:[-0.81176376, 12.306973, -3.5866675, -1.4895748, -1.1205267, -2.738602, 0.10008638, -2.8555284, 0.2803424, 0.20117304]
Target sample: 55, Prediction:1, Target's Score:[-1.7941482, 7.8803005, -2.4200103, -1.8298237, -1.6542807, -2.3196025, 6.1627316, -2.833787, -0.3665738, -0.6020641]
Target sample: 61, Prediction:1, Target's Score:[-1.0089619, 11.287359, -3.4597313, -1.4402218, -1.761201, -2.9793234, 1.5819939, -2.9357119, 0.91132414, 0.06288859]
Target sample: 67, Prediction:1, Target's Score:[-0.9554034, 5.587821, -3.0931063, -0.6035629, -1.7703202, -2.632732, 4.6053877, -2.7485435, 2.997716, -1.221579]
Target sample: 73, Prediction:1, Target's Score:[0.9872782, 9.899278, -3.474562, -1.4964923, -2.619275, -3.2882016, 0.91070247, -2.9960995, 2.2461135, 0.068726495]
Target sample: 79, Prediction:1, Target's Score:[-1.1454198, 10.98293, -3.432814, -0.15260103, -2.7497668, -3.1956706, 0.43808916, -3.4171498, 0.25015974, 2.7049966]
Target sample: 85, Prediction:1, Target's Score:[-2.4514725, 7.95124, -3.2509584, -0.21499756, -2.4281855, -2.971413, 3.143788, -3.7100782, 0.53624, 3.6309917]
Target sample: 91, Prediction:1, Target's Score:[0.08139655, 12.078038, -3.465907, -2.2547557, -1.7322873, -2.760756, 0.39381048, -2.4897513, 0.552046, -0.124690175]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 00:14:21 Epoch 59, Val iteration 0, acc 93.800 (93.800)
2021-06-13 00:14:42 Epoch 59, Val iteration 19, acc 92.800 (92.840)
* Prec: 92.84000205993652
Per class accuracy =  [0.93645577 0.95327828 0.8675247  0.88602468 0.93632095 0.87678845
 0.955275   0.93677148 0.97126224 0.96341561]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 3.75
MobileNetV2
[80, 84] 45
Using Adam for retraining
2000
poison index =  74
poison index =  86
poison index =  89
497
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 00:14:45, Val iteration 0, acc 92.600 (92.600)
2021-06-13 00:14:51, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-13 00:14:52, Epoch 0, Iteration 7, loss 0.123 (0.296), acc 94.231 (90.600)
2021-06-13 00:15:20, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.4405917, 11.444105, -6.0755467, 0.53159225, -4.727814, -2.9586506, 5.209523, -4.578369, 2.4081569, 0.7509433]
Target sample: 7, Prediction:1, Target's Score:[-0.78756875, 8.675771, -3.1461105, -0.7717893, -1.7132573, -2.531617, 5.2147193, -4.655455, -3.3757346, 3.6396093]
Target sample: 13, Prediction:9, Target's Score:[-2.985064, 7.1155186, -3.324002, 1.7382114, -4.021288, -2.4282799, 5.291858, -5.79402, -3.6686301, 8.650642]
Target sample: 19, Prediction:1, Target's Score:[-4.0084796, 8.758653, -3.34458, 3.5117311, -3.2436953, -2.8256574, 5.7477856, -4.076193, -0.82872725, 0.87277836]
Target sample: 25, Prediction:1, Target's Score:[-3.1391685, 8.9057, -4.734162, 0.73946303, -4.3919816, -2.5924911, 7.7130055, -2.8823307, -2.2151208, 3.1410632]
Target sample: 31, Prediction:1, Target's Score:[-3.0064204, 9.346871, -5.2104297, 0.65126336, 1.5229731, -1.6759896, 3.9888775, -3.5580308, -4.0262594, 2.5563703]
Target sample: 37, Prediction:1, Target's Score:[-2.4894087, 10.105965, -4.496327, 0.82281137, -0.7600631, -2.4292839, 4.4889283, -4.9050107, -4.057417, 4.3324437]
Target sample: 43, Prediction:6, Target's Score:[-1.0911336, 2.5485795, -1.3200024, 3.624777, -3.4526458, -3.5491848, 8.794032, -5.5844107, 1.250282, -0.7642451]
Target sample: 49, Prediction:6, Target's Score:[-2.9747639, 4.6067142, -4.560501, 3.3399427, 1.3832908, -3.4379103, 8.331494, -5.162542, -0.064086765, -0.9601297]
Target sample: 55, Prediction:6, Target's Score:[-4.016369, 8.292766, -4.990444, 1.623206, -2.688868, -2.570975, 14.63647, -6.262509, -2.088385, -1.3568803]
Target sample: 61, Prediction:1, Target's Score:[-3.764976, 9.35533, -5.4218106, 2.0755324, 0.25701705, -0.96386814, 3.0763724, -4.2881265, -2.6923277, 2.948801]
Target sample: 67, Prediction:1, Target's Score:[-3.7694228, 6.0239105, -2.7364464, 2.6416292, 5.1743493, -1.7749515, 4.468212, -5.5987825, -4.5299587, 0.7196839]
Target sample: 73, Prediction:1, Target's Score:[-2.2925851, 9.675612, -4.2680783, 0.099155575, 0.18026203, -2.901516, 5.549094, -4.1202736, -3.2146497, 1.8669705]
Target sample: 79, Prediction:1, Target's Score:[-1.6040103, 10.759134, -5.1360703, -1.4409695, -6.182499, -1.5859573, 4.8576565, -5.754537, -0.52906764, 7.204777]
Target sample: 85, Prediction:9, Target's Score:[-3.186923, 0.6729156, -0.28138992, 0.025691517, -2.2172573, -3.5134182, 2.9320793, -2.473717, 0.143236, 8.382574]
Target sample: 91, Prediction:1, Target's Score:[1.8126639, 11.390889, -4.754533, -1.5311298, -4.7963133, -4.1212206, 2.5566568, -3.559268, 2.7409518, 0.78165215]
Current ATTACK acc on target samples: 18.750
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 00:15:47 Epoch 59, Val iteration 0, acc 89.200 (89.200)
2021-06-13 00:15:53 Epoch 59, Val iteration 19, acc 90.200 (89.490)
* Prec: 89.49000205993653
Per class accuracy =  [0.92240289 0.92422448 0.84802206 0.83023285 0.8930628  0.82568122
 0.93225114 0.88976205 0.93146788 0.94690069]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 1, 1, 9, 1, 1, 6, 9, 9, 9, 1, 9, 6, 6, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 6, 1, 6, 1, 1, 1, 1, 6, 6, 1, 6, 6, 6, 1, 1, 1, 1, 1, 1, 4, 4, 1, 1, 4, 1, 1, 1, 1, 1, 6, 6, 1, 1, 1, 9, 9, 9, 9, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 20.0
GoogLeNet
[74, 80, 84, 86, 89] 22
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 00:15:56, Val iteration 0, acc 96.200 (96.200)
2021-06-13 00:16:08, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-13 00:16:11, Epoch 0, Iteration 7, loss 1.097 (1.067), acc 65.385 (74.600)
2021-06-13 00:17:22, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-4.291799, 14.593988, -2.2893429, 1.1594009, -2.6487827, -0.80137604, 1.1602862, -4.1390224, -2.017753, -0.7849588]
Target sample: 7, Prediction:1, Target's Score:[-4.148882, 13.532056, -1.3468574, 2.8625288, -2.876704, -3.0550659, 0.76593846, -3.7170188, -3.1850948, 1.1195875]
Target sample: 13, Prediction:1, Target's Score:[-4.3729477, 10.031895, -4.0485983, 2.6488595, -4.9958, -1.9888635, -0.5463904, -3.9905984, -1.1545736, 8.394542]
Target sample: 19, Prediction:1, Target's Score:[-4.8675046, 9.663171, -2.8814614, 4.7242813, -3.5604205, -2.7970963, -0.063051954, -3.360401, 3.2770925, -0.17388308]
Target sample: 25, Prediction:1, Target's Score:[-4.480709, 15.211483, -2.8918989, 3.5262651, -5.001548, -2.637325, 0.79857904, -3.8313978, -1.8657715, 1.1427431]
Target sample: 31, Prediction:1, Target's Score:[-4.198944, 9.847364, -1.9294026, 1.4417312, -2.9343548, -1.875573, 0.7552443, -3.5363374, 0.39246494, 1.99079]
Target sample: 37, Prediction:1, Target's Score:[-3.6682608, 14.616125, -4.4171014, 5.0629272, -0.97973835, -3.1078973, -1.7026652, -4.4103613, -2.288022, 0.8555722]
Target sample: 43, Prediction:1, Target's Score:[-3.0623934, 10.493996, -2.0454357, 2.4440045, -1.7255335, 0.5318872, 1.7928754, -4.2942476, -2.7848332, -1.4184183]
Target sample: 49, Prediction:1, Target's Score:[-3.6968558, 12.660145, -2.755618, 2.2755218, -1.4174865, -2.6841254, 1.6971431, -5.1714373, -0.14882588, -0.8183696]
Target sample: 55, Prediction:1, Target's Score:[-3.7628996, 14.306132, -2.7181406, 2.7997718, -3.8118324, -2.3566177, 3.0111573, -4.6915383, -2.2674916, -0.55722415]
Target sample: 61, Prediction:1, Target's Score:[-4.401883, 9.775033, -2.1459599, 4.3281693, -3.362744, -2.7930653, 1.0747312, -3.1526544, 0.103544354, 0.53661895]
Target sample: 67, Prediction:1, Target's Score:[-4.0140247, 13.05575, -1.5903169, 2.6859844, -3.3038657, -2.9546583, 1.189065, -3.954173, -1.395714, 0.24029851]
Target sample: 73, Prediction:1, Target's Score:[-4.500703, 14.36284, -3.6483934, 3.7436068, -2.3464913, -2.8163722, -0.5814496, -3.635601, -1.3863842, 0.7725109]
Target sample: 79, Prediction:1, Target's Score:[-3.9239364, 8.581563, -2.877707, 4.659347, -3.7300186, -2.9764, -1.1888669, -4.0506706, -3.0078723, 8.491129]
Target sample: 85, Prediction:1, Target's Score:[-4.68867, 8.082533, -1.5095965, 5.3750677, -4.2465367, -1.6508949, 1.1684576, -3.4569173, -3.1758354, 4.062258]
Target sample: 91, Prediction:1, Target's Score:[-3.547023, 17.29614, -2.8080273, 1.9153996, -3.5000644, -1.8191717, -1.37525, -4.013869, -1.917095, -0.2665032]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 00:18:32 Epoch 59, Val iteration 0, acc 92.400 (92.400)
2021-06-13 00:18:44 Epoch 59, Val iteration 19, acc 91.000 (91.820)
* Prec: 91.82000122070312
Per class accuracy =  [0.94134514 0.96136879 0.86576576 0.80375464 0.95783781 0.87845838
 0.94537744 0.93344    0.94855    0.94720018]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
------SUMMARY POST DEFENSE------
TIME ELAPSED (mins): 17
TARGET INDEX: 6
ResNet50 0.0 0.0 95.46000137329102 90.96000175476074 100.0
DPN92 0.0 3.75 95.50000267028808 92.84000205993652 20.0
MobileNetV2 18.75 20.0 91.22000160217286 89.49000205993653 40.0
GoogLeNet 0.0 0.0 95.41000213623047 91.82000122070312 100.0
True False False False False
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.300-droplayer0.000.t7
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
No specific indices are determined, so try to include whatever we find
In total, we found 129 images of target 7
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', eval_poisons_root='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=False, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=7, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/7/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127]
# Targets: 22, # Poisons: 5
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-13 00:19:02 Iteration 0 	 Training Loss: 9.299e-01 	 Loss in Target Net: 2.192e+00	  
 2021-06-13 00:19:55 Iteration 50 	 Training Loss: 2.017e-01 	 Loss in Target Net: 4.305e-01	  
 2021-06-13 00:20:46 Iteration 100 	 Training Loss: 1.910e-01 	 Loss in Target Net: 3.336e-01	  
 2021-06-13 00:21:37 Iteration 150 	 Training Loss: 1.765e-01 	 Loss in Target Net: 3.856e-01	  
 2021-06-13 00:22:27 Iteration 200 	 Training Loss: 1.719e-01 	 Loss in Target Net: 4.083e-01	  
 2021-06-13 00:23:18 Iteration 250 	 Training Loss: 1.648e-01 	 Loss in Target Net: 4.787e-01	  
 2021-06-13 00:24:08 Iteration 300 	 Training Loss: 1.628e-01 	 Loss in Target Net: 4.216e-01	  
 2021-06-13 00:24:57 Iteration 350 	 Training Loss: 1.636e-01 	 Loss in Target Net: 4.223e-01	  
 2021-06-13 00:25:47 Iteration 400 	 Training Loss: 1.586e-01 	 Loss in Target Net: 4.408e-01	  
 2021-06-13 00:26:36 Iteration 450 	 Training Loss: 1.646e-01 	 Loss in Target Net: 4.698e-01	  
 2021-06-13 00:27:26 Iteration 500 	 Training Loss: 1.631e-01 	 Loss in Target Net: 4.433e-01	  
 2021-06-13 00:28:15 Iteration 550 	 Training Loss: 1.645e-01 	 Loss in Target Net: 4.318e-01	  
 2021-06-13 00:29:05 Iteration 600 	 Training Loss: 1.588e-01 	 Loss in Target Net: 4.316e-01	  
 2021-06-13 00:29:54 Iteration 650 	 Training Loss: 1.610e-01 	 Loss in Target Net: 3.922e-01	  
 2021-06-13 00:30:43 Iteration 700 	 Training Loss: 1.567e-01 	 Loss in Target Net: 5.051e-01	  
 2021-06-13 00:31:32 Iteration 750 	 Training Loss: 1.613e-01 	 Loss in Target Net: 5.137e-01	  
 2021-06-13 00:32:20 Iteration 800 	 Training Loss: 1.553e-01 	 Loss in Target Net: 4.578e-01	  
 2021-06-13 00:33:09 Iteration 850 	 Training Loss: 1.580e-01 	 Loss in Target Net: 5.449e-01	  
 2021-06-13 00:33:57 Iteration 900 	 Training Loss: 1.537e-01 	 Loss in Target Net: 5.366e-01	  
 2021-06-13 00:34:46 Iteration 950 	 Training Loss: 1.505e-01 	 Loss in Target Net: 4.208e-01	  
 2021-06-13 00:35:35 Iteration 999 	 Training Loss: 1.567e-01 	 Loss in Target Net: 4.448e-01	  
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 00:35:40, Val iteration 0, acc 94.200 (94.200)
2021-06-13 00:35:50, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-13 00:35:55, Epoch 0, Iteration 7, loss 0.558 (0.634), acc 90.385 (86.800)
2021-06-13 00:36:56, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-4.59234, 4.0600123, -1.3538566, -2.6033766, -0.41459677, -4.087765, 10.185344, -3.2128794, 1.019443, 1.2091889]
Target sample: 7, Prediction:6, Target's Score:[-5.1788063, 2.9561086, -0.89319396, -2.4503307, -0.43599895, -4.049302, 11.497088, -3.5470052, 0.2702454, 2.05624]
Target sample: 13, Prediction:6, Target's Score:[-5.1965394, 4.6034093, -0.24954994, -2.6123986, 0.69050485, -3.9581373, 12.136913, -4.0826526, -1.3462101, 0.2393551]
Target sample: 19, Prediction:1, Target's Score:[-3.676084, 13.017853, -1.3712798, -2.9528315, -2.222153, -3.746481, 7.0710506, -2.318179, -2.7577329, -0.9337954]
Target sample: 25, Prediction:1, Target's Score:[-1.5476309, 11.535199, -0.5457147, -2.4227464, -1.7779808, -3.7025287, 5.7358193, -2.2022526, -1.6265731, -3.332859]
Target sample: 31, Prediction:1, Target's Score:[-3.5245762, 9.142176, -1.2354276, -2.3067422, -1.3109341, -3.7892005, 8.200938, -3.0274627, 0.069631666, -2.0467477]
Target sample: 37, Prediction:1, Target's Score:[-3.6208398, 10.675833, -0.3590301, -2.5376995, -0.98789185, -3.5671282, 7.133791, -2.9537027, -1.34501, -2.3147242]
Target sample: 43, Prediction:1, Target's Score:[-3.9141757, 13.534688, -1.5266734, -3.7102668, -2.0709796, -3.808977, 7.6475687, -2.792258, -2.449059, -0.7770296]
Target sample: 49, Prediction:1, Target's Score:[-3.1455574, 12.212745, -1.2440319, -3.5519202, -1.3366058, -3.6840925, 7.5506463, -2.404559, -2.4057148, -1.8574251]
Target sample: 55, Prediction:6, Target's Score:[-4.0482326, 8.607728, -1.0489644, -2.457195, -0.7850009, -4.027485, 10.045969, -3.5667894, -1.125327, -1.3922458]
Target sample: 61, Prediction:6, Target's Score:[-4.7148333, 8.17401, -0.88192147, -2.4075298, -0.38708186, -4.0721445, 10.00061, -3.4468286, -0.021674426, -2.0490003]
Target sample: 67, Prediction:6, Target's Score:[-4.6515613, 9.2816, -1.6265059, -3.2694356, -0.66745096, -3.8153186, 9.571003, -3.2888088, 0.29813388, -1.6379135]
Target sample: 73, Prediction:1, Target's Score:[-4.4662547, 10.579743, -1.3816149, -3.3529603, -1.4335759, -3.9326289, 9.482814, -3.3029032, -1.7041014, -0.31046876]
Target sample: 79, Prediction:1, Target's Score:[-3.8537624, 13.336925, -1.2550437, -4.1083055, -1.6059504, -3.2387886, 7.176754, -2.2468243, -2.8166928, -1.276186]
Target sample: 85, Prediction:1, Target's Score:[-2.3984668, 11.401529, -0.3331392, -2.902178, -1.4436386, -3.329445, 6.2947636, -2.711616, -1.797158, -2.6687393]
Target sample: 91, Prediction:1, Target's Score:[-4.0114503, 11.514497, -1.6821612, -4.139931, -2.0216317, -2.4476259, 6.066617, -2.4507663, -2.0399125, 1.3144643]
Target sample: 97, Prediction:1, Target's Score:[-3.5769558, 9.916244, -1.5366863, -3.5460043, -1.1688421, -3.8295965, 8.16944, -2.6417265, -0.9130048, -0.71193933]
Target sample: 103, Prediction:1, Target's Score:[-3.0768461, 13.052333, -2.079457, -3.3902264, -2.1292667, -3.3826077, 6.2765765, -2.4222703, -2.171853, -0.56057644]
Target sample: 109, Prediction:1, Target's Score:[-3.6821141, 13.894741, -1.7701316, -3.762854, -2.3400617, -4.071087, 7.837724, -2.262893, -2.2428532, -1.4598923]
Target sample: 115, Prediction:6, Target's Score:[-4.418845, 4.654076, -0.09774169, -2.1480124, 0.17171623, -3.9468937, 10.437036, -3.6808355, -1.0079044, 0.23301013]
Target sample: 121, Prediction:6, Target's Score:[-5.2176285, 3.4035206, -1.0380921, -1.346096, -0.9191391, -3.9165187, 8.495815, -3.3999362, -0.19593938, 4.279723]
Target sample: 127, Prediction:6, Target's Score:[-5.364535, 2.2484713, -1.1078078, -2.0346825, -0.8200616, -4.0603085, 10.45848, -4.165877, 2.8095222, 2.252356]
Current ATTACK acc on target samples: 40.909
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 00:37:55 Epoch 59, Val iteration 0, acc 92.000 (92.000)
2021-06-13 00:38:05 Epoch 59, Val iteration 19, acc 92.400 (91.700)
* Prec: 91.70000076293945
Per class accuracy =  [0.93047624 0.96302667 0.85318432 0.82375298 0.93988719 0.89191345
 0.96603373 0.90688489 0.94441938 0.95106509]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 6, 1, 6, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 39.25233644859813
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 00:38:17, Val iteration 0, acc 94.800 (94.800)
2021-06-13 00:38:38, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-13 00:38:51, Epoch 0, Iteration 7, loss 0.171 (0.611), acc 94.231 (87.400)
2021-06-13 00:41:31, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:8, Target's Score:[-3.0012934, -1.1954349, -1.8690815, -2.873209, -0.4435569, -4.509502, 6.958343, -2.1330848, 7.724599, 1.6495347]
Target sample: 7, Prediction:6, Target's Score:[-3.5726464, 1.7985679, -1.9813844, -1.8698944, 0.5788536, -3.4465911, 6.8072634, -2.6830761, 1.2353729, 3.4296381]
Target sample: 13, Prediction:6, Target's Score:[-2.9306352, 2.4999423, -0.20759407, -1.9692671, -0.3786894, -3.6684415, 7.1114974, -3.4192846, 0.94545305, 2.3409545]
Target sample: 19, Prediction:1, Target's Score:[-1.2154144, 13.896199, -4.8343134, -2.8587527, -1.8527844, -4.7438984, 2.8713198, -2.5116072, -0.16315506, 1.9340122]
Target sample: 25, Prediction:1, Target's Score:[-0.28571948, 15.664759, -4.444049, -2.4971728, -2.1470454, -5.0641685, 0.80772805, -2.387903, -0.23133837, 1.1350218]
Target sample: 31, Prediction:1, Target's Score:[-0.5199183, 14.647603, -4.520815, -2.6696415, -2.0831416, -5.249379, 1.4960104, -2.2965562, 0.5184419, 1.2061715]
Target sample: 37, Prediction:1, Target's Score:[-1.1121551, 11.584283, -3.8139234, -2.9723167, -1.1257213, -5.264241, 3.1360426, -2.5028553, 0.70283437, 1.844051]
Target sample: 43, Prediction:1, Target's Score:[-0.30162966, 15.093581, -4.4117756, -2.9998727, -2.2688582, -4.7675614, 1.3348947, -2.7232175, -0.27598232, 1.8541527]
Target sample: 49, Prediction:1, Target's Score:[-0.7740656, 13.658704, -4.0693097, -2.8523753, -0.32110077, -5.5869617, 2.8158653, -2.4280686, -0.48380333, 0.5677823]
Target sample: 55, Prediction:6, Target's Score:[-1.390647, 5.089355, -2.7526398, -2.3335445, -0.64490294, -4.78551, 8.726323, -2.10097, -0.40519273, 0.9689889]
Target sample: 61, Prediction:1, Target's Score:[-2.5831919, 7.791237, -3.0686684, -2.2978125, -0.9577055, -4.42293, 4.5165424, -1.6590624, 2.1422656, 0.9243483]
Target sample: 67, Prediction:1, Target's Score:[-2.886118, 5.2970476, -3.1472406, -2.9310515, -1.036204, -2.8737028, 4.8667445, -2.372705, 2.6651552, 2.7614717]
Target sample: 73, Prediction:1, Target's Score:[-1.8526075, 10.211088, -2.8554556, -2.9931371, -1.5162357, -4.358356, 4.726915, -2.6595984, 0.69127274, 1.038978]
Target sample: 79, Prediction:1, Target's Score:[-1.4919896, 14.399194, -4.387843, -3.1622007, -0.93596274, -5.1038938, 2.9680166, -2.6915557, -0.55717564, 1.4995296]
Target sample: 85, Prediction:1, Target's Score:[-0.73952067, 14.089518, -3.7689524, -2.3758953, -2.1037636, -3.9518888, 0.6454638, -3.0665603, -0.5962044, 2.3831072]
Target sample: 91, Prediction:1, Target's Score:[0.46194378, 16.243124, -4.5893745, -3.3981833, -2.6679847, -4.3409557, 0.0075988416, -3.022098, -0.5660518, 2.4247353]
Target sample: 97, Prediction:1, Target's Score:[-0.65453684, 13.460463, -4.395141, -2.950038, -1.6854887, -5.081285, 2.0952387, -2.3229165, 0.54448825, 1.4782362]
Target sample: 103, Prediction:1, Target's Score:[-0.21934998, 15.062039, -4.5595565, -3.0447404, -2.640512, -4.492666, 1.1757547, -2.568259, -0.0085375905, 1.8229418]
Target sample: 109, Prediction:1, Target's Score:[-1.1874725, 14.66483, -3.8616853, -3.0794654, -2.234325, -4.986489, 1.415744, -2.8128521, 0.33513713, 2.2632122]
Target sample: 115, Prediction:6, Target's Score:[-2.351458, 2.715459, -1.9539077, -2.0550492, 0.69827634, -4.6671925, 8.882623, -3.0613248, 0.30162007, 1.8250314]
Target sample: 121, Prediction:9, Target's Score:[-3.8497124, 0.85201854, -1.7743785, -0.7531107, 0.4743938, -4.452464, 4.4716997, -1.9406244, 2.195354, 5.0934515]
Target sample: 127, Prediction:8, Target's Score:[-3.3914824, -0.49138394, -1.208218, -2.4547563, 0.046289336, -3.9261093, 5.7735877, -2.5372775, 6.037577, 2.452926]
Current ATTACK acc on target samples: 18.182
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 00:44:07 Epoch 59, Val iteration 0, acc 94.000 (94.000)
2021-06-13 00:44:28 Epoch 59, Val iteration 19, acc 93.000 (92.760)
* Prec: 92.76000175476074
Per class accuracy =  [0.94409393 0.96530856 0.92141823 0.83261004 0.94258789 0.87390166
 0.96281749 0.92168498 0.95584486 0.95752069]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 6, 8, 8, 8, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 6, 6
ATTACK acc: 20.560747663551403
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 00:44:32, Val iteration 0, acc 92.600 (92.600)
2021-06-13 00:44:38, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-13 00:44:40, Epoch 0, Iteration 7, loss 0.366 (0.334), acc 88.462 (91.000)
2021-06-13 00:45:08, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.9725525, 5.3786807, -3.141412, 3.6946154, -2.7673461, -2.428759, -0.9906378, -4.112783, 1.9073366, 4.861748]
Target sample: 7, Prediction:1, Target's Score:[-1.1957018, 6.455809, 0.37369046, 3.5164235, -4.205229, -1.882625, -1.1063681, -4.481727, -0.81472164, 3.7954316]
Target sample: 13, Prediction:6, Target's Score:[-0.8325391, 1.4150202, -2.8709521, 4.78825, -4.4882636, -1.8170097, 6.6082067, -6.1098976, 0.3690844, 3.3414166]
Target sample: 19, Prediction:1, Target's Score:[-0.6937145, 12.791161, -5.1668005, 2.5226743, -5.228603, -0.9733312, 2.4806473, -5.4663363, -3.3437083, 3.5322516]
Target sample: 25, Prediction:1, Target's Score:[-0.3403868, 13.816894, -4.121328, -0.4518901, -3.9704378, -2.4836571, 1.5609815, -5.9592905, 1.720124, 0.7176316]
Target sample: 31, Prediction:1, Target's Score:[2.8375688, 16.915728, -3.8340359, 0.7201776, -5.808942, -3.121907, -2.37104, -5.964398, -0.07563168, 1.2134349]
Target sample: 37, Prediction:1, Target's Score:[-0.40712708, 14.642932, -4.9197025, 2.4677043, -3.5668855, -1.3286626, -1.6892745, -6.1722255, 1.6625278, -0.15775143]
Target sample: 43, Prediction:1, Target's Score:[-0.20074457, 14.367251, -5.53649, 0.3397038, -1.2276387, 0.5971137, -1.0788376, -5.551269, -1.3541356, 0.16787328]
Target sample: 49, Prediction:1, Target's Score:[0.15118554, 14.019147, -3.4566278, -0.06465684, -3.1351216, -1.093024, 1.5737193, -5.4228945, -3.5267217, 1.4441308]
Target sample: 55, Prediction:1, Target's Score:[-0.9239925, 13.782282, -5.312168, 3.1026604, -5.3394675, -1.7941935, 0.48634905, -6.0769854, -2.5250237, 5.1159096]
Target sample: 61, Prediction:1, Target's Score:[-1.1951993, 8.7071295, -3.347752, 0.9550618, -5.458983, -2.4901056, 2.8734126, -5.4242425, 2.7673166, 3.0442924]
Target sample: 67, Prediction:1, Target's Score:[-2.048749, 9.92912, -4.3639517, 1.3282559, -5.5794835, -0.7214108, 2.950607, -6.494647, 2.7584398, 2.6936953]
Target sample: 73, Prediction:1, Target's Score:[0.90083724, 13.297323, -3.4193451, 3.9175234, -4.901077, -0.8929343, -1.1335918, -7.6147184, -3.0828102, 3.4508255]
Target sample: 79, Prediction:1, Target's Score:[0.610252, 17.854767, -3.4505517, -1.2886372, -5.4234185, -1.9434073, -1.0021363, -5.5360055, -0.73741525, 1.3946335]
Target sample: 85, Prediction:1, Target's Score:[0.52454615, 13.1699505, -4.304711, 1.9120938, -5.8010826, -0.90173364, 1.1390527, -6.541871, 2.1602685, -0.88761944]
Target sample: 91, Prediction:1, Target's Score:[1.2043483, 15.297478, -3.404221, -0.72851044, -5.8226886, -2.7716308, -1.5638784, -5.479841, 2.5456998, 1.1895858]
Target sample: 97, Prediction:1, Target's Score:[0.86550176, 16.219126, -4.8367457, -0.7367499, -5.0011773, -3.2216785, -0.5750485, -5.7015934, 4.128872, -0.64337283]
Target sample: 103, Prediction:1, Target's Score:[-0.42130023, 15.146835, -4.753232, 0.17535467, -5.3658285, -1.7134157, -1.3649546, -4.869538, -2.2017202, 5.856464]
Target sample: 109, Prediction:1, Target's Score:[0.43804196, 11.161787, -5.5653963, 2.9078677, -4.5833106, -2.0486772, 2.033575, -5.1583247, -3.6144059, 4.9044724]
Target sample: 115, Prediction:1, Target's Score:[-0.41919193, 9.270175, -3.236388, 2.8746061, -3.8916862, -3.341365, 0.18036671, -4.9947224, 1.498352, 2.5250888]
Target sample: 121, Prediction:9, Target's Score:[-3.1269314, 0.28692764, -3.122028, 2.9427605, -1.8557373, -2.899045, 1.3859332, -2.7571235, -0.11432259, 9.688167]
Target sample: 127, Prediction:1, Target's Score:[0.72787017, 10.398703, -3.2689097, 3.3101206, -5.555105, -0.9898281, -2.1118224, -6.0111165, -2.0220075, 6.0167017]
Current ATTACK acc on target samples: 4.545
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 00:45:35 Epoch 59, Val iteration 0, acc 89.400 (89.400)
2021-06-13 00:45:42 Epoch 59, Val iteration 19, acc 90.400 (89.440)
* Prec: 89.44000205993652
Per class accuracy =  [0.92659872 0.92363025 0.84481611 0.82675844 0.89223505 0.82500348
 0.93441056 0.89113032 0.92858474 0.94491633]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 9, 3, 9, 9, 1, 3, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 9, 3, 3, 9, 3, 3
ATTACK acc: 0.0
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 00:45:49, Val iteration 0, acc 96.200 (96.200)
2021-06-13 00:46:02, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-13 00:46:08, Epoch 0, Iteration 7, loss 0.883 (0.643), acc 75.000 (83.200)
2021-06-13 00:47:19, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:8, Target's Score:[-2.0291386, 3.5379782, -2.767608, -2.0181952, -2.6560783, -3.3558617, 2.480553, -3.9813995, 11.354663, -0.4466623]
Target sample: 7, Prediction:1, Target's Score:[-2.2483363, 5.2196374, -1.8215652, -1.854715, -1.1003726, -2.8724656, 3.0837488, -2.9748642, 3.377196, 1.2748259]
Target sample: 13, Prediction:1, Target's Score:[-2.1160145, 10.359718, -3.1906335, -2.3221452, -2.7134726, -3.4899771, 7.9650636, -3.280119, -0.5102739, -0.6244359]
Target sample: 19, Prediction:1, Target's Score:[-1.1638944, 12.726089, -3.386644, 0.33385193, -3.6756043, -3.4563513, 3.753232, -3.5841174, -1.4612652, 0.0075597614]
Target sample: 25, Prediction:1, Target's Score:[-1.2390832, 16.504122, -4.376828, -2.757284, -3.5320427, -3.9896183, 1.040723, -3.765543, 1.6096562, 0.61807966]
Target sample: 31, Prediction:1, Target's Score:[0.31700298, 9.942896, -3.1237159, -2.3993788, -3.0746884, -4.3328485, 4.188813, -3.523353, 1.967345, 0.1311544]
Target sample: 37, Prediction:1, Target's Score:[-1.3845081, 12.503935, -2.9871314, -2.441861, -3.2577744, -4.0844116, 2.3476067, -4.1207004, 3.597955, -0.06413509]
Target sample: 43, Prediction:1, Target's Score:[-3.8498309, 16.457693, -3.7217445, -0.21274108, -4.070982, -3.7882347, 2.1362252, -4.005993, -0.5516646, 1.712055]
Target sample: 49, Prediction:1, Target's Score:[-2.6924336, 16.17129, -2.9906497, -2.7767937, -2.5943387, -3.5221984, 1.7895886, -3.2541502, -0.4752556, 0.44211674]
Target sample: 55, Prediction:1, Target's Score:[0.29871085, 8.734526, -4.110511, -0.7693734, -2.34495, -4.396704, 4.78325, -3.7289715, 1.2485849, 0.3723265]
Target sample: 61, Prediction:8, Target's Score:[-2.6397226, 6.110996, -3.5901897, 0.053041816, -1.9970137, -3.3826907, 3.8569915, -3.6808095, 6.5444803, -1.1768686]
Target sample: 67, Prediction:1, Target's Score:[-4.019921, 7.3252397, -3.7834556, -1.1569566, 0.41699666, -3.2493253, 4.0876412, -3.9730115, 5.7365546, -1.2924603]
Target sample: 73, Prediction:1, Target's Score:[-2.4961665, 12.53714, -3.609039, -0.03199798, -2.4238992, -4.049041, 2.9340098, -3.590879, -0.47686243, 1.2984996]
Target sample: 79, Prediction:1, Target's Score:[-2.085407, 15.168455, -3.6446707, -2.552309, -1.6396621, -3.4826694, 1.2090806, -3.6364365, -0.66796196, 1.4309139]
Target sample: 85, Prediction:1, Target's Score:[-2.584864, 16.567734, -3.6123402, -2.341413, -3.9640021, -2.1287286, 0.98711574, -3.6902928, -0.82064354, 1.6991403]
Target sample: 91, Prediction:1, Target's Score:[0.62422746, 13.74996, -3.8541431, -3.2365155, -4.1503353, -2.555881, 1.2000955, -3.4342308, 0.20269419, 1.5851526]
Target sample: 97, Prediction:1, Target's Score:[2.3794727, 9.219641, -3.0920486, -3.6052837, -3.537689, -4.07784, 4.151909, -3.3584769, 1.533637, 0.50893915]
Target sample: 103, Prediction:1, Target's Score:[-1.6122007, 12.834419, -3.771002, -2.1345947, -3.4631085, -2.9471529, 1.3263109, -3.917532, 1.1389527, 2.6513853]
Target sample: 109, Prediction:1, Target's Score:[-2.1778262, 15.357388, -3.0247934, -0.4261588, -4.105495, -3.6933458, 1.4365914, -3.9296942, -0.49936712, 1.1645705]
Target sample: 115, Prediction:1, Target's Score:[-2.2461624, 7.285937, -2.9009364, -1.1974992, -3.0038073, -4.1520047, 4.8242135, -3.6522663, 2.1378984, 2.9985754]
Target sample: 121, Prediction:1, Target's Score:[-3.1342936, 8.336657, -2.7721374, 0.16924572, -2.2082314, -3.9766164, 1.1614927, -3.7598467, 3.102778, 3.1821961]
Target sample: 127, Prediction:8, Target's Score:[-2.635504, 6.4178195, -4.1817636, 0.114806354, -0.2662515, -2.767155, 0.45447433, -3.8364823, 6.515122, 0.28885305]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 00:48:29 Epoch 59, Val iteration 0, acc 93.600 (93.600)
2021-06-13 00:48:42 Epoch 59, Val iteration 19, acc 91.400 (92.150)
* Prec: 92.15000114440917
Per class accuracy =  [0.96311944 0.93971743 0.87353873 0.86366325 0.95138645 0.85580487
 0.96684241 0.89751758 0.96003424 0.94065308]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 8, 8, 8, 6, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 8, 8, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 9, 6, 6, 9, 8, 8, 8, 8, 8, 6, 6
ATTACK acc: 6.542056074766355
--------
------SUMMARY PRE DEFENSE------
TIME ELAPSED (mins): 16
TARGET INDEX: 7
ResNet50 40.90909090909091 39.25233644859813 95.46000137329102 91.70000076293945
DPN92 18.181818181818183 20.560747663551403 95.50000267028808 92.76000175476074
MobileNetV2 4.545454545454546 0.0 91.22000160217286 89.44000205993652
GoogLeNet 0.0 6.542056074766355 95.41000213623047 92.15000114440917
DEFENSE EVALUATION
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
ResNet50
[74, 80, 84, 86, 89] 5
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 00:48:47, Val iteration 0, acc 94.200 (94.200)
2021-06-13 00:48:58, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-13 00:49:00, Epoch 0, Iteration 7, loss 0.184 (0.145), acc 98.077 (97.600)
2021-06-13 00:50:01, Epoch 30, Iteration 7, loss 0.007 (0.024), acc 100.000 (99.200)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:8, Target's Score:[0.4223279, -0.5629051, -1.5531042, -1.1061953, -0.4836058, -2.5689065, -1.3765291, -0.36143383, 6.8619294, 0.82911503]
Target sample: 7, Prediction:8, Target's Score:[-0.27167636, 0.5937214, -0.65396917, -0.5105621, -1.8104836, -2.4913185, -0.39343733, -0.40481687, 5.5689125, 0.44814473]
Target sample: 13, Prediction:1, Target's Score:[-1.6562743, 3.456321, -0.5419698, -0.07273029, -1.707237, -2.0498261, 2.3829906, -1.697479, 1.3052065, 0.64922476]
Target sample: 19, Prediction:1, Target's Score:[-1.6572074, 13.51635, -2.0061684, -2.1238065, -2.8667629, -2.7572713, -0.58485794, -1.9421618, 0.027904058, 0.46069902]
Target sample: 25, Prediction:1, Target's Score:[-0.31155455, 11.802299, -2.0216277, -2.1598065, -2.916863, -2.8819008, -1.1551465, -2.0485168, 2.1605628, -0.40996903]
Target sample: 31, Prediction:1, Target's Score:[-0.38139623, 7.288368, -1.7745249, -1.2110214, -2.508606, -2.652937, -0.9255898, -2.1770751, 5.161187, -0.75611323]
Target sample: 37, Prediction:1, Target's Score:[-0.6053597, 9.635704, -1.9219228, -1.9079729, -2.6067162, -2.596972, -1.1485759, -2.2288575, 3.7394683, -0.29556662]
Target sample: 43, Prediction:1, Target's Score:[-2.107067, 16.94217, -2.7953851, -3.107713, -3.2946744, -3.1794057, -0.711332, -2.536001, 0.24418521, 0.6289274]
Target sample: 49, Prediction:1, Target's Score:[-1.5406193, 12.290345, -1.6940403, -2.1187363, -2.2467961, -2.3346496, -0.5789375, -1.7727479, -0.04598678, 0.09950897]
Target sample: 55, Prediction:1, Target's Score:[-1.1524252, 8.139722, -1.4060357, -1.3149037, -2.01039, -2.2024386, 0.16734906, -1.7487003, 1.2980888, 0.281317]
Target sample: 61, Prediction:1, Target's Score:[-0.5022634, 5.8184037, -1.3146149, -0.9723154, -1.9897501, -2.446713, -0.60570973, -1.4894205, 4.498353, -0.9377005]
Target sample: 67, Prediction:1, Target's Score:[-0.563066, 5.728819, -1.314457, -1.1159939, -1.9480911, -2.180245, -0.47714075, -1.6936606, 4.420806, -0.8067906]
Target sample: 73, Prediction:1, Target's Score:[-1.7152939, 9.856059, -1.4045497, -1.41033, -2.2188709, -2.1803029, -0.019116204, -1.8960618, 0.18829218, 0.8628128]
Target sample: 79, Prediction:1, Target's Score:[-1.9499406, 15.424447, -2.2487571, -2.6489289, -2.9167387, -2.7490242, -1.0768049, -2.1852744, -0.38350785, 0.8095308]
Target sample: 85, Prediction:1, Target's Score:[-1.1598599, 12.5388975, -2.1207328, -2.1151567, -2.4327881, -2.547351, -1.074237, -2.1330047, 0.7955934, 0.31321087]
Target sample: 91, Prediction:1, Target's Score:[-1.3479345, 13.279433, -2.3607311, -2.1850615, -3.0114896, -2.5923767, -1.1457049, -2.4696558, 1.0820587, 0.824238]
Target sample: 97, Prediction:1, Target's Score:[-0.6205643, 9.465723, -2.1890693, -1.7653719, -2.6312313, -2.518143, -1.0223311, -2.283368, 3.0943992, 0.53754985]
Target sample: 103, Prediction:1, Target's Score:[-1.2536217, 11.358149, -2.32581, -1.7794075, -2.7142682, -2.4712734, -0.59286094, -2.168467, 0.94851863, 1.0642091]
Target sample: 109, Prediction:1, Target's Score:[-1.4317551, 11.262505, -1.937566, -1.7127106, -2.591711, -2.4575174, -0.5648338, -1.762639, 0.22466917, 1.0355532]
Target sample: 115, Prediction:1, Target's Score:[-1.5129027, 9.200934, -1.2380084, -1.4595274, -1.9133666, -2.2324998, -0.30766484, -1.6230319, 0.9169464, 0.2277474]
Target sample: 121, Prediction:8, Target's Score:[-0.7695309, 1.5821949, -1.1145282, -0.35968643, 0.86320597, -2.4922888, -1.6063098, -0.033156224, 2.9233792, 1.117883]
Target sample: 127, Prediction:8, Target's Score:[-0.6716876, 2.714959, -1.0713521, -0.5444488, -2.0747297, -2.5221565, -0.07219158, -1.2439271, 5.7420907, -0.18025212]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 00:51:01 Epoch 59, Val iteration 0, acc 89.000 (89.000)
2021-06-13 00:51:11 Epoch 59, Val iteration 19, acc 89.600 (89.490)
* Prec: 89.49000091552735
Per class accuracy =  [0.92646786 0.93619936 0.86800829 0.85992922 0.85017704 0.75374253
 0.92210754 0.95444285 0.96697272 0.91235592]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 8, 8, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 8, 8, 4, 8, 8, 8, 8, 8
ATTACK acc: 0.0
DPN92
[74, 80, 84, 89] 26
Using Adam for retraining
2000
poison index =  86
499
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 00:51:16, Val iteration 0, acc 94.800 (94.800)
2021-06-13 00:51:37, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-13 00:51:42, Epoch 0, Iteration 7, loss 0.406 (0.349), acc 86.538 (91.600)
2021-06-13 00:54:22, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6]
Target sample: 1, Prediction:8, Target's Score:[-1.4944701, -0.34365168, -3.1719456, -3.9539251, -1.0291954, -3.773112, 3.637139, -0.98234916, 11.852056, -0.25523844]
Target sample: 7, Prediction:8, Target's Score:[-2.9472978, 1.4888829, -2.1980817, -2.763375, -0.90115577, -1.9759318, 3.2637806, -1.0678668, 4.82702, 2.6567407]
Target sample: 13, Prediction:1, Target's Score:[-3.1337805, 4.1144238, -1.3269368, -3.6459556, -1.7774405, -1.1427824, 3.843482, -1.6019604, 3.5417943, 1.5375282]
Target sample: 19, Prediction:1, Target's Score:[-1.2467079, 14.59076, -4.195188, -3.7556026, -2.422697, -1.9022985, -0.29537365, -0.640576, 0.40083396, -0.051780574]
Target sample: 25, Prediction:1, Target's Score:[0.575734, 15.891378, -3.9926674, -3.392937, -1.8596911, -2.2625394, -2.5993054, -1.1088581, -0.27633008, -0.50131047]
Target sample: 31, Prediction:1, Target's Score:[0.11346164, 15.169125, -4.0459166, -3.418056, -1.6861086, -2.436485, -2.3457065, -1.234837, 0.5788575, -0.2167305]
Target sample: 37, Prediction:1, Target's Score:[0.3846763, 12.810882, -3.6735127, -4.244645, -1.8487242, -2.5188992, -1.547038, -1.4075168, 2.4889348, 0.031011881]
Target sample: 43, Prediction:1, Target's Score:[-0.08205289, 16.402039, -3.7925613, -4.138622, -1.89873, -1.9127048, -2.760146, -1.2187885, 0.14005642, -0.22611558]
Target sample: 49, Prediction:1, Target's Score:[-0.084541954, 15.545548, -3.24155, -3.8743236, -1.7352694, -2.0490968, -1.9044452, -0.8791403, -0.1977922, -1.0982248]
Target sample: 55, Prediction:1, Target's Score:[-0.18827674, 11.198423, -3.462012, -3.3957329, -2.4623814, -2.046099, 1.2849704, -1.2145584, 0.6763719, 0.022733657]
Target sample: 61, Prediction:1, Target's Score:[-1.9731492, 8.601031, -3.3310707, -3.691221, -1.2974609, -1.9454669, 1.7233763, -0.45028988, 4.8139, -2.020331]
Target sample: 67, Prediction:8, Target's Score:[-2.9862783, 4.98897, -3.169957, -4.2930393, -1.7778232, -1.7523767, 2.7428813, -1.0822698, 7.0496264, 0.73991156]
Target sample: 73, Prediction:1, Target's Score:[-1.72638, 11.49841, -2.3179371, -4.0815835, -1.8229064, -1.3825243, 0.511923, -0.87369287, 2.6207352, -1.9801555]
Target sample: 79, Prediction:1, Target's Score:[-1.8274719, 15.031089, -3.600326, -4.2089567, -1.3298126, -1.633482, -1.0279708, -0.61647534, 0.21149594, -0.50257385]
Target sample: 85, Prediction:1, Target's Score:[0.44330564, 14.527419, -3.1993313, -3.422416, -1.9698641, -1.0233635, -2.7542481, -1.6511756, -0.6578329, 0.16906475]
Target sample: 91, Prediction:1, Target's Score:[0.39434502, 16.3905, -4.005561, -4.3341713, -2.4772973, -1.3037367, -2.9616337, -1.6354581, -1.1734066, 1.6204536]
Target sample: 97, Prediction:1, Target's Score:[0.13669157, 15.372115, -4.2272606, -3.849039, -1.8294134, -2.4409475, -2.2672098, -1.2495722, 1.1368403, -0.29927376]
Target sample: 103, Prediction:1, Target's Score:[0.48623335, 16.156885, -3.8802328, -3.9028604, -2.1335154, -1.6621904, -2.862887, -1.426472, -0.9045705, 0.6245629]
Target sample: 109, Prediction:1, Target's Score:[-0.1314658, 15.567007, -3.3634984, -4.0576553, -2.283734, -1.8534614, -2.340523, -1.4797934, -0.0028541833, 0.42863098]
Target sample: 115, Prediction:1, Target's Score:[-1.1849598, 5.8374896, -2.5635483, -3.737665, -2.1383662, -2.0753236, 2.4319851, -1.8949956, 0.27486256, 5.4541125]
Target sample: 121, Prediction:9, Target's Score:[-1.3996391, 0.51256603, -2.957645, -0.74535394, -0.7614755, -2.876837, 0.07165903, -0.83106494, 2.1801383, 7.145539]
Target sample: 127, Prediction:8, Target's Score:[-1.934023, 1.6860555, -2.4107478, -3.0639656, -1.6781167, -2.0845284, 1.5973094, -1.6424305, 8.554294, 1.3939707]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 00:56:58 Epoch 59, Val iteration 0, acc 93.200 (93.200)
2021-06-13 00:57:19 Epoch 59, Val iteration 19, acc 91.800 (92.890)
* Prec: 92.89000129699707
Per class accuracy =  [0.93894731 0.95502096 0.88748934 0.7912764  0.9304696  0.92524249
 0.96993574 0.94996026 0.97373256 0.96671082]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 8, 1, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 8, 8, 8, 8, 8, 8, 8, 8, 6
ATTACK acc: 1.8691588785046729
MobileNetV2
[80, 84, 89] 45
Using Adam for retraining
2000
poison index =  74
poison index =  86
498
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 00:57:23, Val iteration 0, acc 92.600 (92.600)
2021-06-13 00:57:29, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-13 00:57:30, Epoch 0, Iteration 7, loss 0.330 (0.308), acc 88.462 (91.000)
2021-06-13 00:57:58, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6]
Target sample: 1, Prediction:9, Target's Score:[-0.72392493, 2.5833886, -3.069553, 3.8815007, -2.2597458, -2.7273088, -1.5397054, -3.4422588, 0.6935598, 7.007074]
Target sample: 7, Prediction:1, Target's Score:[-0.37316325, 6.282702, -0.6567817, 3.0574613, -4.3968434, -2.0770943, -1.7343245, -3.756488, -1.5234206, 5.6353097]
Target sample: 13, Prediction:6, Target's Score:[-0.4337214, 2.5607445, -3.2389555, 4.604981, -4.625351, -2.0087407, 5.757467, -6.0115023, -0.93948835, 4.7647986]
Target sample: 19, Prediction:1, Target's Score:[-0.2792957, 15.260588, -5.9660144, 1.7823348, -5.846407, -1.0469977, -0.13743888, -5.331976, -3.7082338, 5.825486]
Target sample: 25, Prediction:1, Target's Score:[0.11550054, 16.395456, -4.389135, -0.16434214, -4.745877, -3.0305903, -0.96057916, -5.806023, -0.07894814, 3.231627]
Target sample: 31, Prediction:1, Target's Score:[3.3404565, 18.752256, -3.9918942, 0.88056564, -6.4651093, -3.276976, -4.7436223, -6.090878, -1.947507, 4.1195087]
Target sample: 37, Prediction:1, Target's Score:[-0.051964488, 17.454962, -5.5982394, 2.1569967, -4.678291, -1.4520509, -3.5873117, -6.3378105, -0.049211707, 2.7286468]
Target sample: 43, Prediction:1, Target's Score:[-0.09460786, 17.939642, -6.189778, -0.3436015, -2.6915703, 0.43846977, -3.1050143, -5.9620924, -2.1476238, 2.777872]
Target sample: 49, Prediction:1, Target's Score:[0.24431935, 17.127121, -4.5483713, -1.0881062, -4.03519, -0.83445907, -1.4930003, -5.2448072, -3.6769793, 4.1552176]
Target sample: 55, Prediction:1, Target's Score:[-0.29472312, 16.492743, -6.0432024, 2.4512265, -6.464668, -2.255366, -1.688154, -6.1150646, -3.1054304, 7.6464343]
Target sample: 61, Prediction:1, Target's Score:[-0.8137292, 10.49008, -3.9911747, 1.0407026, -6.037481, -2.9174693, 0.6849576, -5.6706376, 2.1147952, 5.6186185]
Target sample: 67, Prediction:1, Target's Score:[-1.2385792, 11.280422, -4.836075, 0.80319834, -5.7995725, -1.2889891, 1.2291927, -6.559243, 1.7513809, 5.1850824]
Target sample: 73, Prediction:1, Target's Score:[0.9394868, 13.235727, -3.9571629, 4.6289034, -5.4544096, -1.232217, -1.7414888, -7.750441, -4.036717, 5.9277678]
Target sample: 79, Prediction:1, Target's Score:[0.4383483, 19.995218, -4.3649025, -1.9973302, -6.0549655, -1.5760899, -3.022672, -5.258938, -1.1235089, 3.547446]
Target sample: 85, Prediction:1, Target's Score:[0.8271193, 16.380726, -5.0170813, 1.5734813, -6.516044, -1.191013, -1.1818506, -6.6508408, 0.6495258, 1.6636035]
Target sample: 91, Prediction:1, Target's Score:[1.4080281, 18.398916, -4.1078935, -1.1102593, -6.951906, -3.126415, -3.047154, -5.718792, 1.0228739, 3.7919884]
Target sample: 97, Prediction:1, Target's Score:[0.5969798, 19.874197, -5.5363607, -1.4863667, -5.9301434, -3.1655643, -2.5657575, -5.916365, 2.6302059, 2.092026]
Target sample: 103, Prediction:1, Target's Score:[0.28661048, 16.376438, -5.412799, 0.2016223, -5.5525146, -2.1549225, -3.7060502, -4.7380753, -3.6770267, 8.991847]
Target sample: 109, Prediction:1, Target's Score:[0.61624736, 13.294657, -6.447209, 2.6498723, -5.3101788, -2.314165, -0.3459095, -4.7349696, -3.9626267, 7.116995]
Target sample: 115, Prediction:1, Target's Score:[-0.49515757, 10.036959, -4.0433326, 2.845552, -3.9540012, -3.6504848, -0.9357023, -4.8700757, 0.6481195, 4.9275923]
Target sample: 121, Prediction:9, Target's Score:[-2.0544882, 0.877243, -3.450056, 2.9525783, -2.05741, -2.6778507, 0.6056541, -3.2673748, -0.44807816, 9.9646845]
Target sample: 127, Prediction:1, Target's Score:[0.9340846, 9.437766, -3.8717077, 3.199775, -6.86166, -1.1820773, -1.3269224, -6.0009694, -2.6648612, 8.863188]
Current ATTACK acc on target samples: 4.545
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 00:58:26 Epoch 59, Val iteration 0, acc 89.200 (89.200)
2021-06-13 00:58:32 Epoch 59, Val iteration 19, acc 89.800 (89.520)
* Prec: 89.52000160217285
Per class accuracy =  [0.92136298 0.93143542 0.84541895 0.82772588 0.88673871 0.82689737
 0.93661239 0.89271487 0.9281397  0.94896004]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 9, 3, 9, 9, 9, 3, 9, 3, 9, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 9, 9, 9, 9, 9, 3, 3
ATTACK acc: 0.0
GoogLeNet
[74, 80, 84, 86, 89] 23
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 00:58:35, Val iteration 0, acc 96.200 (96.200)
2021-06-13 00:58:48, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-13 00:58:50, Epoch 0, Iteration 7, loss 1.093 (0.965), acc 67.308 (78.800)
2021-06-13 01:00:01, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:8, Target's Score:[-2.0049574, 5.846504, -2.5458705, 0.40914124, -2.2948697, -3.443717, -1.2422596, -3.8559198, 9.561461, -0.48195714]
Target sample: 7, Prediction:1, Target's Score:[-1.8051199, 4.7676964, -0.47000003, 0.4811237, -2.0110924, -1.9625757, 0.39650658, -2.3412356, 2.6252491, 0.28617328]
Target sample: 13, Prediction:1, Target's Score:[-2.8976865, 9.354073, -2.1736307, 2.2042797, -3.1104827, -2.8846066, 1.8616318, -2.636553, -0.11540598, 0.38289005]
Target sample: 19, Prediction:1, Target's Score:[-1.3415087, 12.525275, -3.177166, 3.2224991, -3.4450145, -2.8906107, -1.7877939, -3.1286924, -0.505016, 0.5293943]
Target sample: 25, Prediction:1, Target's Score:[-1.5402555, 16.989666, -4.0149727, 0.10389615, -4.0722723, -3.6601315, -2.3185987, -3.2782166, 0.25351924, 1.5286407]
Target sample: 31, Prediction:1, Target's Score:[-0.5891758, 12.713463, -3.0577042, 1.10312, -3.6536767, -3.907721, -1.4096075, -3.315603, 0.9170072, 1.1897194]
Target sample: 37, Prediction:1, Target's Score:[-2.153964, 12.909586, -3.8689406, 0.7790773, -3.9204755, -3.779386, -1.5797682, -3.782933, 4.724988, 0.64186937]
Target sample: 43, Prediction:1, Target's Score:[-2.7289793, 16.073984, -3.3631067, 2.0435483, -4.441737, -2.7343578, -1.7820716, -3.4807687, -1.455558, 1.8658288]
Target sample: 49, Prediction:1, Target's Score:[-2.7708173, 15.330733, -2.3109984, 1.729673, -4.1795883, -3.0780907, -1.685283, -2.2477818, -1.2503302, 0.45580536]
Target sample: 55, Prediction:1, Target's Score:[-1.0055598, 10.226695, -2.9246929, 0.75051516, -2.6842773, -3.09829, 0.35603812, -2.211727, 0.5017773, 0.072565496]
Target sample: 61, Prediction:1, Target's Score:[-3.6162164, 8.782274, -2.2086008, 1.7193495, -2.6810741, -2.6760237, -0.37510422, -3.3027854, 5.4406977, -1.1200544]
Target sample: 67, Prediction:1, Target's Score:[-3.6353369, 9.706482, -2.3495026, 1.6947795, -0.27495152, -3.4789436, 0.08352289, -3.7321305, 3.039386, -1.0931095]
Target sample: 73, Prediction:1, Target's Score:[-2.9514337, 11.613484, -2.1555295, 1.4110258, -3.254903, -2.9873352, -0.25925654, -2.161811, -1.1536392, 1.8912181]
Target sample: 79, Prediction:1, Target's Score:[-2.570002, 12.69687, -2.579816, 2.3564584, -3.1304338, -2.4352496, -2.1916866, -3.1158125, -1.325498, 2.2937849]
Target sample: 85, Prediction:1, Target's Score:[-2.115107, 16.822153, -4.4061007, 0.2382223, -4.4385443, -0.8642547, -2.2484682, -3.4431846, -1.9371706, 2.376901]
Target sample: 91, Prediction:1, Target's Score:[0.18294424, 15.471984, -3.7888572, -0.8801457, -4.413714, -2.3395865, -2.2993882, -3.4421878, -1.3945152, 2.8886032]
Target sample: 97, Prediction:1, Target's Score:[0.30365998, 13.039077, -3.6522424, -1.4481003, -3.9010296, -2.611275, -1.122808, -3.20495, 0.4250906, 2.1552556]
Target sample: 103, Prediction:1, Target's Score:[-1.4107722, 12.043354, -3.1965287, 0.149957, -3.8098366, -2.116389, -2.123717, -3.0085044, 1.337794, 2.1220503]
Target sample: 109, Prediction:1, Target's Score:[-2.969588, 15.695014, -2.6834104, 2.2217484, -4.221828, -3.0424604, -2.7802932, -3.3460004, -0.8258473, 1.9541172]
Target sample: 115, Prediction:1, Target's Score:[-2.489059, 8.5403185, -2.0272794, 1.7818627, -2.9520686, -3.0996397, -0.5963638, -3.1851838, 1.4347098, 2.5849369]
Target sample: 121, Prediction:1, Target's Score:[-3.5034165, 8.493739, -2.4960344, 2.952978, -2.378792, -2.3654578, -1.3779087, -3.1058075, 1.558327, 2.2113774]
Target sample: 127, Prediction:1, Target's Score:[-3.0376103, 7.8869495, -2.123915, 0.46472126, -0.8320461, -0.9427752, -1.0968415, -3.4266553, 2.199541, 0.8748585]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 01:01:10 Epoch 59, Val iteration 0, acc 92.800 (92.800)
2021-06-13 01:01:23 Epoch 59, Val iteration 19, acc 92.000 (92.230)
* Prec: 92.23000221252441
Per class accuracy =  [0.94384749 0.96217692 0.88210748 0.81274658 0.94531511 0.89792695
 0.94362022 0.931192   0.95651529 0.94719945]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 8, 8, 1, 8, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 8, 1, 8, 1, 1, 1, 8, 1, 8, 8
ATTACK acc: 0.0
------SUMMARY POST DEFENSE------
TIME ELAPSED (mins): 16
TARGET INDEX: 7
ResNet50 0.0 0.0 95.46000137329102 89.49000091552735 100.0
DPN92 0.0 1.8691588785046729 95.50000267028808 92.89000129699707 80.0
MobileNetV2 4.545454545454546 0.0 91.22000160217286 89.52000160217285 60.0
GoogLeNet 0.0 0.0 95.41000213623047 92.23000221252441 100.0
True False False False False
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.300-droplayer0.000.t7
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
No specific indices are determined, so try to include whatever we find
In total, we found 170 images of target 8
All target indices used in crafting poisons: [1, 6, 11, 16, 21, 26, 31, 36, 41, 46, 51, 56, 61, 66, 71, 76, 81, 86, 91, 96, 101, 106, 111, 116, 121, 126, 131, 136, 141, 146, 151, 156, 161, 166]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', eval_poisons_root='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=False, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=8, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/8/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 6, 11, 16, 21, 26, 31, 36, 41, 46, 51, 56, 61, 66, 71, 76, 81, 86, 91, 96, 101, 106, 111, 116, 121, 126, 131, 136, 141, 146, 151, 156, 161, 166]
# Targets: 34, # Poisons: 5
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-13 01:01:44 Iteration 0 	 Training Loss: 9.314e-01 	 Loss in Target Net: 2.167e+00	  
 2021-06-13 01:02:51 Iteration 50 	 Training Loss: 1.850e-01 	 Loss in Target Net: 2.027e-01	  
 2021-06-13 01:03:52 Iteration 100 	 Training Loss: 1.569e-01 	 Loss in Target Net: 1.874e-01	  
 2021-06-13 01:04:52 Iteration 150 	 Training Loss: 1.535e-01 	 Loss in Target Net: 2.211e-01	  
 2021-06-13 01:05:47 Iteration 200 	 Training Loss: 1.516e-01 	 Loss in Target Net: 2.320e-01	  
 2021-06-13 01:06:55 Iteration 250 	 Training Loss: 1.446e-01 	 Loss in Target Net: 2.255e-01	  
 2021-06-13 01:07:55 Iteration 300 	 Training Loss: 1.461e-01 	 Loss in Target Net: 2.153e-01	  
 2021-06-13 01:08:51 Iteration 350 	 Training Loss: 1.507e-01 	 Loss in Target Net: 2.362e-01	  
 2021-06-13 01:09:48 Iteration 400 	 Training Loss: 1.371e-01 	 Loss in Target Net: 2.246e-01	  
 2021-06-13 01:10:45 Iteration 450 	 Training Loss: 1.416e-01 	 Loss in Target Net: 2.134e-01	  
 2021-06-13 01:11:43 Iteration 500 	 Training Loss: 1.462e-01 	 Loss in Target Net: 2.208e-01	  
 2021-06-13 01:12:46 Iteration 550 	 Training Loss: 1.364e-01 	 Loss in Target Net: 2.124e-01	  
 2021-06-13 01:13:44 Iteration 600 	 Training Loss: 1.410e-01 	 Loss in Target Net: 1.989e-01	  
 2021-06-13 01:14:40 Iteration 650 	 Training Loss: 1.439e-01 	 Loss in Target Net: 2.293e-01	  
 2021-06-13 01:15:39 Iteration 700 	 Training Loss: 1.447e-01 	 Loss in Target Net: 2.171e-01	  
 2021-06-13 01:16:37 Iteration 750 	 Training Loss: 1.433e-01 	 Loss in Target Net: 2.142e-01	  
 2021-06-13 01:17:42 Iteration 800 	 Training Loss: 1.354e-01 	 Loss in Target Net: 2.079e-01	  
 2021-06-13 01:18:41 Iteration 850 	 Training Loss: 1.372e-01 	 Loss in Target Net: 2.274e-01	  
 2021-06-13 01:19:36 Iteration 900 	 Training Loss: 1.386e-01 	 Loss in Target Net: 2.361e-01	  
 2021-06-13 01:20:31 Iteration 950 	 Training Loss: 1.376e-01 	 Loss in Target Net: 2.302e-01	  
 2021-06-13 01:21:26 Iteration 999 	 Training Loss: 1.407e-01 	 Loss in Target Net: 2.831e-01	  
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 01:21:31, Val iteration 0, acc 94.200 (94.200)
2021-06-13 01:21:41, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-13 01:21:46, Epoch 0, Iteration 7, loss 0.175 (0.430), acc 96.154 (90.000)
2021-06-13 01:22:47, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-3.2423658, 7.3894844, -1.4535065, -1.5867189, -2.5940819, -2.5750308, 8.515025, -2.835426, 0.6000144, -2.0770462]
Target sample: 6, Prediction:6, Target's Score:[-2.890235, 5.7615137, -0.6954529, -1.6082038, -0.07877682, -2.764275, 7.3673844, -2.9110594, 0.0004622033, -2.0585103]
Target sample: 11, Prediction:1, Target's Score:[-3.8528304, 8.823028, -1.304094, -1.8791496, -2.1959379, -2.569311, 7.5518064, -3.3682134, -1.3084558, 0.2296177]
Target sample: 16, Prediction:6, Target's Score:[-2.4981413, 4.6558623, -0.4382746, -1.1085664, -1.3523221, -2.7243526, 8.6947565, -3.1186597, -0.65854853, -1.2973835]
Target sample: 21, Prediction:1, Target's Score:[-3.9283834, 12.785938, -1.8920623, -2.2711935, -2.229002, -3.0724466, 7.102723, -3.3210177, -2.2354267, -0.82527465]
Target sample: 26, Prediction:1, Target's Score:[-3.0465298, 12.214648, -1.7672331, -2.129603, -2.5411303, -2.8290894, 5.699264, -3.2761319, -2.6158354, 0.39372447]
Target sample: 31, Prediction:1, Target's Score:[-3.7473292, 13.322814, -1.8851713, -1.105578, -3.0917718, -3.0600464, 5.9220085, -3.373403, -2.3037388, -0.58205193]
Target sample: 36, Prediction:1, Target's Score:[-3.8532014, 13.544351, -1.9538561, -2.3874774, -3.1282887, -3.125322, 5.5099115, -3.3547833, -2.1457052, 0.9885585]
Target sample: 41, Prediction:1, Target's Score:[-3.7013001, 12.367684, -2.1097925, -1.2142682, -2.7961783, -2.8954394, 5.3958893, -3.30536, -1.4235084, -0.2261025]
Target sample: 46, Prediction:1, Target's Score:[-0.23374106, 5.934633, -1.8947276, -1.6505529, -1.3106886, -2.7249007, 4.8215857, -1.9988043, 1.8163943, -2.6522791]
Target sample: 51, Prediction:1, Target's Score:[-1.7153631, 7.868976, -1.7128096, -1.7339729, -1.3951645, -2.713933, 5.1245694, -2.6673365, 1.5949188, -2.5516717]
Target sample: 56, Prediction:1, Target's Score:[-1.5333996, 7.6079717, -1.8619614, -1.6411278, -1.7760557, -2.8375406, 5.2448153, -2.625975, 2.829533, -3.3068707]
Target sample: 61, Prediction:1, Target's Score:[-2.6956458, 10.024569, -1.511678, -1.9798294, -2.253814, -2.621392, 5.9798317, -2.4046764, 0.575013, -3.0214927]
Target sample: 66, Prediction:1, Target's Score:[-3.6898158, 12.819917, -1.6781472, -2.0378041, -3.0191398, -3.1251373, 6.886459, -3.2148573, -0.82429945, -2.0173001]
Target sample: 71, Prediction:1, Target's Score:[-3.361442, 11.332371, -1.4958857, -0.9303495, -2.4217558, -2.9105039, 6.489255, -3.132556, -0.99087256, -2.480968]
Target sample: 76, Prediction:1, Target's Score:[-3.4666984, 12.063709, -1.4385524, -1.8330039, -2.8174334, -2.9188833, 6.237699, -3.2700014, -1.6838046, -0.77607054]
Target sample: 81, Prediction:1, Target's Score:[-4.1167493, 11.169777, -0.858686, -2.1417475, -2.3038373, -3.0880334, 8.190631, -3.3197525, -1.8323436, -1.5793058]
Target sample: 86, Prediction:6, Target's Score:[-3.286994, 5.5577564, -0.32677394, -1.7156719, -1.4905441, -3.0045104, 9.556451, -2.7083793, 0.07517329, -2.504871]
Target sample: 91, Prediction:1, Target's Score:[-3.0365503, 7.1287107, -0.9952271, -0.3057299, -2.0424576, -2.6688857, 7.0304575, -2.5862806, 0.04742518, -2.455832]
Target sample: 96, Prediction:1, Target's Score:[-3.897163, 12.830399, -1.8353446, -2.163923, -2.4765236, -2.8778317, 5.8371315, -2.8368287, -1.7317344, -0.76288533]
Target sample: 101, Prediction:1, Target's Score:[-3.1884756, 10.233552, -0.8884642, -2.263314, -1.8201945, -3.017714, 6.9063845, -2.2475495, -1.4405316, -2.168354]
Target sample: 106, Prediction:1, Target's Score:[-4.177874, 10.399156, -1.3318347, -2.049774, -2.5017471, -3.1844563, 8.995294, -3.5582097, -1.629472, -0.8195123]
Target sample: 111, Prediction:1, Target's Score:[-3.4174638, 14.352413, -2.0496752, -2.3712153, -3.4361618, -3.0204175, 6.3237195, -3.11045, -1.8314916, -1.3426164]
Target sample: 116, Prediction:1, Target's Score:[-3.7371368, 14.761552, -2.3099504, -2.5114295, -3.4285855, -3.0405934, 6.0561366, -2.9848685, -0.9729436, -1.7452378]
Target sample: 121, Prediction:1, Target's Score:[-3.184873, 15.977924, -2.8877366, -2.700676, -3.8844073, -2.9679894, 4.825231, -2.8335907, -1.2650263, -1.0009508]
Target sample: 126, Prediction:1, Target's Score:[-2.853112, 10.265551, -2.3601024, -2.1319897, -2.0908988, -2.5727997, 5.753532, -2.7205164, 0.6651841, -1.8579564]
Target sample: 131, Prediction:1, Target's Score:[-1.6370717, 6.317821, -1.8232203, -1.6505772, -0.5111395, -2.5869608, 5.824498, -2.0284307, 1.7152774, -3.518683]
Target sample: 136, Prediction:6, Target's Score:[-0.82653946, 4.6701097, -1.627993, -1.4314277, -2.0900457, -2.497726, 4.969153, -2.68167, 3.6277122, -1.997953]
Target sample: 141, Prediction:1, Target's Score:[-0.47696847, 5.667327, -2.1158812, -1.7237841, -2.574795, -2.5529706, 3.8191006, -2.848071, 3.349473, -0.43754154]
Target sample: 146, Prediction:1, Target's Score:[-3.876417, 13.588029, -2.071906, -2.5134192, -3.3295667, -2.9873543, 6.2666087, -3.5013287, -1.7913644, 0.31969547]
Target sample: 151, Prediction:1, Target's Score:[-3.5336199, 13.941549, -2.0439591, -2.420526, -3.1557698, -3.099695, 6.1544037, -3.3351567, -1.5278635, -0.8842653]
Target sample: 156, Prediction:1, Target's Score:[-2.876146, 11.295186, -1.337499, -2.1920776, -3.1075494, -3.1003792, 6.05589, -3.4239237, -1.9929688, 0.79139143]
Target sample: 161, Prediction:6, Target's Score:[-3.8813462, 7.629496, -0.33911166, -1.8378153, -1.8265238, -2.8957255, 8.592899, -3.8047717, -1.4994737, 0.0067098755]
Target sample: 166, Prediction:6, Target's Score:[-3.9273298, 7.9632583, -1.470913, -1.681373, -2.4133775, -2.6749861, 9.200415, -3.3126764, -0.95821387, -0.5745235]
Current ATTACK acc on target samples: 20.588
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 01:23:47 Epoch 59, Val iteration 0, acc 91.400 (91.400)
2021-06-13 01:23:57 Epoch 59, Val iteration 19, acc 92.000 (91.160)
* Prec: 91.16000099182129
Per class accuracy =  [0.93870246 0.95008523 0.81378564 0.85400663 0.91760981 0.85622171
 0.96477931 0.92757068 0.96203918 0.93194378]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 6, 6, 6, 1
ATTACK acc: 16.91176470588235
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 01:24:09, Val iteration 0, acc 94.800 (94.800)
2021-06-13 01:24:30, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-13 01:24:43, Epoch 0, Iteration 7, loss 0.973 (0.453), acc 76.923 (90.600)
2021-06-13 01:27:23, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.8173907, 4.541845, -2.634188, -1.0280461, -2.2942977, -1.0031167, 4.3067784, -0.86933255, 3.150464, -2.034944]
Target sample: 6, Prediction:8, Target's Score:[-2.2962265, 4.4664893, -3.9660566, -2.3955812, -1.0610188, -2.1596472, 1.8209089, -1.4551014, 8.735546, -1.3336658]
Target sample: 11, Prediction:1, Target's Score:[-1.5660763, 5.9796486, -3.7478359, -2.312919, -2.4268398, -1.6347721, 4.1031313, -1.6622534, 4.7004943, -1.0769514]
Target sample: 16, Prediction:6, Target's Score:[-1.6260227, 2.945634, -2.7866414, -2.1627686, -1.9728234, -1.4945507, 6.1752443, -2.1377783, 2.8448846, 0.56305784]
Target sample: 21, Prediction:1, Target's Score:[-0.29681385, 13.841362, -2.9527507, -3.726233, -3.2609541, -1.3813392, 0.09811293, -2.0664463, 0.86098135, -0.64819354]
Target sample: 26, Prediction:1, Target's Score:[-0.57845783, 13.281356, -3.2505653, -3.3427103, -3.5959392, -1.9084941, 0.04333912, -2.26866, 0.64885414, 1.4332328]
Target sample: 31, Prediction:1, Target's Score:[-0.7056811, 15.847822, -3.4115257, -3.8413908, -4.248105, -1.6512431, -0.1652401, -2.2724316, 1.734442, -0.7602949]
Target sample: 36, Prediction:1, Target's Score:[-0.005769155, 15.02156, -3.553108, -3.6895626, -4.2684097, -2.1820202, 0.56112957, -2.1508982, 0.9873241, -0.20743309]
Target sample: 41, Prediction:1, Target's Score:[-0.67557764, 14.729579, -3.2898164, -3.4955351, -4.1592, -2.1379714, 0.3172083, -2.142696, 1.348226, 0.0019497983]
Target sample: 46, Prediction:1, Target's Score:[-0.66911185, 11.733853, -3.650909, -3.531912, -3.135272, -2.4927464, 0.97527206, -1.8264135, 3.5652378, -0.5298284]
Target sample: 51, Prediction:1, Target's Score:[-1.5480362, 13.27504, -3.1569533, -3.4703238, -3.2410088, -2.0478992, 0.1477449, -1.4071314, 3.5798006, -1.6799136]
Target sample: 56, Prediction:1, Target's Score:[-0.82347214, 13.222461, -3.474025, -3.7253625, -3.0321393, -2.326913, 0.13012885, -1.7583704, 3.640008, -1.4009309]
Target sample: 61, Prediction:1, Target's Score:[-0.94464934, 14.221537, -3.0708911, -3.8774147, -3.558473, -2.1962583, -0.115808085, -2.0246615, 4.1947384, -2.1469371]
Target sample: 66, Prediction:1, Target's Score:[-1.0459034, 14.859766, -3.14196, -3.6926286, -3.9231968, -1.9664862, 0.9345422, -1.8249106, 2.56239, -2.2696953]
Target sample: 71, Prediction:1, Target's Score:[-0.78324807, 12.375945, -3.2681592, -3.5835743, -2.4619577, -2.063607, 1.7995149, -1.9641391, 2.830796, -2.442998]
Target sample: 76, Prediction:1, Target's Score:[-0.8815288, 13.956735, -3.1000395, -3.4119546, -3.5044298, -1.9364791, 0.92837876, -1.7539248, 2.1601746, -1.9860498]
Target sample: 81, Prediction:1, Target's Score:[0.507363, 10.111839, -2.2170942, -3.047746, -1.6632347, -2.2034075, 2.4147158, -2.1318731, 0.5913696, -1.9458091]
Target sample: 86, Prediction:6, Target's Score:[-0.6624274, 3.0805936, -2.331791, -1.7009654, 0.20820716, -1.946326, 6.064357, -1.036322, 2.1541681, -3.506692]
Target sample: 91, Prediction:1, Target's Score:[-0.9756439, 7.357958, -3.4161239, -1.9757925, -2.6249993, -1.4719454, 3.551754, -0.56057274, 4.253601, -3.7822528]
Target sample: 96, Prediction:1, Target's Score:[-1.1091235, 10.810537, -3.2031646, -2.6270485, -2.5130181, -1.822785, 2.3795598, -1.4429054, 2.1275938, -2.2028396]
Target sample: 101, Prediction:1, Target's Score:[0.04784334, 9.171379, -3.24055, -3.097428, -2.374502, -1.8523463, 3.3409674, -1.3355297, 1.7565372, -2.0100412]
Target sample: 106, Prediction:1, Target's Score:[-0.14416113, 9.9921255, -3.0432246, -3.091206, -3.837255, -2.2069561, 4.2418785, -2.530712, 0.5808309, 0.4907993]
Target sample: 111, Prediction:1, Target's Score:[-0.5265299, 14.188359, -2.4785995, -3.7411356, -3.3358958, -2.0789373, 0.7672106, -2.082404, 1.5688272, -1.8088508]
Target sample: 116, Prediction:1, Target's Score:[-1.1317487, 12.970651, -2.3408203, -3.5916877, -2.5737872, -1.5492234, 1.138262, -1.7856348, 1.4480166, -2.12874]
Target sample: 121, Prediction:1, Target's Score:[-0.78567415, 16.046587, -3.2081852, -3.8379831, -3.852483, -1.7183757, -0.13448748, -2.544932, 1.2084262, -0.6516924]
Target sample: 126, Prediction:1, Target's Score:[-1.3351738, 12.419572, -3.7640164, -3.371759, -3.15569, -1.951473, 0.46158183, -2.3268719, 3.2242868, 0.25270247]
Target sample: 131, Prediction:1, Target's Score:[-1.3977519, 9.145724, -3.3963375, -3.052786, -2.227962, -2.2260046, 1.9668629, -1.947012, 4.3505354, -0.8171184]
Target sample: 136, Prediction:1, Target's Score:[-0.9703899, 12.353413, -3.8343678, -3.2581048, -3.857841, -2.0752141, 2.0363855, -2.185789, 2.489672, -0.24168535]
Target sample: 141, Prediction:1, Target's Score:[-0.7628726, 9.49074, -4.482777, -3.3056924, -3.2148366, -2.801014, 1.0057857, -2.4475849, 5.616391, 1.3499563]
Target sample: 146, Prediction:1, Target's Score:[-0.56274605, 13.517411, -3.6039753, -3.3294206, -4.273121, -2.147741, 1.8512611, -2.5352955, 1.3237687, 0.2513014]
Target sample: 151, Prediction:1, Target's Score:[-0.6089976, 13.860833, -3.456445, -3.4999158, -3.9415061, -2.449444, 0.8402085, -2.453845, 2.0834358, 0.11237515]
Target sample: 156, Prediction:1, Target's Score:[-0.8592847, 11.8101425, -2.3157854, -2.9237518, -3.4206614, -1.6364472, 1.5714618, -1.9233187, 1.7902567, -1.6720197]
Target sample: 161, Prediction:1, Target's Score:[-0.92589635, 5.156054, -2.6300097, -2.3812857, -1.0956371, -1.4842697, 4.36182, -1.3876281, 2.3634338, -1.6532278]
Target sample: 166, Prediction:1, Target's Score:[-2.224311, 7.089583, -4.4755864, -2.4190078, -3.0905757, -1.8028351, 2.588774, -2.4872675, 4.2440357, 3.0058591]
Current ATTACK acc on target samples: 5.882
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 01:29:59 Epoch 59, Val iteration 0, acc 93.200 (93.200)
2021-06-13 01:30:20 Epoch 59, Val iteration 19, acc 93.200 (92.990)
* Prec: 92.99000129699706
Per class accuracy =  [0.94738844 0.96809733 0.90311228 0.85683676 0.93733476 0.87076769
 0.95530803 0.93676066 0.96582533 0.95802299]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 8, 8, 8, 1, 1, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 6, 1, 8, 8, 8, 8
ATTACK acc: 10.294117647058824
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 01:30:24, Val iteration 0, acc 92.600 (92.600)
2021-06-13 01:30:30, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-13 01:30:32, Epoch 0, Iteration 7, loss 0.266 (0.368), acc 92.308 (89.400)
2021-06-13 01:31:00, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.2887335, 5.060979, -0.6979971, 3.2735062, -4.375893, -1.4417472, 5.3219924, -5.8151426, -1.0679847, 2.1399786]
Target sample: 6, Prediction:1, Target's Score:[0.07505673, 9.529461, -1.6307472, 0.5387008, -3.7663836, -3.6808574, -1.028595, -4.742107, -2.713882, 7.546901]
Target sample: 11, Prediction:1, Target's Score:[-1.4247379, 12.138224, -3.6151476, 2.840928, -5.5754395, -2.073439, -1.2053646, -4.117711, -3.3730612, 6.5356636]
Target sample: 16, Prediction:1, Target's Score:[3.0963805, 7.0953255, 1.7248658, 2.876615, -3.8626525, -3.4429069, 1.9570603, -5.930937, -3.7512302, 0.36654788]
Target sample: 21, Prediction:1, Target's Score:[0.5252762, 8.140918, 1.9414673, 2.7754912, -2.7225485, -4.515375, 4.011517, -4.5127907, -1.603171, -3.8848336]
Target sample: 26, Prediction:1, Target's Score:[1.0344568, 15.205144, -2.9437506, 0.74324805, -5.9378757, -3.344224, 2.2991629, -4.6817455, -3.0760703, 0.8459407]
Target sample: 31, Prediction:1, Target's Score:[-0.020406552, 20.701708, -4.190512, -0.9890188, -6.185059, -2.663337, -1.6275752, -4.7082796, -0.46993542, 0.34735686]
Target sample: 36, Prediction:1, Target's Score:[-1.3061962, 18.411884, -4.8309565, -1.1789883, -5.8152723, -3.11727, 2.2224329, -4.561508, -0.098709226, 0.44672382]
Target sample: 41, Prediction:1, Target's Score:[-1.6432031, 16.944998, -5.395288, 0.76384175, -4.967918, -1.897933, 0.41100213, -5.101411, -0.77007854, 1.8206825]
Target sample: 46, Prediction:1, Target's Score:[-0.63362813, 12.181824, -5.019523, 1.365428, -0.48359695, -3.3995583, -1.4992095, -3.1294699, 0.3426153, 0.44012883]
Target sample: 51, Prediction:1, Target's Score:[-2.164199, 14.2824955, -5.468169, 0.5264417, -3.2699673, -1.2164223, -0.16084075, -4.7431192, 2.8320622, -0.44590384]
Target sample: 56, Prediction:1, Target's Score:[-1.3922209, 13.447962, -5.0649447, 2.082965, -1.9248997, -2.3805933, -0.013124146, -4.182937, 0.1339917, -0.53501517]
Target sample: 61, Prediction:1, Target's Score:[0.63845766, 13.959075, -5.510045, 2.1934323, -0.9914387, -2.5550752, -1.9698293, -5.104486, -0.3820887, -0.10335042]
Target sample: 66, Prediction:1, Target's Score:[-1.1236919, 16.483728, -5.663917, 1.1538389, -5.398609, -2.7782588, 1.6350201, -5.3066955, 0.20356524, 0.9531275]
Target sample: 71, Prediction:1, Target's Score:[1.3291162, 9.944616, -2.7374392, 1.3959286, 2.5524263, -4.7572317, -1.8094333, -3.5350425, 0.82788426, -3.0276384]
Target sample: 76, Prediction:1, Target's Score:[0.20056495, 17.192924, -4.134133, 1.1690518, -4.93614, -3.0704007, 1.5518357, -6.426852, -2.961647, 1.5752115]
Target sample: 81, Prediction:1, Target's Score:[3.240798, 15.199249, -2.738657, 1.3802295, -5.3200636, -3.7442288, -1.6168439, -6.1632147, -1.4125428, 1.3320942]
Target sample: 86, Prediction:1, Target's Score:[1.0750105, 10.768495, -2.0957096, -0.29066235, -3.7326458, -3.7810872, 1.9123311, -3.9818962, 0.073170945, 0.18304351]
Target sample: 91, Prediction:1, Target's Score:[0.07768394, 13.748852, -4.1241274, -0.023480967, -6.209906, -1.5163903, 2.2949395, -5.7973557, 1.3925446, 0.29989788]
Target sample: 96, Prediction:1, Target's Score:[-1.5328346, 16.444012, -5.783486, -0.48651838, -5.6202307, -0.86820406, 1.4958853, -5.129695, -1.5416394, 3.1704094]
Target sample: 101, Prediction:1, Target's Score:[1.3106807, 14.130959, -2.8104198, -0.47520304, -5.8759212, -3.004722, 1.6809608, -5.207403, 0.22108465, 0.17363036]
Target sample: 106, Prediction:1, Target's Score:[-0.74517167, 13.848795, -3.033626, -0.89355886, -6.2538605, -3.533626, 5.4622073, -4.975205, -0.089476496, 0.34981704]
Target sample: 111, Prediction:1, Target's Score:[0.5829755, 14.472699, -2.4213357, -0.2944196, -5.3508925, -4.0274982, 2.6460712, -4.833734, -0.21498771, -0.41048443]
Target sample: 116, Prediction:1, Target's Score:[0.22536612, 17.486046, -3.1092818, -0.55369306, -5.1724386, -4.258925, 1.5890398, -5.263644, -0.30796343, -0.4597969]
Target sample: 121, Prediction:1, Target's Score:[1.2773329, 16.208206, -3.9334579, -1.0248166, -4.485376, -4.0211153, -0.52193946, -4.037777, 1.4358616, -0.72642565]
Target sample: 126, Prediction:1, Target's Score:[0.41983375, 12.971487, -4.4341726, 0.61637264, -3.312112, -3.8209648, 2.0939612, -4.6599336, 2.4289584, -2.1496148]
Target sample: 131, Prediction:1, Target's Score:[0.1300821, 12.082809, -4.0894623, -1.6240085, 2.6188505, -3.434008, -2.7246177, -1.7264464, -0.42835313, -0.6160444]
Target sample: 136, Prediction:1, Target's Score:[-0.73508763, 12.590833, -5.0492992, 0.7040293, -4.6529636, -2.3367424, 1.8471403, -4.818033, 0.900771, 1.681801]
Target sample: 141, Prediction:1, Target's Score:[1.270866, 9.042626, -3.844181, 3.2999225, -3.243686, -2.675347, -1.3711561, -4.6955447, -2.9153693, 5.2569723]
Target sample: 146, Prediction:1, Target's Score:[-0.4525973, 17.168297, -3.8889105, 0.066070214, -4.87049, -3.4909763, -1.1429653, -4.161851, -1.6258464, 2.5740986]
Target sample: 151, Prediction:1, Target's Score:[0.24623445, 15.728055, -3.7921052, -1.3727076, -5.1847844, -3.564175, 2.265731, -5.1244917, -1.5056967, 2.4475946]
Target sample: 156, Prediction:1, Target's Score:[1.5418853, 10.791975, -2.269629, 1.3907474, -6.21226, -3.491563, 2.3436701, -5.27218, -4.0938773, 5.3928394]
Target sample: 161, Prediction:3, Target's Score:[1.6269177, 2.8594482, 1.0240659, 3.360457, 0.72568756, -3.5750751, 3.278764, -4.162453, -3.1432884, -1.8702159]
Target sample: 166, Prediction:9, Target's Score:[-2.7874038, 7.321619, -4.3611593, 1.8532782, -4.5226936, -1.9914314, 4.3021293, -5.582353, -3.6187444, 9.484865]
Current ATTACK acc on target samples: 2.941
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 01:31:27 Epoch 59, Val iteration 0, acc 89.200 (89.200)
2021-06-13 01:31:33 Epoch 59, Val iteration 19, acc 90.000 (89.380)
* Prec: 89.38000183105468
Per class accuracy =  [0.92043127 0.92273202 0.83578844 0.82673396 0.8930448  0.82908368
 0.93698986 0.88782154 0.93295541 0.94767402]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 9, 1, 1, 9, 1, 1, 1, 1, 3, 3, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 9, 9, 9
ATTACK acc: 0.7352941176470589
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 01:31:41, Val iteration 0, acc 96.200 (96.200)
2021-06-13 01:31:54, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-13 01:32:00, Epoch 0, Iteration 7, loss 0.431 (0.946), acc 90.385 (76.400)
2021-06-13 01:33:11, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.9112475, 9.7571945, -3.204483, -0.9423249, -3.0502598, -3.8588734, 5.461469, -2.6680336, 1.9505275, -1.522186]
Target sample: 6, Prediction:1, Target's Score:[-1.7800218, 8.220684, -1.1576245, -3.0384617, -2.6617424, -4.9013395, 3.2967782, -3.2266119, 4.3825336, 0.8680816]
Target sample: 11, Prediction:1, Target's Score:[-2.4667423, 9.4512415, -1.4624729, -4.0428443, -2.8280332, -2.9674525, 4.8176293, -3.271617, 2.8974166, -0.12086384]
Target sample: 16, Prediction:6, Target's Score:[-1.6013508, 7.920731, -3.0301902, -3.5793927, -2.6209888, -2.8845968, 8.129192, -3.0653195, 0.33595264, 0.42225286]
Target sample: 21, Prediction:1, Target's Score:[-1.6341605, 16.933193, -2.6818366, -4.5248756, -2.7352202, -3.5876837, 3.3255239, -3.664378, -1.3187388, -0.07944326]
Target sample: 26, Prediction:1, Target's Score:[-1.7272505, 19.907711, -2.5759916, -4.858786, -3.9381797, -4.5061045, 2.1545894, -3.6962848, -1.122159, 0.391947]
Target sample: 31, Prediction:1, Target's Score:[-2.018058, 21.925692, -2.5190892, -4.160676, -4.7170944, -4.6015134, 0.86786824, -3.9896655, -1.3686514, 0.6114833]
Target sample: 36, Prediction:1, Target's Score:[-1.5370197, 17.580225, -2.405418, -3.8634717, -4.1466503, -4.458068, 0.70360106, -4.3132, -0.56755644, 3.039336]
Target sample: 41, Prediction:1, Target's Score:[-1.8564643, 16.331774, -3.403218, -3.5360634, -3.4737267, -5.040167, 2.080625, -4.583768, 1.518212, 1.981019]
Target sample: 46, Prediction:1, Target's Score:[0.99263793, 11.039916, -2.566933, -3.3347056, -1.3750879, -5.563866, 0.7169141, -3.936488, 4.69878, -0.66383123]
Target sample: 51, Prediction:1, Target's Score:[-1.6458228, 11.706895, -3.0462387, -3.5321705, -1.812875, -5.3227654, 2.1983182, -4.3721304, 7.5466194, -1.7404227]
Target sample: 56, Prediction:1, Target's Score:[0.90869385, 13.57541, -2.657365, -3.1031508, -1.888173, -5.4251223, 0.82464045, -4.231631, 2.3695667, -0.35209802]
Target sample: 61, Prediction:1, Target's Score:[0.16013162, 15.128533, -2.7153225, -2.493345, -2.0519245, -5.348135, 0.5826496, -4.4365983, 1.5183667, -0.32273856]
Target sample: 66, Prediction:1, Target's Score:[-1.0877919, 16.23101, -3.726816, -0.804766, -3.3579063, -5.4332404, 1.4126045, -4.5739427, 0.75071174, 0.6086362]
Target sample: 71, Prediction:1, Target's Score:[-0.020346712, 13.491714, -3.2892096, -2.0468256, -1.8593228, -5.057464, 2.7024443, -4.228593, 1.9958246, -1.672515]
Target sample: 76, Prediction:1, Target's Score:[-0.20372589, 16.064697, -3.4818318, -2.575091, -2.4200437, -4.1212225, 2.8631084, -3.9601986, -1.7172434, -0.4091387]
Target sample: 81, Prediction:1, Target's Score:[-0.04090799, 12.77828, -2.8648698, -3.6592512, -0.9709286, -4.634085, 4.5245223, -3.710621, -0.6031421, -0.7836798]
Target sample: 86, Prediction:6, Target's Score:[-0.76764476, 4.3435345, -1.3896241, -3.1603887, -2.1860826, -3.441329, 7.7329597, -2.811004, 4.7639503, -3.0828736]
Target sample: 91, Prediction:1, Target's Score:[-1.126173, 8.976859, -2.081505, -3.6874232, -3.0742967, -3.9735794, 4.3591356, -3.493984, 6.834241, -2.7461884]
Target sample: 96, Prediction:1, Target's Score:[-0.2105961, 9.415631, -2.5662675, -3.3518598, -2.244974, -3.3760118, 4.9241357, -2.9822068, 2.3655016, -1.9575844]
Target sample: 101, Prediction:1, Target's Score:[-0.6147749, 10.942394, -1.9806902, -4.4494405, -1.1210041, -4.0155215, 3.2846122, -3.24692, 2.41887, -1.2043762]
Target sample: 106, Prediction:1, Target's Score:[-1.8653667, 10.595544, -2.4763587, -3.7798128, -3.2252512, -3.5430715, 7.994343, -4.0337677, 1.0616218, -0.7109892]
Target sample: 111, Prediction:1, Target's Score:[-0.92960423, 16.1713, -2.7721882, -3.3388047, -2.2545602, -4.5229945, 2.6210797, -4.2847137, -0.7065341, 0.045798495]
Target sample: 116, Prediction:1, Target's Score:[-1.257188, 14.1199875, -2.7384312, -2.3625047, -2.2391126, -4.445038, 3.4299605, -4.1141887, 0.6201276, -0.99446243]
Target sample: 121, Prediction:1, Target's Score:[0.551562, 13.68296, -3.8636904, -2.8468647, -2.3068547, -4.993502, 0.99965817, -4.8825355, 1.0910615, 2.5990322]
Target sample: 126, Prediction:1, Target's Score:[-1.0397547, 14.187793, -3.5893993, -2.4935675, -1.3096503, -5.5528708, 0.48920357, -4.8209934, 4.2128987, -0.08237152]
Target sample: 131, Prediction:1, Target's Score:[-0.905525, 8.731072, -1.9153475, -2.7758296, -1.3527017, -4.5465846, 2.2957716, -4.766115, 6.111821, -0.8835571]
Target sample: 136, Prediction:1, Target's Score:[-0.6959866, 12.186257, -3.589722, -2.470005, -2.1925447, -4.889844, 1.5014536, -4.478165, 4.8315144, -0.20224075]
Target sample: 141, Prediction:1, Target's Score:[0.20911233, 12.63651, -3.151156, -3.085916, -2.9942272, -4.8476768, 1.311978, -3.8805594, 3.6594446, 0.15093048]
Target sample: 146, Prediction:1, Target's Score:[-0.81224024, 11.536872, -1.5212204, -0.58922803, -3.85015, -4.036036, 3.3160377, -4.4659133, -0.5953122, 1.0482221]
Target sample: 151, Prediction:1, Target's Score:[-0.40593505, 15.7329645, -2.0767896, -2.9575267, -3.5787392, -4.2911754, 2.5976617, -4.1138268, -0.95010155, 0.07777114]
Target sample: 156, Prediction:1, Target's Score:[-0.996251, 16.257214, -1.415607, -3.5205486, -3.8650455, -4.492573, 3.0081127, -3.4145174, -1.7431846, 0.22009344]
Target sample: 161, Prediction:1, Target's Score:[-2.629318, 6.8670187, 0.18605676, -2.898893, 0.21684681, -2.5372114, 6.414431, -3.9506156, -0.04028302, -1.6080662]
Target sample: 166, Prediction:6, Target's Score:[-1.9784448, 7.399985, -2.480367, -1.9685321, -3.011282, -4.177465, 8.100039, -3.0101385, 0.7362493, 0.41357657]
Current ATTACK acc on target samples: 8.824
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 01:34:21 Epoch 59, Val iteration 0, acc 93.000 (93.000)
2021-06-13 01:34:34 Epoch 59, Val iteration 19, acc 94.400 (92.770)
* Prec: 92.77000160217285
Per class accuracy =  [0.93327195 0.93515059 0.87378876 0.84804896 0.96466995 0.91471675
 0.95755537 0.93560309 0.94807716 0.9642508 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 6, 6, 1, 1, 1, 1, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 8, 8, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 1, 1, 1, 1, 1
ATTACK acc: 8.823529411764707
--------
------SUMMARY PRE DEFENSE------
TIME ELAPSED (mins): 19
TARGET INDEX: 8
ResNet50 20.58823529411765 16.91176470588235 95.46000137329102 91.16000099182129
DPN92 5.882352941176471 10.294117647058824 95.50000267028808 92.99000129699706
MobileNetV2 2.9411764705882355 0.7352941176470589 91.22000160217286 89.38000183105468
GoogLeNet 8.823529411764707 8.823529411764707 95.41000213623047 92.77000160217285
DEFENSE EVALUATION
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
ResNet50
[74, 80, 84, 86, 89] 5
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 01:34:39, Val iteration 0, acc 94.200 (94.200)
2021-06-13 01:34:50, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-13 01:34:52, Epoch 0, Iteration 7, loss 0.114 (0.286), acc 98.077 (93.600)
2021-06-13 01:35:53, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-1.2663271, 14.235383, -2.9277143, -0.5982604, -4.2765174, -2.6134965, -1.6037531, -2.3405042, -0.94513625, 2.6077473]
Target sample: 6, Prediction:1, Target's Score:[-1.737824, 10.131294, -2.1065426, -0.45481998, -0.19693619, -2.6069975, -2.0149162, -2.3142862, -1.6561869, 3.2308238]
Target sample: 11, Prediction:1, Target's Score:[-3.0710344, 12.229868, -1.5247641, -0.72792745, -2.866917, -3.0537083, -1.5703237, -2.4750228, -2.8241706, 6.1969314]
Target sample: 16, Prediction:1, Target's Score:[-2.5433366, 8.223599, -0.6534038, 0.5167319, -3.0023236, -2.8385108, -0.048003837, -2.269043, -1.8737122, 4.7705293]
Target sample: 21, Prediction:1, Target's Score:[-2.4316304, 16.283619, -1.9126447, -0.3081364, -4.091916, -3.2879088, -1.5822741, -3.3562255, -1.9063612, 2.9066064]
Target sample: 26, Prediction:1, Target's Score:[-1.8941758, 15.36267, -2.083018, -0.6401732, -4.1849155, -3.087078, -2.1299236, -3.064912, -2.5361338, 4.581292]
Target sample: 31, Prediction:1, Target's Score:[-3.0302026, 20.871252, -2.2700286, -1.7201906, -5.1877427, -4.191754, -2.0557032, -3.586643, -2.1189015, 3.646026]
Target sample: 36, Prediction:1, Target's Score:[-2.8412628, 19.523766, -2.2999423, -1.4861102, -5.08073, -4.225204, -2.460548, -3.5827532, -1.9982908, 4.814574]
Target sample: 41, Prediction:1, Target's Score:[-1.7035443, 18.451124, -2.7629209, -1.1282129, -5.0705724, -3.7462623, -2.2472682, -3.5586977, 0.06047152, 2.0121903]
Target sample: 46, Prediction:1, Target's Score:[1.0564795, 9.864041, -2.619624, -1.0578066, -3.4827976, -2.7768624, -1.8279603, -2.501101, 4.77246, -1.2488378]
Target sample: 51, Prediction:1, Target's Score:[0.48925522, 13.142742, -2.4314492, -0.9328507, -4.381419, -3.4296534, -2.0104287, -3.1408422, 4.9641905, -2.0544596]
Target sample: 56, Prediction:1, Target's Score:[1.1189976, 13.575055, -2.9572763, -1.6589406, -4.592888, -3.626929, -1.7896975, -3.1340642, 5.695842, -2.4275317]
Target sample: 61, Prediction:1, Target's Score:[-1.0838088, 20.429321, -3.371341, -2.394946, -5.6332264, -3.9888508, -1.9380803, -3.4817855, 1.9533954, -0.20991309]
Target sample: 66, Prediction:1, Target's Score:[-1.6548223, 24.400715, -3.6820586, -2.7802012, -6.496692, -4.904739, -2.2544985, -3.9590993, 0.9006521, 0.7673564]
Target sample: 71, Prediction:1, Target's Score:[-1.9057876, 20.468552, -2.928646, -1.0910808, -5.4410486, -3.949562, -1.9956659, -3.538649, -0.3836228, 1.0840986]
Target sample: 76, Prediction:1, Target's Score:[-1.9661944, 19.830126, -3.20225, -1.6940242, -5.096816, -3.7355793, -2.0679955, -3.3255572, -0.9401739, 2.5187726]
Target sample: 81, Prediction:1, Target's Score:[-0.6403505, 17.582909, -3.2388577, -2.0733104, -4.0665913, -3.6412432, -1.4721345, -3.0152106, -0.30725756, 1.146112]
Target sample: 86, Prediction:1, Target's Score:[-0.6237298, 14.862299, -2.8238933, -0.9591277, -4.2519207, -3.2856555, -1.4689419, -2.355281, 0.28296328, 0.86851203]
Target sample: 91, Prediction:1, Target's Score:[-0.43162546, 16.476168, -3.2367792, 0.116668314, -5.133429, -3.2268867, -2.1326387, -2.8953085, 0.26077572, 0.48263913]
Target sample: 96, Prediction:1, Target's Score:[-2.3902757, 20.312973, -3.4042625, -1.5317222, -5.1720605, -3.7670023, -2.321515, -3.0505025, -1.6284609, 3.2962682]
Target sample: 101, Prediction:1, Target's Score:[-0.49274066, 17.196688, -2.1226027, -1.7113394, -4.2225437, -3.8731635, -1.7553992, -2.7731924, -0.37186226, 0.3934963]
Target sample: 106, Prediction:1, Target's Score:[-1.9872113, 17.979168, -2.8474233, -1.650418, -4.734916, -3.8704884, -1.1182516, -3.238738, -0.41299254, 2.1714842]
Target sample: 111, Prediction:1, Target's Score:[-1.2133294, 19.616148, -2.8305848, -1.7118787, -5.0305, -3.8782108, -1.8643024, -3.4730606, -0.6839835, 1.3631676]
Target sample: 116, Prediction:1, Target's Score:[-2.422573, 23.716787, -3.3844013, -2.7938988, -5.9801764, -4.7610254, -1.8134614, -3.7853923, -0.07870184, 1.637196]
Target sample: 121, Prediction:1, Target's Score:[-2.0227833, 23.081623, -3.6637938, -2.695123, -5.846578, -4.3096833, -2.3860242, -3.8216538, -1.0542685, 3.0753193]
Target sample: 126, Prediction:1, Target's Score:[-1.0370617, 14.297399, -2.9852483, -0.83583134, -3.8434389, -3.160704, -1.8980215, -3.1297708, 2.1760101, 0.66152185]
Target sample: 131, Prediction:1, Target's Score:[-0.890221, 14.351616, -2.4136329, -1.2490679, -3.76321, -3.3906264, -1.4987227, -2.7095194, 2.6005285, -0.82481974]
Target sample: 136, Prediction:1, Target's Score:[0.36316875, 11.0034, -2.6861546, -0.3914877, -4.320717, -2.9213686, -1.8169813, -3.0970852, 6.012342, -1.9365882]
Target sample: 141, Prediction:1, Target's Score:[-0.57341224, 11.141022, -2.7971892, -0.82973623, -3.9454572, -2.9078064, -2.0462143, -2.8484235, 3.581851, 1.4514933]
Target sample: 146, Prediction:1, Target's Score:[-2.8783097, 18.165716, -2.648352, -1.6040373, -4.9284716, -3.6905394, -2.158599, -3.3735485, -1.4963394, 4.955619]
Target sample: 151, Prediction:1, Target's Score:[-2.1978805, 17.494928, -2.4969578, -0.91280305, -4.7548265, -3.5972447, -2.2156045, -3.209274, -1.2193848, 3.420161]
Target sample: 156, Prediction:1, Target's Score:[-2.1335316, 13.153743, -1.6015894, 0.8089281, -3.808685, -2.9422488, -2.4424045, -2.992521, -2.434924, 4.711726]
Target sample: 161, Prediction:1, Target's Score:[-3.2010517, 9.129356, -0.5536849, 0.47220367, -2.5157816, -2.8506925, -1.1306958, -2.9007702, -2.8381355, 6.7154336]
Target sample: 166, Prediction:1, Target's Score:[-2.476862, 12.586466, -2.4639583, 0.56158274, -3.8124356, -2.420084, -1.4848093, -2.686868, -1.8838671, 4.376211]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 01:36:53 Epoch 59, Val iteration 0, acc 90.800 (90.800)
2021-06-13 01:37:03 Epoch 59, Val iteration 19, acc 93.000 (92.030)
* Prec: 92.03000183105469
Per class accuracy =  [0.93112616 0.93252597 0.82430711 0.89424821 0.92228951 0.88600782
 0.9652794  0.95269009 0.94453138 0.95081397]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
DPN92
[74, 80, 84, 86, 89] 27
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 01:37:08, Val iteration 0, acc 94.800 (94.800)
2021-06-13 01:37:29, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-13 01:37:34, Epoch 0, Iteration 7, loss 0.166 (0.413), acc 94.231 (91.600)
2021-06-13 01:40:14, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[0.40928793, 13.046145, -3.6624577, -1.097045, -4.288482, -3.348958, -1.475506, -1.9993273, 2.084508, 0.8538763]
Target sample: 6, Prediction:1, Target's Score:[-0.7988985, 12.610758, -3.536418, -2.5855646, -2.4152699, -3.5322375, -0.90528786, -2.4385653, 4.4479113, -0.32626456]
Target sample: 11, Prediction:1, Target's Score:[-0.3640382, 12.737279, -3.883711, -2.8646805, -2.9863386, -3.4156783, -0.8830658, -2.2270281, 2.9566255, 1.4274669]
Target sample: 16, Prediction:1, Target's Score:[-0.8679179, 8.173709, -3.235714, -3.0788605, -3.3419662, -3.4935107, 0.075093694, -2.5193722, 5.014274, 3.7517216]
Target sample: 21, Prediction:1, Target's Score:[1.3094002, 17.202816, -3.9278297, -3.4134595, -4.1257696, -3.4944, -1.8596936, -2.8457668, 1.3786887, 0.36387968]
Target sample: 26, Prediction:1, Target's Score:[0.90354794, 16.23328, -4.014716, -3.1997752, -4.113683, -3.4657507, -1.8336917, -2.869972, 1.2132405, 1.713726]
Target sample: 31, Prediction:1, Target's Score:[1.299125, 19.07929, -4.4253635, -3.696847, -4.634432, -3.9778414, -2.0919857, -3.5037234, 2.3352056, 0.2558639]
Target sample: 36, Prediction:1, Target's Score:[1.7260076, 18.50456, -4.3663673, -3.3428874, -4.617801, -3.8888981, -2.1682863, -3.249814, 1.635036, 0.39413005]
Target sample: 41, Prediction:1, Target's Score:[1.3647752, 17.574003, -4.2776256, -3.159661, -4.4501386, -3.7240803, -1.9290607, -2.9819932, 1.8874325, 0.29597038]
Target sample: 46, Prediction:1, Target's Score:[1.3953042, 15.826044, -4.18905, -2.903013, -4.144066, -3.8226366, -1.6602008, -2.509009, 2.624899, -0.059834808]
Target sample: 51, Prediction:1, Target's Score:[0.61777496, 16.382214, -3.9936075, -3.0302935, -4.0101523, -3.6489172, -1.3842146, -2.7334301, 3.413707, -1.0432855]
Target sample: 56, Prediction:1, Target's Score:[1.3033968, 17.360132, -4.165858, -3.3381157, -4.413154, -3.8949733, -1.6782324, -2.9353294, 3.183814, -0.8302375]
Target sample: 61, Prediction:1, Target's Score:[1.4524343, 18.345087, -4.1604567, -3.6477783, -4.5872183, -3.9866004, -1.764, -3.3888311, 3.497993, -1.1349506]
Target sample: 66, Prediction:1, Target's Score:[1.2433032, 19.495508, -4.3412147, -3.6167345, -4.6993237, -4.0455966, -1.6835413, -3.300517, 2.6450953, -1.0408529]
Target sample: 71, Prediction:1, Target's Score:[1.2081472, 17.562658, -3.855552, -3.4527292, -4.2189336, -3.808297, -1.3193517, -3.0933306, 2.9561565, -1.3756675]
Target sample: 76, Prediction:1, Target's Score:[1.2304811, 17.908363, -4.127708, -3.1534588, -4.382652, -3.7853394, -1.6805494, -2.8775268, 2.2703574, -0.7868681]
Target sample: 81, Prediction:1, Target's Score:[1.72091, 16.161102, -3.5208364, -3.218072, -3.6013124, -3.6958375, -1.6192684, -3.052612, 1.4960374, -0.09395864]
Target sample: 86, Prediction:1, Target's Score:[1.0255212, 13.563084, -3.1564074, -2.6140969, -3.3829017, -3.2750158, -0.973265, -0.8089792, 1.8123258, -1.6580597]
Target sample: 91, Prediction:1, Target's Score:[1.4241413, 15.653239, -3.8990326, -2.559482, -4.48313, -3.6208172, -1.3789458, -2.1377015, 2.6183276, -1.0459125]
Target sample: 96, Prediction:1, Target's Score:[1.0651215, 16.610498, -4.080786, -2.691021, -4.1177664, -3.5139434, -1.6373401, -2.5049336, 1.6502692, -0.207618]
Target sample: 101, Prediction:1, Target's Score:[1.1370041, 14.904556, -3.7075565, -3.0533066, -3.6541066, -3.2707107, -1.4976258, -2.2201371, 1.7797912, 0.124682724]
Target sample: 106, Prediction:1, Target's Score:[1.6553032, 14.027971, -4.0106263, -3.1867154, -4.2900844, -3.7569838, -1.1638368, -2.9566345, 1.6516534, 2.581567]
Target sample: 111, Prediction:1, Target's Score:[1.73021, 18.497667, -4.0811625, -3.566077, -4.259441, -3.9481032, -1.9463679, -3.3822727, 1.8415073, -0.2551635]
Target sample: 116, Prediction:1, Target's Score:[0.8256214, 17.466951, -3.7099829, -3.7015593, -3.5927963, -3.6104095, -1.4667491, -2.8845313, 2.2064705, -0.9299606]
Target sample: 121, Prediction:1, Target's Score:[1.5765316, 19.76982, -4.573229, -3.636811, -4.6383758, -3.9804425, -2.3762634, -3.587788, 1.6128473, 0.49451232]
Target sample: 126, Prediction:1, Target's Score:[0.81392807, 16.71348, -4.2047467, -2.8647919, -4.17053, -3.7050223, -1.7909648, -3.0166774, 2.8738205, -0.06695116]
Target sample: 131, Prediction:1, Target's Score:[0.31074765, 14.45336, -3.4796271, -2.7870343, -3.4670973, -3.648738, -1.1723768, -2.5454469, 4.025644, -1.1642038]
Target sample: 136, Prediction:1, Target's Score:[1.1249851, 16.412302, -4.3756657, -2.5679936, -4.4549356, -3.8699462, -1.6223658, -3.0051455, 2.534485, 0.3936125]
Target sample: 141, Prediction:1, Target's Score:[1.3748478, 13.694032, -4.103977, -3.0953617, -4.5058064, -4.743659, -1.5830405, -3.4696412, 5.996676, 1.0064048]
Target sample: 146, Prediction:1, Target's Score:[1.643419, 17.3998, -4.3613873, -2.987525, -4.645755, -4.0528026, -1.9025555, -3.3096118, 1.9133737, 0.90290904]
Target sample: 151, Prediction:1, Target's Score:[1.6127125, 16.239447, -4.196479, -2.9235752, -4.2921543, -3.8660834, -1.994476, -3.1182446, 1.8870077, 1.2239608]
Target sample: 156, Prediction:1, Target's Score:[1.102094, 15.676095, -3.5965486, -2.5864103, -4.086708, -3.4820185, -1.5404809, -2.8414323, 2.4261503, -0.51437795]
Target sample: 161, Prediction:1, Target's Score:[-0.05987423, 11.43337, -2.6724854, -2.725827, -2.525865, -3.068544, -0.80037224, -1.5041152, 2.4134092, -0.021012664]
Target sample: 166, Prediction:1, Target's Score:[0.11130229, 9.720623, -4.392031, -2.141995, -3.8161435, -3.609973, -1.9227917, -3.216122, 2.0629148, 7.726814]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 01:42:49 Epoch 59, Val iteration 0, acc 93.200 (93.200)
2021-06-13 01:43:10 Epoch 59, Val iteration 19, acc 93.200 (93.410)
* Prec: 93.41000137329101
Per class accuracy =  [0.95401264 0.9794823  0.89427751 0.84485552 0.95546045 0.90299579
 0.95404956 0.9335982  0.9688018  0.95963487]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
MobileNetV2
[74, 80, 84, 86, 89] 47
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 01:43:14, Val iteration 0, acc 92.600 (92.600)
2021-06-13 01:43:19, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-13 01:43:20, Epoch 0, Iteration 7, loss 0.283 (0.286), acc 90.385 (89.600)
2021-06-13 01:43:48, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-1.1535268, 8.076062, -1.3738431, 2.5744781, -4.438751, -2.450873, 0.67055553, -4.590286, -0.18457592, 3.4358246]
Target sample: 6, Prediction:1, Target's Score:[0.98971075, 11.158785, -2.2056718, 0.16832963, -3.9478076, -4.382261, -4.3377786, -3.8225334, -1.7782117, 8.807789]
Target sample: 11, Prediction:1, Target's Score:[-0.63536304, 13.747534, -3.890384, 2.202611, -5.9169645, -2.1122122, -5.0211625, -3.1256454, -2.4290257, 7.8444514]
Target sample: 16, Prediction:1, Target's Score:[4.1185513, 11.134576, 0.24801081, 1.50535, -5.092738, -4.0022454, -1.865842, -5.139936, -2.525567, 2.2296531]
Target sample: 21, Prediction:1, Target's Score:[1.9429816, 14.141897, 0.313677, 1.0240062, -4.309244, -5.2630253, -2.1482847, -3.7338219, 0.3998905, -1.7095823]
Target sample: 26, Prediction:1, Target's Score:[2.2700553, 19.368198, -3.7692287, -0.6871227, -6.355898, -4.018673, -3.391054, -3.7248209, -1.8070146, 2.8425498]
Target sample: 31, Prediction:1, Target's Score:[1.6743509, 25.014597, -4.7343683, -2.1586027, -6.6765075, -3.6292443, -6.586521, -4.5988073, 0.4055601, 2.152346]
Target sample: 36, Prediction:1, Target's Score:[0.67734295, 23.737286, -5.1138678, -2.6598995, -6.692668, -4.1759753, -4.249283, -4.2777724, 0.9369997, 2.653893]
Target sample: 41, Prediction:1, Target's Score:[-0.16220209, 21.690472, -5.7497563, -0.8169074, -5.74189, -2.4672358, -5.2061777, -4.6272855, 0.12953985, 3.7579234]
Target sample: 46, Prediction:1, Target's Score:[1.0605613, 17.21417, -5.496224, -0.36052817, -2.052841, -3.7340376, -6.0092683, -3.0053787, 1.2043624, 1.9100592]
Target sample: 51, Prediction:1, Target's Score:[-0.10840037, 19.707962, -5.585176, -0.90143573, -4.1610475, -2.3647606, -6.0197606, -4.3963866, 3.3305976, 1.2700711]
Target sample: 56, Prediction:1, Target's Score:[0.28084326, 18.924002, -5.4325113, 0.07845482, -2.753274, -3.3792255, -5.661272, -3.4360514, 0.7931981, 1.3674856]
Target sample: 61, Prediction:1, Target's Score:[2.4140105, 18.838465, -5.7429276, 0.6051635, -2.792772, -3.1639805, -6.7519636, -5.1031985, 0.6321221, 1.8457063]
Target sample: 66, Prediction:1, Target's Score:[0.4524529, 21.71874, -6.173174, -0.4669046, -6.5395613, -3.8084855, -4.472188, -4.9105334, 1.7746547, 3.2313762]
Target sample: 71, Prediction:1, Target's Score:[2.8073575, 15.862536, -3.3668406, -0.40285298, -0.48129416, -5.2686453, -5.8938813, -3.713136, 1.8622609, -0.6850969]
Target sample: 76, Prediction:1, Target's Score:[1.6928757, 22.33899, -5.197797, -0.6126771, -5.9741573, -3.8008313, -4.5660157, -5.79201, -0.97076154, 3.7060053]
Target sample: 81, Prediction:1, Target's Score:[4.4521513, 19.640312, -3.9686031, -0.030020684, -6.325523, -4.536235, -5.8212385, -5.9185324, -0.05528636, 3.3265915]
Target sample: 86, Prediction:1, Target's Score:[2.4682937, 15.253888, -3.4176025, -1.3291788, -4.7189355, -4.528527, -3.3835762, -3.2069223, 1.6360432, 1.8618294]
Target sample: 91, Prediction:1, Target's Score:[0.9552072, 18.11482, -4.97992, -1.3011022, -6.557015, -2.5454502, -2.7365603, -5.3479075, 2.9083793, 2.2127078]
Target sample: 96, Prediction:1, Target's Score:[-0.10241113, 20.263977, -6.3055353, -1.6810325, -6.1093946, -2.2503116, -3.1814277, -4.476164, -0.13403428, 4.7464814]
Target sample: 101, Prediction:1, Target's Score:[2.7369957, 18.073053, -3.8613992, -1.4491243, -6.3672442, -3.8876185, -3.5311863, -4.4321094, 1.5161862, 1.8854553]
Target sample: 106, Prediction:1, Target's Score:[0.71054554, 19.234926, -4.428867, -2.1101398, -7.019895, -4.5507154, -1.469879, -3.9010346, 1.527688, 2.7322862]
Target sample: 111, Prediction:1, Target's Score:[2.3948748, 19.740036, -3.692245, -1.5618374, -6.1679807, -5.050228, -3.3007624, -4.5531435, 1.2440512, 1.680602]
Target sample: 116, Prediction:1, Target's Score:[1.7757702, 22.955206, -4.141369, -2.04721, -6.132415, -5.197252, -4.157143, -5.063539, 0.8892915, 1.9409014]
Target sample: 121, Prediction:1, Target's Score:[2.4702272, 20.686043, -4.7441063, -2.157085, -5.4606695, -4.8100247, -5.10401, -3.791739, 2.2671843, 1.4040723]
Target sample: 126, Prediction:1, Target's Score:[2.3205955, 17.24291, -4.6641335, -0.815428, -3.961076, -4.846421, -3.8060923, -4.4017997, 3.81408, -0.17624022]
Target sample: 131, Prediction:1, Target's Score:[1.5278199, 15.994322, -4.6163883, -2.826006, 1.5847042, -3.9630497, -6.1103578, -1.7619232, 0.09428932, 0.80469847]
Target sample: 136, Prediction:1, Target's Score:[0.89616114, 17.705732, -5.316014, -0.94353795, -5.474494, -3.2583954, -3.6499968, -4.3516808, 1.5545487, 3.5462937]
Target sample: 141, Prediction:1, Target's Score:[1.8280306, 11.406998, -4.122804, 2.1693976, -3.636168, -3.093123, -4.723717, -3.9256454, -2.1318793, 6.8871374]
Target sample: 146, Prediction:1, Target's Score:[0.7454269, 21.499374, -4.830527, -1.2101939, -5.491446, -4.111331, -5.835884, -3.6629326, -0.7874052, 4.506907]
Target sample: 151, Prediction:1, Target's Score:[1.8476989, 20.404947, -4.760659, -2.7840676, -6.02801, -4.315189, -3.6862006, -4.354991, 0.11079593, 4.3220086]
Target sample: 156, Prediction:1, Target's Score:[2.9876301, 14.372322, -2.7898364, -0.21808621, -6.9791875, -4.2363753, -1.9300985, -4.5815835, -3.0192904, 7.1020265]
Target sample: 161, Prediction:1, Target's Score:[2.3229053, 6.6889443, -0.3822713, 2.4913895, 0.048666015, -4.075475, -0.99451566, -3.8169603, -1.8623154, 0.12853402]
Target sample: 166, Prediction:9, Target's Score:[-1.9376342, 10.182438, -5.3723254, 0.9816253, -4.9458804, -2.799981, 0.33287677, -4.734122, -2.5934808, 11.580224]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 01:44:16 Epoch 59, Val iteration 0, acc 89.600 (89.600)
2021-06-13 01:44:22 Epoch 59, Val iteration 19, acc 90.000 (89.710)
* Prec: 89.71000099182129
Per class accuracy =  [0.92511958 0.93160434 0.85299036 0.83469356 0.89558949 0.82146554
 0.9370308  0.8913621  0.93112784 0.94426351]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 9, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 1
ATTACK acc: 0.0
GoogLeNet
[74, 80, 84, 86, 89] 22
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 01:44:25, Val iteration 0, acc 96.200 (96.200)
2021-06-13 01:44:38, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-13 01:44:40, Epoch 0, Iteration 7, loss 0.372 (0.502), acc 90.385 (86.600)
2021-06-13 01:45:51, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-4.676599, 13.3133955, -3.3102086, -0.9383728, -2.1071186, -4.088131, -1.0043763, -1.8672445, 3.906652, 0.92290163]
Target sample: 6, Prediction:1, Target's Score:[-2.5321395, 11.811667, -1.896188, -2.904137, 0.024033487, -3.9681325, -2.3418856, -2.2926137, 3.0548391, 1.1856856]
Target sample: 11, Prediction:1, Target's Score:[-2.779987, 12.820197, -2.3149729, -2.3751051, -0.78527427, -3.9082239, -0.8845377, -2.2423534, 1.7319934, 0.87855697]
Target sample: 16, Prediction:1, Target's Score:[-2.9471593, 12.659445, -4.2595963, -3.5243773, -1.7808248, -3.4994254, 1.7361244, -0.7401449, 2.3821995, 0.12099004]
Target sample: 21, Prediction:1, Target's Score:[-3.5347826, 20.615011, -3.7096827, -3.7077816, -3.1401958, -4.1387453, -1.5563978, -2.8793242, 0.2582395, 1.9623781]
Target sample: 26, Prediction:1, Target's Score:[-2.6395848, 20.129158, -3.9788387, -4.120883, -3.9433484, -3.651406, -1.9869323, -2.3521755, 0.2327658, 2.479628]
Target sample: 31, Prediction:1, Target's Score:[-3.2648575, 22.056795, -4.0195923, -4.063667, -4.2292, -4.0826864, -2.553387, -2.9760718, 0.39552844, 2.9140134]
Target sample: 36, Prediction:1, Target's Score:[-3.0427854, 19.417028, -3.9703562, -3.5125535, -3.9537773, -4.195484, -2.9764585, -3.242548, 1.4503462, 4.1972938]
Target sample: 41, Prediction:1, Target's Score:[-3.8270113, 18.934498, -4.37178, -3.0920484, -3.7632244, -4.3820486, -2.3589704, -3.503105, 3.6657746, 2.8722594]
Target sample: 46, Prediction:1, Target's Score:[-1.7412453, 13.17048, -4.0026555, -2.9346106, -3.0070763, -4.2742496, -2.812294, -3.2900963, 8.356507, 0.7018589]
Target sample: 51, Prediction:1, Target's Score:[-2.8279827, 12.464997, -4.343197, -2.8771083, -3.2202086, -3.8283668, -1.8761171, -3.2684753, 9.995919, -0.05945087]
Target sample: 56, Prediction:1, Target's Score:[0.36749673, 13.074613, -4.374249, -3.295286, -3.270381, -4.326662, -2.8950427, -3.1837668, 7.3401856, 0.7312608]
Target sample: 61, Prediction:1, Target's Score:[-1.712181, 14.974959, -4.0290494, -2.314, -2.5389452, -3.9004703, -2.7284043, -3.3634608, 4.791515, 0.9737656]
Target sample: 66, Prediction:1, Target's Score:[-2.4815328, 17.393452, -4.282894, -1.513809, -3.634414, -4.254268, -2.8218205, -3.2301435, 2.961944, 2.0293012]
Target sample: 71, Prediction:1, Target's Score:[0.13020016, 14.063354, -3.4322796, -2.0624478, -2.6696064, -4.051668, -2.4637883, -3.5652356, 4.7375183, -0.5310308]
Target sample: 76, Prediction:1, Target's Score:[-1.3043238, 19.251095, -4.384133, -3.2864122, -2.351842, -3.976376, -2.5845134, -2.9419458, 0.0358138, 1.7150387]
Target sample: 81, Prediction:1, Target's Score:[2.2496943, 15.091972, -3.610679, -3.7496483, -1.1565261, -4.5693383, -2.633042, -2.756606, 0.42130983, 0.88322794]
Target sample: 86, Prediction:1, Target's Score:[-0.89561284, 9.187127, -2.6982446, -3.531299, -0.46330047, -3.395201, 0.019712487, -1.8388065, 4.975359, -1.2214307]
Target sample: 91, Prediction:1, Target's Score:[-1.838316, 13.9206705, -2.775007, -2.904728, -2.3825755, -3.6869378, -1.6948652, -3.1765437, 4.956801, -0.26665294]
Target sample: 96, Prediction:1, Target's Score:[-3.4844077, 13.763023, -3.6775517, -1.4648623, -0.79213774, -3.8531268, -0.52054644, -2.1315756, 2.3901527, -0.0820899]
Target sample: 101, Prediction:1, Target's Score:[-2.1681654, 15.229289, -3.6240485, -3.6226385, -1.3801229, -3.560789, -2.1355934, -1.1801542, 1.7627895, 0.8352883]
Target sample: 106, Prediction:1, Target's Score:[-2.6314456, 17.444933, -3.4425278, -3.4446182, -3.1400766, -3.931588, 0.08374036, -2.999859, 0.97352564, 1.2403471]
Target sample: 111, Prediction:1, Target's Score:[-0.7967785, 17.074799, -3.3514388, -3.0354228, -2.0053463, -4.2650833, -2.318259, -3.2748978, 0.683624, 1.4478637]
Target sample: 116, Prediction:1, Target's Score:[-1.78956, 14.584985, -2.7979548, -1.8461859, -2.727604, -3.9687066, -2.0195425, -3.0256276, 3.4563909, 0.28185165]
Target sample: 121, Prediction:1, Target's Score:[-0.33810365, 13.265275, -3.5538857, -2.1251857, -2.8596873, -4.21611, -2.8566008, -3.7529433, 3.31266, 3.288319]
Target sample: 126, Prediction:1, Target's Score:[-1.1959753, 12.642903, -3.6306112, -2.0337934, -2.1404722, -4.533793, -3.0292375, -3.4986534, 6.5763793, 1.0027419]
Target sample: 131, Prediction:1, Target's Score:[-2.0944455, 8.722245, -2.4946878, -2.2882154, -2.4194496, -3.392878, -1.6982622, -3.0888467, 8.554636, 0.34147835]
Target sample: 136, Prediction:1, Target's Score:[-1.3892448, 11.085026, -3.9033918, -2.467847, -2.8130429, -3.7358837, -2.609047, -3.2206216, 7.324305, 1.8902014]
Target sample: 141, Prediction:1, Target's Score:[-0.38112098, 11.921063, -3.5982854, -2.8342478, -2.7631052, -4.057471, -2.685667, -2.9564996, 5.841501, 1.6683252]
Target sample: 146, Prediction:1, Target's Score:[-0.46509442, 13.755378, -3.523939, -2.5591836, -3.0880375, -3.8992088, -1.8002363, -2.8400247, 2.7111363, 1.857854]
Target sample: 151, Prediction:1, Target's Score:[-1.5093374, 18.831013, -3.9558306, -4.0347013, -3.4075947, -3.74456, -2.3457851, -3.0507636, 0.94508326, 2.435853]
Target sample: 156, Prediction:1, Target's Score:[-1.8659613, 18.38255, -2.7751708, -3.6934178, -3.9277864, -4.277918, -1.9668967, -2.3690484, 0.31800544, 2.3435445]
Target sample: 161, Prediction:1, Target's Score:[-3.0157332, 11.469242, -0.41690314, -1.7890227, -0.70579123, -3.8027284, -0.8286402, -2.2944868, 1.407226, 0.10945451]
Target sample: 166, Prediction:1, Target's Score:[-4.083548, 12.798302, -4.091686, -2.5391243, -1.3775756, -3.9457192, 0.90057206, -1.8376658, 2.4242587, 1.8965682]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 01:47:01 Epoch 59, Val iteration 0, acc 93.000 (93.000)
2021-06-13 01:47:14 Epoch 59, Val iteration 19, acc 93.200 (92.860)
* Prec: 92.8600009918213
Per class accuracy =  [0.95266823 0.9456239  0.90301764 0.87810619 0.95968045 0.86978279
 0.94620774 0.93179314 0.96247512 0.93642193]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
------SUMMARY POST DEFENSE------
TIME ELAPSED (mins): 19
TARGET INDEX: 8
ResNet50 0.0 0.0 95.46000137329102 92.03000183105469 100.0
DPN92 0.0 0.0 95.50000267028808 93.41000137329101 100.0
MobileNetV2 0.0 0.0 91.22000160217286 89.71000099182129 100.0
GoogLeNet 0.0 0.0 95.41000213623047 92.8600009918213 100.0
True False False False False
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.300-droplayer0.000.t7
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
No specific indices are determined, so try to include whatever we find
In total, we found 104 images of target 9
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', eval_poisons_root='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=False, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=9, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/9/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103]
# Targets: 18, # Poisons: 5
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-13 01:47:33 Iteration 0 	 Training Loss: 9.208e-01 	 Loss in Target Net: 2.212e+00	  
 2021-06-13 01:48:22 Iteration 50 	 Training Loss: 1.984e-01 	 Loss in Target Net: 6.842e-01	  
 2021-06-13 01:49:10 Iteration 100 	 Training Loss: 1.782e-01 	 Loss in Target Net: 6.203e-01	  
 2021-06-13 01:49:59 Iteration 150 	 Training Loss: 1.663e-01 	 Loss in Target Net: 6.125e-01	  
 2021-06-13 01:50:49 Iteration 200 	 Training Loss: 1.717e-01 	 Loss in Target Net: 5.786e-01	  
 2021-06-13 01:51:37 Iteration 250 	 Training Loss: 1.595e-01 	 Loss in Target Net: 6.160e-01	  
 2021-06-13 01:52:26 Iteration 300 	 Training Loss: 1.602e-01 	 Loss in Target Net: 5.992e-01	  
 2021-06-13 01:53:15 Iteration 350 	 Training Loss: 1.645e-01 	 Loss in Target Net: 6.456e-01	  
 2021-06-13 01:54:04 Iteration 400 	 Training Loss: 1.581e-01 	 Loss in Target Net: 6.508e-01	  
 2021-06-13 01:54:53 Iteration 450 	 Training Loss: 1.582e-01 	 Loss in Target Net: 6.859e-01	  
 2021-06-13 01:55:42 Iteration 500 	 Training Loss: 1.544e-01 	 Loss in Target Net: 7.172e-01	  
 2021-06-13 01:56:30 Iteration 550 	 Training Loss: 1.566e-01 	 Loss in Target Net: 6.218e-01	  
 2021-06-13 01:57:19 Iteration 600 	 Training Loss: 1.562e-01 	 Loss in Target Net: 6.245e-01	  
 2021-06-13 01:58:09 Iteration 650 	 Training Loss: 1.561e-01 	 Loss in Target Net: 6.617e-01	  
 2021-06-13 01:58:59 Iteration 700 	 Training Loss: 1.577e-01 	 Loss in Target Net: 6.984e-01	  
 2021-06-13 01:59:48 Iteration 750 	 Training Loss: 1.599e-01 	 Loss in Target Net: 6.799e-01	  
 2021-06-13 02:00:38 Iteration 800 	 Training Loss: 1.552e-01 	 Loss in Target Net: 6.515e-01	  
 2021-06-13 02:01:27 Iteration 850 	 Training Loss: 1.516e-01 	 Loss in Target Net: 6.477e-01	  
 2021-06-13 02:02:17 Iteration 900 	 Training Loss: 1.558e-01 	 Loss in Target Net: 7.025e-01	  
 2021-06-13 02:03:07 Iteration 950 	 Training Loss: 1.555e-01 	 Loss in Target Net: 6.798e-01	  
 2021-06-13 02:03:56 Iteration 999 	 Training Loss: 1.549e-01 	 Loss in Target Net: 7.069e-01	  
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 02:04:01, Val iteration 0, acc 94.200 (94.200)
2021-06-13 02:04:12, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-13 02:04:17, Epoch 0, Iteration 7, loss 0.104 (0.264), acc 98.077 (94.200)
2021-06-13 02:05:18, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.8262434, 4.632998, -3.6178977, -0.88142014, -2.7232382, -2.3894646, 6.251801, -2.1819873, 1.8652909, 1.1916876]
Target sample: 7, Prediction:6, Target's Score:[-2.5622015, 0.6545884, -3.0779908, 0.7019765, -2.43978, -1.9421118, 11.905078, -1.1796684, 1.1638213, -2.8551247]
Target sample: 13, Prediction:6, Target's Score:[-2.560546, 2.2086325, -3.4005866, -0.86132556, -2.9068983, -2.6478999, 12.993441, -1.0780983, 1.2335643, -2.5770664]
Target sample: 19, Prediction:6, Target's Score:[-2.1113045, 6.115234, -1.7978058, 0.27209786, -2.1248212, -2.5172622, 6.850546, -2.5486143, -0.13296497, -1.6061131]
Target sample: 25, Prediction:3, Target's Score:[-2.2079344, 1.23038, -1.4449426, 3.670646, -2.1450076, -1.7030948, 3.5408363, -0.17274775, -0.08692155, -0.38145065]
Target sample: 31, Prediction:1, Target's Score:[-2.2606065, 12.691124, -2.187937, -2.6621602, -4.1859355, -3.1924443, 5.412476, -1.9137273, 0.6604697, -1.9287312]
Target sample: 37, Prediction:6, Target's Score:[0.48778182, 4.6772556, -2.7196825, 0.2328687, -2.4971435, -1.9992627, 7.0715632, -2.7606316, -0.4687009, -1.6355413]
Target sample: 43, Prediction:6, Target's Score:[-1.8670977, 4.8738465, -3.623618, -1.024996, -3.2626133, -2.5385783, 9.818987, -1.4202908, 2.1797638, -2.7789927]
Target sample: 49, Prediction:6, Target's Score:[-2.1059997, 2.6757774, -3.3310435, 0.37321782, -2.795435, -2.4160643, 9.048784, -1.5970803, 2.3892748, -1.9050318]
Target sample: 55, Prediction:6, Target's Score:[-2.2190325, 1.7800579, -3.0111406, -0.24069662, -1.6256217, -2.0279198, 8.024286, -2.174374, 2.0841675, -0.28134906]
Target sample: 61, Prediction:6, Target's Score:[-2.2019513, 1.3286146, -3.0741374, -0.3115847, -1.1767269, -2.3487206, 7.7277207, -2.0454433, 1.3573444, 1.062786]
Target sample: 67, Prediction:6, Target's Score:[-2.5100782, 1.5937436, -3.2381546, 0.11524139, -1.82468, -2.3895066, 11.333839, -2.0401816, 0.11771316, -0.7635334]
Target sample: 73, Prediction:6, Target's Score:[-1.1118511, 5.153417, -3.7880216, -0.9509361, -3.2349756, -2.3395824, 7.313828, -1.7040966, 1.8284911, -0.8471389]
Target sample: 79, Prediction:1, Target's Score:[-1.5953733, 7.174678, -2.7977307, -1.553189, -3.1969273, -2.842964, 5.4897966, -2.2235882, 2.9209566, -1.048159]
Target sample: 85, Prediction:6, Target's Score:[-1.1554298, 3.7764578, -3.134569, -0.39985013, -2.452382, -2.5897667, 9.007855, -2.4010985, 0.9710282, -1.2695154]
Target sample: 91, Prediction:6, Target's Score:[-1.5388298, 3.993614, -3.2085302, 0.17016223, -2.6852772, -2.2141526, 8.059958, -1.8971639, 1.4267507, -1.7746547]
Target sample: 97, Prediction:6, Target's Score:[-1.5641488, 0.5204087, -3.1656961, -0.19800273, -2.049725, -1.892622, 9.488055, -1.668166, 2.5139372, -1.6777457]
Target sample: 103, Prediction:6, Target's Score:[-2.2886183, 0.4089992, -2.7864482, 0.15463269, -1.4070551, -1.9039632, 10.002585, -1.6387161, 1.7507765, -1.9782635]
Current ATTACK acc on target samples: 83.333
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 02:06:17 Epoch 59, Val iteration 0, acc 92.400 (92.400)
2021-06-13 02:06:28 Epoch 59, Val iteration 19, acc 92.800 (92.080)
* Prec: 92.08000106811524
Per class accuracy =  [0.95788694 0.94890712 0.88079132 0.87250437 0.94548462 0.81032865
 0.94792736 0.94775684 0.95113346 0.94346884]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 1, 1, 1, 1, 6, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 6, 6, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 80.23255813953489
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 02:06:40, Val iteration 0, acc 94.800 (94.800)
2021-06-13 02:07:01, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-13 02:07:14, Epoch 0, Iteration 7, loss 0.236 (0.367), acc 90.385 (91.000)
2021-06-13 02:09:54, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-0.58225787, 9.203739, -3.5224578, -2.3905463, -3.0529642, -2.262531, 1.4652063, -0.991828, 1.3855478, 1.3107378]
Target sample: 7, Prediction:6, Target's Score:[-0.5561434, 3.8918438, -4.3188434, -0.6407653, -1.6300043, -3.6098845, 4.1386037, 0.5750495, 3.4128232, -0.78026485]
Target sample: 13, Prediction:6, Target's Score:[0.41244748, 5.2398157, -5.3627257, -3.0811293, -2.2687464, -3.038797, 6.417239, -0.6193631, 3.0983624, -0.2727909]
Target sample: 19, Prediction:1, Target's Score:[-1.7852201, 11.422772, -1.880044, -0.86764187, -2.1983027, -2.6871397, 0.040429503, -1.527926, 0.11644673, -0.031804003]
Target sample: 25, Prediction:3, Target's Score:[-2.3142164, -2.1461732, 0.47513744, 4.579394, -2.7093103, -1.733354, 3.1464458, 4.1060057, -0.6988877, -2.2814412]
Target sample: 31, Prediction:1, Target's Score:[-0.96229553, 10.333842, -3.8507333, -2.316355, -2.3203616, -2.9760394, 2.6118243, -0.55439323, 1.2967079, -0.6800949]
Target sample: 37, Prediction:1, Target's Score:[-1.0306579, 9.543159, -1.9129562, -1.5107292, -2.087996, -2.4505434, 1.5455412, -1.3290757, 0.59571576, -0.82502747]
Target sample: 43, Prediction:1, Target's Score:[-0.41864038, 8.841499, -3.6288643, -3.224435, -2.089027, -2.5685575, 2.9342113, -0.8413602, 2.6404693, -1.0951347]
Target sample: 49, Prediction:6, Target's Score:[0.9145289, 5.0730453, -5.2751718, -1.9163413, -2.6626263, -3.987723, 5.1159577, -0.12819444, 3.4963088, -0.10051071]
Target sample: 55, Prediction:6, Target's Score:[0.20788948, 1.4859447, -3.6040297, -0.79160637, -2.5671384, -3.4005191, 5.435996, 1.340231, 2.1751764, 0.15979648]
Target sample: 61, Prediction:1, Target's Score:[-0.21697679, 8.1999445, -4.798884, -0.9471704, -2.893307, -3.5214257, 4.0602465, -0.9699844, 1.0689081, 0.61287034]
Target sample: 67, Prediction:6, Target's Score:[-0.3581161, 6.2487607, -3.3648486, -0.9986137, -2.343752, -3.255192, 7.3962207, -1.4715619, -0.28490514, -1.0284033]
Target sample: 73, Prediction:6, Target's Score:[1.0029457, 1.5691681, -5.6716003, -1.9778271, -1.8740444, -3.59433, 6.698031, -0.2634465, 5.6109023, -0.9945397]
Target sample: 79, Prediction:1, Target's Score:[-0.6069758, 6.467939, -4.565815, -2.0538287, -2.4860349, -3.2137547, 4.6257086, -0.62680143, 3.1326392, -0.15132591]
Target sample: 85, Prediction:1, Target's Score:[-0.76761574, 9.535193, -3.1273694, -1.7199014, -2.6285322, -3.4419181, 3.18212, -1.3341281, 0.41874442, 0.4567476]
Target sample: 91, Prediction:1, Target's Score:[-0.9514923, 10.03669, -4.0663295, -1.2602172, -2.8993232, -2.6467443, 1.1351166, -0.9315279, 1.5971698, 0.58302706]
Target sample: 97, Prediction:6, Target's Score:[0.59688026, 1.0345364, -4.5572057, -0.8889657, -2.1279225, -3.617011, 6.070906, 1.1097306, 2.9850588, -0.1447824]
Target sample: 103, Prediction:8, Target's Score:[0.06443119, 4.7437296, -4.5473666, -1.7159725, -1.9248657, -3.5240781, 3.984481, -0.3374303, 4.8309445, -1.0857671]
Current ATTACK acc on target samples: 38.889
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 02:12:30 Epoch 59, Val iteration 0, acc 92.600 (92.600)
2021-06-13 02:12:51 Epoch 59, Val iteration 19, acc 93.400 (93.040)
* Prec: 93.04000129699708
Per class accuracy =  [0.9448764  0.96986129 0.91449953 0.83172595 0.94232505 0.88610926
 0.95622208 0.94016463 0.96794864 0.9531645 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 8, 1, 6, 1, 6, 8, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 8, 6
ATTACK acc: 24.41860465116279
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 02:12:55, Val iteration 0, acc 92.600 (92.600)
2021-06-13 02:13:01, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-13 02:13:03, Epoch 0, Iteration 7, loss 0.418 (0.349), acc 86.538 (90.000)
2021-06-13 02:13:31, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-0.5381373, 11.764208, -3.5679762, 0.5381617, -3.7170289, -3.1191587, 2.8367777, -3.679813, -1.3883504, 1.2729254]
Target sample: 7, Prediction:1, Target's Score:[2.6558752, 6.6913786, -0.6942069, 4.5893626, -2.0692644, -2.5274386, -0.6642916, -4.3462768, -3.6877859, 0.4091412]
Target sample: 13, Prediction:1, Target's Score:[-0.31295422, 9.902385, -1.7915525, 0.7392001, -3.006275, -3.825011, 5.5160685, -4.174354, 0.119229555, -2.7830288]
Target sample: 19, Prediction:1, Target's Score:[0.35668507, 10.638135, -2.3884203, 1.641783, -2.9333186, -2.8862922, 1.4457091, -2.7933726, 0.51234925, -3.199175]
Target sample: 25, Prediction:9, Target's Score:[-1.7016895, 0.6438892, 0.9143323, 3.1030948, -5.064121, -2.2329698, 0.9108758, -0.42597172, -0.543582, 4.694806]
Target sample: 31, Prediction:1, Target's Score:[0.8886094, 10.886476, -4.152143, 0.30833817, -3.208431, -3.1673462, 2.0431762, -4.222461, -1.2177651, 2.214514]
Target sample: 37, Prediction:1, Target's Score:[1.0019255, 11.894704, -4.001271, 1.6982219, -3.951322, -3.2806544, 4.771751, -5.679844, -2.1215045, 0.06366754]
Target sample: 43, Prediction:1, Target's Score:[1.0608015, 9.110622, -2.6704414, 0.122444466, -4.218432, -3.5707457, 5.4264383, -3.6276133, 1.7084877, -2.9980357]
Target sample: 49, Prediction:1, Target's Score:[-0.4476778, 10.722608, -3.9294405, 4.656724, -4.338114, -3.447479, 4.568055, -6.3690753, 1.3933961, -2.3800704]
Target sample: 55, Prediction:3, Target's Score:[0.17643222, 3.8468518, -0.21747339, 5.3465157, -1.6763858, -3.1866388, 4.216671, -5.409351, -2.2787306, -0.47643593]
Target sample: 61, Prediction:9, Target's Score:[1.9562566, 2.654937, -1.9603534, 3.7989945, -2.2120533, -3.780607, 1.2530576, -4.8735247, -0.906818, 4.3892894]
Target sample: 67, Prediction:6, Target's Score:[-0.7250649, 7.572663, -3.5906856, 1.905021, -4.3178535, -2.250694, 8.822023, -5.2026677, -2.9125206, 1.0325058]
Target sample: 73, Prediction:1, Target's Score:[-0.24172184, 7.146261, -6.448706, 2.9207792, -3.8279643, -3.955673, 5.0201244, -4.6734705, -0.03940769, 4.453582]
Target sample: 79, Prediction:1, Target's Score:[2.6363387, 7.7751746, -5.536272, 2.501938, -5.154834, -3.741586, 5.0315857, -4.4446454, 1.2664369, 0.009698784]
Target sample: 85, Prediction:1, Target's Score:[0.027654286, 6.6455436, -0.24538109, 5.75503, -4.223201, -1.955212, 3.8913198, -4.3376393, -4.306033, -0.8901957]
Target sample: 91, Prediction:1, Target's Score:[-0.36273903, 12.144178, -4.3398137, 2.4015913, -3.6441212, -2.656286, 3.8242917, -5.125369, -4.9016595, 3.0850291]
Target sample: 97, Prediction:3, Target's Score:[0.12622881, 3.9664476, 0.3268851, 6.389969, 0.24847277, -3.8275704, -0.8833535, -2.854044, -1.2686889, -1.8645241]
Target sample: 103, Prediction:3, Target's Score:[-0.84231484, 2.8945687, 1.287524, 7.1897697, 0.81011283, -3.490533, 3.1422014, -6.1172867, -4.2305417, -0.26466224]
Current ATTACK acc on target samples: 5.556
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 02:13:59 Epoch 59, Val iteration 0, acc 89.600 (89.600)
2021-06-13 02:14:05 Epoch 59, Val iteration 19, acc 90.200 (89.590)
* Prec: 89.59000129699707
Per class accuracy =  [0.9237065  0.92692872 0.84655704 0.83009275 0.89151256 0.82262081
 0.9381255  0.89368943 0.93270178 0.94919324]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 3, 3, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 9, 6, 3, 1, 1, 1, 1, 6, 6, 1, 9, 3, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 3, 1, 3
ATTACK acc: 12.790697674418604
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 02:14:12, Val iteration 0, acc 96.200 (96.200)
2021-06-13 02:14:25, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-13 02:14:31, Epoch 0, Iteration 7, loss 0.943 (0.943), acc 71.154 (77.000)
2021-06-13 02:15:42, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[1.3074994, 6.4779615, -2.6409948, 1.4416593, -3.2177002, -0.0045855734, 1.5932379, -2.0157614, -1.6866559, -1.2820395]
Target sample: 7, Prediction:6, Target's Score:[-2.395211, 2.3404021, -1.4735819, 0.5280603, -2.2599952, 0.57279396, 4.0537586, -1.6391829, 2.7116225, -2.5044389]
Target sample: 13, Prediction:1, Target's Score:[-2.0262156, 5.330146, -2.7774875, 2.0339432, -4.716021, 1.3401827, 4.3304453, -1.8443675, -0.5594102, -1.1257665]
Target sample: 19, Prediction:6, Target's Score:[-3.7655692, 4.9720955, -4.880445, 6.8799024, -4.0613613, -1.3101532, 8.29662, -1.2041258, -1.8743321, -3.1273139]
Target sample: 25, Prediction:7, Target's Score:[-3.8298178, 1.0801785, 1.0956094, 1.426729, -2.3988702, 2.3320038, -0.67000115, 2.583107, -1.4492234, -0.23041551]
Target sample: 31, Prediction:1, Target's Score:[-0.5344822, 12.300789, -4.8039694, 0.13492069, -1.8110436, 0.6331607, -0.015706316, -3.5082178, -2.4165754, 0.030913312]
Target sample: 37, Prediction:1, Target's Score:[-1.579972, 7.308426, -3.6422417, 6.0330243, -2.8198705, 0.8440463, 6.1358166, -4.5009704, -4.3205647, -3.487974]
Target sample: 43, Prediction:1, Target's Score:[-3.4734166, 6.481931, -3.1105711, 1.3774757, -4.946659, 0.6816567, 6.3202543, -1.0094616, -1.0478928, -1.290575]
Target sample: 49, Prediction:8, Target's Score:[0.13870913, -1.5672116, -2.6932752, -0.27805758, -3.171347, 0.35470805, 2.3784847, -1.093591, 8.705236, -2.8942318]
Target sample: 55, Prediction:8, Target's Score:[-1.6858103, 0.030430384, -4.693293, -0.13357636, -1.2544572, 0.5554153, 3.2721014, -1.8990101, 7.9194517, -2.2147315]
Target sample: 61, Prediction:1, Target's Score:[-1.8964067, 5.2069397, -3.6689487, 2.9878867, -3.3464744, -0.116699435, 3.4604125, -2.4299614, -0.20846556, -0.011515837]
Target sample: 67, Prediction:6, Target's Score:[-2.7263105, 4.095316, -4.284307, 2.4671721, -3.3420882, 1.0802717, 9.968693, -1.5603341, -3.1007602, -2.6258135]
Target sample: 73, Prediction:1, Target's Score:[-0.9977583, 5.20005, -5.6747127, -0.19655834, -3.9228714, 0.6197996, 4.9286847, -2.11273, 2.4009392, -0.2700303]
Target sample: 79, Prediction:1, Target's Score:[1.4227545, 6.454214, -5.979303, -0.34268373, -4.6296473, 0.00902616, 5.7945642, -3.3643787, 0.37706032, 0.24111415]
Target sample: 85, Prediction:6, Target's Score:[-2.823853, 4.1714606, -3.1763475, 5.066185, -2.270783, 1.0579338, 6.0964384, -2.7282398, -3.3074064, -2.108628]
Target sample: 91, Prediction:1, Target's Score:[-2.1824563, 7.152174, -3.1606605, 2.0587265, -4.461166, -0.16573742, 5.0328403, -2.7371078, -0.51644564, -1.0420239]
Target sample: 97, Prediction:8, Target's Score:[-0.7087824, 0.92048126, -2.367706, 0.6050792, -1.5650117, 0.75025296, 3.1767187, -2.6736224, 5.59119, -3.8178878]
Target sample: 103, Prediction:6, Target's Score:[-3.026804, -0.24670033, -1.1822144, 2.7073145, -2.2382948, 1.4532878, 4.421615, -2.7639728, 3.8470404, -3.04849]
Current ATTACK acc on target samples: 27.778
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 02:16:52 Epoch 59, Val iteration 0, acc 91.200 (91.200)
2021-06-13 02:17:05 Epoch 59, Val iteration 19, acc 92.000 (91.120)
* Prec: 91.12000160217285
Per class accuracy =  [0.94819769 0.94091102 0.87021645 0.83782099 0.94224246 0.82144446
 0.95499057 0.91728023 0.94116334 0.93914275]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 8, 1, 8, 8, 8, 1, 1, 6, 6, 1, 1, 1, 6, 6, 3, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 6, 1, 1, 1, 6, 6, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 1, 6, 1, 1, 1, 6, 6, 6, 6, 6, 1, 1, 8, 8, 8, 1, 6, 1, 6, 6, 1, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 1, 8, 8, 8, 6, 6
ATTACK acc: 33.72093023255814
--------
------SUMMARY PRE DEFENSE------
TIME ELAPSED (mins): 16
TARGET INDEX: 9
ResNet50 83.33333333333333 80.23255813953489 95.46000137329102 92.08000106811524
DPN92 38.888888888888886 24.41860465116279 95.50000267028808 93.04000129699708
MobileNetV2 5.555555555555555 12.790697674418604 91.22000160217286 89.59000129699707
GoogLeNet 27.77777777777778 33.72093023255814 95.41000213623047 91.12000160217285
DEFENSE EVALUATION
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
ResNet50
[74, 80, 86, 89] 4
Using Adam for retraining
2000
poison index =  84
499
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 02:17:10, Val iteration 0, acc 94.200 (94.200)
2021-06-13 02:17:20, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-13 02:17:22, Epoch 0, Iteration 7, loss 0.135 (0.524), acc 96.154 (92.600)
2021-06-13 02:18:23, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6]
Target sample: 1, Prediction:1, Target's Score:[-1.5858611, 17.502922, -3.568121, -0.23908551, -5.0218334, -3.0528088, -1.5680666, -4.183896, 0.65095806, 1.1758506]
Target sample: 7, Prediction:1, Target's Score:[-2.4909363, 11.352158, -2.7052953, 0.52090716, -3.6587002, -3.0061352, 0.8946714, -3.2493458, 2.8627217, -0.43659002]
Target sample: 13, Prediction:1, Target's Score:[-2.2518885, 14.78467, -3.7240708, -1.086816, -4.6182547, -3.3814955, 1.4556578, -3.2226348, 2.3551242, -0.20495895]
Target sample: 19, Prediction:1, Target's Score:[-1.2887399, 10.420568, -1.3493598, 1.509975, -3.9015856, -2.4675815, 1.0581449, -3.848342, 1.3015188, -1.3396711]
Target sample: 25, Prediction:3, Target's Score:[-2.6353414, -1.4493005, 1.8904668, 6.96335, -1.77335, -1.5338238, 0.65975535, 0.2440749, -1.1982406, -1.1285331]
Target sample: 31, Prediction:1, Target's Score:[-2.518849, 14.462998, -0.20180416, 0.7209774, -4.715502, -3.073366, -0.19968799, -3.3609955, -1.1975032, 0.21565536]
Target sample: 37, Prediction:1, Target's Score:[-0.92379725, 8.336693, -1.8748136, 3.2966566, -3.352742, -2.2499115, 3.1681364, -3.9495625, 0.04572895, -2.423572]
Target sample: 43, Prediction:1, Target's Score:[-1.8172227, 15.726987, -3.9565375, -1.3092626, -4.575265, -3.3264644, 1.0648714, -3.725286, 2.9590542, -0.93345696]
Target sample: 49, Prediction:1, Target's Score:[-1.4885043, 8.282752, -3.572344, 0.80318624, -3.5516157, -3.0975206, 2.0616462, -3.444413, 5.1333947, -1.0574068]
Target sample: 55, Prediction:1, Target's Score:[-2.4890747, 11.193956, -2.6494539, 1.9824916, -3.6471417, -2.722397, 0.30690303, -3.796475, 1.8770832, 0.019391654]
Target sample: 61, Prediction:1, Target's Score:[-2.130391, 15.734595, -3.4802208, 0.46157953, -4.5532413, -3.3540864, -1.0781273, -4.036764, 0.83963835, 1.6919309]
Target sample: 67, Prediction:6, Target's Score:[-2.0567143, 2.7584453, 0.25787345, 2.6364803, -2.287938, -3.3557787, 6.8474817, -3.3476148, 1.7233177, -3.0698824]
Target sample: 73, Prediction:1, Target's Score:[-1.3163147, 9.111426, -2.2576709, 1.6408533, -3.6998336, -3.0187712, 0.17131674, -3.0361185, 0.4117159, 2.0663214]
Target sample: 79, Prediction:1, Target's Score:[-1.5090398, 15.146525, -2.0693424, -0.6546877, -4.901326, -3.2790136, -0.95880777, -3.764962, 0.31597075, 1.8011293]
Target sample: 85, Prediction:1, Target's Score:[-1.1460931, 10.148691, -2.7800167, 1.6816113, -3.5800478, -3.3289633, 2.4713697, -3.8218257, 1.7490131, -1.3204173]
Target sample: 91, Prediction:1, Target's Score:[-1.7386824, 13.893038, -2.498609, 2.4384854, -4.3308115, -3.0464082, -0.8822539, -4.0902658, 0.513181, -0.17924914]
Target sample: 97, Prediction:1, Target's Score:[-1.7036159, 10.560689, -2.5187087, 1.298724, -3.4748356, -2.6226418, -0.05415439, -3.3342323, 2.2180684, -0.29909173]
Target sample: 103, Prediction:1, Target's Score:[-1.5814158, 7.69581, -2.9650927, -0.053770155, -2.652946, -2.7626517, 1.1923437, -2.9872625, 4.7997546, -0.6193567]
Current ATTACK acc on target samples: 5.556
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 02:19:23 Epoch 59, Val iteration 0, acc 91.000 (91.000)
2021-06-13 02:19:33 Epoch 59, Val iteration 19, acc 93.200 (91.690)
* Prec: 91.6900016784668
Per class accuracy =  [0.94210689 0.95269035 0.83817104 0.90257299 0.95424559 0.84359572
 0.9533209  0.89637683 0.9503341  0.93706934]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
DPN92
[84, 86, 89] 25
Using Adam for retraining
2000
poison index =  74
poison index =  80
498
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 02:19:38, Val iteration 0, acc 94.800 (94.800)
2021-06-13 02:19:59, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-13 02:20:04, Epoch 0, Iteration 7, loss 0.352 (0.324), acc 94.231 (93.000)
2021-06-13 02:22:43, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6]
Target sample: 1, Prediction:1, Target's Score:[0.9320903, 11.040733, -3.6782975, -3.4940796, -3.6494136, -1.7760569, 0.37123838, -3.328032, 4.6561527, -0.5538518]
Target sample: 7, Prediction:8, Target's Score:[-1.1087683, 5.0249786, -4.572571, -2.1095507, -2.4970772, -4.021524, 3.5585923, -1.87412, 9.725717, -1.6289076]
Target sample: 13, Prediction:8, Target's Score:[-1.2792574, 6.105477, -5.4669495, -3.5423615, -3.3509002, -2.8403742, 5.395765, -1.2662835, 8.67663, -1.946723]
Target sample: 19, Prediction:1, Target's Score:[-0.14489695, 11.923411, -3.582799, -1.1136632, -3.7588751, -2.8164368, 1.5472567, -3.4359345, 1.4355309, 0.49159074]
Target sample: 25, Prediction:3, Target's Score:[-1.9687338, -3.2440758, -0.74549985, 6.4526014, -2.4087136, -0.95436954, 1.5129339, 1.2202878, 0.20946848, 0.42851895]
Target sample: 31, Prediction:1, Target's Score:[-1.3013742, 11.715075, -4.550417, -2.708108, -3.7542503, -2.890005, 3.0113847, -2.2226036, 3.2985032, -0.10623347]
Target sample: 37, Prediction:1, Target's Score:[-1.026872, 9.462768, -2.2721705, -1.1503068, -2.8930116, -1.8466759, 1.8649805, -2.7352312, 2.2428668, -1.2039583]
Target sample: 43, Prediction:1, Target's Score:[-0.3893806, 11.261493, -3.532945, -4.2879696, -3.6204748, -1.8164706, 2.6333046, -2.4283764, 5.4330707, -2.761238]
Target sample: 49, Prediction:8, Target's Score:[0.10965492, 5.8710318, -4.512591, -3.261609, -3.1726031, -4.030087, 3.3038106, -1.929115, 10.111313, -1.9888153]
Target sample: 55, Prediction:8, Target's Score:[-0.05798552, 1.9720793, -3.5457742, -1.3281223, -2.7553794, -3.8223963, 3.0028183, -0.8497751, 9.570164, -1.7059176]
Target sample: 61, Prediction:1, Target's Score:[-0.53083384, 10.841945, -4.5450606, -2.609473, -3.5832553, -3.2502635, 2.7234683, -2.322518, 4.918712, -1.1323417]
Target sample: 67, Prediction:6, Target's Score:[-1.7997016, 5.0059423, -3.5701096, -1.4267079, -2.2735322, -2.5896816, 8.9124775, -1.1959743, 1.8673446, -2.4796426]
Target sample: 73, Prediction:8, Target's Score:[-0.025540235, 1.0310278, -4.514248, -0.6274357, -2.5152364, -4.0161896, 4.7853017, -0.64555717, 7.4552464, -0.42648703]
Target sample: 79, Prediction:8, Target's Score:[-1.3370425, 5.3625207, -4.9102993, -1.5269601, -3.1081288, -3.342363, 4.3589287, -1.617713, 6.9015565, -0.2949457]
Target sample: 85, Prediction:1, Target's Score:[-0.89291024, 8.279193, -3.1645854, -0.07683723, -3.0370467, -2.9586272, 4.2294965, -2.6067343, 1.2608128, -0.5509702]
Target sample: 91, Prediction:1, Target's Score:[-0.13814732, 12.549154, -4.1096625, -2.7966826, -4.114432, -1.751406, 0.9768267, -2.9022312, 3.1953042, -0.3724159]
Target sample: 97, Prediction:8, Target's Score:[0.1664409, 2.1844587, -4.027322, -2.0357306, -2.1331017, -3.9751723, 3.067945, -1.1377156, 9.916554, -1.5492222]
Target sample: 103, Prediction:8, Target's Score:[-0.08999326, 3.0645452, -4.176257, -1.8620952, -2.1727943, -4.434393, 2.8026962, -2.3289595, 11.453503, -1.7568448]
Current ATTACK acc on target samples: 5.556
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 02:25:19 Epoch 59, Val iteration 0, acc 93.400 (93.400)
2021-06-13 02:25:40 Epoch 59, Val iteration 19, acc 92.800 (93.150)
* Prec: 93.15000228881836
Per class accuracy =  [0.95088615 0.94064412 0.92411129 0.86768062 0.95098572 0.87668701
 0.93290911 0.95298322 0.96414571 0.95508209]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 8, 8, 8, 8, 8, 1, 8, 1, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 8, 8, 8, 8, 8, 8, 1, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 8, 1, 8, 8, 1, 8, 1, 8, 8, 8
ATTACK acc: 9.30232558139535
MobileNetV2
[80, 86, 89] 45
Using Adam for retraining
2000
poison index =  74
poison index =  84
498
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 02:25:43, Val iteration 0, acc 92.600 (92.600)
2021-06-13 02:25:49, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-13 02:25:50, Epoch 0, Iteration 7, loss 0.336 (0.319), acc 84.615 (90.000)
2021-06-13 02:26:19, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6]
Target sample: 1, Prediction:1, Target's Score:[-0.18485238, 14.679577, -4.5552573, 0.18393648, -4.3408756, -2.9518142, -0.5117049, -3.616302, -1.6408464, 3.448511]
Target sample: 7, Prediction:1, Target's Score:[3.026986, 7.576632, -1.230228, 5.077204, -2.615335, -2.4045048, -2.3783581, -4.3698597, -3.895195, 1.6125826]
Target sample: 13, Prediction:1, Target's Score:[0.31172103, 15.317473, -3.8973372, 0.15657473, -4.806917, -4.107616, 1.0385011, -4.1075134, -0.02667433, 0.6114159]
Target sample: 19, Prediction:1, Target's Score:[0.8637099, 14.427505, -3.8432508, 1.3389055, -3.7819974, -3.2557309, -2.092656, -3.1503441, 0.49354714, -0.53320277]
Target sample: 25, Prediction:9, Target's Score:[-1.7825114, 1.1481473, -0.72169673, 3.3909504, -5.149239, -1.88473, -0.19134668, -0.1081771, 0.18298128, 5.4677944]
Target sample: 31, Prediction:1, Target's Score:[1.0404966, 13.964781, -5.0010047, -0.28991064, -4.107302, -3.4238343, -0.6807649, -4.2073073, -0.8260475, 4.012125]
Target sample: 37, Prediction:1, Target's Score:[1.2642564, 15.313445, -5.228769, 1.6336004, -5.103271, -3.5127342, 1.5209358, -5.9600263, -1.706654, 2.2825477]
Target sample: 43, Prediction:1, Target's Score:[0.78686476, 14.073176, -4.459736, 0.10101476, -5.4860864, -3.623062, 1.8427734, -3.7923157, 0.85980386, 0.1438387]
Target sample: 49, Prediction:1, Target's Score:[-0.012254417, 15.311103, -5.179105, 4.1727514, -5.6630554, -3.7051435, 0.5368687, -6.465623, 1.2625664, 0.2576275]
Target sample: 55, Prediction:1, Target's Score:[0.2173444, 6.539155, -1.7737378, 5.3174295, -2.7473779, -3.0539272, 1.1529124, -4.8331885, -2.4959998, 2.0892997]
Target sample: 61, Prediction:9, Target's Score:[1.9292969, 5.2852645, -3.214653, 3.514351, -3.338782, -3.8332224, -1.1927615, -4.449086, -1.9051338, 7.638052]
Target sample: 67, Prediction:1, Target's Score:[-0.32063138, 11.232767, -5.2114997, 1.6135365, -5.2634683, -2.6517045, 5.536215, -5.376532, -3.0844297, 3.9993334]
Target sample: 73, Prediction:1, Target's Score:[0.06375708, 10.45374, -7.584403, 2.3871415, -5.078636, -4.2105665, 2.3289685, -4.9169183, -0.28475153, 7.3565083]
Target sample: 79, Prediction:1, Target's Score:[2.8427958, 10.172299, -6.4109488, 2.033061, -5.750876, -4.16504, 2.1073968, -4.388848, 1.8433907, 2.156078]
Target sample: 85, Prediction:1, Target's Score:[0.35949963, 9.146464, -1.5637249, 5.6874948, -5.1602106, -2.155044, 1.7067522, -4.581253, -3.9692411, 0.9558014]
Target sample: 91, Prediction:1, Target's Score:[0.2683763, 15.1685915, -5.4703474, 2.1150274, -4.4464965, -3.0236363, 0.8449185, -5.1327314, -4.8783245, 5.1180024]
Target sample: 97, Prediction:3, Target's Score:[0.107474074, 6.351749, -0.9045003, 6.480865, -1.309496, -3.484133, -2.5870464, -3.0494773, -1.724629, 0.52713805]
Target sample: 103, Prediction:3, Target's Score:[-0.6415154, 5.916911, 0.19533715, 6.866719, -0.4336308, -3.5734458, 0.20903502, -5.9164515, -3.7270644, 1.5507847]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 02:26:47 Epoch 59, Val iteration 0, acc 90.000 (90.000)
2021-06-13 02:26:54 Epoch 59, Val iteration 19, acc 90.000 (89.600)
* Prec: 89.60000152587891
Per class accuracy =  [0.92018824 0.93419044 0.8449095  0.82732181 0.89280534 0.8268508
 0.93356535 0.89281841 0.93334442 0.95085659]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1
ATTACK acc: 0.0
GoogLeNet
[74, 80, 89] 20
Using Adam for retraining
2000
poison index =  84
poison index =  86
498
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 02:26:57, Val iteration 0, acc 96.200 (96.200)
2021-06-13 02:27:09, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-13 02:27:12, Epoch 0, Iteration 7, loss 0.962 (0.915), acc 69.231 (79.400)
2021-06-13 02:28:23, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6]
Target sample: 1, Prediction:1, Target's Score:[3.068926, 9.563528, -3.3044286, -2.9041889, -3.7609591, -3.8514712, 1.5571748, -1.5002567, -0.750646, 1.9882758]
Target sample: 7, Prediction:1, Target's Score:[1.7975194, 5.5407996, -3.0722635, -0.38750654, -1.7085018, -5.6426687, 4.643892, -2.3770726, 3.026713, -1.7407146]
Target sample: 13, Prediction:1, Target's Score:[-0.7044676, 9.87951, -3.7668254, -0.12287782, -4.243843, -4.019748, 3.7485774, -3.4000614, 3.3121302, -0.6146569]
Target sample: 19, Prediction:1, Target's Score:[-3.814494, 9.888223, -5.2591023, 4.5436254, -4.5767064, -4.9016643, 6.9668703, -3.6619806, 3.2795687, -2.4154315]
Target sample: 25, Prediction:3, Target's Score:[-1.3941795, -0.22027743, 0.9870204, 3.7512863, -1.4579648, -2.7797103, 3.5343976, 0.4060043, -3.2731664, 0.48857042]
Target sample: 31, Prediction:1, Target's Score:[-2.2762415, 13.670448, -4.5002065, -0.21802245, -3.1476107, -4.6803646, 3.6074793, -3.705545, 2.588028, -1.2839396]
Target sample: 37, Prediction:1, Target's Score:[-1.5427005, 10.433676, -3.465691, 5.582295, -2.719733, -4.4734864, 5.3891892, -4.870447, -1.6192691, -2.6347868]
Target sample: 43, Prediction:1, Target's Score:[-1.4614621, 10.953073, -3.5340228, 0.88742614, -3.4458497, -3.891544, 4.808316, -3.3664002, -0.38102698, -0.49467066]
Target sample: 49, Prediction:8, Target's Score:[4.5434294, 3.4028676, -3.2561295, -2.3310955, -3.0591245, -5.1744885, 2.6460352, -2.1699803, 7.1287093, -1.6515749]
Target sample: 55, Prediction:8, Target's Score:[2.0571446, 4.7284956, -5.216461, -1.2733723, -2.9922023, -5.0823255, 4.2346625, -1.9104954, 5.6279173, -0.106130034]
Target sample: 61, Prediction:1, Target's Score:[-0.57731706, 12.290279, -5.211354, 1.4110782, -3.6831052, -4.7604475, 1.9671723, -3.0137634, 1.7947369, -0.14369717]
Target sample: 67, Prediction:6, Target's Score:[-1.2528855, 6.588623, -1.3666133, 0.20737524, -3.5274026, -4.830116, 9.748097, -1.8535476, -2.341425, -1.2843016]
Target sample: 73, Prediction:8, Target's Score:[-2.0069478, 6.7482557, -5.9507947, -0.93151855, -4.7756367, -5.00509, 7.133794, -2.4079466, 7.597542, -0.35786584]
Target sample: 79, Prediction:1, Target's Score:[-2.0650866, 10.42726, -5.659049, -1.1982986, -5.1146464, -4.78244, 5.9679804, -2.8658655, 5.7016325, -0.3544592]
Target sample: 85, Prediction:1, Target's Score:[-0.9565533, 8.835184, -3.0422895, 2.9459958, -2.3883507, -4.7126474, 5.48116, -3.549632, -1.3882703, -1.1423458]
Target sample: 91, Prediction:1, Target's Score:[-1.402506, 12.981676, -3.010084, 0.4278189, -4.10527, -3.8790696, 2.3123689, -4.0772805, 0.55898035, 0.26087984]
Target sample: 97, Prediction:0, Target's Score:[5.374333, 4.8574247, -3.2253644, -1.5380183, -2.5581157, -5.4884133, 3.274075, -1.1916772, 3.7988613, -3.189138]
Target sample: 103, Prediction:8, Target's Score:[2.8689644, 3.117872, -3.0536976, -0.581182, -3.1455815, -5.3523955, 4.878003, -3.2592738, 6.734158, -2.1373138]
Current ATTACK acc on target samples: 5.556
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 02:29:32 Epoch 59, Val iteration 0, acc 92.000 (92.000)
2021-06-13 02:29:44 Epoch 59, Val iteration 19, acc 92.400 (92.260)
* Prec: 92.26000137329102
Per class accuracy =  [0.9294002  0.94198003 0.86834971 0.85890423 0.95388424 0.89380962
 0.94413765 0.92638828 0.94763424 0.96425732]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 8, 8, 6, 8, 8, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 6, 8, 0, 8, 8, 8, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 1, 8, 8, 8, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 8
ATTACK acc: 10.465116279069768
------SUMMARY POST DEFENSE------
TIME ELAPSED (mins): 16
TARGET INDEX: 9
ResNet50 5.555555555555555 0.0 95.46000137329102 91.6900016784668 80.0
DPN92 5.555555555555555 9.30232558139535 95.50000267028808 93.15000228881836 60.0
MobileNetV2 0.0 0.0 91.22000160217286 89.60000152587891 60.0
GoogLeNet 5.555555555555555 10.465116279069768 95.41000213623047 92.26000137329102 60.0
True False False False False
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.300-droplayer0.000.t7
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
No specific indices are determined, so try to include whatever we find
In total, we found 142 images of target 10
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133, 139]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', eval_poisons_root='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=False, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=10, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/10/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133, 139]
# Targets: 24, # Poisons: 5
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-13 02:30:02 Iteration 0 	 Training Loss: 1.023e+00 	 Loss in Target Net: 2.153e+00	  
 2021-06-13 02:30:53 Iteration 50 	 Training Loss: 2.563e-01 	 Loss in Target Net: 5.643e-01	  
 2021-06-13 02:31:43 Iteration 100 	 Training Loss: 2.290e-01 	 Loss in Target Net: 5.657e-01	  
 2021-06-13 02:32:32 Iteration 150 	 Training Loss: 2.235e-01 	 Loss in Target Net: 5.645e-01	  
 2021-06-13 02:33:23 Iteration 200 	 Training Loss: 2.106e-01 	 Loss in Target Net: 5.239e-01	  
 2021-06-13 02:34:14 Iteration 250 	 Training Loss: 2.055e-01 	 Loss in Target Net: 5.201e-01	  
 2021-06-13 02:35:10 Iteration 300 	 Training Loss: 2.036e-01 	 Loss in Target Net: 5.392e-01	  
 2021-06-13 02:36:03 Iteration 350 	 Training Loss: 2.066e-01 	 Loss in Target Net: 5.294e-01	  
 2021-06-13 02:36:57 Iteration 400 	 Training Loss: 1.990e-01 	 Loss in Target Net: 4.947e-01	  
 2021-06-13 02:37:50 Iteration 450 	 Training Loss: 2.005e-01 	 Loss in Target Net: 5.077e-01	  
 2021-06-13 02:38:41 Iteration 500 	 Training Loss: 1.919e-01 	 Loss in Target Net: 5.056e-01	  
 2021-06-13 02:39:31 Iteration 550 	 Training Loss: 2.003e-01 	 Loss in Target Net: 5.101e-01	  
 2021-06-13 02:40:23 Iteration 600 	 Training Loss: 2.003e-01 	 Loss in Target Net: 4.680e-01	  
 2021-06-13 02:41:14 Iteration 650 	 Training Loss: 2.007e-01 	 Loss in Target Net: 4.745e-01	  
 2021-06-13 02:42:05 Iteration 700 	 Training Loss: 1.998e-01 	 Loss in Target Net: 5.112e-01	  
 2021-06-13 02:42:57 Iteration 750 	 Training Loss: 1.945e-01 	 Loss in Target Net: 5.452e-01	  
 2021-06-13 02:43:48 Iteration 800 	 Training Loss: 2.002e-01 	 Loss in Target Net: 5.217e-01	  
 2021-06-13 02:44:39 Iteration 850 	 Training Loss: 1.949e-01 	 Loss in Target Net: 4.720e-01	  
 2021-06-13 02:45:34 Iteration 900 	 Training Loss: 1.918e-01 	 Loss in Target Net: 5.128e-01	  
 2021-06-13 02:46:24 Iteration 950 	 Training Loss: 1.972e-01 	 Loss in Target Net: 4.763e-01	  
 2021-06-13 02:47:14 Iteration 999 	 Training Loss: 1.947e-01 	 Loss in Target Net: 4.742e-01	  
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 02:47:19, Val iteration 0, acc 94.200 (94.200)
2021-06-13 02:47:29, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-13 02:47:34, Epoch 0, Iteration 7, loss 0.333 (0.193), acc 90.385 (95.200)
2021-06-13 02:48:35, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-0.1726143, 7.1682343, -5.091476, -0.085385814, -4.656256, -0.26126558, 5.113287, -1.5391793, 0.13744433, -0.027954545]
Target sample: 7, Prediction:1, Target's Score:[-0.992046, 8.361114, -5.482792, -0.95610017, -4.511507, -0.40188706, 4.7893634, -1.9248352, 3.5072, -1.8432214]
Target sample: 13, Prediction:6, Target's Score:[-0.22745809, 4.957957, -5.360008, -0.9607856, -3.4196863, -1.7946213, 7.2721567, -1.2428024, 1.9421438, -0.6081249]
Target sample: 19, Prediction:1, Target's Score:[-0.3539178, 7.439873, -4.6854863, 0.17974173, -4.166668, 0.37489682, 4.0015306, -1.3180938, 1.1780385, -2.144437]
Target sample: 25, Prediction:1, Target's Score:[-1.6046399, 12.826921, -4.932912, -1.25639, -4.9268746, -0.40601915, 2.1575844, -1.7960479, -0.3438534, 0.912426]
Target sample: 31, Prediction:1, Target's Score:[-2.310091, 11.255933, -4.571308, -0.23343982, -4.5102386, 0.83885014, 3.477546, -2.670886, 0.752928, -1.4540048]
Target sample: 37, Prediction:1, Target's Score:[0.39822373, 12.795461, -5.121048, -1.195297, -5.123484, -1.0494839, 0.8095453, -2.518398, -0.79559517, 2.4570463]
Target sample: 43, Prediction:1, Target's Score:[-0.62008315, 13.16568, -4.71657, -1.2412779, -4.564635, -2.2972627, 2.5864627, -2.1525187, 0.8012101, -0.38781244]
Target sample: 49, Prediction:1, Target's Score:[-1.1605444, 12.421849, -4.894511, -1.7869002, -4.797668, -1.2566271, 3.7962842, -1.9527118, 0.025012743, 0.23393768]
Target sample: 55, Prediction:1, Target's Score:[-2.2484798, 15.304712, -5.4137225, -1.2865409, -5.556665, -1.1354407, 2.735789, -1.2817506, -0.34521848, -0.083255365]
Target sample: 61, Prediction:1, Target's Score:[-1.7441624, 9.661414, -4.7903814, 1.0808153, -4.794382, -0.3447057, 2.44032, -2.7585716, -0.5697205, 2.449218]
Target sample: 67, Prediction:1, Target's Score:[-0.04961304, 7.3984394, -4.4943585, 0.18168283, -4.5115976, 0.17825235, 2.8733804, -2.2309182, -1.1448438, 2.389284]
Target sample: 73, Prediction:1, Target's Score:[-2.8209798, 11.826631, -5.175558, -0.8027953, -4.7307, -1.5606459, 3.5483203, -2.0221677, 2.7868254, -0.46460602]
Target sample: 79, Prediction:1, Target's Score:[-2.1429691, 10.015263, -4.6882715, -0.89278644, -4.3453517, -0.9077192, 5.242655, -2.2950792, 2.1070237, -1.5358295]
Target sample: 85, Prediction:1, Target's Score:[-1.8532834, 9.385738, -4.5230637, -0.4782091, -3.8329678, -0.893502, 2.6123195, -1.9419996, 2.0131388, 0.01848955]
Target sample: 91, Prediction:1, Target's Score:[-1.9110005, 13.5580845, -4.629757, -1.342274, -4.7765503, -1.1200811, 2.8619478, -2.2832556, 0.20840429, 0.034284588]
Target sample: 97, Prediction:1, Target's Score:[-2.3712325, 12.8256235, -4.7803144, -0.09857683, -5.210637, 0.6467038, 1.6512529, -2.1914523, -0.48353457, 0.6530076]
Target sample: 103, Prediction:1, Target's Score:[-0.56145835, 10.105982, -5.090628, -0.7342929, -4.8616877, -1.5030822, 2.9492652, -1.3531741, 2.4454086, -0.8409699]
Target sample: 109, Prediction:1, Target's Score:[-1.6434866, 13.156264, -4.9539685, -1.21315, -4.392927, -1.786722, 3.1657417, -1.7330365, 2.029719, -2.074868]
Target sample: 115, Prediction:1, Target's Score:[-2.0346348, 14.096707, -4.5239296, -1.6601474, -4.674347, -0.654987, 1.645967, -2.4519272, 0.21323843, 0.6529754]
Target sample: 121, Prediction:1, Target's Score:[-1.9927124, 12.261818, -4.90464, -0.25745544, -4.90725, -1.6817567, 3.6392503, -1.732959, 0.7881226, -0.6122829]
Target sample: 127, Prediction:1, Target's Score:[-2.2007408, 12.858883, -4.5711913, 0.5565094, -4.8091545, -1.3574532, 2.2542148, -2.8984065, -0.010655929, 0.80032104]
Target sample: 133, Prediction:1, Target's Score:[-1.0915942, 5.481252, -4.9791775, -0.19632508, -4.730684, 1.9873731, 3.2161539, -0.4861152, 1.2110977, 0.14034098]
Target sample: 139, Prediction:6, Target's Score:[-0.21407433, 5.212187, -4.9601884, 0.20714493, -4.370285, -0.86406994, 7.1228433, -2.0639641, 1.3789796, -0.8735021]
Current ATTACK acc on target samples: 8.333
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 02:49:34 Epoch 59, Val iteration 0, acc 91.400 (91.400)
2021-06-13 02:49:45 Epoch 59, Val iteration 19, acc 90.800 (90.840)
* Prec: 90.84000205993652
Per class accuracy =  [0.91905966 0.96099737 0.78973749 0.85900903 0.92084402 0.84418314
 0.9576865  0.93514353 0.9625828  0.93673303]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 1, 1, 1
ATTACK acc: 8.474576271186441
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 02:49:56, Val iteration 0, acc 94.800 (94.800)
2021-06-13 02:50:18, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-13 02:50:31, Epoch 0, Iteration 7, loss 0.071 (0.448), acc 100.000 (89.800)
2021-06-13 02:53:10, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-0.9127277, 5.141801, -1.2650968, -2.562492, -1.0787112, -2.9502888, 3.9640498, -3.1602764, 2.5771582, 0.61177987]
Target sample: 7, Prediction:6, Target's Score:[-0.70883125, 2.3522768, -1.1092662, -1.6802055, -1.0100049, -3.8327498, 6.5863824, -3.3737478, 3.4981875, -0.3504721]
Target sample: 13, Prediction:6, Target's Score:[-0.12456254, -0.54726624, -0.8690785, -2.4505756, 2.7254505, -3.8471537, 8.196245, -3.639544, 2.1791291, -1.2435865]
Target sample: 19, Prediction:6, Target's Score:[-0.7970749, -0.26559773, -0.26345187, -1.8678671, 3.8113515, -2.920525, 5.5644317, -3.1548824, 1.6800219, -1.4700944]
Target sample: 25, Prediction:1, Target's Score:[-0.8832369, 5.2429233, -1.2619667, -1.267315, -0.021600341, -3.263711, 4.3188014, -3.8421621, 0.33985582, 0.99645174]
Target sample: 31, Prediction:1, Target's Score:[-1.9514982, 6.6401105, -1.1386397, -1.4476544, 0.06591466, -2.8244703, 3.644762, -3.827718, 1.1296405, 0.085041344]
Target sample: 37, Prediction:1, Target's Score:[-0.7380754, 6.9125443, -2.6797411, -1.6046214, -1.1800078, -3.3809528, 3.0219388, -4.2260427, 1.2820762, 2.9719963]
Target sample: 43, Prediction:6, Target's Score:[-1.7035421, 4.6947293, -0.79766136, -1.4153546, -0.27426222, -3.9353096, 4.9185715, -4.040311, 0.975741, 1.9199592]
Target sample: 49, Prediction:6, Target's Score:[-1.3748096, 2.3693693, 0.10110349, -1.1410226, 0.1610208, -3.5328705, 5.7447157, -3.6731613, 1.6117, 0.062942035]
Target sample: 55, Prediction:6, Target's Score:[-2.5096576, 3.6197734, 1.0466609, 1.4001821, -0.79438925, -2.940396, 4.190343, -3.3116202, 0.8873973, -1.2111475]
Target sample: 61, Prediction:6, Target's Score:[-0.4326771, 1.265908, -1.0004439, 2.1720526, -0.07840248, -1.6681201, 4.0683866, -2.8632057, -0.30876282, -0.82053816]
Target sample: 67, Prediction:8, Target's Score:[0.96838534, -0.13800846, -0.030229293, -0.7195025, 0.84576154, -1.8630568, 0.8447386, -2.2371335, 1.698361, 0.91034365]
Target sample: 73, Prediction:1, Target's Score:[-1.8878448, 5.2900877, -1.049981, -0.366566, -2.2079124, -2.9944086, 3.62553, -3.3110726, 4.262845, -0.9847261]
Target sample: 79, Prediction:6, Target's Score:[-2.312071, 4.837768, -1.2012364, -1.3842931, -0.5420084, -3.258649, 5.837778, -3.897464, 3.020081, -0.7205491]
Target sample: 85, Prediction:6, Target's Score:[-2.4095595, -0.59545594, -0.7436353, 0.6330206, 4.8757777, -1.5423045, 5.1319714, -3.4306414, 0.24137297, -1.8479396]
Target sample: 91, Prediction:6, Target's Score:[-1.9813101, 4.6538005, -1.0806829, -1.074847, 0.360541, -3.4847307, 7.237081, -4.183344, -0.52364945, 0.45351934]
Target sample: 97, Prediction:1, Target's Score:[-1.7706741, 7.6343975, -2.1006267, -1.2569702, -1.3221822, -3.2861993, 3.719982, -4.3544884, 2.389925, 0.7599392]
Target sample: 103, Prediction:6, Target's Score:[-2.1572735, 3.3455336, -0.4725083, -0.53971523, -0.32787734, -3.196931, 5.782004, -3.8410246, 2.5099204, -0.75183386]
Target sample: 109, Prediction:6, Target's Score:[-2.6403253, 4.675309, -0.48976618, -0.89836717, 0.12255773, -3.9743476, 6.713891, -4.4178004, 1.8279556, -0.5322996]
Target sample: 115, Prediction:6, Target's Score:[-1.7891766, 3.719845, -0.8863499, -0.5959157, 0.5197395, -3.5859025, 5.015906, -3.9655485, 0.91402864, 0.98247707]
Target sample: 121, Prediction:6, Target's Score:[-2.7135484, 1.1581154, 0.17159967, 3.4683194, 0.87180406, -3.028497, 5.0989366, -4.1385245, 0.16987377, -0.7115935]
Target sample: 127, Prediction:6, Target's Score:[-2.4846325, 1.889542, -0.96451694, 2.0945265, 0.8832559, -2.153791, 3.915735, -3.8392253, 0.6802428, 0.28766546]
Target sample: 133, Prediction:8, Target's Score:[-1.9827962, 2.5009756, -1.4839058, -1.3842399, -0.90099454, -2.8980558, 3.057223, -2.467763, 5.8564057, 0.04267036]
Target sample: 139, Prediction:6, Target's Score:[-0.8408292, 4.928998, -2.4334064, -2.851641, -1.2437971, -2.9739401, 4.9643035, -3.4501934, 3.8243992, 0.4921903]
Current ATTACK acc on target samples: 66.667
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 02:55:46 Epoch 59, Val iteration 0, acc 92.600 (92.600)
2021-06-13 02:56:07 Epoch 59, Val iteration 19, acc 93.400 (93.000)
* Prec: 93.0000015258789
Per class accuracy =  [0.95352612 0.94107355 0.9004124  0.84352561 0.95986443 0.8980152
 0.95809058 0.93482222 0.96241538 0.95056337]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 8, 6, 8, 6, 6, 1, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 6, 1, 9, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 6, 6, 8, 6, 6, 6, 6, 6, 3, 3, 6, 6, 1, 6, 1, 6, 1, 6, 1, 8, 6, 6, 6, 1, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 3, 1, 3, 6, 6, 6, 6, 8, 6, 6, 8, 6, 6, 6, 6
ATTACK acc: 64.40677966101696
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 02:56:11, Val iteration 0, acc 92.600 (92.600)
2021-06-13 02:56:17, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-13 02:56:19, Epoch 0, Iteration 7, loss 0.342 (0.358), acc 90.385 (89.800)
2021-06-13 02:56:47, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:9, Target's Score:[-1.2535663, 3.5730302, -4.4106665, 1.8742042, -4.5121255, -2.1479533, 3.0373766, -2.9302282, 1.3277729, 5.754502]
Target sample: 7, Prediction:9, Target's Score:[-2.6289518, 0.48117888, -4.401935, 4.597297, -4.8532085, -1.7616403, 5.5120416, -3.5638645, 1.2532016, 5.6478944]
Target sample: 13, Prediction:3, Target's Score:[-1.7370667, -0.9656638, -2.7157903, 5.3812175, -2.5530949, -2.3741157, 1.5562027, -1.78296, 2.255589, 3.2013564]
Target sample: 19, Prediction:3, Target's Score:[-3.4689178, 0.933887, -2.1051233, 5.535956, 0.50292027, -1.846841, 3.2680335, 0.78491014, -4.026985, 0.73237664]
Target sample: 25, Prediction:1, Target's Score:[-1.3822341, 5.3213577, -2.3460732, 3.5734313, -0.4662228, -3.699384, 4.0166125, -0.28798267, -5.821035, 1.453349]
Target sample: 31, Prediction:3, Target's Score:[-1.0293765, 1.4241802, -0.65334237, 3.221888, 1.9331673, -3.6327584, 1.4862384, 0.36092108, -4.7613707, 1.9708377]
Target sample: 37, Prediction:9, Target's Score:[0.9362596, 1.1035993, -4.1221714, 4.8887024, -2.4123325, -3.2260466, -2.191396, -1.3041457, -1.9180608, 8.566169]
Target sample: 43, Prediction:3, Target's Score:[-1.3016306, -1.5628302, -1.9418722, 6.7159214, -2.1906292, -3.6535022, 2.0052044, -3.5799134, -0.23251355, 6.0395837]
Target sample: 49, Prediction:9, Target's Score:[-1.7218285, 3.9281723, -1.5384452, 3.304121, -4.7595973, -2.5709472, 1.7683566, -4.8530874, 0.68893594, 6.103683]
Target sample: 55, Prediction:9, Target's Score:[-1.5264547, 4.738947, -0.33864865, 2.3091223, -4.8335395, -2.3099504, 0.13095309, 0.37686202, -3.221456, 5.036926]
Target sample: 61, Prediction:3, Target's Score:[-2.5718496, 3.3433342, -3.5683439, 6.774706, -2.040083, -1.0654328, 4.252134, -5.8112264, -4.031173, 5.0704427]
Target sample: 67, Prediction:9, Target's Score:[-0.063551575, 3.708367, -1.8067697, 3.262251, -2.7751987, -0.9595855, -1.7065583, 0.91102064, -4.447289, 4.1916337]
Target sample: 73, Prediction:3, Target's Score:[-3.5207922, 4.9708753, -0.66799897, 6.032451, -2.314362, -4.1082735, -1.8062946, -3.155754, 3.4866223, 1.4617296]
Target sample: 79, Prediction:3, Target's Score:[-4.245514, 2.3410218, -1.6118994, 5.9691987, -1.5055757, -3.1847944, 1.7715994, -2.7094414, 0.37361455, 3.137657]
Target sample: 85, Prediction:6, Target's Score:[-4.095041, -1.5870416, -0.10838587, 6.726368, -0.0018927408, -0.6313339, 7.832396, -3.3651412, -5.3397803, 0.8561863]
Target sample: 91, Prediction:3, Target's Score:[-1.5906231, 4.0333333, -3.754103, 7.706231, -0.42114574, -0.9857325, 3.413952, -1.4965614, -6.928145, 0.36679822]
Target sample: 97, Prediction:1, Target's Score:[-0.30532092, 6.499699, -4.5063534, 3.461426, -2.047429, -1.264479, 0.63991165, -1.747109, -5.9790463, 5.6059203]
Target sample: 103, Prediction:9, Target's Score:[-1.5855482, 1.5122067, -4.526865, 3.8862777, 0.2736263, -4.517874, 4.0418725, -1.7619444, -1.5994598, 4.5998135]
Target sample: 109, Prediction:6, Target's Score:[-1.3369447, -1.3818585, -1.0228447, 2.8546748, -1.2081757, -5.174065, 4.227121, -2.9252539, 3.230218, 3.0273597]
Target sample: 115, Prediction:9, Target's Score:[-3.1879084, 3.0993667, -3.2161932, 2.0410116, -3.3485837, -0.8906036, 2.6242619, -3.638058, 1.0627861, 5.7814636]
Target sample: 121, Prediction:3, Target's Score:[-3.7573714, 2.1787188, -3.359707, 7.3947678, -3.3243556, -2.641539, 4.2988024, -3.0533216, -0.5933861, 3.2054088]
Target sample: 127, Prediction:3, Target's Score:[-3.2225175, 5.55478, -4.0141006, 6.041851, -1.2898499, -2.661858, 5.9049926, -4.5410337, -3.463913, 2.045323]
Target sample: 133, Prediction:3, Target's Score:[-1.8970419, 2.6905115, -2.7602684, 6.826708, -4.905778, -2.1263943, 3.287349, -2.8598566, -2.553473, 4.6215534]
Target sample: 139, Prediction:3, Target's Score:[-2.6819227, 0.9740552, -4.0607667, 5.052354, -2.8988254, -2.2683494, 3.8329842, -4.0889792, 2.6745138, 3.766386]
Current ATTACK acc on target samples: 8.333
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 02:57:15 Epoch 59, Val iteration 0, acc 89.200 (89.200)
2021-06-13 02:57:21 Epoch 59, Val iteration 19, acc 90.200 (89.300)
* Prec: 89.30000190734863
Per class accuracy =  [0.91741017 0.92574968 0.83888495 0.8244648  0.88841048 0.8173893
 0.93925378 0.89261158 0.93162719 0.94694373]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 3, 3, 8, 6, 9, 3, 3, 3, 6, 3, 3, 3, 3, 3, 3, 3, 3, 3, 6, 1, 1, 1, 1, 1, 3, 3, 3, 9, 9, 9, 9, 9, 3, 9, 9, 9, 9, 9, 1, 9, 9, 9, 1, 3, 1, 3, 3, 3, 3, 1, 3, 3, 9, 9, 3, 9, 1, 1, 1, 3, 3, 3, 3, 3, 3, 3, 4, 3, 3, 6, 4, 3, 3, 3, 3, 3, 6, 3, 6, 1, 1, 1, 3, 6, 3, 6, 6, 6, 6, 3, 3, 3, 3, 3, 6, 3, 1, 1, 3, 6, 1, 3, 3, 3, 3, 1, 1, 3, 6, 9, 3, 3, 8, 6, 3, 3, 3
ATTACK acc: 13.559322033898304
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 02:57:28, Val iteration 0, acc 96.200 (96.200)
2021-06-13 02:57:41, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-13 02:57:47, Epoch 0, Iteration 7, loss 0.222 (0.519), acc 94.231 (86.800)
2021-06-13 02:58:58, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.5204667, 2.3480976, -2.0362978, -1.9393892, -1.8032154, 2.11792, 4.388998, -2.9717476, -1.0280453, 2.4881082]
Target sample: 7, Prediction:6, Target's Score:[-2.348505, 3.9014003, -3.1823335, -0.7941536, -1.9109683, -2.2479084, 4.73581, -3.0894136, 2.5740352, 2.4041574]
Target sample: 13, Prediction:6, Target's Score:[-1.7857608, 3.2501798, -2.49233, 0.468033, -0.81795865, -2.2949603, 5.217938, -3.1282706, -0.3073681, 1.9293598]
Target sample: 19, Prediction:6, Target's Score:[-2.064891, 1.5885862, -3.2533877, 2.750127, -1.2648803, -3.4744668, 5.543805, -2.097112, 1.2590832, 1.0471653]
Target sample: 25, Prediction:1, Target's Score:[-1.4656004, 5.5650024, -3.373943, -0.22414029, -1.1835256, -3.0562246, 4.0325108, -1.9443644, -1.1513678, 2.8473034]
Target sample: 31, Prediction:1, Target's Score:[-1.0352381, 5.0617075, -2.954009, -0.64880824, 1.2790307, -1.8063359, 3.8850703, -2.866478, -2.4162595, 1.5506313]
Target sample: 37, Prediction:1, Target's Score:[-0.38630977, 9.696414, -1.7538733, -1.7799561, -3.310695, -0.6851038, 1.8167039, -3.223191, -2.8202214, 2.5057983]
Target sample: 43, Prediction:1, Target's Score:[-1.4865069, 9.570261, -2.9086623, -0.16303962, -3.5352898, -2.1418912, 3.6438835, -3.3902457, -2.4842708, 2.953748]
Target sample: 49, Prediction:1, Target's Score:[-2.5291395, 10.107591, -2.6884677, 1.1215575, -2.6401584, -2.7465203, 1.9516788, -3.3083572, -2.0131607, 2.8021376]
Target sample: 55, Prediction:1, Target's Score:[-2.0083463, 10.609256, -2.4249804, 0.57883453, -3.1677375, -2.9290752, 4.0692573, -2.1519756, -3.3093476, 0.79955]
Target sample: 61, Prediction:6, Target's Score:[-1.9448595, 3.7089999, -3.686971, 3.461357, -2.4263694, 0.035978056, 6.566663, -4.4944534, -2.2476, 1.0634942]
Target sample: 67, Prediction:9, Target's Score:[-1.2055486, 2.0825043, -2.0956008, 0.5447055, -0.6756055, -0.6717219, 3.53876, -2.9586818, -2.2793865, 3.7544913]
Target sample: 73, Prediction:1, Target's Score:[-2.5658114, 8.045087, -1.2507602, -1.2223794, -1.6324757, -2.79227, 4.3803835, -2.3634238, -0.75042623, 0.20541798]
Target sample: 79, Prediction:1, Target's Score:[-2.9133127, 7.418535, -2.5134199, -0.7322011, -2.4277601, -2.6521401, 6.325296, -2.7231221, 0.62052476, -0.35024738]
Target sample: 85, Prediction:3, Target's Score:[-2.0306373, 0.48740393, -2.5888808, 5.0018406, 2.1783397, -1.8679625, 3.8080108, -2.312869, -1.2711533, -1.3731191]
Target sample: 91, Prediction:1, Target's Score:[-1.5448719, 4.615987, -3.6573758, 0.0030475277, 0.4908561, -2.8622825, 4.479312, -1.8325665, 0.05941449, 0.29269338]
Target sample: 97, Prediction:1, Target's Score:[-1.5642625, 10.745881, -3.218518, -0.80835044, -1.9563029, -2.3819013, 2.5522888, -3.5546086, -2.2088816, 2.4556453]
Target sample: 103, Prediction:1, Target's Score:[-1.1144766, 9.524535, -2.7503588, -0.71584594, -3.0705166, -2.4060044, 4.5809445, -3.5569408, -1.7477093, 1.3133862]
Target sample: 109, Prediction:1, Target's Score:[-1.592044, 10.499991, -3.0541728, -1.804771, -2.3201354, -2.818224, 4.1595464, -3.0426264, -1.2433869, 1.2761624]
Target sample: 115, Prediction:1, Target's Score:[-1.3218702, 8.408801, -0.47466794, -2.4811227, -3.0699546, -1.9599155, 2.9430988, -2.709294, -1.5835141, 2.305662]
Target sample: 121, Prediction:1, Target's Score:[-1.7398506, 8.58331, -2.3632133, 0.37639794, -1.5876251, -3.2187471, 3.3223367, -2.187522, -1.7603253, 0.62997055]
Target sample: 127, Prediction:1, Target's Score:[-1.4191672, 9.091065, -3.3065557, -0.8715695, -2.0742297, -2.2036495, 3.9691808, -3.225272, -1.8500248, 1.9456687]
Target sample: 133, Prediction:6, Target's Score:[-1.3913695, 3.6666048, -2.2707424, -1.3822156, -2.3519764, 0.49765572, 3.6748745, -0.846055, -1.1771958, 1.6283978]
Target sample: 139, Prediction:6, Target's Score:[-2.6517932, 1.9571925, -3.4210248, 0.38636252, -1.974588, -1.8395338, 6.328685, -3.4110777, 3.0234756, 1.6390318]
Current ATTACK acc on target samples: 29.167
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 03:00:08 Epoch 59, Val iteration 0, acc 91.600 (91.600)
2021-06-13 03:00:20 Epoch 59, Val iteration 19, acc 93.600 (92.900)
* Prec: 92.90000076293946
Per class accuracy =  [0.95127425 0.94494672 0.89055146 0.85450787 0.93325663 0.91304506
 0.94954421 0.94895263 0.94534165 0.95647623]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 1, 6, 1, 1, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 1, 6, 6, 6, 6, 9, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 8, 6, 6, 1, 1
ATTACK acc: 33.05084745762712
--------
------SUMMARY PRE DEFENSE------
TIME ELAPSED (mins): 17
TARGET INDEX: 10
ResNet50 8.333333333333334 8.474576271186441 95.46000137329102 90.84000205993652
DPN92 66.66666666666667 64.40677966101696 95.50000267028808 93.0000015258789
MobileNetV2 8.333333333333334 13.559322033898304 91.22000160217286 89.30000190734863
GoogLeNet 29.166666666666668 33.05084745762712 95.41000213623047 92.90000076293946
DEFENSE EVALUATION
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
ResNet50
[74, 80, 84, 86, 89] 5
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 03:00:25, Val iteration 0, acc 94.200 (94.200)
2021-06-13 03:00:36, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-13 03:00:38, Epoch 0, Iteration 7, loss 0.832 (0.276), acc 71.154 (93.400)
2021-06-13 03:01:39, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[1.9834878, 7.0735774, -3.782697, 1.4049928, -4.1350136, -2.4354186, -0.5809415, -3.8134246, 3.1489558, 1.5540658]
Target sample: 7, Prediction:1, Target's Score:[-0.4520575, 12.521741, -3.4028363, -2.1229637, -2.4657402, -4.2941394, -1.5861036, -3.7058377, 2.659522, 3.3148034]
Target sample: 13, Prediction:1, Target's Score:[0.838353, 9.182156, -2.3488624, -0.42357022, -4.175347, -5.2175164, -2.784613, -3.84203, 1.2791476, 8.06696]
Target sample: 19, Prediction:1, Target's Score:[0.3890772, 5.6406903, -0.50953966, 2.2501354, -4.1837835, -4.2093434, -1.886342, -2.9067664, 0.32698113, 5.598444]
Target sample: 25, Prediction:1, Target's Score:[0.38291228, 12.485496, -3.7505748, -0.0599128, -4.48375, -2.6651375, -2.5753956, -4.301776, 0.16597186, 5.32445]
Target sample: 31, Prediction:1, Target's Score:[-2.356219, 14.863314, -1.9349976, 0.6043837, -4.803564, -4.045213, -2.9692774, -4.214402, -0.5965499, 6.0578485]
Target sample: 37, Prediction:9, Target's Score:[3.264726, 5.930116, -1.6345494, -0.49124545, -5.1812396, -5.4049506, -5.626123, -3.972559, 0.87739927, 12.87966]
Target sample: 43, Prediction:1, Target's Score:[-0.42966354, 14.20073, -2.7675953, -1.6756756, -5.1690373, -5.2754645, -3.7244194, -3.9126992, 0.036348723, 9.331557]
Target sample: 49, Prediction:1, Target's Score:[0.49625418, 14.768285, -3.1418636, -2.0730197, -4.700574, -5.0963225, -3.3497934, -3.973759, 1.6111245, 6.035584]
Target sample: 55, Prediction:1, Target's Score:[-1.1220793, 19.069265, -4.0345807, -1.8320458, -4.9927883, -3.8770971, -2.0703585, -3.510029, 0.7262427, 2.2003314]
Target sample: 61, Prediction:1, Target's Score:[-0.7717684, 9.694657, -3.0138323, 2.8191726, -4.488887, -2.2983854, -1.2168547, -4.0420737, 0.04992511, 3.7403405]
Target sample: 67, Prediction:1, Target's Score:[-0.27110973, 7.909434, -1.4198608, 1.5797914, -4.71819, -3.1186695, -3.4073038, -3.9352515, 1.067459, 6.870922]
Target sample: 73, Prediction:1, Target's Score:[-1.4997019, 16.773418, -3.8985374, -2.2810993, -4.830921, -4.3835773, -2.2863953, -4.478361, 5.145302, 2.270388]
Target sample: 79, Prediction:1, Target's Score:[-0.8337307, 14.023642, -3.8027532, -1.8221096, -3.3144727, -3.6587262, -0.78384674, -4.248617, 4.559681, 0.31545338]
Target sample: 85, Prediction:1, Target's Score:[-0.5174529, 6.9054713, -1.0290956, 1.7541088, -3.538062, -4.755399, -2.2474213, -3.7323663, 3.9268541, 3.742129]
Target sample: 91, Prediction:1, Target's Score:[-1.1029739, 13.016251, -2.229502, -1.202448, -3.2208953, -4.0433517, -1.3603771, -4.1309104, 0.9446558, 3.823942]
Target sample: 97, Prediction:9, Target's Score:[-0.5301006, 9.058251, -1.2822508, 2.3965514, -5.581373, -3.290221, -4.0101433, -3.7275817, -1.5110126, 9.098812]
Target sample: 103, Prediction:1, Target's Score:[0.9891524, 14.254562, -3.1325123, -2.1627882, -4.1644945, -4.5025134, -3.03002, -3.887935, 1.8263419, 4.317577]
Target sample: 109, Prediction:1, Target's Score:[-0.1523205, 14.826564, -3.2465434, -2.0499122, -4.1253715, -4.6624885, -2.7087953, -4.200779, 3.073114, 3.7654228]
Target sample: 115, Prediction:1, Target's Score:[0.28212783, 14.324715, -2.8689802, -2.5183072, -4.644098, -5.121486, -3.670688, -4.566264, 3.2907093, 6.0713034]
Target sample: 121, Prediction:1, Target's Score:[-1.9341141, 14.8557, -2.436813, -1.3176343, -4.3840337, -4.585031, -2.1895382, -3.914629, 1.8051965, 4.623925]
Target sample: 127, Prediction:1, Target's Score:[-1.7374058, 15.550544, -3.1265721, 0.38829574, -4.614923, -3.8355258, -2.123239, -4.347631, 0.35903752, 4.027094]
Target sample: 133, Prediction:8, Target's Score:[-0.1250773, 5.045152, -1.4680545, 0.7537108, -4.3208327, -1.439941, -2.780609, -3.1072862, 5.0966196, 2.798894]
Target sample: 139, Prediction:1, Target's Score:[1.2158812, 5.6714554, -3.2994654, 2.3953054, -4.8208385, -3.466123, -0.51753974, -3.87647, 4.2160134, 2.9421875]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 03:02:38 Epoch 59, Val iteration 0, acc 91.200 (91.200)
2021-06-13 03:02:49 Epoch 59, Val iteration 19, acc 91.800 (91.670)
* Prec: 91.67000198364258
Per class accuracy =  [0.94493515 0.94435098 0.89709387 0.88734154 0.88455307 0.83936964
 0.91636257 0.94279809 0.95932848 0.95163528]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 9, 3, 9, 9, 8, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 9, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 8, 8, 1, 1, 1, 1, 1, 1, 1, 3, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1
ATTACK acc: 0.0
DPN92
[74, 80, 84, 86, 89] 27
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 03:02:53, Val iteration 0, acc 94.800 (94.800)
2021-06-13 03:03:14, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-13 03:03:19, Epoch 0, Iteration 7, loss 0.389 (0.345), acc 90.385 (91.800)
2021-06-13 03:05:59, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[2.4164703, 14.220523, -5.7044115, -2.1420174, -3.7996259, -2.847569, -2.189243, -4.0034957, 0.67093945, 4.210946]
Target sample: 7, Prediction:1, Target's Score:[1.3774703, 12.067497, -6.016208, -1.5367385, -4.103312, -4.2724757, -1.7136838, -3.8314595, 3.0784402, 5.7607913]
Target sample: 13, Prediction:1, Target's Score:[1.5192267, 7.4988494, -6.171324, -2.2912233, -1.3184049, -4.501207, -1.6626273, -2.2271385, 5.1790767, 4.690818]
Target sample: 19, Prediction:1, Target's Score:[0.8639117, 10.908495, -5.480966, -1.4627236, -2.388972, -3.2381253, -2.179715, -3.686069, 2.8917956, 4.5018325]
Target sample: 25, Prediction:1, Target's Score:[0.9630492, 15.257416, -6.042024, -0.49850863, -3.6157963, -3.5114708, -1.9976888, -4.0919976, 0.8527043, 3.5335023]
Target sample: 31, Prediction:1, Target's Score:[1.3695377, 15.11534, -5.8653173, 0.12452923, -3.2999096, -3.3724048, -2.1087089, -4.293938, 0.4440154, 2.7384238]
Target sample: 37, Prediction:1, Target's Score:[2.315371, 15.7780905, -6.4052143, -1.7306567, -3.7424169, -3.2926908, -2.5355446, -5.100992, 0.7647735, 4.8680606]
Target sample: 43, Prediction:1, Target's Score:[0.9418054, 14.376421, -6.013813, -1.090312, -4.2018237, -4.346512, -2.323182, -4.928622, 2.2826054, 6.2082095]
Target sample: 49, Prediction:1, Target's Score:[1.0032829, 14.8990755, -5.9195747, -1.2961241, -3.8142893, -3.2970312, -2.2565503, -4.684394, 1.1779898, 5.0552087]
Target sample: 55, Prediction:1, Target's Score:[0.83171934, 14.396768, -5.686197, 0.3541233, -4.0229516, -3.4107008, -2.4887013, -4.7886014, 1.4408736, 4.256735]
Target sample: 61, Prediction:1, Target's Score:[0.8802835, 10.285148, -6.606397, 1.6647522, -3.8143837, -2.4199352, -1.9030349, -3.7147806, 0.76328313, 5.6732073]
Target sample: 67, Prediction:1, Target's Score:[1.6130475, 9.555459, -5.474491, -1.7614621, -2.318209, -1.5097111, -2.918916, -3.2882237, 1.7186193, 5.106178]
Target sample: 73, Prediction:1, Target's Score:[1.2395855, 14.117812, -5.5551996, -1.3986716, -4.261482, -3.0934556, -2.0567167, -3.9995816, 2.6340222, 3.175966]
Target sample: 79, Prediction:1, Target's Score:[0.36758566, 13.592883, -5.5220394, -1.0367368, -3.4000175, -3.4286087, -1.4772735, -3.7736597, 2.7709665, 2.6800327]
Target sample: 85, Prediction:1, Target's Score:[-2.2474058, 5.593812, -5.914181, 2.1886923, 0.5569062, -1.766622, -1.9595757, -3.455651, 3.017354, 4.650257]
Target sample: 91, Prediction:1, Target's Score:[0.5901917, 13.66755, -5.786382, -0.65403205, -1.9250121, -3.1848123, -1.7204036, -3.1270852, 0.26378673, 2.6466954]
Target sample: 97, Prediction:1, Target's Score:[0.6554545, 15.157288, -6.365171, 1.3236849, -3.6887252, -3.668787, -2.3592117, -5.3975587, 1.2770821, 3.9883134]
Target sample: 103, Prediction:1, Target's Score:[0.94134086, 14.263464, -6.3590655, -0.60808533, -4.1247063, -4.2475595, -1.8765099, -4.7721157, 3.0442839, 4.6152735]
Target sample: 109, Prediction:1, Target's Score:[1.0300283, 16.491938, -6.1856246, -1.0254418, -4.0876966, -4.158956, -1.9769247, -4.9896817, 1.617027, 4.2001204]
Target sample: 115, Prediction:1, Target's Score:[1.3822476, 14.1846285, -5.7914705, -0.3482345, -3.5201511, -3.7847838, -2.3071263, -4.9551177, 1.2907033, 4.7278886]
Target sample: 121, Prediction:1, Target's Score:[-0.5514818, 13.952825, -6.1846414, 2.8759491, -3.4642138, -4.113115, -2.319857, -5.5429735, 1.6281049, 4.6514416]
Target sample: 127, Prediction:1, Target's Score:[-0.6378423, 12.369687, -6.584357, 0.7606271, -3.9112453, -4.153483, -1.9930463, -4.7379045, 3.1503716, 6.613375]
Target sample: 133, Prediction:1, Target's Score:[0.25720075, 10.860226, -5.955784, -1.7983882, -3.2791953, -4.1821876, -2.4180994, -3.571435, 6.16045, 4.717671]
Target sample: 139, Prediction:1, Target's Score:[2.514615, 13.4734335, -6.0603576, -1.8885789, -3.671828, -3.5578084, -1.8937645, -4.407772, 1.6083565, 4.735756]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 03:08:34 Epoch 59, Val iteration 0, acc 93.000 (93.000)
2021-06-13 03:08:55 Epoch 59, Val iteration 19, acc 93.600 (93.280)
* Prec: 93.28000144958496
Per class accuracy =  [0.96887102 0.97486757 0.87733966 0.8629216  0.94975588 0.89043018
 0.95316714 0.94250493 0.96329891 0.94572616]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 8, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 4, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
MobileNetV2
[80, 86] 46
Using Adam for retraining
2000
poison index =  74
poison index =  84
poison index =  89
497
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 03:08:59, Val iteration 0, acc 92.600 (92.600)
2021-06-13 03:09:05, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-13 03:09:06, Epoch 0, Iteration 7, loss 0.259 (0.329), acc 88.462 (88.800)
2021-06-13 03:09:34, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6]
Target sample: 1, Prediction:9, Target's Score:[-0.98697793, 4.206143, -4.4295926, 2.0871384, -5.128088, -2.2363164, 2.1181948, -3.3250413, 1.6758412, 6.4148664]
Target sample: 7, Prediction:9, Target's Score:[-2.589601, 0.9931231, -4.6147876, 4.646832, -5.1293106, -1.5383682, 4.537564, -3.7169547, 2.236585, 5.545776]
Target sample: 13, Prediction:3, Target's Score:[-2.2008634, -0.46974927, -3.42285, 5.8137107, -3.1475484, -2.0874577, 1.0422412, -1.8024235, 3.0536473, 3.5411575]
Target sample: 19, Prediction:3, Target's Score:[-3.2467701, 3.8060071, -3.2923803, 5.5498714, -1.0606531, -1.8505331, 1.7686149, 0.5206925, -3.24002, 1.4144924]
Target sample: 25, Prediction:1, Target's Score:[-0.8456928, 6.9929557, -3.0748737, 3.6017346, -1.9524758, -3.2085152, 2.7413018, -0.94995207, -5.075729, 2.200964]
Target sample: 31, Prediction:3, Target's Score:[-0.74308753, 2.9019523, -1.2345406, 2.9493895, 1.1784903, -3.7409332, 0.22446655, 0.15636456, -3.9821641, 2.6444154]
Target sample: 37, Prediction:9, Target's Score:[0.9232608, 2.3186636, -4.4357796, 4.7831473, -3.2048624, -3.1660326, -2.7900648, -1.7341948, -1.7999008, 9.482193]
Target sample: 43, Prediction:9, Target's Score:[-0.9909674, -0.07109208, -2.783823, 6.1155515, -2.7120972, -3.4957025, 0.9470099, -3.364174, -0.18190321, 6.898741]
Target sample: 49, Prediction:9, Target's Score:[-1.372722, 5.207233, -2.4178464, 3.3970904, -5.1986938, -2.3082445, 0.6716336, -4.5518246, 0.23999503, 6.770478]
Target sample: 55, Prediction:1, Target's Score:[-1.3237255, 6.444918, -0.90020365, 2.7875285, -5.3985577, -2.475734, -0.9398204, 0.18051527, -2.9874754, 5.044172]
Target sample: 61, Prediction:3, Target's Score:[-2.7726085, 4.5259013, -4.4026666, 6.7028027, -2.53387, -0.8032993, 3.8101778, -5.9769354, -3.491745, 5.3950906]
Target sample: 67, Prediction:9, Target's Score:[-0.19507645, 5.2155633, -2.812864, 3.1456506, -3.7703114, -0.9640211, -2.7074268, 0.84839207, -4.083506, 5.6866364]
Target sample: 73, Prediction:1, Target's Score:[-2.5829153, 8.024882, -1.8507057, 5.516044, -3.4729493, -3.6645694, -3.0700908, -3.343446, 2.7332826, 2.1558375]
Target sample: 79, Prediction:3, Target's Score:[-3.9189985, 4.470938, -2.565219, 5.4717245, -2.229934, -3.1398792, 0.101520866, -2.277772, 0.90039706, 3.5783288]
Target sample: 85, Prediction:6, Target's Score:[-3.7483864, 0.31249908, -0.51453924, 6.6307507, -1.2149367, -0.49340275, 6.7543707, -3.8327303, -5.2005296, 1.676388]
Target sample: 91, Prediction:3, Target's Score:[-1.4566746, 6.109604, -5.0302105, 7.506038, -1.6785201, -0.17626004, 1.496044, -0.88878936, -6.373856, 0.9099913]
Target sample: 97, Prediction:1, Target's Score:[-0.049618293, 8.120967, -4.760036, 3.9360392, -3.6899638, -1.1671394, -0.6544777, -2.1759944, -5.602145, 6.4765673]
Target sample: 103, Prediction:9, Target's Score:[-0.9433677, 3.4746163, -4.655259, 3.6421452, -0.5992781, -4.2475295, 2.1625896, -2.1106093, -1.3453288, 5.01229]
Target sample: 109, Prediction:9, Target's Score:[-0.26365355, 0.09584903, -1.4976009, 2.4791336, -1.6517593, -5.257354, 2.3866603, -2.631116, 3.160739, 3.5354106]
Target sample: 115, Prediction:9, Target's Score:[-2.9172778, 4.149844, -3.641133, 2.1396475, -4.192197, -0.71611935, 2.0654523, -4.012442, 1.4376727, 6.0866523]
Target sample: 121, Prediction:3, Target's Score:[-3.8546345, 3.4012089, -3.7024455, 7.737969, -3.530204, -2.367013, 3.0890243, -3.1186457, -0.35581103, 3.129263]
Target sample: 127, Prediction:1, Target's Score:[-3.0749323, 7.268194, -4.5247173, 6.1045737, -2.0861971, -2.4074285, 4.7777247, -5.0855656, -3.3476849, 2.8405776]
Target sample: 133, Prediction:3, Target's Score:[-1.8970139, 3.2154605, -3.1736844, 7.5841646, -5.1692886, -1.782638, 1.6306242, -3.018116, -2.1385515, 5.158154]
Target sample: 139, Prediction:3, Target's Score:[-2.7052653, 1.6894821, -4.5331807, 5.4618454, -3.3615627, -2.0139313, 2.9719253, -4.270658, 3.2511601, 3.888614]
Current ATTACK acc on target samples: 4.167
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 03:10:03 Epoch 59, Val iteration 0, acc 90.000 (90.000)
2021-06-13 03:10:09 Epoch 59, Val iteration 19, acc 90.200 (89.350)
* Prec: 89.35000152587891
Per class accuracy =  [0.92412239 0.93003997 0.84604721 0.8333582  0.88670741 0.81316882
 0.93409909 0.89210085 0.92527118 0.94294046]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 9, 3, 3, 8, 3, 9, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 9, 9, 9, 9, 9, 9, 9, 3, 9, 9, 9, 9, 9, 1, 9, 9, 9, 1, 3, 1, 3, 3, 3, 3, 1, 3, 9, 9, 9, 1, 9, 1, 1, 1, 1, 1, 3, 3, 1, 3, 9, 1, 3, 3, 6, 3, 3, 3, 3, 1, 1, 1, 1, 3, 1, 1, 1, 3, 9, 1, 3, 1, 6, 6, 3, 3, 1, 3, 3, 6, 3, 1, 1, 3, 6, 1, 1, 3, 1, 3, 1, 1, 3, 3, 9, 3, 3, 8, 3, 3, 8, 3
ATTACK acc: 4.237288135593221
GoogLeNet
[74, 80, 84, 86, 89] 22
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 03:10:12, Val iteration 0, acc 96.200 (96.200)
2021-06-13 03:10:25, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-13 03:10:27, Epoch 0, Iteration 7, loss 0.516 (0.991), acc 88.462 (79.200)
2021-06-13 03:11:38, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:8, Target's Score:[-0.3998469, 3.7386675, -3.1255653, -3.5298164, -3.268744, 2.8412602, -0.9049864, -2.75884, 7.553674, -0.03494264]
Target sample: 7, Prediction:8, Target's Score:[-3.640288, 5.6264935, -4.6686893, -3.3661213, -2.2756674, -1.6532364, -0.2453568, -3.5717843, 10.22017, 3.6687105]
Target sample: 13, Prediction:8, Target's Score:[-2.914964, 5.246727, -4.6907406, -2.0271018, -0.91051704, -2.9461734, 0.3468157, -2.5984435, 9.129271, 1.4443038]
Target sample: 19, Prediction:8, Target's Score:[-2.078897, 4.2483253, -5.269318, 2.0809689, -1.0271082, -4.7103696, 0.71768826, -2.511763, 7.0797586, 1.5315297]
Target sample: 25, Prediction:1, Target's Score:[-2.367413, 10.389687, -4.0276437, -2.373211, -1.915078, -3.5863283, -0.74714684, -2.1774042, 4.0631323, 2.813166]
Target sample: 31, Prediction:1, Target's Score:[-1.2675817, 7.6676273, -3.273534, -2.2996323, 1.6798369, -3.1912477, -0.87429196, -3.34251, 2.6060314, 2.3651648]
Target sample: 37, Prediction:1, Target's Score:[0.16629346, 11.285211, -4.7285175, -3.0687022, -3.95937, -1.2916024, -3.073852, -3.3736908, 1.80851, 6.3338203]
Target sample: 43, Prediction:1, Target's Score:[-1.7198807, 12.932716, -4.901135, -1.2071664, -3.892954, -2.4614472, -2.2291567, -3.3703237, 2.0136461, 4.9192114]
Target sample: 49, Prediction:1, Target's Score:[-3.5580044, 13.348346, -2.954807, -0.48090017, -2.5093422, -3.5623574, -3.0470622, -3.1596367, 1.4127201, 4.5892644]
Target sample: 55, Prediction:1, Target's Score:[-3.4990559, 15.81435, -3.2688744, -1.8499701, -3.094082, -2.5733564, -2.9760897, -1.9277575, -0.6693121, 4.131216]
Target sample: 61, Prediction:1, Target's Score:[-2.5888884, 7.8956614, -5.371492, 1.394948, -3.8939147, -0.42368123, 0.13651334, -3.98228, 4.0768666, 2.8343458]
Target sample: 67, Prediction:8, Target's Score:[-2.3519235, 4.7992625, -3.4109306, -2.45594, -3.456356, -1.1871147, -1.6271086, -1.3441218, 5.890842, 5.2408614]
Target sample: 73, Prediction:1, Target's Score:[-5.2833276, 14.240444, -3.2760596, -3.5642653, -3.0678685, -2.718329, -3.0400853, -2.2702928, 7.366455, 1.7152216]
Target sample: 79, Prediction:1, Target's Score:[-4.431557, 13.916219, -3.9304326, -4.6956897, -2.5258045, -1.2345827, -0.93130636, -2.3418422, 4.8574767, 1.4214435]
Target sample: 85, Prediction:8, Target's Score:[-3.4036517, 2.5536137, -4.788603, 2.8127122, 0.79679286, -0.96908754, -0.4313786, -2.798288, 5.5955324, 0.692958]
Target sample: 91, Prediction:1, Target's Score:[-3.2077408, 9.930958, -4.8278613, -1.9169084, 0.032305606, -2.8304799, -0.6956553, -2.4984891, 3.0869281, 3.0010993]
Target sample: 97, Prediction:1, Target's Score:[-1.9789953, 13.069161, -4.4595976, -3.228787, -2.9876673, -2.355776, -1.6940473, -3.5407825, 0.7016889, 6.5766277]
Target sample: 103, Prediction:1, Target's Score:[-0.5236829, 11.142675, -4.8900785, -3.1026492, -4.487948, -2.8530674, -1.680295, -3.5353324, 3.9708498, 6.0563164]
Target sample: 109, Prediction:1, Target's Score:[-0.53382033, 14.5679, -4.8372583, -3.8185053, -2.652953, -3.444846, -2.4786916, -3.3506517, 2.1540086, 4.4837584]
Target sample: 115, Prediction:1, Target's Score:[-1.2405559, 11.791088, -1.8515364, -5.20315, -3.462355, -2.3527455, -3.081852, -2.4056795, 1.4764264, 6.43579]
Target sample: 121, Prediction:1, Target's Score:[-3.1944842, 12.790838, -4.6112757, -1.5571816, -1.0430809, -3.4760606, -1.9721805, -2.2269974, 2.342787, 3.0222557]
Target sample: 127, Prediction:1, Target's Score:[-3.4333954, 13.276976, -4.7070847, -1.3095347, -3.6046379, -2.2394767, -1.4231756, -3.9131138, 2.9814994, 4.4595556]
Target sample: 133, Prediction:8, Target's Score:[-1.5841631, 6.559535, -4.083074, -2.6122239, -3.8906708, -0.20394817, -1.604872, -1.4434316, 7.380563, 1.5765808]
Target sample: 139, Prediction:8, Target's Score:[-3.1808834, 4.861354, -3.5961149, 1.1423498, -1.6221571, -1.6016636, 0.13548233, -3.7218623, 7.3568335, 0.3003065]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 03:12:48 Epoch 59, Val iteration 0, acc 93.800 (93.800)
2021-06-13 03:13:01 Epoch 59, Val iteration 19, acc 93.200 (92.520)
* Prec: 92.52000122070312
Per class accuracy =  [0.95689404 0.9594581  0.8883112  0.89094085 0.92825034 0.85064263
 0.95257197 0.9119802  0.95816481 0.95354912]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 1, 8, 1, 1, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 8, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 8, 1, 8, 8, 8, 8, 8, 1, 8
ATTACK acc: 0.0
------SUMMARY POST DEFENSE------
TIME ELAPSED (mins): 17
TARGET INDEX: 10
ResNet50 0.0 0.0 95.46000137329102 91.67000198364258 100.0
DPN92 0.0 0.0 95.50000267028808 93.28000144958496 100.0
MobileNetV2 4.166666666666667 4.237288135593221 91.22000160217286 89.35000152587891 40.0
GoogLeNet 0.0 0.0 95.41000213623047 92.52000122070312 100.0
True False False False False
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.300-droplayer0.000.t7
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
No specific indices are determined, so try to include whatever we find
In total, we found 92 images of target 11
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', eval_poisons_root='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=False, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=11, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/11/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
# Targets: 16, # Poisons: 5
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-13 03:13:18 Iteration 0 	 Training Loss: 9.139e-01 	 Loss in Target Net: 2.106e+00	  
 2021-06-13 03:14:13 Iteration 50 	 Training Loss: 2.073e-01 	 Loss in Target Net: 2.116e-01	  
 2021-06-13 03:15:07 Iteration 100 	 Training Loss: 1.888e-01 	 Loss in Target Net: 2.175e-01	  
 2021-06-13 03:16:03 Iteration 150 	 Training Loss: 1.792e-01 	 Loss in Target Net: 2.052e-01	  
 2021-06-13 03:17:00 Iteration 200 	 Training Loss: 1.712e-01 	 Loss in Target Net: 2.140e-01	  
 2021-06-13 03:17:56 Iteration 250 	 Training Loss: 1.691e-01 	 Loss in Target Net: 2.311e-01	  
 2021-06-13 03:18:50 Iteration 300 	 Training Loss: 1.656e-01 	 Loss in Target Net: 2.107e-01	  
 2021-06-13 03:19:42 Iteration 350 	 Training Loss: 1.647e-01 	 Loss in Target Net: 2.123e-01	  
 2021-06-13 03:20:41 Iteration 400 	 Training Loss: 1.638e-01 	 Loss in Target Net: 2.103e-01	  
 2021-06-13 03:21:34 Iteration 450 	 Training Loss: 1.618e-01 	 Loss in Target Net: 2.080e-01	  
 2021-06-13 03:22:27 Iteration 500 	 Training Loss: 1.651e-01 	 Loss in Target Net: 2.212e-01	  
 2021-06-13 03:23:20 Iteration 550 	 Training Loss: 1.612e-01 	 Loss in Target Net: 2.288e-01	  
 2021-06-13 03:24:13 Iteration 600 	 Training Loss: 1.644e-01 	 Loss in Target Net: 2.172e-01	  
 2021-06-13 03:25:07 Iteration 650 	 Training Loss: 1.611e-01 	 Loss in Target Net: 2.166e-01	  
 2021-06-13 03:26:04 Iteration 700 	 Training Loss: 1.625e-01 	 Loss in Target Net: 2.015e-01	  
 2021-06-13 03:26:56 Iteration 750 	 Training Loss: 1.636e-01 	 Loss in Target Net: 1.953e-01	  
 2021-06-13 03:27:48 Iteration 800 	 Training Loss: 1.620e-01 	 Loss in Target Net: 1.795e-01	  
 2021-06-13 03:28:41 Iteration 850 	 Training Loss: 1.616e-01 	 Loss in Target Net: 1.917e-01	  
 2021-06-13 03:29:34 Iteration 900 	 Training Loss: 1.623e-01 	 Loss in Target Net: 1.749e-01	  
 2021-06-13 03:30:26 Iteration 950 	 Training Loss: 1.633e-01 	 Loss in Target Net: 1.802e-01	  
 2021-06-13 03:31:18 Iteration 999 	 Training Loss: 1.619e-01 	 Loss in Target Net: 1.659e-01	  
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 03:31:23, Val iteration 0, acc 94.200 (94.200)
2021-06-13 03:31:33, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-13 03:31:38, Epoch 0, Iteration 7, loss 0.597 (0.846), acc 76.923 (85.600)
2021-06-13 03:32:39, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-3.544169, 18.727629, -2.1744192, -0.6462452, -3.834652, -4.6495705, 3.8755326, -3.3885474, -1.0623734, -2.9421446]
Target sample: 7, Prediction:1, Target's Score:[-3.1318958, 15.672186, -3.2095475, -0.93241405, -4.1579537, -3.1036878, 4.324466, -3.873333, -4.3446603, 3.1065922]
Target sample: 13, Prediction:1, Target's Score:[-4.2317944, 11.343987, -0.06567703, -1.5441327, -3.8143647, -2.7979014, 3.0864353, -4.6289144, -6.1368723, 9.13249]
Target sample: 19, Prediction:1, Target's Score:[-3.5263996, 16.156244, -3.5898335, -0.09293168, -3.6712968, -2.9235766, 5.0502954, -3.4208794, -3.0358036, -0.6106471]
Target sample: 25, Prediction:1, Target's Score:[-5.1308994, 17.790257, -0.68023896, -1.0482565, -4.132328, -4.4051056, 4.8540425, -3.8868551, -4.1423306, 1.1430205]
Target sample: 31, Prediction:1, Target's Score:[-5.857544, 19.232391, -0.6554162, 0.1772749, -4.2465177, -4.6762486, 4.970588, -4.2306166, -4.446086, 0.11750946]
Target sample: 37, Prediction:1, Target's Score:[-3.6258855, 19.335018, -2.6389906, -1.282576, -3.7744932, -4.378191, 2.6557484, -3.596905, -2.614369, 0.27423292]
Target sample: 43, Prediction:1, Target's Score:[-2.6881843, 19.327267, -3.5924964, -1.7209837, -3.9821265, -3.7936287, 2.0475373, -3.3548238, -2.4155383, 0.5396061]
Target sample: 49, Prediction:1, Target's Score:[-4.3822155, 19.701674, -1.6476084, -1.7694905, -4.5439277, -4.537327, 3.242662, -3.753439, -4.0228286, 2.0806837]
Target sample: 55, Prediction:1, Target's Score:[-2.9092705, 11.392139, -1.9568046, -1.8226072, -3.438517, -4.299079, 4.6381326, -3.2920663, -3.8816485, 5.885139]
Target sample: 61, Prediction:1, Target's Score:[-3.8389986, 13.05353, -2.563788, -0.8463712, -3.4077747, -4.0856504, 8.870637, -2.6554718, -1.9188794, -2.2922294]
Target sample: 67, Prediction:1, Target's Score:[-3.8209708, 13.471089, -1.4979736, -1.5120687, -3.7402742, -4.313808, 7.3080263, -3.138079, -2.651164, 0.2166068]
Target sample: 73, Prediction:1, Target's Score:[-3.4034765, 18.053299, -2.7256837, -0.38351074, -4.0478477, -4.336391, 4.3952966, -3.481762, -2.761878, -0.9549363]
Target sample: 79, Prediction:1, Target's Score:[-4.2283106, 20.8016, -2.6569111, -1.4765695, -4.258628, -5.0074363, 3.9209864, -3.3851216, -2.624706, -0.7164372]
Target sample: 85, Prediction:1, Target's Score:[-3.5751479, 18.55956, -2.0566413, 0.3092724, -4.0665927, -5.01479, 3.9122, -3.439148, 0.24381669, -4.4930096]
Target sample: 91, Prediction:1, Target's Score:[-3.5439343, 18.006443, -3.273399, -1.0048639, -4.492208, -2.8935556, 4.6441355, -3.8368518, -4.104633, 0.86019903]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 03:33:38 Epoch 59, Val iteration 0, acc 91.000 (91.000)
2021-06-13 03:33:49 Epoch 59, Val iteration 19, acc 92.200 (91.810)
* Prec: 91.81000137329102
Per class accuracy =  [0.95917741 0.93805303 0.86011233 0.8525902  0.95161389 0.82048954
 0.94274299 0.93378679 0.95809944 0.96354317]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 03:34:00, Val iteration 0, acc 94.800 (94.800)
2021-06-13 03:34:22, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-13 03:34:35, Epoch 0, Iteration 7, loss 0.616 (0.468), acc 88.462 (89.600)
2021-06-13 03:37:15, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-0.7162594, 14.675372, -3.5162659, -2.9601467, -3.102521, -5.1441216, 3.9577382, -2.4591622, 0.5784806, -0.74211293]
Target sample: 7, Prediction:1, Target's Score:[-0.75276303, 13.098375, -3.3884344, -2.8177488, -2.2728527, -4.763422, 4.990384, -2.7796826, -1.1499343, 0.44451737]
Target sample: 13, Prediction:1, Target's Score:[-1.1183305, 15.50855, -3.3351433, -3.1870184, -2.76346, -5.4163694, 3.8469534, -3.2984133, -0.92471457, 1.3117815]
Target sample: 19, Prediction:1, Target's Score:[-1.4332391, 10.746815, -3.0877912, -1.5291045, -3.4029295, -4.7810583, 6.028004, -2.2118306, 1.6154194, -1.4256691]
Target sample: 25, Prediction:1, Target's Score:[-1.4667637, 14.742003, -2.8838675, -2.7420309, -2.4710534, -5.32837, 4.289876, -3.0830011, -1.1137357, 0.6794408]
Target sample: 31, Prediction:1, Target's Score:[-0.3494963, 13.4390745, -3.2539723, -3.133057, -1.7495159, -5.060455, 4.533449, -2.9024587, -1.2660289, 0.33736363]
Target sample: 37, Prediction:1, Target's Score:[-0.45031872, 16.28182, -3.898952, -3.552028, -2.704665, -5.4521017, 3.2062824, -2.9448028, -0.5120616, 0.64858454]
Target sample: 43, Prediction:1, Target's Score:[-0.9267262, 12.831893, -3.8860025, -2.3479207, -2.5071714, -5.0305905, 4.3739576, -2.9135075, 0.9101209, 0.04640987]
Target sample: 49, Prediction:1, Target's Score:[-1.1827887, 15.200764, -2.8890145, -3.3303714, -2.641005, -5.2864566, 4.5960674, -2.931064, -0.85812473, -0.04993855]
Target sample: 55, Prediction:1, Target's Score:[-1.9921577, 10.448572, -2.9253473, -2.3931925, -2.2723908, -4.766685, 6.6267776, -3.200338, -1.4362409, 2.5245702]
Target sample: 61, Prediction:1, Target's Score:[-1.7513032, 10.475603, -3.342564, -1.2861097, -1.4476913, -5.0416894, 7.350603, -3.1235335, 0.19450065, -1.4586625]
Target sample: 67, Prediction:1, Target's Score:[-1.748067, 11.393071, -2.7115185, -2.1531706, -2.247635, -5.059553, 7.145873, -2.8524213, -1.0582365, -0.108173236]
Target sample: 73, Prediction:1, Target's Score:[-0.52465135, 13.306421, -3.5249755, -2.5540633, -2.2636304, -5.251617, 4.898583, -3.0855863, -0.6752471, 0.2681389]
Target sample: 79, Prediction:1, Target's Score:[-0.8870668, 13.747892, -3.4908557, -2.7582114, -2.863498, -5.2469554, 4.7853994, -2.8093266, 0.30969903, -0.20677869]
Target sample: 85, Prediction:1, Target's Score:[-0.48964888, 14.063495, -3.6006196, -2.6128793, -2.668494, -5.2276044, 4.039488, -2.6779723, 0.8219192, -1.092893]
Target sample: 91, Prediction:1, Target's Score:[-0.90793234, 14.699616, -3.369602, -3.4471123, -2.5312717, -3.861936, 3.5238752, -2.7304964, -0.8848237, 0.11277713]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 03:39:51 Epoch 59, Val iteration 0, acc 92.400 (92.400)
2021-06-13 03:40:12 Epoch 59, Val iteration 19, acc 92.200 (92.830)
* Prec: 92.83000144958496
Per class accuracy =  [0.94346571 0.96384831 0.86634529 0.83189173 0.95830575 0.88598825
 0.9622519  0.94728452 0.96506294 0.95963024]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 03:40:16, Val iteration 0, acc 92.600 (92.600)
2021-06-13 03:40:22, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-13 03:40:24, Epoch 0, Iteration 7, loss 0.453 (0.304), acc 80.769 (89.600)
2021-06-13 03:40:52, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-2.1062467, 10.242057, -1.1888798, -1.0389311, -2.2230036, -1.7358745, 4.234592, -3.3485749, -3.7383235, 1.3022263]
Target sample: 7, Prediction:1, Target's Score:[-0.8166871, 8.596501, -0.78540015, 1.1119419, -3.3110373, -2.557563, 7.603034, -5.8279433, -4.7050514, 1.0882641]
Target sample: 13, Prediction:1, Target's Score:[-1.6922936, 10.081541, -2.7378397, -2.0971828, -4.6967435, -0.8793209, 7.825814, -6.7980022, -3.47969, 4.88655]
Target sample: 19, Prediction:1, Target's Score:[-2.708388, 14.767831, -6.195078, 2.3221426, -5.8995786, -2.3314416, 3.955167, -3.822245, -0.38895968, 0.7506522]
Target sample: 25, Prediction:1, Target's Score:[-3.0493796, 7.128471, -1.270552, 2.1800463, -2.383412, -3.8246667, 6.173087, -4.518336, -2.451937, 2.4134083]
Target sample: 31, Prediction:6, Target's Score:[-1.9463263, 11.2377, -3.7742825, 0.85153055, -6.4552894, -1.9329982, 11.486242, -7.387961, -4.805998, 3.1682117]
Target sample: 37, Prediction:1, Target's Score:[-0.69931173, 12.9687805, -3.1691806, -1.2145308, -0.28339475, -2.3186643, -0.21716398, -3.9090297, -4.3970604, 3.6616156]
Target sample: 43, Prediction:1, Target's Score:[-0.79750293, 14.954547, -3.2325346, 0.5662903, 2.0662186, -4.000062, -2.4367156, -3.8589876, -4.2566833, 1.4798768]
Target sample: 49, Prediction:1, Target's Score:[-1.8149129, 11.367187, -0.9813649, -0.12450436, -5.8022337, -2.7085052, 10.000224, -5.857459, -1.6526355, -1.981472]
Target sample: 55, Prediction:1, Target's Score:[-1.4528497, 9.531001, -2.7856627, -0.72240746, -4.566982, -3.1616483, 9.460693, -4.223794, -3.521214, 1.8340333]
Target sample: 61, Prediction:1, Target's Score:[-2.5114036, 8.250926, -2.915647, 1.519661, -2.3639896, -2.2461572, 7.772456, -4.876129, -1.975926, -0.26018822]
Target sample: 67, Prediction:6, Target's Score:[-2.4275668, 9.536901, -2.6168745, 0.21744972, -3.862698, -3.5457335, 10.270499, -4.6685176, -2.2924435, -0.18955636]
Target sample: 73, Prediction:1, Target's Score:[-1.0279813, 13.184033, -3.8204243, 0.1754582, -4.6163726, -2.5542953, 7.02368, -4.8175316, -3.61046, 0.50713587]
Target sample: 79, Prediction:1, Target's Score:[-1.9061594, 8.809546, -1.5652672, 1.5415422, 1.1187898, -2.8000772, 3.560599, -4.9189835, -5.787958, 2.366889]
Target sample: 85, Prediction:1, Target's Score:[0.90840584, 11.954716, -0.32248372, 1.4707209, -2.387358, -3.8141088, -1.001435, -2.905237, -5.6102433, 2.1266906]
Target sample: 91, Prediction:1, Target's Score:[-1.70118, 10.527605, -2.7986157, -0.715009, -4.4666805, -1.4499958, 6.561142, -5.186101, -4.3894453, 3.9927466]
Current ATTACK acc on target samples: 12.500
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 03:41:19 Epoch 59, Val iteration 0, acc 89.600 (89.600)
2021-06-13 03:41:26 Epoch 59, Val iteration 19, acc 90.200 (89.460)
* Prec: 89.46000099182129
Per class accuracy =  [0.92432414 0.92788952 0.84202549 0.82881411 0.88721775 0.8272464
 0.93479075 0.89282296 0.92906123 0.94683044]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 1, 6, 6, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 15.789473684210526
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 03:41:33, Val iteration 0, acc 96.200 (96.200)
2021-06-13 03:41:46, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-13 03:41:52, Epoch 0, Iteration 7, loss 0.796 (0.753), acc 76.923 (82.000)
2021-06-13 03:43:03, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-3.1635857, 7.7460775, -3.1849234, 0.014301181, -2.1722593, -2.7631826, 5.958183, -2.309352, -0.38645247, 0.19988437]
Target sample: 7, Prediction:1, Target's Score:[-3.403697, 8.045993, -3.2989137, -0.1642242, -2.1549847, -2.5170445, 5.568687, -1.9429778, -2.660436, 2.457497]
Target sample: 13, Prediction:6, Target's Score:[-3.6586423, 5.161246, -2.6861522, 0.83184135, -2.0056171, -2.5862896, 9.345385, -2.3330345, -1.268007, -0.87724894]
Target sample: 19, Prediction:1, Target's Score:[-3.2749577, 6.136094, -2.1959908, 0.5556784, -2.7269413, -0.6332504, 4.854643, -2.367341, 0.53184056, -0.9386401]
Target sample: 25, Prediction:1, Target's Score:[-2.5966094, 7.1445074, -3.7167842, 2.7433352, -0.6532205, -2.6528592, 4.430589, -2.2832913, -1.825532, -0.65121204]
Target sample: 31, Prediction:6, Target's Score:[-3.076035, 4.5179205, -1.6440359, 1.8505255, -1.3967748, -2.9204106, 6.257797, -2.3676805, -1.2882127, 0.006720679]
Target sample: 37, Prediction:1, Target's Score:[-3.0018678, 9.404626, -3.3677576, 0.432393, -0.57991725, -3.0780773, 3.2757418, -2.844395, -1.9573005, 1.657879]
Target sample: 43, Prediction:1, Target's Score:[-2.8278055, 9.76076, -3.7506855, 0.8059563, -0.8309323, -2.9720173, 2.298344, -2.9568396, -1.7855197, 2.2077847]
Target sample: 49, Prediction:1, Target's Score:[-3.4875934, 7.6167254, -2.2195518, 2.453775, -1.5156889, -3.6716108, 5.2654138, -2.441059, -1.690116, -0.37357053]
Target sample: 55, Prediction:6, Target's Score:[-3.1792314, 2.4151735, -2.530116, 1.3593767, -1.6464044, -2.141104, 11.029793, -2.5573707, -1.4164838, -1.415543]
Target sample: 61, Prediction:6, Target's Score:[-3.1388214, 1.9081486, -2.0849326, 0.21464372, -0.9145149, -2.2994103, 11.659312, -2.6467934, 0.40381446, -3.1846895]
Target sample: 67, Prediction:6, Target's Score:[-3.642535, 5.7972074, -1.4914168, 1.1821741, -2.9494538, -2.2112024, 8.973295, -2.2291243, -2.2534895, -1.2564384]
Target sample: 73, Prediction:1, Target's Score:[-2.7552683, 6.455526, -2.4078698, 3.0806441, -1.287522, -2.9111307, 3.416851, -2.1530812, -1.8042505, 0.31423435]
Target sample: 79, Prediction:1, Target's Score:[-3.44046, 8.223924, -3.0817986, 1.3107097, -1.0039546, -3.5574918, 4.0994244, -2.5750751, -1.7941631, 1.7616771]
Target sample: 85, Prediction:1, Target's Score:[-2.7556486, 8.928983, -2.593428, 1.4416057, -1.6267612, -3.1937068, 3.0661724, -2.2432628, -1.5853473, 0.5086662]
Target sample: 91, Prediction:6, Target's Score:[-3.9273047, 5.0664167, -3.885917, -0.8635837, -2.1349344, -1.3833698, 8.71591, -3.0312383, -2.7697742, 4.12701]
Current ATTACK acc on target samples: 37.500
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 03:44:13 Epoch 59, Val iteration 0, acc 93.400 (93.400)
2021-06-13 03:44:26 Epoch 59, Val iteration 19, acc 91.800 (92.130)
* Prec: 92.13000144958497
Per class accuracy =  [0.94126115 0.92223902 0.8861494  0.8350345  0.94313703 0.8835378
 0.96105225 0.93338462 0.94855948 0.95612345]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 6, 1, 6, 6, 6, 6, 1, 1, 6, 6, 1, 6, 6, 1, 1, 6, 6, 1, 1, 6, 6, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1
ATTACK acc: 39.473684210526315
--------
------SUMMARY PRE DEFENSE------
TIME ELAPSED (mins): 18
TARGET INDEX: 11
ResNet50 0.0 0.0 95.46000137329102 91.81000137329102
DPN92 0.0 0.0 95.50000267028808 92.83000144958496
MobileNetV2 12.5 15.789473684210526 91.22000160217286 89.46000099182129
GoogLeNet 37.5 39.473684210526315 95.41000213623047 92.13000144958497
DEFENSE EVALUATION
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
ResNet50
[74, 80, 86, 89] 4
Using Adam for retraining
2000
poison index =  84
499
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 03:44:31, Val iteration 0, acc 94.200 (94.200)
2021-06-13 03:44:41, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-13 03:44:43, Epoch 0, Iteration 7, loss 0.250 (0.196), acc 96.154 (96.400)
2021-06-13 03:45:44, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6]
Target sample: 1, Prediction:1, Target's Score:[-4.5559516, 15.505796, -1.8611503, -1.2588589, -3.0120332, -1.2801489, -1.9968644, -1.5608759, -0.8912794, 1.5081666]
Target sample: 7, Prediction:1, Target's Score:[-2.7377338, 10.115185, -1.3225676, 0.91871315, -2.325274, -1.2264382, -1.5841739, -2.2189596, -2.2654357, 3.1144779]
Target sample: 13, Prediction:1, Target's Score:[-4.280225, 10.041796, 0.663271, 0.56607354, -2.4405236, -1.3115243, -1.8597219, -2.5799003, -3.66531, 5.3707623]
Target sample: 19, Prediction:1, Target's Score:[-3.8190722, 11.983446, -1.469942, -0.2937926, -2.5093105, -1.0652268, -1.5127779, -1.8285831, -1.7135133, 2.7270448]
Target sample: 25, Prediction:1, Target's Score:[-4.9691505, 13.4759655, 0.3564686, 0.5400177, -2.2304285, -1.6745434, -2.0848987, -2.604345, -2.9381127, 2.705307]
Target sample: 31, Prediction:1, Target's Score:[-4.829526, 12.510196, 0.003870682, 1.4897493, -2.622304, -1.626119, -1.8290687, -2.3731432, -3.442425, 3.292482]
Target sample: 37, Prediction:1, Target's Score:[-3.7605586, 12.421958, -1.0471567, -0.5423156, -1.9601328, -1.3924087, -2.4928975, -1.8647562, -2.0161402, 3.175633]
Target sample: 43, Prediction:1, Target's Score:[-3.7971642, 13.957444, -1.6078258, -1.0946207, -2.6244793, -0.950279, -2.429496, -1.7526699, -1.8075513, 2.6706743]
Target sample: 49, Prediction:1, Target's Score:[-4.6744037, 16.94415, -1.9674084, -2.1821709, -3.1401215, -1.2360809, -1.72016, -1.3802232, -1.516333, 1.5174129]
Target sample: 55, Prediction:1, Target's Score:[-2.5973773, 9.170029, -1.798024, -0.9165804, -3.1390653, -1.8401622, 1.0547785, -1.5080799, -1.7265397, 3.7548873]
Target sample: 61, Prediction:1, Target's Score:[-4.0485954, 12.562521, -1.9095738, -1.448297, -2.781346, -1.3476336, 0.8497748, -1.3926493, -0.41009736, 0.42351893]
Target sample: 67, Prediction:1, Target's Score:[-4.372605, 14.052258, -0.80663157, -0.70276964, -2.873476, -2.0661643, -1.5354667, -2.192951, -1.72415, 2.7891772]
Target sample: 73, Prediction:1, Target's Score:[-4.6476808, 15.97099, -1.970234, -1.2204045, -3.2663682, -1.3590996, -1.3704627, -1.7158046, -1.8215536, 2.0293074]
Target sample: 79, Prediction:1, Target's Score:[-4.579628, 16.351673, -1.9580035, -0.7779379, -3.1957712, -1.7260926, -2.591448, -1.6759825, -1.9783009, 2.7770543]
Target sample: 85, Prediction:1, Target's Score:[-3.8808143, 13.530159, -1.5886873, -0.17167912, -2.7370362, -1.657527, -2.2430625, -1.7457628, -0.9058661, 1.9397306]
Target sample: 91, Prediction:1, Target's Score:[-3.4540439, 12.524126, -1.6786888, -0.12465207, -2.778705, -0.78814894, -1.6629969, -1.9529538, -2.0569487, 2.5049858]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 03:46:44 Epoch 59, Val iteration 0, acc 88.000 (88.000)
2021-06-13 03:46:54 Epoch 59, Val iteration 19, acc 91.000 (89.780)
* Prec: 89.78000106811524
Per class accuracy =  [0.89617319 0.94177742 0.80430719 0.85861288 0.91950715 0.80453638
 0.96906805 0.86356917 0.97191956 0.9494335 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
DPN92
[74, 80, 84, 86, 89] 27
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 03:46:59, Val iteration 0, acc 94.800 (94.800)
2021-06-13 03:47:20, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-13 03:47:25, Epoch 0, Iteration 7, loss 0.676 (0.355), acc 88.462 (91.600)
2021-06-13 03:50:05, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[0.14347756, 19.01023, -4.5899096, -3.5637336, -3.137102, -2.6467133, -3.0366883, -3.1772878, 0.85948205, 0.89353454]
Target sample: 7, Prediction:1, Target's Score:[0.56695575, 17.83361, -4.3612003, -3.318127, -3.4849539, -2.247057, -2.4140012, -3.7404382, -0.08338641, 2.006787]
Target sample: 13, Prediction:1, Target's Score:[0.06911923, 19.721098, -4.286865, -3.6219144, -3.8804905, -2.905892, -2.4596694, -4.148801, 0.1037743, 2.208633]
Target sample: 19, Prediction:1, Target's Score:[-0.17299189, 17.23174, -4.2308326, -2.8568673, -3.3646865, -2.7698143, -2.2417579, -3.556641, 1.072202, 1.584171]
Target sample: 25, Prediction:1, Target's Score:[-0.40168592, 19.520279, -4.321538, -3.016966, -3.6314561, -2.660759, -2.6743815, -3.9356992, -0.034404725, 1.9522144]
Target sample: 31, Prediction:1, Target's Score:[0.5513553, 18.620853, -4.2595863, -3.0801942, -3.5466743, -2.8005548, -2.6725929, -3.8522565, -0.06115774, 1.8755376]
Target sample: 37, Prediction:1, Target's Score:[0.36791286, 19.939512, -4.568136, -3.8712056, -3.3252883, -2.5534124, -3.2478456, -3.6130118, 0.29573542, 1.3685029]
Target sample: 43, Prediction:1, Target's Score:[0.5176902, 18.040651, -4.6265464, -3.3288956, -3.0067554, -2.7996593, -2.7866032, -3.571923, 1.0968161, 1.2102438]
Target sample: 49, Prediction:1, Target's Score:[0.44793904, 18.663328, -3.6680877, -3.895539, -3.64784, -2.1834812, -2.2045708, -3.5136902, -0.330076, 1.1082225]
Target sample: 55, Prediction:1, Target's Score:[-0.028598592, 17.4512, -4.327766, -2.9777257, -3.3798125, -2.8360422, -1.9480362, -3.7184565, 0.14709583, 2.356592]
Target sample: 61, Prediction:1, Target's Score:[-0.3107415, 17.354542, -4.558451, -2.6273532, -2.7702482, -2.7349064, -2.1177719, -3.4747984, 0.9312155, 1.0322782]
Target sample: 67, Prediction:1, Target's Score:[-0.20997955, 17.198656, -4.096356, -3.070971, -2.8320777, -2.7082114, -2.0384188, -3.0637183, 0.21812591, 1.3180337]
Target sample: 73, Prediction:1, Target's Score:[0.5869163, 19.090538, -4.772065, -3.206887, -3.4828835, -2.8666832, -2.7933452, -3.9577973, 0.118643366, 2.068718]
Target sample: 79, Prediction:1, Target's Score:[0.38379166, 19.010906, -4.5623903, -3.4963095, -3.3760343, -2.8405333, -2.8506408, -3.5465422, 0.73438984, 1.3095382]
Target sample: 85, Prediction:1, Target's Score:[-0.19675209, 18.29875, -4.4099207, -3.0051613, -3.1122603, -2.6657248, -2.811939, -3.3311415, 1.2823467, 0.6870923]
Target sample: 91, Prediction:1, Target's Score:[0.5410618, 18.585306, -4.236413, -3.2529147, -3.8014586, -1.5208021, -3.052821, -3.916844, -0.15460935, 1.585827]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 03:52:41 Epoch 59, Val iteration 0, acc 94.000 (94.000)
2021-06-13 03:53:02 Epoch 59, Val iteration 19, acc 93.800 (93.030)
* Prec: 93.03000183105469
Per class accuracy =  [0.94584616 0.97851446 0.87860965 0.87413566 0.95584262 0.88192788
 0.94369598 0.92542084 0.97201816 0.95082424]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
MobileNetV2
[74, 80, 86, 89] 47
Using Adam for retraining
2000
poison index =  84
499
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 03:53:05, Val iteration 0, acc 92.600 (92.600)
2021-06-13 03:53:11, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-13 03:53:12, Epoch 0, Iteration 7, loss 0.162 (0.288), acc 94.231 (91.200)
2021-06-13 03:53:41, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6]
Target sample: 1, Prediction:1, Target's Score:[-0.90481275, 13.63593, -1.2489623, -1.6140593, -3.5893426, -2.0888128, 0.013377332, -3.4584553, -2.3854005, 2.247345]
Target sample: 7, Prediction:1, Target's Score:[0.21889809, 13.564136, -1.7092608, 0.43339062, -5.2694488, -3.1831558, 3.2101266, -6.33714, -2.7198093, 2.4263966]
Target sample: 13, Prediction:1, Target's Score:[-0.38307032, 14.539379, -3.2154517, -2.7010694, -6.182687, -1.8742591, 2.5734684, -7.027421, -1.8159403, 6.79255]
Target sample: 19, Prediction:1, Target's Score:[-1.777927, 17.772356, -6.8904157, 2.079334, -6.6745033, -3.0043492, -0.00031114998, -3.5633152, 0.30445316, 2.453115]
Target sample: 25, Prediction:1, Target's Score:[-1.8889301, 10.496554, -1.3139702, 1.4610554, -3.4109037, -4.4041977, 2.443892, -4.848189, -1.417334, 3.4776647]
Target sample: 31, Prediction:1, Target's Score:[-1.1166995, 16.233063, -4.796097, 0.48287767, -7.8370595, -2.4493794, 6.4244323, -7.503618, -3.2290463, 4.517138]
Target sample: 37, Prediction:1, Target's Score:[0.8724084, 16.115114, -3.5741818, -1.8295898, -1.0917407, -2.8404834, -4.0339427, -4.0050316, -3.0702958, 4.1768036]
Target sample: 43, Prediction:1, Target's Score:[1.1982416, 16.996193, -3.4863605, -0.623054, 1.0166211, -4.421517, -5.1959033, -3.9418614, -2.8597832, 2.0763478]
Target sample: 49, Prediction:1, Target's Score:[-1.0476127, 15.957641, -1.3877827, -0.6541925, -7.3418255, -3.3491678, 5.349512, -5.8106475, -0.5502494, -0.5407731]
Target sample: 55, Prediction:1, Target's Score:[-0.6607694, 13.660932, -3.3903885, -1.1573814, -5.876056, -3.6690254, 4.1093144, -3.8515065, -2.2628953, 3.7135262]
Target sample: 61, Prediction:1, Target's Score:[-1.7269641, 12.786103, -4.033694, 1.0672071, -3.0961268, -3.2448506, 3.207103, -4.762486, -0.80294794, 1.2137412]
Target sample: 67, Prediction:1, Target's Score:[-1.3329886, 14.96472, -3.877016, -0.5598597, -5.957794, -4.201783, 5.9600873, -5.25828, -0.67017347, 1.5834467]
Target sample: 73, Prediction:1, Target's Score:[0.47704512, 17.391249, -4.4184017, -0.57599884, -6.2539864, -2.8517587, 1.7917817, -4.8385267, -2.0217636, 1.9918587]
Target sample: 79, Prediction:1, Target's Score:[-0.9384635, 12.748684, -1.9556195, 0.71792674, -0.6407921, -3.3442338, -0.14489794, -5.024603, -3.955015, 3.2175324]
Target sample: 85, Prediction:1, Target's Score:[1.9599499, 14.254479, -0.7627076, 1.1099422, -3.4672818, -4.0793266, -3.088425, -3.410907, -4.411621, 2.5582867]
Target sample: 91, Prediction:1, Target's Score:[-1.1140485, 14.680067, -3.70631, -1.2701228, -5.896974, -1.5682782, 2.421125, -5.373512, -2.9602275, 5.4334884]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 03:54:09 Epoch 59, Val iteration 0, acc 89.600 (89.600)
2021-06-13 03:54:15 Epoch 59, Val iteration 19, acc 89.600 (89.470)
* Prec: 89.47000083923339
Per class accuracy =  [0.91971998 0.93447182 0.84834868 0.83146529 0.89509332 0.82068058
 0.93690968 0.88639247 0.93017335 0.94208146]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 1.3157894736842106
GoogLeNet
[74, 80, 86, 89] 21
Using Adam for retraining
2000
poison index =  84
499
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 03:54:18, Val iteration 0, acc 96.200 (96.200)
2021-06-13 03:54:31, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-13 03:54:33, Epoch 0, Iteration 7, loss 0.916 (1.153), acc 73.077 (74.200)
2021-06-13 03:55:45, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6]
Target sample: 1, Prediction:1, Target's Score:[-4.1592817, 14.542648, -3.7782452, 1.6966352, -3.4507332, -2.9904964, 2.6695952, -3.5789528, -0.88348216, -0.12755543]
Target sample: 7, Prediction:1, Target's Score:[-4.236509, 13.32324, -2.9171278, 2.8612757, -3.8953366, -1.7560247, 2.247891, -4.029212, -3.571761, 1.9043041]
Target sample: 13, Prediction:1, Target's Score:[-4.647566, 11.73722, -3.4244204, 4.878289, -3.480411, -2.3013055, 5.1663923, -3.8110569, -3.1607153, -1.0356454]
Target sample: 19, Prediction:1, Target's Score:[-3.9482653, 9.695485, -1.3878802, 1.2364064, -4.9194407, 1.6186833, 2.5353224, -3.0233696, -0.51064426, -1.3736845]
Target sample: 25, Prediction:1, Target's Score:[-3.8074653, 12.045742, -4.1842413, 5.3639717, -3.3156407, -1.0750307, 2.949343, -3.4295595, -3.5048387, -1.1106278]
Target sample: 31, Prediction:1, Target's Score:[-4.4502606, 9.096004, -1.6775205, 3.7525566, -4.0922713, -1.779817, 4.8626537, -3.5032897, -2.9013047, 0.609906]
Target sample: 37, Prediction:1, Target's Score:[-3.2591617, 14.540493, -3.1353612, 2.47508, -1.7013505, -3.9825191, 1.6793634, -4.121721, -3.0909574, 0.5335881]
Target sample: 43, Prediction:1, Target's Score:[-3.1603005, 14.617679, -3.224158, 2.68371, -2.9877849, -3.1438303, 0.04266186, -3.5982065, -2.5838718, 1.3121604]
Target sample: 49, Prediction:1, Target's Score:[-4.7793326, 13.342487, -1.0603971, 5.355606, -3.448591, -3.4310796, 1.6820011, -3.4678743, -3.5045893, -0.74881476]
Target sample: 55, Prediction:1, Target's Score:[-4.371857, 9.820586, -2.0269508, 4.4985247, -3.6569767, -2.3682446, 6.7979198, -3.6615932, -2.893975, -2.2326841]
Target sample: 61, Prediction:1, Target's Score:[-4.987264, 10.945957, -2.5542343, -0.24692664, -3.5234616, -0.7361707, 7.755967, -3.1138222, -0.6045839, -3.0527763]
Target sample: 67, Prediction:1, Target's Score:[-4.815619, 12.020557, -0.84558374, 4.1649785, -4.908729, -1.8874993, 4.9715624, -3.7719352, -4.3351836, -0.684291]
Target sample: 73, Prediction:1, Target's Score:[-3.7113123, 10.608651, -2.1693199, 6.0174046, -3.7812002, -1.8834156, 1.1443013, -3.1794143, -3.904502, 0.8060189]
Target sample: 79, Prediction:1, Target's Score:[-3.7277608, 12.689416, -2.5539353, 3.1342714, -1.7518708, -3.736091, 1.252634, -3.219071, -2.8618352, 0.7160515]
Target sample: 85, Prediction:1, Target's Score:[-3.8744051, 14.35055, -2.544649, 2.5522213, -2.2892854, -3.6613998, 1.1288117, -3.3233526, -2.142818, -0.2505396]
Target sample: 91, Prediction:1, Target's Score:[-5.04232, 12.529171, -3.847541, 2.7217696, -3.8710895, -1.0195737, 5.0007386, -4.5523334, -3.6731234, 1.6638831]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 03:56:55 Epoch 59, Val iteration 0, acc 93.000 (93.000)
2021-06-13 03:57:08 Epoch 59, Val iteration 19, acc 90.400 (91.990)
* Prec: 91.9900016784668
Per class accuracy =  [0.94746752 0.95834147 0.86433851 0.82046094 0.94825244 0.88929505
 0.95685841 0.9341647  0.94308383 0.93682531]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
------SUMMARY POST DEFENSE------
TIME ELAPSED (mins): 18
TARGET INDEX: 11
ResNet50 0.0 0.0 95.46000137329102 89.78000106811524 80.0
DPN92 0.0 0.0 95.50000267028808 93.03000183105469 100.0
MobileNetV2 0.0 1.3157894736842106 91.22000160217286 89.47000083923339 80.0
GoogLeNet 0.0 0.0 95.41000213623047 91.9900016784668 80.0
True False False False False
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.300-droplayer0.000.t7
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
No specific indices are determined, so try to include whatever we find
In total, we found 119 images of target 12
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', eval_poisons_root='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=False, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=12, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/12/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115]
# Targets: 20, # Poisons: 5
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-13 03:57:25 Iteration 0 	 Training Loss: 9.435e-01 	 Loss in Target Net: 2.294e+00	  
 2021-06-13 03:58:16 Iteration 50 	 Training Loss: 2.056e-01 	 Loss in Target Net: 4.664e-01	  
 2021-06-13 03:59:06 Iteration 100 	 Training Loss: 1.741e-01 	 Loss in Target Net: 5.045e-01	  
 2021-06-13 03:59:57 Iteration 150 	 Training Loss: 1.618e-01 	 Loss in Target Net: 5.400e-01	  
 2021-06-13 04:00:48 Iteration 200 	 Training Loss: 1.603e-01 	 Loss in Target Net: 5.608e-01	  
 2021-06-13 04:01:38 Iteration 250 	 Training Loss: 1.626e-01 	 Loss in Target Net: 5.086e-01	  
 2021-06-13 04:02:29 Iteration 300 	 Training Loss: 1.609e-01 	 Loss in Target Net: 5.521e-01	  
 2021-06-13 04:03:20 Iteration 350 	 Training Loss: 1.566e-01 	 Loss in Target Net: 5.190e-01	  
 2021-06-13 04:04:11 Iteration 400 	 Training Loss: 1.535e-01 	 Loss in Target Net: 5.446e-01	  
 2021-06-13 04:05:03 Iteration 450 	 Training Loss: 1.488e-01 	 Loss in Target Net: 5.894e-01	  
 2021-06-13 04:05:54 Iteration 500 	 Training Loss: 1.495e-01 	 Loss in Target Net: 5.111e-01	  
 2021-06-13 04:06:46 Iteration 550 	 Training Loss: 1.489e-01 	 Loss in Target Net: 4.994e-01	  
 2021-06-13 04:07:37 Iteration 600 	 Training Loss: 1.535e-01 	 Loss in Target Net: 5.331e-01	  
 2021-06-13 04:08:31 Iteration 650 	 Training Loss: 1.604e-01 	 Loss in Target Net: 4.732e-01	  
 2021-06-13 04:09:24 Iteration 700 	 Training Loss: 1.509e-01 	 Loss in Target Net: 4.872e-01	  
 2021-06-13 04:10:16 Iteration 750 	 Training Loss: 1.508e-01 	 Loss in Target Net: 4.329e-01	  
 2021-06-13 04:11:07 Iteration 800 	 Training Loss: 1.533e-01 	 Loss in Target Net: 5.371e-01	  
 2021-06-13 04:11:59 Iteration 850 	 Training Loss: 1.518e-01 	 Loss in Target Net: 4.230e-01	  
 2021-06-13 04:12:52 Iteration 900 	 Training Loss: 1.485e-01 	 Loss in Target Net: 4.572e-01	  
 2021-06-13 04:13:48 Iteration 950 	 Training Loss: 1.479e-01 	 Loss in Target Net: 4.055e-01	  
 2021-06-13 04:14:40 Iteration 999 	 Training Loss: 1.483e-01 	 Loss in Target Net: 5.204e-01	  
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 04:14:46, Val iteration 0, acc 94.200 (94.200)
2021-06-13 04:14:56, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-13 04:15:01, Epoch 0, Iteration 7, loss 0.214 (0.578), acc 92.308 (91.400)
2021-06-13 04:16:01, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-2.272057, 15.184243, -4.8715997, -1.6720368, -4.5228596, -3.0117512, 3.762512, -3.5559068, 0.42756262, 1.0510465]
Target sample: 7, Prediction:8, Target's Score:[0.09991001, 5.720027, -5.12536, -2.8420553, -4.2013245, -2.9902914, 4.4551625, -2.7580013, 8.491728, -0.44496962]
Target sample: 13, Prediction:8, Target's Score:[-1.5246642, 6.3560257, -7.382758, -1.5456532, -4.807819, -3.9712262, 6.6797137, -1.8698318, 9.371636, -0.8757876]
Target sample: 19, Prediction:1, Target's Score:[-1.7847022, 7.5219374, -5.1366715, -2.0405161, -3.6543345, -2.8390498, 6.251074, -1.9862485, 1.498175, 2.603815]
Target sample: 25, Prediction:1, Target's Score:[-2.711166, 9.922533, -4.632247, -2.3631933, -4.2412667, -2.232481, 5.5159163, -2.684241, 0.8859936, 3.0136359]
Target sample: 31, Prediction:6, Target's Score:[-2.31728, 7.4464383, -5.918817, -2.0202205, -4.629304, -2.8626032, 8.567843, -1.3028177, 1.3648026, 2.1679935]
Target sample: 37, Prediction:1, Target's Score:[-3.0850387, 15.584926, -5.2363515, -1.3298597, -4.7301397, -3.1192281, 4.50622, -2.5840414, 1.2785132, -0.77056867]
Target sample: 43, Prediction:1, Target's Score:[-2.8175302, 10.34596, -5.693808, -1.6723357, -4.3478928, -3.034096, 5.1231375, -1.9445107, 3.5176663, 0.9586171]
Target sample: 49, Prediction:1, Target's Score:[-3.4253101, 12.539116, -4.5128164, -1.3913502, -4.004148, -2.1544557, 4.006677, -2.5010335, -1.3911719, 3.3464844]
Target sample: 55, Prediction:1, Target's Score:[-3.0876994, 10.741077, -3.0036833, -0.90868384, -2.8750372, -1.4882406, 2.8452835, -2.903826, -2.3640523, 3.5059042]
Target sample: 61, Prediction:9, Target's Score:[-2.8928475, 6.7173505, -6.3531585, -1.8579401, -3.361566, -1.9949234, 4.2374825, -3.5022907, 1.3350356, 8.200582]
Target sample: 67, Prediction:1, Target's Score:[-1.1377885, 12.79338, -5.927481, -0.7664935, -5.313497, -3.100978, 4.5790615, -2.7645156, 3.9777567, -1.8711283]
Target sample: 73, Prediction:1, Target's Score:[-2.7180667, 13.931701, -5.5318246, -0.52796745, -3.862312, -2.902113, 2.9596257, -2.7988293, -0.5268416, 2.5076437]
Target sample: 79, Prediction:1, Target's Score:[-2.6645133, 14.018136, -4.3813624, -1.6369133, -4.1789923, -2.3900268, 3.2340574, -2.604984, -2.081096, 3.2047105]
Target sample: 85, Prediction:1, Target's Score:[-3.1855216, 7.8797445, -4.8706512, -1.6014413, -3.893032, -1.4255484, 4.3393016, -2.70348, -0.005822627, 5.9735365]
Target sample: 91, Prediction:1, Target's Score:[-3.25063, 8.010094, -5.643348, -0.48092633, -3.7667143, -2.341731, 5.3868723, -2.3917482, 0.8036853, 4.1605997]
Target sample: 97, Prediction:1, Target's Score:[-2.8513346, 12.903461, -4.755792, -2.347588, -4.0620766, -2.1684897, 4.8482027, -2.5991282, 0.8522918, 0.66808814]
Target sample: 103, Prediction:1, Target's Score:[-2.3096771, 15.386855, -4.5220866, -0.38114893, -4.68122, -2.5351098, 3.0810149, -3.0758326, -0.54908323, 0.1114498]
Target sample: 109, Prediction:1, Target's Score:[-3.2566915, 13.944351, -4.9642525, -1.9025908, -4.331587, -2.6455145, 4.6753354, -2.6699605, 0.30227813, 1.340509]
Target sample: 115, Prediction:9, Target's Score:[-3.8627005, 3.097458, -7.0484056, -2.166028, -2.1086977, -2.2887805, 6.287203, -3.3059158, 3.3000026, 8.639521]
Current ATTACK acc on target samples: 5.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 04:17:01 Epoch 59, Val iteration 0, acc 91.800 (91.800)
2021-06-13 04:17:11 Epoch 59, Val iteration 19, acc 93.800 (92.390)
* Prec: 92.39000205993652
Per class accuracy =  [0.94557047 0.95513605 0.84235646 0.87263681 0.92973123 0.90794391
 0.94355443 0.92695923 0.96775369 0.94620468]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 9, 9, 8, 8, 8, 8, 8, 8, 1, 1, 1, 1, 6, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 9, 1, 1, 1
ATTACK acc: 2.0202020202020203
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 04:17:23, Val iteration 0, acc 94.800 (94.800)
2021-06-13 04:17:44, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-13 04:17:57, Epoch 0, Iteration 7, loss 0.413 (0.346), acc 92.308 (91.200)
2021-06-13 04:20:37, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-2.714639, 12.324401, -2.8438122, -1.562111, -1.6838872, -3.637696, 2.0373359, -2.8515818, 1.1247206, 0.44381815]
Target sample: 7, Prediction:1, Target's Score:[-0.63588494, 9.415671, -4.0371985, -3.2562146, -1.4092002, -3.9575636, 6.0721035, -3.5030537, 0.33880368, 1.572264]
Target sample: 13, Prediction:1, Target's Score:[-0.5637146, 5.9657736, -3.2802992, -1.3769344, -2.9816277, -3.9316416, 1.0509944, -2.580066, 5.534415, 2.6899717]
Target sample: 19, Prediction:9, Target's Score:[-1.5620565, 1.832844, -2.6261818, -1.6048251, -0.7409605, -4.067278, 4.9477572, -3.050996, -1.2277853, 8.566249]
Target sample: 25, Prediction:1, Target's Score:[-2.3934734, 12.466861, -3.4642863, -3.138927, -1.3695251, -3.301189, 2.6163995, -2.4227998, 2.035466, -0.3862312]
Target sample: 31, Prediction:1, Target's Score:[-0.5346458, 12.186926, -4.111317, -2.887435, -3.0035615, -3.1602979, 4.7245216, -2.4071102, -0.09842074, -0.04429309]
Target sample: 37, Prediction:1, Target's Score:[-1.9858379, 14.638715, -3.448283, -3.2653334, -2.598535, -3.4087286, 2.7330778, -2.661808, 1.4640816, -0.7430677]
Target sample: 43, Prediction:1, Target's Score:[-1.4709077, 12.021154, -4.4228907, -3.5239167, -2.5057187, -3.3221703, 2.6433752, -2.5379958, 1.5125167, 2.2390437]
Target sample: 49, Prediction:1, Target's Score:[-1.5064435, 10.374701, -3.7802513, -3.6061513, -2.1359143, -1.7341003, 3.89515, -1.2584643, -1.0864325, 1.4494201]
Target sample: 55, Prediction:9, Target's Score:[-3.1852355, 5.0904493, -1.5696152, -1.0257831, -0.022612084, -2.2262812, 0.7599488, -2.5694182, -1.048456, 6.228409]
Target sample: 61, Prediction:9, Target's Score:[-0.70889616, 6.8461843, -3.475567, -2.5681126, -2.108123, -2.5903811, 2.3405313, -3.1294308, -1.0893956, 7.032064]
Target sample: 67, Prediction:1, Target's Score:[-3.1178224, 6.6667933, -3.302069, 0.0007511489, -2.5049334, -3.2006662, 1.4047583, -2.7607856, 3.2393782, 4.119143]
Target sample: 73, Prediction:1, Target's Score:[-0.24794662, 6.8732586, -3.0535295, -0.6747425, -0.78948224, -3.240461, 0.81611794, -0.3590424, -1.7712274, 2.9630845]
Target sample: 79, Prediction:1, Target's Score:[-1.3623213, 14.128086, -4.381086, -2.9763963, -2.649151, -3.2207537, 3.0949671, -2.4727356, -0.1853157, 0.7227921]
Target sample: 85, Prediction:1, Target's Score:[-0.2165849, 12.284862, -3.568184, -3.7315574, -2.8024075, -1.8994806, 2.4132607, -2.4771733, -0.065711245, 0.7089624]
Target sample: 91, Prediction:1, Target's Score:[-0.99051356, 13.050452, -4.035903, -3.3582354, -2.4443848, -3.9913793, 4.418948, -3.8196757, -0.13830636, 1.9883049]
Target sample: 97, Prediction:1, Target's Score:[-1.2640569, 13.692946, -3.7718303, -3.365623, -2.2362192, -3.2098079, 3.1155179, -2.3470137, 1.1013027, -1.028798]
Target sample: 103, Prediction:1, Target's Score:[-0.31157184, 12.465983, -3.0952249, -2.8512475, -1.5814158, -3.2770777, 1.7890912, -1.76259, -0.2798529, -0.45444715]
Target sample: 109, Prediction:1, Target's Score:[-2.5119495, 13.199276, -3.730752, -2.0679913, -1.5815461, -3.2018938, 2.4875352, -2.451596, 0.18231067, 0.34016737]
Target sample: 115, Prediction:9, Target's Score:[-0.65894884, 2.1658032, -3.2159524, -2.1568012, -1.7251405, -3.0139298, 2.9012258, -2.9628973, -1.6906788, 10.829592]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 04:23:13 Epoch 59, Val iteration 0, acc 93.200 (93.200)
2021-06-13 04:23:34 Epoch 59, Val iteration 19, acc 92.800 (92.890)
* Prec: 92.89000244140625
Per class accuracy =  [0.92979463 0.96391701 0.88954768 0.84562993 0.93774847 0.88850001
 0.9619834  0.94663216 0.97112445 0.95205652]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 9, 9, 8, 1, 1, 1, 8, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 9, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1
ATTACK acc: 1.0101010101010102
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 04:23:38, Val iteration 0, acc 92.600 (92.600)
2021-06-13 04:23:44, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-13 04:23:46, Epoch 0, Iteration 7, loss 0.494 (0.365), acc 82.692 (88.200)
2021-06-13 04:24:14, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.250624, 13.086887, -5.546814, 3.6592445, -8.401983, -0.38258225, 3.6586828, -7.921287, -1.1100246, 4.767634]
Target sample: 7, Prediction:6, Target's Score:[0.014326774, 6.5094924, -5.889759, 1.2095265, -6.7221413, -3.45548, 8.339772, -6.6487193, 5.8498883, 1.3275187]
Target sample: 13, Prediction:1, Target's Score:[-1.8774222, 13.1390505, -4.894471, 0.61250585, -7.0842237, -2.068976, 3.8861282, -6.9538903, 4.7783055, 1.0290525]
Target sample: 19, Prediction:6, Target's Score:[-1.2944291, 5.4374747, -4.622302, 3.7476645, -5.487996, -2.4099903, 7.693618, -6.28797, -1.1409183, 4.8427234]
Target sample: 25, Prediction:1, Target's Score:[-0.2973039, 10.802773, -3.0440629, -1.9392654, -4.7323713, -2.2085872, 4.9678783, -4.942482, -2.577475, 4.3874207]
Target sample: 31, Prediction:1, Target's Score:[0.85598487, 12.724974, -5.565322, -0.6480504, -4.231237, -3.1023636, 4.4593816, -3.972114, -0.4484897, 0.38897464]
Target sample: 37, Prediction:1, Target's Score:[-0.69634736, 20.565077, -4.6049166, -0.2010239, -7.8778305, -0.94824463, -1.850549, -6.1092877, 0.86161125, 1.4511434]
Target sample: 43, Prediction:1, Target's Score:[0.9213303, 10.312962, -4.351548, 0.27886444, -4.6703777, -4.0011125, -2.1927907, -2.988139, 3.9304652, 3.2060206]
Target sample: 49, Prediction:1, Target's Score:[-2.2079055, 11.638641, -4.4666348, 0.47891957, -6.0321064, -0.5083417, 3.1770105, -5.091508, -1.5901389, 5.081839]
Target sample: 55, Prediction:1, Target's Score:[-1.8686951, 8.304064, -5.0883026, 1.8834091, -7.5228004, -1.5642592, 6.0806656, -5.4838967, -1.7348408, 7.4822683]
Target sample: 61, Prediction:1, Target's Score:[0.36311448, 12.603721, -4.5281124, -0.57593775, -7.834932, -2.1651015, 5.2644973, -6.87135, 3.7665322, 0.52469313]
Target sample: 67, Prediction:1, Target's Score:[-0.20315593, 9.329262, -3.8943536, -0.42721164, -6.7324977, -2.6431017, 0.58158004, -6.036367, 6.4134674, 4.1365952]
Target sample: 73, Prediction:1, Target's Score:[-3.4107678, 9.129758, -4.49685, 2.0859761, -3.8536012, -1.6320192, 5.7407346, -5.81547, 0.42644873, 2.3192415]
Target sample: 79, Prediction:1, Target's Score:[0.71416396, 11.854235, -4.505307, 0.2675386, -5.148578, -0.09075144, -1.2563932, -2.8767805, -3.3265638, 4.7621326]
Target sample: 85, Prediction:1, Target's Score:[1.3605102, 12.718125, -4.3626127, -1.354323, -6.630235, -2.4169655, 3.4863455, -4.109782, -1.3151408, 3.0781465]
Target sample: 91, Prediction:1, Target's Score:[-0.412759, 14.179183, -4.0195045, -0.5547883, -5.3957176, -1.4510506, 2.2136056, -4.878996, -1.4888201, 2.2958646]
Target sample: 97, Prediction:1, Target's Score:[-1.199885, 14.410448, -4.4059544, -0.26817164, -5.7935114, -1.6254586, 1.1550088, -4.561528, 1.7596786, 1.0219718]
Target sample: 103, Prediction:1, Target's Score:[2.7303014, 11.845008, -2.1089144, -0.24015775, -3.4953222, -0.8572251, -2.7313664, -5.108106, -0.41914627, 0.8117641]
Target sample: 109, Prediction:1, Target's Score:[-1.863092, 13.895889, -3.3565252, 0.64782715, -7.298823, 0.8477476, 1.7823236, -6.391897, -1.9667234, 4.190047]
Target sample: 115, Prediction:9, Target's Score:[-0.3027931, 7.861605, -5.8876143, 0.14462924, -7.097036, -1.7554839, 5.2823377, -6.1749845, 0.06025763, 8.36306]
Current ATTACK acc on target samples: 10.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 04:24:42 Epoch 59, Val iteration 0, acc 89.800 (89.800)
2021-06-13 04:24:48 Epoch 59, Val iteration 19, acc 90.400 (89.570)
* Prec: 89.57000198364258
Per class accuracy =  [0.92617707 0.92860342 0.84860397 0.82582164 0.89021524 0.82874424
 0.93618987 0.89045264 0.93254917 0.94479297]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 8, 1, 8, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 8, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 1.0101010101010102
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 04:24:55, Val iteration 0, acc 96.200 (96.200)
2021-06-13 04:25:08, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-13 04:25:14, Epoch 0, Iteration 7, loss 0.130 (0.513), acc 96.154 (86.600)
2021-06-13 04:26:25, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-2.7652218, 16.133766, -3.7427433, -2.025983, -3.627255, -3.5598154, -0.98003024, -2.5577438, -0.53746116, 3.6991444]
Target sample: 7, Prediction:1, Target's Score:[1.8258474, 5.3964906, -3.4106603, -2.458536, -2.1642318, -4.1258364, 1.8474079, -2.684882, 3.3488936, 2.4726307]
Target sample: 13, Prediction:1, Target's Score:[-0.9263285, 7.367869, -3.2663763, -2.1803088, -2.5152113, -3.6202693, 2.8856525, -2.6915252, 3.2793455, 1.7013595]
Target sample: 19, Prediction:1, Target's Score:[-0.39935178, 5.7099714, -3.236398, -2.8194618, -3.0513308, -3.638681, 5.48561, -1.9329957, -0.48883104, 4.4103837]
Target sample: 25, Prediction:1, Target's Score:[-2.0059183, 12.030825, -2.0993752, -3.1362088, -2.943184, -3.5112062, 0.65549564, -2.497466, -0.0045550987, 3.5441728]
Target sample: 31, Prediction:1, Target's Score:[-1.7201062, 9.108803, -3.8761535, -2.7798305, -2.4685102, -3.0765283, 3.9736333, -2.6858213, 0.23022336, 3.3300886]
Target sample: 37, Prediction:1, Target's Score:[-1.1362545, 16.842161, -4.126376, -3.932059, -3.0303378, -4.2872777, 0.0010259394, -2.405261, -0.19179368, 2.3083172]
Target sample: 43, Prediction:1, Target's Score:[-0.76118255, 9.725073, -3.6803913, -3.5311124, -2.6816278, -4.0256004, 1.8027246, -2.341553, 3.2920222, 2.2372112]
Target sample: 49, Prediction:1, Target's Score:[-1.2280036, 9.482573, -2.4134307, -3.5108109, -2.408368, -3.7017093, 3.8337064, -1.9580555, -0.81413406, 2.753232]
Target sample: 55, Prediction:1, Target's Score:[-2.6992428, 7.9160204, -1.2915145, -2.421188, -2.8446026, -3.2786088, 1.8337935, -1.8237078, -2.0055995, 6.6434736]
Target sample: 61, Prediction:1, Target's Score:[-1.9152254, 12.532569, -4.0556464, -2.6188524, -2.7410343, -4.138244, -0.034112297, -2.7119465, 0.01694239, 5.706081]
Target sample: 67, Prediction:1, Target's Score:[-0.28394938, 11.526696, -3.557725, -1.4925845, -2.886975, -4.1609163, -1.1443548, -3.3486872, 2.6689353, 2.7246428]
Target sample: 73, Prediction:1, Target's Score:[-0.13970897, 5.700676, -1.8752538, -1.2877156, -1.8499216, -2.9222934, 0.994546, -1.4206595, -0.6094905, 3.4442873]
Target sample: 79, Prediction:1, Target's Score:[-2.1106572, 10.746207, -4.103138, -3.5049317, -2.8354912, -3.0882137, 2.2336156, -1.3202773, -2.0314293, 6.0505395]
Target sample: 85, Prediction:1, Target's Score:[-1.0779692, 11.848101, -4.0913515, -2.2066362, -2.6346402, -3.5763507, -1.0808809, -2.5971825, 0.17792189, 5.2806134]
Target sample: 91, Prediction:1, Target's Score:[-1.7745459, 9.851601, -2.5228353, -0.93191075, -1.8807926, -3.0147538, 0.36619234, -2.3831272, -0.6415887, 2.9676776]
Target sample: 97, Prediction:1, Target's Score:[-1.4400696, 14.036844, -3.3792858, -1.7032527, -3.131021, -3.414615, -1.5429075, -2.6376183, -0.10504042, 3.3548365]
Target sample: 103, Prediction:1, Target's Score:[0.9056409, 11.428806, -2.2077026, -1.8841777, -2.8355365, -2.9589188, -1.1033981, -2.4802423, -1.0640575, 2.2402894]
Target sample: 109, Prediction:1, Target's Score:[-2.6967425, 11.834702, -2.7750888, -1.4875429, -3.7539945, -3.7343714, -0.14582473, -2.7279432, -1.1472617, 6.672546]
Target sample: 115, Prediction:9, Target's Score:[-0.09033664, 4.580267, -4.765008, -3.2514021, -2.602251, -5.08009, 1.6240115, -3.3180857, -0.2926554, 13.251842]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 04:27:35 Epoch 59, Val iteration 0, acc 93.200 (93.200)
2021-06-13 04:27:48 Epoch 59, Val iteration 19, acc 93.000 (92.830)
* Prec: 92.83000144958496
Per class accuracy =  [0.95840859 0.95016036 0.87370757 0.88346401 0.96095646 0.86951026
 0.9636681  0.92700248 0.9512315  0.94078412]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 9, 9, 8, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 1, 1
ATTACK acc: 1.0101010101010102
--------
------SUMMARY PRE DEFENSE------
TIME ELAPSED (mins): 17
TARGET INDEX: 12
ResNet50 5.0 2.0202020202020203 95.46000137329102 92.39000205993652
DPN92 0.0 1.0101010101010102 95.50000267028808 92.89000244140625
MobileNetV2 10.0 1.0101010101010102 91.22000160217286 89.57000198364258
GoogLeNet 0.0 1.0101010101010102 95.41000213623047 92.83000144958496
DEFENSE EVALUATION
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
ResNet50
[74, 80, 84, 86, 89] 5
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 04:27:53, Val iteration 0, acc 94.200 (94.200)
2021-06-13 04:28:03, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-13 04:28:05, Epoch 0, Iteration 7, loss 0.426 (0.272), acc 86.538 (94.200)
2021-06-13 04:29:06, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-2.275949, 16.101841, -2.2360282, -3.9585004, -4.3143835, -1.5176291, -1.7297795, -2.4587874, -1.970181, 4.6897025]
Target sample: 7, Prediction:1, Target's Score:[1.151685, 9.146251, -2.0944452, -3.2855077, -2.9279053, -2.4940813, -0.8134674, -2.273616, 2.0707262, 1.7376477]
Target sample: 13, Prediction:1, Target's Score:[-0.12394996, 7.120422, -3.1867611, -0.7330456, -3.1177661, -2.23606, -0.6522848, -2.556864, 2.7313755, 2.9613583]
Target sample: 19, Prediction:1, Target's Score:[-0.17512672, 6.5783668, -0.3736371, -2.6880739, -2.9808574, -2.5867147, -0.44489017, -1.749604, -1.5891472, 6.2142663]
Target sample: 25, Prediction:1, Target's Score:[-2.1628046, 12.7267, -1.528632, -4.1719112, -3.8277254, -1.3672934, -1.0841135, -2.0088375, -1.6553435, 5.356566]
Target sample: 31, Prediction:1, Target's Score:[-2.317384, 12.143371, -2.3870697, -3.8693206, -3.784364, -1.2826635, -0.13379022, -1.7425845, -1.0438105, 4.697336]
Target sample: 37, Prediction:1, Target's Score:[-2.2994354, 16.84551, -2.1669679, -4.2869983, -4.100902, -1.4678223, -2.2419326, -1.7795582, -2.1376753, 3.965056]
Target sample: 43, Prediction:1, Target's Score:[-2.0441825, 13.428541, -2.0827754, -3.690057, -3.8130732, -1.5966163, -1.8423244, -1.6485683, -1.5535122, 5.1232634]
Target sample: 49, Prediction:1, Target's Score:[-2.9243486, 11.376125, -1.646177, -3.683129, -3.9316835, -1.0344652, -1.6841334, -1.2653993, -2.803678, 7.87934]
Target sample: 55, Prediction:1, Target's Score:[-3.1705828, 9.3368, -0.73331314, -3.6959045, -3.3948884, -0.43181485, -0.71736896, -1.6989549, -3.0248282, 7.7819953]
Target sample: 61, Prediction:9, Target's Score:[-2.5017087, 5.4413896, -2.3203123, -1.2743735, -3.2984524, -1.1131294, 0.3405905, -1.8400123, -0.046789754, 6.8189087]
Target sample: 67, Prediction:1, Target's Score:[-0.48835728, 7.2468796, -1.363269, -1.3494984, -2.8676581, -2.159837, -1.7770406, -1.9992381, 0.99984807, 3.9569643]
Target sample: 73, Prediction:1, Target's Score:[-2.239699, 10.772107, -1.9858589, -2.724741, -3.5112102, -1.0853108, -1.3464829, -1.5508565, -2.1826544, 6.109]
Target sample: 79, Prediction:1, Target's Score:[-2.4166293, 14.025173, -1.9804246, -3.8836212, -4.114168, -0.8492553, -1.5518706, -1.5050393, -3.1552706, 5.7400527]
Target sample: 85, Prediction:1, Target's Score:[-2.406919, 10.561428, -1.9172232, -3.335129, -3.849215, -0.79975, -1.0196861, -1.3328915, -1.9107933, 6.2742]
Target sample: 91, Prediction:1, Target's Score:[-2.4119117, 9.400195, -0.9811951, -2.5416927, -3.469414, -1.6581975, -0.8807506, -1.7262225, -1.9649969, 6.477673]
Target sample: 97, Prediction:1, Target's Score:[-2.2688336, 14.486387, -1.6571501, -4.568463, -3.7594671, -0.61911976, -1.7711042, -1.4889396, -1.9820998, 3.931592]
Target sample: 103, Prediction:1, Target's Score:[-2.9288661, 16.338467, -1.491257, -4.750608, -4.4568996, -0.86148375, -2.1387086, -1.8057499, -2.863782, 5.294768]
Target sample: 109, Prediction:1, Target's Score:[-2.4223347, 15.059027, -2.067203, -4.6544743, -3.922803, -1.2314216, -1.267095, -1.4417776, -1.8381821, 4.0897727]
Target sample: 115, Prediction:9, Target's Score:[-2.6193192, 3.538073, -2.1185408, -1.2230102, -2.9592493, -3.2951157, -0.09576978, -1.9068396, 0.67251307, 10.19293]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 04:30:05 Epoch 59, Val iteration 0, acc 92.400 (92.400)
2021-06-13 04:30:16 Epoch 59, Val iteration 19, acc 93.800 (91.690)
* Prec: 91.69000091552735
Per class accuracy =  [0.95202342 0.96594808 0.89602511 0.79039569 0.93133042 0.84393668
 0.95848796 0.95619604 0.92420562 0.95251123]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 9, 1, 8, 8, 8, 1, 1, 1, 1, 1, 9, 9, 9, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 9, 9, 9, 1
ATTACK acc: 0.0
DPN92
[74, 80, 84, 86, 89] 27
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 04:30:20, Val iteration 0, acc 94.800 (94.800)
2021-06-13 04:30:41, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-13 04:30:46, Epoch 0, Iteration 7, loss 0.303 (0.350), acc 90.385 (91.800)
2021-06-13 04:33:24, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-0.8502088, 15.04256, -4.524334, -0.175272, -2.1429071, -2.7901597, -1.9142888, -4.03429, -1.1646625, 3.2960591]
Target sample: 7, Prediction:1, Target's Score:[3.9774458, 9.991242, -5.0361423, -2.1254294, -3.0091355, -3.773778, -1.5123261, -3.234992, 1.14066, 4.319768]
Target sample: 13, Prediction:1, Target's Score:[0.956327, 6.3803663, -4.575842, -0.82651037, -3.1037192, -4.256641, -2.2412245, -3.134284, 5.6119885, 5.8765845]
Target sample: 19, Prediction:9, Target's Score:[0.9976221, 4.8766723, -4.235626, -0.18984163, -2.5162408, -4.592412, -3.75868, -3.4819362, -1.8894295, 15.569337]
Target sample: 25, Prediction:1, Target's Score:[-0.29433778, 13.76122, -4.6307745, -1.0340488, -1.7649078, -2.1796463, -2.1162536, -3.7657304, -0.7735045, 3.516928]
Target sample: 31, Prediction:1, Target's Score:[1.1414704, 14.885846, -5.1195717, -0.72127616, -2.9829867, -2.1225252, -1.633695, -3.7234046, -1.5146325, 2.5713375]
Target sample: 37, Prediction:1, Target's Score:[-0.7462455, 17.082272, -4.6437697, -1.0850172, -2.4355497, -2.4226363, -1.5441755, -3.9579735, -0.5029699, 1.0689306]
Target sample: 43, Prediction:1, Target's Score:[-0.032965202, 14.728992, -5.356789, -1.0975195, -3.0065823, -3.4361215, -2.406261, -4.248301, -0.8673972, 6.5405097]
Target sample: 49, Prediction:1, Target's Score:[0.2762282, 12.945609, -4.5393286, -0.70199627, -3.162269, -2.397546, -2.0682175, -3.012756, -2.434732, 5.856209]
Target sample: 55, Prediction:9, Target's Score:[-0.101697795, 3.946284, -3.3897526, 0.58281994, -2.25456, -3.155844, -4.072963, -3.2069383, -2.6190856, 14.977586]
Target sample: 61, Prediction:9, Target's Score:[1.0406386, 9.46227, -5.4193807, -1.060049, -3.3183603, -3.320019, -2.6653905, -3.6989121, -1.2473594, 11.003982]
Target sample: 67, Prediction:1, Target's Score:[-1.1067852, 9.226229, -4.6536174, 0.79679954, -3.1209817, -3.7214715, -2.4488204, -3.711123, 1.6000886, 7.8752227]
Target sample: 73, Prediction:9, Target's Score:[1.7895803, 8.282608, -5.1004505, 0.8557829, -2.076864, -3.041908, -3.5969236, -2.8402767, -2.8768666, 9.312277]
Target sample: 79, Prediction:1, Target's Score:[0.8611861, 14.726522, -5.272396, -1.0309973, -2.8806474, -1.9164666, -2.2553818, -3.7924972, -2.6442711, 4.9840574]
Target sample: 85, Prediction:1, Target's Score:[1.0985293, 13.366598, -4.8134546, -1.1136044, -3.382515, -1.7682344, -2.4422479, -3.814258, -1.8924584, 5.542828]
Target sample: 91, Prediction:1, Target's Score:[-0.07148338, 14.990896, -4.8871884, -0.17759162, -2.7947536, -2.3462589, -2.5188622, -4.7252536, -1.6030163, 4.9392405]
Target sample: 97, Prediction:1, Target's Score:[-0.13267846, 16.99708, -4.833378, -1.4282585, -2.2915566, -2.1725883, -1.5673904, -3.7861016, -0.74777573, 0.76475847]
Target sample: 103, Prediction:1, Target's Score:[0.17144112, 15.992337, -4.751105, -0.48957562, -2.394884, -2.1818674, -2.2514653, -4.028595, -2.2154272, 2.957904]
Target sample: 109, Prediction:1, Target's Score:[-0.6855502, 14.906222, -4.9856153, -0.24945767, -2.451753, -2.1741567, -2.0632486, -4.060346, -1.8216753, 4.34843]
Target sample: 115, Prediction:9, Target's Score:[0.968879, 4.2428107, -5.2982574, -0.47839254, -3.377223, -4.754287, -4.508178, -4.004945, -1.4521878, 19.52988]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 04:35:58 Epoch 59, Val iteration 0, acc 93.400 (93.400)
2021-06-13 04:36:19 Epoch 59, Val iteration 19, acc 93.600 (93.140)
* Prec: 93.14000091552734
Per class accuracy =  [0.933716   0.96509549 0.92211687 0.83730817 0.95554275 0.8675891
 0.95166406 0.95727434 0.96400554 0.95980684]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 9, 9, 9, 9, 9, 1, 1, 8, 8, 1, 1, 1, 1, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 9, 9, 9, 9, 1, 9, 9, 9, 1, 1, 1, 1, 1, 1, 9, 9, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 9, 1
ATTACK acc: 0.0
MobileNetV2
[74, 80, 84, 86, 89] 47
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 04:36:22, Val iteration 0, acc 92.600 (92.600)
2021-06-13 04:36:28, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-13 04:36:29, Epoch 0, Iteration 7, loss 0.264 (0.291), acc 90.385 (90.400)
2021-06-13 04:36:57, Epoch 30, Iteration 7, loss 0.000 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-0.30893087, 15.077717, -5.9750957, 3.9056897, -8.91371, -0.768273, -0.3832579, -7.8831344, -0.8353886, 6.923582]
Target sample: 7, Prediction:1, Target's Score:[0.72782886, 8.678045, -6.5907874, 1.0559771, -7.5423827, -4.336148, 5.054355, -6.6214724, 7.455666, 2.7808743]
Target sample: 13, Prediction:1, Target's Score:[-0.6392369, 14.345452, -5.2063265, 0.950737, -7.701438, -3.2746854, -0.10093953, -6.790226, 6.476319, 2.6393356]
Target sample: 19, Prediction:9, Target's Score:[-0.31312916, 7.0307417, -5.5083704, 3.3864481, -6.5532355, -2.917073, 3.8106542, -5.8660593, -0.0048396066, 7.6376033]
Target sample: 25, Prediction:1, Target's Score:[0.9613871, 13.465403, -3.5039606, -2.8206363, -5.3056984, -2.6156754, 0.0477996, -4.4988847, -1.9911866, 6.9587207]
Target sample: 31, Prediction:1, Target's Score:[2.3697772, 16.366575, -6.1770306, -1.1403573, -5.4669223, -3.487507, -1.1394255, -4.106988, 0.105714984, 3.3844278]
Target sample: 37, Prediction:1, Target's Score:[0.46895668, 22.913342, -4.5299, -0.4739587, -7.957835, -1.1341975, -6.3617682, -5.8901033, 0.21122375, 3.6148384]
Target sample: 43, Prediction:1, Target's Score:[2.750681, 11.158922, -4.3144326, -0.0072394013, -4.7360983, -4.1397967, -5.4280634, -3.0871625, 3.279844, 5.153638]
Target sample: 49, Prediction:1, Target's Score:[-0.7574845, 14.219391, -4.485859, -0.80176425, -6.2400146, -1.0516438, -1.5796174, -4.2602997, -2.3617787, 8.08134]
Target sample: 55, Prediction:1, Target's Score:[-1.2033597, 10.687292, -5.753872, 0.9715862, -8.208142, -1.7041804, 2.246866, -5.341456, -1.1491085, 10.21129]
Target sample: 61, Prediction:1, Target's Score:[1.2794235, 14.7980175, -5.5805054, -0.2586823, -8.393933, -3.1602633, 1.7799889, -6.7579603, 4.5071487, 2.5093553]
Target sample: 67, Prediction:1, Target's Score:[0.70366836, 10.215172, -4.3985486, -0.81924486, -7.198812, -3.356269, -2.9313319, -5.703066, 7.3770514, 6.770959]
Target sample: 73, Prediction:1, Target's Score:[-2.38319, 11.050971, -5.325293, 1.6583703, -4.9080048, -2.388545, 1.9103161, -5.269806, 1.8347799, 4.49798]
Target sample: 79, Prediction:1, Target's Score:[1.4434942, 12.924426, -4.7579594, -0.37041107, -4.9086213, 0.17637253, -4.593, -2.103529, -3.6315932, 6.5206137]
Target sample: 85, Prediction:1, Target's Score:[2.1852825, 15.27765, -5.0004683, -2.1014464, -6.748759, -2.591894, -1.3246299, -3.6771324, -1.3143762, 6.010265]
Target sample: 91, Prediction:1, Target's Score:[0.8200375, 17.07864, -4.667635, -1.1483321, -5.7819877, -1.5267549, -3.120554, -4.8252225, -1.3868704, 5.3197947]
Target sample: 97, Prediction:1, Target's Score:[-0.27893227, 16.373758, -4.4461017, -0.81738925, -6.061771, -1.9448135, -3.1836772, -3.8763986, 1.3143373, 3.6000006]
Target sample: 103, Prediction:1, Target's Score:[3.7909, 13.431619, -2.3340962, -0.61483586, -3.729074, -0.5994313, -5.7107353, -4.501501, -0.99846655, 1.9264263]
Target sample: 109, Prediction:1, Target's Score:[-0.96049047, 16.171057, -3.892485, 0.292188, -7.78421, 0.703108, -2.0961087, -5.937231, -1.9987676, 6.2708774]
Target sample: 115, Prediction:9, Target's Score:[0.4335021, 10.367578, -6.4997635, -0.60128605, -7.929215, -2.1186635, 0.893441, -6.085594, 1.1286352, 11.165969]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 04:37:24 Epoch 59, Val iteration 0, acc 89.000 (89.000)
2021-06-13 04:37:30 Epoch 59, Val iteration 19, acc 90.400 (89.590)
* Prec: 89.59000091552734
Per class accuracy =  [0.92035037 0.93646845 0.84462266 0.82671407 0.89247738 0.82530265
 0.93275564 0.89180652 0.93494451 0.94977143]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 9, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 8, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
GoogLeNet
[74, 80, 84, 86, 89] 22
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 04:37:33, Val iteration 0, acc 96.200 (96.200)
2021-06-13 04:37:46, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-13 04:37:48, Epoch 0, Iteration 7, loss 0.453 (0.539), acc 88.462 (85.600)
2021-06-13 04:38:59, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-2.0543118, 18.452314, -4.1754794, -1.3959204, -3.598394, -3.556191, -2.9091485, -3.1546922, -0.80041987, 3.308411]
Target sample: 7, Prediction:0, Target's Score:[5.964009, 3.5565195, -2.9108825, -2.5707686, -1.2342653, -3.7100983, -2.2496219, -2.8556173, 3.1793509, 2.8834171]
Target sample: 13, Prediction:1, Target's Score:[0.47632885, 9.299861, -2.9498372, -2.576391, -2.276284, -3.4601476, -1.6757002, -2.9788358, 4.288637, 1.9143778]
Target sample: 19, Prediction:1, Target's Score:[0.5937, 7.2296033, -3.7122583, -1.711169, -2.8352077, -3.3570476, -0.5073686, -1.8761576, -0.57674587, 6.8488116]
Target sample: 25, Prediction:1, Target's Score:[-1.0008392, 14.618534, -2.9243362, -2.5065892, -3.1740623, -2.9975162, -2.509417, -2.814297, -0.040483285, 3.44685]
Target sample: 31, Prediction:1, Target's Score:[-1.2489744, 13.925486, -4.1464105, -2.3097842, -2.0155394, -3.354162, -0.22828136, -3.027831, -0.22754805, 2.7246087]
Target sample: 37, Prediction:1, Target's Score:[-1.0335361, 18.680973, -4.016705, -3.4002726, -3.1600864, -3.9357285, -2.710123, -2.6471794, -0.0518183, 2.3835938]
Target sample: 43, Prediction:1, Target's Score:[0.28479248, 12.284206, -3.2831438, -3.0821803, -2.667831, -3.619816, -2.8711338, -2.3344862, 3.5391183, 1.8242757]
Target sample: 49, Prediction:1, Target's Score:[-1.2209815, 12.835159, -2.2540658, -1.9749987, -2.0937114, -3.2533026, -1.3994534, -2.2770686, -0.77760285, 2.4998202]
Target sample: 55, Prediction:1, Target's Score:[-2.2701705, 13.610566, -2.9474149, -2.7716687, -3.0191052, -3.1334722, -1.9764416, -2.4135575, -1.1178663, 6.149692]
Target sample: 61, Prediction:1, Target's Score:[-0.08531236, 13.28976, -4.0661726, -2.1613667, -3.0238385, -3.7591548, -2.738431, -3.1255882, 1.1211619, 4.6504407]
Target sample: 67, Prediction:1, Target's Score:[0.3749463, 12.612435, -3.1805024, -2.2324495, -2.7456927, -3.8756058, -2.9257126, -3.2933621, 2.9155703, 2.4334772]
Target sample: 73, Prediction:1, Target's Score:[-0.46678883, 8.701285, -2.3967416, -1.2877334, -2.2639258, -2.0242205, -1.9783762, -1.4676635, -0.118808135, 3.3714075]
Target sample: 79, Prediction:1, Target's Score:[-1.2921196, 14.29813, -3.4871771, -1.6789848, -3.201704, -2.4724252, -2.2091002, -1.8610716, -1.7391422, 3.7403898]
Target sample: 85, Prediction:1, Target's Score:[-1.6131107, 15.160028, -3.8922687, -2.1232865, -3.1113315, -2.9043007, -2.6106822, -2.5706646, 0.09538074, 3.6697915]
Target sample: 91, Prediction:1, Target's Score:[-1.653127, 13.588608, -2.361693, -0.78456146, -1.8196199, -3.090908, -3.0954866, -2.80314, -0.78724104, 2.8977153]
Target sample: 97, Prediction:1, Target's Score:[-1.4757066, 16.472439, -3.8297036, -1.2971781, -2.8067708, -2.9069216, -3.1637657, -3.181643, -0.65431744, 2.9470985]
Target sample: 103, Prediction:1, Target's Score:[-0.830861, 15.449434, -3.110123, -2.4824145, -3.0308952, -1.2626739, -2.8368435, -2.6999266, -0.9455276, 1.8425468]
Target sample: 109, Prediction:1, Target's Score:[-2.0062995, 12.875432, -3.273151, -1.6681849, -3.1233401, -3.2646906, -2.3583217, -2.9770992, -1.2473844, 7.162605]
Target sample: 115, Prediction:9, Target's Score:[0.1774718, 3.398875, -4.722178, -2.4668577, -1.5125575, -4.5709977, -1.5761287, -3.7237062, -0.62598175, 15.777395]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 04:40:08 Epoch 59, Val iteration 0, acc 93.800 (93.800)
2021-06-13 04:40:21 Epoch 59, Val iteration 19, acc 93.600 (92.950)
* Prec: 92.95000190734864
Per class accuracy =  [0.95731432 0.94939882 0.87325206 0.85740571 0.95432231 0.90386388
 0.95631786 0.93874376 0.95866402 0.94602495]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 9, 9, 8, 1, 8, 1, 8, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 1, 1
ATTACK acc: 0.0
------SUMMARY POST DEFENSE------
TIME ELAPSED (mins): 17
TARGET INDEX: 12
ResNet50 0.0 0.0 95.46000137329102 91.69000091552735 100.0
DPN92 0.0 0.0 95.50000267028808 93.14000091552734 100.0
MobileNetV2 0.0 0.0 91.22000160217286 89.59000091552734 100.0
GoogLeNet 0.0 0.0 95.41000213623047 92.95000190734864 100.0
True False False False False
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.300-droplayer0.000.t7
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
No specific indices are determined, so try to include whatever we find
In total, we found 142 images of target 14
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133, 139]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', eval_poisons_root='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=False, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=14, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/14/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133, 139]
# Targets: 24, # Poisons: 5
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-13 04:40:40 Iteration 0 	 Training Loss: 1.080e+00 	 Loss in Target Net: 2.196e+00	  
 2021-06-13 04:41:25 Iteration 50 	 Training Loss: 2.576e-01 	 Loss in Target Net: 5.626e-01	  
 2021-06-13 04:42:10 Iteration 100 	 Training Loss: 2.240e-01 	 Loss in Target Net: 5.608e-01	  
 2021-06-13 04:42:56 Iteration 150 	 Training Loss: 2.273e-01 	 Loss in Target Net: 4.565e-01	  
 2021-06-13 04:43:44 Iteration 200 	 Training Loss: 2.109e-01 	 Loss in Target Net: 4.929e-01	  
 2021-06-13 04:44:29 Iteration 250 	 Training Loss: 2.067e-01 	 Loss in Target Net: 5.212e-01	  
 2021-06-13 04:45:16 Iteration 300 	 Training Loss: 2.043e-01 	 Loss in Target Net: 5.094e-01	  
 2021-06-13 04:46:05 Iteration 350 	 Training Loss: 2.079e-01 	 Loss in Target Net: 5.193e-01	  
 2021-06-13 04:46:51 Iteration 400 	 Training Loss: 1.997e-01 	 Loss in Target Net: 5.741e-01	  
 2021-06-13 04:47:38 Iteration 450 	 Training Loss: 1.992e-01 	 Loss in Target Net: 4.834e-01	  
 2021-06-13 04:48:24 Iteration 500 	 Training Loss: 1.947e-01 	 Loss in Target Net: 5.541e-01	  
 2021-06-13 04:49:11 Iteration 550 	 Training Loss: 1.967e-01 	 Loss in Target Net: 4.835e-01	  
 2021-06-13 04:49:59 Iteration 600 	 Training Loss: 1.992e-01 	 Loss in Target Net: 5.349e-01	  
 2021-06-13 04:50:47 Iteration 650 	 Training Loss: 1.995e-01 	 Loss in Target Net: 5.696e-01	  
 2021-06-13 04:51:33 Iteration 700 	 Training Loss: 1.981e-01 	 Loss in Target Net: 5.081e-01	  
 2021-06-13 04:52:21 Iteration 750 	 Training Loss: 1.989e-01 	 Loss in Target Net: 5.001e-01	  
 2021-06-13 04:53:07 Iteration 800 	 Training Loss: 1.890e-01 	 Loss in Target Net: 6.199e-01	  
 2021-06-13 04:53:53 Iteration 850 	 Training Loss: 1.995e-01 	 Loss in Target Net: 5.105e-01	  
 2021-06-13 04:54:39 Iteration 900 	 Training Loss: 1.941e-01 	 Loss in Target Net: 4.974e-01	  
 2021-06-13 04:55:26 Iteration 950 	 Training Loss: 1.946e-01 	 Loss in Target Net: 5.089e-01	  
 2021-06-13 04:56:13 Iteration 999 	 Training Loss: 1.994e-01 	 Loss in Target Net: 5.786e-01	  
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 04:56:18, Val iteration 0, acc 94.200 (94.200)
2021-06-13 04:56:29, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-13 04:56:34, Epoch 0, Iteration 7, loss 0.352 (0.195), acc 92.308 (95.800)
2021-06-13 04:57:34, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:8, Target's Score:[-0.7724922, 2.3066888, -2.710737, -2.467668, -2.3903022, -2.9606295, 3.6766942, 0.16512164, 6.938375, -1.2733797]
Target sample: 7, Prediction:8, Target's Score:[-1.5368011, 2.3258507, -2.8585534, -1.879819, -3.529918, -3.2145693, 4.3171897, -0.09729571, 7.6188993, -0.58856267]
Target sample: 13, Prediction:8, Target's Score:[-1.3542182, 1.7888492, -2.988229, -2.123484, -3.3592098, -2.9751885, 3.622017, -0.9972618, 10.317172, -1.3936133]
Target sample: 19, Prediction:8, Target's Score:[-1.4750843, 1.7876797, -3.6867445, -1.9424917, -4.232698, -3.0703156, 4.4429317, -1.0345287, 12.397932, -2.582567]
Target sample: 25, Prediction:6, Target's Score:[0.077279486, 4.135202, -2.9054618, -2.006201, -3.8831031, -3.8083575, 5.7981277, 0.5133045, 4.6799917, -2.011113]
Target sample: 31, Prediction:6, Target's Score:[-0.79502153, 4.2445083, -2.1993647, -2.1791005, -3.735036, -3.572721, 6.956534, 0.40786228, 4.048269, -2.5902028]
Target sample: 37, Prediction:6, Target's Score:[-0.49249464, 3.0736086, -3.637669, -0.15127021, -3.3501122, -2.4515347, 5.7644973, -0.27618128, 4.48314, -2.3925784]
Target sample: 43, Prediction:6, Target's Score:[-1.1652418, 3.5356462, -3.3373075, -1.5758739, -3.520097, -2.2983327, 4.7360215, 0.007110186, 3.9717245, 0.23163205]
Target sample: 49, Prediction:8, Target's Score:[-2.6116383, 4.1430836, -3.1917388, -1.9055775, -3.9052885, -2.6012945, 3.3279855, -1.1294448, 6.0684776, 2.4359727]
Target sample: 55, Prediction:6, Target's Score:[-0.66553515, 4.6745014, -3.5239437, -2.6151905, -4.247097, -2.0878336, 5.335394, -0.64653456, 3.8138387, 0.64662004]
Target sample: 61, Prediction:6, Target's Score:[-2.2833948, 2.9534748, -1.983071, -1.1328063, -0.7037533, -2.1604357, 3.8438575, -0.64994955, 2.4893265, 0.17380893]
Target sample: 67, Prediction:1, Target's Score:[-1.2773281, 3.7517843, -0.034661174, -2.35077, -1.9262717, -3.033072, 3.666765, -0.92846745, 1.6699183, 1.0350982]
Target sample: 73, Prediction:8, Target's Score:[-1.3483725, 2.0716577, -1.9040302, -2.010155, -1.9894267, -3.1789973, 4.51909, 0.056771718, 5.7215877, -1.417435]
Target sample: 79, Prediction:8, Target's Score:[-1.2885908, 3.503479, -3.7961993, -2.339006, -3.9851873, -3.7005827, 5.451934, 0.31106824, 9.672766, -3.2289147]
Target sample: 85, Prediction:8, Target's Score:[-0.3883413, 3.887536, -3.5888343, -2.902147, -3.1753998, -3.4951382, 3.501511, -0.12577604, 7.315653, -0.46183515]
Target sample: 91, Prediction:6, Target's Score:[-0.30078414, 4.7731996, -2.877203, -0.7344063, -3.2981339, -2.8910155, 5.80678, -1.3634486, 2.7002492, -1.2222168]
Target sample: 97, Prediction:6, Target's Score:[-0.57077026, 3.0408, -3.191263, -1.8895435, -3.5408525, -2.7095935, 8.206345, -0.73051196, 4.59002, -2.5994534]
Target sample: 103, Prediction:8, Target's Score:[-2.1590533, 3.8216949, -3.7389264, -0.6924977, -3.548536, -1.744058, 5.2963657, -2.5525508, 7.029323, -1.087236]
Target sample: 109, Prediction:6, Target's Score:[-1.7959999, 2.635211, -3.581748, -0.75778085, -3.9662426, -2.070315, 9.553579, -2.0913148, 6.603814, -3.8748732]
Target sample: 115, Prediction:6, Target's Score:[-0.66770583, 1.6169502, -3.7155614, 1.9682214, -2.8378246, -2.76523, 5.2468953, -0.63085234, 4.051414, -1.6745759]
Target sample: 121, Prediction:8, Target's Score:[-0.4099391, 3.166016, -3.4955845, -1.4274911, -3.274898, -2.9614913, 5.8829684, -0.8538818, 6.038845, -2.0535538]
Target sample: 127, Prediction:6, Target's Score:[0.56661355, 2.604967, -2.054973, -1.7521019, -3.1167123, -3.6192605, 6.3076305, 0.27800924, 2.8819325, -1.5434544]
Target sample: 133, Prediction:1, Target's Score:[0.6446337, 4.032651, -2.8399827, -1.5771966, -2.7095, -3.0616918, 3.2157748, 0.12004355, 3.018684, -0.2933802]
Target sample: 139, Prediction:8, Target's Score:[-1.094581, 2.2111583, -3.149918, -2.272577, -3.8788543, -3.4803321, 4.9209523, -0.5009687, 9.744101, -1.9299424]
Current ATTACK acc on target samples: 45.833
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 04:58:33 Epoch 59, Val iteration 0, acc 91.800 (91.800)
2021-06-13 04:58:43 Epoch 59, Val iteration 19, acc 92.600 (92.060)
* Prec: 92.06000099182128
Per class accuracy =  [0.94763576 0.9592973  0.84282636 0.81834014 0.96392125 0.89035804
 0.9516474  0.93675315 0.95851067 0.94101347]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 6, 6, 1, 6, 6, 6, 6, 1, 1, 1, 1, 6, 6, 6, 6, 6, 8, 1, 1, 1, 8, 8, 1, 1, 6, 8, 6, 8, 6, 8, 9, 1, 1, 1, 1, 1, 1, 6, 6, 8, 8, 8, 1, 8, 8, 8, 8, 8, 8, 8, 8, 8, 6, 6, 6, 1, 1, 6, 6, 1, 6, 6, 6, 6, 6, 8, 8, 1, 6, 8, 8, 8, 8, 8, 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 8, 8, 8, 8, 8, 8, 8, 8, 8
ATTACK acc: 34.74576271186441
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 04:58:56, Val iteration 0, acc 94.800 (94.800)
2021-06-13 04:59:17, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-13 04:59:31, Epoch 0, Iteration 7, loss 0.069 (0.425), acc 100.000 (90.200)
2021-06-13 05:02:09, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:8, Target's Score:[0.36996123, 0.35664836, -1.798137, -0.5347209, -1.0440481, -3.664533, 2.1266572, -2.5528328, 7.3890433, -0.2838449]
Target sample: 7, Prediction:8, Target's Score:[-0.7231535, 1.2931327, -0.18305123, -0.6219684, -1.2148963, -4.393394, 4.4098277, -3.118675, 7.0282435, -2.0787358]
Target sample: 13, Prediction:8, Target's Score:[-0.7916685, 1.4861113, -0.72219956, -0.8507536, -1.5317504, -4.221368, 4.0381894, -2.794541, 7.386236, -1.6110265]
Target sample: 19, Prediction:8, Target's Score:[-0.8505497, 5.405554, -0.98530954, -1.6900377, -2.440198, -4.142583, 3.0635755, -3.3213303, 6.967544, -1.5738597]
Target sample: 25, Prediction:8, Target's Score:[1.1846758, 1.4744234, 0.009306199, -1.2195134, -0.8415172, -4.844436, 2.8045907, -3.4551065, 7.7508845, -2.4188614]
Target sample: 31, Prediction:8, Target's Score:[-1.2361124, 2.9048097, -0.053738497, -0.48762453, -0.87419224, -3.935459, 3.511082, -3.2962372, 5.5490994, -1.6751504]
Target sample: 37, Prediction:8, Target's Score:[-1.0807614, -1.4248896, 0.8882437, 3.265215, 0.59480983, -2.9048295, 2.268885, -3.0894644, 3.5271788, -1.7248912]
Target sample: 43, Prediction:8, Target's Score:[-0.90987486, -0.6417565, -0.6631641, 0.902608, -0.9425003, -1.8147305, 1.85869, -1.7531176, 4.1703577, 0.08715041]
Target sample: 49, Prediction:8, Target's Score:[-1.917539, -0.24283706, 0.18279222, 3.0371594, -2.2671897, -2.1617844, 3.466304, -1.4531764, 3.8995636, -2.2250824]
Target sample: 55, Prediction:8, Target's Score:[-0.108112045, -0.5150382, -1.8275498, -0.15743244, -2.373384, -1.8663979, 0.11600276, -1.8944476, 7.386005, 1.5767126]
Target sample: 61, Prediction:9, Target's Score:[-1.8194023, 0.17918776, -0.24699226, 2.3116105, -0.455574, -2.9460208, 1.5069603, -3.2605839, 1.9396323, 3.113013]
Target sample: 67, Prediction:1, Target's Score:[-0.44625005, 7.8056912, -0.308849, -0.7129945, -2.3677306, -3.996288, 2.92467, -4.328641, 2.3350656, -0.42820042]
Target sample: 73, Prediction:8, Target's Score:[-0.45011854, 1.2769718, -0.7452391, -0.70069426, -1.5345976, -4.9140925, 5.213331, -3.6373703, 6.4878945, -0.5746173]
Target sample: 79, Prediction:8, Target's Score:[-1.1758268, 0.25474688, -0.65332687, -0.12048644, -1.9845531, -4.0079556, 2.8066278, -3.3728967, 9.690921, -1.0411685]
Target sample: 85, Prediction:8, Target's Score:[-0.33061188, -1.0000473, -0.20287627, -0.12530111, -1.6142961, -4.6879263, 3.581732, -3.0017347, 8.279674, -0.5144249]
Target sample: 91, Prediction:6, Target's Score:[-0.18325128, 3.0558634, 0.8678641, 0.61622727, -0.8639384, -4.1022863, 5.5841026, -4.0574584, 2.086719, -2.5703583]
Target sample: 97, Prediction:8, Target's Score:[-1.3646235, 0.9132436, -1.0766139, 0.82017726, -0.6104955, -3.3342545, 3.2405543, -3.255617, 4.8227396, 0.18168224]
Target sample: 103, Prediction:6, Target's Score:[0.4282392, -2.495668, 1.7908125, 2.9216747, -0.983593, -3.9642246, 3.9221852, -3.279924, 3.241737, -1.2112966]
Target sample: 109, Prediction:6, Target's Score:[-0.7881649, -1.0967711, -0.17870116, -0.28212208, -0.8134185, -3.2213564, 10.445661, -3.8203497, 2.4721885, -2.3122845]
Target sample: 115, Prediction:3, Target's Score:[-0.14346673, -3.0569003, -1.0283594, 3.448959, 1.3517241, -1.5980322, -0.024518948, -2.1655927, 1.8506969, 1.6877811]
Target sample: 121, Prediction:8, Target's Score:[0.7833533, 2.8428829, -2.1015, -0.87737286, -2.1128159, -2.4170134, 2.1927497, -3.7729547, 3.210375, 2.6341736]
Target sample: 127, Prediction:6, Target's Score:[-0.7496725, 3.9224925, 0.25073788, 0.016435158, -1.92129, -4.208469, 4.494133, -3.8520684, 3.3199942, -0.84960216]
Target sample: 133, Prediction:8, Target's Score:[1.0287107, 2.176413, -1.6076719, -0.23811463, -1.7147346, -3.34412, 2.290057, -2.6759176, 5.0209365, -0.5581847]
Target sample: 139, Prediction:8, Target's Score:[0.6240965, -0.4046307, -0.71519434, -0.7609085, -1.3020027, -4.17984, 3.7857468, -2.9483564, 6.7571673, -0.49430692]
Current ATTACK acc on target samples: 16.667
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 05:04:44 Epoch 59, Val iteration 0, acc 92.800 (92.800)
2021-06-13 05:05:05 Epoch 59, Val iteration 19, acc 93.800 (93.210)
* Prec: 93.21000213623047
Per class accuracy =  [0.94452334 0.95046976 0.92195699 0.84880037 0.9369817  0.8899812
 0.9624316  0.94302726 0.97300977 0.95019859]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 8, 6, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 6, 8, 8, 8, 8, 8, 1, 1, 1, 1, 8, 1, 6, 1, 1, 6, 8, 9, 9, 8, 8, 1, 8, 8, 8, 8, 8, 9, 8, 8, 8, 8, 9, 9, 9, 8, 1, 8, 9, 1, 1, 6, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 6, 8, 6, 6, 6, 8, 1, 1, 6, 1, 1, 1, 8, 8, 8, 6, 6, 6, 6, 6, 6, 8, 8, 8, 6, 9, 8, 9, 9, 9, 6, 1, 1, 1, 1, 1, 6, 6, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8
ATTACK acc: 16.949152542372882
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 05:05:09, Val iteration 0, acc 92.600 (92.600)
2021-06-13 05:05:15, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-13 05:05:17, Epoch 0, Iteration 7, loss 0.353 (0.347), acc 90.385 (89.600)
2021-06-13 05:05:44, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:9, Target's Score:[-1.2282462, 3.547785, -5.0304065, 5.228429, -0.8104628, -3.3353264, -0.92078567, -1.9863774, -2.5145562, 7.526191]
Target sample: 7, Prediction:9, Target's Score:[-0.15879726, 2.5182114, -2.5924551, 3.7805574, 0.5936031, -3.8546448, -1.5502157, -1.8728962, -4.762389, 8.39007]
Target sample: 13, Prediction:9, Target's Score:[-0.18561196, 2.02902, -4.0499544, 4.373823, 0.14513607, -2.448287, -0.32008332, -0.59137857, -5.8144794, 7.315383]
Target sample: 19, Prediction:9, Target's Score:[-0.45859772, 3.0398529, -4.7300334, 2.1931636, -0.047158416, -3.7863398, 1.7050481, -1.2541089, -4.516432, 8.309833]
Target sample: 25, Prediction:3, Target's Score:[-0.3941293, 3.1159189, -4.7150564, 5.091755, 0.75454694, -1.2585509, 2.0537076, -2.1153543, -5.9274035, 3.8177729]
Target sample: 31, Prediction:1, Target's Score:[-2.0034454, 10.375082, -4.736824, 3.1273463, -2.3557873, -2.1032047, 2.704657, -2.8212965, -5.8539357, 4.203435]
Target sample: 37, Prediction:9, Target's Score:[-0.42550278, 6.323035, -4.544895, 2.2992616, -2.373805, -1.2469149, 0.59996915, -3.1289592, -5.9367256, 8.946485]
Target sample: 43, Prediction:3, Target's Score:[-0.6724812, 3.7259157, -1.9329863, 3.9661965, 0.6925417, -1.0815004, -2.449318, 3.8250258, -4.2173023, -1.4513221]
Target sample: 49, Prediction:3, Target's Score:[-3.956589, 3.5353324, -5.2176895, 6.9418306, -4.066344, 0.20666623, 0.45155483, -2.5548174, 4.0232325, 1.0378543]
Target sample: 55, Prediction:1, Target's Score:[1.5039033, 5.7841573, -4.9684014, 0.8407527, -2.1705158, -1.2969356, -0.14324509, 0.2949632, -1.5358917, 2.056617]
Target sample: 61, Prediction:3, Target's Score:[-1.0986303, 3.0717647, 0.6641516, 3.7996535, 2.1877203, -1.8900236, -1.442588, 1.1140187, -4.266293, -1.7396337]
Target sample: 67, Prediction:1, Target's Score:[-0.046767868, 7.519826, -3.073504, 1.4841088, -0.12400967, -3.9224432, -0.949374, -0.8029465, -5.105613, 5.5296173]
Target sample: 73, Prediction:9, Target's Score:[2.1219323, 2.5473228, -2.5581331, 2.7395706, 1.7035488, -4.3747044, 0.21385418, -2.1767228, -5.151174, 5.3870034]
Target sample: 79, Prediction:9, Target's Score:[-0.1861993, 5.2011914, -4.849288, 2.3050985, -1.2646997, -3.8150613, 2.9594882, -2.9896567, -3.704652, 6.786602]
Target sample: 85, Prediction:9, Target's Score:[-2.188983, 1.8599235, -4.6762094, 3.593875, -0.31845078, -3.7480717, 4.5730753, -2.7348268, -4.388639, 8.477658]
Target sample: 91, Prediction:1, Target's Score:[1.8854636, 10.418466, -2.48958, 4.852432, -2.8038275, -2.825883, -0.2675834, -5.0903134, -4.9043536, 1.7251457]
Target sample: 97, Prediction:6, Target's Score:[-2.4083185, 4.26192, -6.00162, 4.954305, 0.098430455, -1.0852888, 7.15714, -4.1488957, -5.2217417, 2.8445837]
Target sample: 103, Prediction:1, Target's Score:[-3.145174, 6.616301, -4.54886, 6.557955, -2.4479122, -1.3761221, 1.9717638, -3.1972926, -1.708808, 1.739691]
Target sample: 109, Prediction:6, Target's Score:[-3.1820207, 5.450534, -5.8937182, 6.189697, -5.91243, 2.8047016, 7.085848, -6.908088, 0.34496498, 0.44109103]
Target sample: 115, Prediction:1, Target's Score:[0.0975204, 5.772993, -1.9801903, 2.5728834, -1.1842701, -1.2192432, 1.9803314, -2.0031602, -5.0213256, 1.4034115]
Target sample: 121, Prediction:1, Target's Score:[0.42728764, 3.1223984, -3.304565, 2.8638604, 2.915086, 0.17089099, -1.2449003, 0.94942915, -3.3402903, -2.192348]
Target sample: 127, Prediction:1, Target's Score:[-0.6893859, 6.431429, -6.11152, 3.8795943, -1.73476, -0.84586376, 2.532269, -3.3462567, -5.5479984, 5.9046583]
Target sample: 133, Prediction:1, Target's Score:[-1.8373106, 5.0809994, -3.3516135, 4.2107997, 1.6537546, -3.3416827, -1.0913315, 0.41383487, -6.1559906, 4.956442]
Target sample: 139, Prediction:9, Target's Score:[1.5190403, 1.6711861, -2.199617, 3.127414, 0.72801954, -3.6660037, -1.0048554, -1.0205797, -4.3694, 5.615228]
Current ATTACK acc on target samples: 8.333
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 05:06:12 Epoch 59, Val iteration 0, acc 90.000 (90.000)
2021-06-13 05:06:18 Epoch 59, Val iteration 19, acc 90.200 (89.640)
* Prec: 89.6400016784668
Per class accuracy =  [0.92284372 0.92734407 0.8428891  0.82919232 0.88808161 0.82632125
 0.94200636 0.89635121 0.93153128 0.94985041]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 1, 9, 9, 9, 3, 9, 3, 3, 1, 1, 1, 1, 1, 1, 3, 1, 9, 1, 1, 9, 9, 3, 1, 3, 9, 1, 3, 3, 3, 1, 1, 3, 1, 3, 9, 3, 3, 9, 1, 3, 9, 9, 9, 9, 1, 6, 9, 9, 9, 9, 1, 9, 9, 9, 1, 9, 9, 1, 6, 1, 1, 1, 1, 1, 1, 1, 6, 3, 1, 6, 3, 1, 1, 1, 6, 6, 1, 3, 1, 3, 1, 1, 3, 6, 6, 3, 3, 3, 1, 9, 1, 1, 1, 9, 1, 1, 9, 9, 9, 9, 9, 9, 9, 9, 9
ATTACK acc: 6.779661016949152
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 05:06:26, Val iteration 0, acc 96.200 (96.200)
2021-06-13 05:06:38, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-13 05:06:45, Epoch 0, Iteration 7, loss 0.346 (0.739), acc 90.385 (80.200)
2021-06-13 05:07:55, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[1.6994979, 4.53037, -3.1596634, 0.14141616, -3.0535178, -3.8708599, 1.999201, -1.8640093, 1.3704598, 2.2564843]
Target sample: 7, Prediction:1, Target's Score:[-1.6345612, 4.1109715, -2.7850537, 1.2763214, -3.4918535, -2.9049518, 3.8823466, -2.1432443, 2.0333433, 1.7069886]
Target sample: 13, Prediction:6, Target's Score:[0.13224742, 2.7041135, -2.8783534, 3.0339227, -2.9900646, -2.495575, 3.885707, -2.4035573, 0.80353224, 0.25277776]
Target sample: 19, Prediction:1, Target's Score:[-0.8109998, 4.4377418, -2.9737773, 3.3120363, -3.3725805, -3.3915744, 1.991749, -1.3436824, 0.52533245, 1.6692603]
Target sample: 25, Prediction:8, Target's Score:[1.2944233, 1.6524334, -0.9224125, 0.789575, -1.8766342, -3.598935, 2.5917041, -2.628594, 4.2493863, -1.4974151]
Target sample: 31, Prediction:1, Target's Score:[-2.612981, 6.947923, -2.7577615, 0.27409562, -2.5446792, -2.7893414, 6.740616, -1.9314713, -0.6528851, -0.61064905]
Target sample: 37, Prediction:6, Target's Score:[0.18472064, 2.8584027, -3.9046466, 4.8019257, -2.7408848, -1.7756181, 4.9724283, -2.847983, -0.5806519, -0.92403704]
Target sample: 43, Prediction:6, Target's Score:[-1.2989426, 3.2769623, -4.369137, 1.6531063, -0.28677157, -1.7543402, 5.374489, -0.29971337, -0.8287649, -1.4134984]
Target sample: 49, Prediction:6, Target's Score:[-3.7125006, 3.929793, -1.7161279, 1.695068, -1.1813239, -3.073337, 5.182527, -2.432773, 2.2362785, -0.8701276]
Target sample: 55, Prediction:1, Target's Score:[-0.53686905, 5.4108696, -2.9800436, -0.26863953, -2.5803695, -2.2368598, 3.1979437, -2.1913924, 0.54990864, 1.6842151]
Target sample: 61, Prediction:1, Target's Score:[-2.5934021, 6.253701, -2.860153, 2.7821043, -2.389126, -3.3682663, 5.977994, -2.110044, -0.6345998, -0.9980036]
Target sample: 67, Prediction:1, Target's Score:[-1.2799996, 5.2208166, -1.5222288, 1.6850133, -2.0913773, -4.0566874, 1.9024011, -2.0711434, 1.8085144, 0.45885247]
Target sample: 73, Prediction:6, Target's Score:[2.1375177, 1.6515346, -3.0937202, -0.012543343, -1.4005255, -4.5767856, 3.6893797, -1.5629257, 3.2858298, -0.05770963]
Target sample: 79, Prediction:6, Target's Score:[-0.9232025, 4.918676, -3.2625618, -0.47825614, -3.2825897, -3.1775548, 5.6874547, -2.7447224, -0.25406507, 3.5726051]
Target sample: 85, Prediction:9, Target's Score:[-1.3895696, 3.0850966, -3.5515933, 0.27333584, -3.4147773, -2.9029682, 4.118857, -2.8458228, 1.9432383, 4.7301946]
Target sample: 91, Prediction:3, Target's Score:[-0.82046324, 3.5891938, -1.4642519, 6.4905314, -2.138595, -2.536078, 3.3528972, -3.8009243, -1.7788682, -0.8469044]
Target sample: 97, Prediction:6, Target's Score:[-1.7381109, 3.8359876, -4.5307837, 0.43917838, -1.1171381, -2.054782, 9.247804, -2.2472541, -0.97408164, -0.79961604]
Target sample: 103, Prediction:1, Target's Score:[-2.7558415, 5.599343, -3.32193, 3.8990018, 0.38589245, -4.4080753, 4.044714, -2.3552322, 0.28152356, -1.3121742]
Target sample: 109, Prediction:6, Target's Score:[-3.4758856, 1.845461, -1.0342752, 2.3489347, -2.7570016, -1.2465458, 9.76799, -3.5247393, 0.704121, -2.5708838]
Target sample: 115, Prediction:3, Target's Score:[-1.945364, 1.0999553, -2.8041565, 8.875113, -0.22082679, -1.4806304, 2.0669608, -3.1251512, -0.30793217, -2.125423]
Target sample: 121, Prediction:6, Target's Score:[-1.6900942, 1.0599375, -2.9825292, 3.01919, -2.0487077, -1.842541, 5.7968884, -0.60099405, -0.019983143, -0.64471406]
Target sample: 127, Prediction:6, Target's Score:[-0.60173845, 3.5132022, -4.0757847, 1.205761, -2.5985935, -3.1385143, 6.320076, -1.2063068, 0.037667185, 0.60193396]
Target sample: 133, Prediction:3, Target's Score:[-0.5116855, 3.2736812, -2.4562325, 3.5257704, -1.6115199, -4.377345, 1.3092096, 0.7865625, -0.7427864, 0.8556922]
Target sample: 139, Prediction:9, Target's Score:[3.23902, 1.8966551, -2.9208803, -0.011843793, -3.5076034, -3.929724, 2.7149832, -2.2615912, 1.1941422, 3.6314948]
Current ATTACK acc on target samples: 41.667
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 05:09:05 Epoch 59, Val iteration 0, acc 92.800 (92.800)
2021-06-13 05:09:17 Epoch 59, Val iteration 19, acc 93.800 (92.960)
* Prec: 92.96000251770019
Per class accuracy =  [0.94609632 0.93469724 0.88717112 0.85360593 0.9462002  0.91280221
 0.94791524 0.94317416 0.95811712 0.96109234]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 6, 6, 6, 1, 6, 6, 6, 1, 6, 1, 6, 1, 1, 1, 8, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 3, 1, 1, 6, 6, 6, 3, 6, 6, 1, 1, 6, 6, 1, 6, 6, 1, 1, 6, 9, 6, 6, 6, 1, 1, 1, 1, 1, 1, 3, 6, 6, 8, 1, 1, 1, 1, 1, 6, 6, 1, 9, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 3, 6, 6, 6, 3, 6, 6, 6, 6, 6, 6, 6, 6, 3, 6, 3, 1, 1, 1, 8, 1, 6, 6, 6
ATTACK acc: 55.932203389830505
--------
------SUMMARY PRE DEFENSE------
TIME ELAPSED (mins): 15
TARGET INDEX: 14
ResNet50 45.833333333333336 34.74576271186441 95.46000137329102 92.06000099182128
DPN92 16.666666666666668 16.949152542372882 95.50000267028808 93.21000213623047
MobileNetV2 8.333333333333334 6.779661016949152 91.22000160217286 89.6400016784668
GoogLeNet 41.666666666666664 55.932203389830505 95.41000213623047 92.96000251770019
DEFENSE EVALUATION
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
ResNet50
[74, 80, 84, 86, 89] 5
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 05:09:22, Val iteration 0, acc 94.200 (94.200)
2021-06-13 05:09:33, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-13 05:09:35, Epoch 0, Iteration 7, loss 0.832 (0.276), acc 71.154 (93.400)
2021-06-13 05:10:35, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[0.061237015, 8.43891, -1.5868683, -2.4682155, -2.4201539, -4.07814, -3.1772068, -3.4263134, 4.8599453, 4.227739]
Target sample: 7, Prediction:1, Target's Score:[-0.646702, 7.4823914, -1.6920162, -1.2888722, -3.28978, -3.8944461, -2.6904018, -3.2808535, 6.657891, 3.03923]
Target sample: 13, Prediction:8, Target's Score:[1.0894617, 3.816549, -0.8766194, -1.11133, -3.133797, -4.3141255, -3.2767336, -3.2116096, 8.297406, 3.0985878]
Target sample: 19, Prediction:8, Target's Score:[1.2689834, 3.7767084, -3.1111841, -1.9604443, -3.400122, -3.4239094, -2.0816023, -3.652726, 13.599373, -0.70630294]
Target sample: 25, Prediction:1, Target's Score:[-0.8522297, 13.459875, -2.9446373, -2.2229462, -2.9412313, -3.9035666, -1.8893657, -3.5981593, 2.71002, 2.6534133]
Target sample: 31, Prediction:1, Target's Score:[-2.2880404, 12.231248, -1.5342652, -2.2798867, -3.1838942, -4.1734843, -0.4910183, -3.2668905, 0.6166318, 4.8672056]
Target sample: 37, Prediction:1, Target's Score:[1.1259843, 8.53395, -3.4431818, 3.2082622, -3.4938662, -2.0583518, 0.9847323, -3.6940157, 0.8016854, -1.582772]
Target sample: 43, Prediction:1, Target's Score:[1.9831177, 4.686583, -2.3263693, 1.3685272, -1.9648237, -1.3237858, -0.32199964, -2.6033692, 0.17975116, 0.6831404]
Target sample: 49, Prediction:1, Target's Score:[-0.30570742, 9.760156, -3.3847368, 0.1920419, -3.975338, -2.8811758, -0.7824981, -3.7032704, 5.6830297, -0.244578]
Target sample: 55, Prediction:1, Target's Score:[3.4679928, 7.5224724, -3.3602507, -1.8761988, -1.8590814, -2.6619785, -1.7345608, -2.7877498, 1.1002822, 2.5768702]
Target sample: 61, Prediction:9, Target's Score:[-1.2115206, 5.1634235, 0.8089528, -1.5108904, -0.6550663, -4.39864, -2.7090235, -3.3981912, -0.51487446, 8.974029]
Target sample: 67, Prediction:9, Target's Score:[-1.8962675, 6.54073, 1.7853117, -1.5152358, -2.2812257, -4.6195188, -3.2462146, -3.1747227, -1.3577336, 10.374791]
Target sample: 73, Prediction:1, Target's Score:[-0.35988647, 7.9059925, -0.6142975, -0.8031969, -2.4780493, -4.0586953, -2.620879, -3.435708, 2.4665904, 4.444114]
Target sample: 79, Prediction:1, Target's Score:[0.6151175, 9.856743, -3.5687745, -2.0505497, -3.505058, -3.4253702, -1.5550045, -3.3827977, 7.527043, -0.15732893]
Target sample: 85, Prediction:1, Target's Score:[2.1896622, 9.285022, -3.192918, -2.2541466, -3.102428, -3.7917569, -2.4584742, -3.4475002, 5.406095, 1.7482878]
Target sample: 91, Prediction:1, Target's Score:[0.06471732, 10.813128, -2.4951673, -0.72447336, -2.0920992, -2.7451818, 0.23777898, -3.7294526, 0.55661875, 0.5127079]
Target sample: 97, Prediction:1, Target's Score:[-0.10763769, 10.399444, -3.2503524, -1.2518444, -2.3608737, -2.8857574, 1.756918, -3.5610292, 0.9778649, 0.6628576]
Target sample: 103, Prediction:1, Target's Score:[0.5669362, 10.657643, -3.8519833, 0.3143822, -2.5129898, -2.7539804, 0.7411709, -4.213119, 2.9820604, -1.5583744]
Target sample: 109, Prediction:1, Target's Score:[0.1820058, 10.024226, -4.4684234, -0.5655981, -2.131224, -2.4538033, 3.266761, -3.9515567, 2.909026, -2.449298]
Target sample: 115, Prediction:1, Target's Score:[1.0300993, 8.767463, -3.5440466, 0.12443142, -2.1195118, -2.8199217, 0.12625271, -3.726943, 2.5335352, -0.0019420218]
Target sample: 121, Prediction:1, Target's Score:[0.41222978, 11.274756, -3.6494265, -1.7457765, -1.5775274, -2.9423118, -0.5736883, -3.5601654, 2.6650028, 0.102130644]
Target sample: 127, Prediction:9, Target's Score:[-0.37496954, 7.063416, 0.21611652, -1.1252004, -2.2674727, -4.311372, -2.4473681, -3.0933988, -1.2974083, 8.155094]
Target sample: 133, Prediction:1, Target's Score:[1.7306509, 8.031337, -1.103396, -1.1733543, -0.34538355, -3.646305, -3.0589273, -3.2122211, 0.19629471, 3.0414627]
Target sample: 139, Prediction:8, Target's Score:[2.2638736, 5.6842127, -2.5250955, -1.9301455, -3.3707075, -4.1855683, -2.5987961, -3.1579056, 8.614001, 1.5441622]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 05:11:34 Epoch 59, Val iteration 0, acc 91.200 (91.200)
2021-06-13 05:11:45 Epoch 59, Val iteration 19, acc 91.800 (91.670)
* Prec: 91.67000198364258
Per class accuracy =  [0.94493515 0.94435098 0.89709387 0.88734154 0.88455307 0.83936964
 0.91636257 0.94279809 0.95932848 0.95163528]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 8, 1, 8, 8, 8, 1, 8, 8, 8, 8, 8, 8, 8, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 9, 9, 9, 1, 1, 1, 1, 9, 9, 9, 9, 9, 9, 1, 9, 9, 1, 8, 8, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 6, 6, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 9, 9, 1, 1, 8, 8, 1, 8, 8, 8
ATTACK acc: 2.542372881355932
DPN92
[80, 84] 24
Using Adam for retraining
2000
poison index =  74
poison index =  86
poison index =  89
497
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 05:11:49, Val iteration 0, acc 94.800 (94.800)
2021-06-13 05:12:10, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-13 05:12:15, Epoch 0, Iteration 7, loss 0.284 (0.395), acc 92.308 (91.400)
2021-06-13 05:14:53, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6]
Target sample: 1, Prediction:8, Target's Score:[0.6983207, 0.21200763, -2.9122417, 1.3322043, -2.7531636, -4.2287602, 1.4334289, -1.2468597, 7.934142, -0.049858242]
Target sample: 7, Prediction:8, Target's Score:[-0.10649997, 1.788996, -2.7199461, 1.6136607, -3.6230478, -4.133368, 4.303631, -1.8003763, 6.346214, -1.2468902]
Target sample: 13, Prediction:8, Target's Score:[-0.75993556, 2.9812047, -2.9034255, 1.3826848, -3.6212718, -3.8585613, 4.0135984, -1.9028013, 6.4247055, -1.3428291]
Target sample: 19, Prediction:8, Target's Score:[-0.8089418, 3.9766395, -3.3962772, 0.7891162, -4.033638, -3.8298707, 3.9561832, -1.8470727, 6.3521132, -0.73707974]
Target sample: 25, Prediction:8, Target's Score:[0.21456213, 3.61839, -2.4863057, 1.3948742, -3.2683938, -4.359159, 3.1954622, -2.0729368, 5.97041, -1.7658492]
Target sample: 31, Prediction:1, Target's Score:[-0.9969008, 4.7183523, -2.8301392, 2.3774958, -3.5060992, -3.4696624, 3.8425686, -2.0158036, 4.168511, -1.8589963]
Target sample: 37, Prediction:3, Target's Score:[-1.4740103, 0.78469306, -1.3898258, 5.433807, -2.3048701, -2.7445934, 4.2710137, -1.543471, 2.3432794, -3.0054889]
Target sample: 43, Prediction:8, Target's Score:[-1.0485209, -0.26427662, -1.4618098, 2.5835197, -1.9307764, -2.6291976, 2.6923604, 0.30136555, 4.4374347, -2.323193]
Target sample: 49, Prediction:8, Target's Score:[-1.5114166, -0.15445136, -0.8856312, 4.0636573, -3.1314037, -2.5887947, 1.587195, 0.008521385, 5.7028384, -2.6902554]
Target sample: 55, Prediction:8, Target's Score:[0.8256245, -0.2995073, -1.5291411, 0.7997212, -3.386996, -3.30493, 1.0942261, -1.1908726, 8.161507, -0.75277084]
Target sample: 61, Prediction:3, Target's Score:[-0.5105735, 0.8931425, -1.6628872, 4.7724833, -2.505175, -2.9028409, 0.6751162, -1.7990166, 2.8791347, 0.5261801]
Target sample: 67, Prediction:1, Target's Score:[-0.54220855, 7.4112124, -2.7734494, 3.0281456, -4.629721, -3.030926, 3.001867, -2.8602052, 1.6293038, -0.76252234]
Target sample: 73, Prediction:8, Target's Score:[0.29290262, 1.6069124, -3.1071236, 1.2601067, -3.7245402, -4.3039274, 4.4837265, -1.7342635, 5.6629577, -0.013270961]
Target sample: 79, Prediction:8, Target's Score:[-0.51786333, 0.92767316, -2.722659, 1.0738578, -3.9462376, -3.489736, 3.8740208, -2.0608137, 7.1983, 0.06955212]
Target sample: 85, Prediction:8, Target's Score:[0.49097088, -0.03212084, -2.826166, 1.9052896, -3.7825997, -4.604459, 2.9005506, -1.323563, 7.582184, 0.12827893]
Target sample: 91, Prediction:3, Target's Score:[-0.8181516, 4.4392967, -2.3275375, 4.6705756, -3.3774493, -3.1270773, 4.568842, -2.794735, 1.6958693, -2.484936]
Target sample: 97, Prediction:6, Target's Score:[-1.0555105, 1.9511554, -2.8899221, 3.0721467, -3.3423696, -3.3987832, 5.8286204, -1.8181113, 3.8816752, -1.8372504]
Target sample: 103, Prediction:6, Target's Score:[-0.7965135, 0.1629388, -0.76842964, 3.6695862, -2.475428, -3.7759612, 5.7509665, -2.2234094, 3.612953, -2.7581074]
Target sample: 109, Prediction:6, Target's Score:[-1.7252188, 0.6701754, -2.102686, 0.21115026, -2.2393632, -3.1158943, 9.34732, -3.0545502, 5.307766, -2.8923235]
Target sample: 115, Prediction:3, Target's Score:[-0.44103009, -1.2461154, -0.3180666, 6.1108837, 0.45911482, -2.4849896, 0.87123644, -1.5446206, 1.7746872, -2.8030176]
Target sample: 121, Prediction:6, Target's Score:[0.043999612, 2.3197548, -2.5056841, 2.5578246, -3.3756251, -2.5070996, 5.0154514, -1.9825342, 2.9173782, -2.1226234]
Target sample: 127, Prediction:6, Target's Score:[-0.6405005, 3.8514142, -2.541277, 2.6274798, -3.8278432, -3.4356863, 5.4427514, -2.3784003, 2.7565646, -1.4385002]
Target sample: 133, Prediction:8, Target's Score:[0.59345686, 1.6850486, -3.012061, 1.4886364, -3.281185, -3.5430188, 3.226749, -1.2242105, 4.9992447, -0.55503404]
Target sample: 139, Prediction:8, Target's Score:[0.4668868, 0.7264745, -2.747747, 1.321212, -3.3632193, -4.24622, 3.0227242, -1.5445389, 7.1953607, -0.42824852]
Current ATTACK acc on target samples: 20.833
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 05:17:27 Epoch 59, Val iteration 0, acc 92.000 (92.000)
2021-06-13 05:17:47 Epoch 59, Val iteration 19, acc 93.600 (93.080)
* Prec: 93.0800006866455
Per class accuracy =  [0.9387544  0.96631963 0.89774115 0.84335423 0.95226274 0.89848412
 0.95883934 0.93133442 0.97798507 0.94699189]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 8, 6, 8, 8, 8, 8, 8, 8, 8, 8, 8, 1, 1, 6, 8, 8, 8, 6, 6, 1, 1, 1, 1, 1, 1, 3, 1, 1, 6, 6, 8, 9, 6, 8, 8, 3, 8, 6, 8, 8, 8, 8, 3, 8, 8, 8, 8, 3, 3, 1, 3, 3, 1, 1, 3, 6, 8, 8, 8, 8, 8, 8, 8, 8, 8, 1, 8, 8, 8, 6, 6, 6, 8, 1, 6, 6, 1, 1, 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 8, 8, 8, 6, 6, 8, 6, 6, 3, 3, 3, 6, 1, 6, 1, 6, 6, 6, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8
ATTACK acc: 27.11864406779661
MobileNetV2
[74, 80, 89] 46
Using Adam for retraining
2000
poison index =  84
poison index =  86
498
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 05:17:51, Val iteration 0, acc 92.600 (92.600)
2021-06-13 05:17:57, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-13 05:17:58, Epoch 0, Iteration 7, loss 0.206 (0.304), acc 88.462 (90.000)
2021-06-13 05:18:26, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6]
Target sample: 1, Prediction:9, Target's Score:[-0.027302518, 5.6511035, -5.3070574, 4.437074, -1.7143451, -3.4466655, -2.5789542, -2.4087842, -2.6766868, 8.6805725]
Target sample: 7, Prediction:9, Target's Score:[1.3855356, 4.9115787, -2.8891263, 2.0429397, -0.77024966, -4.3088827, -3.0797403, -2.5342405, -3.9467256, 9.801147]
Target sample: 13, Prediction:9, Target's Score:[0.57169265, 4.4887857, -4.295635, 3.4221282, -1.1138014, -2.9093032, -1.5857431, -1.5736425, -5.4308734, 9.01686]
Target sample: 19, Prediction:9, Target's Score:[0.4432358, 6.0232067, -4.8282585, 0.881363, -1.1002412, -4.478698, -0.06712882, -2.097141, -3.853463, 9.690399]
Target sample: 25, Prediction:1, Target's Score:[-0.259759, 6.2361393, -5.317032, 4.0010204, -0.1885256, -1.6259798, 0.95258504, -2.6377828, -5.723967, 5.142362]
Target sample: 31, Prediction:1, Target's Score:[-1.4519254, 13.772803, -5.7425795, 2.3146572, -3.5950825, -2.2211406, 0.5194664, -3.2768397, -5.5146313, 5.941874]
Target sample: 37, Prediction:9, Target's Score:[0.13050768, 8.6030035, -4.778015, 1.4522656, -3.73443, -1.0277784, -1.0016266, -3.6003408, -5.6111917, 10.245527]
Target sample: 43, Prediction:1, Target's Score:[-0.11832617, 5.632361, -2.8154304, 3.4677353, -0.047166225, -1.248618, -3.8117194, 3.5925143, -3.8067183, -0.3340284]
Target sample: 49, Prediction:3, Target's Score:[-3.7205048, 5.7262273, -6.177843, 6.0299377, -4.8952785, 0.05648898, -0.5094179, -2.4932334, 4.656725, 1.8551705]
Target sample: 55, Prediction:1, Target's Score:[2.0712306, 7.504275, -5.5152206, 0.26464546, -3.49074, -1.3218325, -1.5318222, -0.23020568, -1.1088032, 3.876321]
Target sample: 61, Prediction:1, Target's Score:[0.19556819, 5.4088607, -0.5060338, 2.4695039, 1.7012343, -2.2822316, -2.6641407, 0.40685913, -4.1684475, -0.06054733]
Target sample: 67, Prediction:1, Target's Score:[0.9879579, 10.035162, -3.5678325, 0.7279065, -1.680256, -4.066137, -2.7848437, -1.2972004, -4.8093853, 7.125738]
Target sample: 73, Prediction:9, Target's Score:[2.9305503, 5.004373, -3.0490541, 1.7358252, 0.3231209, -4.6394773, -0.9437072, -2.8004315, -4.618144, 6.6450987]
Target sample: 79, Prediction:1, Target's Score:[0.8039163, 8.611744, -5.1979275, 1.0876747, -2.582684, -4.1418433, 0.76766986, -3.4480784, -2.909524, 7.619118]
Target sample: 85, Prediction:9, Target's Score:[-1.5421516, 4.5910506, -5.051688, 2.8087409, -1.6547416, -4.014362, 2.332899, -3.4381523, -3.726521, 10.29627]
Target sample: 91, Prediction:1, Target's Score:[2.5926185, 12.677037, -3.1868742, 4.007178, -3.7011888, -2.854693, -1.6174741, -5.336826, -4.9372215, 3.047595]
Target sample: 97, Prediction:1, Target's Score:[-2.4620078, 7.3497863, -6.4913874, 4.004536, -1.0089253, -0.9741913, 5.4221225, -4.897839, -4.5368547, 4.2246337]
Target sample: 103, Prediction:1, Target's Score:[-2.8299582, 9.429945, -5.122143, 5.6339583, -3.434118, -1.1711142, 0.7983518, -3.776516, -1.3916287, 2.4805198]
Target sample: 109, Prediction:1, Target's Score:[-3.3476815, 8.203979, -6.4125166, 5.267019, -6.6175575, 2.798882, 6.0798297, -7.36521, 0.42579105, 1.5915186]
Target sample: 115, Prediction:1, Target's Score:[1.0755584, 8.122533, -2.7458553, 1.8663651, -2.061192, -1.2753372, 0.3732275, -2.5881574, -4.5865183, 2.3871562]
Target sample: 121, Prediction:1, Target's Score:[0.8956007, 5.0018134, -4.0467844, 1.9766285, 1.8252428, -0.27451098, -1.96648, 0.6185298, -2.9262865, -0.6341142]
Target sample: 127, Prediction:1, Target's Score:[-0.27668232, 9.331395, -6.4726667, 3.337065, -3.2516098, -1.1795996, 0.9666556, -3.9886322, -4.942209, 7.129878]
Target sample: 133, Prediction:1, Target's Score:[-0.7250944, 7.299325, -3.9272685, 3.3184454, 0.30416417, -3.4629207, -2.2817962, -0.14261001, -6.4437485, 6.736422]
Target sample: 139, Prediction:9, Target's Score:[2.6026661, 3.5682256, -2.5617623, 2.3066626, -0.24409333, -4.133423, -2.4407964, -1.5655378, -3.929848, 6.916799]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 05:18:54 Epoch 59, Val iteration 0, acc 89.800 (89.800)
2021-06-13 05:19:00 Epoch 59, Val iteration 19, acc 90.000 (89.530)
* Prec: 89.53000068664551
Per class accuracy =  [0.92277212 0.93308886 0.84169537 0.83283603 0.88960936 0.82283013
 0.9335827  0.89100923 0.93271963 0.94845512]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 1, 9, 9, 9, 1, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 1, 1, 1, 1, 1, 3, 1, 9, 1, 1, 1, 1, 9, 9, 3, 9, 9, 1, 1, 9, 1, 9, 9, 1, 1, 9, 1, 9, 9, 1, 9, 9, 9, 1, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 9, 1, 1, 3, 6, 9, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 9, 9, 9, 9, 9, 9, 9, 1
ATTACK acc: 1.694915254237288
GoogLeNet
[74, 80, 84, 86, 89] 22
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 05:19:04, Val iteration 0, acc 96.200 (96.200)
2021-06-13 05:19:16, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-13 05:19:19, Epoch 0, Iteration 7, loss 0.518 (0.992), acc 88.462 (79.200)
2021-06-13 05:20:29, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[3.6161888, 9.057971, -5.6047163, -4.154629, -3.0345922, -2.8548594, -3.193951, -2.572736, 5.274207, 3.5607853]
Target sample: 7, Prediction:1, Target's Score:[1.2893268, 8.611719, -4.758245, -3.5780203, -3.0079958, -1.9830377, -2.3682368, -2.8835118, 5.6041746, 3.1629267]
Target sample: 13, Prediction:8, Target's Score:[1.3681926, 6.5989156, -5.589834, -2.12104, -3.0316293, -2.0241797, -1.4474369, -2.7044535, 6.9973283, 2.038141]
Target sample: 19, Prediction:1, Target's Score:[1.2339996, 8.152376, -5.5548763, -1.4083349, -3.428072, -2.587594, -2.4549792, -2.786357, 4.1072206, 4.809014]
Target sample: 25, Prediction:8, Target's Score:[2.8145916, 4.972322, -3.22921, -3.5944717, -1.541483, -2.1924858, -1.3501906, -3.4409873, 6.4271727, 1.2193327]
Target sample: 31, Prediction:1, Target's Score:[-1.1846038, 11.971972, -3.6987913, -3.081847, -1.2903309, -1.5792799, -2.506366, -3.3623366, 2.1341085, 2.685918]
Target sample: 37, Prediction:8, Target's Score:[2.4736671, 4.3925014, -3.6616614, 0.1589096, -2.6661274, -1.0499698, -1.7035822, -3.444265, 4.451974, 1.1216015]
Target sample: 43, Prediction:1, Target's Score:[0.015493074, 6.811566, -5.238418, -0.46564746, -2.145921, -1.5142059, 0.11873825, -0.84592503, 2.4747767, 0.8583425]
Target sample: 49, Prediction:1, Target's Score:[-4.681952, 10.285644, -4.795185, -1.5949746, -1.1472365, 0.025249433, -1.7136298, -2.121609, 5.3007936, 0.5326672]
Target sample: 55, Prediction:1, Target's Score:[0.19494705, 8.5152645, -3.8711746, -3.3811798, -2.328062, -0.7650636, -2.2639418, -1.6921556, 2.9666166, 2.7132144]
Target sample: 61, Prediction:1, Target's Score:[-2.5055585, 10.644211, -4.4535627, -0.7170506, 0.9046614, -3.0105753, -1.5796717, -1.7666928, 0.928812, 1.6259139]
Target sample: 67, Prediction:1, Target's Score:[0.34017226, 8.748723, -2.9636862, -3.4392116, -1.7411622, -2.134132, -3.6199903, -2.8133607, 5.130583, 2.5801244]
Target sample: 73, Prediction:8, Target's Score:[3.6793756, 5.0412536, -4.881162, -3.4972427, -0.7622412, -3.2604537, -1.2798066, -2.8544745, 5.9922323, 1.9031492]
Target sample: 79, Prediction:1, Target's Score:[1.2327107, 10.064625, -4.9383993, -4.3956594, -2.912999, -3.0200324, -0.44598737, -3.1955786, 1.5273616, 6.181257]
Target sample: 85, Prediction:1, Target's Score:[-0.15713187, 7.2856174, -5.2892942, -3.3794, -3.174911, -2.7162392, -1.7726628, -3.40277, 6.635835, 6.064835]
Target sample: 91, Prediction:1, Target's Score:[-1.3066219, 8.046464, -2.2233207, -0.33838814, -0.96510404, -0.5195925, -1.0948497, -3.8858612, 0.4922438, 1.8714784]
Target sample: 97, Prediction:1, Target's Score:[-0.27424985, 7.1416025, -5.653177, -3.0072474, -0.98691684, -1.8977008, 4.201092, -3.0158038, 2.4883478, 1.0803263]
Target sample: 103, Prediction:1, Target's Score:[-2.3018615, 6.400095, -3.1129546, 1.1796467, 2.8608036, -3.6209276, -0.26002234, -3.2741547, 2.1789474, 0.004795596]
Target sample: 109, Prediction:8, Target's Score:[-2.079951, 3.8648157, -2.8413813, -2.6119328, -0.32978663, -0.20253785, 3.596498, -3.1044533, 5.285879, -1.5037466]
Target sample: 115, Prediction:3, Target's Score:[-0.75887764, 2.8825283, -5.2145643, 3.4916036, 0.29515907, 0.65139556, -0.12057301, -3.819975, 2.4919758, 0.16277473]
Target sample: 121, Prediction:1, Target's Score:[-2.3216097, 5.8960376, -4.675349, -0.8424608, -2.5001228, -0.80488247, 0.200257, -1.4349363, 2.9250796, 3.634344]
Target sample: 127, Prediction:1, Target's Score:[-1.1508964, 8.785548, -5.5827904, -3.6067333, -3.2420907, -2.5191536, 1.022309, -2.457249, 2.8992407, 5.9465365]
Target sample: 133, Prediction:1, Target's Score:[0.3947144, 8.466567, -5.219494, -1.423215, -1.5347775, -2.6666167, -2.9548225, -0.8111672, 2.471716, 3.3549902]
Target sample: 139, Prediction:1, Target's Score:[5.841523, 6.09024, -5.008114, -4.135414, -2.9784517, -2.1059384, -2.6137686, -3.0773532, 4.3675675, 3.7150385]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 05:21:38 Epoch 59, Val iteration 0, acc 93.600 (93.600)
2021-06-13 05:21:50 Epoch 59, Val iteration 19, acc 93.000 (92.540)
* Prec: 92.54000129699708
Per class accuracy =  [0.95601685 0.96052193 0.88937503 0.89371302 0.92812991 0.84955222
 0.95257197 0.91296059 0.95784902 0.95154189]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 1, 1, 1, 9, 8, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 1, 9, 1, 1, 1, 1, 1, 1, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 8, 1, 1, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 6, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 8, 8, 8, 6, 6, 1, 1, 9, 1, 1, 1, 9, 1, 8, 1, 1, 1, 1, 8, 1, 0, 8, 1
ATTACK acc: 3.389830508474576
------SUMMARY POST DEFENSE------
TIME ELAPSED (mins): 15
TARGET INDEX: 14
ResNet50 0.0 2.542372881355932 95.46000137329102 91.67000198364258 100.0
DPN92 20.833333333333332 27.11864406779661 95.50000267028808 93.0800006866455 40.0
MobileNetV2 0.0 1.694915254237288 91.22000160217286 89.53000068664551 60.0
GoogLeNet 0.0 3.389830508474576 95.41000213623047 92.54000129699708 100.0
True False False False False
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.300-droplayer0.000.t7
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
No specific indices are determined, so try to include whatever we find
In total, we found 92 images of target 15
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', eval_poisons_root='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=False, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=15, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/15/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
# Targets: 16, # Poisons: 5
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-13 05:22:08 Iteration 0 	 Training Loss: 9.723e-01 	 Loss in Target Net: 2.186e+00	  
 2021-06-13 05:22:57 Iteration 50 	 Training Loss: 2.351e-01 	 Loss in Target Net: 3.580e-01	  
 2021-06-13 05:23:46 Iteration 100 	 Training Loss: 2.114e-01 	 Loss in Target Net: 3.880e-01	  
 2021-06-13 05:24:34 Iteration 150 	 Training Loss: 2.033e-01 	 Loss in Target Net: 3.671e-01	  
 2021-06-13 05:25:23 Iteration 200 	 Training Loss: 2.071e-01 	 Loss in Target Net: 3.426e-01	  
 2021-06-13 05:26:09 Iteration 250 	 Training Loss: 1.957e-01 	 Loss in Target Net: 3.845e-01	  
 2021-06-13 05:26:56 Iteration 300 	 Training Loss: 1.978e-01 	 Loss in Target Net: 4.033e-01	  
 2021-06-13 05:27:43 Iteration 350 	 Training Loss: 1.920e-01 	 Loss in Target Net: 3.586e-01	  
 2021-06-13 05:28:30 Iteration 400 	 Training Loss: 1.891e-01 	 Loss in Target Net: 3.434e-01	  
 2021-06-13 05:29:18 Iteration 450 	 Training Loss: 1.861e-01 	 Loss in Target Net: 4.050e-01	  
 2021-06-13 05:30:07 Iteration 500 	 Training Loss: 1.941e-01 	 Loss in Target Net: 3.578e-01	  
 2021-06-13 05:30:54 Iteration 550 	 Training Loss: 1.878e-01 	 Loss in Target Net: 3.478e-01	  
 2021-06-13 05:31:42 Iteration 600 	 Training Loss: 1.846e-01 	 Loss in Target Net: 3.335e-01	  
 2021-06-13 05:32:30 Iteration 650 	 Training Loss: 1.795e-01 	 Loss in Target Net: 4.052e-01	  
 2021-06-13 05:33:19 Iteration 700 	 Training Loss: 1.918e-01 	 Loss in Target Net: 4.674e-01	  
 2021-06-13 05:34:07 Iteration 750 	 Training Loss: 1.832e-01 	 Loss in Target Net: 3.478e-01	  
 2021-06-13 05:34:55 Iteration 800 	 Training Loss: 1.840e-01 	 Loss in Target Net: 3.891e-01	  
 2021-06-13 05:35:43 Iteration 850 	 Training Loss: 1.833e-01 	 Loss in Target Net: 3.836e-01	  
 2021-06-13 05:36:31 Iteration 900 	 Training Loss: 1.806e-01 	 Loss in Target Net: 3.457e-01	  
 2021-06-13 05:37:20 Iteration 950 	 Training Loss: 1.857e-01 	 Loss in Target Net: 4.053e-01	  
 2021-06-13 05:38:10 Iteration 999 	 Training Loss: 1.855e-01 	 Loss in Target Net: 3.662e-01	  
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 05:38:16, Val iteration 0, acc 94.200 (94.200)
2021-06-13 05:38:26, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-13 05:38:31, Epoch 0, Iteration 7, loss 0.605 (0.851), acc 76.923 (85.000)
2021-06-13 05:39:31, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-2.1249385, 6.599339, -1.3553419, 1.1017696, -3.7815275, -3.024729, 6.478852, -2.4990854, 2.9748144, -4.115974]
Target sample: 7, Prediction:1, Target's Score:[-1.26609, 7.307084, -3.0931878, -0.34000915, -3.9023328, -1.6461979, 6.786174, -2.0229697, 0.25476998, -1.8443425]
Target sample: 13, Prediction:1, Target's Score:[-2.9963882, 9.903663, -2.7273943, -0.9880477, -4.2336717, -0.51211447, 4.8860245, -1.962532, -3.9211118, 2.803389]
Target sample: 19, Prediction:1, Target's Score:[-3.4793665, 12.583289, -2.7558134, -0.23217934, -4.29739, -3.1139438, 4.009456, -2.5528948, -0.7964037, 0.90854865]
Target sample: 25, Prediction:8, Target's Score:[-0.48709273, 2.7058175, -1.5513155, 0.31631234, -3.4304736, -3.4086816, 4.032441, -0.75793636, 4.6420054, -1.8546098]
Target sample: 31, Prediction:1, Target's Score:[-0.2857678, 5.6061335, -3.8838954, 1.8553292, -4.4751062, 0.030053178, 1.8817091, -0.02659324, -4.024641, 3.5379598]
Target sample: 37, Prediction:1, Target's Score:[-0.6912729, 5.5738935, -2.9133437, 0.062971964, -1.5130782, -2.6339142, 0.13708998, -2.1392484, -0.8396391, 5.1973224]
Target sample: 43, Prediction:1, Target's Score:[-2.8551037, 7.664165, -1.3609995, 0.13533963, -3.2872086, -3.3161838, 6.984285, -2.311678, 0.95048547, -2.3556786]
Target sample: 49, Prediction:1, Target's Score:[-0.5588096, 7.3892384, -2.3460512, -0.08497613, -2.8407266, -3.3168898, 2.0684588, -2.5153105, 3.3966413, -0.953919]
Target sample: 55, Prediction:9, Target's Score:[1.3036314, 3.7208714, -4.358954, 2.735807, -4.7145944, 1.9933972, 0.44695583, -0.40139616, -4.5488615, 4.07268]
Target sample: 61, Prediction:1, Target's Score:[-2.3644543, 7.186997, -2.511002, 1.887954, -3.7058272, -2.1648676, 4.346729, -0.65162444, -1.4375746, -0.36424282]
Target sample: 67, Prediction:1, Target's Score:[-2.4162252, 10.292781, -3.1155202, 0.83880246, -4.31674, -2.673491, 3.2479236, -2.9784126, -0.92316985, 2.2978296]
Target sample: 73, Prediction:1, Target's Score:[-1.6336086, 8.086187, -2.8765054, 1.4401193, -3.8880591, -2.0660987, 2.6780198, -1.8503195, -3.2804582, 3.6178522]
Target sample: 79, Prediction:9, Target's Score:[-3.7543197, 8.451108, -1.3078338, -2.048285, -4.30442, -1.4529722, 4.0368795, -3.412329, -4.9575577, 9.012233]
Target sample: 85, Prediction:6, Target's Score:[-2.3875272, 6.917037, -1.5465149, 1.8439584, -3.704125, -2.809762, 6.948454, -2.3728585, 1.1084805, -3.7456608]
Target sample: 91, Prediction:6, Target's Score:[-1.3273499, 4.7422805, -2.022923, 0.6344904, -3.546269, -1.2459882, 6.6696467, -2.122277, 1.481209, -3.0349967]
Current ATTACK acc on target samples: 12.500
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 05:40:30 Epoch 59, Val iteration 0, acc 90.800 (90.800)
2021-06-13 05:40:40 Epoch 59, Val iteration 19, acc 91.800 (91.190)
* Prec: 91.19000205993652
Per class accuracy =  [0.94000394 0.95594918 0.80485334 0.90056723 0.8953319  0.83102159
 0.95027832 0.9330401  0.96782462 0.93521697]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 8, 1, 1, 1, 6, 9, 1, 9, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 9, 9, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 6, 6, 6, 1, 1, 6, 6, 1
ATTACK acc: 13.157894736842104
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 05:40:53, Val iteration 0, acc 94.800 (94.800)
2021-06-13 05:41:13, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-13 05:41:28, Epoch 0, Iteration 7, loss 0.560 (0.465), acc 88.462 (89.400)
2021-06-13 05:44:06, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-0.34946778, 9.942824, -4.217107, -1.1091161, -4.0408173, -2.2506163, 4.7312613, -2.431614, 1.0703629, -0.8249232]
Target sample: 7, Prediction:1, Target's Score:[-0.12978761, 10.143701, -4.3046494, -0.7112794, -3.7199605, -2.9132926, 2.4200385, -2.7410254, 1.0805473, 1.4103]
Target sample: 13, Prediction:1, Target's Score:[-0.51562965, 13.343094, -3.9128726, -1.22174, -4.262502, -2.9444757, 2.587947, -2.7912822, -0.2865951, 0.61161375]
Target sample: 19, Prediction:1, Target's Score:[-0.5118381, 9.513339, -3.074667, -0.90267384, -3.7303114, -2.549845, 2.1910217, -2.1519585, 1.7855456, -0.08506459]
Target sample: 25, Prediction:1, Target's Score:[-0.14471327, 5.658836, -5.0091314, 0.51033145, -3.7492268, -4.365823, 3.622897, -1.1414108, 4.4485626, 0.6586945]
Target sample: 31, Prediction:1, Target's Score:[0.33626106, 8.25721, -4.119287, 0.62698793, -4.0038586, -3.0593004, 3.6178713, -0.8453171, 2.1345682, -2.4482317]
Target sample: 37, Prediction:1, Target's Score:[-1.4604454, 11.591673, -3.516923, -0.64881486, -3.4587383, -2.4514291, 1.3903757, -2.2708392, 1.2724211, 0.048727944]
Target sample: 43, Prediction:1, Target's Score:[-0.74815077, 11.207664, -3.7234826, -0.796073, -3.5642414, -2.675438, 2.4803412, -2.4353025, 1.9798169, -1.2125537]
Target sample: 49, Prediction:1, Target's Score:[-1.0758301, 5.7785616, -4.6258373, 0.10926779, -0.6149405, -2.7863014, 3.7300818, -2.5875022, 3.5499232, -1.0510709]
Target sample: 55, Prediction:1, Target's Score:[0.05149543, 8.62214, -4.2771664, 0.35138243, -3.9514792, -2.3633006, 4.675797, -2.63644, -0.84335226, 0.95150167]
Target sample: 61, Prediction:1, Target's Score:[-0.5059538, 11.989607, -3.161327, -0.4030248, -3.9873111, -2.8094049, 2.4537117, -2.0474234, 0.32939494, -1.2998629]
Target sample: 67, Prediction:1, Target's Score:[-0.43072197, 9.237847, -3.920217, -0.1967579, -3.4730463, -2.733593, 0.9434594, -2.2344046, 1.5333719, 1.7705576]
Target sample: 73, Prediction:1, Target's Score:[-0.4388117, 9.4798355, -4.351601, -0.14697903, -4.309017, -3.6061797, 1.5929322, -2.057272, 1.6804749, 2.699259]
Target sample: 79, Prediction:1, Target's Score:[-1.5643259, 12.959659, -4.2866077, -0.42978626, -4.5206585, -2.539312, 3.2617974, -3.422103, -1.1284792, 2.3195326]
Target sample: 85, Prediction:1, Target's Score:[-0.44514546, 10.824174, -4.3672667, -0.987263, -4.100562, -2.393293, 4.872148, -2.6156955, 0.53807247, -0.7681552]
Target sample: 91, Prediction:1, Target's Score:[-0.14357033, 8.45197, -4.6505265, 0.124167114, -3.5476825, -3.2394187, 4.9713774, -2.6855547, 2.020001, -0.7816881]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 05:46:40 Epoch 59, Val iteration 0, acc 91.600 (91.600)
2021-06-13 05:47:01 Epoch 59, Val iteration 19, acc 93.400 (92.700)
* Prec: 92.70000038146972
Per class accuracy =  [0.94305345 0.96135182 0.85900697 0.83705937 0.95758978 0.90448089
 0.95698525 0.94147093 0.96180772 0.95056288]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 1.3157894736842106
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 05:47:04, Val iteration 0, acc 92.600 (92.600)
2021-06-13 05:47:10, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-13 05:47:12, Epoch 0, Iteration 7, loss 0.447 (0.294), acc 84.615 (90.000)
2021-06-13 05:47:40, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.5448673, 8.979062, -3.379593, -1.0039792, -5.561087, -1.7201946, 7.9012203, -4.541048, 1.072903, 0.24558729]
Target sample: 7, Prediction:1, Target's Score:[-2.0223746, 10.820051, -3.6215808, 0.3875379, -3.808695, -1.7357262, 2.1962252, -4.50313, 0.9874695, 1.7677989]
Target sample: 13, Prediction:1, Target's Score:[-1.9056726, 11.325095, -4.6733932, 2.0841072, -3.8665822, 0.81840944, 0.9672532, -4.128185, -3.155043, 3.0053706]
Target sample: 19, Prediction:1, Target's Score:[-3.4798474, 9.335517, -4.934971, 0.1876788, -4.5349708, 0.5212875, 4.4523005, -5.126538, 1.6580752, 2.4410195]
Target sample: 25, Prediction:1, Target's Score:[-3.0024881, 6.2569995, -2.9341578, 1.3285877, -5.6350136, -1.3225062, 1.9672958, -3.5130956, 4.315337, 3.023359]
Target sample: 31, Prediction:1, Target's Score:[-0.52590746, 12.142393, -2.6906533, 2.388433, -4.612585, -0.15051666, -4.630999, 0.5867442, -2.0058362, 0.013198957]
Target sample: 37, Prediction:1, Target's Score:[-1.3412895, 11.051974, -4.5319185, 2.324353, -4.555859, -0.49231502, 2.1953807, -5.0337615, -0.056080963, 0.9046352]
Target sample: 43, Prediction:1, Target's Score:[-3.6166792, 13.484036, -3.2957788, -0.21937944, -4.6282673, 0.12793276, 2.102201, -4.0721307, 0.14450386, 0.48635766]
Target sample: 49, Prediction:1, Target's Score:[-2.118116, 10.552354, -5.1018043, 1.5546759, -1.2944067, -2.031182, 1.5531253, -2.9569292, -0.42529458, 0.75169086]
Target sample: 55, Prediction:1, Target's Score:[3.241759, 7.55684, -5.2535653, 5.933628, -2.368315, -0.34753925, -3.0060875, -3.3164601, -3.151826, 1.1215336]
Target sample: 61, Prediction:1, Target's Score:[-2.2948844, 15.305306, -3.408299, -0.4537747, -6.2540236, -0.863292, -0.0011991069, -2.7457104, -1.4956402, 2.7424264]
Target sample: 67, Prediction:1, Target's Score:[-2.6311538, 12.517945, -5.4808893, 0.5020415, -3.6133907, -1.74068, -0.12941854, -1.1321297, -1.8240179, 4.05897]
Target sample: 73, Prediction:1, Target's Score:[-2.8180106, 12.153717, -3.5894902, 1.5486912, -3.9627848, -0.33105242, -2.317802, -1.7896886, -0.7513417, 2.3829453]
Target sample: 79, Prediction:1, Target's Score:[-1.9040973, 6.3517323, -3.435395, 4.571036, -3.7569118, -0.4497984, 3.6287553, -4.9338923, -3.83374, 4.2187333]
Target sample: 85, Prediction:6, Target's Score:[-1.765717, 8.073494, -3.4529235, -0.29821092, -5.2907796, -1.6547432, 8.534848, -5.2885575, 2.0565197, -0.46265885]
Target sample: 91, Prediction:1, Target's Score:[-2.269743, 11.515655, -3.7565868, 0.4275574, -5.0102468, -1.982852, 5.52541, -5.203318, 0.360278, 0.88786376]
Current ATTACK acc on target samples: 6.250
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 05:48:08 Epoch 59, Val iteration 0, acc 90.200 (90.200)
2021-06-13 05:48:14 Epoch 59, Val iteration 19, acc 90.600 (89.740)
* Prec: 89.74000205993653
Per class accuracy =  [0.92618213 0.92424119 0.84887862 0.83289637 0.88976266 0.82723232
 0.93976643 0.89336862 0.93564738 0.95075805]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 3.9473684210526314
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 05:48:21, Val iteration 0, acc 96.200 (96.200)
2021-06-13 05:48:34, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-13 05:48:40, Epoch 0, Iteration 7, loss 0.777 (0.765), acc 75.000 (80.600)
2021-06-13 05:49:51, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.9322426, 3.443267, -1.3843219, 1.7411175, -3.6106088, -2.4740598, 8.830043, -3.998057, 2.685235, -2.3517127]
Target sample: 7, Prediction:6, Target's Score:[-4.031615, 6.5881147, -2.2928357, 0.25057238, -3.9655662, -1.6641121, 10.831779, -3.7972934, -0.1773993, -1.7967302]
Target sample: 13, Prediction:6, Target's Score:[-1.0483962, 4.083524, -1.6776321, 0.9388535, -2.2089956, -1.0488085, 7.990113, -3.5204473, -2.1671686, -1.3911351]
Target sample: 19, Prediction:6, Target's Score:[-2.3159783, 1.7868098, 0.5431039, 4.48431, -1.5766406, -2.7397752, 6.8568244, -2.9460077, -1.8541249, -2.2762513]
Target sample: 25, Prediction:6, Target's Score:[-0.17159776, -0.91494155, -0.10021225, 3.5212386, -1.3878441, -3.7266047, 6.5993457, -3.445227, 2.2422345, -2.671765]
Target sample: 31, Prediction:6, Target's Score:[-0.5422196, 0.81681424, 0.7118328, 4.945695, -2.6438394, -2.374894, 5.5732255, -3.7459154, 0.03794019, -2.8206756]
Target sample: 37, Prediction:8, Target's Score:[-1.0996801, -0.11075875, -3.2692344, 2.4888406, -0.06861375, -3.614477, 5.8176374, -3.5075932, 6.7488794, -3.4560776]
Target sample: 43, Prediction:6, Target's Score:[-3.3782277, 4.619182, -2.279341, 1.7679744, -1.8079737, -2.8663929, 7.011128, -3.9358575, 2.363173, -1.5410887]
Target sample: 49, Prediction:6, Target's Score:[-1.2684965, 1.1406538, -2.8352659, 3.4580288, -2.8648615, -2.2494106, 6.4751625, -3.0802534, 3.7023435, -2.5305004]
Target sample: 55, Prediction:6, Target's Score:[4.167203, -0.07901624, -1.9597489, 2.3136706, -2.0416868, -3.1664557, 6.223533, -2.1467512, -1.1027626, -2.27357]
Target sample: 61, Prediction:6, Target's Score:[-2.3456373, 2.6735663, -1.9783396, 2.9570007, -2.785816, -2.2300367, 10.388383, -3.815102, -0.81021786, -2.098783]
Target sample: 67, Prediction:1, Target's Score:[-1.3175073, 4.521379, -3.063834, 4.3877363, -2.618756, -3.3025713, 3.5941489, -3.8098168, 1.9796029, -0.40263516]
Target sample: 73, Prediction:3, Target's Score:[-2.5935292, 3.6004605, 0.8599356, 5.601313, -1.996686, -2.1454966, 2.8454013, -3.5329025, -1.4732023, -1.1912638]
Target sample: 79, Prediction:1, Target's Score:[-2.3655975, 6.971205, -2.512224, 3.5675154, -2.3543892, -2.4988167, 5.1100593, -3.9323199, -1.8565199, -0.15964341]
Target sample: 85, Prediction:6, Target's Score:[-2.4244945, 3.4079623, -2.016066, 1.2493379, -3.064433, -2.4073308, 10.777966, -3.9964359, 1.1517903, -2.731526]
Target sample: 91, Prediction:6, Target's Score:[-3.9450386, 4.771774, -2.3749337, 1.0633262, -3.210398, -2.0547044, 11.985199, -3.8540633, 0.383796, -2.8232563]
Current ATTACK acc on target samples: 75.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 05:51:01 Epoch 59, Val iteration 0, acc 92.600 (92.600)
2021-06-13 05:51:13 Epoch 59, Val iteration 19, acc 92.200 (92.140)
* Prec: 92.14000129699707
Per class accuracy =  [0.95013195 0.94105555 0.88513521 0.802735   0.95663413 0.89648375
 0.95569159 0.9263579  0.95475046 0.9460755 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 3, 6, 6, 6, 6, 6, 3, 6, 6, 6, 6, 6, 6, 1, 3, 8, 8, 1, 6, 6, 6, 6, 8, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 3, 6, 6, 6, 6, 3, 3, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 80.26315789473684
--------
------SUMMARY PRE DEFENSE------
TIME ELAPSED (mins): 16
TARGET INDEX: 15
ResNet50 12.5 13.157894736842104 95.46000137329102 91.19000205993652
DPN92 0.0 1.3157894736842106 95.50000267028808 92.70000038146972
MobileNetV2 6.25 3.9473684210526314 91.22000160217286 89.74000205993653
GoogLeNet 75.0 80.26315789473684 95.41000213623047 92.14000129699707
DEFENSE EVALUATION
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
ResNet50
[74, 84, 86] 3
Using Adam for retraining
2000
poison index =  80
poison index =  89
498
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 05:51:18, Val iteration 0, acc 94.200 (94.200)
2021-06-13 05:51:28, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-13 05:51:30, Epoch 0, Iteration 7, loss 0.543 (0.213), acc 92.308 (96.400)
2021-06-13 05:52:31, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.6207333, 9.519572, -2.486312, 0.3742333, -2.9087858, -1.2392709, 0.92148936, -2.8294716, 1.5300003, -1.2646905]
Target sample: 7, Prediction:1, Target's Score:[-1.0177591, 9.95636, -2.4698052, -0.38652664, -2.7656298, -1.4332216, 0.68118083, -2.550339, 0.950797, -0.9681349]
Target sample: 13, Prediction:1, Target's Score:[-1.9022068, 13.021156, -2.494301, -1.4148263, -2.999544, -1.2723578, -0.34268722, -1.80637, -1.0624899, 0.26703203]
Target sample: 19, Prediction:1, Target's Score:[-2.190541, 12.859764, -2.6310012, -0.8702622, -3.429049, -1.8072234, -1.1694918, -2.6533878, -0.88688123, 2.7783837]
Target sample: 25, Prediction:1, Target's Score:[-0.9188387, 7.177195, -2.5024598, -0.69594014, -2.8854976, -1.9336952, -0.715241, -2.1930885, 1.9118876, 2.7636623]
Target sample: 31, Prediction:1, Target's Score:[-1.7109543, 10.033467, -1.8967643, 0.47520864, -3.0341346, -1.4788327, -1.4278588, -2.2566638, -1.7970194, 3.103813]
Target sample: 37, Prediction:1, Target's Score:[-0.36691734, 6.5347376, -1.709823, -0.33563763, -0.48451355, -1.9464625, -1.2622682, -2.762312, 0.10244396, 2.249209]
Target sample: 43, Prediction:1, Target's Score:[-2.3852687, 10.652834, -2.177428, 0.41023576, -2.63294, -1.395043, 0.99019885, -3.1995885, 0.249724, -0.5156566]
Target sample: 49, Prediction:1, Target's Score:[-1.3250886, 8.839324, -1.8137281, 0.27271333, -2.520163, -1.7431945, -0.6577532, -3.0441585, 1.6148498, 0.37695757]
Target sample: 55, Prediction:1, Target's Score:[-0.17399979, 7.3559823, -2.0673862, 0.012448448, -2.257, -0.6284939, -0.9363438, -0.18752736, -2.009511, 0.91805685]
Target sample: 61, Prediction:1, Target's Score:[-2.0824966, 11.555966, -2.331343, -0.70453006, -3.0440838, -1.6739075, -0.74964863, -2.3173156, -1.200065, 2.549086]
Target sample: 67, Prediction:1, Target's Score:[-2.094592, 11.121436, -2.9489386, -0.20029655, -3.6387343, -1.6823921, -1.6012881, -3.0546527, -1.1179607, 5.2278094]
Target sample: 73, Prediction:1, Target's Score:[-1.6597488, 10.095021, -1.5248778, 0.81431407, -2.8479974, -1.5845867, -1.2686796, -2.5487204, -0.71723706, 1.2466785]
Target sample: 79, Prediction:1, Target's Score:[-1.7015859, 8.144041, -2.1269977, 0.018907785, -2.4699967, -1.2437545, 0.49923152, -2.776849, -0.78731924, 2.4557238]
Target sample: 85, Prediction:1, Target's Score:[-1.8730625, 9.877868, -2.3544805, 0.6658648, -2.8160832, -1.2341539, 0.8339147, -2.8541987, 0.9523605, -1.2009732]
Target sample: 91, Prediction:1, Target's Score:[-1.0529025, 9.305631, -2.371982, 0.4141714, -2.5782495, -1.1774496, 0.69475394, -2.73645, 0.71057034, -1.2080331]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 05:53:30 Epoch 59, Val iteration 0, acc 88.400 (88.400)
2021-06-13 05:53:41 Epoch 59, Val iteration 19, acc 91.600 (90.990)
* Prec: 90.99000053405761
Per class accuracy =  [0.94491594 0.95531645 0.84411154 0.82744496 0.92425563 0.86674911
 0.9591883  0.89444928 0.95623368 0.92884546]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
DPN92
[74, 80, 84, 89] 26
Using Adam for retraining
2000
poison index =  86
499
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 05:53:45, Val iteration 0, acc 94.800 (94.800)
2021-06-13 05:54:06, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-13 05:54:11, Epoch 0, Iteration 7, loss 0.890 (0.469), acc 80.769 (89.000)
2021-06-13 05:56:48, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6]
Target sample: 1, Prediction:1, Target's Score:[-1.0666343, 9.105541, -1.2102811, -0.99946684, -4.429465, -4.1333632, 4.0798154, -2.4322371, 1.6499283, -0.04161171]
Target sample: 7, Prediction:1, Target's Score:[-0.60848325, 12.018666, -1.5435772, -0.8811591, -4.380735, -4.150149, 1.5632975, -2.5317175, 0.043963324, 1.0482097]
Target sample: 13, Prediction:1, Target's Score:[-0.5899887, 14.836446, -1.4596161, -1.1796074, -4.9042206, -4.5098863, 0.92910665, -3.5436108, -1.0586761, 2.1565118]
Target sample: 19, Prediction:1, Target's Score:[-1.1567125, 12.142052, -0.79075474, 0.013140067, -5.179623, -4.637181, 1.814931, -3.2501178, 0.61252373, 1.0576265]
Target sample: 25, Prediction:1, Target's Score:[0.022548692, 5.2161555, -1.5985322, 0.80788827, -4.8952203, -5.386763, 4.499961, -2.581453, 3.3406487, 1.0975935]
Target sample: 31, Prediction:1, Target's Score:[0.6361582, 8.488558, -0.4458692, 0.7488799, -4.82378, -4.679036, 2.6876028, -1.7873962, 1.4017254, -1.6675063]
Target sample: 37, Prediction:1, Target's Score:[-0.17747103, 12.247012, -1.4880157, -1.0595902, -4.0039167, -3.686927, 0.4364585, -2.1183753, -0.6464174, 1.0484602]
Target sample: 43, Prediction:1, Target's Score:[-0.27161258, 11.4835005, -1.2784964, -0.6455874, -4.4226766, -4.26403, 1.7185894, -2.0451322, 0.99361396, -0.69243205]
Target sample: 49, Prediction:1, Target's Score:[-0.4744014, 7.598398, -1.7454947, 0.025179865, -3.2547433, -3.9207995, 2.6280475, -2.152431, 2.1675036, -0.39749038]
Target sample: 55, Prediction:1, Target's Score:[0.26283497, 8.864611, -1.3104898, 1.120483, -4.5302787, -3.6601045, 1.2063524, -2.5391529, -0.9708662, 2.1086164]
Target sample: 61, Prediction:1, Target's Score:[-0.80621934, 14.0021305, -0.6196627, 0.18868187, -5.0928226, -4.483909, 0.46894926, -3.1804283, -0.4665481, 0.65686214]
Target sample: 67, Prediction:1, Target's Score:[-0.7640807, 13.227939, -1.7540836, -0.3614398, -4.6825156, -4.1478, -0.16362768, -3.7950401, 0.009480372, 3.0391338]
Target sample: 73, Prediction:1, Target's Score:[-0.98769593, 10.8362, -1.1017745, -0.11209464, -4.8086476, -4.5881424, 1.1314018, -2.8637967, 1.0931416, 1.9551017]
Target sample: 79, Prediction:1, Target's Score:[-0.99757475, 14.872986, -1.4486595, -0.8316295, -4.643137, -3.8303592, -0.09307359, -3.6910079, -1.799646, 3.106418]
Target sample: 85, Prediction:1, Target's Score:[-1.1015695, 11.458945, -1.2275574, -1.0874596, -4.60588, -4.1690035, 3.0715396, -2.603196, 0.6118913, 0.22750907]
Target sample: 91, Prediction:1, Target's Score:[-0.60738796, 10.314319, -1.203177, -0.16940914, -4.494306, -4.670795, 2.9201336, -2.572685, 1.5566344, -0.49818617]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 05:59:22 Epoch 59, Val iteration 0, acc 93.400 (93.400)
2021-06-13 05:59:43 Epoch 59, Val iteration 19, acc 92.600 (92.930)
* Prec: 92.93000144958496
Per class accuracy =  [0.94366924 0.95539079 0.86520081 0.87877527 0.95183657 0.8509475
 0.96792012 0.94644409 0.97750506 0.95567502]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 1.3157894736842106
MobileNetV2
[74, 80, 89] 46
Using Adam for retraining
2000
poison index =  84
poison index =  86
498
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 05:59:46, Val iteration 0, acc 92.600 (92.600)
2021-06-13 05:59:52, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-13 05:59:53, Epoch 0, Iteration 7, loss 0.137 (0.295), acc 94.231 (90.600)
2021-06-13 06:00:21, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.3749099, 11.7291155, -3.8022177, -1.2488742, -6.4139752, -2.3442762, 5.407956, -4.6322746, 1.6899933, 1.4988935]
Target sample: 7, Prediction:1, Target's Score:[-1.7069868, 12.860173, -3.970764, 0.15745619, -4.7328367, -2.2086446, 0.38369834, -4.626782, 1.666794, 2.7313035]
Target sample: 13, Prediction:1, Target's Score:[-1.4321047, 13.282155, -4.883837, 1.5084379, -4.8813486, 0.63970524, -0.5084884, -4.436768, -2.4229393, 3.7300632]
Target sample: 19, Prediction:1, Target's Score:[-3.2871442, 12.028797, -5.305444, -0.16555256, -5.665352, 0.21297951, 2.1111913, -5.0226564, 2.150187, 3.5492396]
Target sample: 25, Prediction:1, Target's Score:[-2.6442113, 7.913111, -2.9597104, 1.714525, -6.342978, -1.8482901, -0.092576005, -3.2929916, 4.6761146, 3.395339]
Target sample: 31, Prediction:1, Target's Score:[-0.91605985, 12.696425, -2.224539, 2.656877, -5.225954, -0.44084865, -5.33397, 1.4175061, -1.8804003, -0.14150254]
Target sample: 37, Prediction:1, Target's Score:[-1.1806804, 13.044992, -4.7966585, 2.246226, -5.3043237, -1.1113341, 0.7338927, -5.1228757, 0.43096188, 1.6205612]
Target sample: 43, Prediction:1, Target's Score:[-3.046444, 16.613544, -3.6746862, -0.48196548, -6.128133, -0.2615319, -0.39949405, -4.353968, 1.0056418, 1.3395225]
Target sample: 49, Prediction:1, Target's Score:[-1.976348, 12.09084, -5.2480254, 1.7882342, -2.0841587, -2.286695, 0.25434166, -3.3047824, 0.2042932, 1.1363229]
Target sample: 55, Prediction:1, Target's Score:[2.9991107, 7.988917, -5.4255037, 5.9622736, -2.7452204, -0.37709054, -3.317243, -3.200183, -2.6615484, 1.2977778]
Target sample: 61, Prediction:1, Target's Score:[-1.8689936, 16.182213, -2.977792, -0.4665208, -6.7466054, -1.2496593, -1.3491434, -2.710772, -1.2198781, 3.0335622]
Target sample: 67, Prediction:1, Target's Score:[-2.0030715, 13.478797, -5.3949127, 0.29068428, -3.9938703, -1.7058352, -2.2315266, -0.7410852, -1.5330454, 4.467771]
Target sample: 73, Prediction:1, Target's Score:[-2.5232928, 13.687304, -4.085953, 1.3305826, -4.6143093, -0.7157708, -3.9330168, -1.4524885, -0.38826808, 3.3360538]
Target sample: 79, Prediction:1, Target's Score:[-1.8736733, 7.973206, -3.6795409, 4.317564, -4.1667233, -0.899384, 2.2933173, -4.810568, -3.2004092, 4.5981064]
Target sample: 85, Prediction:1, Target's Score:[-1.7075241, 11.091781, -4.147, -0.4874323, -6.3598366, -2.3068516, 5.9636545, -5.5010157, 2.9412766, 1.0188736]
Target sample: 91, Prediction:1, Target's Score:[-1.8630668, 13.873597, -4.3284283, 0.2415387, -5.762928, -2.5633461, 3.2663882, -5.202224, 1.2061883, 1.6998192]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 06:00:48 Epoch 59, Val iteration 0, acc 89.200 (89.200)
2021-06-13 06:00:55 Epoch 59, Val iteration 19, acc 90.000 (89.470)
* Prec: 89.47000122070312
Per class accuracy =  [0.91909888 0.92913505 0.84436834 0.82896041 0.8931111  0.81885961
 0.93439658 0.88926366 0.93477785 0.94966646]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
GoogLeNet
[74, 80, 84, 86, 89] 22
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 06:00:58, Val iteration 0, acc 96.200 (96.200)
2021-06-13 06:01:10, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-13 06:01:13, Epoch 0, Iteration 7, loss 1.096 (1.067), acc 65.385 (74.600)
2021-06-13 06:02:24, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-2.4430685, 9.449114, -0.4207345, 2.373769, -4.241005, -2.1305296, 0.4296579, -3.7049823, 0.8645499, -0.21422447]
Target sample: 7, Prediction:1, Target's Score:[-4.6078777, 11.657725, -1.779172, 0.46431273, -5.212197, 0.18725133, 1.5470824, -4.1211104, 1.7105004, 0.10230956]
Target sample: 13, Prediction:1, Target's Score:[-2.142856, 10.092371, -1.1731333, 0.7259632, -3.3513875, 1.0580555, -0.9597152, -3.0956805, -2.0917566, 0.8943342]
Target sample: 19, Prediction:1, Target's Score:[-2.0378325, 9.299685, 0.64841455, 2.103829, -4.0002246, -0.87020105, -0.65335834, -2.5720026, -2.3786633, 0.41933128]
Target sample: 25, Prediction:1, Target's Score:[0.53375936, 5.32818, -0.9786089, 2.6008132, -2.9626772, -3.6246076, -1.2979043, -2.9840631, 1.8835707, 1.4629058]
Target sample: 31, Prediction:1, Target's Score:[-0.7167363, 8.515961, -0.4726658, 2.3412838, -3.9485462, -0.96706843, -1.0992548, -3.3926013, -0.07316325, -0.22743823]
Target sample: 37, Prediction:8, Target's Score:[-3.813452, 4.698117, -2.3093421, 3.1582189, -0.84721583, -3.4791863, -1.8323513, -3.3521128, 10.082263, -2.372032]
Target sample: 43, Prediction:1, Target's Score:[-5.0642066, 8.494932, -1.5506444, 2.6719122, -3.1557937, -2.0125225, -1.0157139, -4.0870233, 6.9974227, -1.3319242]
Target sample: 49, Prediction:1, Target's Score:[-3.1319637, 7.187304, -1.1007348, 3.826089, -4.1353354, -2.2138793, -0.9466306, -3.3283496, 5.221609, -1.4228464]
Target sample: 55, Prediction:1, Target's Score:[0.8392794, 5.2219334, -2.2714427, 2.4486074, -2.9002, 0.29028338, -1.1467624, -1.9534339, -0.83475083, 0.26041552]
Target sample: 61, Prediction:1, Target's Score:[-0.72396666, 9.620026, -1.4350218, 2.882318, -4.288603, -0.9829935, 0.3951463, -4.0766563, -2.2427986, 0.81577474]
Target sample: 67, Prediction:1, Target's Score:[-1.4582825, 11.409748, -3.1062021, 3.5476766, -4.401413, -2.7842019, -2.9214776, -3.046998, -0.79558337, 3.544211]
Target sample: 73, Prediction:1, Target's Score:[-2.8362777, 10.490283, -0.51600385, 3.5778358, -4.0572085, -1.4726849, -2.4835496, -3.0872772, -1.244222, 1.6022987]
Target sample: 79, Prediction:1, Target's Score:[-3.443754, 11.813001, -1.7550633, 2.7977648, -3.6819437, -1.7982005, -0.77710766, -3.7691264, -0.2053121, 0.79031074]
Target sample: 85, Prediction:1, Target's Score:[-2.1757085, 9.856474, -0.661678, 2.075838, -3.8054888, -1.7226063, 1.0824242, -4.12457, 0.058773898, -0.62598383]
Target sample: 91, Prediction:1, Target's Score:[-4.290079, 11.171673, -1.4585909, 2.0672545, -4.8783207, -1.4474386, 2.1065981, -3.7307286, 1.0207902, -0.6079968]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 06:03:33 Epoch 59, Val iteration 0, acc 92.600 (92.600)
2021-06-13 06:03:45 Epoch 59, Val iteration 19, acc 91.800 (91.770)
* Prec: 91.77000198364257
Per class accuracy =  [0.94087481 0.96043553 0.8644633  0.79764369 0.95759916 0.8832633
 0.9416106  0.9345118  0.94320498 0.95389158]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 8, 8, 1, 1, 1, 1, 1, 1, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
------SUMMARY POST DEFENSE------
TIME ELAPSED (mins): 16
TARGET INDEX: 15
ResNet50 0.0 0.0 95.46000137329102 90.99000053405761 60.0
DPN92 0.0 1.3157894736842106 95.50000267028808 92.93000144958496 80.0
MobileNetV2 0.0 0.0 91.22000160217286 89.47000122070312 60.0
GoogLeNet 0.0 0.0 95.41000213623047 91.77000198364257 100.0
True False False False False
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.300-droplayer0.000.t7
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
No specific indices are determined, so try to include whatever we find
In total, we found 136 images of target 16
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', eval_poisons_root='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=False, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=16, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/16/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133]
# Targets: 23, # Poisons: 5
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-13 06:04:05 Iteration 0 	 Training Loss: 9.321e-01 	 Loss in Target Net: 2.047e+00	  
 2021-06-13 06:04:51 Iteration 50 	 Training Loss: 2.289e-01 	 Loss in Target Net: 5.440e-01	  
 2021-06-13 06:05:37 Iteration 100 	 Training Loss: 2.004e-01 	 Loss in Target Net: 5.213e-01	  
 2021-06-13 06:06:24 Iteration 150 	 Training Loss: 1.916e-01 	 Loss in Target Net: 5.715e-01	  
 2021-06-13 06:07:11 Iteration 200 	 Training Loss: 1.895e-01 	 Loss in Target Net: 5.824e-01	  
 2021-06-13 06:07:59 Iteration 250 	 Training Loss: 1.981e-01 	 Loss in Target Net: 6.154e-01	  
 2021-06-13 06:08:46 Iteration 300 	 Training Loss: 1.826e-01 	 Loss in Target Net: 5.649e-01	  
 2021-06-13 06:09:33 Iteration 350 	 Training Loss: 1.828e-01 	 Loss in Target Net: 6.070e-01	  
 2021-06-13 06:10:20 Iteration 400 	 Training Loss: 1.854e-01 	 Loss in Target Net: 6.187e-01	  
 2021-06-13 06:11:06 Iteration 450 	 Training Loss: 1.851e-01 	 Loss in Target Net: 5.471e-01	  
 2021-06-13 06:11:55 Iteration 500 	 Training Loss: 1.798e-01 	 Loss in Target Net: 6.010e-01	  
 2021-06-13 06:12:44 Iteration 550 	 Training Loss: 1.737e-01 	 Loss in Target Net: 5.805e-01	  
 2021-06-13 06:13:31 Iteration 600 	 Training Loss: 1.737e-01 	 Loss in Target Net: 6.847e-01	  
 2021-06-13 06:14:17 Iteration 650 	 Training Loss: 1.769e-01 	 Loss in Target Net: 6.127e-01	  
 2021-06-13 06:15:03 Iteration 700 	 Training Loss: 1.782e-01 	 Loss in Target Net: 5.849e-01	  
 2021-06-13 06:15:51 Iteration 750 	 Training Loss: 1.754e-01 	 Loss in Target Net: 5.932e-01	  
 2021-06-13 06:16:38 Iteration 800 	 Training Loss: 1.809e-01 	 Loss in Target Net: 5.762e-01	  
 2021-06-13 06:17:27 Iteration 850 	 Training Loss: 1.732e-01 	 Loss in Target Net: 6.099e-01	  
 2021-06-13 06:18:16 Iteration 900 	 Training Loss: 1.751e-01 	 Loss in Target Net: 6.371e-01	  
 2021-06-13 06:19:03 Iteration 950 	 Training Loss: 1.725e-01 	 Loss in Target Net: 5.656e-01	  
 2021-06-13 06:19:49 Iteration 999 	 Training Loss: 1.697e-01 	 Loss in Target Net: 6.011e-01	  
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 06:19:55, Val iteration 0, acc 94.200 (94.200)
2021-06-13 06:20:05, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-13 06:20:10, Epoch 0, Iteration 7, loss 0.835 (0.635), acc 76.923 (85.800)
2021-06-13 06:21:10, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-4.079679, 2.9343085, 0.19102895, -1.3716645, -0.57109815, -3.2176063, 9.786142, -2.937476, -1.3073655, 0.6961565]
Target sample: 7, Prediction:6, Target's Score:[-4.5409346, 0.7871261, 1.3670697, -0.45655048, -0.3048654, -3.5855086, 11.380937, -3.108295, -0.9966879, -0.40628418]
Target sample: 13, Prediction:6, Target's Score:[-4.156033, 2.624012, 0.33319214, -1.0815756, -0.6509759, -3.0366714, 9.87028, -2.5463138, -0.0017031142, -1.2213401]
Target sample: 19, Prediction:6, Target's Score:[-4.1434712, 1.5450279, 0.1003171, -1.6806641, -0.37330297, -3.5101445, 10.994767, -3.0474377, 0.061953634, 0.19770196]
Target sample: 25, Prediction:6, Target's Score:[-4.429635, 5.1426287, -0.22013159, -1.6652501, -1.105106, -3.3340802, 9.236403, -2.6394114, -0.6980847, -0.16489695]
Target sample: 31, Prediction:6, Target's Score:[-4.3397727, 1.661672, -0.099947885, -1.0232329, -0.6933776, -3.2620237, 9.474051, -3.0061464, 1.8000734, -0.388265]
Target sample: 37, Prediction:6, Target's Score:[-4.4223456, 0.21754518, -1.0926698, -1.255436, -0.6145531, -3.2476044, 9.329199, -3.0933616, 3.311558, 0.9943119]
Target sample: 43, Prediction:6, Target's Score:[-4.2808757, -0.57996404, -0.7862341, -1.5598046, -0.68042326, -3.4345927, 9.35434, -3.2015393, 5.569923, -0.27335304]
Target sample: 49, Prediction:6, Target's Score:[-4.5606003, 0.480287, -0.5151235, -1.294299, -0.6747592, -3.0271308, 9.1820135, -3.145782, 2.4138587, 1.2600242]
Target sample: 55, Prediction:6, Target's Score:[-4.166032, -0.6449086, 0.25932342, -0.7221004, 0.17148887, -3.2802756, 11.106458, -2.7212627, 1.1547935, -1.0103534]
Target sample: 61, Prediction:6, Target's Score:[-4.80448, 3.2117276, -0.6006377, -1.7120919, -1.1129423, -3.3736663, 9.0071945, -3.39803, -0.82181466, 3.7110493]
Target sample: 67, Prediction:6, Target's Score:[-4.7474093, -0.6581914, -0.067436434, -0.32186, 1.9954343, -3.1375313, 9.286896, -2.7752378, -0.08429909, 0.6043463]
Target sample: 73, Prediction:6, Target's Score:[-3.9689922, 2.2542598, 0.6213935, -0.8596168, 0.0038854834, -2.7706845, 9.745835, -2.485301, -0.32484472, -2.089222]
Target sample: 79, Prediction:6, Target's Score:[-3.8856528, 0.8217336, -0.18812218, -1.5871575, -0.52833164, -3.503117, 9.003982, -3.3198662, -0.26062423, 3.5510232]
Target sample: 85, Prediction:6, Target's Score:[-3.9554355, 7.476002, -0.7281677, -2.009405, -1.5673026, -3.4747653, 8.782173, -2.7750583, -0.28157675, -1.3377504]
Target sample: 91, Prediction:6, Target's Score:[-4.8131323, 2.7910872, -0.65405047, -1.5339357, -1.1762769, -3.340782, 9.541767, -2.4909647, 1.8409191, -0.033746727]
Target sample: 97, Prediction:6, Target's Score:[-2.9536064, -0.19169536, -1.2813591, -2.0121763, -1.2751716, -3.4791296, 7.7057934, -2.97445, 5.3444476, 1.2269446]
Target sample: 103, Prediction:6, Target's Score:[-5.2600174, -0.7183864, -2.0140536, -2.1266894, -1.0892884, -3.909726, 7.647808, -3.99357, 5.4344716, 6.107639]
Target sample: 109, Prediction:6, Target's Score:[-4.6847363, -0.8383592, -0.36409917, -1.4535964, 0.09805035, -3.3023171, 10.856115, -3.6198847, 3.209154, 0.23970823]
Target sample: 115, Prediction:6, Target's Score:[-4.113853, 3.8679738, -0.1526419, -2.0365338, -1.0007172, -3.4302561, 9.726017, -2.7646034, -0.3295816, 0.36391383]
Target sample: 121, Prediction:6, Target's Score:[-4.1339684, 2.2093866, 0.050907444, -1.1690001, -0.6618829, -3.0228019, 10.060653, -2.6349218, -0.89689815, 0.33077675]
Target sample: 127, Prediction:6, Target's Score:[-4.737289, 2.44568, 0.08910477, -1.8446018, -0.56113476, -3.4495714, 10.453615, -3.0391865, -1.050675, 1.820942]
Target sample: 133, Prediction:6, Target's Score:[-4.18338, -0.123098314, 1.2918767, -0.24514838, 0.044552274, -3.390711, 12.0296, -2.9934614, -1.1327529, -1.146016]
Current ATTACK acc on target samples: 100.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 06:22:09 Epoch 59, Val iteration 0, acc 89.600 (89.600)
2021-06-13 06:22:19 Epoch 59, Val iteration 19, acc 91.800 (90.590)
* Prec: 90.59000205993652
Per class accuracy =  [0.93248372 0.93521041 0.84047804 0.84346184 0.90336546 0.86259421
 0.93941062 0.90184415 0.957259   0.94474323]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 100.0
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 06:22:32, Val iteration 0, acc 94.800 (94.800)
2021-06-13 06:22:53, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-13 06:23:07, Epoch 0, Iteration 7, loss 0.338 (0.397), acc 90.385 (90.600)
2021-06-13 06:25:45, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[1.1228064, 6.5449014, -3.2916057, -2.459733, -2.7504349, -1.4443066, 5.624099, -2.0531802, -1.0202553, 0.04791274]
Target sample: 7, Prediction:6, Target's Score:[0.8208567, 2.4422762, -2.119795, -1.7894078, -1.6406628, -1.8157477, 8.4410305, -2.3763678, 0.07972171, -1.7861989]
Target sample: 13, Prediction:6, Target's Score:[1.7477396, 1.8554045, -2.752502, -2.3508358, -2.1441164, -2.1455882, 8.331994, -2.2199247, 0.2832613, -0.3375492]
Target sample: 19, Prediction:6, Target's Score:[4.6123204, 0.8734137, -3.6590416, -2.182764, -2.3718565, -1.9200761, 6.2529488, -1.4873611, -0.632005, 0.8584214]
Target sample: 25, Prediction:1, Target's Score:[2.6739826, 6.9483457, -3.5850236, -2.5177207, -2.537444, -2.0109882, 4.1735907, -1.8296461, -2.3238795, 1.3801597]
Target sample: 31, Prediction:1, Target's Score:[0.953478, 6.630611, -2.7782485, -2.1850936, -1.8599123, -1.7667072, 1.8529438, -2.116717, 1.3914928, 0.18937612]
Target sample: 37, Prediction:1, Target's Score:[-1.1854764, 5.2187715, -3.90197, -1.89129, -1.773354, -2.6261, 1.3397534, -2.5753524, 5.0274296, 2.6747437]
Target sample: 43, Prediction:8, Target's Score:[-0.5334489, 0.5960645, -2.8704438, -2.1024528, -1.3934568, -2.318369, 3.2613072, -1.5300478, 7.725257, -0.57882506]
Target sample: 49, Prediction:6, Target's Score:[0.09265734, 3.5663748, -4.2558813, -1.7809814, -2.7409737, -1.9227349, 4.5273957, -2.9028008, 2.5597847, 3.1823578]
Target sample: 55, Prediction:8, Target's Score:[-0.16364086, 0.68909395, -2.0365818, -0.5057586, 0.22541124, -2.6356537, 1.6925516, -2.0230672, 4.8603964, 0.13955821]
Target sample: 61, Prediction:9, Target's Score:[-0.9581912, 6.149006, -3.424288, -1.2973334, -0.2312701, -2.5911996, -1.0324193, -2.8568263, 0.25880033, 6.3213215]
Target sample: 67, Prediction:6, Target's Score:[-0.5662889, 0.10633241, -2.6043394, -1.1785643, -0.3013233, -2.4410427, 5.19135, -2.018934, 3.3891995, 0.6424393]
Target sample: 73, Prediction:0, Target's Score:[5.017431, 2.8656285, -1.2984686, -1.7190647, -0.68753886, -2.7923439, 1.0693773, -1.875422, 0.65581316, -0.90333]
Target sample: 79, Prediction:9, Target's Score:[0.74507636, 2.8318973, -3.828613, -1.808689, 0.0062351176, -3.055783, 1.59439, -2.9277854, -0.7195667, 7.509856]
Target sample: 85, Prediction:1, Target's Score:[0.6743091, 9.621592, -3.2410142, -2.5851083, -1.6893841, -2.5055273, 0.71176404, -2.2231412, 0.28107536, 1.3066497]
Target sample: 91, Prediction:1, Target's Score:[-0.499559, 6.587471, -3.6431437, -1.8289347, -1.7314528, -2.5483477, 1.627804, -2.2605264, 3.1180575, 1.4912802]
Target sample: 97, Prediction:8, Target's Score:[0.63300127, 1.4286777, -3.478434, -2.4224708, -1.9817154, -2.8325047, 1.9060524, -2.1090775, 7.9958773, 1.1540452]
Target sample: 103, Prediction:8, Target's Score:[-1.438943, 2.5669131, -4.2540865, -2.4070845, -1.9654884, -2.6390128, 1.1917202, -2.332817, 8.744387, 2.8645205]
Target sample: 109, Prediction:1, Target's Score:[-0.8098897, 5.1885557, -3.357797, -2.3251638, -2.1153524, -1.8853636, 1.6122217, -2.416826, 4.3820896, 2.0334988]
Target sample: 115, Prediction:1, Target's Score:[0.19434044, 12.002522, -3.129855, -2.912269, -2.1501443, -1.8774875, -0.94622403, -2.2531104, -0.31766564, 1.7864465]
Target sample: 121, Prediction:1, Target's Score:[2.4055889, 6.172577, -3.3630517, -1.9520301, -1.9168855, -1.791781, 1.6256361, -1.9830701, -0.9796493, 2.1159801]
Target sample: 127, Prediction:6, Target's Score:[0.23715831, 0.20168571, -2.7471929, -2.432284, -1.466386, -1.7490084, 9.869973, -2.722546, 0.9364713, 0.108042225]
Target sample: 133, Prediction:6, Target's Score:[0.97768307, 0.72691804, -1.9591476, -1.632671, -1.3488277, -1.1933196, 11.3064165, -2.2511578, -2.0509894, -2.3264194]
Current ATTACK acc on target samples: 30.435
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 06:28:19 Epoch 59, Val iteration 0, acc 91.600 (91.600)
2021-06-13 06:28:40 Epoch 59, Val iteration 19, acc 93.000 (92.720)
* Prec: 92.72000083923339
Per class accuracy =  [0.95118041 0.95631005 0.90723261 0.8709179  0.94170846 0.83800496
 0.95017832 0.94489574 0.96429792 0.94826967]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 8, 8, 8, 8, 8, 1, 6, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 9, 8, 8, 4, 6, 6, 6, 6, 6, 0, 0, 9, 4, 4, 6, 6, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 30.97345132743363
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 06:28:44, Val iteration 0, acc 92.600 (92.600)
2021-06-13 06:28:50, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-13 06:28:52, Epoch 0, Iteration 7, loss 0.297 (0.321), acc 92.308 (90.000)
2021-06-13 06:29:20, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[2.0718968, 6.1268682, -4.1805263, 1.076303, -3.1038265, -2.2111888, 0.38595518, -3.685065, 1.0304352, 2.9602404]
Target sample: 7, Prediction:1, Target's Score:[2.7177196, 5.9730053, -3.1096964, 4.1360464, -5.9848228, -3.1578498, 5.3447585, -5.393936, 1.2718, -1.3381081]
Target sample: 13, Prediction:1, Target's Score:[0.94816035, 5.7362595, -3.6471775, 2.1329017, -5.1066957, -3.195116, 5.066562, -5.8207393, 2.5407262, 1.8260393]
Target sample: 19, Prediction:9, Target's Score:[4.21073, 1.5049367, -3.8999965, 2.7980716, -1.6569349, -3.3760753, 1.6215144, -3.788497, -1.9685866, 5.0256634]
Target sample: 25, Prediction:1, Target's Score:[3.8322914, 7.6397686, -5.2576, 2.5984218, -3.1264768, -2.6562047, 0.18163839, -3.938425, 0.3889199, 0.83153516]
Target sample: 31, Prediction:3, Target's Score:[1.1749791, 2.0009139, -3.283445, 5.2183146, -3.434749, -3.7209492, 2.9812267, -4.858814, 4.8494225, -0.4803149]
Target sample: 37, Prediction:8, Target's Score:[-0.35683328, 1.2671697, -5.137018, 4.899648, -2.848399, -3.5309448, 1.0576952, -4.5005074, 6.3629794, 3.2681417]
Target sample: 43, Prediction:8, Target's Score:[-0.59297836, 1.456404, -2.6613402, 4.235662, -2.0827675, -3.0790033, 1.8522514, -3.7015386, 5.7737594, -0.7794787]
Target sample: 49, Prediction:1, Target's Score:[1.9914123, 4.6864977, -2.8367221, 4.298972, -0.85727936, -3.3322268, -0.28963798, -5.2289, 3.4889007, -1.4386266]
Target sample: 55, Prediction:3, Target's Score:[0.95908016, -1.8125354, -0.4296776, 7.7309427, -1.822352, -1.6947279, 2.1470284, -5.0738716, 2.4178903, -2.014385]
Target sample: 61, Prediction:9, Target's Score:[1.0573382, 4.081994, -3.7217302, 1.8201259, -3.6599734, -3.1043687, 2.9553397, -4.584322, -2.176119, 7.8001375]
Target sample: 67, Prediction:8, Target's Score:[0.86596876, -1.4378824, -2.0220358, 1.2116846, -0.12756303, -4.198085, 2.21125, -1.9372413, 5.210246, 0.60666007]
Target sample: 73, Prediction:8, Target's Score:[2.8413322, 0.9713542, 0.5798444, 2.9825165, -0.18520144, -4.875182, -1.046443, -3.9502668, 6.007675, -2.927357]
Target sample: 79, Prediction:9, Target's Score:[1.0818932, 5.4453154, -5.578529, 2.4766839, -1.9595871, -1.6939493, 1.0496538, -5.0023513, -1.5463805, 6.2493234]
Target sample: 85, Prediction:1, Target's Score:[4.305556, 6.001905, -4.6517973, 1.5408814, -1.2735486, -2.7234302, -0.46440026, -3.077039, 2.4337883, -1.647875]
Target sample: 91, Prediction:1, Target's Score:[0.4697158, 10.979766, -6.497833, 2.826284, -4.5807467, -3.0927095, 0.36905444, -3.6148326, 1.7600905, 1.9447505]
Target sample: 97, Prediction:8, Target's Score:[0.6135129, -1.2033747, -1.7129141, 4.68861, -2.5616698, -4.104401, -0.36231244, -2.959804, 5.2960496, 2.7451828]
Target sample: 103, Prediction:8, Target's Score:[-1.6893324, 3.213177, -5.611719, 2.927211, -2.8771107, -2.1042256, 2.2949035, -5.2152576, 5.1486, 4.396251]
Target sample: 109, Prediction:3, Target's Score:[0.44328907, 3.000297, -3.764961, 4.7547646, -3.6939826, -2.536644, 4.0475917, -4.975931, 2.2664807, 0.91526204]
Target sample: 115, Prediction:1, Target's Score:[4.042721, 8.074151, -3.5447714, 2.3357675, -4.6503825, -3.1651878, -0.82185954, -2.16245, 0.6626077, -0.26529682]
Target sample: 121, Prediction:3, Target's Score:[2.9482512, 2.9172149, -5.0785737, 3.6041496, -4.0151553, -2.2055926, 0.45489973, -2.2271776, 1.5514116, 2.486544]
Target sample: 127, Prediction:1, Target's Score:[0.40055236, 5.0962315, -4.3459, 3.4796789, -6.125116, -2.6572108, 4.233007, -4.5530243, 1.1754311, 3.7727487]
Target sample: 133, Prediction:6, Target's Score:[1.4099599, 4.3237987, -3.4641597, 4.8763347, -5.8288593, -2.8338337, 5.491463, -5.142352, 0.92989695, 0.6980374]
Current ATTACK acc on target samples: 4.348
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 06:29:47 Epoch 59, Val iteration 0, acc 88.800 (88.800)
2021-06-13 06:29:53 Epoch 59, Val iteration 19, acc 90.200 (89.530)
* Prec: 89.53000221252441
Per class accuracy =  [0.92725163 0.93094451 0.83475367 0.82758261 0.89017761 0.81896869
 0.9420188  0.89353528 0.93376827 0.9490701 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 3, 1, 1, 1, 1, 1, 6, 6, 1, 1, 1, 6, 1, 1, 9, 1, 1, 6, 3, 0, 1, 1, 8, 8, 3, 3, 3, 1, 3, 8, 8, 1, 8, 8, 8, 3, 3, 1, 3, 8, 1, 1, 1, 3, 3, 3, 4, 3, 1, 8, 0, 9, 3, 8, 8, 8, 8, 8, 8, 3, 8, 8, 8, 8, 4, 3, 3, 3, 3, 1, 1, 3, 1, 1, 1, 1, 1, 8, 1, 8, 8, 9, 9, 3, 9, 8, 9, 8, 3, 3, 3, 8, 1, 3, 1, 1, 1, 3, 3, 0, 8, 6, 1, 3, 9, 1, 1, 1, 6, 6, 6, 6, 6
ATTACK acc: 8.849557522123893
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 06:30:00, Val iteration 0, acc 96.200 (96.200)
2021-06-13 06:30:13, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-13 06:30:20, Epoch 0, Iteration 7, loss 1.033 (1.079), acc 69.231 (78.200)
2021-06-13 06:31:30, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-0.7697208, 1.2222886, -2.7477283, -0.74530643, -0.2951407, -5.095231, 7.2744727, -1.1149281, -0.645907, 2.8031805]
Target sample: 7, Prediction:6, Target's Score:[-0.17247216, -1.7599773, -1.4324952, -0.5866036, -0.82956326, -5.320578, 8.970437, -0.23238601, 0.28504628, 0.96425176]
Target sample: 13, Prediction:6, Target's Score:[-2.5526628, 1.2642281, -2.755433, -0.680849, -1.2939951, -4.7512364, 9.124414, -1.5494834, 4.468646, -1.4070045]
Target sample: 19, Prediction:6, Target's Score:[0.6001452, 1.4023778, -3.061243, -0.5433044, -1.6670904, -4.6683517, 7.4227223, -1.1583596, 0.37494925, 1.1902729]
Target sample: 25, Prediction:6, Target's Score:[1.8669188, 3.6903229, -3.425939, -1.0253654, 0.84213585, -4.830765, 4.9360642, -1.8955001, -0.105735436, -0.16108549]
Target sample: 31, Prediction:6, Target's Score:[-1.7813826, 3.1912808, -4.0804787, -0.15786023, -1.8423274, -4.338406, 6.122921, -2.8020492, 3.0591536, 2.5061135]
Target sample: 37, Prediction:6, Target's Score:[-0.6529869, 2.6618552, -4.025369, -0.16208188, -0.3665005, -5.129752, 5.3167562, -3.3149443, 2.2549977, 3.288948]
Target sample: 43, Prediction:6, Target's Score:[-1.2343217, 1.821634, -2.7414424, -0.3013453, -0.4420627, -5.3469315, 5.562574, -1.3351966, 3.5716624, 0.32370353]
Target sample: 49, Prediction:6, Target's Score:[-2.2778883, 2.4514656, -3.9692206, 1.5428092, -1.9864284, -2.7531903, 6.543938, -2.4866493, 1.8406254, 0.97625506]
Target sample: 55, Prediction:6, Target's Score:[2.6946049, -1.8739388, -1.3575759, -0.2645604, 2.3147814, -6.1667433, 6.0083656, 0.6691468, -0.6406687, -1.50181]
Target sample: 61, Prediction:9, Target's Score:[-2.5850172, 3.313819, -2.7618718, -1.7208694, -0.31148776, -5.3238883, 5.3835835, -2.9439309, -0.9365492, 7.7540154]
Target sample: 67, Prediction:4, Target's Score:[-2.086991, -0.4363082, -3.2086594, 3.555018, 4.4449506, -5.2928944, 3.955226, -2.0300975, 2.0486047, -1.1013876]
Target sample: 73, Prediction:8, Target's Score:[0.017358046, 2.8208618, -3.0022626, -1.3691906, 0.77222425, -6.0511436, 3.8200283, -2.0907545, 6.5925846, -1.6702986]
Target sample: 79, Prediction:9, Target's Score:[0.029356461, 5.0288415, -4.1363716, -2.6885133, -2.2844412, -6.0768766, 3.0752978, -3.5912826, -0.5046494, 11.007569]
Target sample: 85, Prediction:6, Target's Score:[2.8505216, 1.5200487, -2.6717117, -1.070873, 0.8145395, -5.1372423, 5.335592, -1.5965097, 0.8310749, -0.9834117]
Target sample: 91, Prediction:6, Target's Score:[-0.8399038, 3.7874327, -3.4586334, -1.0195017, -1.6766609, -5.4625635, 6.1462746, -1.5877416, -0.4542596, 4.45534]
Target sample: 97, Prediction:6, Target's Score:[0.5626446, -0.5222116, -2.9956188, 0.040724322, -0.85766274, -5.120793, 5.4896493, -2.628328, 5.1662164, 0.7251349]
Target sample: 103, Prediction:8, Target's Score:[-1.1824445, 3.6277313, -4.511866, -1.3015462, -2.6883867, -5.31232, 4.5393786, -2.253413, 4.544823, 4.4062123]
Target sample: 109, Prediction:6, Target's Score:[-2.1884155, 1.774735, -3.5223675, -0.98231083, -2.2192557, -4.8894224, 6.783446, -3.1564546, 3.6424603, 4.617086]
Target sample: 115, Prediction:6, Target's Score:[-2.3680012, 3.5996559, -4.1484976, 0.8818254, -2.536744, -4.0467954, 6.9143124, -1.7532184, -1.0959669, 4.4467583]
Target sample: 121, Prediction:1, Target's Score:[-0.13947453, 7.222804, -2.8686094, -0.44937658, -1.0604298, -5.2027164, 4.8520947, -3.2452757, -1.1837833, 1.9722756]
Target sample: 127, Prediction:6, Target's Score:[-1.0792706, -0.6527673, -3.0100749, -1.7842174, -2.007306, -4.781477, 8.934578, -1.9074365, 1.7308543, 4.423114]
Target sample: 133, Prediction:6, Target's Score:[-1.8961095, -2.056786, -0.59146535, 0.5757257, -1.6540337, -5.238585, 8.985947, -1.1428996, 0.5422689, 2.3531477]
Current ATTACK acc on target samples: 73.913
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 06:32:40 Epoch 59, Val iteration 0, acc 92.200 (92.200)
2021-06-13 06:32:52 Epoch 59, Val iteration 19, acc 91.800 (91.560)
* Prec: 91.56000099182128
Per class accuracy =  [0.94582553 0.92394013 0.87596686 0.8434193  0.94314836 0.88334202
 0.92865844 0.90658433 0.94108835 0.96494078]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 8, 6, 9, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 9, 9, 9, 9, 8, 4, 4, 4, 4, 6, 6, 8, 8, 9, 9, 6, 6, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 1, 8, 6, 6, 6, 6, 9, 6, 6, 8, 6, 8, 6, 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 9, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 76.10619469026548
--------
------SUMMARY PRE DEFENSE------
TIME ELAPSED (mins): 15
TARGET INDEX: 16
ResNet50 100.0 100.0 95.46000137329102 90.59000205993652
DPN92 30.434782608695652 30.97345132743363 95.50000267028808 92.72000083923339
MobileNetV2 4.3478260869565215 8.849557522123893 91.22000160217286 89.53000221252441
GoogLeNet 73.91304347826087 76.10619469026548 95.41000213623047 91.56000099182128
DEFENSE EVALUATION
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
ResNet50
[74, 80, 89] 3
Using Adam for retraining
2000
poison index =  84
poison index =  86
498
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 06:32:57, Val iteration 0, acc 94.200 (94.200)
2021-06-13 06:33:08, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-13 06:33:10, Epoch 0, Iteration 7, loss 0.033 (0.175), acc 98.077 (96.800)
2021-06-13 06:34:10, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6]
Target sample: 1, Prediction:6, Target's Score:[2.2224388, 2.7979033, -2.0964847, -0.29926994, -2.3920283, -1.3541385, 4.389148, -1.2707577, -1.7921742, -0.05731037]
Target sample: 7, Prediction:6, Target's Score:[2.1917224, 2.0907595, -0.19868357, 0.8451857, -1.8972276, -2.525254, 5.0175467, -1.5147891, -1.7331667, -2.1248634]
Target sample: 13, Prediction:0, Target's Score:[4.6565294, 3.587981, -1.3168315, -0.8307624, -3.0698082, -2.447167, 3.121017, -1.2813566, -0.83019805, -1.40495]
Target sample: 19, Prediction:0, Target's Score:[3.8852587, 2.8907053, -1.5909067, -0.45457128, -2.7549715, -1.9519017, 2.1808767, -1.300692, -1.3345529, 0.5893403]
Target sample: 25, Prediction:1, Target's Score:[0.9878721, 8.001257, -0.29828164, -2.3083093, -2.96916, -2.4818552, 1.8002782, -1.6588467, -0.85717404, 0.014887359]
Target sample: 31, Prediction:1, Target's Score:[0.14647458, 5.7643204, 0.15908611, -1.4700204, -2.2641127, -1.7391742, 1.3219725, -2.24143, 1.1333315, -0.6095412]
Target sample: 37, Prediction:8, Target's Score:[0.6353646, -0.6471622, -1.4008454, -1.0198753, -1.5302134, -2.4728253, 1.0901676, -2.2673547, 7.3474298, 0.44495094]
Target sample: 43, Prediction:8, Target's Score:[-0.07609524, -1.6398485, -1.3793782, -1.1728748, -1.6728327, -3.0143664, 2.4638994, -2.3528786, 9.429414, -0.38736197]
Target sample: 49, Prediction:8, Target's Score:[-0.06045758, 2.292507, -1.115011, -0.6412385, -1.932917, -1.6305091, 2.2613125, -2.0494995, 2.4085526, 0.6424006]
Target sample: 55, Prediction:6, Target's Score:[2.8213289, 0.40827203, -0.98548996, 0.8711251, -0.68849605, -1.8972853, 3.5288029, -1.6389214, -0.60081416, -1.6882783]
Target sample: 61, Prediction:6, Target's Score:[-0.43752366, 2.55014, -2.120998, -1.4895669, -2.1040294, -2.603913, 4.7853317, -2.3491976, 1.0690821, 2.8927572]
Target sample: 67, Prediction:8, Target's Score:[0.6919543, -1.0869323, -1.3916748, -0.75922495, 0.6472926, -2.420058, 2.2393892, -1.3346379, 3.5882246, -0.03672318]
Target sample: 73, Prediction:0, Target's Score:[2.5638418, 2.342046, -0.30411786, -0.5899111, 0.3396255, -2.1711931, 1.0179765, -2.246408, 0.14727224, -0.93827814]
Target sample: 79, Prediction:9, Target's Score:[0.6672193, 2.3091404, -1.8699759, -1.5917095, -1.8822047, -2.4895465, 1.4368623, -2.2164576, 0.8566446, 4.956476]
Target sample: 85, Prediction:1, Target's Score:[2.0785527, 8.29093, -0.61869633, -2.3458514, -3.1539066, -2.6597214, 1.3610837, -2.2214758, -0.40327728, -0.07945509]
Target sample: 91, Prediction:1, Target's Score:[2.3494222, 3.9113357, -0.86990374, -1.5189912, -2.7118793, -2.3578925, 1.3663653, -1.8324275, 2.525044, -0.6593293]
Target sample: 97, Prediction:0, Target's Score:[5.892993, -0.5053399, -1.7931813, -1.2954793, -2.4737947, -2.4828472, -0.7188423, -2.2822888, 5.0269656, 0.829255]
Target sample: 103, Prediction:8, Target's Score:[-0.0696401, -0.7051394, -2.162608, -1.5355703, -1.6073483, -2.891654, 1.8740538, -2.5920997, 6.102068, 3.7817829]
Target sample: 109, Prediction:8, Target's Score:[1.1355773, -0.31717163, -1.8259592, -0.6878844, -1.592691, -1.7132301, 2.858397, -2.1047838, 3.4968185, 0.9010287]
Target sample: 115, Prediction:1, Target's Score:[0.2806141, 7.835017, -0.6570907, -2.3555176, -3.0950313, -2.0127525, 2.571733, -2.2651594, -1.3295465, 1.2591814]
Target sample: 121, Prediction:6, Target's Score:[0.76221305, 2.0012522, -1.6264236, -0.84811777, -2.0607781, -1.752778, 4.836541, -1.9357693, -0.55066943, 1.3219194]
Target sample: 127, Prediction:1, Target's Score:[0.9492785, 4.381599, -1.3376287, -1.3829439, -2.458136, -1.7312604, 3.1800468, -1.9801311, -1.8753359, 2.428263]
Target sample: 133, Prediction:0, Target's Score:[5.68609, 0.36255866, -0.14387976, 0.3085262, -1.8763859, -2.679052, 3.6331637, -1.5012614, -1.5901105, -2.0521588]
Current ATTACK acc on target samples: 21.739
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 06:35:09 Epoch 59, Val iteration 0, acc 90.200 (90.200)
2021-06-13 06:35:19 Epoch 59, Val iteration 19, acc 93.600 (91.590)
* Prec: 91.59000129699707
Per class accuracy =  [0.92015524 0.93978053 0.86215948 0.75182639 0.94696081 0.92052898
 0.93734513 0.95290045 0.96607307 0.96337574]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 0, 1, 1, 6, 6, 0, 6, 0, 0, 1, 6, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 8, 8, 8, 8, 8, 8, 8, 1, 8, 8, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 9, 8, 8, 8, 8, 8, 0, 6, 8, 8, 8, 0, 9, 1, 0, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 8, 1, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 6, 8, 1, 1, 1, 1, 1, 6, 6, 1, 6, 6, 6, 6, 0, 6, 6, 6, 1, 6, 0, 0, 6
ATTACK acc: 20.353982300884955
DPN92
[] 22
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 06:35:24, Val iteration 0, acc 94.800 (94.800)
2021-06-13 06:35:44, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-13 06:35:49, Epoch 0, Iteration 7, loss 0.402 (0.433), acc 88.462 (89.000)
2021-06-13 06:38:27, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[0.85421187, 8.480936, -4.8566527, -3.351893, -2.5926428, -2.4149265, 5.753549, -2.7302525, 0.32053748, 0.941892]
Target sample: 7, Prediction:6, Target's Score:[0.30611998, 2.52386, -3.7543252, -2.1991284, -1.9880456, -2.6344585, 8.9693365, -2.5997736, 2.8984513, -1.1843957]
Target sample: 13, Prediction:6, Target's Score:[2.0063133, 2.634896, -3.750335, -3.1619616, -2.2145984, -3.3157191, 6.7853847, -2.3998482, 3.8463278, -0.06904341]
Target sample: 19, Prediction:6, Target's Score:[3.662807, 3.244424, -4.7058187, -3.5152087, -2.9520223, -3.495771, 5.8103895, -2.089491, 1.4843416, 2.9715445]
Target sample: 25, Prediction:1, Target's Score:[2.2703595, 9.479508, -5.1963882, -3.7572002, -2.3802333, -2.4220405, 4.054827, -1.8492265, -0.40705678, 0.65582824]
Target sample: 31, Prediction:1, Target's Score:[1.9868908, 6.221617, -4.1927376, -3.4749994, -2.1060636, -2.4983864, 4.3847647, -2.4565768, 3.3007684, -0.76519424]
Target sample: 37, Prediction:8, Target's Score:[-0.015544448, 4.2546716, -4.975406, -3.290322, -2.126318, -2.127206, 3.2525752, -2.9872189, 6.4016757, 2.032047]
Target sample: 43, Prediction:8, Target's Score:[-0.0812854, 1.1685077, -3.7836335, -3.3942416, -1.3402035, -1.946898, 4.687196, -2.4608114, 8.952497, -1.4302039]
Target sample: 49, Prediction:8, Target's Score:[2.1746955, 2.8206553, -4.6384954, -3.2726462, -2.6102674, -2.4984655, 4.3055196, -2.772624, 5.4967647, 1.4219456]
Target sample: 55, Prediction:8, Target's Score:[0.88590467, 2.711684, -3.5954163, -2.7855437, -0.0102569405, -2.8644152, 3.3793626, -1.9332362, 5.2528944, -0.69854647]
Target sample: 61, Prediction:1, Target's Score:[-1.0033774, 5.933029, -4.1777387, -3.2069175, 0.2245388, -2.7723575, 1.1060537, -2.5943408, 2.1433918, 4.7379603]
Target sample: 67, Prediction:8, Target's Score:[0.57728845, 0.41768286, -3.8105576, -2.273179, 0.8701952, -3.2141154, 4.30756, -1.7355466, 4.7454615, 0.4655279]
Target sample: 73, Prediction:8, Target's Score:[3.5368898, 2.9638565, -2.712663, -2.3287618, -0.08353624, -4.052224, 2.2272594, -2.238632, 3.836133, -0.7648324]
Target sample: 79, Prediction:9, Target's Score:[0.58538836, 4.3904123, -4.3533664, -3.5059838, -0.044743136, -3.384069, 2.613403, -2.7126322, 0.117080554, 6.6891522]
Target sample: 85, Prediction:1, Target's Score:[2.3497415, 9.780878, -4.711352, -3.7172787, -1.7693905, -2.8892956, 2.416737, -2.3651721, 1.385491, -0.032409683]
Target sample: 91, Prediction:1, Target's Score:[1.427318, 7.7926617, -4.8250995, -3.379022, -2.1671903, -2.9084218, 2.5855849, -2.215149, 3.9322655, 0.20110448]
Target sample: 97, Prediction:8, Target's Score:[1.9546916, 3.5019803, -4.2920547, -3.6906514, -2.0567079, -2.9126298, 3.3277292, -2.6631455, 6.5204124, 0.7164762]
Target sample: 103, Prediction:8, Target's Score:[-0.34393963, 2.1006157, -4.113424, -3.5729964, -2.3121474, -1.9035168, 2.531683, -3.2856092, 9.871177, 1.4629456]
Target sample: 109, Prediction:1, Target's Score:[1.0911233, 6.0135117, -4.2553577, -3.4954066, -2.6561084, -2.377243, 2.1104238, -2.803477, 4.8873467, 1.9056869]
Target sample: 115, Prediction:1, Target's Score:[0.97893447, 11.152894, -4.552675, -3.4038713, -2.115611, -2.391107, 1.1953764, -2.5560474, 1.1477449, 0.98990035]
Target sample: 121, Prediction:1, Target's Score:[1.653176, 8.995306, -4.5960197, -3.420021, -1.7285017, -2.4586751, 1.6527964, -2.0958836, -0.30271196, 2.7131994]
Target sample: 127, Prediction:6, Target's Score:[0.43117422, 3.3109627, -4.6932697, -3.7451904, -2.532491, -2.2416897, 7.0826235, -2.6587029, 2.1016746, 3.3062704]
Target sample: 133, Prediction:6, Target's Score:[0.81622684, 1.0334506, -3.015627, -1.7587537, -1.8730432, -2.3487988, 10.144624, -2.2814603, 1.5024203, -1.9092695]
Current ATTACK acc on target samples: 21.739
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 06:41:00 Epoch 59, Val iteration 0, acc 93.800 (93.800)
2021-06-13 06:41:21 Epoch 59, Val iteration 19, acc 93.200 (93.240)
* Prec: 93.2400016784668
Per class accuracy =  [0.96327963 0.95618383 0.90778903 0.83709497 0.94413081 0.87425206
 0.95749155 0.9554438  0.96646077 0.96081897]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 8, 8, 8, 8, 8, 8, 8, 1, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 8, 8, 8, 6, 6, 6, 6, 6, 8, 8, 9, 4, 4, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 1, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 27.43362831858407
MobileNetV2
[80, 86, 89] 47
Using Adam for retraining
2000
poison index =  74
poison index =  84
498
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 06:41:25, Val iteration 0, acc 92.600 (92.600)
2021-06-13 06:41:31, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-13 06:41:32, Epoch 0, Iteration 7, loss 0.154 (0.293), acc 98.077 (89.800)
2021-06-13 06:42:00, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6]
Target sample: 1, Prediction:1, Target's Score:[2.5867374, 6.349588, -4.2925477, 0.8441894, -2.8455257, -2.5972862, -0.014609003, -3.2657893, 0.9432734, 2.8677173]
Target sample: 7, Prediction:1, Target's Score:[3.427627, 7.6663456, -3.2705407, 3.3445842, -6.1291933, -3.510073, 3.4607458, -5.45765, 1.6873451, -0.6026725]
Target sample: 13, Prediction:1, Target's Score:[1.885999, 6.6932507, -3.7630894, 1.8163502, -5.052226, -3.60746, 3.5171134, -5.627023, 2.9291964, 1.8310963]
Target sample: 19, Prediction:9, Target's Score:[4.973589, 2.7587264, -4.3861275, 1.8795649, -1.9786772, -3.3476603, 0.6703679, -3.6399064, -2.1199398, 5.777643]
Target sample: 25, Prediction:1, Target's Score:[5.262582, 8.732169, -4.800347, 2.0891755, -3.42548, -3.1854877, -1.6071018, -3.9747741, 0.72602284, 0.8130541]
Target sample: 31, Prediction:3, Target's Score:[1.698139, 3.6217694, -3.4612608, 4.843208, -3.7458086, -3.797196, 1.479306, -4.882604, 4.7598166, 0.07239855]
Target sample: 37, Prediction:8, Target's Score:[0.41208684, 1.2771379, -4.5081, 4.5810804, -2.2895486, -3.897154, 0.16192196, -4.324513, 6.505958, 2.6710525]
Target sample: 43, Prediction:8, Target's Score:[-0.05750412, 1.3033053, -2.0613563, 4.108725, -1.8655404, -3.34838, 0.5846384, -2.997643, 5.662302, -0.80559605]
Target sample: 49, Prediction:1, Target's Score:[2.4660718, 5.674449, -2.9377103, 4.158079, -1.1945189, -3.3954887, -0.9810302, -5.047913, 3.016726, -1.1392322]
Target sample: 55, Prediction:3, Target's Score:[1.994421, -0.96630144, -0.14904912, 7.5060334, -2.1813195, -2.1666985, 0.42995656, -4.795252, 2.6793263, -1.853059]
Target sample: 61, Prediction:9, Target's Score:[1.4328166, 4.724242, -3.6758263, 1.1784964, -3.5124137, -3.2781458, 2.6256711, -4.3763022, -2.2259376, 7.685606]
Target sample: 67, Prediction:8, Target's Score:[1.9873064, -0.3236894, -2.1081264, 0.4161082, -0.8982943, -4.3570514, 1.4408545, -1.5427713, 4.69772, 1.1604513]
Target sample: 73, Prediction:8, Target's Score:[3.5168095, 2.160982, 0.3179909, 2.167219, -0.56865805, -4.616305, -1.8873163, -3.7459013, 5.1733847, -2.0308876]
Target sample: 79, Prediction:9, Target's Score:[1.7562994, 5.7573404, -5.6808915, 1.99181, -2.4327672, -1.7309602, 0.5755282, -4.639241, -1.453559, 6.490453]
Target sample: 85, Prediction:1, Target's Score:[4.8910847, 6.7716136, -4.8342, 0.96578753, -1.7702308, -3.0298924, -1.7073393, -2.9238021, 3.3682628, -1.1641982]
Target sample: 91, Prediction:1, Target's Score:[0.9949287, 11.16426, -6.516362, 2.3507006, -4.5193663, -3.3629787, -0.46082622, -3.4087923, 2.5731227, 1.8944765]
Target sample: 97, Prediction:8, Target's Score:[1.2777774, -1.1431615, -1.7969415, 4.071521, -1.9653225, -4.092361, -0.64447707, -2.8714974, 5.251796, 2.4204988]
Target sample: 103, Prediction:8, Target's Score:[-1.0904241, 2.9089515, -5.7098956, 3.1584356, -2.2883527, -2.3398728, 1.4368742, -4.8487663, 5.160593, 4.213806]
Target sample: 109, Prediction:3, Target's Score:[1.0913893, 4.0407624, -3.8237138, 4.590582, -3.3516626, -2.7667017, 1.9021006, -4.7233205, 2.4111884, 1.2145998]
Target sample: 115, Prediction:1, Target's Score:[4.3663692, 8.418658, -3.8368816, 2.0112, -4.682706, -3.4372425, -1.3895782, -1.9755129, 1.1459358, 0.0008648485]
Target sample: 121, Prediction:1, Target's Score:[3.4529767, 3.6346514, -4.8963995, 3.2726662, -3.7303457, -2.508499, -0.20966113, -2.0890403, 1.2867501, 2.3232818]
Target sample: 127, Prediction:1, Target's Score:[1.0364447, 6.2271338, -4.6432514, 3.036638, -6.1117916, -2.8528154, 3.1764398, -4.3242483, 0.8456722, 4.2150774]
Target sample: 133, Prediction:1, Target's Score:[1.8003685, 5.473138, -3.5655177, 4.696271, -5.7759657, -3.083619, 4.1507707, -4.945549, 0.9644159, 0.88883746]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 06:42:28 Epoch 59, Val iteration 0, acc 90.000 (90.000)
2021-06-13 06:42:34 Epoch 59, Val iteration 19, acc 90.200 (89.580)
* Prec: 89.58000144958496
Per class accuracy =  [0.92427067 0.93064493 0.84843282 0.83367254 0.89379914 0.82115161
 0.93563344 0.89214787 0.92944492 0.94655795]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 3, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 9, 1, 1, 6, 3, 0, 1, 1, 8, 8, 3, 3, 3, 1, 3, 8, 8, 1, 1, 8, 8, 3, 3, 1, 3, 8, 1, 1, 1, 3, 3, 3, 4, 3, 1, 0, 0, 9, 9, 8, 8, 8, 0, 8, 8, 3, 8, 8, 8, 8, 4, 1, 9, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 8, 8, 9, 9, 3, 9, 8, 9, 8, 3, 3, 3, 3, 1, 3, 1, 1, 1, 3, 3, 0, 8, 1, 1, 1, 9, 1, 1, 1, 1, 3, 0, 0, 1
ATTACK acc: 0.8849557522123894
GoogLeNet
[74, 86, 89] 20
Using Adam for retraining
2000
poison index =  80
poison index =  84
498
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 06:42:37, Val iteration 0, acc 96.200 (96.200)
2021-06-13 06:42:50, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-13 06:42:52, Epoch 0, Iteration 7, loss 0.544 (0.525), acc 82.692 (86.800)
2021-06-13 06:44:02, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6]
Target sample: 1, Prediction:1, Target's Score:[-0.021906214, 7.0095887, -4.2603817, -0.8639179, 0.48357302, -3.210842, 2.823932, -3.0927556, 1.2818632, -0.054972827]
Target sample: 7, Prediction:6, Target's Score:[1.4066805, 2.9353573, -2.5097556, -1.5047603, -1.0013776, -3.578385, 5.033857, -1.4012299, 2.1995394, -1.478335]
Target sample: 13, Prediction:1, Target's Score:[-0.6905277, 10.064832, -4.517249, -2.6395416, -2.4048114, -4.090361, 3.8547053, -3.0807223, 4.576403, -0.9745166]
Target sample: 19, Prediction:1, Target's Score:[2.9970713, 5.7590933, -4.5102143, -2.1128747, -1.1613547, -3.6562576, 2.5467827, -2.882562, 3.6989143, -0.56975377]
Target sample: 25, Prediction:1, Target's Score:[4.2816424, 5.1255054, -4.6128125, -3.1090379, 0.18046212, -3.3028982, 1.2154176, -2.404654, 3.6521008, -0.92020917]
Target sample: 31, Prediction:1, Target's Score:[0.34822837, 5.717912, -4.0041966, -2.5776768, -1.5487798, -2.6583447, 1.132813, -3.573638, 4.783891, 2.484555]
Target sample: 37, Prediction:1, Target's Score:[0.97392815, 6.221185, -4.834034, -1.7930241, -0.94735676, -3.5049963, 1.563443, -3.7876325, 4.9333053, 1.2852427]
Target sample: 43, Prediction:1, Target's Score:[1.5229046, 4.499944, -2.889435, -1.5719995, -1.1638662, -3.9395297, 2.3213608, -2.4814107, 4.0175056, -0.21472412]
Target sample: 49, Prediction:1, Target's Score:[-1.1690394, 7.61421, -4.615506, -1.4234097, -2.0968359, -1.6206242, 1.3994477, -3.6951423, 4.870068, 0.8325157]
Target sample: 55, Prediction:0, Target's Score:[3.9918664, 1.4318258, -3.525399, -1.910283, 1.8178368, -3.759314, 2.3338299, -0.663298, 3.0136895, -2.6172538]
Target sample: 61, Prediction:1, Target's Score:[-0.69683415, 7.775483, -3.6056805, -1.608, -0.33821312, -2.8232098, 0.38080886, -3.2514603, 1.1194772, 3.156613]
Target sample: 67, Prediction:8, Target's Score:[0.4970123, 2.444266, -4.764003, 1.9224827, 0.70196897, -3.6124291, 1.8673928, -2.7481246, 5.226823, -1.4196587]
Target sample: 73, Prediction:8, Target's Score:[2.7754345, 5.055619, -3.5375943, -1.0267401, -0.9603714, -4.5009785, 0.89913595, -3.3193226, 5.9064903, -1.1807106]
Target sample: 79, Prediction:9, Target's Score:[1.9997561, 8.052782, -4.855773, -3.3322952, -3.0348258, -4.795323, -0.355096, -3.8488107, 1.118279, 9.223546]
Target sample: 85, Prediction:1, Target's Score:[5.0028954, 5.479711, -4.5605073, -3.7727606, -0.6065257, -3.299188, 1.889806, -0.8680973, 3.0319185, -2.1842446]
Target sample: 91, Prediction:1, Target's Score:[1.9303402, 6.7837853, -4.5190043, -2.8540902, -2.0982873, -4.7612195, 1.8958209, -1.0210116, 3.3523734, 1.4212861]
Target sample: 97, Prediction:8, Target's Score:[2.0938456, 2.5826051, -3.6219296, -2.2571018, -1.1816512, -4.289413, 2.886144, -3.0224574, 7.0049458, -0.08506912]
Target sample: 103, Prediction:1, Target's Score:[0.8014762, 7.4594665, -5.0758305, -3.0299582, -3.2089708, -4.56233, 0.9749167, -3.1149135, 6.529586, 3.3536832]
Target sample: 109, Prediction:8, Target's Score:[1.5157278, 5.519034, -4.628056, -2.3513284, -1.654327, -3.541641, 0.965443, -3.4420855, 5.786262, 1.9456584]
Target sample: 115, Prediction:1, Target's Score:[0.44006017, 10.265392, -4.3709536, -2.1455774, -3.4975243, -3.4807005, 0.4428876, -2.64503, 3.460007, 1.634116]
Target sample: 121, Prediction:1, Target's Score:[2.8074548, 11.432922, -3.9541693, -1.959789, -2.0628355, -4.1595154, -1.0528444, -3.0951877, 1.9136364, 0.23418546]
Target sample: 127, Prediction:6, Target's Score:[0.49192077, 4.228373, -3.7156491, -2.2807896, -1.8866776, -3.337555, 5.4605722, -2.5030406, 3.0741036, 0.5738528]
Target sample: 133, Prediction:6, Target's Score:[-1.2788992, 3.8084939, -2.8378057, 1.5669048, -1.5839373, -3.075916, 4.2036004, -2.5456362, 2.2074807, -0.36065662]
Current ATTACK acc on target samples: 13.043
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 06:45:11 Epoch 59, Val iteration 0, acc 93.000 (93.000)
2021-06-13 06:45:24 Epoch 59, Val iteration 19, acc 93.400 (92.920)
* Prec: 92.92000160217285
Per class accuracy =  [0.94809687 0.96256594 0.8851082  0.86287587 0.97015544 0.88501083
 0.96355516 0.91379228 0.94678914 0.95239369]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 1, 1, 8, 1, 9, 8, 8, 8, 8, 0, 1, 8, 8, 1, 8, 8, 8, 0, 1, 6, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 8, 1, 8, 8, 8, 1, 8, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 1, 1, 6, 6
ATTACK acc: 10.619469026548673
------SUMMARY POST DEFENSE------
TIME ELAPSED (mins): 15
TARGET INDEX: 16
ResNet50 21.73913043478261 20.353982300884955 95.46000137329102 91.59000129699707 60.0
DPN92 21.73913043478261 27.43362831858407 95.50000267028808 93.2400016784668 0.0
MobileNetV2 0.0 0.8849557522123894 91.22000160217286 89.58000144958496 60.0
GoogLeNet 13.043478260869565 10.619469026548673 95.41000213623047 92.92000160217285 60.0
True False False False False
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.300-droplayer0.000.t7
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
No specific indices are determined, so try to include whatever we find
In total, we found 129 images of target 17
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', eval_poisons_root='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=False, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=17, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/17/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127]
# Targets: 22, # Poisons: 5
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-13 06:45:43 Iteration 0 	 Training Loss: 9.430e-01 	 Loss in Target Net: 1.944e+00	  
 2021-06-13 06:46:29 Iteration 50 	 Training Loss: 2.207e-01 	 Loss in Target Net: 5.814e-01	  
 2021-06-13 06:47:16 Iteration 100 	 Training Loss: 1.984e-01 	 Loss in Target Net: 5.488e-01	  
 2021-06-13 06:48:02 Iteration 150 	 Training Loss: 1.847e-01 	 Loss in Target Net: 5.373e-01	  
 2021-06-13 06:48:49 Iteration 200 	 Training Loss: 1.780e-01 	 Loss in Target Net: 5.053e-01	  
 2021-06-13 06:49:36 Iteration 250 	 Training Loss: 1.756e-01 	 Loss in Target Net: 5.474e-01	  
 2021-06-13 06:50:22 Iteration 300 	 Training Loss: 1.718e-01 	 Loss in Target Net: 5.714e-01	  
 2021-06-13 06:51:09 Iteration 350 	 Training Loss: 1.710e-01 	 Loss in Target Net: 5.197e-01	  
 2021-06-13 06:51:57 Iteration 400 	 Training Loss: 1.686e-01 	 Loss in Target Net: 5.681e-01	  
 2021-06-13 06:52:43 Iteration 450 	 Training Loss: 1.630e-01 	 Loss in Target Net: 5.124e-01	  
 2021-06-13 06:53:32 Iteration 500 	 Training Loss: 1.741e-01 	 Loss in Target Net: 5.225e-01	  
 2021-06-13 06:54:20 Iteration 550 	 Training Loss: 1.643e-01 	 Loss in Target Net: 5.788e-01	  
 2021-06-13 06:55:08 Iteration 600 	 Training Loss: 1.560e-01 	 Loss in Target Net: 5.329e-01	  
 2021-06-13 06:55:55 Iteration 650 	 Training Loss: 1.594e-01 	 Loss in Target Net: 5.488e-01	  
 2021-06-13 06:56:42 Iteration 700 	 Training Loss: 1.581e-01 	 Loss in Target Net: 5.398e-01	  
 2021-06-13 06:57:28 Iteration 750 	 Training Loss: 1.651e-01 	 Loss in Target Net: 5.171e-01	  
 2021-06-13 06:58:16 Iteration 800 	 Training Loss: 1.536e-01 	 Loss in Target Net: 5.335e-01	  
 2021-06-13 06:59:03 Iteration 850 	 Training Loss: 1.625e-01 	 Loss in Target Net: 5.481e-01	  
 2021-06-13 06:59:51 Iteration 900 	 Training Loss: 1.587e-01 	 Loss in Target Net: 5.657e-01	  
 2021-06-13 07:00:37 Iteration 950 	 Training Loss: 1.545e-01 	 Loss in Target Net: 5.297e-01	  
 2021-06-13 07:01:23 Iteration 999 	 Training Loss: 1.674e-01 	 Loss in Target Net: 5.222e-01	  
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 07:01:28, Val iteration 0, acc 94.200 (94.200)
2021-06-13 07:01:38, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-13 07:01:43, Epoch 0, Iteration 7, loss 0.541 (0.662), acc 86.538 (86.800)
2021-06-13 07:02:43, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.3527553, 4.2063236, -0.5943415, -2.4841123, -1.8860602, -3.1934793, 8.926834, -0.5177264, 1.3513062, -3.3758957]
Target sample: 7, Prediction:6, Target's Score:[-3.7065845, 4.752595, -1.9298292, -1.3433894, -2.0399067, -2.595352, 10.616852, -3.1996548, 1.640151, -2.0812738]
Target sample: 13, Prediction:6, Target's Score:[-4.0420647, 1.8895037, -1.090406, -1.4844711, -1.5813347, -2.6337328, 10.9548235, -3.1355186, 1.0946076, 0.13273326]
Target sample: 19, Prediction:1, Target's Score:[-2.505062, 8.800523, -1.0697349, -2.4546788, -1.832443, -3.3185172, 8.199665, -2.6079595, -0.69364595, -2.4666526]
Target sample: 25, Prediction:6, Target's Score:[-3.4193165, 4.2146144, -0.43532902, -1.8860222, -1.4007854, -2.9503403, 10.189973, -2.9387507, 1.4186887, -2.7023427]
Target sample: 31, Prediction:6, Target's Score:[-3.4186482, 1.8368492, -0.81368285, -1.4199728, -1.6729342, -2.8934634, 11.867212, -3.4111137, 3.2013502, -3.1462197]
Target sample: 37, Prediction:6, Target's Score:[-3.0116801, 2.2278285, -1.3134574, -1.5731277, -1.9062929, -2.9695568, 10.980314, -3.3285968, 3.8777673, -2.8638856]
Target sample: 43, Prediction:6, Target's Score:[-3.4272168, 4.297142, -1.9415601, -1.3901188, -2.0116773, -2.6039057, 10.053729, -3.089217, 2.2541163, -2.0363343]
Target sample: 49, Prediction:6, Target's Score:[-2.164561, 8.0032215, -1.4811988, -1.388221, -2.60355, -3.0431943, 8.623242, -2.918171, 0.7479705, -3.6997147]
Target sample: 55, Prediction:6, Target's Score:[-3.0532656, 4.620562, -0.7285848, -1.443969, -1.5648276, -2.789933, 10.087722, -2.7870777, 0.3672298, -2.6099026]
Target sample: 61, Prediction:6, Target's Score:[-2.138862, 1.7051791, -0.80783975, -1.6462971, -1.0814406, -3.0460985, 10.663417, -2.7268531, 2.198302, -3.0061774]
Target sample: 67, Prediction:6, Target's Score:[-3.6836295, 3.8227878, -1.5142275, -1.5506759, -1.9356142, -3.0332074, 12.244958, -3.2318254, 2.9824543, -3.968109]
Target sample: 73, Prediction:6, Target's Score:[-3.1574733, 4.989547, -1.7310973, -1.6393687, -2.0632286, -2.9803543, 9.569463, -3.1452994, 0.7873427, -0.5397599]
Target sample: 79, Prediction:1, Target's Score:[-2.190162, 9.746058, -1.6178268, -1.9258481, -2.4384027, -3.3203526, 7.989209, -2.8343182, 0.6879628, -4.0413237]
Target sample: 85, Prediction:6, Target's Score:[-3.3305414, 3.3579383, -1.2887728, -1.9284164, -1.32355, -2.846114, 9.6323805, -2.9524179, 3.141592, -2.3757653]
Target sample: 91, Prediction:6, Target's Score:[-3.489808, 1.5825461, -1.6289328, -1.1158595, -1.876011, -2.485194, 9.997534, -3.4964478, 4.4710364, -1.8601496]
Target sample: 97, Prediction:6, Target's Score:[-2.9941926, 5.568324, -1.5366708, -0.8289555, -2.2046595, -2.6946177, 9.146803, -3.5284011, 2.9827435, -3.829487]
Target sample: 103, Prediction:6, Target's Score:[-3.1957574, 1.7527084, -1.6573439, -0.8562724, -1.7554747, -2.1354973, 9.464253, -3.102921, 2.5667303, -0.98126423]
Target sample: 109, Prediction:1, Target's Score:[-1.8858372, 10.011656, -2.0634444, -1.6032265, -3.2938318, -2.982958, 6.872858, -2.4212718, 0.5593381, -3.1449823]
Target sample: 115, Prediction:6, Target's Score:[-3.1644115, 1.4457091, -0.7130627, -1.4445612, -1.7644588, -2.255351, 10.402254, -2.7800424, 1.9159967, -1.5323055]
Target sample: 121, Prediction:6, Target's Score:[-2.1927896, 4.037084, 0.49754867, -2.4472396, -1.332703, -3.1159103, 9.109314, -2.312604, 1.2178829, -3.3857896]
Target sample: 127, Prediction:6, Target's Score:[-3.579836, 0.79855263, -1.2949486, -1.8993522, -1.8063405, -2.9254794, 9.693473, -2.4273722, 2.4652755, 1.0603968]
Current ATTACK acc on target samples: 86.364
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 07:03:42 Epoch 59, Val iteration 0, acc 89.000 (89.000)
2021-06-13 07:03:53 Epoch 59, Val iteration 19, acc 91.000 (89.370)
* Prec: 89.37000122070313
Per class accuracy =  [0.92135836 0.9175206  0.80096481 0.79085368 0.92272256 0.85476699
 0.96180185 0.8651501  0.94211087 0.958736  ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 90.65420560747664
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 07:04:05, Val iteration 0, acc 94.800 (94.800)
2021-06-13 07:04:26, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-13 07:04:40, Epoch 0, Iteration 7, loss 0.154 (0.597), acc 96.154 (87.800)
2021-06-13 07:07:18, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-0.33478856, 5.162685, -2.6233861, -2.6545084, -0.4648432, -1.7154857, 4.1751213, -1.4111762, 0.5770472, -0.4743126]
Target sample: 7, Prediction:8, Target's Score:[-0.6540432, 1.4221686, -1.8266472, -3.0532014, -1.7275841, -2.7672796, 5.0787363, -3.0553997, 5.4965525, 1.3334595]
Target sample: 13, Prediction:6, Target's Score:[-1.0057517, 0.9824979, -2.193653, -1.0273836, -0.6695178, -2.2706473, 7.170241, -1.1909587, 0.96545225, -0.55701613]
Target sample: 19, Prediction:1, Target's Score:[-0.42322636, 7.2785397, -3.314937, -2.2998803, -1.4873284, -1.6300738, 4.302157, -2.9145913, 0.7931349, -0.022383852]
Target sample: 25, Prediction:6, Target's Score:[0.38550404, 5.6473165, -2.6978505, -2.6363683, -1.9684377, -2.7089663, 6.3176184, -3.907324, 1.6548014, 0.1870509]
Target sample: 31, Prediction:6, Target's Score:[0.04636315, 2.0416777, -2.4676836, -1.9785231, -1.2475895, -2.9468644, 9.922344, -2.356745, 0.4261308, -1.2006277]
Target sample: 37, Prediction:6, Target's Score:[0.24773753, 4.276653, -3.2527006, -2.9522383, -2.6171749, -3.0047872, 10.436924, -3.1301975, 1.2030557, -0.93284094]
Target sample: 43, Prediction:6, Target's Score:[-0.058686946, 2.0457752, -2.8805947, -2.9667146, -2.4547775, -2.8549693, 10.1806135, -3.6479726, 2.2995281, 0.60975516]
Target sample: 49, Prediction:1, Target's Score:[-0.08526064, 10.464387, -3.9978952, -3.8667583, -2.9632874, -2.64017, 8.996048, -4.5805254, 0.68583125, -1.6458142]
Target sample: 55, Prediction:6, Target's Score:[0.8124251, 1.8002366, -2.4873369, -1.1084466, -1.6379234, -2.4907367, 10.9512415, -3.0419464, 0.70834506, -3.2494843]
Target sample: 61, Prediction:6, Target's Score:[-0.32391545, 0.5065512, -2.5538619, -2.0641856, -1.2703949, -3.0007126, 9.494159, -2.6521664, 2.5540671, -0.4622902]
Target sample: 67, Prediction:6, Target's Score:[0.7148209, 2.0535014, -2.970179, -2.5217407, -1.6982814, -2.9702208, 10.393101, -2.8932745, 1.560009, -1.427944]
Target sample: 73, Prediction:6, Target's Score:[-0.45606554, 3.4183183, -3.0782351, -2.1330376, -1.6254729, -3.0002189, 8.24324, -2.6991255, 0.50092554, 1.0748216]
Target sample: 79, Prediction:1, Target's Score:[-0.56431246, 9.29231, -3.385266, -2.4972079, -3.0890443, -2.185181, 3.8173244, -2.6739883, 1.3483639, 0.25910452]
Target sample: 85, Prediction:6, Target's Score:[-0.014838777, 5.2793126, -3.3825705, -2.8133686, -2.88352, -1.9904662, 6.452773, -3.8167856, 3.5068488, -0.044625923]
Target sample: 91, Prediction:6, Target's Score:[-1.1122669, 2.2884924, -2.6257155, -2.0847042, -2.288937, -2.8478942, 6.0345154, -2.87885, 5.24915, 0.5194871]
Target sample: 97, Prediction:1, Target's Score:[0.042021435, 9.112143, -3.1491418, -3.2025611, -3.4230528, -2.7927392, 4.5731077, -3.297528, 3.592749, -1.1304032]
Target sample: 103, Prediction:6, Target's Score:[0.28370577, 1.6657034, -2.729157, -2.4678931, -2.0478497, -1.6198018, 4.9263387, -3.0330749, 3.5926583, 1.6733731]
Target sample: 109, Prediction:1, Target's Score:[0.80073065, 9.136951, -3.2090185, -2.636111, -3.3812456, -1.6117995, 4.1882167, -2.2891314, -0.54881805, -0.12655602]
Target sample: 115, Prediction:6, Target's Score:[-0.20309786, 4.0508537, -2.7018695, -1.7281905, -2.219436, -2.6090667, 7.181468, -1.9840069, 2.0099077, -1.5401031]
Target sample: 121, Prediction:6, Target's Score:[-2.2744818, 2.290841, -1.9579608, -1.6348819, -0.7109824, -3.590145, 4.271675, 0.56959677, 0.5971793, 2.683913]
Target sample: 127, Prediction:6, Target's Score:[-1.2603254, 0.693351, -1.5805951, -1.915388, -2.2223985, -3.1664977, 4.2259398, -1.5815125, 2.9734757, 4.077099]
Current ATTACK acc on target samples: 68.182
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 07:09:52 Epoch 59, Val iteration 0, acc 93.800 (93.800)
2021-06-13 07:10:13 Epoch 59, Val iteration 19, acc 91.600 (92.530)
* Prec: 92.53000183105469
Per class accuracy =  [0.93822079 0.9556474  0.91778439 0.82499764 0.94804181 0.8930086
 0.95796568 0.90106275 0.96380539 0.95589945]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 1, 6, 6, 6, 6, 1, 6, 6, 6, 1, 6, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 1, 1, 1, 1, 6, 1, 1, 6, 8, 6, 6, 8, 1, 6, 8, 6, 8, 6, 6, 6, 6, 6, 9, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 7, 6, 6, 6, 6, 8, 6, 6
ATTACK acc: 69.1588785046729
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 07:10:17, Val iteration 0, acc 92.600 (92.600)
2021-06-13 07:10:23, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-13 07:10:25, Epoch 0, Iteration 7, loss 0.401 (0.332), acc 88.462 (91.200)
2021-06-13 07:10:53, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[1.4201967, 2.5714462, -0.5503349, 1.6059736, -0.72693586, -3.7290847, 0.33421415, 1.4199044, -4.2797804, 2.3561788]
Target sample: 7, Prediction:1, Target's Score:[0.039228965, 7.7876806, -4.5101447, -0.09283784, -4.5486045, -3.6518922, 2.7617455, -2.3518662, -0.97941774, 6.0039988]
Target sample: 13, Prediction:9, Target's Score:[2.3661604, 3.5276022, -2.9214923, 1.6323733, -2.5863063, -3.95678, 3.7377963, -1.1268208, -4.1975646, 3.9790285]
Target sample: 19, Prediction:1, Target's Score:[-1.1645726, 11.406222, -1.706471, -1.4723669, -3.0022147, -2.8351595, 1.7398129, -0.6213563, -3.7375836, 1.871398]
Target sample: 25, Prediction:6, Target's Score:[2.6915343, 3.9548512, -0.912324, 0.6297025, -1.4981394, -3.91609, 5.0313044, -4.1698637, -0.37232578, -1.0143249]
Target sample: 31, Prediction:1, Target's Score:[1.3050871, 8.741179, -1.8910325, -0.5290507, -0.9520035, -4.4773793, 2.2705836, -3.1116602, -3.607291, 2.7470763]
Target sample: 37, Prediction:6, Target's Score:[-0.010446113, 1.6850137, -2.8330598, 1.0315912, 0.87774456, -5.049116, 6.9270525, -4.1469164, -0.38924965, 2.3752937]
Target sample: 43, Prediction:6, Target's Score:[-1.5632675, 4.9471164, -5.505932, 2.2738948, -4.392666, -2.5242012, 9.351471, -6.6033716, -0.52346545, 5.047451]
Target sample: 49, Prediction:1, Target's Score:[0.35487247, 10.624448, -3.489039, 0.711742, -4.9200454, -3.56446, 7.973165, -5.212557, -2.0746098, 0.09334661]
Target sample: 55, Prediction:6, Target's Score:[1.7791821, 0.07012138, -1.8166449, 3.5003712, -4.3366804, -1.7467608, 10.419517, -5.0236554, -5.0255084, 2.592487]
Target sample: 61, Prediction:6, Target's Score:[0.94494545, 2.3067775, 0.40377927, 0.2506414, -2.260703, -3.7175074, 5.871578, -1.0985914, -2.4228754, 0.098850474]
Target sample: 67, Prediction:6, Target's Score:[1.4208809, 1.9669641, -4.5189834, 1.3796829, -2.0256355, -4.0715733, 9.675737, -4.010129, 1.3060694, -0.70150197]
Target sample: 73, Prediction:6, Target's Score:[4.609944, 5.799594, -3.2658854, -0.95101327, -3.6028094, -4.6392527, 7.917118, -3.759262, -2.5712702, 0.88974375]
Target sample: 79, Prediction:6, Target's Score:[3.2029548, 5.9036946, -2.2566211, 0.2640888, -5.021449, -3.5023382, 7.8255324, -4.782484, -3.2273893, 2.0268373]
Target sample: 85, Prediction:9, Target's Score:[2.0422785, 4.518373, -4.1020284, 1.1122174, -4.741946, -2.3628469, 5.583893, -5.2636733, -2.649162, 6.293028]
Target sample: 91, Prediction:9, Target's Score:[-0.7197223, 2.9171402, -4.65755, 1.8536568, -2.055578, -3.045522, 5.5263796, -3.487189, -4.1608973, 8.292094]
Target sample: 97, Prediction:9, Target's Score:[0.8596643, 2.562914, -3.4800186, 2.963628, -2.035396, -3.2089522, 3.6813164, -3.191623, -3.8929117, 6.210959]
Target sample: 103, Prediction:9, Target's Score:[-0.46396947, -0.72777843, -3.5193272, 3.0615034, 0.06319183, -3.9097145, 3.75027, -2.1774447, -0.1012748, 4.4819183]
Target sample: 109, Prediction:1, Target's Score:[-0.8272672, 9.979689, -3.822601, -0.69203264, -5.3785706, -3.6904838, 7.1155205, -3.4473014, -3.8197305, 5.0929747]
Target sample: 115, Prediction:6, Target's Score:[-1.3991313, 1.6837293, -2.3849163, 1.3100177, -1.2492347, -1.7381339, 10.30259, -3.452117, -1.3444387, -1.3260303]
Target sample: 121, Prediction:9, Target's Score:[-2.4244757, 1.9233452, -3.3856535, 0.5661621, 2.5875442, -3.7821224, 1.3791038, 1.8326409, -1.2205328, 2.9790254]
Target sample: 127, Prediction:9, Target's Score:[-0.7925863, 2.297779, -4.8977532, 0.7411385, -3.193609, -4.309069, 2.5187478, -2.2093341, -2.5970933, 12.941196]
Current ATTACK acc on target samples: 40.909
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 07:11:20 Epoch 59, Val iteration 0, acc 89.600 (89.600)
2021-06-13 07:11:26 Epoch 59, Val iteration 19, acc 90.200 (89.530)
* Prec: 89.53000183105469
Per class accuracy =  [0.92744473 0.92934479 0.84273888 0.83332734 0.89044014 0.81971429
 0.93687337 0.88981115 0.92968418 0.94715207]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 9, 4, 9, 9, 6, 9, 9, 9, 9, 1, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 1, 1, 1, 6, 1, 1, 9, 9, 6, 6, 6, 6, 6, 9, 9, 9, 9, 6, 9, 9, 9, 9, 9, 1, 1, 1, 6, 6, 6, 6, 6, 2, 3, 1, 1, 6, 9, 1, 1, 9, 9
ATTACK acc: 46.728971962616825
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 07:11:34, Val iteration 0, acc 96.200 (96.200)
2021-06-13 07:11:46, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-13 07:11:53, Epoch 0, Iteration 7, loss 0.929 (0.646), acc 73.077 (82.400)
2021-06-13 07:13:04, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[0.96057683, 7.4709406, -3.5671425, -2.5611944, -2.2793005, -4.513987, 3.7115247, -2.4056296, 2.5493238, 0.7575323]
Target sample: 7, Prediction:6, Target's Score:[-2.584924, 5.0036244, -3.2337413, -3.562056, -1.634815, -4.1063356, 7.606259, -3.3474233, 6.178256, -0.20315182]
Target sample: 13, Prediction:6, Target's Score:[-0.65643054, 5.6133723, -4.146609, 0.24777575, -1.0091563, -4.9789248, 7.7969685, -2.73521, 0.0919296, -0.12685084]
Target sample: 19, Prediction:1, Target's Score:[-0.82239497, 9.524967, -5.516996, -2.4786196, -1.0599817, -4.9495687, 6.3043423, -3.1222188, 0.98736215, 1.2452279]
Target sample: 25, Prediction:6, Target's Score:[0.80688184, 3.66875, -4.484499, -3.6615663, -1.7011199, -4.865832, 7.604544, -3.1639924, 1.931865, 3.9939687]
Target sample: 31, Prediction:6, Target's Score:[0.46930665, 3.7850258, -3.7613325, -3.0475233, -1.5141728, -4.154525, 7.7968397, -3.1619003, 4.3335514, -0.6247313]
Target sample: 37, Prediction:8, Target's Score:[3.7246518, 1.2389002, -3.8825653, -3.5418556, -3.1083229, -4.109266, 6.8031497, -3.2694592, 7.625811, -1.3127794]
Target sample: 43, Prediction:6, Target's Score:[0.6553429, 5.8300643, -5.035293, -2.3013463, -3.2181292, -4.8486943, 7.985629, -3.480713, 4.1950593, 0.35113287]
Target sample: 49, Prediction:1, Target's Score:[-1.0932775, 7.667914, -4.2024384, -0.50922257, -1.5412437, -3.9380655, 6.5561, -3.505493, 0.64612055, 0.019409293]
Target sample: 55, Prediction:6, Target's Score:[1.4368658, 1.9689575, -3.7680306, 2.3850546, -3.3601525, -4.6877346, 6.8878694, -2.3731253, 2.1516469, -0.51134986]
Target sample: 61, Prediction:6, Target's Score:[-1.6348999, 0.7831833, -2.3301754, 1.5033607, -2.2317452, -4.1525393, 7.814381, -1.5947783, 3.3339517, -1.4062629]
Target sample: 67, Prediction:6, Target's Score:[0.4915589, 2.1567256, -4.6637936, -1.1499873, 0.7141555, -5.06491, 8.462106, -3.4237416, 4.8122206, -2.234776]
Target sample: 73, Prediction:1, Target's Score:[1.3926694, 7.2637014, -5.173071, 0.8368931, -2.3834846, -5.359884, 5.963238, -2.138499, 0.4885218, -0.74686337]
Target sample: 79, Prediction:1, Target's Score:[-0.0013926704, 11.098795, -4.727209, -2.4245543, -3.3332455, -4.8833547, 4.613728, -3.3804467, 2.5603805, 0.6193181]
Target sample: 85, Prediction:0, Target's Score:[5.930013, 1.3940792, -4.140869, -1.7543387, -1.6891062, -4.640882, 3.4378638, -3.8367023, 5.2350245, 0.25172436]
Target sample: 91, Prediction:8, Target's Score:[-2.8117495, 4.502859, -5.215708, -1.5570878, -3.9579854, -3.341045, 4.82902, -3.6208081, 8.500419, 2.827399]
Target sample: 97, Prediction:8, Target's Score:[1.4200592, 5.360786, -5.1184487, -1.6394188, -3.536625, -3.4790475, 1.807835, -3.9381151, 7.6110864, 1.6859057]
Target sample: 103, Prediction:8, Target's Score:[3.4392362, 1.5178566, -4.0645027, -1.3563088, -2.842282, -3.6230474, 2.771349, -3.2606316, 5.979996, 1.6131356]
Target sample: 109, Prediction:1, Target's Score:[-1.5531666, 14.022587, -4.9901743, -2.469726, -3.6425648, -4.7175136, 3.0268018, -3.2930033, -0.32412946, 4.082091]
Target sample: 115, Prediction:6, Target's Score:[-2.7525687, 7.6983004, -4.4105344, -1.7651502, -2.7891307, -3.0733283, 8.944368, -3.3344042, 0.74713445, 0.83972484]
Target sample: 121, Prediction:1, Target's Score:[-1.2386888, 6.323245, -2.4787893, -1.4403741, 0.029664394, -3.6744509, 2.6186807, -2.748197, 1.5780112, 1.1357019]
Target sample: 127, Prediction:8, Target's Score:[-1.7865056, 4.4356723, -3.1104665, -3.1226294, -2.2520123, -4.7636814, 2.4928036, -3.221707, 7.671886, 3.7869565]
Current ATTACK acc on target samples: 40.909
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 07:14:13 Epoch 59, Val iteration 0, acc 94.000 (94.000)
2021-06-13 07:14:26 Epoch 59, Val iteration 19, acc 92.600 (92.850)
* Prec: 92.85000076293946
Per class accuracy =  [0.96284951 0.9402268  0.88539965 0.87588645 0.95032289 0.87525045
 0.95830232 0.91514551 0.96355098 0.9567635 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 1, 1, 6, 1, 8, 8, 8, 1, 9, 1, 1, 6, 9, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 8, 8, 8, 8, 6, 8, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 8, 1, 8, 8, 8, 8, 8, 8, 8, 8, 9, 8, 1, 8, 0, 6, 6, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 4, 1, 6, 1, 8, 8, 9
ATTACK acc: 36.44859813084112
--------
------SUMMARY PRE DEFENSE------
TIME ELAPSED (mins): 15
TARGET INDEX: 17
ResNet50 86.36363636363636 90.65420560747664 95.46000137329102 89.37000122070313
DPN92 68.18181818181819 69.1588785046729 95.50000267028808 92.53000183105469
MobileNetV2 40.90909090909091 46.728971962616825 91.22000160217286 89.53000183105469
GoogLeNet 40.90909090909091 36.44859813084112 95.41000213623047 92.85000076293946
DEFENSE EVALUATION
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
ResNet50
[74, 80, 86, 89] 4
Using Adam for retraining
2000
poison index =  84
499
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 07:14:31, Val iteration 0, acc 94.200 (94.200)
2021-06-13 07:14:41, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-13 07:14:43, Epoch 0, Iteration 7, loss 0.423 (0.253), acc 90.385 (95.000)
2021-06-13 07:15:44, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6]
Target sample: 1, Prediction:9, Target's Score:[-0.44743052, 0.25417486, -1.1018848, -0.09099987, -1.0077283, -1.31867, 0.013796897, -0.8418969, 1.2671634, 3.2936554]
Target sample: 7, Prediction:8, Target's Score:[-0.707729, -0.2225578, -0.9159133, 0.013208879, -0.5533112, -1.111588, 1.7859157, -1.2649193, 2.5065446, 0.48155877]
Target sample: 13, Prediction:9, Target's Score:[-0.7434102, -0.38589597, -0.7459248, 0.306379, -1.1954743, -0.95215786, 0.41497663, -1.7804946, -0.23812674, 5.354974]
Target sample: 19, Prediction:9, Target's Score:[-1.3943173, 5.7385516, -1.2931372, -1.1129464, -1.7641455, -1.0496485, -0.35320026, -2.656182, -2.0133843, 5.9646864]
Target sample: 25, Prediction:9, Target's Score:[-1.2690192, 1.2377499, -1.1752938, -0.18739681, -1.542775, -0.78581357, 0.797684, -2.096389, -1.1543367, 6.2326183]
Target sample: 31, Prediction:6, Target's Score:[-0.34119692, 0.0070731537, -1.6325936, -0.53143096, -1.3947921, -0.91977817, 3.1318607, -1.3446648, 1.2429153, 1.7985089]
Target sample: 37, Prediction:9, Target's Score:[0.6111876, 0.9360644, -1.4375399, -0.5977401, -1.435454, -1.4709269, 0.36128235, -1.2828674, 1.6956965, 2.6231647]
Target sample: 43, Prediction:9, Target's Score:[-0.568222, 1.273906, -2.2010095, -0.36408833, -2.0052037, -1.4595398, 0.21411741, -1.8497809, 0.6049228, 6.394359]
Target sample: 49, Prediction:1, Target's Score:[-0.7993665, 9.96639, -2.8321545, -1.4026608, -3.0041692, -1.9402591, -0.15222105, -2.6214285, -1.1153849, 3.9408064]
Target sample: 55, Prediction:9, Target's Score:[-1.2090272, 0.7167647, -1.4892848, -0.46398497, -1.764489, -1.2294719, 0.3442985, -2.4791808, -0.16616848, 7.7995615]
Target sample: 61, Prediction:8, Target's Score:[-0.6149608, -1.6183239, -1.5979239, -0.23158784, -0.7273625, -1.4519701, 1.981276, -0.7136785, 3.6576457, 1.3299255]
Target sample: 67, Prediction:6, Target's Score:[-0.8225332, 0.19908528, -2.0011215, -0.36489472, -1.1948861, -1.0773758, 2.9715455, -1.4662197, 2.8622832, 0.90718144]
Target sample: 73, Prediction:9, Target's Score:[-1.0896434, 2.0573146, -2.1966777, -0.7205281, -2.2842176, -1.8759146, -0.29491127, -2.3636596, 0.60322964, 8.221491]
Target sample: 79, Prediction:1, Target's Score:[-1.3471186, 10.519255, -2.2532842, -1.6218683, -2.430828, -2.1099463, -1.2767313, -2.5166712, -1.0580292, 4.1411366]
Target sample: 85, Prediction:9, Target's Score:[-0.2032179, 0.16688854, -0.89324176, 0.088366926, -0.9417037, -1.0912292, -0.55298334, -1.6784849, 1.0134385, 4.1181207]
Target sample: 91, Prediction:9, Target's Score:[-0.5997766, 0.57733995, -0.7818794, 0.13332154, -1.3034376, -0.97627425, -0.33542675, -2.046582, 0.39727023, 4.976937]
Target sample: 97, Prediction:1, Target's Score:[-0.07537182, 6.6847577, -1.6269319, -0.9212233, -2.022065, -1.5785677, -1.3116995, -2.1023605, 0.3915642, 2.5824366]
Target sample: 103, Prediction:9, Target's Score:[-0.06682647, 2.2967446, -1.3890911, -0.31096813, -1.8615819, -1.182502, -1.0676197, -1.8176969, -0.023945436, 5.459176]
Target sample: 109, Prediction:1, Target's Score:[-1.139168, 8.622776, -2.4205303, -0.99114776, -2.9679568, -1.7041861, -1.3228062, -2.592047, -1.1938957, 5.7672734]
Target sample: 115, Prediction:9, Target's Score:[-0.61179924, 1.5005567, -1.6859403, -0.43660483, -1.5991791, -0.7248667, 0.21587065, -1.6984987, 0.59394175, 4.48476]
Target sample: 121, Prediction:4, Target's Score:[-0.8117808, -1.0669861, 0.670016, 0.42368484, 2.4447143, -1.3930186, -0.32385364, -0.48399138, 0.26873374, 0.30799726]
Target sample: 127, Prediction:9, Target's Score:[0.019906005, -0.8285172, 1.2930549, -0.27362263, -0.6705918, -1.4171927, -0.63203263, -1.0787178, 0.25279853, 3.359413]
Current ATTACK acc on target samples: 9.091
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 07:16:43 Epoch 59, Val iteration 0, acc 87.400 (87.400)
2021-06-13 07:16:53 Epoch 59, Val iteration 19, acc 90.200 (90.030)
* Prec: 90.03000183105469
Per class accuracy =  [0.86148804 0.90785501 0.85683372 0.82012853 0.91719521 0.88816311
 0.96054842 0.88044405 0.95060852 0.9576103 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 4, 4, 8, 4, 8, 9, 2, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 1, 1, 9, 1, 1, 9, 9, 9, 9, 1, 1, 1, 9, 1, 9, 1, 1, 1, 1, 9, 9, 9, 9, 6, 9, 8, 6, 8, 6, 9, 8, 6, 9, 9, 9, 9, 1, 1, 1, 9, 1, 1, 1, 1, 9, 9, 1, 9, 9, 9, 9, 9, 1, 1, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 1, 1, 1, 1, 1, 9, 9, 1, 9, 9, 7, 3, 4, 4, 8, 8, 2, 9
ATTACK acc: 3.7383177570093458
DPN92
[74, 86, 89] 25
Using Adam for retraining
2000
poison index =  80
poison index =  84
498
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 07:16:58, Val iteration 0, acc 94.800 (94.800)
2021-06-13 07:17:19, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-13 07:17:24, Epoch 0, Iteration 7, loss 0.195 (0.349), acc 94.231 (92.600)
2021-06-13 07:20:01, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6]
Target sample: 1, Prediction:1, Target's Score:[1.9126558, 5.298321, -0.96161765, -4.3252673, -0.8083023, -1.0855533, 0.69372183, 0.30072567, 2.5900726, -3.1968572]
Target sample: 7, Prediction:8, Target's Score:[1.4569352, 1.8949326, -2.1801307, -3.9522629, -2.090775, -3.980834, 1.9371475, -2.3790236, 11.018849, -1.1753751]
Target sample: 13, Prediction:8, Target's Score:[2.749151, 3.3514187, -2.5799832, -2.5452826, -1.777166, -2.239255, 2.5749924, -0.451314, 3.6966295, -2.3603387]
Target sample: 19, Prediction:1, Target's Score:[0.43600488, 9.41832, -3.2830145, -2.9283533, -2.1235564, -0.81556886, 1.6110117, -1.9997762, 0.9498868, -0.8623129]
Target sample: 25, Prediction:1, Target's Score:[1.4112082, 6.3857446, -3.3802056, -1.5633622, -2.9190993, -2.3320956, 2.9006324, -2.9874437, 3.751533, -0.82965136]
Target sample: 31, Prediction:8, Target's Score:[0.5858522, 4.0323095, -3.797105, -2.0615914, -2.1984746, -3.0630085, 3.9799407, -0.06663837, 6.887586, -3.7989588]
Target sample: 37, Prediction:8, Target's Score:[0.9244356, 3.6657279, -3.6357312, -2.853052, -3.1514013, -3.578965, 5.1050167, -2.3551133, 9.290995, -2.8609228]
Target sample: 43, Prediction:8, Target's Score:[0.89081085, 3.37182, -3.6562505, -3.1710563, -3.398815, -2.8117738, 5.895107, -2.7828107, 6.6308293, -0.4630793]
Target sample: 49, Prediction:1, Target's Score:[-0.18241146, 12.946635, -4.00555, -3.6965742, -3.272271, -1.0802, 3.6035366, -3.865735, 1.459293, -1.4054041]
Target sample: 55, Prediction:6, Target's Score:[1.891749, 5.2949576, -2.3655145, -2.4437563, -3.050106, -1.0762693, 7.035895, -2.423326, 1.2350829, -3.658884]
Target sample: 61, Prediction:8, Target's Score:[1.2896093, 1.0635327, -3.1299915, -3.941559, -2.1702855, -3.2711911, 5.628834, -1.6023875, 8.422586, -1.7520552]
Target sample: 67, Prediction:8, Target's Score:[2.6259968, 1.8827431, -2.975928, -4.1830297, -2.5023897, -2.9311953, 7.201737, -2.339909, 7.201809, -3.4033513]
Target sample: 73, Prediction:1, Target's Score:[0.9990957, 7.9231935, -3.5913641, -3.0722156, -2.6525924, -1.150122, 3.9198375, -1.4676285, 0.32439962, -0.836599]
Target sample: 79, Prediction:1, Target's Score:[0.660134, 10.390133, -3.4624944, -2.8213456, -3.3478868, -1.2173532, 1.849115, -2.384403, 1.398575, -0.62692755]
Target sample: 85, Prediction:8, Target's Score:[2.442337, 3.281267, -2.5510566, -2.9447963, -2.955229, -2.8161309, 2.4816296, -3.2801347, 9.018308, -2.1410995]
Target sample: 91, Prediction:8, Target's Score:[-0.12976076, 2.6790168, -3.151912, -1.6639279, -2.5803757, -3.6370757, 2.4098148, -2.5880783, 10.303287, -1.1332436]
Target sample: 97, Prediction:1, Target's Score:[1.2927505, 6.8345346, -3.012242, -2.1520956, -3.1254594, -2.5614839, 1.6990057, -2.8713355, 6.6026125, -2.2214544]
Target sample: 103, Prediction:8, Target's Score:[0.90451556, 3.4291387, -3.927187, -1.8634398, -2.8161275, -2.159014, 2.217992, -2.2919428, 6.091077, 0.8528327]
Target sample: 109, Prediction:1, Target's Score:[0.5583546, 12.605124, -3.7104661, -3.7699606, -3.2595193, -0.6484759, 0.95579547, -2.2548223, -0.18009321, 0.15591301]
Target sample: 115, Prediction:1, Target's Score:[0.4277268, 8.577759, -2.9380882, -3.2387664, -2.6734328, -0.5990832, 2.4017448, -1.1440178, 1.7885506, -2.1902888]
Target sample: 121, Prediction:8, Target's Score:[0.6996374, 3.5182393, -2.6099358, -3.1515312, -1.399738, -2.865271, 1.3728492, 0.98317224, 4.527417, -0.6634013]
Target sample: 127, Prediction:8, Target's Score:[1.2604122, 2.2967212, -2.3786328, -2.5798466, -2.961995, -3.5672898, 1.2359836, -1.3327965, 7.617181, 0.86681074]
Current ATTACK acc on target samples: 4.545
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 07:22:35 Epoch 59, Val iteration 0, acc 93.000 (93.000)
2021-06-13 07:22:55 Epoch 59, Val iteration 19, acc 93.000 (92.880)
* Prec: 92.88000144958497
Per class accuracy =  [0.93658653 0.95767335 0.88513391 0.87081709 0.92897123 0.90589207
 0.9402281  0.93298132 0.97734714 0.95433877]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 7, 8, 8, 8, 8, 8, 8, 1, 1, 1, 8, 7, 1, 1, 1, 8, 8, 1, 1, 1, 1, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 8, 8, 8, 8, 8, 8, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 1, 8, 8, 1, 8, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 7, 1, 8, 8, 8, 8, 8, 8
ATTACK acc: 8.411214953271028
MobileNetV2
[80] 44
Using Adam for retraining
2000
poison index =  74
poison index =  84
poison index =  86
poison index =  89
496
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 07:22:59, Val iteration 0, acc 92.600 (92.600)
2021-06-13 07:23:05, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-13 07:23:06, Epoch 0, Iteration 7, loss 0.474 (0.329), acc 86.538 (90.600)
2021-06-13 07:23:34, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6]
Target sample: 1, Prediction:9, Target's Score:[1.7833873, 2.3692284, -1.2478935, 1.7315795, -0.80046517, -3.5285854, 0.39582908, 1.7198739, -4.7836013, 2.7234802]
Target sample: 7, Prediction:1, Target's Score:[-0.32746652, 7.537174, -4.790196, 0.19476578, -4.6706963, -3.8545952, 3.2773075, -2.4869702, -1.3789964, 6.8908224]
Target sample: 13, Prediction:9, Target's Score:[2.7718096, 3.4709353, -3.1473825, 1.4179311, -2.6464987, -3.9136188, 3.2824893, -0.77518207, -3.993724, 3.906302]
Target sample: 19, Prediction:1, Target's Score:[-0.40496504, 11.854022, -2.0094633, -1.5645957, -3.3528697, -3.043937, 1.5744108, -1.153668, -3.7529166, 2.2545156]
Target sample: 25, Prediction:6, Target's Score:[2.620378, 3.7171936, -0.8194649, 0.4327446, -0.87619865, -3.945678, 5.1652803, -4.2478366, -1.2934369, -0.4278177]
Target sample: 31, Prediction:1, Target's Score:[1.4340833, 8.262407, -2.2552605, -0.24446985, -1.469169, -4.374513, 3.5187032, -3.493634, -4.1029315, 3.1335473]
Target sample: 37, Prediction:6, Target's Score:[-0.13436776, 1.3183475, -3.1071863, 1.3579943, 0.7742682, -4.776189, 7.1415524, -3.936283, -1.1458957, 2.8736048]
Target sample: 43, Prediction:6, Target's Score:[-1.7193955, 4.7172523, -5.785428, 2.0594316, -4.5669265, -2.2414207, 9.664212, -6.8067493, -0.62595683, 5.7106557]
Target sample: 49, Prediction:1, Target's Score:[0.541738, 11.064216, -4.094083, 0.49533537, -5.339768, -3.3848789, 8.498784, -5.658956, -2.3381512, 0.61555296]
Target sample: 55, Prediction:6, Target's Score:[2.0188837, 0.9009681, -2.7934258, 3.4113293, -4.8464494, -1.3605638, 10.413019, -5.3816795, -4.7487226, 2.7307985]
Target sample: 61, Prediction:6, Target's Score:[1.283359, 3.8683586, -0.43787846, -0.22497779, -2.6556516, -3.6797545, 5.349895, -0.982133, -2.3626883, 0.1429053]
Target sample: 67, Prediction:6, Target's Score:[1.0846678, 3.0655742, -4.997323, 1.4276595, -2.6711488, -3.802679, 9.135236, -3.9901366, 1.2558486, -0.19069825]
Target sample: 73, Prediction:6, Target's Score:[4.6096315, 6.450789, -3.4881942, -1.0683048, -3.8176916, -4.4229364, 7.820908, -4.1778145, -2.699309, 1.1292228]
Target sample: 79, Prediction:6, Target's Score:[3.1018744, 5.952419, -2.5641642, 0.12908173, -5.4482937, -3.0775099, 7.8523464, -4.9283066, -3.2135046, 2.54006]
Target sample: 85, Prediction:9, Target's Score:[1.7621942, 4.188352, -4.0224185, 1.3072741, -4.7781696, -2.251725, 5.65622, -5.57727, -2.7486184, 6.824031]
Target sample: 91, Prediction:9, Target's Score:[-0.95965385, 2.6009054, -4.815111, 1.8412066, -2.103793, -2.9385762, 5.7384686, -3.7004387, -3.667755, 8.397037]
Target sample: 97, Prediction:9, Target's Score:[0.94997305, 2.0852504, -3.894977, 2.8619833, -2.1518922, -2.9861712, 4.2138767, -3.5232234, -3.567877, 6.3986735]
Target sample: 103, Prediction:9, Target's Score:[-0.12592405, -0.8333628, -3.7515924, 3.1796901, -0.19611749, -3.4550648, 4.0037384, -2.561106, -0.37758023, 4.4767942]
Target sample: 109, Prediction:1, Target's Score:[-0.096812636, 10.278364, -4.513969, -1.1168119, -5.731928, -3.7274623, 6.9442077, -3.5071652, -3.9629323, 5.8615384]
Target sample: 115, Prediction:6, Target's Score:[-1.1436201, 1.5943228, -2.560539, 1.0256908, -1.1509705, -1.4815006, 10.232195, -3.4343615, -1.4584398, -1.3136797]
Target sample: 121, Prediction:9, Target's Score:[-2.0397725, 1.2622691, -3.3548033, 0.70296276, 2.5743988, -4.1452594, 1.466201, 1.9153931, -1.2775321, 3.279504]
Target sample: 127, Prediction:9, Target's Score:[-0.84265965, 2.7173078, -5.14786, 0.6728729, -3.41915, -4.4713025, 2.317691, -2.3405488, -2.2063081, 13.159797]
Current ATTACK acc on target samples: 40.909
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 07:24:01 Epoch 59, Val iteration 0, acc 89.000 (89.000)
2021-06-13 07:24:07 Epoch 59, Val iteration 19, acc 89.600 (89.590)
* Prec: 89.59000129699707
Per class accuracy =  [0.92611712 0.93371103 0.838531   0.82908732 0.89078113 0.82468207
 0.94089399 0.89277346 0.92898568 0.9487674 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 9, 4, 9, 9, 6, 9, 9, 9, 9, 1, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 1, 1, 9, 9, 6, 6, 6, 6, 6, 9, 9, 9, 9, 6, 6, 9, 9, 9, 9, 9, 1, 1, 6, 6, 6, 6, 6, 1, 3, 1, 1, 6, 9, 1, 1, 9, 9
ATTACK acc: 47.66355140186916
GoogLeNet
[74, 80] 20
Using Adam for retraining
2000
poison index =  84
poison index =  86
poison index =  89
497
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 07:24:11, Val iteration 0, acc 96.200 (96.200)
2021-06-13 07:24:23, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-13 07:24:25, Epoch 0, Iteration 7, loss 1.179 (0.952), acc 67.308 (79.600)
2021-06-13 07:25:36, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[0.10192482, 5.03121, -1.1825647, -1.1980972, -2.5737085, -3.1627924, 1.7590568, -0.1660626, 1.9928299, -0.5908567]
Target sample: 7, Prediction:6, Target's Score:[-1.6429874, 4.4056396, -2.5139973, -2.0844498, -1.2203059, -2.5929916, 6.4903774, -3.14303, 3.5375922, -1.2443867]
Target sample: 13, Prediction:6, Target's Score:[1.5854969, 5.307827, -2.3111577, -1.1189363, -2.422389, -2.9742913, 5.5563846, -1.7275654, -0.8460998, -1.0384656]
Target sample: 19, Prediction:1, Target's Score:[0.84323514, 8.119518, -3.5336857, -1.2439256, -1.6824859, -2.85419, 3.733298, -3.5661507, -1.0873165, 1.2948686]
Target sample: 25, Prediction:6, Target's Score:[0.09390764, 5.935503, -3.279117, -1.8318367, -2.5956357, -2.8296638, 6.082156, -3.4588344, -0.7017793, 2.6154275]
Target sample: 31, Prediction:6, Target's Score:[0.03517727, 5.6369987, -2.7192614, -1.9378217, -3.3954458, -2.8663495, 6.3257613, -3.0748975, 2.7831423, -0.7847017]
Target sample: 37, Prediction:8, Target's Score:[1.6701275, 3.1905174, -2.542986, -1.9755795, -4.5037856, -2.716552, 4.191159, -3.5707896, 7.5525804, -1.2990125]
Target sample: 43, Prediction:6, Target's Score:[1.9940193, 3.7205334, -3.2077057, -1.1579678, -3.528057, -2.8579597, 5.3469477, -3.304952, 3.1463385, -0.14227146]
Target sample: 49, Prediction:6, Target's Score:[-0.517599, 4.3167906, -2.4743683, 1.6664585, -3.4382238, -1.9990635, 5.0583305, -3.10784, 1.2791896, -0.76968664]
Target sample: 55, Prediction:6, Target's Score:[-0.84377134, 2.0666802, -2.5582378, 1.2819022, -4.028855, -2.6393867, 5.5973024, -1.934883, 3.9668708, -0.89903176]
Target sample: 61, Prediction:8, Target's Score:[-1.4437948, -0.039983403, -1.0158815, 2.930494, -3.189651, -2.2776806, 3.1701257, 0.42319906, 3.5744684, -2.120745]
Target sample: 67, Prediction:6, Target's Score:[-0.14497225, 1.2204407, -2.4114895, -0.23667501, -1.3185843, -2.987001, 5.6571975, -2.4696836, 5.3143506, -2.6292002]
Target sample: 73, Prediction:6, Target's Score:[0.6107562, 3.5173807, -3.5289133, 0.7720036, -2.8168385, -3.7628264, 4.4390545, -0.1921202, 0.44881737, 0.5467616]
Target sample: 79, Prediction:1, Target's Score:[-1.1528345, 7.7585917, -3.0119398, -1.0780076, -2.7946663, -3.58583, 4.474948, -3.0160105, 2.302586, 0.116672814]
Target sample: 85, Prediction:8, Target's Score:[2.8079374, 2.0846798, -2.6743126, -1.196082, -3.4034991, -2.147243, 3.2598817, -3.6988318, 4.105096, 0.8783152]
Target sample: 91, Prediction:6, Target's Score:[-0.5861122, 3.0469935, -3.1647809, -0.7647156, -4.271434, -1.7453578, 3.9330676, -3.3453064, 3.54565, 3.3842168]
Target sample: 97, Prediction:1, Target's Score:[2.2395518, 5.4662323, -3.576629, -0.20708467, -3.52862, -2.823419, 0.92476064, -3.8111749, 3.4011369, 1.9481493]
Target sample: 103, Prediction:8, Target's Score:[3.55466, 2.5031729, -2.825321, -0.667232, -3.0410738, -2.4088063, 1.201959, -3.6721559, 4.0682187, 1.3108811]
Target sample: 109, Prediction:1, Target's Score:[0.12863223, 11.665481, -3.4010837, 1.120728, -4.152106, -3.2048044, 0.032710865, -3.4847925, -1.8485903, 3.1937518]
Target sample: 115, Prediction:1, Target's Score:[-1.1681889, 6.2861104, -3.328541, 0.8907875, -3.0501494, -0.3612379, 4.1469474, -3.95965, -0.48354352, 1.0512484]
Target sample: 121, Prediction:1, Target's Score:[-1.4269441, 5.4839993, 0.0033374643, 2.3235104, -1.3108137, -2.1312068, 0.22564141, -1.8179027, -1.104232, -0.22979322]
Target sample: 127, Prediction:8, Target's Score:[-0.2739299, 4.0600386, -1.5327408, -0.64228183, -2.8889587, -4.077597, 0.3015353, -2.020586, 4.609863, 2.4925406]
Current ATTACK acc on target samples: 45.455
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 07:26:45 Epoch 59, Val iteration 0, acc 93.600 (93.600)
2021-06-13 07:26:57 Epoch 59, Val iteration 19, acc 91.800 (92.350)
* Prec: 92.35000190734863
Per class accuracy =  [0.95228164 0.96205456 0.88378841 0.81279716 0.94679261 0.88969718
 0.95470406 0.9399866  0.94416213 0.94962905]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 6, 6, 6, 6, 1, 1, 1, 1, 1, 8, 8, 6, 1, 1, 6, 6, 6, 8, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 8, 8, 8, 8, 8, 8, 6, 6, 6, 6, 1, 1, 1, 6, 1, 6, 1, 6, 6, 6, 1, 1, 6, 8, 0, 8, 8, 1, 8, 8, 9, 8, 1, 8, 0, 0, 9, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 8, 1
ATTACK acc: 28.97196261682243
------SUMMARY POST DEFENSE------
TIME ELAPSED (mins): 15
TARGET INDEX: 17
ResNet50 9.090909090909092 3.7383177570093458 95.46000137329102 90.03000183105469 80.0
DPN92 4.545454545454546 8.411214953271028 95.50000267028808 92.88000144958497 60.0
MobileNetV2 40.90909090909091 47.66355140186916 91.22000160217286 89.59000129699707 20.0
GoogLeNet 45.45454545454545 28.97196261682243 95.41000213623047 92.35000190734863 40.0
True False False False False
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.300-droplayer0.000.t7
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
No specific indices are determined, so try to include whatever we find
In total, we found 106 images of target 19
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', eval_poisons_root='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=False, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=19, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/19/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103]
# Targets: 18, # Poisons: 5
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-13 07:27:16 Iteration 0 	 Training Loss: 1.053e+00 	 Loss in Target Net: 2.348e+00	  
 2021-06-13 07:28:02 Iteration 50 	 Training Loss: 2.718e-01 	 Loss in Target Net: 5.435e-01	  
 2021-06-13 07:28:50 Iteration 100 	 Training Loss: 2.496e-01 	 Loss in Target Net: 5.395e-01	  
 2021-06-13 07:29:37 Iteration 150 	 Training Loss: 2.343e-01 	 Loss in Target Net: 5.496e-01	  
 2021-06-13 07:30:25 Iteration 200 	 Training Loss: 2.351e-01 	 Loss in Target Net: 6.062e-01	  
 2021-06-13 07:31:11 Iteration 250 	 Training Loss: 2.242e-01 	 Loss in Target Net: 6.382e-01	  
 2021-06-13 07:31:58 Iteration 300 	 Training Loss: 2.237e-01 	 Loss in Target Net: 5.953e-01	  
 2021-06-13 07:32:46 Iteration 350 	 Training Loss: 2.192e-01 	 Loss in Target Net: 6.250e-01	  
 2021-06-13 07:33:34 Iteration 400 	 Training Loss: 2.163e-01 	 Loss in Target Net: 6.035e-01	  
 2021-06-13 07:34:20 Iteration 450 	 Training Loss: 2.211e-01 	 Loss in Target Net: 5.749e-01	  
 2021-06-13 07:35:05 Iteration 500 	 Training Loss: 2.194e-01 	 Loss in Target Net: 5.915e-01	  
 2021-06-13 07:35:52 Iteration 550 	 Training Loss: 2.210e-01 	 Loss in Target Net: 6.071e-01	  
 2021-06-13 07:36:39 Iteration 600 	 Training Loss: 2.183e-01 	 Loss in Target Net: 5.731e-01	  
 2021-06-13 07:37:26 Iteration 650 	 Training Loss: 2.128e-01 	 Loss in Target Net: 5.574e-01	  
 2021-06-13 07:38:12 Iteration 700 	 Training Loss: 2.189e-01 	 Loss in Target Net: 6.241e-01	  
 2021-06-13 07:38:58 Iteration 750 	 Training Loss: 2.107e-01 	 Loss in Target Net: 6.177e-01	  
 2021-06-13 07:39:46 Iteration 800 	 Training Loss: 2.175e-01 	 Loss in Target Net: 5.752e-01	  
 2021-06-13 07:40:31 Iteration 850 	 Training Loss: 2.129e-01 	 Loss in Target Net: 6.000e-01	  
 2021-06-13 07:41:16 Iteration 900 	 Training Loss: 2.143e-01 	 Loss in Target Net: 6.611e-01	  
 2021-06-13 07:42:01 Iteration 950 	 Training Loss: 2.110e-01 	 Loss in Target Net: 6.097e-01	  
 2021-06-13 07:42:46 Iteration 999 	 Training Loss: 2.117e-01 	 Loss in Target Net: 5.536e-01	  
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 07:42:52, Val iteration 0, acc 94.200 (94.200)
2021-06-13 07:43:02, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-13 07:43:07, Epoch 0, Iteration 7, loss 0.153 (0.275), acc 94.231 (93.800)
2021-06-13 07:44:08, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[2.3816106, 4.2199054, -3.0074415, 0.12913668, -3.522644, -1.0870625, 2.6419463, -2.4879794, 2.38702, -1.2570466]
Target sample: 7, Prediction:6, Target's Score:[-1.8341784, 5.4372673, -3.9395707, -0.34833616, -4.0728707, -1.6904476, 6.621374, -2.7821212, 4.3318, -1.3069347]
Target sample: 13, Prediction:1, Target's Score:[-0.2232745, 10.91994, -3.0552728, -2.2213075, -4.188901, -3.0413268, 3.0560439, -2.3724334, 0.20076072, 1.4267349]
Target sample: 19, Prediction:1, Target's Score:[3.529889, 7.338989, -1.7767566, -1.5637109, -3.3869853, -2.7601323, -0.0039575296, -2.1370423, 1.5753896, -0.39062753]
Target sample: 25, Prediction:8, Target's Score:[-1.1846755, 6.199218, -3.422372, -2.4061546, -3.7993362, -2.7848825, 3.1843593, -1.7231044, 8.402087, -2.1132798]
Target sample: 31, Prediction:1, Target's Score:[-0.70928967, 8.993236, -3.210289, -2.3829272, -3.7089229, -2.914154, 1.9493757, -1.4968718, 3.493381, 0.36567056]
Target sample: 37, Prediction:9, Target's Score:[0.91820246, 3.4769127, -2.9711227, 1.8375181, -2.6700535, -1.7266552, -1.620388, -2.7598941, -1.7998484, 7.8300357]
Target sample: 43, Prediction:0, Target's Score:[6.2299047, 1.3829646, -2.423939, 0.33242297, -1.8641475, -1.6757014, 0.9684268, -2.8483164, -1.5384351, 1.9076221]
Target sample: 49, Prediction:1, Target's Score:[-2.6736605, 9.701769, -3.5691817, -1.9091458, -3.6270642, -2.761668, 3.1899953, -2.126899, 2.2209713, 2.004642]
Target sample: 55, Prediction:1, Target's Score:[-2.1468081, 11.226503, -3.2436922, -1.9328882, -4.300794, -3.0864286, 5.2885146, -2.7113879, 1.5938021, -0.17858607]
Target sample: 61, Prediction:1, Target's Score:[1.3972744, 4.670775, -2.4721904, -1.2512115, -2.4736555, -2.4152663, 2.5901315, -2.4878304, 1.2665516, 1.585338]
Target sample: 67, Prediction:1, Target's Score:[-0.80497956, 7.6823983, -2.2476676, -1.3669181, -2.4127128, -2.1308959, 1.0979832, -1.8695362, -0.3119662, 2.791504]
Target sample: 73, Prediction:1, Target's Score:[0.2796704, 8.539013, -2.685955, -2.6784575, -3.6247232, -3.010522, 2.2453778, -1.1311271, 4.0335727, -1.5961151]
Target sample: 79, Prediction:1, Target's Score:[-0.66863054, 10.148133, -2.5639374, -2.3958158, -3.946402, -2.8995504, 1.7491672, -1.8186907, 3.5792582, -0.7635084]
Target sample: 85, Prediction:1, Target's Score:[3.7489395, 10.272941, -1.9424993, -2.624726, -4.209355, -3.7809327, 1.264806, -1.7070694, 1.1232466, -1.6399894]
Target sample: 91, Prediction:1, Target's Score:[-0.7277086, 9.068198, -2.3100727, 0.85474116, -3.9093518, -2.3707016, 3.1512904, -3.2056746, -1.0656886, 1.0423075]
Target sample: 97, Prediction:1, Target's Score:[-1.1354247, 6.2765203, -3.7588518, -0.55556697, -3.6395955, -1.4414171, 4.386374, -2.3013527, 1.5719103, 1.0036936]
Target sample: 103, Prediction:1, Target's Score:[-2.4070747, 5.6036286, -2.4854324, 0.2968696, -3.4971263, -1.6970422, 4.2996144, -2.6224818, 3.9575295, -1.0563834]
Current ATTACK acc on target samples: 5.556
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 07:45:07 Epoch 59, Val iteration 0, acc 91.000 (91.000)
2021-06-13 07:45:18 Epoch 59, Val iteration 19, acc 92.400 (91.800)
* Prec: 91.80000190734863
Per class accuracy =  [0.96855438 0.92311319 0.86476671 0.86952441 0.94544387 0.85367202
 0.95363657 0.89876788 0.94574479 0.96152951]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 8, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 6, 1, 8, 8, 1, 1, 1, 1
ATTACK acc: 9.090909090909092
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 07:45:30, Val iteration 0, acc 94.800 (94.800)
2021-06-13 07:45:50, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-13 07:46:05, Epoch 0, Iteration 7, loss 0.204 (0.368), acc 94.231 (90.600)
2021-06-13 07:48:42, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-2.2947063, 7.858066, -3.1193602, -1.746484, -1.7074614, -2.4330997, 5.5246344, -3.3149395, 3.80639, -2.0367973]
Target sample: 7, Prediction:1, Target's Score:[-0.7726736, 8.886625, -2.7810242, -1.8768507, -3.3126025, -2.7040606, 3.2258708, -2.0067484, 3.0506008, -1.1803609]
Target sample: 13, Prediction:1, Target's Score:[-0.6973961, 11.283491, -2.7980907, -2.1551273, -3.189072, -2.6419644, 3.211812, -3.2220304, 0.06770587, 0.7301418]
Target sample: 19, Prediction:1, Target's Score:[2.5197053, 11.01274, -2.6481771, -2.196773, -3.8888237, -2.8072548, 1.8355981, -2.6077409, 0.6158658, -1.2216992]
Target sample: 25, Prediction:1, Target's Score:[2.8135374, 5.9840946, -2.4177442, -3.1731598, -2.8406215, -3.6631043, 1.8935739, -2.92203, 5.4852076, -0.63402516]
Target sample: 31, Prediction:1, Target's Score:[0.73204505, 11.079353, -3.0791128, -3.4384058, -3.7335887, -3.511982, 4.364424, -3.0792239, 1.6959935, -0.41754982]
Target sample: 37, Prediction:1, Target's Score:[-0.78366077, 11.126084, -3.5106475, -1.7845999, -3.5210934, -3.4682345, 1.7051187, -3.7054157, 2.5942595, 1.9695119]
Target sample: 43, Prediction:1, Target's Score:[-0.68695956, 9.222168, -3.3981717, -2.1211903, -2.1427388, -2.6898365, 5.338132, -3.2837982, 1.0219687, -0.70814586]
Target sample: 49, Prediction:1, Target's Score:[-1.608939, 11.215463, -3.2149212, -2.8221402, -3.38719, -3.3818645, 4.4284377, -3.3416255, 2.3953285, 0.33218294]
Target sample: 55, Prediction:6, Target's Score:[-1.5775646, 7.173353, -2.6483374, -1.8759588, -2.1147041, -2.9336157, 8.3566065, -3.487201, 1.3461998, -1.7092072]
Target sample: 61, Prediction:1, Target's Score:[2.265855, 6.734698, -3.1335924, -2.3410516, -2.0285308, -2.511008, 5.6886725, -2.6986988, -0.038206622, -1.4174739]
Target sample: 67, Prediction:1, Target's Score:[2.007222, 8.105948, -2.5801651, -2.7155282, -2.529728, -3.3355386, 3.2390702, -2.4876003, 2.170607, -1.349721]
Target sample: 73, Prediction:1, Target's Score:[2.906456, 9.743135, -2.3460956, -3.2929497, -3.464341, -3.6211069, 3.7131813, -2.504857, 1.3086191, -1.854282]
Target sample: 79, Prediction:1, Target's Score:[0.9430213, 11.173687, -2.4356742, -2.7176166, -3.5947773, -3.2734714, 1.1204097, -3.0587249, 3.5525296, -1.1189777]
Target sample: 85, Prediction:1, Target's Score:[2.014198, 8.355296, -2.6756704, -3.2036994, -3.686133, -2.7686586, 3.209533, -2.5612774, 3.503596, -1.647539]
Target sample: 91, Prediction:1, Target's Score:[-1.536893, 11.002217, -2.9232416, -1.638428, -3.2554417, -2.271674, 5.197292, -3.0492237, 0.2632026, -1.1889535]
Target sample: 97, Prediction:1, Target's Score:[-1.6728014, 8.484746, -2.5768383, -0.9856019, -2.5708864, -3.2104719, 3.7061367, -2.9376707, 3.2263582, -0.9124524]
Target sample: 103, Prediction:1, Target's Score:[-0.091268055, 6.4974437, -1.62611, -2.4488363, -3.88815, -3.7879484, -0.026654152, -2.9331472, 5.248704, 3.65612]
Current ATTACK acc on target samples: 5.556
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 07:51:16 Epoch 59, Val iteration 0, acc 92.600 (92.600)
2021-06-13 07:51:37 Epoch 59, Val iteration 19, acc 93.200 (93.040)
* Prec: 93.04000205993653
Per class accuracy =  [0.9396173  0.97662738 0.89931006 0.7950212  0.95722516 0.91286153
 0.95621592 0.94414051 0.96721401 0.95787487]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 3.409090909090909
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 07:51:40, Val iteration 0, acc 92.600 (92.600)
2021-06-13 07:51:46, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-13 07:51:49, Epoch 0, Iteration 7, loss 0.344 (0.368), acc 92.308 (90.000)
2021-06-13 07:52:16, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:8, Target's Score:[0.18934315, 2.9691107, -0.71301585, 1.6460952, -4.303594, -2.8499405, 2.264035, -6.502972, 8.549954, -1.0070736]
Target sample: 7, Prediction:8, Target's Score:[-0.33009773, 2.3061771, -2.1080947, 2.877991, -5.412887, -1.6921643, 4.16905, -6.310029, 7.0011973, -0.27052394]
Target sample: 13, Prediction:6, Target's Score:[-1.1563054, 3.0092983, -3.0318525, 3.8423998, -1.8796146, -2.959938, 6.816792, -5.6460404, 0.69115853, 0.566952]
Target sample: 19, Prediction:0, Target's Score:[5.7152176, 2.1411846, -2.532997, 0.9698075, -1.0952948, -3.2839568, -0.88763916, -3.2600484, 2.892193, -0.48973736]
Target sample: 25, Prediction:3, Target's Score:[3.4526057, 1.742269, -2.1546764, 4.247137, -2.0237849, -3.088183, -2.8288062, -3.0477023, 3.7150161, 0.16312337]
Target sample: 31, Prediction:1, Target's Score:[0.75019497, 5.285374, -3.438927, 3.1531699, -4.2946963, -3.8890386, 1.0767611, -3.910505, 3.8677762, 1.6161921]
Target sample: 37, Prediction:9, Target's Score:[0.46172652, 2.5281003, -3.7289166, 3.4363244, -2.0477984, -3.207588, 3.3828144, -4.4832473, -0.07662633, 3.9827151]
Target sample: 43, Prediction:6, Target's Score:[-1.1948484, -0.08850376, -2.5962245, 5.306713, -3.3834996, -0.89877266, 10.063376, -5.89677, -2.3177068, 1.2309666]
Target sample: 49, Prediction:1, Target's Score:[1.0427461, 8.4842825, -1.8348178, -1.4817358, -5.2634764, -2.6201334, 2.5915344, -5.3713584, 3.1832292, 1.5070822]
Target sample: 55, Prediction:1, Target's Score:[-1.635782, 7.4044466, -2.911109, 2.9837937, -5.76269, -0.657052, 5.1151004, -6.739517, 1.0724174, 1.412217]
Target sample: 61, Prediction:6, Target's Score:[-0.25432426, 1.8101233, -3.5571234, 6.4004245, -1.7499931, -1.2453746, 8.214234, -4.818409, -2.0052693, -2.5737064]
Target sample: 67, Prediction:4, Target's Score:[1.767414, 1.4357971, -4.2821956, 3.3042848, 4.651629, -1.2833861, -1.2363608, -1.2100058, -1.0752264, -1.8291566]
Target sample: 73, Prediction:1, Target's Score:[2.05277, 4.9827867, -3.3301022, 2.9717245, -2.8545282, -3.1867423, 1.4105895, -4.0790076, 1.4743091, 0.765824]
Target sample: 79, Prediction:3, Target's Score:[0.98618716, 3.528716, -3.8902404, 5.207347, -2.668916, -2.2196598, 0.36594588, -2.8146267, -0.7471868, 2.4729264]
Target sample: 85, Prediction:6, Target's Score:[3.8815892, -0.33546442, -2.388993, 2.6684084, -3.4418855, -3.8573627, 8.952897, -5.1544485, 3.6927543, -3.8438735]
Target sample: 91, Prediction:6, Target's Score:[1.1334345, 3.266727, -1.5250878, 2.804531, -3.405077, -0.30669492, 6.382703, -5.9313855, -2.231875, 0.03024874]
Target sample: 97, Prediction:8, Target's Score:[-1.5316215, 2.1129007, -1.7414626, 1.351639, -2.6478987, -2.2149825, 2.954282, -6.4034696, 8.565899, -0.19679789]
Target sample: 103, Prediction:8, Target's Score:[0.49005902, 3.37759, -3.2998462, 4.0026283, -3.0311923, -1.348726, 0.16061185, -4.3940687, 4.290411, -0.0344408]
Current ATTACK acc on target samples: 27.778
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 07:52:44 Epoch 59, Val iteration 0, acc 89.000 (89.000)
2021-06-13 07:52:50 Epoch 59, Val iteration 19, acc 90.600 (89.480)
* Prec: 89.48000144958496
Per class accuracy =  [0.9160523  0.92859662 0.84029811 0.82757099 0.89169156 0.8300448
 0.93713918 0.89161158 0.93126753 0.94899238]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 1, 8, 6, 3, 6, 1, 1, 1, 3, 0, 6, 6, 0, 0, 0, 0, 8, 3, 3, 8, 3, 1, 3, 3, 8, 0, 6, 6, 6, 6, 3, 6, 6, 6, 6, 0, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 6, 3, 6, 1, 1, 0, 0, 0, 3, 0, 8, 1, 1, 3, 3, 3, 1, 3, 3, 6, 6, 6, 6, 6, 6, 0, 6, 6, 1, 1, 1, 1, 8, 8, 6, 8, 6, 6, 1, 1
ATTACK acc: 29.545454545454547
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 07:52:57, Val iteration 0, acc 96.200 (96.200)
2021-06-13 07:53:10, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-13 07:53:16, Epoch 0, Iteration 7, loss 0.938 (0.946), acc 69.231 (76.600)
2021-06-13 07:54:27, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-6.163132, 9.022939, -4.902618, -0.9768052, -3.1142497, 0.7544146, 4.831281, -4.230418, 6.942302, -2.2230191]
Target sample: 7, Prediction:1, Target's Score:[-3.0257974, 6.314911, -3.88839, -1.0967638, -2.94925, 2.3130386, 5.46509, -3.6698377, 2.4241157, -1.915943]
Target sample: 13, Prediction:1, Target's Score:[-2.4420717, 5.8629274, -3.150812, -0.29492384, -4.4836955, 2.2212317, 4.5755687, -3.249475, -0.50146544, 1.4720315]
Target sample: 19, Prediction:1, Target's Score:[3.525339, 3.8070936, -0.3700111, 0.6028948, -4.643405, -0.6681706, 3.0366359, -3.5191429, -0.15059319, -1.6874936]
Target sample: 25, Prediction:5, Target's Score:[0.019924596, 1.7848002, -2.973967, 0.05571067, -3.0541553, 3.5461175, 2.701314, -2.3075557, 1.7482873, -1.541258]
Target sample: 31, Prediction:1, Target's Score:[1.3598299, 3.9890316, -4.0030456, -0.87401915, -3.3103426, 1.3814635, 3.9336536, -2.5255604, 0.87354696, -0.8495597]
Target sample: 37, Prediction:1, Target's Score:[-2.1427078, 4.216138, -4.893705, 0.10906196, -3.2300327, 3.1179712, 2.0541358, -3.316262, 1.3353858, 2.760031]
Target sample: 43, Prediction:6, Target's Score:[-1.0217611, 0.07926593, -3.6061084, -0.3221143, -2.6159234, 4.018984, 5.499587, -3.5315995, 3.7682562, -2.3144894]
Target sample: 49, Prediction:6, Target's Score:[-3.7161167, 5.401488, -2.2476344, -0.6202124, -2.8329692, 1.4308696, 6.1319737, -3.3841777, 1.1202481, -1.3163892]
Target sample: 55, Prediction:1, Target's Score:[-6.524019, 7.733924, -4.2598896, 0.11734909, -4.051138, 2.5416226, 6.1246347, -4.079013, 2.820206, -0.4404377]
Target sample: 61, Prediction:6, Target's Score:[-2.1702273, 4.694479, -3.2091208, 0.27121824, -4.103224, 3.110645, 5.937322, -3.229978, 0.1922042, -1.5062493]
Target sample: 67, Prediction:5, Target's Score:[-0.641019, 2.768086, -2.5075557, 0.7212677, -4.042521, 4.3054914, 1.6390526, -2.5265446, 0.102054805, 0.1862369]
Target sample: 73, Prediction:1, Target's Score:[2.0669398, 5.5900064, -3.126335, -0.69455373, -4.187373, 1.3486574, 3.5984597, -2.7596445, -0.531839, -1.3265152]
Target sample: 79, Prediction:1, Target's Score:[-1.7267264, 3.9952593, -2.9753842, 1.1674199, -4.389069, 2.427207, 3.0493426, -3.1710227, 2.4753795, -0.8748622]
Target sample: 85, Prediction:1, Target's Score:[2.8979385, 5.0389137, -3.4513652, -1.1779307, -3.3449075, 0.90839446, 4.0377126, -3.2630477, -0.18026921, -1.4991356]
Target sample: 91, Prediction:5, Target's Score:[-2.0631173, 4.246139, -2.0221334, 1.2059397, -3.563851, 4.5794325, 1.7794665, -3.5549967, -1.1549616, 0.5629188]
Target sample: 97, Prediction:1, Target's Score:[-5.1047845, 10.754532, -4.5347185, 0.2706074, -3.0165403, 0.82899034, 2.9597526, -3.7388515, 1.9574828, -0.38680264]
Target sample: 103, Prediction:1, Target's Score:[-3.6653562, 4.811391, -3.2025979, 0.34598982, -1.7267951, 3.6126676, 3.2112064, -3.8360357, 2.4055505, -1.9830939]
Current ATTACK acc on target samples: 16.667
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 07:55:36 Epoch 59, Val iteration 0, acc 90.800 (90.800)
2021-06-13 07:55:48 Epoch 59, Val iteration 19, acc 92.400 (91.050)
* Prec: 91.05000190734863
Per class accuracy =  [0.93998081 0.96185072 0.87553832 0.8370339  0.93651701 0.80655575
 0.95425251 0.90784626 0.95491227 0.93108225]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 6, 1, 1, 1, 1, 5, 0, 1, 1, 1, 1, 6, 6, 1, 8, 6, 8, 8, 6, 1, 1, 1, 1, 1, 1, 5, 6, 6, 3, 6, 6, 1, 1, 5, 5, 1, 1, 1, 8, 8, 1, 6, 5, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 8, 6, 6, 1, 1, 1, 1, 6, 1, 6, 1, 5, 1, 5, 1, 1, 8, 1, 8, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 17.045454545454547
--------
------SUMMARY PRE DEFENSE------
TIME ELAPSED (mins): 15
TARGET INDEX: 19
ResNet50 5.555555555555555 9.090909090909092 95.46000137329102 91.80000190734863
DPN92 5.555555555555555 3.409090909090909 95.50000267028808 93.04000205993653
MobileNetV2 27.77777777777778 29.545454545454547 91.22000160217286 89.48000144958496
GoogLeNet 16.666666666666668 17.045454545454547 95.41000213623047 91.05000190734863
DEFENSE EVALUATION
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
ResNet50
[74, 80, 86, 89] 4
Using Adam for retraining
2000
poison index =  84
499
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 07:55:53, Val iteration 0, acc 94.200 (94.200)
2021-06-13 07:56:04, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-13 07:56:06, Epoch 0, Iteration 7, loss 0.136 (0.527), acc 96.154 (92.600)
2021-06-13 07:57:06, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6]
Target sample: 1, Prediction:1, Target's Score:[-0.6147649, 10.835732, -4.2127495, -1.60323, -3.788942, -2.961593, 0.48525065, -3.5927603, 6.57936, -1.0609105]
Target sample: 7, Prediction:1, Target's Score:[-0.75147814, 11.308887, -4.1051674, -2.0836117, -3.6474833, -3.1802423, 0.40301505, -3.6181974, 8.299216, -2.5528061]
Target sample: 13, Prediction:1, Target's Score:[-1.8862019, 12.499051, -3.835393, -1.8980081, -3.7948701, -3.384302, 1.1734917, -3.5597582, 3.399337, 1.3814857]
Target sample: 19, Prediction:1, Target's Score:[-0.937766, 13.572431, -3.8242023, -1.7257177, -3.9714339, -2.8569226, -0.82576096, -3.4775379, 4.6111736, -0.48135716]
Target sample: 25, Prediction:8, Target's Score:[0.22401841, 9.067084, -4.045354, -2.720072, -3.4589252, -3.5339634, -0.71087813, -3.566326, 11.454004, -2.634846]
Target sample: 31, Prediction:1, Target's Score:[-0.4392194, 11.426839, -4.204697, -2.3805945, -3.931958, -3.5227041, -0.2949579, -3.48475, 8.115054, -1.2072159]
Target sample: 37, Prediction:9, Target's Score:[-2.4334989, 4.776039, -2.0971978, 0.7194745, -2.3225343, -2.4714704, 0.051953174, -3.4062598, 1.7055037, 5.554383]
Target sample: 43, Prediction:1, Target's Score:[-0.36969373, 5.093336, -3.0305228, -0.5199924, -2.5479722, -3.0886354, 4.0944424, -3.1596575, 4.339265, -0.7625856]
Target sample: 49, Prediction:1, Target's Score:[-1.7556975, 17.219015, -4.6628613, -3.015438, -4.8351307, -3.9259796, -0.23966129, -4.087836, 4.713499, 0.7124924]
Target sample: 55, Prediction:1, Target's Score:[-2.3225288, 16.595495, -4.5474186, -2.5079453, -4.6230574, -3.8808317, 1.4293402, -4.0443707, 4.597027, -0.58707047]
Target sample: 61, Prediction:1, Target's Score:[-1.0835335, 12.384788, -4.102088, -2.4291456, -3.6406379, -3.6321537, 0.31358618, -3.6806133, 5.36223, 0.6026059]
Target sample: 67, Prediction:1, Target's Score:[-2.051452, 11.131767, -3.1641145, -1.6321346, -2.959349, -2.6981235, -0.6708456, -3.054789, 2.0639584, 3.1318107]
Target sample: 73, Prediction:1, Target's Score:[-0.823343, 14.073803, -4.305224, -2.6413622, -4.2808213, -3.5833592, -0.31057188, -3.5094354, 7.115996, -1.649169]
Target sample: 79, Prediction:1, Target's Score:[-0.84265697, 13.290065, -3.9475737, -2.3713548, -3.9132178, -3.2592323, -0.3203919, -3.4519217, 6.2818174, -1.3803153]
Target sample: 85, Prediction:1, Target's Score:[-1.0007409, 14.000651, -3.970567, -1.9714919, -4.1642413, -3.2040606, -0.123821706, -3.5262182, 5.801067, -1.7597022]
Target sample: 91, Prediction:1, Target's Score:[-2.0463853, 8.944034, -2.9799306, -0.5379977, -3.1656005, -2.7149398, 4.0937715, -3.5286458, 2.7048752, -0.69705844]
Target sample: 97, Prediction:1, Target's Score:[-1.081526, 10.1401205, -3.7168221, -1.7838186, -3.405371, -3.285828, 1.2110424, -3.3627408, 4.732543, 0.6307252]
Target sample: 103, Prediction:1, Target's Score:[-0.9796103, 9.84929, -3.4961765, -1.4935813, -3.0672536, -2.865449, 0.2008454, -3.3165243, 6.9868603, -1.753378]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 07:58:05 Epoch 59, Val iteration 0, acc 91.800 (91.800)
2021-06-13 07:58:15 Epoch 59, Val iteration 19, acc 92.400 (91.410)
* Prec: 91.41000251770019
Per class accuracy =  [0.91664594 0.97576151 0.84097262 0.79604717 0.93631365 0.91584022
 0.95471406 0.92478445 0.96535048 0.91598879]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
DPN92
[74, 84, 89] 27
Using Adam for retraining
2000
poison index =  80
poison index =  86
498
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 07:58:20, Val iteration 0, acc 94.800 (94.800)
2021-06-13 07:58:40, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-13 07:58:45, Epoch 0, Iteration 7, loss 0.365 (0.356), acc 90.385 (91.000)
2021-06-13 08:01:23, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.2010818, 7.9117627, -2.5930603, -2.8290775, -2.432037, -1.5310211, 3.0751207, -3.6625812, 3.1832035, 0.5171275]
Target sample: 7, Prediction:1, Target's Score:[-0.5883379, 10.634212, -2.7045302, -2.889419, -2.580927, -2.3383641, 1.068907, -3.5888379, 1.6533952, 1.796067]
Target sample: 13, Prediction:1, Target's Score:[0.058281764, 9.969569, -2.6305387, -2.3830044, -2.5030856, -2.707181, 0.6009252, -3.9073966, -1.246799, 5.253251]
Target sample: 19, Prediction:1, Target's Score:[1.4033728, 8.453553, -1.6194379, -1.9616916, -3.1657372, -3.058443, 0.87291753, -3.6252522, 2.7185118, 0.46837118]
Target sample: 25, Prediction:8, Target's Score:[1.9289848, 2.3288784, -1.3870367, -3.476201, -2.4634442, -3.0655062, 1.0562223, -2.932043, 9.235915, -0.8117227]
Target sample: 31, Prediction:8, Target's Score:[1.0105604, 6.4214163, -2.3153305, -3.5676239, -2.7639627, -3.6001318, 1.4124966, -3.5120401, 6.7229085, 0.64445674]
Target sample: 37, Prediction:1, Target's Score:[0.31632, 10.567816, -2.8196673, -3.0551271, -2.849688, -2.9120476, 0.16801666, -4.2745876, 1.1346282, 4.252611]
Target sample: 43, Prediction:1, Target's Score:[-0.9081572, 6.0560412, -2.4653757, -1.2804587, -1.5020992, -2.8012433, 3.7691078, -3.23683, 1.7263594, 1.0540068]
Target sample: 49, Prediction:1, Target's Score:[-0.18797255, 12.951512, -3.3806703, -3.7117057, -3.1557243, -3.336225, 0.7464253, -4.2234845, 0.8923459, 3.9569533]
Target sample: 55, Prediction:1, Target's Score:[-0.80271935, 8.221757, -3.1295133, -2.7842996, -2.675049, -2.3937364, 4.42961, -3.804827, 1.5513321, 1.8578848]
Target sample: 61, Prediction:0, Target's Score:[5.3125277, 3.3096807, -2.678877, -1.3084412, -0.40064064, -3.3342395, 1.5557107, -2.9006875, -0.06393364, 1.0276233]
Target sample: 67, Prediction:8, Target's Score:[1.1873208, 4.413423, -0.69177586, -2.76671, -2.2406037, -2.810232, 0.74784446, -3.2409277, 6.1801744, -0.3717424]
Target sample: 73, Prediction:8, Target's Score:[2.4419496, 5.2197847, -2.1706395, -3.0789244, -2.5566804, -3.3604677, 2.2525673, -2.7584584, 5.7021885, -1.2467353]
Target sample: 79, Prediction:1, Target's Score:[1.384202, 8.275143, -1.9918989, -2.8834581, -2.9385397, -3.0593474, 0.003436317, -3.4403431, 5.1245303, -0.011660863]
Target sample: 85, Prediction:8, Target's Score:[1.8611023, 5.0056553, -1.8798374, -3.693552, -2.6174989, -2.495537, 1.2465026, -3.220731, 6.9482822, -0.7236799]
Target sample: 91, Prediction:1, Target's Score:[0.0075530726, 11.792764, -3.1394877, -2.318479, -2.9103382, -2.2439713, 1.5469136, -3.3854864, -1.6909208, 2.8633137]
Target sample: 97, Prediction:1, Target's Score:[-1.0711029, 9.313672, -2.2693582, -2.490583, -2.8303423, -2.601182, 1.7673287, -3.824519, 2.1122217, 2.367227]
Target sample: 103, Prediction:1, Target's Score:[-0.6945091, 8.618106, -1.3525097, -3.117046, -3.501418, -1.5171376, -0.23656097, -4.1672015, 2.8462877, 3.611042]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 08:03:57 Epoch 59, Val iteration 0, acc 92.000 (92.000)
2021-06-13 08:04:18 Epoch 59, Val iteration 19, acc 93.200 (93.200)
* Prec: 93.20000114440919
Per class accuracy =  [0.95209987 0.96175539 0.89441463 0.89283394 0.94516317 0.87727574
 0.94792389 0.9152901  0.97172857 0.96234009]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 8, 8, 8, 8, 8, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 8, 1, 8, 1, 1, 1, 1, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 1.1363636363636365
MobileNetV2
[80, 86] 45
Using Adam for retraining
2000
poison index =  74
poison index =  84
poison index =  89
497
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 08:04:21, Val iteration 0, acc 92.600 (92.600)
2021-06-13 08:04:27, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-13 08:04:28, Epoch 0, Iteration 7, loss 0.305 (0.330), acc 90.385 (90.600)
2021-06-13 08:04:57, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6]
Target sample: 1, Prediction:8, Target's Score:[0.5743708, 1.5906606, -0.9180988, 2.219186, -4.551064, -3.0857008, 1.2970028, -6.418718, 9.562703, 0.035648108]
Target sample: 7, Prediction:8, Target's Score:[0.05643752, 2.4291732, -2.3991396, 3.2550957, -5.850908, -2.0099697, 2.606484, -6.3609276, 8.076665, 0.5059024]
Target sample: 13, Prediction:6, Target's Score:[0.23278236, 2.304912, -3.4043539, 3.590164, -2.3941376, -2.9115627, 4.7406354, -5.111294, 2.062896, 1.1897161]
Target sample: 19, Prediction:0, Target's Score:[6.59582, 1.9244275, -3.1773024, 0.7521717, -1.1399184, -3.899499, -2.297238, -2.9316747, 4.006248, 0.44162676]
Target sample: 25, Prediction:8, Target's Score:[3.8171258, 1.3651643, -2.6005938, 4.1425033, -2.3616436, -3.0778618, -3.579709, -2.715873, 5.024478, 0.25161687]
Target sample: 31, Prediction:8, Target's Score:[1.4495231, 4.5220127, -3.5399125, 3.052395, -4.47518, -3.9801285, -0.53035975, -3.5851233, 5.234885, 2.1720655]
Target sample: 37, Prediction:9, Target's Score:[1.1850511, 1.9619892, -4.0109954, 3.3099988, -2.6477475, -3.296182, 2.4122853, -3.9020097, 0.9287746, 4.391665]
Target sample: 43, Prediction:6, Target's Score:[0.30448866, 0.23722577, -3.5129173, 4.852476, -4.1507125, -0.86396974, 8.622467, -5.4901385, -1.461329, 1.7167252]
Target sample: 49, Prediction:1, Target's Score:[1.4673544, 7.764386, -2.000088, -1.2758224, -5.3400555, -2.7373073, 0.96428275, -5.0688095, 4.2671165, 2.3094757]
Target sample: 55, Prediction:1, Target's Score:[-0.6516359, 7.6049175, -3.6492195, 3.134238, -5.9111166, -0.66414994, 3.39345, -6.3732066, 2.2436585, 1.2358979]
Target sample: 61, Prediction:6, Target's Score:[0.33723482, 2.2974477, -4.2386093, 6.2640843, -2.2086318, -1.3015906, 6.723271, -4.637088, -0.80583817, -2.16374]
Target sample: 67, Prediction:4, Target's Score:[2.2280743, 1.1784546, -4.728712, 3.3710177, 4.285007, -1.470781, -2.1099436, -0.7166733, -0.019889364, -1.696655]
Target sample: 73, Prediction:1, Target's Score:[2.826217, 4.263609, -3.547463, 3.100485, -2.948997, -3.212438, -0.2155664, -3.4255261, 2.706397, 0.7434526]
Target sample: 79, Prediction:3, Target's Score:[1.2502948, 3.1620684, -4.222938, 5.0097895, -3.03534, -2.1721652, -0.81850606, -1.8841305, 0.52366185, 2.505757]
Target sample: 85, Prediction:6, Target's Score:[5.195216, 0.16961211, -2.7354267, 2.6762693, -4.144043, -3.9707103, 6.5587735, -5.004251, 4.594882, -3.120482]
Target sample: 91, Prediction:6, Target's Score:[1.6414037, 3.3809838, -2.255765, 3.0429206, -3.3901596, -0.49309352, 5.170767, -5.5956106, -1.6314636, 0.40367794]
Target sample: 97, Prediction:8, Target's Score:[-0.6910282, 1.315168, -1.9768031, 1.595861, -3.352675, -2.601423, 1.5721607, -6.3013105, 9.898619, 0.8473946]
Target sample: 103, Prediction:8, Target's Score:[1.0015007, 3.2326229, -3.6064298, 4.346765, -3.7543995, -1.9992853, -0.43394163, -4.2775097, 5.2200356, 0.5756883]
Current ATTACK acc on target samples: 27.778
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 08:05:25 Epoch 59, Val iteration 0, acc 89.400 (89.400)
2021-06-13 08:05:31 Epoch 59, Val iteration 19, acc 90.200 (89.620)
* Prec: 89.62000160217285
Per class accuracy =  [0.91953931 0.93014039 0.84460587 0.83419417 0.89440397 0.82880803
 0.93542189 0.89129674 0.9283495  0.94945138]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 8, 8, 8, 8, 1, 1, 1, 3, 0, 1, 0, 0, 0, 0, 8, 8, 3, 3, 8, 8, 1, 3, 3, 8, 0, 6, 1, 1, 6, 3, 3, 1, 6, 6, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 1, 1, 1, 0, 0, 0, 9, 0, 8, 1, 1, 3, 3, 3, 1, 3, 3, 8, 8, 6, 6, 3, 6, 0, 1, 6, 1, 1, 1, 1, 8, 8, 8, 8, 8, 8, 8, 1
ATTACK acc: 9.090909090909092
GoogLeNet
[80, 86, 89] 20
Using Adam for retraining
2000
poison index =  74
poison index =  84
498
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-13 08:05:34, Val iteration 0, acc 96.200 (96.200)
2021-06-13 08:05:46, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-13 08:05:49, Epoch 0, Iteration 7, loss 0.894 (0.922), acc 73.077 (79.000)
2021-06-13 08:06:59, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6]
Target sample: 1, Prediction:8, Target's Score:[-3.0682888, 6.880922, -2.3428137, -1.7274393, -2.3332171, -4.194519, 1.3646713, -5.111298, 14.215336, -3.715533]
Target sample: 7, Prediction:1, Target's Score:[-0.36211684, 7.688564, -1.8436552, -1.4340107, -2.8235557, -3.4949765, 1.894348, -4.021834, 6.9222746, -2.494753]
Target sample: 13, Prediction:1, Target's Score:[2.429327, 6.4492927, -3.7800686, -1.1358922, -3.899705, -4.335073, 2.4569626, -2.6770263, 5.0504584, -0.47789538]
Target sample: 19, Prediction:1, Target's Score:[5.231282, 6.8172, -0.56591, -1.3385395, -4.3446455, -4.502735, -0.89999765, -2.095258, 3.2714126, -1.476346]
Target sample: 25, Prediction:8, Target's Score:[5.7482247, 4.1453447, -3.3508165, -1.9846182, -3.4059598, -3.589161, 0.19870402, -1.6832044, 5.9463615, -1.9281068]
Target sample: 31, Prediction:1, Target's Score:[4.907372, 6.945718, -4.164528, -1.4464538, -3.7577868, -3.9349287, 1.6752014, -1.7640464, 2.8507068, -1.2010806]
Target sample: 37, Prediction:9, Target's Score:[4.3961406, 2.0110257, -4.4880085, -1.974463, -3.3759477, -3.2915344, 1.4126372, -3.8189268, 3.686801, 5.514691]
Target sample: 43, Prediction:8, Target's Score:[2.7899828, 0.7574332, -1.337236, -2.5075746, -3.080756, -1.470795, 0.69638675, -3.4130342, 9.508605, -1.9077811]
Target sample: 49, Prediction:8, Target's Score:[-1.9426559, 6.7444887, -0.81415486, -3.0933466, -3.2891865, -4.158488, 2.1924078, -3.2660384, 10.520936, -2.8988826]
Target sample: 55, Prediction:8, Target's Score:[-2.7524643, 8.642855, -4.1358747, -0.57522345, -3.4913816, -4.529414, 3.459478, -4.4955306, 10.207846, -2.3255804]
Target sample: 61, Prediction:1, Target's Score:[2.4687243, 6.61724, -3.368912, -1.166511, -2.9158878, -3.5406559, 2.3077857, -3.2816741, 4.859726, -1.9021797]
Target sample: 67, Prediction:0, Target's Score:[6.4551315, 2.8769753, -2.6853256, -0.38539863, -4.125942, -3.3614836, 0.34959444, -2.691814, 2.9558306, 0.7240713]
Target sample: 73, Prediction:1, Target's Score:[4.95586, 5.6846395, -3.671114, -1.1852376, -4.0438004, -3.7998755, 0.6398366, -2.1230876, 4.3199677, -0.6780088]
Target sample: 79, Prediction:1, Target's Score:[4.8584933, 6.0119786, -3.2457533, -1.2929502, -4.6327987, -3.5503914, 0.84639883, -2.042173, 4.106641, -0.95544237]
Target sample: 85, Prediction:0, Target's Score:[6.9980574, 4.9964023, -3.4933484, -1.5773201, -3.274109, -4.462244, 1.5013459, -1.9888281, 1.8989111, -0.47673732]
Target sample: 91, Prediction:9, Target's Score:[2.7968051, 3.0760243, -2.0553966, 1.0027392, -2.787184, -3.4229393, -0.09958507, -3.8512995, 0.9233687, 4.48203]
Target sample: 97, Prediction:8, Target's Score:[-3.0898042, 9.28461, -2.6734753, -0.19775647, -2.7140224, -4.2437487, 1.2222949, -4.843618, 9.719183, -2.472106]
Target sample: 103, Prediction:8, Target's Score:[1.1272413, 4.577096, -1.4348394, -2.252472, -2.4016852, -2.6246817, 1.3360038, -3.9327993, 8.222671, -2.5865576]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-13 08:08:07 Epoch 59, Val iteration 0, acc 92.200 (92.200)
2021-06-13 08:08:19 Epoch 59, Val iteration 19, acc 92.400 (92.230)
* Prec: 92.23000144958496
Per class accuracy =  [0.93374791 0.94437671 0.86175027 0.85559785 0.95170849 0.89626598
 0.9469853  0.92723964 0.94563875 0.96139128]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 8, 8, 8, 1, 1, 1, 1, 8, 0, 1, 1, 1, 1, 0, 0, 0, 8, 8, 1, 8, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 8, 8, 1, 8, 8, 8, 8, 8, 8, 8, 1, 8, 8, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 8, 0, 1, 1, 1, 1, 1, 8, 1, 0, 1, 0, 1, 8, 1, 1, 8, 8, 8, 8, 8, 8, 8, 8, 1, 1
ATTACK acc: 0.0
------SUMMARY POST DEFENSE------
TIME ELAPSED (mins): 15
TARGET INDEX: 19
ResNet50 0.0 0.0 95.46000137329102 91.41000251770019 80.0
DPN92 0.0 1.1363636363636365 95.50000267028808 93.20000114440919 60.0
MobileNetV2 27.77777777777778 9.090909090909092 91.22000160217286 89.62000160217285 40.0
GoogLeNet 0.0 0.0 95.41000213623047 92.23000144958496 60.0
Original Code
bash launch/attack-end2end-12.sh 0 mean 1 1 20 False False False False ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '1', '1', '20', 'False', 'False', 'False', 'False']
Original Code
bash launch/attack-end2end-12.sh 0 mean 5 1 20 False False False False ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '5', '1', '20', 'False', 'False', 'False', 'False']
Original Code
bash launch/attack-end2end-12.sh 0 mean 6 1 20 False False False False ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '6', '1', '20', 'False', 'False', 'False', 'False']
Original Code
bash launch/attack-end2end-12.sh 0 mean 7 1 20 False False False False ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '7', '1', '20', 'False', 'False', 'False', 'False']
Original Code
bash launch/attack-end2end-12.sh 0 mean 8 1 20 False False False False ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '8', '1', '20', 'False', 'False', 'False', 'False']
Original Code
bash launch/attack-end2end-12.sh 0 mean 9 1 20 False False False False ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '9', '1', '20', 'False', 'False', 'False', 'False']
Original Code
bash launch/attack-end2end-12.sh 0 mean 10 1 20 False False False False ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '10', '1', '20', 'False', 'False', 'False', 'False']
Original Code
bash launch/attack-end2end-12.sh 0 mean 11 1 20 False False False False ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '11', '1', '20', 'False', 'False', 'False', 'False']
Original Code
bash launch/attack-end2end-12.sh 0 mean 12 1 20 False False False False ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '12', '1', '20', 'False', 'False', 'False', 'False']
Original Code
bash launch/attack-end2end-12.sh 0 mean 14 1 20 False False False False ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '14', '1', '20', 'False', 'False', 'False', 'False']
Original Code
bash launch/attack-end2end-12.sh 0 mean 15 1 20 False False False False ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '15', '1', '20', 'False', 'False', 'False', 'False']
Original Code
bash launch/attack-end2end-12.sh 0 mean 16 1 20 False False False False ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '16', '1', '20', 'False', 'False', 'False', 'False']
Original Code
bash launch/attack-end2end-12.sh 0 mean 17 1 20 False False False False ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '17', '1', '20', 'False', 'False', 'False', 'False']
Original Code
bash launch/attack-end2end-12.sh 0 mean 19 1 20 False False False False ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '19', '1', '20', 'False', 'False', 'False', 'False']
