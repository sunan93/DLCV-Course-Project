True False False False True
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 118 images of target 1
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=1, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/1/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115]
# Targets: 20, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 19:15:36 Iteration 0 	 Training Loss: 8.936e-01 	 Loss in Target Net: 1.145e+00	  
tensor(0.0004, device='cuda:0')
 2021-06-11 19:16:44 Iteration 50 	 Training Loss: 3.690e-01 	 Loss in Target Net: 4.229e-01	  
tensor(-0.0254, device='cuda:0')
 2021-06-11 19:17:54 Iteration 100 	 Training Loss: 3.179e-01 	 Loss in Target Net: 4.590e-01	  
tensor(-0.0748, device='cuda:0')
 2021-06-11 19:19:06 Iteration 150 	 Training Loss: 2.926e-01 	 Loss in Target Net: 4.441e-01	  
tensor(-0.1150, device='cuda:0')
 2021-06-11 19:20:16 Iteration 200 	 Training Loss: 2.794e-01 	 Loss in Target Net: 4.430e-01	  
tensor(-0.1374, device='cuda:0')
 2021-06-11 19:21:31 Iteration 250 	 Training Loss: 2.700e-01 	 Loss in Target Net: 4.475e-01	  
tensor(-0.1506, device='cuda:0')
 2021-06-11 19:22:41 Iteration 300 	 Training Loss: 2.648e-01 	 Loss in Target Net: 4.501e-01	  
tensor(-0.1628, device='cuda:0')
 2021-06-11 19:23:54 Iteration 350 	 Training Loss: 2.650e-01 	 Loss in Target Net: 4.625e-01	  
tensor(-0.1691, device='cuda:0')
 2021-06-11 19:25:09 Iteration 400 	 Training Loss: 2.590e-01 	 Loss in Target Net: 4.394e-01	  
tensor(-0.1777, device='cuda:0')
 2021-06-11 19:26:25 Iteration 450 	 Training Loss: 2.597e-01 	 Loss in Target Net: 4.541e-01	  
tensor(-0.1795, device='cuda:0')
 2021-06-11 19:27:38 Iteration 500 	 Training Loss: 2.604e-01 	 Loss in Target Net: 4.529e-01	  
tensor(-0.1800, device='cuda:0')
 2021-06-11 19:28:51 Iteration 550 	 Training Loss: 2.615e-01 	 Loss in Target Net: 4.401e-01	  
tensor(-0.1755, device='cuda:0')
 2021-06-11 19:30:04 Iteration 600 	 Training Loss: 2.564e-01 	 Loss in Target Net: 4.410e-01	  
tensor(-0.1758, device='cuda:0')
 2021-06-11 19:31:17 Iteration 650 	 Training Loss: 2.595e-01 	 Loss in Target Net: 4.742e-01	  
tensor(-0.1745, device='cuda:0')
 2021-06-11 19:32:31 Iteration 700 	 Training Loss: 2.579e-01 	 Loss in Target Net: 4.682e-01	  
tensor(-0.1757, device='cuda:0')
 2021-06-11 19:33:44 Iteration 750 	 Training Loss: 2.597e-01 	 Loss in Target Net: 4.481e-01	  
tensor(-0.1752, device='cuda:0')
 2021-06-11 19:34:57 Iteration 800 	 Training Loss: 2.612e-01 	 Loss in Target Net: 4.702e-01	  
tensor(-0.1774, device='cuda:0')
 2021-06-11 19:36:10 Iteration 850 	 Training Loss: 2.582e-01 	 Loss in Target Net: 4.405e-01	  
tensor(-0.1772, device='cuda:0')
 2021-06-11 19:37:23 Iteration 900 	 Training Loss: 2.579e-01 	 Loss in Target Net: 4.526e-01	  
tensor(-0.1794, device='cuda:0')
 2021-06-11 19:38:39 Iteration 950 	 Training Loss: 2.586e-01 	 Loss in Target Net: 4.391e-01	  
tensor(-0.1776, device='cuda:0')
 2021-06-11 19:39:53 Iteration 999 	 Training Loss: 2.638e-01 	 Loss in Target Net: 4.123e-01	  
tensor(-0.1785, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 19:39:58, Val iteration 0, acc 94.200 (94.200)
2021-06-11 19:40:08, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 19:40:13, Epoch 0, Iteration 7, loss 0.274 (0.473), acc 94.231 (89.000)
2021-06-11 19:41:13, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[1.1842699, -0.66746664, -2.086767, -2.2084372, -0.1577326, -2.907957, 7.9371142, -1.485263, -1.2704872, 1.6075813]
Target sample: 7, Prediction:6, Target's Score:[1.8268224, 3.3755903, -1.3856403, -2.9565785, -0.86179256, -2.4533403, 6.2216983, -1.2048059, -2.1120584, -0.53938484]
Target sample: 13, Prediction:1, Target's Score:[-2.5147235, 9.294137, -1.6927164, -2.454107, -2.2229369, -2.4634159, 7.2632527, -2.7663927, -3.0984664, 0.52448404]
Target sample: 19, Prediction:1, Target's Score:[-2.2896779, 7.738186, -0.6892715, -2.2868018, -1.41935, -2.5426142, 6.7845416, -2.6341949, -2.3854795, -0.3860692]
Target sample: 25, Prediction:6, Target's Score:[-2.2366605, 5.195355, -1.3849516, -1.8472742, -1.2414123, -1.5015357, 6.770611, -2.6094122, -1.6265517, 0.40180612]
Target sample: 31, Prediction:1, Target's Score:[-2.776665, 9.89537, -2.1277983, -2.4052362, -2.4754236, -2.4169297, 7.270184, -2.3248835, -2.3440154, -0.43105176]
Target sample: 37, Prediction:1, Target's Score:[-1.6281297, 10.224452, -2.0986137, -2.8047938, -2.4545116, -2.888258, 7.611455, -1.9007264, -1.8934642, -2.3138056]
Target sample: 43, Prediction:6, Target's Score:[-1.1204774, -0.43921602, -2.4542432, -1.9258701, -0.46346337, -2.8826466, 10.521612, -0.8583624, 0.25600505, -0.6752762]
Target sample: 49, Prediction:6, Target's Score:[-1.7436358, 3.1853623, -2.3339777, -1.3984509, 0.10465853, -2.2339413, 8.0891485, -1.3831551, -1.0766394, -1.2775118]
Target sample: 55, Prediction:6, Target's Score:[-0.02879187, 0.9064415, -2.1769035, -2.4463825, -0.80670494, -3.1337771, 11.570543, -1.5004836, -1.3253711, -1.1109341]
Target sample: 61, Prediction:6, Target's Score:[1.1440868, 3.718512, -1.2089202, -2.0033278, -0.8048276, -2.1704855, 6.445372, -1.9256054, -2.2756636, -0.99514496]
Target sample: 67, Prediction:6, Target's Score:[-2.5491016, 7.4950514, -2.0981162, -2.4421575, -2.0576787, -2.4060524, 9.138035, -2.345976, -1.7077477, -1.1338717]
Target sample: 73, Prediction:1, Target's Score:[-1.3060862, 8.546822, -2.2788448, -2.8297043, -2.067478, -2.4781952, 6.8851748, -1.7603364, -0.94858694, -1.8849881]
Target sample: 79, Prediction:1, Target's Score:[-2.1890814, 6.5622044, -1.2026945, -1.8322052, -1.3188832, -2.1695168, 6.179335, -2.6599827, -2.0507977, 0.5794217]
Target sample: 85, Prediction:1, Target's Score:[-1.2565031, 6.8870754, -0.11648109, -2.0343432, -1.5625843, -2.155161, 5.6608615, -2.5994563, -2.324099, -0.5958149]
Target sample: 91, Prediction:6, Target's Score:[-1.0290711, 1.8594846, -0.94018567, -2.4292061, -0.6421286, -2.4868162, 7.426928, -2.096579, -3.007256, 3.2753623]
Target sample: 97, Prediction:6, Target's Score:[1.5271015, 2.6047099, -0.26764557, -2.9214182, 0.14648686, -1.934856, 3.5071604, -1.9339064, -2.3467605, 1.5403204]
Target sample: 103, Prediction:6, Target's Score:[0.23473881, 0.900493, -2.2280908, -2.047124, -0.20079494, -2.16388, 6.416773, 2.3080938, -1.2578808, -2.027507]
Target sample: 109, Prediction:6, Target's Score:[-0.61117274, 0.8570567, -1.9324229, -1.8962536, 0.23425597, -2.796018, 8.384241, -1.6218177, -0.9129827, 0.24266876]
Target sample: 115, Prediction:6, Target's Score:[3.5978017, -1.2776144, -1.4347714, -3.0074997, 0.17941284, -3.2531197, 7.546123, -1.7458891, -1.6515003, 0.9870363]
Current ATTACK acc on target samples: 65.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 19:42:12 Epoch 59, Val iteration 0, acc 92.000 (92.000)
2021-06-11 19:42:23 Epoch 59, Val iteration 19, acc 91.800 (90.850)
* Prec: 90.85000190734863
Per class accuracy =  [0.93626916 0.9397617  0.87392588 0.86245191 0.91830292 0.828106
 0.9314879  0.91854802 0.93957408 0.93860704]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 0, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 6, 1, 6, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 1, 6, 6, 6, 6, 7, 6, 6, 6, 6, 6, 6, 6, 6, 6, 0, 6, 6
ATTACK acc: 59.183673469387756
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 19:42:34, Val iteration 0, acc 94.800 (94.800)
2021-06-11 19:42:55, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 19:43:08, Epoch 0, Iteration 7, loss 0.040 (0.371), acc 100.000 (90.800)
2021-06-11 19:45:47, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[1.6833124, 0.2397877, -4.128452, -2.4446077, -1.2248472, -4.563154, 8.39653, -1.9993099, 4.2402916, 0.20372897]
Target sample: 7, Prediction:6, Target's Score:[1.8322451, -1.0975899, -2.721999, -2.7512598, -0.5816887, -3.5969832, 11.063809, -0.7968617, 0.37016907, -1.3597977]
Target sample: 13, Prediction:1, Target's Score:[-0.99972016, 7.227183, -3.4823363, -2.4121268, -2.2332742, -2.4712598, 6.1191106, -0.46830937, 0.26540387, -1.0530486]
Target sample: 19, Prediction:1, Target's Score:[-1.0314047, 7.1212144, -4.1522403, -0.7763217, -2.2916129, -3.3546636, 3.5838778, -0.3841152, 2.2247903, -0.46306804]
Target sample: 25, Prediction:6, Target's Score:[-0.3830502, 5.5261602, -3.6786127, -1.8940433, -1.9674331, -3.2194145, 7.02005, -1.4611967, 1.6159269, -1.1079937]
Target sample: 31, Prediction:1, Target's Score:[0.87078136, 6.7185173, -3.781673, -1.8574207, -2.6263173, -3.5244594, 5.2422857, -1.154151, 0.31902334, 0.28643462]
Target sample: 37, Prediction:6, Target's Score:[0.97259, 5.696105, -3.3392406, -2.3965125, -1.7186557, -3.3790748, 7.810139, -0.9596621, 0.2018392, -2.4063687]
Target sample: 43, Prediction:6, Target's Score:[2.440956, -1.1744653, -3.660376, -2.4550822, 0.46992612, -4.322786, 8.956704, -0.8190572, 2.290963, -1.3563228]
Target sample: 49, Prediction:6, Target's Score:[0.3859423, -0.48870045, -3.2019794, -1.8770255, -0.7550311, -4.0667686, 12.322259, -2.5919292, 2.3508542, -1.6856557]
Target sample: 55, Prediction:6, Target's Score:[2.8333583, -1.1708877, -2.8242633, -3.3532705, 0.17982545, -4.7400694, 12.548864, -1.5801601, 1.0959285, -2.5660906]
Target sample: 61, Prediction:6, Target's Score:[0.7927631, 2.2754087, -2.12001, -2.2715154, -0.7229134, -1.9049538, 9.69398, -1.6199406, -0.9523095, -2.7924893]
Target sample: 67, Prediction:6, Target's Score:[-0.52684784, 4.0204372, -3.2193255, -1.5074797, -1.6511898, -3.2689583, 8.487472, -2.0350258, 0.35850245, -0.22385255]
Target sample: 73, Prediction:6, Target's Score:[0.011635935, 3.0751188, -4.35911, -1.6359011, -0.46214476, -3.7805598, 5.821719, -1.026687, 3.7256448, -0.97216356]
Target sample: 79, Prediction:1, Target's Score:[-0.6127919, 6.6143126, -3.656178, -2.376503, -1.7542322, -2.6317496, 4.895828, -1.7445667, 2.0635033, -0.32736024]
Target sample: 85, Prediction:1, Target's Score:[0.8793855, 7.0165887, -3.1759853, -2.422138, -2.8687074, -2.5592873, 5.49245, -2.2666051, 0.17524739, 0.23104867]
Target sample: 91, Prediction:1, Target's Score:[-0.21423444, 6.2311206, -3.1410103, -2.3253486, -2.4522958, -2.958129, 5.5436463, -1.5187235, 0.47545454, 0.8307419]
Target sample: 97, Prediction:1, Target's Score:[0.78051764, 6.078564, -4.5201087, -2.1598155, -2.025734, -3.5234697, 1.557276, 0.16640648, 2.1936154, 1.9145716]
Target sample: 103, Prediction:6, Target's Score:[3.36807, -2.069096, -3.693051, -3.116213, -0.54560393, -3.9426005, 7.780235, 0.30135274, 1.820165, 0.45706305]
Target sample: 109, Prediction:6, Target's Score:[0.75330853, 1.1650069, -4.4077773, -2.3913662, -0.99110585, -4.272975, 8.55688, -2.0129485, 5.287361, -1.286225]
Target sample: 115, Prediction:6, Target's Score:[1.218994, -0.38524222, -3.5862124, -2.9474163, -0.8817297, -3.7845576, 9.55468, -1.6538047, 3.546662, -0.7128612]
Current ATTACK acc on target samples: 65.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 19:48:23 Epoch 59, Val iteration 0, acc 92.200 (92.200)
2021-06-11 19:48:44 Epoch 59, Val iteration 19, acc 92.000 (92.710)
* Prec: 92.71000175476074
Per class accuracy =  [0.95156903 0.9715865  0.88269846 0.79683215 0.92523792 0.9103944
 0.96636916 0.93782243 0.96672616 0.96497282]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 1, 1, 1, 6, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 62.244897959183675
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 19:48:48, Val iteration 0, acc 92.600 (92.600)
2021-06-11 19:48:54, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 19:48:56, Epoch 0, Iteration 7, loss 0.392 (0.344), acc 88.462 (90.000)
2021-06-11 19:49:24, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:9, Target's Score:[-0.87674034, 1.133459, -2.7437158, 4.2216673, -0.6925471, -3.5953553, 3.2110252, -3.6951067, -3.6546125, 6.9605255]
Target sample: 7, Prediction:1, Target's Score:[-0.431944, 6.598055, -3.4634826, -1.7804937, -2.6973033, -3.02261, 3.4720201, 0.10206134, -3.1756656, 4.6680083]
Target sample: 13, Prediction:1, Target's Score:[-2.9160433, 12.37874, -1.7313663, -2.9522808, -2.4804993, -0.11719823, 2.022067, -1.9823405, -2.0223994, 0.19694947]
Target sample: 19, Prediction:1, Target's Score:[-2.3253143, 11.891982, -3.388025, -0.93743044, 1.0181016, -2.1726127, 0.9370831, -1.8540747, -2.8763347, 0.103336215]
Target sample: 25, Prediction:1, Target's Score:[-1.4881283, 12.011395, -3.4283462, -1.5659894, -1.7325046, -1.1204189, 0.08502131, -3.0120015, -1.0506872, 1.6766573]
Target sample: 31, Prediction:1, Target's Score:[-2.6801498, 11.565578, -4.0602665, -1.7316413, -1.4178365, -1.1656021, 3.9130363, -1.5851761, -2.3756423, -0.112443745]
Target sample: 37, Prediction:1, Target's Score:[-1.3312649, 11.462477, -3.3536086, -1.6901803, -3.280316, -2.5086515, 6.5524697, -4.0202703, -3.3107758, 1.8244839]
Target sample: 43, Prediction:6, Target's Score:[-1.4030178, 3.2947721, -4.179265, 0.2839867, 1.2596482, -4.3583193, 7.2320576, -2.106629, -1.1092868, 1.3478127]
Target sample: 49, Prediction:6, Target's Score:[-2.1654902, 5.387706, -3.0663784, -0.04335098, -1.7253126, -2.6880426, 9.07666, -4.2500677, -2.4118993, 2.1719449]
Target sample: 55, Prediction:6, Target's Score:[-0.35213834, 5.784814, -4.3509, -0.20837326, -1.4402815, -4.367032, 8.579437, -4.7798147, 2.7092605, -1.2589998]
Target sample: 61, Prediction:1, Target's Score:[1.1841571, 9.564967, -3.1208997, -0.97395974, -2.7865546, -2.7168148, 2.5015328, -2.5096827, -2.5997076, 1.7465457]
Target sample: 67, Prediction:1, Target's Score:[-1.7637893, 11.211131, -4.0724325, -0.48746264, -3.6640291, -1.5220225, 4.2773066, -4.501076, -0.5373379, 1.4131818]
Target sample: 73, Prediction:1, Target's Score:[-2.0114534, 7.912093, -3.9849918, 0.8519426, -0.5145129, -2.4723508, 4.3156724, -3.8462477, 0.5320821, -0.47724986]
Target sample: 79, Prediction:1, Target's Score:[-1.1908278, 11.041091, -2.3449104, 0.24963714, -1.0779462, -2.3385005, 0.007016518, -3.0051498, -2.10813, 1.1402968]
Target sample: 85, Prediction:1, Target's Score:[-1.5269157, 12.849477, -2.94359, -0.81372094, -4.640148, -0.9526054, 2.9760346, -4.839395, -3.0707126, 3.3452346]
Target sample: 91, Prediction:1, Target's Score:[-1.9183432, 9.009686, -2.6855805, -2.1649506, -2.662159, -1.495017, 7.004585, -3.0586727, -2.2362757, 0.5157757]
Target sample: 97, Prediction:1, Target's Score:[0.23365645, 5.600123, -3.099213, -2.2696176, -0.50648904, -2.969853, 4.2155128, 0.3040853, -3.6911077, 2.3976526]
Target sample: 103, Prediction:6, Target's Score:[0.32710442, -0.23870714, -1.0324527, -0.3711021, 2.0134804, -4.133086, 7.6569004, -1.5361184, -4.354268, 1.8549955]
Target sample: 109, Prediction:6, Target's Score:[-2.612718, 5.339952, -5.4781785, 2.0658612, -2.270909, -3.406847, 7.4066873, -2.7866702, -2.231422, 4.2684197]
Target sample: 115, Prediction:9, Target's Score:[-2.59833, -2.9511573, -2.8980997, 0.51963925, 1.7275082, -5.0761704, 6.4236503, -0.7468779, -1.1333443, 6.962609]
Current ATTACK acc on target samples: 25.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 19:49:51 Epoch 59, Val iteration 0, acc 89.400 (89.400)
2021-06-11 19:49:57 Epoch 59, Val iteration 19, acc 90.800 (89.520)
* Prec: 89.52000160217285
Per class accuracy =  [0.92503421 0.93017813 0.84925087 0.82639111 0.89068356 0.82011662
 0.93754671 0.8909805  0.9308315  0.94479423]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 9, 9, 9, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 9, 6, 6, 9, 9, 9, 9, 9, 9, 9, 9
ATTACK acc: 24.489795918367346
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 19:50:05, Val iteration 0, acc 96.200 (96.200)
2021-06-11 19:50:17, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 19:50:23, Epoch 0, Iteration 7, loss 1.168 (0.880), acc 63.462 (77.400)
2021-06-11 19:51:35, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:0, Target's Score:[6.812567, -2.8172398, -4.7318015, -0.53918874, 0.676489, -3.4398494, 4.360047, -2.619221, 2.4337895, -0.115004525]
Target sample: 7, Prediction:6, Target's Score:[3.2391138, 2.7634234, -4.402329, -1.2755401, -1.9970189, -3.536725, 8.136046, -0.5663595, -1.519531, -0.81046206]
Target sample: 13, Prediction:1, Target's Score:[-1.5655292, 7.2876716, -3.5922382, -3.2308424, -1.5156049, -0.93757886, 3.8920205, -2.818997, -1.968256, 4.5037546]
Target sample: 19, Prediction:1, Target's Score:[-1.9518833, 11.244047, -4.1592436, -2.186728, -1.4289328, -3.1916656, 3.1384566, -2.2363005, -1.7997434, 2.6149929]
Target sample: 25, Prediction:1, Target's Score:[-0.39246675, 11.825482, -4.1725025, -1.0780079, -2.6808705, -2.2829952, 1.1064072, -3.2430284, -0.4695731, 1.4373605]
Target sample: 31, Prediction:1, Target's Score:[-0.87075377, 8.760187, -4.1860037, -1.7479606, -2.614553, -1.8655251, 2.042565, -2.9110985, -1.8225602, 5.2691164]
Target sample: 37, Prediction:1, Target's Score:[-0.7962649, 8.714017, -3.1328166, -2.252226, -2.741395, -2.7152557, 6.5707397, -1.8802258, -2.1176796, 0.38968885]
Target sample: 43, Prediction:6, Target's Score:[4.783446, -2.3468237, -4.686358, -1.0689445, -1.058857, -3.2995026, 8.994557, -0.20990857, 2.3594759, -3.4539173]
Target sample: 49, Prediction:6, Target's Score:[2.694285, 0.8391304, -4.3018312, -0.11262932, 0.81662947, -4.135278, 9.239351, -2.3859127, -0.29019445, -2.3482468]
Target sample: 55, Prediction:6, Target's Score:[3.7521732, -2.3058057, -4.081071, 0.7027172, -0.047802113, -3.9067485, 12.105425, -2.0136569, -0.5688354, -3.622205]
Target sample: 61, Prediction:6, Target's Score:[-0.52947295, 2.9074767, -2.6239207, -1.8193885, -0.696919, -2.165747, 7.3166785, -2.2363467, -1.6507901, 1.5311086]
Target sample: 67, Prediction:6, Target's Score:[-0.1625077, 4.288546, -3.0604293, -1.3311931, -0.74144167, -2.184883, 5.711273, -2.8708117, -1.8016554, 2.1900437]
Target sample: 73, Prediction:1, Target's Score:[0.727262, 7.0755563, -4.1952834, -1.6514759, -2.5618882, -2.8796659, 3.575692, -2.7487638, -0.8897206, 3.5904753]
Target sample: 79, Prediction:1, Target's Score:[-1.3985897, 10.937379, -4.6015587, -1.63175, -2.105666, -1.8418556, 2.0324519, -2.8881454, -1.1858541, 2.7329366]
Target sample: 85, Prediction:1, Target's Score:[-0.72731566, 9.199838, -3.5375435, -2.3077888, -0.92857534, -1.0253948, 2.2407372, -3.6022046, -1.8535362, 2.5970752]
Target sample: 91, Prediction:6, Target's Score:[1.068679, 4.433608, -3.8116007, -2.0721128, -0.2330829, -2.9056153, 5.4627695, -2.0116117, -1.3278221, 1.4295568]
Target sample: 97, Prediction:1, Target's Score:[1.7073916, 9.05305, -5.227845, -3.0510259, -2.0301478, -3.1243944, 2.7229593, -0.44919965, -0.12195947, 0.56072927]
Target sample: 103, Prediction:6, Target's Score:[6.214235, -3.0433347, -3.9661613, -1.3774548, -3.0293255, -0.23352823, 7.1984873, -0.6012982, 1.1466681, -2.2664375]
Target sample: 109, Prediction:0, Target's Score:[5.5460196, -0.4561595, -5.6544065, 0.61383563, 0.7538558, -4.1356544, 2.6900263, -2.8449404, 3.1559591, 0.3464011]
Target sample: 115, Prediction:6, Target's Score:[4.08059, -1.2780014, -5.052042, 1.6388073, 1.1633745, -4.5894594, 4.769808, -1.6418202, -0.011583412, 0.9362943]
Current ATTACK acc on target samples: 45.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 19:52:45 Epoch 59, Val iteration 0, acc 92.000 (92.000)
2021-06-11 19:52:58 Epoch 59, Val iteration 19, acc 92.200 (92.030)
* Prec: 92.03000068664551
Per class accuracy =  [0.93072225 0.91805051 0.88170271 0.89136257 0.93987137 0.86154786
 0.95278609 0.9156742  0.96785681 0.94502405]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 0, 0, 0, 8, 0, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 8, 6, 6, 0, 9, 0, 0, 6, 8, 0, 0
ATTACK acc: 30.612244897959183
--------
------SUMMARY------
TIME ELAPSED (mins): 24
TARGET INDEX: 1
ResNet50 65.0 59.183673469387756 95.46000137329102 90.85000190734863
DPN92 65.0 62.244897959183675 95.50000267028808 92.71000175476074
MobileNetV2 25.0 24.489795918367346 91.22000160217286 89.52000160217285
GoogLeNet 45.0 30.612244897959183 95.41000213623047 92.03000068664551
True False False False True
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 84 images of target 5
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=5, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/5/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79]
# Targets: 14, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 19:53:17 Iteration 0 	 Training Loss: 9.121e-01 	 Loss in Target Net: 1.157e+00	  
tensor(0.0001, device='cuda:0')
 2021-06-11 19:54:31 Iteration 50 	 Training Loss: 3.976e-01 	 Loss in Target Net: 3.210e-01	  
tensor(-0.0588, device='cuda:0')
 2021-06-11 19:55:48 Iteration 100 	 Training Loss: 3.446e-01 	 Loss in Target Net: 2.352e-01	  
tensor(-0.1533, device='cuda:0')
 2021-06-11 19:57:05 Iteration 150 	 Training Loss: 3.199e-01 	 Loss in Target Net: 2.349e-01	  
tensor(-0.1944, device='cuda:0')
 2021-06-11 19:58:22 Iteration 200 	 Training Loss: 3.079e-01 	 Loss in Target Net: 2.583e-01	  
tensor(-0.2090, device='cuda:0')
 2021-06-11 19:59:38 Iteration 250 	 Training Loss: 3.001e-01 	 Loss in Target Net: 2.407e-01	  
tensor(-0.2210, device='cuda:0')
 2021-06-11 20:00:54 Iteration 300 	 Training Loss: 3.040e-01 	 Loss in Target Net: 2.469e-01	  
tensor(-0.2210, device='cuda:0')
 2021-06-11 20:02:09 Iteration 350 	 Training Loss: 3.040e-01 	 Loss in Target Net: 2.381e-01	  
tensor(-0.2259, device='cuda:0')
 2021-06-11 20:03:24 Iteration 400 	 Training Loss: 2.992e-01 	 Loss in Target Net: 2.371e-01	  
tensor(-0.2205, device='cuda:0')
 2021-06-11 20:04:41 Iteration 450 	 Training Loss: 3.004e-01 	 Loss in Target Net: 2.450e-01	  
tensor(-0.2194, device='cuda:0')
 2021-06-11 20:05:59 Iteration 500 	 Training Loss: 2.984e-01 	 Loss in Target Net: 2.508e-01	  
tensor(-0.2202, device='cuda:0')
 2021-06-11 20:07:14 Iteration 550 	 Training Loss: 3.002e-01 	 Loss in Target Net: 2.335e-01	  
tensor(-0.2205, device='cuda:0')
 2021-06-11 20:08:30 Iteration 600 	 Training Loss: 3.049e-01 	 Loss in Target Net: 2.637e-01	  
tensor(-0.2164, device='cuda:0')
 2021-06-11 20:09:45 Iteration 650 	 Training Loss: 2.985e-01 	 Loss in Target Net: 2.305e-01	  
tensor(-0.2146, device='cuda:0')
 2021-06-11 20:11:02 Iteration 700 	 Training Loss: 3.061e-01 	 Loss in Target Net: 2.388e-01	  
tensor(-0.2073, device='cuda:0')
 2021-06-11 20:12:18 Iteration 750 	 Training Loss: 3.048e-01 	 Loss in Target Net: 2.390e-01	  
tensor(-0.2116, device='cuda:0')
 2021-06-11 20:13:35 Iteration 800 	 Training Loss: 2.987e-01 	 Loss in Target Net: 2.360e-01	  
tensor(-0.2081, device='cuda:0')
 2021-06-11 20:14:52 Iteration 850 	 Training Loss: 3.013e-01 	 Loss in Target Net: 2.229e-01	  
tensor(-0.2112, device='cuda:0')
 2021-06-11 20:16:08 Iteration 900 	 Training Loss: 2.985e-01 	 Loss in Target Net: 2.303e-01	  
tensor(-0.2080, device='cuda:0')
 2021-06-11 20:17:24 Iteration 950 	 Training Loss: 3.048e-01 	 Loss in Target Net: 2.305e-01	  
tensor(-0.2107, device='cuda:0')
 2021-06-11 20:18:40 Iteration 999 	 Training Loss: 3.026e-01 	 Loss in Target Net: 2.185e-01	  
tensor(-0.2047, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 20:18:45, Val iteration 0, acc 94.200 (94.200)
2021-06-11 20:18:55, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 20:19:00, Epoch 0, Iteration 7, loss 0.212 (0.416), acc 98.077 (91.400)
2021-06-11 20:20:01, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.9151535, -0.09342542, 0.032231893, 1.154309, -1.5014602, -1.4600849, 6.980773, -2.743842, -1.4143763, 2.002121]
Target sample: 7, Prediction:6, Target's Score:[-1.1465749, 0.28191862, -0.285698, -1.1648476, -1.3959825, -1.1900561, 6.954959, -2.4315586, -0.85842437, 1.2720909]
Target sample: 13, Prediction:6, Target's Score:[-2.4181378, 1.8334264, 0.17094192, -0.21234238, -1.4314141, -1.1266707, 6.3949137, -2.8053522, -2.5920959, 2.2249477]
Target sample: 19, Prediction:6, Target's Score:[-2.580049, -0.09476374, -1.1188341, -0.2775051, -1.1109735, -0.7199052, 9.992181, -2.7399933, -1.067853, -0.22776979]
Target sample: 25, Prediction:6, Target's Score:[-2.2183075, -0.32664955, -1.24528, -0.89479464, -1.5724965, -0.66375756, 10.384652, -2.5274477, -0.10551023, -0.7804688]
Target sample: 31, Prediction:6, Target's Score:[-2.4851897, 2.2967973, -0.70835775, -0.64911336, -1.2146429, -0.9491021, 7.099536, -2.4852154, -1.7270912, 0.8599797]
Target sample: 37, Prediction:6, Target's Score:[-2.8274457, 3.3120396, 0.0670514, -0.47770315, -1.2045013, -1.4538494, 5.947504, -1.973749, -1.6252284, 0.26465496]
Target sample: 43, Prediction:6, Target's Score:[-2.9206018, 2.7885842, -0.32119277, -1.5992345, -1.2433857, -1.7448798, 7.119086, -1.9849985, 1.0094686, -1.0902268]
Target sample: 49, Prediction:6, Target's Score:[-2.623982, 1.4705001, -0.30477017, -1.1776857, -1.1814203, -1.4746004, 6.468573, -2.6259468, 1.5590825, -0.102933206]
Target sample: 55, Prediction:1, Target's Score:[-2.718259, 4.64859, -0.96178657, -1.4011877, -1.5627483, 0.20133364, 4.481888, -2.827802, -2.6487732, 2.7971587]
Target sample: 61, Prediction:6, Target's Score:[-0.03974022, 2.7364776, -1.0724033, -1.7021657, 0.14758354, -1.016937, 4.8363814, -2.3590295, -0.15911737, -1.3599297]
Target sample: 67, Prediction:6, Target's Score:[-1.8056513, 0.9748534, -0.34469065, 0.3236447, -1.4021127, -0.9974986, 7.041058, -2.4836848, -2.2973857, 1.0420096]
Target sample: 73, Prediction:6, Target's Score:[-2.4039364, 1.3109932, -0.20131414, -0.024082895, -1.3130409, -1.3903756, 7.3313446, -2.351267, -1.8676834, 0.95579445]
Target sample: 79, Prediction:6, Target's Score:[-2.7242746, 0.5265151, 0.41147447, 1.205799, -1.3524748, -1.3251907, 6.966533, -2.6699688, -1.8610753, 0.8706137]
Current ATTACK acc on target samples: 92.857
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 20:21:00 Epoch 59, Val iteration 0, acc 90.200 (90.200)
2021-06-11 20:21:11 Epoch 59, Val iteration 19, acc 90.400 (90.590)
* Prec: 90.59000167846679
Per class accuracy =  [0.9517422  0.91313143 0.82339999 0.82736437 0.91188476 0.86626728
 0.94843034 0.91682961 0.95914307 0.93862032]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 9, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 97.14285714285714
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 20:21:22, Val iteration 0, acc 94.800 (94.800)
2021-06-11 20:21:42, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 20:21:56, Epoch 0, Iteration 7, loss 0.503 (0.542), acc 92.308 (90.400)
2021-06-11 20:24:36, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-3.6630244, 5.2142205, -3.1526282, -1.276708, -1.6290108, -3.488052, 8.467036, -2.9922583, 2.0442321, 0.9065465]
Target sample: 7, Prediction:6, Target's Score:[-1.8993635, 2.4407992, -4.202258, -2.1968782, -1.3710066, -3.7537432, 6.2800217, -1.4258255, 3.418201, 3.1045637]
Target sample: 13, Prediction:6, Target's Score:[-3.0413013, 2.6256852, -1.5586582, -1.1876234, -0.26115352, -1.5813073, 7.010155, -1.696451, -1.4495754, 1.4832873]
Target sample: 19, Prediction:6, Target's Score:[-3.422484, 2.183818, -3.7767854, -1.8611327, -1.5783411, -2.0468884, 9.146655, -2.5065687, 2.6772459, 1.5827327]
Target sample: 25, Prediction:6, Target's Score:[-3.0951262, 2.098705, -3.5155315, -1.269462, -1.0649587, -3.2964792, 8.761724, -2.498085, 2.7667933, 1.4824541]
Target sample: 31, Prediction:6, Target's Score:[-3.379053, 4.527201, -1.8302302, -1.2698796, -0.73917043, -1.4498761, 8.153746, -2.3392475, -1.1715829, -0.082983136]
Target sample: 37, Prediction:6, Target's Score:[-2.394319, 5.5727906, -3.1548815, -1.6541672, -1.1350303, -2.9882796, 6.453268, -2.302628, 2.0113049, 0.029119447]
Target sample: 43, Prediction:6, Target's Score:[-3.4713807, 3.0950046, -2.7477558, -1.846349, -0.7175682, -3.0096414, 10.974687, -2.6911912, 1.4110825, -0.6156888]
Target sample: 49, Prediction:6, Target's Score:[-3.6340013, 3.7556214, -3.096299, -1.1545937, -0.80014944, -2.8218186, 8.701735, -2.4807878, 3.1947844, -1.260281]
Target sample: 55, Prediction:1, Target's Score:[-2.5189888, 6.7246265, -3.363899, -2.0245821, -1.1938279, -1.8696883, 4.6446266, -2.6258268, -1.1635549, 3.8881567]
Target sample: 61, Prediction:1, Target's Score:[0.4009819, 7.3636274, -4.254139, -1.4367402, -2.5513878, -3.9213052, 3.0061126, -1.2534639, 3.5754068, -0.43619263]
Target sample: 67, Prediction:6, Target's Score:[-3.0240295, 5.9565797, -2.9537437, -1.4506482, -1.3989003, -3.3108964, 6.9990096, -2.7027614, 0.34187454, 1.9926594]
Target sample: 73, Prediction:6, Target's Score:[-3.0361516, 3.7764306, -3.295399, -2.1546845, -1.71626, -2.4018207, 9.463273, -3.1655915, 1.6243651, 1.3458171]
Target sample: 79, Prediction:6, Target's Score:[-3.8704736, 3.4898124, -3.0257823, -1.3023667, -1.3550884, -2.8818586, 10.479191, -2.7066503, 0.9359295, 0.6310214]
Current ATTACK acc on target samples: 85.714
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 20:27:12 Epoch 59, Val iteration 0, acc 92.600 (92.600)
2021-06-11 20:27:33 Epoch 59, Val iteration 19, acc 92.800 (92.910)
* Prec: 92.91000213623047
Per class accuracy =  [0.94929188 0.95359314 0.89669644 0.86521491 0.95861861 0.87381382
 0.93099635 0.93114193 0.96834417 0.96221122]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 9, 9, 9, 1, 9, 1, 9, 6, 6, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8
ATTACK acc: 75.71428571428571
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 20:27:37, Val iteration 0, acc 92.600 (92.600)
2021-06-11 20:27:42, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 20:27:44, Epoch 0, Iteration 7, loss 0.483 (0.411), acc 80.769 (88.000)
2021-06-11 20:28:12, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-2.931414, 4.0692444, -2.732846, 1.6791838, -3.1566646, -2.1545036, 3.6492743, -3.5254998, 1.8430687, 3.4747095]
Target sample: 7, Prediction:3, Target's Score:[-3.3203642, -0.20697236, -2.0365412, 4.1870413, -1.3903726, -3.2806244, 1.4099972, 0.9269069, 0.6637666, 3.2751145]
Target sample: 13, Prediction:6, Target's Score:[-3.255749, 4.940247, -2.1928606, 1.2410377, -3.454841, -2.9183517, 5.0482354, -0.83253485, -0.6762619, 2.3156881]
Target sample: 19, Prediction:6, Target's Score:[-4.0344996, 6.266993, -4.41691, 0.95532715, -6.8105874, -0.81160355, 9.177448, -5.206611, 4.0876875, 1.021719]
Target sample: 25, Prediction:6, Target's Score:[-2.7889476, 3.2663264, -3.487143, 0.14127788, -5.0631676, -0.9539727, 7.8607907, -4.19967, 2.3973618, 3.0318813]
Target sample: 31, Prediction:1, Target's Score:[-1.8675215, 10.603938, -1.2580179, -1.6466889, -3.598131, -2.1732564, 6.0031095, -4.8260646, -3.740438, 2.747895]
Target sample: 37, Prediction:1, Target's Score:[-2.113633, 9.701225, -0.34505105, -0.1856929, -6.363472, 0.46059653, -2.144952, -0.59016, 0.055960238, 1.7786463]
Target sample: 43, Prediction:8, Target's Score:[-2.4919589, 2.836332, -1.3103381, 0.57736754, -4.520289, -1.7991041, 3.3416045, -3.095278, 4.5018277, 2.1818697]
Target sample: 49, Prediction:8, Target's Score:[-3.0730042, 3.2940514, -2.2437334, 1.9476932, -5.72037, 1.9310436, 1.4710504, -5.7074885, 4.382074, 3.9598935]
Target sample: 55, Prediction:1, Target's Score:[-2.5453277, 8.98798, -3.8638303, -0.8468825, -6.5452847, 0.29841048, 5.227858, -4.272528, -1.8218206, 5.602628]
Target sample: 61, Prediction:1, Target's Score:[0.0125044435, 6.961984, -1.97676, 2.558, -4.6388197, -3.3727589, 2.377283, -5.5121255, 4.3060856, -0.48117444]
Target sample: 67, Prediction:1, Target's Score:[-0.61858535, 9.657988, -2.4071543, -1.3890333, -4.641527, -3.3396413, 4.843691, -3.7100875, -0.8017607, 2.6359158]
Target sample: 73, Prediction:1, Target's Score:[-1.8510046, 6.572268, -3.0050535, 0.32964766, -5.7033544, -1.548606, 3.7354696, -4.205022, 3.752983, 2.1487126]
Target sample: 79, Prediction:1, Target's Score:[-2.118527, 6.2353497, -0.023229435, 1.2200398, -4.1146593, -2.369304, -0.14746344, -2.204538, 0.9437909, 2.8248239]
Current ATTACK acc on target samples: 21.429
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 20:28:40 Epoch 59, Val iteration 0, acc 88.800 (88.800)
2021-06-11 20:28:46 Epoch 59, Val iteration 19, acc 90.600 (89.510)
* Prec: 89.51000099182129
Per class accuracy =  [0.92387605 0.92010202 0.85276499 0.83192601 0.89442471 0.82734773
 0.93151704 0.89351402 0.92944854 0.94167915]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 9, 8, 3, 1, 1, 1, 1, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 9, 1, 1, 1, 1, 1, 1, 1, 6, 1, 8, 1, 8, 8, 8, 8, 1, 6, 1, 1, 1, 6, 1, 1, 1, 8, 1, 9, 6, 9, 1, 1, 1, 1, 1, 1, 8, 8, 8, 8, 9, 1, 8, 8, 1, 8
ATTACK acc: 24.285714285714285
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 20:28:53, Val iteration 0, acc 96.200 (96.200)
2021-06-11 20:29:05, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 20:29:11, Epoch 0, Iteration 7, loss 0.445 (0.523), acc 90.385 (87.800)
2021-06-11 20:30:23, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.4985049, 3.7329972, -0.2048508, 1.5966078, -3.8406003, -4.1896443, 4.5508723, -2.13244, 0.76128083, 2.283883]
Target sample: 7, Prediction:8, Target's Score:[-1.2246339, 0.98175573, 1.7074897, -0.6597695, -3.8668656, -3.2552757, 2.6740565, -2.5508595, 3.1606529, 3.1094842]
Target sample: 13, Prediction:1, Target's Score:[-2.3987439, 6.458383, -0.01360949, -1.1358696, -3.0224812, -3.2461092, 6.073727, -1.6230366, -2.2055428, 1.1588295]
Target sample: 19, Prediction:6, Target's Score:[-3.409946, 3.5636117, -2.9156377, -0.7728406, -3.0605383, -3.0218978, 9.645508, -1.5839489, 0.6150719, 0.9845244]
Target sample: 25, Prediction:6, Target's Score:[-3.9124706, 6.3149104, -3.9007494, -1.8390672, -3.7481098, -3.3383496, 6.8641376, -2.393702, 5.6748843, 0.3284168]
Target sample: 31, Prediction:6, Target's Score:[-2.9076877, 6.7119074, -1.2110099, -0.282708, -3.2728853, -2.3461947, 6.737989, -2.1980777, -2.6576464, 1.4707596]
Target sample: 37, Prediction:1, Target's Score:[-1.211462, 6.0532064, -1.7109057, 0.10833124, -3.4716425, -3.3689346, 4.6526656, -2.037177, 0.039438903, 1.0045083]
Target sample: 43, Prediction:6, Target's Score:[-3.1172967, 4.44963, -1.0074769, -2.5800006, -3.6568964, -3.4265862, 7.8333387, -1.1261551, 1.1001893, 1.5776799]
Target sample: 49, Prediction:1, Target's Score:[-3.2753422, 5.66348, -1.8365371, -3.118817, -3.1219056, -2.8554144, 4.7255864, -2.9360688, 4.051039, 2.758591]
Target sample: 55, Prediction:1, Target's Score:[-3.8744562, 9.985696, -2.2759416, -3.1049745, -3.5496185, -2.3466125, 6.226822, -1.9914691, -1.3758571, 2.3434052]
Target sample: 61, Prediction:8, Target's Score:[2.4332783, 2.7314465, -2.005696, -2.5969987, -2.3747733, -3.575934, 2.9219115, -2.012523, 5.7283835, -1.1744763]
Target sample: 67, Prediction:1, Target's Score:[-1.0710373, 7.985006, -1.908515, -2.6476252, -3.7861943, -3.2093077, 6.2584214, -1.0380964, -2.3530636, 1.8245487]
Target sample: 73, Prediction:6, Target's Score:[-0.7929972, 6.74749, -2.035414, -2.4034498, -3.8410146, -3.3005662, 6.777112, -2.4000797, -1.0523314, 2.3535244]
Target sample: 79, Prediction:1, Target's Score:[-3.345147, 4.9469047, 0.40548882, 0.6327264, -3.9127166, -4.0089417, 4.7043366, -2.5814793, 0.16382718, 3.052424]
Current ATTACK acc on target samples: 42.857
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 20:31:34 Epoch 59, Val iteration 0, acc 92.200 (92.200)
2021-06-11 20:31:47 Epoch 59, Val iteration 19, acc 92.600 (92.440)
* Prec: 92.4400016784668
Per class accuracy =  [0.95956104 0.93073385 0.87322385 0.84229702 0.93502579 0.9048326
 0.96897395 0.9398416  0.94608474 0.94242545]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 8, 8, 8, 9, 6, 1, 1, 6, 6, 6, 9, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 1, 1, 6, 1, 1, 1, 6, 6, 6, 6, 8, 6, 1, 1, 1, 1, 1, 1, 6, 9, 0, 8, 8, 9, 6, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 6, 6, 6, 6, 8, 8
ATTACK acc: 48.57142857142857
--------
------SUMMARY------
TIME ELAPSED (mins): 25
TARGET INDEX: 5
ResNet50 92.85714285714286 97.14285714285714 95.46000137329102 90.59000167846679
DPN92 85.71428571428571 75.71428571428571 95.50000267028808 92.91000213623047
MobileNetV2 21.428571428571427 24.285714285714285 91.22000160217286 89.51000099182129
GoogLeNet 42.857142857142854 48.57142857142857 95.41000213623047 92.4400016784668
True False False False True
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 96 images of target 6
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=6, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/6/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
# Targets: 16, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 20:32:06 Iteration 0 	 Training Loss: 8.499e-01 	 Loss in Target Net: 1.054e+00	  
tensor(-5.4306e-06, device='cuda:0')
 2021-06-11 20:33:22 Iteration 50 	 Training Loss: 3.746e-01 	 Loss in Target Net: 3.445e-01	  
tensor(-0.0540, device='cuda:0')
 2021-06-11 20:34:38 Iteration 100 	 Training Loss: 3.308e-01 	 Loss in Target Net: 2.980e-01	  
tensor(-0.1158, device='cuda:0')
 2021-06-11 20:35:57 Iteration 150 	 Training Loss: 3.162e-01 	 Loss in Target Net: 2.736e-01	  
tensor(-0.1310, device='cuda:0')
 2021-06-11 20:37:14 Iteration 200 	 Training Loss: 3.170e-01 	 Loss in Target Net: 2.901e-01	  
tensor(-0.1359, device='cuda:0')
 2021-06-11 20:38:30 Iteration 250 	 Training Loss: 3.105e-01 	 Loss in Target Net: 3.117e-01	  
tensor(-0.1374, device='cuda:0')
 2021-06-11 20:39:50 Iteration 300 	 Training Loss: 3.121e-01 	 Loss in Target Net: 3.236e-01	  
tensor(-0.1389, device='cuda:0')
 2021-06-11 20:41:06 Iteration 350 	 Training Loss: 3.133e-01 	 Loss in Target Net: 3.210e-01	  
tensor(-0.1401, device='cuda:0')
 2021-06-11 20:42:21 Iteration 400 	 Training Loss: 3.069e-01 	 Loss in Target Net: 2.764e-01	  
tensor(-0.1402, device='cuda:0')
 2021-06-11 20:43:40 Iteration 450 	 Training Loss: 3.040e-01 	 Loss in Target Net: 2.905e-01	  
tensor(-0.1426, device='cuda:0')
 2021-06-11 20:44:56 Iteration 500 	 Training Loss: 3.097e-01 	 Loss in Target Net: 2.925e-01	  
tensor(-0.1460, device='cuda:0')
 2021-06-11 20:46:13 Iteration 550 	 Training Loss: 3.031e-01 	 Loss in Target Net: 2.932e-01	  
tensor(-0.1483, device='cuda:0')
 2021-06-11 20:47:30 Iteration 600 	 Training Loss: 3.057e-01 	 Loss in Target Net: 3.157e-01	  
tensor(-0.1477, device='cuda:0')
 2021-06-11 20:48:46 Iteration 650 	 Training Loss: 3.026e-01 	 Loss in Target Net: 2.987e-01	  
tensor(-0.1488, device='cuda:0')
 2021-06-11 20:50:03 Iteration 700 	 Training Loss: 3.005e-01 	 Loss in Target Net: 3.278e-01	  
tensor(-0.1502, device='cuda:0')
 2021-06-11 20:51:20 Iteration 750 	 Training Loss: 3.042e-01 	 Loss in Target Net: 3.226e-01	  
tensor(-0.1493, device='cuda:0')
 2021-06-11 20:52:38 Iteration 800 	 Training Loss: 3.024e-01 	 Loss in Target Net: 2.992e-01	  
tensor(-0.1514, device='cuda:0')
 2021-06-11 20:53:56 Iteration 850 	 Training Loss: 3.025e-01 	 Loss in Target Net: 2.947e-01	  
tensor(-0.1522, device='cuda:0')
 2021-06-11 20:55:12 Iteration 900 	 Training Loss: 3.021e-01 	 Loss in Target Net: 3.136e-01	  
tensor(-0.1507, device='cuda:0')
 2021-06-11 20:56:28 Iteration 950 	 Training Loss: 3.048e-01 	 Loss in Target Net: 3.173e-01	  
tensor(-0.1506, device='cuda:0')
 2021-06-11 20:57:42 Iteration 999 	 Training Loss: 2.991e-01 	 Loss in Target Net: 3.059e-01	  
tensor(-0.1502, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 20:57:47, Val iteration 0, acc 94.200 (94.200)
2021-06-11 20:57:57, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 20:58:02, Epoch 0, Iteration 7, loss 0.629 (0.616), acc 84.615 (88.800)
2021-06-11 20:59:03, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.8287454, 7.467461, -1.2745608, -0.88720006, -2.3581247, -2.1381183, 7.4934263, -2.4671876, -1.6393569, -1.2044356]
Target sample: 7, Prediction:6, Target's Score:[-3.5204215, 6.1159945, -0.8449804, -1.4181606, -2.5066197, -2.7006078, 9.816708, -3.8164523, -3.3958805, 2.4606512]
Target sample: 13, Prediction:9, Target's Score:[-1.398284, 1.2967776, -1.5959109, -1.448507, -2.3804095, -2.7134154, 5.7209864, -3.6202955, -3.0620275, 9.287517]
Target sample: 19, Prediction:6, Target's Score:[-2.1544766, 3.5320427, -1.1785651, -0.3616616, -2.2421708, -2.1349845, 7.3178377, -3.0993507, -2.6689603, 3.1330929]
Target sample: 25, Prediction:6, Target's Score:[-3.197102, 7.1650887, -1.2439488, -0.8995601, -2.5525558, -2.169792, 7.175246, -3.023334, -2.949815, 1.8326633]
Target sample: 31, Prediction:6, Target's Score:[-2.4836218, 5.1924586, -1.202189, -0.84981984, -2.3006423, -2.2544625, 7.6722717, -2.5594077, -2.4455242, 1.389345]
Target sample: 37, Prediction:1, Target's Score:[-3.596499, 10.465435, -1.3604603, -1.4415956, -2.852291, -2.4325242, 6.757248, -2.7545173, -2.6225827, -0.033038635]
Target sample: 43, Prediction:6, Target's Score:[-2.5821955, 6.504196, -1.1181511, -0.9433171, -2.0318863, -1.6008914, 7.706727, -2.7145567, -1.8892131, -1.1619866]
Target sample: 49, Prediction:1, Target's Score:[-3.2442632, 9.122513, -1.7023468, -1.2849507, -2.5194006, -2.460099, 7.7965245, -2.7667305, -1.4110687, -1.3629801]
Target sample: 55, Prediction:6, Target's Score:[-3.038509, 4.010601, -0.44624105, -1.0744647, -1.8279861, -2.8289645, 10.52273, -3.5518098, -2.5334022, 0.9841647]
Target sample: 61, Prediction:6, Target's Score:[-3.3299246, 6.4993434, -1.1270301, -0.27682424, -2.2132487, -1.9052804, 7.917091, -3.01123, -2.7991774, 0.4019958]
Target sample: 67, Prediction:6, Target's Score:[-2.3646731, 2.9860215, -0.3986779, 0.20289008, -1.6685314, -1.9023738, 8.514929, -3.1232464, -2.687556, 0.6165365]
Target sample: 73, Prediction:1, Target's Score:[-3.2873123, 7.7364273, -1.3626004, -0.814621, -2.697243, -2.1184688, 6.7576566, -2.7322214, -2.8423426, 1.4908497]
Target sample: 79, Prediction:6, Target's Score:[-3.2325895, 5.8783517, -1.59576, -1.3214079, -2.9432046, -2.6507936, 6.8754215, -3.3020399, -3.4162283, 5.8243623]
Target sample: 85, Prediction:6, Target's Score:[-2.053942, 1.3407642, -1.200745, -0.73146164, -1.6475501, -2.7121968, 9.6214, -3.7643006, -2.129134, 3.469665]
Target sample: 91, Prediction:1, Target's Score:[-2.7428124, 8.686761, -1.6960895, -1.0164379, -2.7342548, -2.2552261, 6.528261, -2.441526, -1.3540723, -0.8337995]
Current ATTACK acc on target samples: 68.750
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 21:00:02 Epoch 59, Val iteration 0, acc 90.600 (90.600)
2021-06-11 21:00:13 Epoch 59, Val iteration 19, acc 89.400 (89.600)
* Prec: 89.60000114440918
Per class accuracy =  [0.92217455 0.92495429 0.76753376 0.82713807 0.88742463 0.84369261
 0.96060255 0.92107419 0.9424407  0.96153413]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 9, 9, 9, 9, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 1, 6, 6, 6, 1, 6, 6, 6, 9, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 6
ATTACK acc: 73.75
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 21:00:24, Val iteration 0, acc 94.800 (94.800)
2021-06-11 21:00:44, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 21:00:58, Epoch 0, Iteration 7, loss 0.185 (0.456), acc 94.231 (89.400)
2021-06-11 21:03:38, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-4.1474285, 4.922709, -1.3736454, -1.7347987, -2.9096217, -0.8696661, 7.7606134, -0.9326426, 2.169807, -2.4356034]
Target sample: 7, Prediction:6, Target's Score:[-4.8790073, 5.231641, -0.18430924, -1.1573867, -2.02746, -1.9152716, 8.766866, -2.4206843, -0.6622149, -0.2770616]
Target sample: 13, Prediction:6, Target's Score:[-4.098541, 5.0812316, -1.1428204, -0.61438435, -3.339795, -1.5628054, 7.020665, -2.415849, -1.5843544, 3.1213388]
Target sample: 19, Prediction:6, Target's Score:[-3.9983413, 1.8823657, -0.29246408, -0.86102825, -2.174236, -1.3244605, 11.25496, -1.3503565, 0.18769631, -2.9236357]
Target sample: 25, Prediction:6, Target's Score:[-3.5805182, 6.6514616, -0.7884562, -1.6362005, -3.3371851, -1.5085568, 7.5830374, -1.0330981, -0.1270586, -1.7225397]
Target sample: 31, Prediction:6, Target's Score:[-3.9759173, 2.5119877, -0.38654798, -1.1488035, -1.4696488, -1.8046174, 10.655567, -1.9816684, -0.30923787, -1.6939857]
Target sample: 37, Prediction:6, Target's Score:[-4.504003, 6.109711, -0.24787194, -1.7033062, -2.335219, -1.6033965, 8.674252, -1.3789111, -0.08164671, -2.443615]
Target sample: 43, Prediction:6, Target's Score:[-4.7191224, 3.7029142, -0.9669628, -0.53179836, 0.017066615, -1.0877229, 8.488585, -2.7304688, -0.31680235, -1.4276748]
Target sample: 49, Prediction:6, Target's Score:[-4.374015, 6.3055196, -0.9115526, -1.9436494, -1.2643956, -1.2450893, 7.739336, -2.2401812, 0.26424897, -1.8590058]
Target sample: 55, Prediction:6, Target's Score:[-4.8916264, 3.3356266, 0.48112252, -1.8387604, -2.299768, -1.0742273, 13.536397, -2.1540048, -1.095836, -3.532352]
Target sample: 61, Prediction:6, Target's Score:[-4.416464, 5.209378, -0.8227042, -1.6475384, -2.2415285, -1.4917439, 9.464416, -1.7026093, 0.22269824, -2.1084924]
Target sample: 67, Prediction:6, Target's Score:[-4.4476995, 0.4419445, 0.059744842, -0.75157464, -0.8636282, -1.1301328, 13.06143, -2.3267095, -0.7437309, -2.9179995]
Target sample: 73, Prediction:6, Target's Score:[-3.5378757, 3.3965578, -0.7345097, -1.4996952, -2.8421068, -1.4904422, 9.821736, -1.3933543, 0.12917386, -1.4245614]
Target sample: 79, Prediction:6, Target's Score:[-4.2063103, 5.0557337, -0.9671389, -0.7071026, -3.1278703, -1.6539935, 8.125984, -2.2483203, -1.0887165, 1.2932787]
Target sample: 85, Prediction:6, Target's Score:[-4.4464226, 5.401397, -0.56150955, -0.6465946, -2.7440088, -2.096173, 8.187564, -2.1331334, 0.095729604, -0.5923978]
Target sample: 91, Prediction:1, Target's Score:[-3.6382072, 7.072801, -1.392749, -2.482975, -3.2462554, -1.1480815, 5.9665885, -0.22015774, 1.2197738, -1.640832]
Current ATTACK acc on target samples: 93.750
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 21:06:15 Epoch 59, Val iteration 0, acc 92.600 (92.600)
2021-06-11 21:06:36 Epoch 59, Val iteration 19, acc 94.000 (93.490)
* Prec: 93.49000129699706
Per class accuracy =  [0.95960259 0.95696101 0.90353062 0.87066271 0.96102473 0.88546372
 0.95471508 0.93784859 0.95694242 0.96270203]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6
ATTACK acc: 88.75
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 21:06:40, Val iteration 0, acc 92.600 (92.600)
2021-06-11 21:06:45, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 21:06:47, Epoch 0, Iteration 7, loss 0.542 (0.329), acc 88.462 (90.400)
2021-06-11 21:07:15, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.5415666, 9.699419, -5.2292104, 0.29282105, -4.3885174, -2.6838207, 6.165911, -4.6713886, 2.7802668, -0.053635955]
Target sample: 7, Prediction:1, Target's Score:[-0.936265, 6.899938, -3.0396786, -0.43727386, -1.0920702, -2.4256306, 6.300857, -4.698421, -3.2847192, 3.077836]
Target sample: 13, Prediction:6, Target's Score:[-3.3239458, 5.09652, -3.2162073, 2.2803512, -3.289107, -2.209179, 7.380039, -5.849245, -3.7989564, 7.291658]
Target sample: 19, Prediction:6, Target's Score:[-3.9819164, 6.3260245, -3.099949, 3.3902516, -2.6636322, -2.499596, 7.7395744, -4.418343, -0.3251232, -0.10410713]
Target sample: 25, Prediction:6, Target's Score:[-3.702872, 6.5687165, -4.266449, 1.2577975, -3.3109324, -2.3879397, 9.724203, -3.2161677, -1.8116202, 1.4977518]
Target sample: 31, Prediction:1, Target's Score:[-3.0876882, 6.8480434, -4.5922914, 0.7504291, 1.8514159, -1.3307742, 5.9716463, -3.6091876, -3.6415522, 1.2119609]
Target sample: 37, Prediction:1, Target's Score:[-2.3901005, 8.13171, -3.9979386, 0.7178505, -0.11988788, -2.2895494, 5.6183534, -4.7329144, -3.7120516, 3.1628006]
Target sample: 43, Prediction:6, Target's Score:[-1.6247195, 1.7169604, -1.1161461, 3.1781406, -3.1389987, -3.082657, 9.96018, -5.6152225, 1.0464854, -0.9979471]
Target sample: 49, Prediction:6, Target's Score:[-2.9556203, 2.9211185, -3.6484082, 3.324139, 1.8607059, -3.2975647, 8.995277, -5.1060686, -0.26937714, -1.4856309]
Target sample: 55, Prediction:6, Target's Score:[-4.2639074, 5.7859926, -3.9506803, 1.6827515, -1.7844336, -2.5047169, 16.02974, -6.1295443, -2.151541, -2.3149612]
Target sample: 61, Prediction:1, Target's Score:[-4.0271654, 7.025034, -4.809788, 2.3037987, 1.0844963, -0.6478245, 4.625914, -4.4736524, -2.5703669, 1.8593343]
Target sample: 67, Prediction:6, Target's Score:[-3.8348749, 4.180451, -2.6227717, 2.8304892, 5.1015024, -1.4853344, 6.254085, -5.52298, -4.0724263, -0.41637412]
Target sample: 73, Prediction:1, Target's Score:[-2.6902795, 7.0669193, -3.673656, 0.52291304, 0.82196826, -2.2981732, 7.0367603, -4.165146, -3.0357935, 0.7827388]
Target sample: 79, Prediction:1, Target's Score:[-2.032254, 8.889675, -4.888802, -1.32445, -5.2214475, -1.0467494, 6.203068, -5.4701004, -0.60929954, 5.876816]
Target sample: 85, Prediction:9, Target's Score:[-3.2292078, -0.65890825, -0.13958749, -0.10040477, -1.4959319, -3.155327, 4.8110223, -2.7867742, 0.26232404, 6.797862]
Target sample: 91, Prediction:1, Target's Score:[1.6316596, 9.77333, -4.202244, -1.5880873, -4.6977534, -3.8928435, 3.937681, -3.9586651, 3.6751628, -0.32793948]
Current ATTACK acc on target samples: 43.750
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 21:07:42 Epoch 59, Val iteration 0, acc 89.400 (89.400)
2021-06-11 21:07:48 Epoch 59, Val iteration 19, acc 89.800 (89.530)
* Prec: 89.53000106811524
Per class accuracy =  [0.91744523 0.92681169 0.84008161 0.83518876 0.89279021 0.83046529
 0.93891764 0.89081883 0.9317159  0.94431343]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 1, 1, 6, 6, 1, 6, 9, 6, 9, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 1, 1, 1, 1, 4, 4, 4, 6, 4, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 9, 9, 6, 1, 9, 1, 1, 1, 1, 1, 8, 6, 1
ATTACK acc: 50.0
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 21:07:56, Val iteration 0, acc 96.200 (96.200)
2021-06-11 21:08:08, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 21:08:14, Epoch 0, Iteration 7, loss 0.390 (0.714), acc 90.385 (82.400)
2021-06-11 21:09:25, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-3.6886015, 11.038441, -1.7967823, -2.7377524, -3.8791845, -1.4203053, 7.209339, -2.414116, -1.4946016, -0.80378175]
Target sample: 7, Prediction:1, Target's Score:[-3.8830242, 12.174511, -2.2455761, -2.256959, -2.8390908, -2.820108, 5.887502, -3.4167147, -2.4909441, 1.9011242]
Target sample: 13, Prediction:9, Target's Score:[-3.7771745, 4.212555, -3.519776, -3.02851, -4.138759, -2.190308, 6.299978, -3.498257, -1.5876462, 11.25961]
Target sample: 19, Prediction:6, Target's Score:[-3.0511444, 3.6187239, -1.267697, 1.3288536, -3.3767612, -2.7019475, 6.7026553, -2.8022082, -0.6778423, 2.2397304]
Target sample: 25, Prediction:1, Target's Score:[-4.0471077, 8.976042, -1.7037868, -0.6282677, -4.401979, -3.5265312, 8.237053, -3.5995574, -2.4246633, 3.1306958]
Target sample: 31, Prediction:6, Target's Score:[-3.9376824, 5.126496, -1.9372638, -2.4525175, -2.9352725, -2.2682989, 10.780298, -2.740533, -1.8380599, 2.220284]
Target sample: 37, Prediction:1, Target's Score:[-3.8813102, 9.5926075, -2.5117953, -1.1761525, -1.6798221, -2.5845733, 6.519578, -3.591499, -1.4062159, 0.7288012]
Target sample: 43, Prediction:1, Target's Score:[-3.3294926, 9.327263, -2.6528847, -2.630823, -2.3661158, -0.8348888, 8.266608, -2.1388335, -2.1979957, -1.4284241]
Target sample: 49, Prediction:1, Target's Score:[-4.227979, 10.978959, -2.8669825, -3.062493, -2.6917417, -3.0045586, 10.246011, -3.4961898, -0.7551785, -1.1109037]
Target sample: 55, Prediction:6, Target's Score:[-4.401798, 8.248381, -2.113747, -2.5298479, -3.8328729, -2.4623618, 12.515628, -2.909503, -1.4976069, -1.0044589]
Target sample: 61, Prediction:6, Target's Score:[-4.038444, 3.5098042, -1.9961473, -1.6365563, -3.2506628, -3.132538, 9.975106, -3.2143264, -0.714261, 4.5162086]
Target sample: 67, Prediction:6, Target's Score:[-4.057002, 5.9772744, -1.3850926, -1.2894762, -3.6571548, -3.265449, 11.076797, -3.304922, -1.5817043, 1.4996693]
Target sample: 73, Prediction:1, Target's Score:[-3.9708657, 8.744455, -2.514827, -1.4460051, -3.3681, -2.9356387, 7.68986, -2.9452214, -1.413623, 2.1689386]
Target sample: 79, Prediction:9, Target's Score:[-3.9812562, 5.5593295, -2.7006261, -1.7752981, -3.9322412, -3.1976368, 6.3980527, -3.5144048, -0.14887372, 7.312896]
Target sample: 85, Prediction:1, Target's Score:[-4.38921, 7.1855397, -1.3189398, -0.3338433, -3.0278711, -2.5520053, 6.9629884, -3.223722, -2.095761, 2.8055131]
Target sample: 91, Prediction:1, Target's Score:[-3.4402657, 14.578983, -2.1682153, -3.7718346, -3.7334146, -1.957601, 4.525601, -2.5931733, -1.4231031, -0.00574404]
Current ATTACK acc on target samples: 31.250
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 21:10:36 Epoch 59, Val iteration 0, acc 93.000 (93.000)
2021-06-11 21:10:48 Epoch 59, Val iteration 19, acc 93.800 (93.200)
* Prec: 93.20000114440919
Per class accuracy =  [0.95654844 0.93216572 0.89310278 0.87649645 0.95689987 0.90060833
 0.95506257 0.93874015 0.94569643 0.96349955]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 6, 6, 1, 9, 9, 9, 9, 9, 1, 1, 9, 1, 6, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 6, 1, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 33.75
--------
------SUMMARY------
TIME ELAPSED (mins): 25
TARGET INDEX: 6
ResNet50 68.75 73.75 95.46000137329102 89.60000114440918
DPN92 93.75 88.75 95.50000267028808 93.49000129699706
MobileNetV2 43.75 50.0 91.22000160217286 89.53000106811524
GoogLeNet 31.25 33.75 95.41000213623047 93.20000114440919
True False False False True
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 129 images of target 7
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=7, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/7/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127]
# Targets: 22, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 21:11:09 Iteration 0 	 Training Loss: 8.857e-01 	 Loss in Target Net: 1.080e+00	  
tensor(-7.8288e-05, device='cuda:0')
 2021-06-11 21:12:27 Iteration 50 	 Training Loss: 3.810e-01 	 Loss in Target Net: 3.356e-01	  
tensor(-0.0735, device='cuda:0')
 2021-06-11 21:13:43 Iteration 100 	 Training Loss: 3.280e-01 	 Loss in Target Net: 3.502e-01	  
tensor(-0.1858, device='cuda:0')
 2021-06-11 21:15:02 Iteration 150 	 Training Loss: 3.060e-01 	 Loss in Target Net: 3.497e-01	  
tensor(-0.2729, device='cuda:0')
 2021-06-11 21:16:19 Iteration 200 	 Training Loss: 3.002e-01 	 Loss in Target Net: 3.418e-01	  
tensor(-0.3006, device='cuda:0')
 2021-06-11 21:17:37 Iteration 250 	 Training Loss: 2.943e-01 	 Loss in Target Net: 3.003e-01	  
tensor(-0.3095, device='cuda:0')
 2021-06-11 21:18:52 Iteration 300 	 Training Loss: 2.905e-01 	 Loss in Target Net: 3.130e-01	  
tensor(-0.3224, device='cuda:0')
 2021-06-11 21:20:12 Iteration 350 	 Training Loss: 2.922e-01 	 Loss in Target Net: 3.081e-01	  
tensor(-0.3255, device='cuda:0')
 2021-06-11 21:21:31 Iteration 400 	 Training Loss: 2.902e-01 	 Loss in Target Net: 2.872e-01	  
tensor(-0.3316, device='cuda:0')
 2021-06-11 21:22:47 Iteration 450 	 Training Loss: 2.869e-01 	 Loss in Target Net: 2.847e-01	  
tensor(-0.3385, device='cuda:0')
 2021-06-11 21:24:05 Iteration 500 	 Training Loss: 2.867e-01 	 Loss in Target Net: 3.042e-01	  
tensor(-0.3363, device='cuda:0')
 2021-06-11 21:25:23 Iteration 550 	 Training Loss: 2.858e-01 	 Loss in Target Net: 2.981e-01	  
tensor(-0.3451, device='cuda:0')
 2021-06-11 21:26:41 Iteration 600 	 Training Loss: 2.849e-01 	 Loss in Target Net: 2.992e-01	  
tensor(-0.3441, device='cuda:0')
 2021-06-11 21:28:01 Iteration 650 	 Training Loss: 2.853e-01 	 Loss in Target Net: 2.936e-01	  
tensor(-0.3459, device='cuda:0')
 2021-06-11 21:29:21 Iteration 700 	 Training Loss: 2.836e-01 	 Loss in Target Net: 3.168e-01	  
tensor(-0.3551, device='cuda:0')
 2021-06-11 21:30:42 Iteration 750 	 Training Loss: 2.832e-01 	 Loss in Target Net: 3.274e-01	  
tensor(-0.3546, device='cuda:0')
 2021-06-11 21:32:02 Iteration 800 	 Training Loss: 2.859e-01 	 Loss in Target Net: 3.314e-01	  
tensor(-0.3560, device='cuda:0')
 2021-06-11 21:33:20 Iteration 850 	 Training Loss: 2.862e-01 	 Loss in Target Net: 3.378e-01	  
tensor(-0.3481, device='cuda:0')
 2021-06-11 21:34:39 Iteration 900 	 Training Loss: 2.824e-01 	 Loss in Target Net: 3.085e-01	  
tensor(-0.3531, device='cuda:0')
 2021-06-11 21:36:03 Iteration 950 	 Training Loss: 2.833e-01 	 Loss in Target Net: 3.259e-01	  
tensor(-0.3532, device='cuda:0')
 2021-06-11 21:37:23 Iteration 999 	 Training Loss: 2.827e-01 	 Loss in Target Net: 3.103e-01	  
tensor(-0.3536, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 21:37:29, Val iteration 0, acc 94.200 (94.200)
2021-06-11 21:37:39, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 21:37:43, Epoch 0, Iteration 7, loss 0.191 (0.331), acc 92.308 (91.000)
2021-06-11 21:38:44, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.9515765, 4.314179, -2.228327, -1.2401903, -1.2462993, -2.5464277, 5.953832, -2.622585, 1.3025901, 0.5258726]
Target sample: 7, Prediction:6, Target's Score:[-1.4423695, 4.394602, -1.1159333, -0.8423284, -1.0465007, -1.7123739, 5.136538, -2.3509696, -0.6340087, -0.16749832]
Target sample: 13, Prediction:6, Target's Score:[-1.2917542, 0.20705351, -0.83730495, -0.3301608, -0.7099932, -1.6544474, 9.254595, -1.9568844, -1.1799016, -1.1702687]
Target sample: 19, Prediction:1, Target's Score:[-1.9064265, 10.197068, -0.56868595, -1.1535859, -2.3551173, -2.7663465, 3.8968349, -2.798848, -2.8831973, 0.53610516]
Target sample: 25, Prediction:1, Target's Score:[0.18361425, 7.6728735, -1.2470586, -1.2502024, -2.4296234, -2.867965, 4.5949535, -2.330213, -0.79531896, -1.2849878]
Target sample: 31, Prediction:6, Target's Score:[-1.638073, 5.3203197, -2.7774842, -1.4275972, -2.6443932, -3.2221477, 6.5909576, -2.8601391, 3.8032215, -0.82859564]
Target sample: 37, Prediction:1, Target's Score:[-1.640499, 7.355644, -1.7539266, -1.5270468, -2.4170494, -2.9803553, 5.5332856, -2.499363, 0.96814865, -0.772274]
Target sample: 43, Prediction:1, Target's Score:[-2.0084636, 11.773022, -0.97377646, -1.8152504, -2.645081, -2.9975064, 3.77497, -2.9964552, -2.3632555, 0.45775452]
Target sample: 49, Prediction:1, Target's Score:[-1.253957, 9.006975, 0.107604474, -1.0197004, -1.930148, -2.459938, 3.476153, -2.7295651, -2.650336, -0.3634204]
Target sample: 55, Prediction:6, Target's Score:[-0.2024703, 3.9028509, -1.1688948, -1.2126219, -1.6825217, -2.6198351, 7.590262, -2.2293591, -1.4789739, -0.6019562]
Target sample: 61, Prediction:6, Target's Score:[-1.5758665, 5.688728, -1.5430394, -0.6870168, -1.64791, -2.4037123, 6.2233605, -2.6073675, 0.16686484, -1.343578]
Target sample: 67, Prediction:1, Target's Score:[-2.0529966, 6.2108502, -1.6484265, -1.4372958, -0.2917112, -1.9709553, 4.8558416, -2.645782, -0.00245927, -0.788304]
Target sample: 73, Prediction:1, Target's Score:[-1.8801687, 6.474895, -1.2406117, -1.0824547, -1.5193985, -1.769261, 4.8445706, -2.8646684, -1.2475253, 0.49879834]
Target sample: 79, Prediction:1, Target's Score:[-1.8702862, 10.873489, -0.62808186, -1.5880935, -2.1071115, -2.200632, 3.3268044, -2.8440793, -2.7197638, -0.056810774]
Target sample: 85, Prediction:1, Target's Score:[-0.87564325, 9.331964, -0.5178807, -1.598932, -2.1943564, -2.5813177, 3.533314, -2.804034, -2.0686574, -0.030182937]
Target sample: 91, Prediction:1, Target's Score:[-1.6560819, 6.9903255, -1.4374666, -1.8066884, -2.2229834, -2.3655646, 4.6454515, -2.7009096, -1.5357575, 2.3089037]
Target sample: 97, Prediction:6, Target's Score:[-0.3806863, 1.7447628, -2.2211282, -1.620429, -2.396754, -3.153257, 8.317181, -1.8440073, 1.8037462, 0.09644415]
Target sample: 103, Prediction:1, Target's Score:[-1.0291299, 8.245871, -1.7049803, -1.3907107, -2.5387151, -2.655561, 3.7776208, -2.753228, -1.6314172, 1.8861701]
Target sample: 109, Prediction:1, Target's Score:[-2.1365929, 9.133176, -0.83263797, -1.8434684, -2.2556913, -2.8316767, 4.16151, -2.787501, -2.8436358, 2.4281814]
Target sample: 115, Prediction:6, Target's Score:[-0.68833876, 1.999493, 0.07574875, -0.834787, -0.9847325, -2.183991, 7.059402, -2.00995, -1.7885182, -0.38512257]
Target sample: 121, Prediction:1, Target's Score:[-2.011293, 4.5901856, -1.3462387, -0.66788375, -1.120509, -2.2984142, 4.465501, -2.6527774, -0.89044034, 2.1249042]
Target sample: 127, Prediction:6, Target's Score:[-2.7166317, 2.7620924, -2.158501, 0.050874982, -1.1991384, -2.2719257, 5.0498915, -3.2583764, 4.792226, -0.7873011]
Current ATTACK acc on target samples: 40.909
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 21:39:43 Epoch 59, Val iteration 0, acc 91.000 (91.000)
2021-06-11 21:39:54 Epoch 59, Val iteration 19, acc 92.400 (91.700)
* Prec: 91.70000190734864
Per class accuracy =  [0.95530823 0.94444296 0.86940413 0.81867734 0.947548   0.85190295
 0.96550065 0.93268323 0.92932274 0.95277635]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 1, 1, 1, 1, 1, 6, 1, 1, 6, 1, 1, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 9, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 42.99065420560748
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 21:40:05, Val iteration 0, acc 94.800 (94.800)
2021-06-11 21:40:26, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 21:40:39, Epoch 0, Iteration 7, loss 0.324 (0.400), acc 90.385 (90.800)
2021-06-11 21:43:18, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-3.8632615, -0.35702953, -2.7331727, 0.8515432, -0.8214856, -2.614639, 7.6418166, -1.8492343, 5.4845347, -1.2581466]
Target sample: 7, Prediction:6, Target's Score:[-4.025696, 0.11425053, -1.8212641, 0.92487997, -0.10785396, -2.2057228, 9.251129, -2.321248, 0.5242568, 0.10861033]
Target sample: 13, Prediction:6, Target's Score:[-3.6553936, -0.0314297, -1.2047915, -0.3896268, 0.11652542, -2.064427, 10.806413, -3.2725866, -0.0023166984, 0.122778445]
Target sample: 19, Prediction:1, Target's Score:[-1.4505272, 8.77358, -4.2797213, -2.5301821, -1.6138716, -1.6202985, 7.054301, -2.6408832, -0.2554918, -0.76036376]
Target sample: 25, Prediction:1, Target's Score:[-0.58995473, 10.726322, -4.206968, -2.9124694, -1.0059365, -2.8235345, 4.806808, -2.4410503, 0.38301438, -1.2285339]
Target sample: 31, Prediction:1, Target's Score:[-1.3873497, 8.359183, -4.3792615, -2.2612474, -0.94020796, -3.0554123, 5.3768177, -2.2981243, 2.3050325, -1.0672264]
Target sample: 37, Prediction:1, Target's Score:[-0.98012835, 6.91846, -3.7472196, -3.2337334, -0.36219504, -2.9082055, 5.653286, -2.4356282, 2.718038, -1.0052913]
Target sample: 43, Prediction:1, Target's Score:[-0.26309836, 11.577619, -4.5261345, -3.752629, -1.3295568, -2.627875, 4.625621, -2.5592518, 0.5801095, -0.9887149]
Target sample: 49, Prediction:1, Target's Score:[0.7770645, 11.668423, -3.6256053, -4.193793, -0.5873728, -3.3088348, 5.4336, -2.2044952, -1.1028123, -2.0824087]
Target sample: 55, Prediction:6, Target's Score:[-1.5274001, 3.607375, -2.1241221, -2.131376, 0.09930379, -2.9068406, 11.559728, -2.9528809, -0.820541, -2.2845747]
Target sample: 61, Prediction:6, Target's Score:[-2.9472487, 4.019085, -2.712293, -1.0763289, -0.54276067, -1.8785356, 7.8181105, -2.0469794, 1.4414148, -1.5583422]
Target sample: 67, Prediction:6, Target's Score:[-3.7936456, 2.6136827, -3.3499405, -1.8411913, -0.5397984, -1.6633451, 7.9179854, -2.7608397, 4.5901613, -0.65417165]
Target sample: 73, Prediction:1, Target's Score:[-2.0572069, 8.716903, -3.313061, -2.9700358, -1.044349, -1.9929819, 6.626236, -2.9897373, 0.7293806, -1.0709977]
Target sample: 79, Prediction:1, Target's Score:[-1.4522433, 10.709023, -3.9703825, -3.7599115, -0.30190107, -2.2817388, 5.9647994, -2.6245837, -0.6317397, -0.92725366]
Target sample: 85, Prediction:1, Target's Score:[-0.8887618, 9.645658, -4.0004907, -3.2944605, -1.1062429, -1.2087287, 4.3846154, -2.8363945, -0.123794824, 0.10402323]
Target sample: 91, Prediction:1, Target's Score:[-0.2910548, 10.653597, -4.965633, -3.8003953, -2.1580486, -1.407723, 4.103599, -2.5195043, 0.661319, 0.44910014]
Target sample: 97, Prediction:1, Target's Score:[-0.61479074, 7.2846518, -4.561585, -2.5726917, -1.2970396, -2.908251, 6.233707, -2.1995494, 2.911411, -1.663717]
Target sample: 103, Prediction:1, Target's Score:[-0.88656294, 10.876366, -4.5920267, -2.572437, -1.8736047, -2.200136, 3.9946833, -2.4563947, 0.76224375, -0.3472551]
Target sample: 109, Prediction:1, Target's Score:[-0.68709296, 11.490305, -4.065986, -3.3417394, -1.369715, -2.9559314, 4.3552775, -2.478905, 0.24428178, -0.4777247]
Target sample: 115, Prediction:6, Target's Score:[-2.524933, 1.7536224, -2.0143845, -1.5732192, 0.6600679, -2.7880492, 10.801589, -3.3830273, -0.63165987, 0.1645872]
Target sample: 121, Prediction:3, Target's Score:[-4.3645315, 0.3752229, -1.8039541, 4.4129224, -0.84727, -2.9587517, 3.1085634, -1.5897502, 0.5744282, 3.5797021]
Target sample: 127, Prediction:6, Target's Score:[-5.051142, -0.9097779, -1.4733187, 1.1787068, -0.05831777, -2.089641, 7.9172816, -2.9999855, 3.1284206, 0.8381558]
Current ATTACK acc on target samples: 36.364
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 21:45:54 Epoch 59, Val iteration 0, acc 93.600 (93.600)
2021-06-11 21:46:15 Epoch 59, Val iteration 19, acc 94.400 (93.200)
* Prec: 93.2000015258789
Per class accuracy =  [0.94826406 0.96563679 0.89730349 0.85260297 0.93035789 0.88085375
 0.96703101 0.95312974 0.97750864 0.94930151]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 44.85981308411215
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 21:46:19, Val iteration 0, acc 92.600 (92.600)
2021-06-11 21:46:25, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 21:46:27, Epoch 0, Iteration 7, loss 0.209 (0.357), acc 94.231 (90.200)
2021-06-11 21:46:55, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:9, Target's Score:[-2.2319758, 2.2993803, -3.3591511, 4.760023, -2.6753216, -3.015388, 0.04533903, -3.7776153, 3.2480943, 5.0383654]
Target sample: 7, Prediction:3, Target's Score:[-1.2338908, 3.5182033, 0.35547888, 4.0185246, -3.8790534, -2.4481966, -0.45956352, -3.2972875, -0.04720874, 3.8343663]
Target sample: 13, Prediction:6, Target's Score:[-0.8053975, -1.1823337, -2.576777, 5.216633, -4.1127305, -1.9819791, 8.042913, -5.4630747, 1.2487031, 1.8616853]
Target sample: 19, Prediction:1, Target's Score:[-0.47052458, 11.605967, -5.1418014, 3.1811411, -5.0316553, -1.2402818, 2.8666186, -4.6186194, -3.2733777, 2.516023]
Target sample: 25, Prediction:1, Target's Score:[-0.8550746, 10.125762, -3.3089669, 0.88231254, -3.3400724, -2.982933, 3.923883, -5.888777, 1.8990918, -0.029431457]
Target sample: 31, Prediction:1, Target's Score:[2.4827168, 12.9845495, -3.305093, 2.5094788, -5.198496, -3.249287, -0.5452607, -5.590242, -0.54973096, 0.91297597]
Target sample: 37, Prediction:1, Target's Score:[-1.2158912, 11.309908, -4.6127734, 4.0443983, -3.1185982, -1.7865119, 0.54682523, -5.9620028, 1.1500509, 0.09361524]
Target sample: 43, Prediction:1, Target's Score:[-1.4872571, 11.887801, -5.422641, 1.0566448, -0.6944717, 0.50595224, 1.625591, -5.3987985, -2.5329933, 0.9311638]
Target sample: 49, Prediction:1, Target's Score:[-0.5113569, 12.941134, -4.102127, 0.82727826, -2.3721507, -1.132773, 2.3709946, -5.193171, -4.398121, 2.03824]
Target sample: 55, Prediction:1, Target's Score:[-1.3255191, 11.350724, -5.1552653, 3.7970593, -5.409058, -2.266599, 2.4922915, -5.603441, -2.7472134, 5.3062816]
Target sample: 61, Prediction:6, Target's Score:[-2.049567, 4.903992, -2.787613, 1.921767, -4.9683385, -2.7867117, 5.461776, -5.6548853, 3.7452784, 2.5722442]
Target sample: 67, Prediction:1, Target's Score:[-2.3776245, 6.8640366, -3.9593105, 1.619648, -5.103833, -1.2252914, 5.128053, -6.2701616, 3.0994186, 2.5978084]
Target sample: 73, Prediction:1, Target's Score:[0.38606378, 11.169299, -3.1246302, 4.297029, -4.85506, -1.4088024, 1.051883, -7.118347, -3.3386602, 3.3793287]
Target sample: 79, Prediction:1, Target's Score:[0.25712395, 16.597372, -3.9601917, -0.84645236, -5.1303253, -2.0635507, 0.2048713, -4.9541316, -1.2696099, 1.640826]
Target sample: 85, Prediction:1, Target's Score:[-0.17411733, 10.813842, -4.15659, 2.3027515, -5.4608517, -1.0409546, 3.6318514, -6.245537, 1.9505041, -1.225337]
Target sample: 91, Prediction:1, Target's Score:[0.3176345, 12.667684, -3.6528313, 0.39408702, -5.703338, -2.6549795, 1.2122313, -5.397373, 2.4546497, 0.7938923]
Target sample: 97, Prediction:1, Target's Score:[-0.15752527, 13.091096, -4.726572, 0.12580045, -4.4035954, -3.1589556, 2.7104712, -5.6975317, 3.623496, -0.95858926]
Target sample: 103, Prediction:1, Target's Score:[-0.6961924, 13.186123, -5.1967764, 1.2063799, -4.610302, -2.102237, -0.2224288, -4.347064, -3.0856326, 6.3412347]
Target sample: 109, Prediction:1, Target's Score:[0.31934333, 9.914693, -5.7692533, 4.0625277, -4.705455, -2.2555702, 2.3674254, -4.2156477, -3.3916364, 4.074905]
Target sample: 115, Prediction:1, Target's Score:[-0.81459266, 6.905864, -3.4314005, 3.5284595, -3.3043375, -3.7707915, 0.773338, -4.2681603, 2.7459767, 2.021204]
Target sample: 121, Prediction:9, Target's Score:[-3.062374, -1.7307053, -2.3622603, 3.7932606, -1.8282306, -3.1990817, 1.775011, -2.5278978, 1.0866672, 8.373016]
Target sample: 127, Prediction:1, Target's Score:[0.5373559, 6.625481, -3.0188308, 4.4928026, -5.624774, -1.1341633, -0.50318825, -5.48796, -1.8679651, 6.377012]
Current ATTACK acc on target samples: 9.091
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 21:47:22 Epoch 59, Val iteration 0, acc 89.400 (89.400)
2021-06-11 21:47:29 Epoch 59, Val iteration 19, acc 90.400 (89.410)
* Prec: 89.41000061035156
Per class accuracy =  [0.92835663 0.9221572  0.84273733 0.82396654 0.89324357 0.81890937
 0.93975425 0.88877447 0.93285386 0.94493966]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 3, 9, 9, 3, 3, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 6, 1, 3, 1, 1, 1, 1, 9, 9, 9, 9, 3, 3, 9, 3, 3
ATTACK acc: 2.803738317757009
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 21:47:36, Val iteration 0, acc 96.200 (96.200)
2021-06-11 21:47:48, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 21:47:55, Epoch 0, Iteration 7, loss 0.622 (0.673), acc 75.000 (81.000)
2021-06-11 21:49:07, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:8, Target's Score:[-3.0312421, 0.8965964, -4.166395, -1.8441262, -2.9009478, -5.1458306, 5.8182225, -3.9993982, 17.136465, -2.6102357]
Target sample: 7, Prediction:6, Target's Score:[-4.4354043, 2.7581303, -0.7597081, -1.5921843, -1.7579664, -4.3507223, 7.64634, -2.697561, 4.181756, 1.1243544]
Target sample: 13, Prediction:6, Target's Score:[-2.8983567, 5.6751213, -2.7921631, -1.1848623, -2.6120367, -4.148764, 11.075048, -2.6132905, 1.1108809, -1.5183998]
Target sample: 19, Prediction:1, Target's Score:[-0.24348275, 8.8207655, -3.158449, 0.7795805, -2.8463023, -4.9369173, 6.8029013, -2.7265205, -1.8410289, -0.54448557]
Target sample: 25, Prediction:1, Target's Score:[-1.0796393, 10.484155, -3.6427634, -1.0668075, -2.1937044, -5.580237, 5.16663, -2.9572318, 1.7960103, -0.80643827]
Target sample: 31, Prediction:6, Target's Score:[1.5082834, 5.747803, -2.358945, -1.5310756, -2.3558125, -5.6366167, 8.325925, -3.2401695, 0.19282281, -0.54046625]
Target sample: 37, Prediction:6, Target's Score:[-0.38746792, 7.166383, -3.0028055, -1.858431, -2.2230806, -5.7842283, 7.7848945, -4.197927, 3.721356, -1.0941368]
Target sample: 43, Prediction:1, Target's Score:[-2.8894484, 11.841115, -4.0595894, 0.27970442, -3.3379798, -5.197345, 6.9246373, -3.325017, -1.5770977, 1.4546207]
Target sample: 49, Prediction:1, Target's Score:[-2.4410806, 10.825, -2.678107, -0.9768618, -0.63425136, -5.04522, 4.7737393, -1.4323374, -1.8771739, -0.4016535]
Target sample: 55, Prediction:6, Target's Score:[-0.18723996, 4.1329827, -4.0585046, 2.2324383, -1.9842981, -5.4492445, 8.684817, -2.5045805, -0.024723709, -0.7372414]
Target sample: 61, Prediction:6, Target's Score:[-3.0078845, 2.7290473, -4.1603155, 1.1482997, -2.0878468, -4.360037, 8.0799465, -2.7507463, 6.7298617, -2.2026992]
Target sample: 67, Prediction:6, Target's Score:[-5.1446548, 4.470304, -2.9146383, 1.364969, 0.6116971, -4.6791945, 6.3026214, -4.508863, 6.1623454, -1.5357795]
Target sample: 73, Prediction:1, Target's Score:[-2.8710964, 7.713056, -3.5243037, 1.1268029, -1.7593302, -4.819763, 6.2662544, -3.681141, -1.908143, 3.577466]
Target sample: 79, Prediction:1, Target's Score:[-2.325302, 9.802798, -2.627196, -1.1426783, -1.5288366, -4.8249826, 4.985608, -2.7675793, -2.0907516, 2.6341095]
Target sample: 85, Prediction:1, Target's Score:[-2.2864764, 8.901681, -3.685686, -0.090444535, -2.927608, -3.0475333, 6.985143, -3.6367307, -1.5354445, 1.4313395]
Target sample: 91, Prediction:6, Target's Score:[1.4455832, 6.213484, -2.512462, -2.8352754, -3.1816237, -4.6919484, 7.7982545, -3.8854136, 0.52086323, 1.249674]
Target sample: 97, Prediction:6, Target's Score:[2.3905213, 4.5899916, -2.5312545, -3.1112065, -1.8049144, -5.7180667, 8.490942, -3.1700742, 1.4832621, -0.50255656]
Target sample: 103, Prediction:1, Target's Score:[0.044231284, 8.511656, -2.8638377, -1.8187003, -2.23732, -4.970537, 5.2519894, -3.701264, -0.0073134303, 1.9072497]
Target sample: 109, Prediction:1, Target's Score:[-2.8978317, 12.72604, -2.1911283, -0.12215218, -3.9423862, -4.9441457, 4.0182934, -2.3539584, -1.2879698, 1.1073775]
Target sample: 115, Prediction:6, Target's Score:[-2.2130053, 2.845606, -3.2525256, -0.007423522, -2.2155852, -5.2158403, 9.630348, -2.8097348, 1.009284, 2.347232]
Target sample: 121, Prediction:8, Target's Score:[-4.137176, 5.2055535, -3.6146946, 0.98320484, -2.2710314, -5.38447, 5.0427365, -3.3613956, 5.5682364, 2.1038456]
Target sample: 127, Prediction:8, Target's Score:[-4.9461665, 3.727031, -3.920037, 1.5604656, -1.5940337, -3.2617898, 4.39517, -4.3484116, 9.887544, -1.3752221]
Current ATTACK acc on target samples: 45.455
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 21:50:17 Epoch 59, Val iteration 0, acc 93.000 (93.000)
2021-06-11 21:50:30 Epoch 59, Val iteration 19, acc 92.800 (92.220)
* Prec: 92.22000083923339
Per class accuracy =  [0.94155002 0.92231577 0.8874608  0.85328005 0.94172941 0.897193
 0.94497982 0.92992691 0.96620918 0.93406016]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 8, 8, 8, 6, 6, 6, 6, 6, 6, 1, 6, 1, 1, 1, 6, 1, 6, 6, 1, 6, 1, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 6, 8, 8, 8, 8, 6, 8, 6, 6, 6, 6, 1, 1, 6, 1, 1, 1, 6, 6, 6, 6, 6, 1, 1, 1, 6, 1, 6, 1, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 6, 1, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 8, 8, 8, 8, 8, 8, 6
ATTACK acc: 41.12149532710281
--------
------SUMMARY------
TIME ELAPSED (mins): 26
TARGET INDEX: 7
ResNet50 40.90909090909091 42.99065420560748 95.46000137329102 91.70000190734864
DPN92 36.36363636363637 44.85981308411215 95.50000267028808 93.2000015258789
MobileNetV2 9.090909090909092 2.803738317757009 91.22000160217286 89.41000061035156
GoogLeNet 45.45454545454545 41.12149532710281 95.41000213623047 92.22000083923339
True False False False True
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 170 images of target 8
All target indices used in crafting poisons: [1, 6, 11, 16, 21, 26, 31, 36, 41, 46, 51, 56, 61, 66, 71, 76, 81, 86, 91, 96, 101, 106, 111, 116, 121, 126, 131, 136, 141, 146, 151, 156, 161, 166]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=8, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/8/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 6, 11, 16, 21, 26, 31, 36, 41, 46, 51, 56, 61, 66, 71, 76, 81, 86, 91, 96, 101, 106, 111, 116, 121, 126, 131, 136, 141, 146, 151, 156, 161, 166]
# Targets: 34, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 21:50:53 Iteration 0 	 Training Loss: 8.794e-01 	 Loss in Target Net: 1.066e+00	  
tensor(0.0001, device='cuda:0')
 2021-06-11 21:52:25 Iteration 50 	 Training Loss: 3.547e-01 	 Loss in Target Net: 2.526e-01	  
tensor(-0.0484, device='cuda:0')
 2021-06-11 21:54:05 Iteration 100 	 Training Loss: 3.064e-01 	 Loss in Target Net: 2.333e-01	  
tensor(-0.1085, device='cuda:0')
 2021-06-11 21:55:41 Iteration 150 	 Training Loss: 2.933e-01 	 Loss in Target Net: 2.335e-01	  
tensor(-0.1262, device='cuda:0')
 2021-06-11 21:57:11 Iteration 200 	 Training Loss: 2.901e-01 	 Loss in Target Net: 2.280e-01	  
tensor(-0.1325, device='cuda:0')
 2021-06-11 21:58:50 Iteration 250 	 Training Loss: 2.838e-01 	 Loss in Target Net: 2.065e-01	  
tensor(-0.1363, device='cuda:0')
 2021-06-11 22:00:26 Iteration 300 	 Training Loss: 2.817e-01 	 Loss in Target Net: 2.151e-01	  
tensor(-0.1400, device='cuda:0')
 2021-06-11 22:01:59 Iteration 350 	 Training Loss: 2.819e-01 	 Loss in Target Net: 2.066e-01	  
tensor(-0.1392, device='cuda:0')
 2021-06-11 22:03:38 Iteration 400 	 Training Loss: 2.815e-01 	 Loss in Target Net: 2.095e-01	  
tensor(-0.1382, device='cuda:0')
 2021-06-11 22:05:14 Iteration 450 	 Training Loss: 2.846e-01 	 Loss in Target Net: 2.111e-01	  
tensor(-0.1419, device='cuda:0')
 2021-06-11 22:06:49 Iteration 500 	 Training Loss: 2.807e-01 	 Loss in Target Net: 2.033e-01	  
tensor(-0.1437, device='cuda:0')
 2021-06-11 22:08:45 Iteration 550 	 Training Loss: 2.784e-01 	 Loss in Target Net: 2.044e-01	  
tensor(-0.1469, device='cuda:0')
 2021-06-11 22:10:33 Iteration 600 	 Training Loss: 2.762e-01 	 Loss in Target Net: 1.993e-01	  
tensor(-0.1502, device='cuda:0')
 2021-06-11 22:12:25 Iteration 650 	 Training Loss: 2.768e-01 	 Loss in Target Net: 2.045e-01	  
tensor(-0.1486, device='cuda:0')
 2021-06-11 22:14:20 Iteration 700 	 Training Loss: 2.754e-01 	 Loss in Target Net: 2.034e-01	  
tensor(-0.1473, device='cuda:0')
 2021-06-11 22:16:17 Iteration 750 	 Training Loss: 2.829e-01 	 Loss in Target Net: 1.987e-01	  
tensor(-0.1447, device='cuda:0')
 2021-06-11 22:18:09 Iteration 800 	 Training Loss: 2.779e-01 	 Loss in Target Net: 2.056e-01	  
tensor(-0.1440, device='cuda:0')
 2021-06-11 22:20:01 Iteration 850 	 Training Loss: 2.781e-01 	 Loss in Target Net: 2.014e-01	  
tensor(-0.1433, device='cuda:0')
 2021-06-11 22:21:42 Iteration 900 	 Training Loss: 2.766e-01 	 Loss in Target Net: 2.058e-01	  
tensor(-0.1434, device='cuda:0')
 2021-06-11 22:23:42 Iteration 950 	 Training Loss: 2.788e-01 	 Loss in Target Net: 2.027e-01	  
tensor(-0.1434, device='cuda:0')
 2021-06-11 22:25:33 Iteration 999 	 Training Loss: 2.756e-01 	 Loss in Target Net: 1.965e-01	  
tensor(-0.1421, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 22:25:38, Val iteration 0, acc 94.200 (94.200)
2021-06-11 22:25:48, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 22:25:53, Epoch 0, Iteration 7, loss 0.626 (0.272), acc 80.769 (93.400)
2021-06-11 22:26:54, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.2343893, 7.4071593, -1.8277738, -3.0089698, -2.1220338, -2.8245783, 7.655979, 0.20497128, -0.5050808, -3.3396041]
Target sample: 6, Prediction:6, Target's Score:[-1.4248514, 3.7665431, -1.083894, -2.899831, 1.6434227, -3.0170135, 6.3965907, -1.5003732, 0.2315983, -1.7561696]
Target sample: 11, Prediction:1, Target's Score:[-2.7548134, 6.8939285, -0.38986412, -3.3021228, -0.29167193, -3.2708347, 4.558814, -1.9312533, -2.0794094, 2.9948897]
Target sample: 16, Prediction:6, Target's Score:[-0.84947795, 2.262531, 0.63606006, -3.3740947, -1.1721785, -3.2891326, 11.83846, -1.023161, -1.9085976, -2.7271454]
Target sample: 21, Prediction:1, Target's Score:[-1.9439602, 9.8361225, -1.010601, -3.3868597, -1.4644785, -3.2744398, 8.5252075, -1.2929517, -1.7693409, -3.7565677]
Target sample: 26, Prediction:1, Target's Score:[-2.111231, 10.502196, -0.9930102, -3.237082, -1.7025043, -2.9531329, 6.9566097, -1.2720762, -1.9385934, -2.7987275]
Target sample: 31, Prediction:1, Target's Score:[-2.359876, 13.727608, -1.3530531, -4.162238, -2.500248, -3.6788778, 7.479524, -0.6538679, -1.6401012, -4.3404636]
Target sample: 36, Prediction:1, Target's Score:[-2.33025, 12.595065, -1.1302781, -4.00439, -1.9669883, -3.6571705, 6.734256, -1.1617424, -1.5473883, -3.0277512]
Target sample: 41, Prediction:1, Target's Score:[-1.8715411, 10.729826, -1.1561711, -2.816796, -1.6697129, -3.3446832, 6.1077056, -1.265316, -1.1069963, -3.1623287]
Target sample: 46, Prediction:6, Target's Score:[1.4967939, 3.1766095, -1.6030867, -3.4043043, 1.0569694, -3.0811121, 4.1757812, -0.33651865, 1.6303345, -2.7855089]
Target sample: 51, Prediction:1, Target's Score:[-0.80921435, 7.214136, -1.3557407, -2.739106, -0.7326368, -2.8191955, 4.6824923, -0.3580904, 0.8319508, -3.5462441]
Target sample: 56, Prediction:1, Target's Score:[-0.060100786, 6.7066364, -1.5342275, -2.9800024, -1.1174287, -3.00958, 5.318634, -0.4495773, 1.2989209, -3.821618]
Target sample: 61, Prediction:1, Target's Score:[-0.9722908, 10.409325, -1.769222, -3.759254, -2.4203734, -3.1586194, 6.909409, 0.3671583, -0.1857235, -4.9852195]
Target sample: 66, Prediction:1, Target's Score:[-1.7029727, 13.878742, -2.010945, -3.3775582, -3.0690866, -3.613272, 6.722934, -0.17390846, -1.1617484, -4.988668]
Target sample: 71, Prediction:1, Target's Score:[-1.4478937, 11.334651, -1.9366558, -3.1377828, -1.7829133, -3.4774249, 7.508911, -0.106448285, -1.1187065, -5.3507414]
Target sample: 76, Prediction:1, Target's Score:[-1.8693993, 10.938857, -1.3560104, -3.4568408, -1.8066512, -3.346846, 7.721301, -1.1190246, -1.6086507, -3.624575]
Target sample: 81, Prediction:1, Target's Score:[-1.4494596, 10.046486, -1.1789815, -3.7050214, -1.372598, -3.5791945, 8.762624, -0.9558441, -1.7315254, -4.3650904]
Target sample: 86, Prediction:6, Target's Score:[-1.3498441, 7.05983, -0.6439093, -3.8983412, -1.2643554, -3.4619443, 8.353898, -0.2317859, -1.7137945, -2.4175706]
Target sample: 91, Prediction:1, Target's Score:[-0.38025874, 8.790971, -1.6033292, -2.621949, -1.9000226, -3.205388, 6.1654835, 0.09292404, -0.9183196, -3.9961755]
Target sample: 96, Prediction:1, Target's Score:[-2.4716034, 12.159955, -1.5220485, -3.0815873, -1.5140567, -3.281074, 5.1483192, -0.60202193, -1.980273, -2.378772]
Target sample: 101, Prediction:1, Target's Score:[-1.2064813, 9.888137, -1.2328169, -3.4441285, -1.3406686, -3.393937, 6.270261, 0.5924952, -1.8164666, -3.853822]
Target sample: 106, Prediction:6, Target's Score:[-1.3518808, 7.607817, -1.2105199, -4.205926, -1.1260297, -3.7162993, 11.429947, -1.2112843, -1.8895944, -3.845392]
Target sample: 111, Prediction:1, Target's Score:[-1.0520576, 12.74284, -1.848023, -4.175922, -2.8994396, -3.53004, 7.962975, -0.15844588, -1.235792, -5.31325]
Target sample: 116, Prediction:1, Target's Score:[-2.0703936, 14.063671, -2.1772196, -4.414644, -3.1127079, -3.5269258, 7.639211, 0.15086411, -0.5221947, -5.521206]
Target sample: 121, Prediction:1, Target's Score:[-1.5975882, 14.007204, -2.2526774, -3.7479293, -3.0966055, -3.3056598, 5.828945, 0.007130649, -0.85712737, -4.4927106]
Target sample: 126, Prediction:1, Target's Score:[-0.77063686, 7.080702, -1.6541483, -3.10488, -0.91901433, -3.0182161, 5.664854, -1.1219716, 1.528576, -3.3184612]
Target sample: 131, Prediction:6, Target's Score:[-0.03492584, 2.0480332, -1.1143805, -2.4439747, 1.1860331, -2.8943837, 4.978801, -0.79320276, 2.2730882, -2.8902051]
Target sample: 136, Prediction:6, Target's Score:[0.94086415, 2.8922083, -1.236294, -2.689435, -1.3677479, -2.802669, 4.609068, -1.304157, 3.7472987, -2.488216]
Target sample: 141, Prediction:6, Target's Score:[1.1872045, 3.768475, -1.1564475, -3.516618, -0.8922639, -2.9248908, 4.9483085, -1.0188385, 2.5158043, -2.6057854]
Target sample: 146, Prediction:1, Target's Score:[-1.7895044, 8.66652, -0.6012369, -3.9682643, -1.8943397, -3.3404415, 8.3691435, -1.6263202, -2.0749223, -1.2922565]
Target sample: 151, Prediction:1, Target's Score:[-1.8042378, 11.429799, -1.3148841, -3.544135, -1.8364186, -3.2206168, 6.3509154, -0.9467031, -1.6869758, -2.973339]
Target sample: 156, Prediction:1, Target's Score:[-1.4430746, 8.986643, -0.47313917, -3.38728, -1.242562, -3.2545366, 6.7795515, -1.8424197, -2.1439817, -1.5341799]
Target sample: 161, Prediction:6, Target's Score:[-1.9043206, 3.189888, 2.0768714, -3.6796126, -0.40759844, -3.6105363, 10.250992, -2.5371745, -2.6162767, -0.33791682]
Target sample: 166, Prediction:6, Target's Score:[-2.2272792, 6.070848, -1.5974094, -3.1569407, -1.0881656, -2.9753916, 7.696184, -0.3748257, -0.6429064, -1.3077629]
Current ATTACK acc on target samples: 32.353
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 22:27:53 Epoch 59, Val iteration 0, acc 92.800 (92.800)
2021-06-11 22:28:04 Epoch 59, Val iteration 19, acc 92.800 (92.190)
* Prec: 92.19000091552735
Per class accuracy =  [0.94908486 0.94325957 0.86001955 0.868987   0.94849514 0.86611294
 0.94926106 0.92244257 0.95566064 0.95771163]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 1, 1, 1, 8, 1, 1, 6, 6, 6, 1, 1, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6
ATTACK acc: 27.941176470588236
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 22:28:15, Val iteration 0, acc 94.800 (94.800)
2021-06-11 22:28:36, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 22:28:49, Epoch 0, Iteration 7, loss 0.255 (0.400), acc 94.231 (91.600)
2021-06-11 22:31:29, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.2900127, 0.66524166, -2.068665, -0.41706878, -1.0491533, -3.0968707, 9.072618, -2.923218, 1.4161404, 0.00081838854]
Target sample: 6, Prediction:6, Target's Score:[-1.9565358, 1.1156816, -2.8894691, -1.5456553, -0.8528821, -3.3059402, 6.7404613, -3.224516, 5.286875, 0.9666072]
Target sample: 11, Prediction:6, Target's Score:[-1.4536439, 1.2117685, -2.7139919, -1.6704963, -1.11627, -2.9609096, 9.033924, -3.4475672, 1.4604278, 1.9716113]
Target sample: 16, Prediction:6, Target's Score:[-0.91924787, -2.0309753, -0.38331082, -1.5776508, -0.6508567, -2.5095365, 10.562414, -3.603595, 1.543625, -0.13135672]
Target sample: 21, Prediction:1, Target's Score:[-1.1434442, 7.187293, -1.9586965, -2.3989713, -1.5811238, -2.736025, 6.581165, -2.855502, -0.9285333, 0.1405569]
Target sample: 26, Prediction:1, Target's Score:[-1.5264716, 7.406465, -2.2291458, -2.2926118, -2.2046144, -3.041592, 5.2545614, -3.0346625, -0.63711643, 2.6193]
Target sample: 31, Prediction:1, Target's Score:[-1.5996138, 11.636238, -3.1908731, -2.5764086, -3.3862183, -3.3191476, 4.9714084, -3.1968272, 0.88920575, 0.12688804]
Target sample: 36, Prediction:1, Target's Score:[-0.9204839, 10.79447, -2.7140257, -2.2814915, -3.4277976, -3.478306, 5.1317263, -2.810851, -0.06580392, 0.11666183]
Target sample: 41, Prediction:1, Target's Score:[-1.3528355, 10.015015, -2.6889346, -2.1527972, -2.9171412, -3.273628, 4.708999, -2.7311873, 0.23429583, 0.49020678]
Target sample: 46, Prediction:1, Target's Score:[-0.9395411, 7.2432203, -2.8640218, -2.469837, -1.7966161, -3.430313, 5.6876993, -2.3480227, 1.2537442, -0.018915737]
Target sample: 51, Prediction:1, Target's Score:[-1.9299448, 8.64386, -2.988452, -2.0144527, -2.0898063, -3.272553, 4.7481747, -2.3805819, 2.3702233, -0.76677984]
Target sample: 56, Prediction:1, Target's Score:[-0.693488, 8.143978, -2.978562, -2.2420237, -2.638914, -3.5217066, 5.3671317, -2.4160855, 1.992159, -0.6929695]
Target sample: 61, Prediction:1, Target's Score:[-0.72503996, 10.093408, -2.8475316, -2.5693133, -3.053704, -3.5462909, 4.083382, -2.9636078, 3.074355, -1.2036599]
Target sample: 66, Prediction:1, Target's Score:[-1.1470519, 10.981849, -2.619982, -2.317186, -3.2243938, -3.641306, 6.1543355, -3.0864162, 0.6439792, -1.3817604]
Target sample: 71, Prediction:6, Target's Score:[-1.2438136, 6.180805, -2.0684893, -2.1239526, -0.34934792, -3.3723898, 7.814531, -2.8375957, 0.44505847, -2.1103773]
Target sample: 76, Prediction:1, Target's Score:[-1.3135926, 10.02551, -2.6402729, -2.0953364, -2.2115104, -3.5476162, 5.940576, -2.955305, 0.19255106, -1.0377884]
Target sample: 81, Prediction:1, Target's Score:[-0.24074058, 7.88766, -1.4868209, -2.005473, -1.326614, -3.470971, 5.9570017, -2.7046328, -1.146197, -1.1271031]
Target sample: 86, Prediction:6, Target's Score:[-0.7671362, 0.37345207, -0.7945568, -1.2425075, 1.5706367, -3.3063242, 9.256017, -1.9334924, -0.22418173, -2.6295905]
Target sample: 91, Prediction:6, Target's Score:[-0.54674387, 3.1887, -2.329828, -1.4596555, -1.2588273, -3.033321, 8.500827, -2.1639295, 1.6099378, -2.208685]
Target sample: 96, Prediction:6, Target's Score:[-1.25037, 6.0592704, -2.2642827, -1.5272925, -1.2705956, -3.1210701, 7.4132657, -2.3394082, -0.06113121, -1.3250062]
Target sample: 101, Prediction:6, Target's Score:[-0.66394544, 3.4252374, -1.299489, -1.9700518, -1.1015217, -2.9264085, 9.493137, -2.3158371, -0.33284616, -2.00789]
Target sample: 106, Prediction:6, Target's Score:[-0.5741521, 3.3149328, -1.4413674, -1.8804667, -1.9837344, -2.9635217, 10.202399, -3.2389424, -0.91015214, -0.21704474]
Target sample: 111, Prediction:1, Target's Score:[-0.44153872, 9.860227, -2.0066237, -2.6466544, -2.120222, -3.4278367, 5.3088613, -2.6620595, -0.26687706, -1.252661]
Target sample: 116, Prediction:1, Target's Score:[-1.4788059, 9.810647, -2.1987724, -2.3867226, -1.9108498, -3.5067286, 5.74051, -2.758282, 0.15137613, -1.1112175]
Target sample: 121, Prediction:1, Target's Score:[-1.1893437, 13.264723, -3.0781138, -2.9509726, -3.0147474, -3.6147661, 3.851741, -3.103755, 0.357786, -0.14870511]
Target sample: 126, Prediction:1, Target's Score:[-2.0856059, 7.668023, -3.2501457, -1.9109887, -1.6844512, -3.35739, 4.7452683, -3.11427, 2.6480784, 0.67512715]
Target sample: 131, Prediction:6, Target's Score:[-2.038056, 2.6828253, -2.2915614, -2.0423102, 1.0013068, -3.358312, 5.469975, -1.7789893, 3.897254, -1.2267573]
Target sample: 136, Prediction:6, Target's Score:[-0.8577156, 6.696549, -3.4846568, -1.9540184, -3.3443935, -3.404718, 7.37914, -3.3862293, 1.4521489, 1.2386211]
Target sample: 141, Prediction:6, Target's Score:[-0.088205084, 4.7464514, -3.8925722, -2.4093554, -2.9479055, -3.779332, 5.5509963, -3.7571461, 4.0555725, 2.883312]
Target sample: 146, Prediction:1, Target's Score:[-0.90702593, 8.118189, -3.0252752, -2.0939252, -3.6241856, -3.3860517, 7.7019553, -3.9100025, -0.2833362, 1.7681681]
Target sample: 151, Prediction:1, Target's Score:[-1.2159518, 8.501492, -2.7411733, -2.1410172, -2.9121351, -3.414995, 6.8982067, -3.7425067, -0.35673028, 1.4715929]
Target sample: 156, Prediction:1, Target's Score:[-1.3877923, 6.8687463, -1.6740035, -1.6859151, -1.7352471, -3.021169, 6.312027, -3.032524, 0.16873862, -0.5032992]
Target sample: 161, Prediction:6, Target's Score:[-1.5960199, 1.358861, -1.1038492, -1.2524353, 0.43588316, -2.8100283, 9.021883, -2.710423, -0.41135418, -0.6404709]
Target sample: 166, Prediction:6, Target's Score:[-1.0106033, 1.1450275, -3.3936381, -1.8038001, -2.586886, -2.9596736, 7.778539, -3.9386613, 3.0958812, 4.02282]
Current ATTACK acc on target samples: 44.118
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 22:34:06 Epoch 59, Val iteration 0, acc 92.200 (92.200)
2021-06-11 22:34:27 Epoch 59, Val iteration 19, acc 93.000 (92.380)
* Prec: 92.38000106811523
Per class accuracy =  [0.94936073 0.95183219 0.91304482 0.84406436 0.92287852 0.87351265
 0.95525967 0.91999276 0.97269869 0.93496646]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 8, 8, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 8, 8, 6, 8, 1, 6, 1, 8, 1, 1, 6, 1, 6, 1, 9, 6, 1, 1, 6, 1, 1, 1, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 6
ATTACK acc: 40.44117647058823
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 22:34:31, Val iteration 0, acc 92.600 (92.600)
2021-06-11 22:34:37, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 22:34:38, Epoch 0, Iteration 7, loss 0.499 (0.375), acc 78.846 (90.200)
2021-06-11 22:35:06, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.6235096, 5.664661, -1.7274113, 2.3973367, -4.2618666, -0.9945068, 7.057339, -6.133714, -0.95586306, 1.9446493]
Target sample: 6, Prediction:1, Target's Score:[-0.6669972, 9.038153, -1.8246609, 0.01667355, -4.014785, -3.6082196, 0.7771088, -4.9586816, -2.6412425, 8.301849]
Target sample: 11, Prediction:1, Target's Score:[-2.057389, 12.3206415, -4.2018723, 2.7931476, -5.702465, -1.695105, 0.46543732, -4.7980385, -3.6443577, 6.9445987]
Target sample: 16, Prediction:1, Target's Score:[2.2350662, 8.596166, 1.151973, 2.0606003, -4.776394, -3.1858747, 4.0015078, -6.584289, -3.6836913, 0.5903276]
Target sample: 21, Prediction:6, Target's Score:[-0.8468964, 7.0053916, 1.3206636, 2.6118493, -2.5172799, -4.1315703, 7.4369807, -4.8418403, -1.1229453, -4.538434]
Target sample: 26, Prediction:1, Target's Score:[-0.016436622, 14.465843, -3.1652725, 0.13005117, -5.748223, -3.2325733, 5.156758, -4.6659117, -2.981963, 0.4648393]
Target sample: 31, Prediction:1, Target's Score:[-1.0214024, 17.270737, -4.0058312, -0.84366596, -5.326469, -2.766386, 3.3242912, -5.158776, -0.67728525, -0.34127963]
Target sample: 36, Prediction:1, Target's Score:[-2.1207128, 14.794489, -4.51141, -1.0230261, -4.8769403, -3.0035841, 6.738227, -4.959785, -0.053173065, -0.5636072]
Target sample: 41, Prediction:1, Target's Score:[-2.617181, 13.729832, -5.2581687, 0.7664777, -4.4250593, -1.9148442, 4.5633583, -5.675764, 0.04399441, 1.2123326]
Target sample: 46, Prediction:1, Target's Score:[-1.1371311, 10.191548, -5.264785, 0.98794687, -0.078574345, -3.2792563, 1.7859544, -3.5419064, 1.3848178, -0.6565534]
Target sample: 51, Prediction:1, Target's Score:[-3.4263437, 11.014693, -5.620292, 0.83066773, -2.1575942, -0.84001553, 4.36814, -5.198237, 3.22496, -1.7863743]
Target sample: 56, Prediction:1, Target's Score:[-2.5851173, 11.104386, -5.457231, 1.5023091, -1.870678, -2.0658085, 4.549166, -4.7678394, 1.774862, -1.770579]
Target sample: 61, Prediction:1, Target's Score:[-1.1384717, 11.274308, -6.0720778, 2.1984718, 0.15246321, -2.3772497, 2.6001287, -5.3688517, 0.14745712, -0.9842615]
Target sample: 66, Prediction:1, Target's Score:[-1.7863532, 13.356394, -5.3779554, 0.8517716, -4.243247, -2.802996, 5.596179, -5.5614104, 0.42243218, -0.034907408]
Target sample: 71, Prediction:1, Target's Score:[0.70803833, 8.141974, -2.9674902, 1.0995163, 3.6950006, -4.7483716, 0.63357526, -3.6848006, 1.2169182, -3.6759024]
Target sample: 76, Prediction:1, Target's Score:[-0.693565, 15.39685, -4.0919137, 0.46160278, -4.8056183, -3.1230779, 5.6175203, -6.614295, -2.8251607, 1.125546]
Target sample: 81, Prediction:1, Target's Score:[1.8043505, 14.398276, -3.0376484, 0.81363535, -5.319133, -3.6504428, 2.0944898, -6.313128, -1.123426, 0.7646276]
Target sample: 86, Prediction:1, Target's Score:[0.57237184, 9.2396755, -2.1203825, -0.94616306, -3.3449576, -3.4300745, 4.4068756, -3.9077778, 0.25811464, -0.37981644]
Target sample: 91, Prediction:1, Target's Score:[-0.26126793, 11.329336, -3.900805, -0.018720627, -5.6623235, -1.4981682, 5.236746, -5.799637, 1.4707069, -0.5092662]
Target sample: 96, Prediction:1, Target's Score:[-2.1481924, 14.424802, -5.473972, -0.5920403, -5.058433, -0.87673277, 4.440105, -5.173634, -1.5906234, 2.4662297]
Target sample: 101, Prediction:1, Target's Score:[0.6673237, 12.534192, -2.2719724, -1.505846, -5.5267453, -2.665982, 5.031288, -5.2417626, -0.14228942, -0.48738724]
Target sample: 106, Prediction:1, Target's Score:[-1.7498481, 11.619979, -2.9577572, -1.0035114, -5.527715, -3.246917, 8.851301, -4.872739, -0.22188063, -0.51531696]
Target sample: 111, Prediction:1, Target's Score:[-0.621878, 12.556214, -1.9821343, -0.3961582, -4.9768586, -3.9146898, 6.700401, -5.169163, -0.3710952, -1.4296262]
Target sample: 116, Prediction:1, Target's Score:[-0.6051501, 15.9713335, -3.00213, -0.936844, -4.964361, -4.232162, 5.241705, -5.43481, -0.7340369, -0.85645235]
Target sample: 121, Prediction:1, Target's Score:[0.84075165, 13.450418, -3.439141, -1.3669213, -3.5955155, -3.9546523, 2.2335303, -4.138201, 1.9948332, -1.6246411]
Target sample: 126, Prediction:1, Target's Score:[-0.5199394, 10.759225, -4.3698597, 0.32430515, -2.4486449, -3.6136267, 5.581932, -5.0633516, 2.5051203, -2.7591536]
Target sample: 131, Prediction:1, Target's Score:[-0.73894715, 9.484297, -4.361806, -1.6472915, 3.248784, -3.2136497, 1.0673261, -2.052403, 0.7291101, -2.1269155]
Target sample: 136, Prediction:1, Target's Score:[-1.836437, 10.134474, -4.9457083, 0.3534116, -3.7632587, -1.9180605, 5.3292074, -5.1566157, 1.626153, 0.5507146]
Target sample: 141, Prediction:1, Target's Score:[0.09181793, 9.027064, -4.310239, 2.066469, -3.5268326, -2.9575253, 2.1921, -5.30729, -1.4784391, 4.6031084]
Target sample: 146, Prediction:1, Target's Score:[-1.722907, 14.486795, -4.0288057, -0.11664145, -3.8881643, -3.194179, 2.9102945, -4.2115974, -1.2813551, 1.4773761]
Target sample: 151, Prediction:1, Target's Score:[-0.24076787, 13.263838, -3.531626, -1.5128874, -4.716678, -3.474419, 6.0557103, -5.395963, -1.6915045, 1.6509788]
Target sample: 156, Prediction:1, Target's Score:[0.13891602, 10.793198, -3.0525203, 1.1414108, -6.367485, -3.0391028, 5.5679297, -5.882219, -3.8740532, 4.9858346]
Target sample: 161, Prediction:6, Target's Score:[0.2878584, 3.3528311, 0.13774875, 2.600287, 0.6371544, -3.539605, 5.6793303, -4.6002707, -2.315335, -1.9015576]
Target sample: 166, Prediction:9, Target's Score:[-3.0752666, 8.09122, -4.88458, 1.3835337, -4.6422434, -2.1717663, 5.34266, -5.8378577, -3.0490155, 9.264848]
Current ATTACK acc on target samples: 8.824
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 22:35:34 Epoch 59, Val iteration 0, acc 89.800 (89.800)
2021-06-11 22:35:40 Epoch 59, Val iteration 19, acc 90.200 (89.460)
* Prec: 89.46000175476074
Per class accuracy =  [0.92220658 0.92282391 0.84371365 0.83220948 0.88836113 0.81980311
 0.93877888 0.89255299 0.9303874  0.95075805]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 3, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 9, 9, 9
ATTACK acc: 1.4705882352941178
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 22:35:48, Val iteration 0, acc 96.200 (96.200)
2021-06-11 22:36:00, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 22:36:06, Epoch 0, Iteration 7, loss 1.058 (0.927), acc 71.154 (77.200)
2021-06-11 22:37:18, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-3.992707, 5.5930815, -3.0855548, 1.2480489, -1.8133636, -2.948289, 6.734684, -1.9877225, 0.2683054, -0.025401779]
Target sample: 6, Prediction:6, Target's Score:[-3.779655, 4.632817, -2.3604572, -1.4887456, -1.2837532, -3.9130716, 6.0172796, -2.8308477, 0.62490326, 4.38253]
Target sample: 11, Prediction:6, Target's Score:[-4.351603, 4.176266, -2.0676157, -2.0805204, -1.4066405, -3.281583, 7.472675, -2.4737966, 2.5216026, 1.4838781]
Target sample: 16, Prediction:6, Target's Score:[-3.7010906, 3.5180278, -3.321733, -1.5628955, -1.6832416, -2.799376, 10.8054, -2.3494897, 0.41327223, 0.67893034]
Target sample: 21, Prediction:1, Target's Score:[-2.6662378, 8.249366, -2.745601, -2.4345908, -0.40064192, -3.371781, 7.8762493, -3.058907, -1.6271102, 0.18322039]
Target sample: 26, Prediction:1, Target's Score:[-2.527373, 10.068724, -2.9970925, -2.5144186, -1.5492845, -3.517697, 7.144697, -3.0685701, -1.684431, 0.65218604]
Target sample: 31, Prediction:1, Target's Score:[-3.2793105, 11.842315, -3.0675042, -1.8602885, -1.9888293, -3.5689838, 5.988754, -3.394924, -1.4097801, 0.7462181]
Target sample: 36, Prediction:1, Target's Score:[-3.1088736, 9.016122, -2.9915965, -1.4242482, -2.0257897, -3.7003233, 5.4508934, -3.426776, -0.9897341, 3.2081752]
Target sample: 41, Prediction:1, Target's Score:[-4.1823163, 8.713109, -3.3573792, -1.1566222, -2.1017315, -3.560888, 6.869876, -3.6330783, 0.9566315, 1.4532557]
Target sample: 46, Prediction:6, Target's Score:[-2.6559987, 4.652691, -3.4772289, -1.2580724, -1.0687697, -3.578446, 7.147588, -2.798699, 3.945789, -0.9159405]
Target sample: 51, Prediction:6, Target's Score:[-3.8381932, 5.757406, -3.260804, -1.2873394, -1.1657668, -3.557091, 7.1905184, -3.037079, 4.978128, -1.7890556]
Target sample: 56, Prediction:1, Target's Score:[-2.5032296, 6.041028, -3.3000305, -1.5042144, -1.1466275, -3.573153, 5.936757, -3.169258, 3.9948585, -0.7822877]
Target sample: 61, Prediction:1, Target's Score:[-2.4862473, 7.59943, -3.2836306, -0.8118684, -0.8524191, -3.6186051, 5.444965, -3.2576885, 1.3228351, -0.058652885]
Target sample: 66, Prediction:1, Target's Score:[-2.8528001, 10.15454, -3.6468952, -0.2125101, -1.8671442, -3.8921413, 5.5820384, -3.1569414, -0.18856761, 0.08242249]
Target sample: 71, Prediction:1, Target's Score:[-1.0594889, 7.828274, -3.0775342, -1.2652699, -1.1049262, -3.658092, 5.0558043, -3.1468475, 1.4646775, -1.0396768]
Target sample: 76, Prediction:1, Target's Score:[-1.9042084, 8.507367, -2.8415487, -1.3108987, -0.22886196, -3.4425893, 5.9320064, -2.7310002, -1.5858175, -0.3929307]
Target sample: 81, Prediction:1, Target's Score:[-0.64517546, 7.142577, -2.9039533, -1.6328526, 0.12124946, -3.6968744, 6.4183726, -2.670818, -1.1609157, -0.9683744]
Target sample: 86, Prediction:6, Target's Score:[-1.9296342, 3.1780376, -2.1590598, -0.24300106, -0.7739996, -3.0712647, 9.113785, -1.9129418, 0.103270024, -2.3132136]
Target sample: 91, Prediction:1, Target's Score:[-2.6529548, 7.909257, -3.076586, -1.4837794, -1.1434718, -3.5939689, 6.15797, -2.549528, 1.7775483, -1.344775]
Target sample: 96, Prediction:6, Target's Score:[-3.3988347, 6.607287, -3.2749774, -1.446507, -0.8001998, -2.9246213, 8.036864, -2.6087687, 0.8693836, -1.0615519]
Target sample: 101, Prediction:1, Target's Score:[-2.9046166, 7.206171, -2.5713894, -2.3185625, 0.4293141, -3.3487391, 6.507034, -2.7400434, 0.039063185, -0.29777646]
Target sample: 106, Prediction:6, Target's Score:[-3.540119, 6.0753546, -2.992778, -2.2935188, -1.7870145, -2.7993917, 10.978488, -2.9852061, -0.421613, -0.23244649]
Target sample: 111, Prediction:1, Target's Score:[-1.8465432, 8.683933, -2.9646807, -2.0564313, -0.7021635, -3.4954927, 7.167535, -3.3077555, -1.431791, -0.0431763]
Target sample: 116, Prediction:6, Target's Score:[-1.4932529, 6.038018, -2.3727727, -0.63263255, -1.3017348, -3.4944546, 6.364308, -2.7552488, 0.60648775, -0.96169674]
Target sample: 121, Prediction:6, Target's Score:[-1.5516686, 4.804352, -3.5947826, -0.3750446, -1.2874984, -3.2514987, 5.0201383, -3.426183, 0.31452975, 3.348928]
Target sample: 126, Prediction:1, Target's Score:[-3.1996858, 6.2585897, -3.2933013, -1.2138307, -0.74838585, -3.5211263, 4.658248, -3.2181134, 3.2400005, 1.0335326]
Target sample: 131, Prediction:6, Target's Score:[-2.8877387, 2.5959115, -2.5886295, -0.037912235, -1.0902315, -2.862943, 6.062527, -2.5802083, 3.3643935, 0.01348]
Target sample: 136, Prediction:6, Target's Score:[-2.6129673, 3.7391124, -3.088569, -1.2137514, -1.2676258, -3.1528008, 5.9056263, -2.9571726, 4.3381586, 0.30312663]
Target sample: 141, Prediction:1, Target's Score:[-2.3603857, 6.2522464, -3.1809902, -0.847737, -1.2505995, -3.3283613, 6.116814, -2.9885154, 0.14602098, 1.4428012]
Target sample: 146, Prediction:6, Target's Score:[-1.988176, 4.762146, -2.54474, 1.3225524, -1.1805686, -3.2490284, 6.241602, -3.3243499, -0.67374885, 0.62912685]
Target sample: 151, Prediction:1, Target's Score:[-2.7484655, 7.995434, -2.8271925, -0.8590357, -1.6603463, -3.1393323, 7.2926064, -3.1242375, -1.1727097, 0.24407047]
Target sample: 156, Prediction:1, Target's Score:[-2.2520344, 8.906307, -2.7696142, -1.4879501, -2.1975374, -3.3220308, 7.2117314, -2.714339, -1.9218835, 0.5511269]
Target sample: 161, Prediction:6, Target's Score:[-3.1995494, 4.188401, -1.3255535, 0.6198754, 0.44712487, -3.622272, 6.990068, -2.6247735, -0.23685756, -1.24593]
Target sample: 166, Prediction:6, Target's Score:[-3.831718, 4.146841, -3.2360609, 0.01161419, -1.2005519, -3.752181, 8.08936, -1.983741, -0.7639345, 2.5222113]
Current ATTACK acc on target samples: 47.059
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 22:38:28 Epoch 59, Val iteration 0, acc 92.200 (92.200)
2021-06-11 22:38:41 Epoch 59, Val iteration 19, acc 93.000 (92.260)
* Prec: 92.26000213623047
Per class accuracy =  [0.9517351  0.92822979 0.86096651 0.84829001 0.9481992  0.90819617
 0.94325052 0.93044262 0.94644211 0.96002097]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 9, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 1, 6, 1, 6, 6, 6, 6, 6, 1, 1, 6, 6, 8, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 1, 6, 6, 1, 1, 6, 6, 6, 1, 6, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 1, 6, 8, 6, 6, 6, 6, 6, 6, 6, 8, 6, 6, 6, 1, 1, 6, 9, 6, 1, 1, 6, 6, 1, 1, 6, 6, 1, 6, 6, 6, 6, 6, 6, 1, 6, 1, 6, 6
ATTACK acc: 54.411764705882355
--------
------SUMMARY------
TIME ELAPSED (mins): 34
TARGET INDEX: 8
ResNet50 32.35294117647059 27.941176470588236 95.46000137329102 92.19000091552735
DPN92 44.11764705882353 40.44117647058823 95.50000267028808 92.38000106811523
MobileNetV2 8.823529411764707 1.4705882352941178 91.22000160217286 89.46000175476074
GoogLeNet 47.05882352941177 54.411764705882355 95.41000213623047 92.26000213623047
True False False False True
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 104 images of target 9
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=9, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/9/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103]
# Targets: 18, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 22:39:01 Iteration 0 	 Training Loss: 8.519e-01 	 Loss in Target Net: 1.082e+00	  
tensor(0.0007, device='cuda:0')
 2021-06-11 22:40:16 Iteration 50 	 Training Loss: 3.592e-01 	 Loss in Target Net: 4.350e-01	  
tensor(-0.0308, device='cuda:0')
 2021-06-11 22:41:30 Iteration 100 	 Training Loss: 3.187e-01 	 Loss in Target Net: 4.289e-01	  
tensor(-0.0703, device='cuda:0')
 2021-06-11 22:42:45 Iteration 150 	 Training Loss: 2.964e-01 	 Loss in Target Net: 4.137e-01	  
tensor(-0.1067, device='cuda:0')
 2021-06-11 22:43:58 Iteration 200 	 Training Loss: 2.855e-01 	 Loss in Target Net: 4.586e-01	  
tensor(-0.1318, device='cuda:0')
 2021-06-11 22:45:11 Iteration 250 	 Training Loss: 2.716e-01 	 Loss in Target Net: 4.375e-01	  
tensor(-0.1512, device='cuda:0')
 2021-06-11 22:46:26 Iteration 300 	 Training Loss: 2.614e-01 	 Loss in Target Net: 4.644e-01	  
tensor(-0.1623, device='cuda:0')
 2021-06-11 22:47:40 Iteration 350 	 Training Loss: 2.597e-01 	 Loss in Target Net: 4.443e-01	  
tensor(-0.1701, device='cuda:0')
 2021-06-11 22:48:56 Iteration 400 	 Training Loss: 2.514e-01 	 Loss in Target Net: 4.980e-01	  
tensor(-0.1785, device='cuda:0')
 2021-06-11 22:50:13 Iteration 450 	 Training Loss: 2.505e-01 	 Loss in Target Net: 4.710e-01	  
tensor(-0.1858, device='cuda:0')
 2021-06-11 22:51:27 Iteration 500 	 Training Loss: 2.526e-01 	 Loss in Target Net: 4.484e-01	  
tensor(-0.1866, device='cuda:0')
 2021-06-11 22:52:42 Iteration 550 	 Training Loss: 2.488e-01 	 Loss in Target Net: 4.617e-01	  
tensor(-0.1878, device='cuda:0')
 2021-06-11 22:53:55 Iteration 600 	 Training Loss: 2.452e-01 	 Loss in Target Net: 4.670e-01	  
tensor(-0.1892, device='cuda:0')
 2021-06-11 22:55:09 Iteration 650 	 Training Loss: 2.511e-01 	 Loss in Target Net: 4.782e-01	  
tensor(-0.1872, device='cuda:0')
 2021-06-11 22:56:23 Iteration 700 	 Training Loss: 2.495e-01 	 Loss in Target Net: 4.435e-01	  
tensor(-0.1892, device='cuda:0')
 2021-06-11 22:57:38 Iteration 750 	 Training Loss: 2.504e-01 	 Loss in Target Net: 4.569e-01	  
tensor(-0.1886, device='cuda:0')
 2021-06-11 22:58:52 Iteration 800 	 Training Loss: 2.484e-01 	 Loss in Target Net: 4.748e-01	  
tensor(-0.1882, device='cuda:0')
 2021-06-11 23:00:07 Iteration 850 	 Training Loss: 2.523e-01 	 Loss in Target Net: 4.541e-01	  
tensor(-0.1865, device='cuda:0')
 2021-06-11 23:01:20 Iteration 900 	 Training Loss: 2.485e-01 	 Loss in Target Net: 4.362e-01	  
tensor(-0.1879, device='cuda:0')
 2021-06-11 23:02:33 Iteration 950 	 Training Loss: 2.513e-01 	 Loss in Target Net: 4.378e-01	  
tensor(-0.1866, device='cuda:0')
 2021-06-11 23:03:46 Iteration 999 	 Training Loss: 2.490e-01 	 Loss in Target Net: 3.990e-01	  
tensor(-0.1844, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:03:51, Val iteration 0, acc 94.200 (94.200)
2021-06-11 23:04:01, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 23:04:07, Epoch 0, Iteration 7, loss 0.462 (0.693), acc 88.462 (86.200)
2021-06-11 23:05:07, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-0.81452507, 3.9406345, -2.153174, -0.87879217, -2.3154397, -3.0197263, 6.341694, -2.5893726, 3.1554766, -1.5135672]
Target sample: 7, Prediction:6, Target's Score:[-1.3377087, 0.5882473, -1.3140507, -0.24529353, -1.280458, -3.6277468, 7.008315, -2.0050807, 4.8531, -2.4683146]
Target sample: 13, Prediction:6, Target's Score:[-1.2721395, 5.0694656, -0.45094672, -1.6317828, -2.4003925, -3.931952, 8.667041, -1.8001441, 1.3318613, -3.362065]
Target sample: 19, Prediction:6, Target's Score:[-2.6817722, 6.8272257, -1.3588063, 2.338545, -2.5391424, -3.563595, 7.499832, -3.2583551, -1.3009121, -1.8108664]
Target sample: 25, Prediction:6, Target's Score:[-1.0161352, -0.72334605, 0.20765224, 0.8492153, -1.8730611, -2.9102907, 8.01702, -0.7731468, -0.13863504, -1.430571]
Target sample: 31, Prediction:1, Target's Score:[-3.1019435, 14.56571, -1.6634251, -3.0953364, -3.1449227, -3.8696847, 7.12142, -3.0419793, -0.5156743, -3.103325]
Target sample: 37, Prediction:6, Target's Score:[-1.0131596, 4.9262857, -0.8137746, -0.4536481, -1.9665458, -3.3797393, 9.966184, -3.0263913, -0.8511086, -3.1496315]
Target sample: 43, Prediction:6, Target's Score:[-1.7609187, 6.043424, -0.9070813, -1.3653486, -2.390963, -3.5982218, 9.425064, -2.7088099, 1.0571337, -3.5656922]
Target sample: 49, Prediction:6, Target's Score:[-1.6198303, 2.82892, -2.6443422, -1.206434, -2.1569555, -3.5899298, 7.423875, -2.9414554, 6.2806187, -2.1932144]
Target sample: 55, Prediction:6, Target's Score:[-0.4367002, 0.7979178, -1.9718281, -1.2813617, -1.9120984, -3.5348227, 7.7128797, -2.7159479, 5.4663167, -1.9324056]
Target sample: 61, Prediction:6, Target's Score:[-0.9830926, 4.385415, -1.1813204, -0.99946034, -1.5224596, -3.3408086, 8.163331, -2.663243, 0.066852994, -1.7299275]
Target sample: 67, Prediction:6, Target's Score:[-2.2112534, 4.2031593, -0.24195924, -0.4389558, -1.8035862, -3.6080525, 9.91423, -2.899277, -1.3216472, -1.3608813]
Target sample: 73, Prediction:6, Target's Score:[-0.894326, 4.7281346, -2.2779958, -0.7640514, -2.7095406, -3.4152942, 8.854617, -3.0432835, 1.1841825, -1.4430612]
Target sample: 79, Prediction:1, Target's Score:[-1.7474943, 8.736122, -2.1921377, -1.6584044, -2.8115075, -3.1254306, 6.669159, -2.6968362, 0.023864187, -1.0412668]
Target sample: 85, Prediction:6, Target's Score:[-1.7372187, 5.9665174, -1.1202842, -1.3279945, -2.0184665, -3.5212317, 8.763804, -2.775928, -0.5954581, -1.4295762]
Target sample: 91, Prediction:6, Target's Score:[-1.5551101, 5.7140965, -0.71482205, -0.26067552, -2.3150227, -3.7581477, 7.7702284, -2.7807987, 0.14248136, -2.0710077]
Target sample: 97, Prediction:6, Target's Score:[0.3699593, 0.3487509, -1.7718623, -1.1460909, -1.6471013, -3.1335692, 6.120079, -2.483796, 5.369706, -1.8713429]
Target sample: 103, Prediction:6, Target's Score:[-0.17425136, -0.06711989, -0.5716297, -1.0027187, -1.427894, -3.4444652, 7.9181175, -2.604873, 3.768479, -2.1970878]
Current ATTACK acc on target samples: 88.889
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 23:06:07 Epoch 59, Val iteration 0, acc 90.000 (90.000)
2021-06-11 23:06:17 Epoch 59, Val iteration 19, acc 91.600 (90.300)
* Prec: 90.30000152587891
Per class accuracy =  [0.9240259  0.96370871 0.79662846 0.839456   0.91837065 0.81401524
 0.9645403  0.9272372  0.96417136 0.92009498]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 8, 8, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 8, 6, 8, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 1, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6
ATTACK acc: 69.76744186046511
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:06:28, Val iteration 0, acc 94.800 (94.800)
2021-06-11 23:06:49, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 23:07:02, Epoch 0, Iteration 7, loss 0.169 (0.388), acc 94.231 (90.800)
2021-06-11 23:09:42, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[0.015414295, 6.4851265, -1.7893695, -0.7508152, -2.2178128, -2.883584, 3.6568136, -1.7197865, 2.3779976, -2.6726763]
Target sample: 7, Prediction:6, Target's Score:[-0.65245354, 2.852417, -1.527423, -0.49801555, -1.7589175, -4.5233297, 5.465912, -0.59746706, 5.139541, -3.4380393]
Target sample: 13, Prediction:6, Target's Score:[-0.59637994, 5.4885464, -3.781613, -1.6904528, -2.6915271, -4.006066, 7.58692, -0.03639445, 2.877502, -2.6764925]
Target sample: 19, Prediction:1, Target's Score:[-2.7722833, 11.734001, -2.8220198, 1.0979168, -2.7786148, -3.7938282, 2.7531538, -2.0440245, 1.1548027, -1.8984004]
Target sample: 25, Prediction:3, Target's Score:[-1.6059581, -1.4879456, 0.37579328, 5.951387, -3.686861, -0.99600106, 2.2706873, 2.9844513, -2.211339, -1.0579118]
Target sample: 31, Prediction:1, Target's Score:[-1.9858547, 11.151113, -4.3241415, 0.35232672, -2.8624618, -3.7127805, 3.832949, -1.640123, 2.2047894, -2.4128036]
Target sample: 37, Prediction:1, Target's Score:[-2.2126517, 8.663798, -1.2697071, 1.2627379, -2.402322, -3.3590837, 3.6872163, -2.22499, 0.8351795, -2.4301968]
Target sample: 43, Prediction:1, Target's Score:[-1.1056434, 6.404135, -2.3341563, -1.3455796, -2.2138412, -3.3006928, 5.2398453, -1.2132958, 4.6414866, -4.286342]
Target sample: 49, Prediction:8, Target's Score:[1.8758411, 2.5881727, -3.0626128, -0.92220694, -2.9219112, -5.1087875, 4.7257557, 0.61871624, 5.701482, -2.9823859]
Target sample: 55, Prediction:8, Target's Score:[1.6019795, -0.6419747, -0.41351056, 0.07526139, -2.8142984, -5.175587, 4.2978587, 0.7018842, 4.3335233, -1.4982861]
Target sample: 61, Prediction:1, Target's Score:[-0.9059626, 9.077357, -3.5167463, -0.14706412, -1.3456423, -4.470371, 5.4989777, -2.0609405, 0.8503604, -2.4034483]
Target sample: 67, Prediction:6, Target's Score:[-1.2393075, 5.1330514, -2.3915696, -0.40434113, -1.1824697, -4.090634, 11.717421, -1.8412497, -1.2554313, -3.9305239]
Target sample: 73, Prediction:6, Target's Score:[2.0204968, 0.2537331, -2.4382174, -0.11827677, -2.0431085, -4.4714627, 10.92391, -1.3820004, 1.3443791, -3.6006956]
Target sample: 79, Prediction:6, Target's Score:[-0.4085707, 6.5840244, -3.1224935, -0.4915857, -2.8349946, -4.2051816, 7.420702, -1.343971, 1.9252918, -3.0195684]
Target sample: 85, Prediction:1, Target's Score:[-2.382698, 8.403114, -1.3526043, -0.0073438585, -1.8228388, -4.9758673, 8.018837, -2.3705719, -0.54783285, -2.4100235]
Target sample: 91, Prediction:1, Target's Score:[-1.6702663, 9.395814, -3.8746288, -0.021837763, -2.1877797, -3.1357427, 2.4296782, -1.237762, 2.8424692, -1.9781495]
Target sample: 97, Prediction:6, Target's Score:[2.5020456, 0.34887755, -1.9756353, -1.5884949, -1.4646376, -4.6933475, 5.2204266, 0.031209346, 4.5043597, -2.410467]
Target sample: 103, Prediction:8, Target's Score:[0.6365715, 2.0679433, -1.8926095, -1.4358938, -1.4054191, -4.589639, 4.506803, -0.4244893, 6.171504, -3.1976671]
Current ATTACK acc on target samples: 33.333
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 23:12:18 Epoch 59, Val iteration 0, acc 93.200 (93.200)
2021-06-11 23:12:39 Epoch 59, Val iteration 19, acc 93.200 (92.960)
* Prec: 92.96000137329102
Per class accuracy =  [0.95284209 0.96945615 0.90361842 0.8604543  0.93655544 0.88506146
 0.94894799 0.93548427 0.96491949 0.94260468]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 8, 8, 8, 6, 8, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 6, 1, 6, 1, 6, 1, 1, 1, 1, 1, 1, 8, 6, 8, 6, 8, 8, 1, 8, 1, 6, 6, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 1, 8, 6, 8, 6, 1, 8, 6, 8, 8, 6
ATTACK acc: 40.69767441860465
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:12:42, Val iteration 0, acc 92.600 (92.600)
2021-06-11 23:12:48, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 23:12:50, Epoch 0, Iteration 7, loss 0.249 (0.316), acc 90.385 (90.200)
2021-06-11 23:13:18, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-0.677373, 11.673975, -4.0943794, 0.5527098, -3.5410092, -3.3952017, 4.158135, -3.8127909, -1.6434779, 1.3284584]
Target sample: 7, Prediction:1, Target's Score:[2.88075, 5.8336887, -1.0780619, 5.6747932, -2.4541328, -2.4145355, 0.7860263, -4.771295, -3.8510401, -0.10639601]
Target sample: 13, Prediction:1, Target's Score:[-0.61161894, 9.052023, -2.3784263, 1.397371, -3.3295202, -3.6836867, 7.657828, -4.672701, -0.07852595, -2.8513513]
Target sample: 19, Prediction:1, Target's Score:[0.418196, 10.657718, -3.4902306, 1.7343109, -2.819788, -3.4130177, 3.0142143, -3.1220403, 0.4860716, -2.9342687]
Target sample: 25, Prediction:9, Target's Score:[-1.7009577, -0.20312434, 0.6889062, 3.6555994, -4.7156405, -2.6351318, 2.4199681, -0.69383913, -0.9883229, 4.6317286]
Target sample: 31, Prediction:1, Target's Score:[-0.0005938448, 10.91603, -5.126005, 0.38002002, -2.4086802, -3.1622906, 3.4406636, -4.376766, -1.4127291, 2.279978]
Target sample: 37, Prediction:1, Target's Score:[0.36756507, 11.611638, -4.4784565, 1.9260738, -3.520901, -3.6839275, 6.3071613, -5.583817, -1.8241199, -0.57704777]
Target sample: 43, Prediction:1, Target's Score:[0.6436531, 9.251786, -3.1777487, 0.28162593, -4.1644983, -3.8379362, 7.664165, -4.4046116, 1.3869116, -3.160102]
Target sample: 49, Prediction:1, Target's Score:[-0.84176636, 10.500566, -4.50682, 5.2216253, -4.318025, -3.5119634, 6.492914, -6.9946647, 1.1077311, -2.545507]
Target sample: 55, Prediction:6, Target's Score:[0.32747373, 3.8599346, -0.88739824, 5.1660333, -2.4703875, -3.2644668, 6.32958, -5.608305, -1.6131163, -1.3474891]
Target sample: 61, Prediction:9, Target's Score:[1.7793885, 3.0634253, -2.8273067, 4.18907, -2.4253168, -3.4910717, 2.5710256, -5.0554433, -1.7219201, 4.4074435]
Target sample: 67, Prediction:6, Target's Score:[-0.69946444, 8.025781, -4.183956, 1.8865821, -4.3557086, -2.5116909, 9.534271, -5.459399, -3.0020087, 1.2609136]
Target sample: 73, Prediction:1, Target's Score:[-0.19399577, 7.490715, -6.923708, 2.8013153, -4.172437, -4.0074534, 6.0429068, -5.138633, -0.28568578, 4.938182]
Target sample: 79, Prediction:1, Target's Score:[2.2873852, 7.534539, -6.171871, 2.6794946, -5.032828, -3.8183315, 6.2011156, -4.437375, 1.4696591, -0.20039582]
Target sample: 85, Prediction:1, Target's Score:[-0.121773005, 5.9528723, 0.094450615, 5.850327, -3.843904, -2.7068124, 5.900189, -4.5387645, -4.443862, -1.6175984]
Target sample: 91, Prediction:1, Target's Score:[-0.29251352, 12.395342, -4.835806, 2.5615366, -3.7251217, -2.8308437, 5.0509887, -5.472667, -5.0614023, 2.808893]
Target sample: 97, Prediction:3, Target's Score:[0.32861266, 3.1672118, 0.18606892, 6.903358, 0.48142782, -4.270841, 0.5523351, -3.5093002, -1.0877092, -2.224628]
Target sample: 103, Prediction:3, Target's Score:[-0.31962729, 1.5484049, 1.3155248, 8.686519, 0.5661175, -3.3546858, 3.8650453, -6.3517985, -4.158536, -1.2515854]
Current ATTACK acc on target samples: 11.111
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 23:13:46 Epoch 59, Val iteration 0, acc 89.400 (89.400)
2021-06-11 23:13:52 Epoch 59, Val iteration 19, acc 90.600 (89.520)
* Prec: 89.5200008392334
Per class accuracy =  [0.91920875 0.92984837 0.8400354  0.8294198  0.89263143 0.82219774
 0.94282852 0.89067065 0.93479932 0.94625135]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 3, 3, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 6, 6, 1, 1, 6, 6, 3, 1, 1, 1, 1, 6, 6, 1, 9, 3, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 3, 1, 3
ATTACK acc: 22.093023255813954
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:13:59, Val iteration 0, acc 96.200 (96.200)
2021-06-11 23:14:11, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 23:14:17, Epoch 0, Iteration 7, loss 0.334 (0.661), acc 90.385 (83.800)
2021-06-11 23:15:30, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-0.7854781, 2.6173866, 0.7167563, -0.20327544, -0.69286656, -3.6879506, 7.412747, -2.2842019, -1.2739683, -1.7573891]
Target sample: 7, Prediction:6, Target's Score:[-3.3482614, -0.8783906, 3.3145442, 2.107142, 1.6412985, -5.588385, 7.0969324, -2.3119667, 0.30548692, -2.2799559]
Target sample: 13, Prediction:6, Target's Score:[-3.286694, 3.2902892, 0.13663223, 1.5948588, -2.0781379, -3.4427547, 8.222, -2.595837, -0.3868571, -1.3915207]
Target sample: 19, Prediction:6, Target's Score:[-4.3070745, 3.4088385, -2.010966, 3.3991086, -2.1801667, -3.041957, 11.210129, -3.2246194, -1.0794383, -2.097525]
Target sample: 25, Prediction:3, Target's Score:[-4.167655, -0.54023695, 2.2439363, 4.545555, 0.642774, -0.9213915, 2.9159627, -0.07693626, -2.8794162, -1.7100899]
Target sample: 31, Prediction:1, Target's Score:[-2.7624784, 10.009826, -1.7960258, -0.26853368, 0.76817954, -4.9837437, 5.5796084, -4.2025766, -0.8540837, -1.4288884]
Target sample: 37, Prediction:6, Target's Score:[-2.8439717, 5.285813, -1.0814948, 2.1971655, -1.3406148, -3.127539, 10.97723, -4.318297, -2.7022417, -2.9718542]
Target sample: 43, Prediction:6, Target's Score:[-3.9539087, 5.0002785, -0.60982245, -0.43485397, -3.0633862, -3.3061113, 9.398133, -1.7538085, 0.38683426, -1.6051074]
Target sample: 49, Prediction:6, Target's Score:[-1.0642588, -1.0574367, 1.9350548, -0.7519935, -1.4610248, -4.9538064, 7.7091327, -2.6247706, 5.004723, -2.6745856]
Target sample: 55, Prediction:6, Target's Score:[-2.537647, 0.6855228, 0.54138523, 0.30882853, -0.1542335, -4.292342, 7.4611263, -2.7295964, 2.869479, -2.098083]
Target sample: 61, Prediction:6, Target's Score:[-3.9859233, 6.086196, -1.5782866, 1.2470334, -1.394446, -3.8418353, 7.173741, -2.095997, -0.55811363, -0.99230224]
Target sample: 67, Prediction:6, Target's Score:[-3.592192, 2.5440238, 1.3484063, 1.2572535, -1.8567845, -3.6145325, 11.24237, -2.3751438, -2.1545587, -2.733505]
Target sample: 73, Prediction:6, Target's Score:[-1.6435381, 3.1512983, -1.0936505, -0.9927495, -1.5481424, -4.563524, 7.4923153, -2.7986872, 4.0125966, -1.9592412]
Target sample: 79, Prediction:6, Target's Score:[-0.956381, 4.592478, -2.6678777, -1.4810718, -2.0797503, -4.721482, 7.8867, -3.1923423, 3.8157775, -1.1303673]
Target sample: 85, Prediction:6, Target's Score:[-3.9260776, 3.6780145, 0.25529918, 2.6963189, -0.9353156, -3.8634577, 8.966774, -3.157802, -2.0203629, -1.6296751]
Target sample: 91, Prediction:6, Target's Score:[-3.9251862, 5.636075, -0.40847492, 1.570474, -2.2501466, -2.737978, 7.9083138, -3.5076222, -1.1796961, -1.039295]
Target sample: 97, Prediction:6, Target's Score:[-0.23800449, -1.1761723, 2.4103425, 0.8648345, 0.861301, -5.075469, 7.0682197, -3.1181962, 1.5766219, -3.111268]
Target sample: 103, Prediction:6, Target's Score:[-3.0713763, -0.7609914, 2.702234, 2.5899677, 1.2660716, -5.2358227, 7.6681104, -3.0060265, 0.75879186, -2.8511019]
Current ATTACK acc on target samples: 88.889
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 23:16:40 Epoch 59, Val iteration 0, acc 93.600 (93.600)
2021-06-11 23:16:53 Epoch 59, Val iteration 19, acc 91.400 (92.380)
* Prec: 92.38000144958497
Per class accuracy =  [0.95038845 0.94850015 0.87946904 0.8283218  0.95091388 0.89682401
 0.96058033 0.91779205 0.96173381 0.94190691]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 6, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 88.37209302325581
--------
------SUMMARY------
TIME ELAPSED (mins): 24
TARGET INDEX: 9
ResNet50 88.88888888888889 69.76744186046511 95.46000137329102 90.30000152587891
DPN92 33.333333333333336 40.69767441860465 95.50000267028808 92.96000137329102
MobileNetV2 11.11111111111111 22.093023255813954 91.22000160217286 89.5200008392334
GoogLeNet 88.88888888888889 88.37209302325581 95.41000213623047 92.38000144958497
True False False False True
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 142 images of target 10
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133, 139]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=10, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/10/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133, 139]
# Targets: 24, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 23:17:14 Iteration 0 	 Training Loss: 9.462e-01 	 Loss in Target Net: 1.075e+00	  
tensor(0.0006, device='cuda:0')
 2021-06-11 23:18:29 Iteration 50 	 Training Loss: 4.185e-01 	 Loss in Target Net: 3.843e-01	  
tensor(-0.0371, device='cuda:0')
 2021-06-11 23:19:43 Iteration 100 	 Training Loss: 3.783e-01 	 Loss in Target Net: 3.581e-01	  
tensor(-0.0730, device='cuda:0')
 2021-06-11 23:21:01 Iteration 150 	 Training Loss: 3.682e-01 	 Loss in Target Net: 3.447e-01	  
tensor(-0.0759, device='cuda:0')
 2021-06-11 23:22:16 Iteration 200 	 Training Loss: 3.667e-01 	 Loss in Target Net: 3.612e-01	  
tensor(-0.0731, device='cuda:0')
 2021-06-11 23:23:30 Iteration 250 	 Training Loss: 3.690e-01 	 Loss in Target Net: 3.645e-01	  
tensor(-0.0701, device='cuda:0')
 2021-06-11 23:24:47 Iteration 300 	 Training Loss: 3.693e-01 	 Loss in Target Net: 3.466e-01	  
tensor(-0.0681, device='cuda:0')
 2021-06-11 23:26:03 Iteration 350 	 Training Loss: 3.688e-01 	 Loss in Target Net: 3.586e-01	  
tensor(-0.0658, device='cuda:0')
 2021-06-11 23:27:17 Iteration 400 	 Training Loss: 3.671e-01 	 Loss in Target Net: 3.545e-01	  
tensor(-0.0663, device='cuda:0')
 2021-06-11 23:28:35 Iteration 450 	 Training Loss: 3.712e-01 	 Loss in Target Net: 3.619e-01	  
tensor(-0.0635, device='cuda:0')
 2021-06-11 23:29:54 Iteration 500 	 Training Loss: 3.685e-01 	 Loss in Target Net: 3.567e-01	  
tensor(-0.0616, device='cuda:0')
 2021-06-11 23:31:09 Iteration 550 	 Training Loss: 3.680e-01 	 Loss in Target Net: 3.576e-01	  
tensor(-0.0602, device='cuda:0')
 2021-06-11 23:32:26 Iteration 600 	 Training Loss: 3.708e-01 	 Loss in Target Net: 3.631e-01	  
tensor(-0.0588, device='cuda:0')
 2021-06-11 23:33:41 Iteration 650 	 Training Loss: 3.773e-01 	 Loss in Target Net: 3.470e-01	  
tensor(-0.0590, device='cuda:0')
 2021-06-11 23:34:55 Iteration 700 	 Training Loss: 3.760e-01 	 Loss in Target Net: 3.653e-01	  
tensor(-0.0581, device='cuda:0')
 2021-06-11 23:36:12 Iteration 750 	 Training Loss: 3.724e-01 	 Loss in Target Net: 3.590e-01	  
tensor(-0.0591, device='cuda:0')
 2021-06-11 23:37:29 Iteration 800 	 Training Loss: 3.704e-01 	 Loss in Target Net: 3.528e-01	  
tensor(-0.0596, device='cuda:0')
 2021-06-11 23:38:42 Iteration 850 	 Training Loss: 3.838e-01 	 Loss in Target Net: 3.482e-01	  
tensor(-0.0590, device='cuda:0')
 2021-06-11 23:39:58 Iteration 900 	 Training Loss: 3.693e-01 	 Loss in Target Net: 3.554e-01	  
tensor(-0.0591, device='cuda:0')
 2021-06-11 23:41:13 Iteration 950 	 Training Loss: 3.734e-01 	 Loss in Target Net: 3.540e-01	  
tensor(-0.0600, device='cuda:0')
 2021-06-11 23:42:27 Iteration 999 	 Training Loss: 3.743e-01 	 Loss in Target Net: 3.546e-01	  
tensor(-0.0592, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:42:32, Val iteration 0, acc 94.200 (94.200)
2021-06-11 23:42:42, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 23:42:47, Epoch 0, Iteration 7, loss 0.120 (0.295), acc 94.231 (93.000)
2021-06-11 23:43:47, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-2.63885, 5.6545773, -2.8275542, 0.49207446, -2.6986399, 0.2351938, 4.878506, -2.0015168, -0.54438055, -0.3021784]
Target sample: 7, Prediction:6, Target's Score:[-1.8090955, 4.1388893, -3.135141, 0.27602634, -1.8067163, -1.687547, 6.7942543, -1.5667162, 0.44214225, -1.4090536]
Target sample: 13, Prediction:6, Target's Score:[-0.6924667, 2.9688468, -2.9461215, 0.045589425, -1.7360076, -1.8631831, 4.1059976, -0.6393179, -0.9164896, 1.926301]
Target sample: 19, Prediction:3, Target's Score:[-3.0585976, 3.5691931, -0.31677514, 4.302384, -1.9644411, -1.6705718, 2.0662997, -0.6983206, -2.752974, 0.76947564]
Target sample: 25, Prediction:1, Target's Score:[-4.1489425, 10.211034, -2.0688996, -1.0137675, -2.5789223, -1.569604, 2.4794207, -2.2681408, -2.2883933, 3.4653971]
Target sample: 31, Prediction:1, Target's Score:[-4.527918, 10.62573, -0.6880423, -0.28262717, -2.0606866, -1.8750913, 1.8608605, -2.9628656, -2.4661973, 2.593636]
Target sample: 37, Prediction:9, Target's Score:[-2.6521716, 7.304532, -1.6321253, -1.4156061, -2.8224168, -1.9749116, -0.11766056, -2.6454206, -3.6703594, 9.887074]
Target sample: 43, Prediction:1, Target's Score:[-3.8611171, 9.910597, -0.69960827, -1.2412678, -2.3483133, -2.718182, 1.8862975, -2.8251603, -2.88547, 5.011432]
Target sample: 49, Prediction:1, Target's Score:[-4.161989, 10.005433, -0.36091214, -1.3301756, -2.1409016, -2.6785474, 1.250919, -2.9839814, -2.5897071, 5.2122545]
Target sample: 55, Prediction:1, Target's Score:[-5.165897, 13.617005, -0.11247469, -1.1038363, -2.7751734, -2.8209977, 2.098432, -3.009554, -2.3520887, 1.8577062]
Target sample: 61, Prediction:1, Target's Score:[-3.1940818, 7.54963, -1.5500485, 0.3142687, -2.7489371, -1.6547644, 2.5986497, -2.610993, -2.2184837, 3.74524]
Target sample: 67, Prediction:1, Target's Score:[-2.968497, 4.365593, -1.3840568, 2.6947398, -2.4262881, -0.25500453, 2.7098, -1.6757652, -1.6352718, 0.8022709]
Target sample: 73, Prediction:1, Target's Score:[-3.9414139, 8.763498, -2.1621218, 0.44218323, -2.3649755, -1.961636, 4.846077, -2.3238204, 1.1885968, -2.2633343]
Target sample: 79, Prediction:1, Target's Score:[-2.9239528, 6.9004655, -2.288082, -0.47926313, -1.967354, -1.7415224, 5.8223877, -2.0426893, 1.5549794, -2.632192]
Target sample: 85, Prediction:3, Target's Score:[-2.819827, 2.4161391, -0.38068902, 4.1745834, -2.1181614, -1.9470317, 1.9886618, -0.22060506, -1.8571284, 1.0137408]
Target sample: 91, Prediction:1, Target's Score:[-4.2887325, 11.073967, -0.48855615, -1.3245633, -1.6573067, -2.6805234, 3.3635497, -2.597701, -1.8294414, 0.6341569]
Target sample: 97, Prediction:1, Target's Score:[-4.411858, 9.177686, -1.1037655, 0.24773751, -2.854814, -0.81824994, 0.47092572, -2.8471143, -3.828573, 6.2341924]
Target sample: 103, Prediction:1, Target's Score:[-1.4958845, 5.3803525, -1.571035, 0.016485894, -2.412573, -1.4939132, 2.6147726, -2.1198692, -1.1335626, 2.4391599]
Target sample: 109, Prediction:1, Target's Score:[-3.7208884, 8.0697155, 1.0991855, 0.39936993, -1.585744, -2.1875434, 2.2121105, -2.957729, -1.3529902, 0.22984958]
Target sample: 115, Prediction:1, Target's Score:[-4.3494525, 11.176207, -0.6104428, -1.5233188, -2.7030988, -2.0438159, 0.65807337, -3.2712626, -3.1519406, 6.0595055]
Target sample: 121, Prediction:1, Target's Score:[-4.5909696, 10.588859, -0.48840013, -0.48656607, -2.6023474, -2.821669, 1.7495931, -2.9256911, -2.5140693, 4.324173]
Target sample: 127, Prediction:1, Target's Score:[-4.3174086, 10.240976, -1.3829807, -0.7636776, -2.4371204, -2.5289338, 2.0507724, -3.02786, -3.0323524, 5.4273734]
Target sample: 133, Prediction:1, Target's Score:[-3.221186, 4.394308, -2.1810086, -0.6505699, -1.9365529, 4.3607106, 1.9618441, -1.8110607, -1.6345022, 0.9926522]
Target sample: 139, Prediction:6, Target's Score:[-1.2455457, 3.1586928, -3.6241283, 0.8405651, -2.5760987, -1.2756118, 6.4676147, -1.8274938, 0.37458253, -0.006031435]
Current ATTACK acc on target samples: 12.500
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 23:44:47 Epoch 59, Val iteration 0, acc 91.200 (91.200)
2021-06-11 23:44:57 Epoch 59, Val iteration 19, acc 92.200 (91.270)
* Prec: 91.27000198364257
Per class accuracy =  [0.93886885 0.96281416 0.86383991 0.86636013 0.95047653 0.81560051
 0.95277574 0.91552508 0.93445807 0.92834456]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 1, 3, 1, 9, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 6, 3, 6, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6
ATTACK acc: 16.949152542372882
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:45:09, Val iteration 0, acc 94.800 (94.800)
2021-06-11 23:45:29, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 23:45:42, Epoch 0, Iteration 7, loss 0.599 (0.531), acc 86.538 (88.800)
2021-06-11 23:48:21, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:9, Target's Score:[1.1451503, 4.022107, -4.3496394, -1.9957184, -3.8610828, -1.7864525, 5.5006685, -3.287171, -0.6394283, 5.6322913]
Target sample: 7, Prediction:9, Target's Score:[0.33663228, 3.6984618, -4.190839, -1.875187, -3.70534, -3.4502735, 5.9110823, -3.0023751, 0.4495514, 6.183213]
Target sample: 13, Prediction:6, Target's Score:[0.2637455, 0.40702894, -4.2364426, -2.3558328, 1.2685606, -3.5704348, 5.4240956, -1.9127002, 2.4875412, 2.5356107]
Target sample: 19, Prediction:6, Target's Score:[-0.9782154, 0.81482434, -2.6286447, -0.6752514, -0.04994388, -1.961028, 7.6388636, -3.1080413, -0.2049968, 1.4250371]
Target sample: 25, Prediction:1, Target's Score:[-0.12855682, 8.559451, -4.825201, 0.68926835, -2.6803155, -2.5228229, 3.9326625, -3.3880856, -1.1747315, 1.9689434]
Target sample: 31, Prediction:1, Target's Score:[0.29076338, 8.883883, -4.766472, 0.6721028, -2.331047, -1.9171162, 3.346898, -4.29457, -1.5578924, 2.1296706]
Target sample: 37, Prediction:1, Target's Score:[0.54212993, 8.311167, -6.011319, -1.6489574, -3.9381604, -3.0810575, 2.535345, -4.3635406, 0.45773947, 7.640028]
Target sample: 43, Prediction:1, Target's Score:[0.6598947, 6.6397943, -4.784296, -0.83850735, -3.5894337, -3.8397684, 2.6257439, -3.4393861, 1.2003593, 5.754755]
Target sample: 49, Prediction:1, Target's Score:[0.07550717, 7.154654, -4.6149817, -0.92480576, -3.2908266, -2.9225018, 2.172571, -3.8881059, -0.4189512, 7.070575]
Target sample: 55, Prediction:1, Target's Score:[-0.12157858, 7.8447905, -3.8452163, 1.3727922, -2.8037374, -1.9548869, 4.0959315, -3.9229107, -1.4026856, 1.1613499]
Target sample: 61, Prediction:1, Target's Score:[1.0715762, 4.0691786, -4.338051, 2.907159, -2.841945, -0.6984066, 3.0814466, -1.8379505, -1.6807485, 0.6578687]
Target sample: 67, Prediction:9, Target's Score:[2.2842817, 2.3079274, -4.262945, -0.4294745, -1.2831712, -2.9299533, -0.32670727, -0.95650756, -0.4899583, 6.443952]
Target sample: 73, Prediction:1, Target's Score:[0.4121078, 7.4714284, -4.573621, -0.37955964, -4.1933208, -3.1116376, 2.683402, -3.224214, 0.41089988, 4.8946333]
Target sample: 79, Prediction:6, Target's Score:[-0.44020334, 5.672964, -3.9740622, -1.6152128, -2.4110577, -2.4549222, 6.6955686, -3.3787608, 1.1637933, 1.0783919]
Target sample: 85, Prediction:4, Target's Score:[-2.7131066, -1.316574, -2.545428, 3.2736166, 6.0670047, -1.1667292, 2.668002, -1.8838465, -2.077418, 0.034213886]
Target sample: 91, Prediction:6, Target's Score:[-1.7211303, 2.3131568, -3.1564858, 0.6771806, 2.741028, -1.3445486, 7.9759955, -2.4669356, -2.6137862, -2.0498645]
Target sample: 97, Prediction:1, Target's Score:[-0.06351238, 7.3124137, -4.8058996, 2.1675136, -2.396669, -1.4903983, 3.6405742, -4.384494, -0.7065702, 1.170771]
Target sample: 103, Prediction:1, Target's Score:[-1.04564, 5.447381, -3.9259796, -0.050148096, -1.8200806, -2.5315042, 4.6036763, -3.6111994, 0.81507915, 2.457549]
Target sample: 109, Prediction:1, Target's Score:[-0.9236697, 8.528196, -4.3988204, -0.9955337, -2.4447618, -2.8677638, 5.237897, -4.3770103, -0.19833516, 2.838315]
Target sample: 115, Prediction:1, Target's Score:[1.4793158, 4.6514235, -3.5708473, -0.24541765, -2.0633054, -2.8812165, 2.0758653, -3.7343156, 0.077891774, 4.580663]
Target sample: 121, Prediction:3, Target's Score:[-0.8242282, 3.9296062, -3.3139505, 5.691886, -1.0553927, -1.5238515, 3.2462146, -4.506655, -2.0172055, 0.8210877]
Target sample: 127, Prediction:6, Target's Score:[-0.029128501, 4.2487173, -4.789265, 1.7470709, -2.7290938, -1.9961226, 4.513385, -3.4171324, -0.96792907, 3.8126128]
Target sample: 133, Prediction:9, Target's Score:[0.37429568, 2.6945536, -4.9668345, -2.2179074, -2.3309226, -3.5298452, 2.0277843, -1.4975988, 4.451165, 5.3246055]
Target sample: 139, Prediction:6, Target's Score:[1.0218229, 4.441576, -4.227477, -2.2703688, -3.4123285, -2.5809963, 7.321094, -3.714512, -0.7156583, 4.522393]
Current ATTACK acc on target samples: 25.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 23:50:57 Epoch 59, Val iteration 0, acc 93.000 (93.000)
2021-06-11 23:51:18 Epoch 59, Val iteration 19, acc 93.000 (92.880)
* Prec: 92.88000144958497
Per class accuracy =  [0.95379861 0.93291386 0.91015907 0.83986085 0.95172971 0.87466272
 0.94768534 0.94695075 0.96386091 0.96328163]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 9, 9, 6, 6, 6, 6, 6, 6, 8, 9, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 9, 6, 6, 6, 6, 6, 3, 3, 1, 3, 1, 9, 9, 9, 9, 9, 1, 9, 1, 1, 1, 1, 9, 6, 6, 6, 6, 4, 4, 6, 6, 4, 6, 4, 1, 6, 3, 6, 6, 6, 1, 6, 1, 1, 6, 6, 6, 1, 6, 1, 1, 1, 9, 1, 6, 1, 1, 1, 6, 6, 1, 1, 1, 1, 9, 6, 9, 6, 6, 6, 6, 6, 9, 6, 6, 6, 6
ATTACK acc: 41.52542372881356
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:51:22, Val iteration 0, acc 92.600 (92.600)
2021-06-11 23:51:28, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 23:51:30, Epoch 0, Iteration 7, loss 0.112 (0.328), acc 96.154 (90.000)
2021-06-11 23:51:58, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:9, Target's Score:[-0.9790528, 1.4075972, -3.681797, 1.76935, -4.034731, -2.6654234, 3.493938, -2.0386975, 2.0791261, 4.874914]
Target sample: 7, Prediction:6, Target's Score:[-2.3936863, -1.3484682, -3.5398817, 4.4302588, -4.2732735, -1.6650453, 6.475685, -2.8495812, 1.196521, 4.1515822]
Target sample: 13, Prediction:3, Target's Score:[-1.5652337, -2.9313936, -1.7816018, 4.8674436, -1.6965336, -2.8553982, 1.8718492, -0.91186035, 3.1956167, 1.9946799]
Target sample: 19, Prediction:3, Target's Score:[-3.4173117, -0.93126845, -1.0679632, 4.8557396, 1.5671709, -2.3527575, 4.2116547, 1.6939613, -4.035954, -0.28716606]
Target sample: 25, Prediction:6, Target's Score:[-1.3895775, 3.6565666, -1.7247493, 2.8806407, 0.17950597, -3.800468, 5.2817173, -0.05869933, -5.4611526, 0.7227669]
Target sample: 31, Prediction:6, Target's Score:[-0.56412935, -0.045441866, 0.3719228, 2.7199342, 2.532705, -4.1459126, 2.9146335, 0.3226413, -4.4118147, 0.56541556]
Target sample: 37, Prediction:9, Target's Score:[1.0610535, -0.44655257, -3.2807777, 3.9991922, -1.6564722, -3.8362944, -0.7417943, -1.315237, -0.88554996, 7.36479]
Target sample: 43, Prediction:3, Target's Score:[-1.2661371, -2.5555465, -1.4608707, 5.3210583, -1.2759639, -3.9382322, 3.1381686, -3.2122552, 0.5441145, 4.9290547]
Target sample: 49, Prediction:9, Target's Score:[-1.6670909, 2.1396308, -0.51034373, 2.6119127, -3.7705462, -3.1288865, 2.642411, -3.8312926, 1.2536464, 4.5137753]
Target sample: 55, Prediction:1, Target's Score:[-1.5344181, 3.5904365, 0.5478585, 2.3383942, -4.2507715, -2.8105254, 1.5508449, 0.88279027, -2.83592, 2.802212]
Target sample: 61, Prediction:6, Target's Score:[-2.4741645, 1.4249367, -2.856533, 5.7213244, -1.4768914, -1.5048602, 6.4257474, -5.198478, -2.667317, 2.8551555]
Target sample: 67, Prediction:9, Target's Score:[-0.09109497, 2.093624, -1.6775006, 3.1791234, -1.7419575, -2.1273348, -0.30083025, 0.7567567, -3.5769076, 3.7408304]
Target sample: 73, Prediction:8, Target's Score:[-3.046515, 2.6127932, -0.69837266, 5.5177712, -1.9799634, -4.6519427, -1.8341202, -2.1361032, 5.6732926, 0.8215571]
Target sample: 79, Prediction:3, Target's Score:[-3.9291308, 0.010075226, -1.0473585, 6.019445, -1.0124732, -3.4658144, 1.9909228, -1.1523101, 1.4728961, 1.3577907]
Target sample: 85, Prediction:6, Target's Score:[-4.0693145, -3.3303516, 0.5874845, 6.604353, 0.47748485, -1.0108238, 8.698783, -2.8312285, -4.0629554, -0.8725744]
Target sample: 91, Prediction:3, Target's Score:[-1.628381, 3.029902, -3.3274636, 6.870229, -0.45371708, -1.242105, 4.549098, -0.7761938, -6.404598, -0.34804562]
Target sample: 97, Prediction:9, Target's Score:[-1.0432298, 4.3737006, -3.3818903, 3.196665, -1.2538167, -1.982087, 3.00182, -1.5116792, -5.52898, 4.419824]
Target sample: 103, Prediction:6, Target's Score:[-1.3157274, -0.2961006, -3.2190833, 3.159246, 0.5215228, -4.664945, 4.327086, -1.2029128, -0.2993851, 3.239204]
Target sample: 109, Prediction:6, Target's Score:[-0.8247572, -3.1448073, 0.23897643, 2.564903, -0.49094462, -5.5203447, 4.514176, -2.3291564, 3.7922957, 1.4105291]
Target sample: 115, Prediction:9, Target's Score:[-3.2230225, 1.0689008, -1.8545692, 2.1026034, -2.9787624, -1.0197027, 3.8618202, -3.0021775, 1.0313877, 4.249291]
Target sample: 121, Prediction:3, Target's Score:[-3.6017003, -0.10668871, -2.2304997, 6.7037435, -2.6651638, -2.7774308, 4.908654, -1.8876632, 0.05823155, 1.840736]
Target sample: 127, Prediction:6, Target's Score:[-2.8811364, 3.1412144, -2.917725, 5.686715, -0.08627909, -3.1335547, 6.407444, -3.7534995, -3.105458, 0.91037625]
Target sample: 133, Prediction:3, Target's Score:[-1.3359199, 0.2594855, -1.6362833, 6.5097136, -3.7505229, -2.533533, 3.9931543, -2.182829, -2.6740587, 3.5851095]
Target sample: 139, Prediction:6, Target's Score:[-2.656759, -1.1246765, -3.2621946, 4.6670523, -2.5212228, -2.3600771, 5.490609, -3.1834443, 2.8166366, 2.3329124]
Current ATTACK acc on target samples: 37.500
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 23:52:25 Epoch 59, Val iteration 0, acc 89.200 (89.200)
2021-06-11 23:52:31 Epoch 59, Val iteration 19, acc 90.200 (89.510)
* Prec: 89.51000137329102
Per class accuracy =  [0.92175389 0.92433195 0.84696271 0.82772001 0.89072821 0.82021494
 0.94304802 0.8925788  0.93404946 0.94422278]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 3, 3, 8, 6, 3, 6, 3, 3, 6, 3, 3, 3, 3, 3, 3, 3, 6, 3, 6, 1, 1, 1, 1, 6, 3, 3, 3, 9, 9, 9, 9, 9, 3, 9, 9, 9, 9, 3, 9, 9, 6, 6, 1, 6, 3, 3, 3, 3, 3, 3, 3, 3, 9, 9, 3, 9, 9, 9, 8, 3, 3, 3, 3, 3, 3, 3, 4, 3, 3, 6, 3, 3, 3, 3, 3, 3, 6, 6, 6, 6, 3, 6, 6, 6, 3, 6, 6, 6, 6, 3, 3, 4, 3, 3, 6, 3, 1, 1, 3, 6, 6, 6, 3, 6, 3, 1, 9, 3, 6, 9, 6, 3, 8, 6, 3, 8, 6
ATTACK acc: 26.271186440677965
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:52:39, Val iteration 0, acc 96.200 (96.200)
2021-06-11 23:52:51, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 23:52:57, Epoch 0, Iteration 7, loss 0.777 (0.822), acc 82.692 (80.200)
2021-06-11 23:54:09, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.8115875, 2.3864253, -2.269517, 1.0600779, -1.0233411, -0.060728908, 5.69461, -2.739372, -1.5555879, 0.34607512]
Target sample: 7, Prediction:6, Target's Score:[-5.5070877, 3.3821528, -2.502328, 0.8959433, -2.5443766, -3.7068346, 7.775592, -3.4643598, 6.7994895, -1.0995055]
Target sample: 13, Prediction:6, Target's Score:[-3.2634184, 2.893362, -1.7291658, 0.9018435, -1.376677, -4.047865, 7.620653, -2.171691, 1.7893124, -0.58911705]
Target sample: 19, Prediction:6, Target's Score:[-3.6701338, 0.19374144, -1.4303576, 4.2781577, -0.9366618, -4.699511, 6.945665, -0.93971324, 2.2756023, -1.9704627]
Target sample: 25, Prediction:6, Target's Score:[-3.9949424, 3.5711489, -1.4514768, 0.97608894, -1.4679784, -4.414474, 7.580701, -1.7247975, 2.5369477, -1.5884291]
Target sample: 31, Prediction:6, Target's Score:[-1.5565141, 3.6483836, -1.0197937, 1.3388596, 1.6995355, -5.214398, 6.41986, -2.97893, -1.2399625, -1.0784041]
Target sample: 37, Prediction:1, Target's Score:[-0.6665752, 5.491478, -1.3587626, 0.4248042, -2.5203822, -3.9945393, 4.1646786, -2.9220293, -1.1070404, 2.5107298]
Target sample: 43, Prediction:1, Target's Score:[-2.4010088, 6.5394163, -1.6845728, 2.834088, -3.1822288, -3.53212, 5.2249756, -3.3552306, -0.37410742, -0.046381183]
Target sample: 49, Prediction:1, Target's Score:[-2.999236, 5.926065, 0.539167, 3.851146, -1.0804628, -4.967527, 3.133975, -3.3081272, -1.1667129, 0.090149514]
Target sample: 55, Prediction:1, Target's Score:[-2.926441, 7.7406797, 0.43458024, 2.1032944, -2.3303242, -4.4040794, 5.5097437, -2.0099566, -2.8859987, -1.2246705]
Target sample: 61, Prediction:6, Target's Score:[-2.4887412, 2.0744705, -2.267188, 4.905729, -2.9505205, -1.923662, 6.2140517, -3.0764656, 0.73981637, -1.1842533]
Target sample: 67, Prediction:3, Target's Score:[-2.616424, 0.19662076, -1.3932278, 5.5505714, -1.5306677, -2.6875653, 2.858593, -1.2960668, 2.0816967, -1.1181684]
Target sample: 73, Prediction:1, Target's Score:[-5.791969, 8.933034, -1.6815187, 2.9981039, -2.9198346, -4.9123073, 2.8103077, -3.158052, 5.387927, -1.650988]
Target sample: 79, Prediction:1, Target's Score:[-4.543224, 5.316739, 0.7028883, 3.1684842, -2.8393812, -3.9801533, 4.5740223, -2.7686894, 2.321775, -1.9331899]
Target sample: 85, Prediction:3, Target's Score:[-4.9270434, -0.0007059891, -1.9344186, 5.4659066, 2.9339912, -4.1592617, 2.7867048, -0.93262243, 3.2156384, -2.415373]
Target sample: 91, Prediction:6, Target's Score:[-3.5994618, 2.1831207, -1.6187783, 2.589337, 0.5479117, -4.030275, 6.0585246, -2.312985, 2.778325, -2.5674725]
Target sample: 97, Prediction:1, Target's Score:[-3.1684048, 5.4320793, -1.4005162, 2.34511, -1.2213929, -4.2947884, 4.7298985, -3.33362, 0.16778266, 0.76724744]
Target sample: 103, Prediction:6, Target's Score:[-1.276783, 4.19535, -1.8133663, 2.6704235, -3.6217356, -3.60062, 4.891083, -3.7604108, 2.4215891, -0.07129211]
Target sample: 109, Prediction:1, Target's Score:[-1.611571, 6.747056, -1.6068918, 2.0013382, -1.5524641, -4.7212, 4.542736, -3.981787, 0.9910451, -0.7915579]
Target sample: 115, Prediction:6, Target's Score:[-0.4071376, 3.6834989, 1.4057893, 1.2916551, -2.3741548, -4.719885, 4.0250134, -2.7475097, -0.31582272, 0.17765187]
Target sample: 121, Prediction:1, Target's Score:[-3.2383142, 4.98071, -0.85606354, 2.9628868, -0.72348416, -4.9875054, 4.2828503, -2.559872, 0.7456085, -0.583907]
Target sample: 127, Prediction:1, Target's Score:[-3.4812517, 6.590432, -1.9951309, 2.2584581, -2.8490198, -3.1480587, 5.6660657, -3.7270837, 1.4055318, -0.6985127]
Target sample: 133, Prediction:8, Target's Score:[-3.718316, 1.059003, -2.3234115, 1.5404265, -2.9553788, -2.0320485, 3.842907, 0.16433914, 5.296114, -0.843081]
Target sample: 139, Prediction:6, Target's Score:[-4.1828194, 2.4415174, -1.7045554, 1.4900129, -1.5160675, -3.3769627, 8.379826, -2.8735952, 2.948544, -1.5754842]
Current ATTACK acc on target samples: 45.833
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 23:55:19 Epoch 59, Val iteration 0, acc 94.000 (94.000)
2021-06-11 23:55:31 Epoch 59, Val iteration 19, acc 91.200 (92.330)
* Prec: 92.33000106811524
Per class accuracy =  [0.94657492 0.95412087 0.885191   0.82286699 0.95758131 0.87960441
 0.95677192 0.93732226 0.94289191 0.95008305]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 6, 1, 6, 1, 1, 6, 1, 1, 1, 9, 1, 1, 1, 1, 6, 6, 1, 8, 1, 1, 1, 1, 6, 6, 3, 6, 1, 6, 6, 6, 6, 6, 1, 8, 6, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 8, 6, 6, 6, 8, 6, 8, 8, 8, 6, 6, 6, 1, 1, 1, 1, 1, 6, 6, 1, 1, 6, 3, 6, 8, 1, 1, 6, 1, 1, 6, 6, 6, 1, 1, 1, 1, 6, 8, 8, 6, 8, 6, 6, 6, 8, 6, 6, 6, 6
ATTACK acc: 49.152542372881356
--------
------SUMMARY------
TIME ELAPSED (mins): 25
TARGET INDEX: 10
ResNet50 12.5 16.949152542372882 95.46000137329102 91.27000198364257
DPN92 25.0 41.52542372881356 95.50000267028808 92.88000144958497
MobileNetV2 37.5 26.271186440677965 91.22000160217286 89.51000137329102
GoogLeNet 45.833333333333336 49.152542372881356 95.41000213623047 92.33000106811524
True False False False True
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 92 images of target 11
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=11, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/11/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
# Targets: 16, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 23:55:51 Iteration 0 	 Training Loss: 8.552e-01 	 Loss in Target Net: 1.011e+00	  
tensor(-0.0006, device='cuda:0')
 2021-06-11 23:57:09 Iteration 50 	 Training Loss: 3.595e-01 	 Loss in Target Net: 2.513e-01	  
tensor(-0.0868, device='cuda:0')
 2021-06-11 23:58:26 Iteration 100 	 Training Loss: 3.120e-01 	 Loss in Target Net: 2.346e-01	  
tensor(-0.1488, device='cuda:0')
 2021-06-11 23:59:46 Iteration 150 	 Training Loss: 3.076e-01 	 Loss in Target Net: 2.238e-01	  
tensor(-0.1550, device='cuda:0')
 2021-06-12 00:01:06 Iteration 200 	 Training Loss: 3.060e-01 	 Loss in Target Net: 2.327e-01	  
tensor(-0.1519, device='cuda:0')
 2021-06-12 00:02:25 Iteration 250 	 Training Loss: 3.029e-01 	 Loss in Target Net: 2.245e-01	  
tensor(-0.1517, device='cuda:0')
 2021-06-12 00:03:44 Iteration 300 	 Training Loss: 3.053e-01 	 Loss in Target Net: 2.262e-01	  
tensor(-0.1520, device='cuda:0')
 2021-06-12 00:05:02 Iteration 350 	 Training Loss: 3.022e-01 	 Loss in Target Net: 2.300e-01	  
tensor(-0.1531, device='cuda:0')
 2021-06-12 00:06:21 Iteration 400 	 Training Loss: 3.012e-01 	 Loss in Target Net: 2.317e-01	  
tensor(-0.1513, device='cuda:0')
 2021-06-12 00:07:39 Iteration 450 	 Training Loss: 2.987e-01 	 Loss in Target Net: 2.244e-01	  
tensor(-0.1527, device='cuda:0')
 2021-06-12 00:08:58 Iteration 500 	 Training Loss: 3.005e-01 	 Loss in Target Net: 2.291e-01	  
tensor(-0.1539, device='cuda:0')
 2021-06-12 00:10:19 Iteration 550 	 Training Loss: 2.974e-01 	 Loss in Target Net: 2.311e-01	  
tensor(-0.1565, device='cuda:0')
 2021-06-12 00:11:40 Iteration 600 	 Training Loss: 3.012e-01 	 Loss in Target Net: 2.242e-01	  
tensor(-0.1542, device='cuda:0')
 2021-06-12 00:13:00 Iteration 650 	 Training Loss: 2.955e-01 	 Loss in Target Net: 2.257e-01	  
tensor(-0.1549, device='cuda:0')
 2021-06-12 00:14:21 Iteration 700 	 Training Loss: 3.012e-01 	 Loss in Target Net: 2.305e-01	  
tensor(-0.1533, device='cuda:0')
 2021-06-12 00:15:41 Iteration 750 	 Training Loss: 3.011e-01 	 Loss in Target Net: 2.347e-01	  
tensor(-0.1535, device='cuda:0')
 2021-06-12 00:17:01 Iteration 800 	 Training Loss: 3.022e-01 	 Loss in Target Net: 2.338e-01	  
tensor(-0.1525, device='cuda:0')
 2021-06-12 00:18:21 Iteration 850 	 Training Loss: 2.941e-01 	 Loss in Target Net: 2.354e-01	  
tensor(-0.1553, device='cuda:0')
 2021-06-12 00:19:47 Iteration 900 	 Training Loss: 2.957e-01 	 Loss in Target Net: 2.403e-01	  
tensor(-0.1566, device='cuda:0')
 2021-06-12 00:21:03 Iteration 950 	 Training Loss: 2.992e-01 	 Loss in Target Net: 2.340e-01	  
tensor(-0.1559, device='cuda:0')
 2021-06-12 00:22:24 Iteration 999 	 Training Loss: 2.957e-01 	 Loss in Target Net: 2.313e-01	  
tensor(-0.1575, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 00:22:29, Val iteration 0, acc 94.200 (94.200)
2021-06-12 00:22:39, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-12 00:22:44, Epoch 0, Iteration 7, loss 0.442 (0.516), acc 88.462 (90.400)
2021-06-12 00:23:44, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-4.0991836, 8.916932, -1.3286066, -0.99136025, -2.464968, -3.0245554, 7.8131356, -3.3646412, -0.8403022, -0.5597072]
Target sample: 7, Prediction:6, Target's Score:[-3.7136686, 6.8598413, -0.8808472, -0.73568434, -2.4263115, -2.8215904, 7.154444, -3.7114012, -2.6918538, 3.0093825]
Target sample: 13, Prediction:1, Target's Score:[-4.7878156, 10.640702, -1.4837863, -1.6515411, -3.0625753, -3.1791823, 6.4987535, -4.059377, -3.3155935, 4.401654]
Target sample: 19, Prediction:1, Target's Score:[-4.2211294, 10.690003, -1.822077, -0.64630014, -2.8694525, -3.0477846, 7.3752894, -3.7342281, -1.8200806, 0.13255027]
Target sample: 25, Prediction:1, Target's Score:[-5.2264485, 14.001741, -1.0391995, -1.0862852, -3.5500574, -3.8526351, 7.286982, -4.2490053, -2.605531, 0.31780347]
Target sample: 31, Prediction:1, Target's Score:[-5.0233088, 9.7618885, 0.62255174, -0.6167648, -2.8535903, -3.5773633, 7.5962467, -4.071593, -3.564705, 1.7446933]
Target sample: 37, Prediction:1, Target's Score:[-3.6242008, 7.043551, -1.1848153, -0.7061557, -2.3111656, -2.819789, 6.4980416, -3.5431855, -2.1150863, 2.7946217]
Target sample: 43, Prediction:1, Target's Score:[-3.9065485, 10.300641, -1.4104354, -0.8097398, -2.7529795, -3.005786, 5.431668, -3.2290943, -2.0453799, 1.4230615]
Target sample: 49, Prediction:1, Target's Score:[-5.1546535, 13.062262, -0.8385406, -1.7171717, -3.2984266, -3.8882222, 7.1937165, -3.4383094, -2.4723072, 0.55379117]
Target sample: 55, Prediction:6, Target's Score:[-3.583966, 8.224737, -1.2540414, -1.4166342, -2.3431985, -3.3643448, 9.0334835, -3.6180434, -1.8741306, 0.28075087]
Target sample: 61, Prediction:6, Target's Score:[-4.238847, 8.715002, -1.5163947, -1.0466496, -2.428071, -3.0879202, 9.245684, -3.626154, -0.83679014, -1.0895141]
Target sample: 67, Prediction:1, Target's Score:[-4.6050806, 10.737166, -1.3946948, -1.3952216, -2.79142, -3.539824, 8.311334, -3.9686697, -2.216047, 0.91166145]
Target sample: 73, Prediction:1, Target's Score:[-4.640573, 12.092686, -1.4038439, -1.380878, -3.1208458, -3.499148, 7.674971, -3.5770686, -2.0949488, -0.02046306]
Target sample: 79, Prediction:1, Target's Score:[-4.509281, 11.119781, -1.5152797, -1.20625, -2.963318, -3.214143, 6.7499404, -3.5067928, -2.3302772, 1.3885698]
Target sample: 85, Prediction:6, Target's Score:[-3.650114, 7.4054627, -1.459715, -0.8026187, -2.294632, -2.877459, 7.6100054, -3.231714, 0.2714288, -0.903717]
Target sample: 91, Prediction:1, Target's Score:[-3.8896823, 8.048445, -0.48524526, -0.7856159, -2.7526221, -2.9318275, 6.762424, -3.9006891, -3.1767993, 3.1371143]
Current ATTACK acc on target samples: 25.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 00:24:44 Epoch 59, Val iteration 0, acc 89.200 (89.200)
2021-06-12 00:24:54 Epoch 59, Val iteration 19, acc 89.800 (89.790)
* Prec: 89.79000205993653
Per class accuracy =  [0.94222501 0.9337127  0.84157273 0.82456522 0.86568521 0.80393512
 0.97805734 0.88533612 0.95119668 0.95611911]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 6, 6, 1
ATTACK acc: 13.157894736842104
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 00:25:05, Val iteration 0, acc 94.800 (94.800)
2021-06-12 00:25:26, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-12 00:25:39, Epoch 0, Iteration 7, loss 0.173 (0.483), acc 92.308 (88.600)
2021-06-12 00:28:19, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.6306236, 9.321583, -2.5885193, -1.8762189, -2.6356964, -1.060772, 4.109882, -1.3736814, -0.91373634, -0.8215571]
Target sample: 7, Prediction:6, Target's Score:[-1.3243433, 4.2667556, -1.1810014, -1.6265799, -1.4225254, -0.16191372, 9.276537, -1.8157281, -3.7533388, -1.7939385]
Target sample: 13, Prediction:1, Target's Score:[-2.5281649, 9.157467, -1.2101682, -1.3671346, -3.1232939, -1.5179878, 6.4427075, -3.2861087, -2.5660675, 0.5562023]
Target sample: 19, Prediction:6, Target's Score:[-2.1499612, 3.9112194, -1.8225207, -0.17940256, -2.5628464, -0.37471497, 7.4268117, -1.1486769, -1.1692861, -1.5198221]
Target sample: 25, Prediction:6, Target's Score:[-2.6633427, 6.846613, -0.3944179, -0.5336447, -2.609426, -1.1157572, 7.74304, -2.9020984, -3.124691, -0.72924954]
Target sample: 31, Prediction:6, Target's Score:[-2.1524694, 5.001726, -0.8940644, -1.1985841, -0.6983183, -1.0432905, 8.195295, -1.9239665, -3.390932, -1.4380758]
Target sample: 37, Prediction:1, Target's Score:[-1.7789459, 9.647486, -1.954005, -2.0685673, -1.0610338, -1.412079, 3.4366553, -1.9140775, -1.9979783, -0.35219106]
Target sample: 43, Prediction:1, Target's Score:[-1.964865, 6.627889, -2.2886558, -1.1724154, -1.3275187, -1.1818678, 5.154952, -1.0385153, -1.0027511, -1.336315]
Target sample: 49, Prediction:6, Target's Score:[-1.3498669, 5.544804, -0.49542433, -2.300681, -2.2223182, -0.18145138, 9.608021, -2.0240529, -4.073579, -2.0035632]
Target sample: 55, Prediction:6, Target's Score:[-2.0527914, 4.172174, -1.1620259, -1.4487435, -1.8792322, -0.59966624, 11.19969, -2.8404098, -3.9367652, -0.9912876]
Target sample: 61, Prediction:6, Target's Score:[-2.542783, 5.6192255, -2.2981925, -0.2093266, -1.1606462, -0.96855354, 7.4555235, -2.1556232, -2.141153, -1.1317669]
Target sample: 67, Prediction:6, Target's Score:[-2.5870984, 4.8074336, -0.4234995, -0.65627885, -1.9254934, -0.8915191, 9.268827, -2.2762527, -3.0760355, -1.7743517]
Target sample: 73, Prediction:6, Target's Score:[-1.1539065, 6.5506277, -1.9007545, -1.8902329, -2.251878, -0.5740015, 7.6176805, -2.2259424, -3.3619025, -0.32145247]
Target sample: 79, Prediction:1, Target's Score:[-1.6984009, 7.8967233, -2.5778978, -1.7332072, -2.0797424, -1.0809163, 5.425243, -1.4516329, -1.503942, -0.6962527]
Target sample: 85, Prediction:1, Target's Score:[-1.8509086, 8.112981, -2.192897, -1.2100508, -1.6461095, -1.3692273, 3.6641786, -0.98937964, -0.6031937, -1.4280108]
Target sample: 91, Prediction:6, Target's Score:[-1.890929, 6.649178, -1.6260707, -2.132872, -2.382592, 1.1969693, 6.79556, -1.8306177, -3.1328175, -1.1272781]
Current ATTACK acc on target samples: 62.500
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 00:30:55 Epoch 59, Val iteration 0, acc 93.000 (93.000)
2021-06-12 00:31:16 Epoch 59, Val iteration 19, acc 94.000 (93.680)
* Prec: 93.68000106811523
Per class accuracy =  [0.9501895  0.96316386 0.91915351 0.88248102 0.9491304  0.87626429
 0.95462635 0.95022071 0.9696246  0.95376311]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6
ATTACK acc: 57.89473684210526
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 00:31:20, Val iteration 0, acc 92.600 (92.600)
2021-06-12 00:31:25, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-12 00:31:27, Epoch 0, Iteration 7, loss 0.552 (0.358), acc 86.538 (90.200)
2021-06-12 00:31:55, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-2.2398245, 7.9183245, -0.6886822, -0.94842976, -1.6911571, -1.7699857, 6.307258, -3.434373, -3.1219862, -0.022794858]
Target sample: 7, Prediction:6, Target's Score:[-0.88707364, 6.509647, -0.080143504, 1.0738666, -3.0515041, -2.711128, 9.606432, -6.2075605, -4.2348537, 0.2941911]
Target sample: 13, Prediction:1, Target's Score:[-2.0093577, 8.867467, -2.4465258, -1.749021, -4.0599847, -1.2904692, 8.8354435, -6.8204627, -3.3224719, 4.334191]
Target sample: 19, Prediction:1, Target's Score:[-3.019548, 12.764102, -6.1906996, 3.0535705, -4.788999, -2.330093, 4.7049375, -3.9141672, 0.29157704, -0.19714649]
Target sample: 25, Prediction:6, Target's Score:[-3.2240922, 5.696726, -0.715338, 2.251862, -1.471628, -4.062257, 7.452851, -4.937245, -1.922256, 1.229588]
Target sample: 31, Prediction:6, Target's Score:[-2.097763, 10.432868, -3.322357, 1.2733994, -6.2949266, -1.9386587, 12.873804, -7.9488764, -4.677153, 2.0692642]
Target sample: 37, Prediction:1, Target's Score:[-0.8568611, 9.811176, -2.443407, -0.93094176, 0.62886846, -2.6886735, 2.5876265, -4.3116775, -4.249799, 2.7979505]
Target sample: 43, Prediction:1, Target's Score:[-0.40003324, 10.406801, -2.1599874, 1.1625254, 3.669064, -4.1767273, -0.010716975, -4.203794, -4.03963, 0.13032365]
Target sample: 49, Prediction:6, Target's Score:[-2.183863, 9.224115, 0.17795846, 0.08627975, -4.8567405, -2.6448255, 11.6661825, -6.1479073, -2.301766, -2.672049]
Target sample: 55, Prediction:6, Target's Score:[-1.8269159, 8.140387, -2.1090198, -0.62802494, -3.8649485, -3.3112488, 10.714498, -4.253674, -3.696823, 1.1502308]
Target sample: 61, Prediction:6, Target's Score:[-3.0021093, 6.190509, -2.1911511, 1.8826208, -0.8558842, -2.3129084, 8.989441, -5.1481333, -1.8466958, -1.4044365]
Target sample: 67, Prediction:6, Target's Score:[-2.665233, 7.7632966, -1.7843686, 0.11403155, -3.1680858, -3.6033595, 11.854843, -4.711579, -2.0803711, -1.3974886]
Target sample: 73, Prediction:1, Target's Score:[-0.97118425, 11.477808, -3.2436807, 0.078543395, -4.2019863, -2.652891, 8.386027, -4.7889657, -3.3401742, -0.37580338]
Target sample: 79, Prediction:6, Target's Score:[-2.0577211, 6.134709, -0.8439734, 1.402698, 1.619228, -2.9270625, 6.487634, -5.1401887, -5.201764, 0.84218854]
Target sample: 85, Prediction:1, Target's Score:[0.4864714, 9.711113, 0.098404475, 1.0114043, -2.250153, -3.666096, 1.5172566, -2.5607228, -4.954853, 0.9507732]
Target sample: 91, Prediction:6, Target's Score:[-1.8219728, 8.347167, -2.3182712, -0.24206385, -4.0209637, -1.4814107, 8.483629, -5.605654, -4.268173, 3.2334383]
Current ATTACK acc on target samples: 56.250
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 00:32:23 Epoch 59, Val iteration 0, acc 90.200 (90.200)
2021-06-12 00:32:29 Epoch 59, Val iteration 19, acc 90.000 (89.590)
* Prec: 89.59000129699707
Per class accuracy =  [0.9231035  0.92418747 0.84201069 0.83410979 0.89365754 0.82859742
 0.9398081  0.88806483 0.93202064 0.94973764]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 6, 1, 6, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 6, 6, 6, 6, 1, 6, 6, 6, 1, 6, 1, 1, 1, 6, 1, 6, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 6, 6, 1
ATTACK acc: 34.21052631578947
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 00:32:36, Val iteration 0, acc 96.200 (96.200)
2021-06-12 00:32:48, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-12 00:32:54, Epoch 0, Iteration 7, loss 0.348 (0.738), acc 90.385 (82.800)
2021-06-12 00:34:06, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-3.636659, 8.952372, -3.4932055, -2.892262, -3.0268853, -2.853599, 10.670184, -2.8726323, -0.30195245, -0.5346484]
Target sample: 7, Prediction:6, Target's Score:[-3.5293865, 7.2783914, -2.6921535, -1.950816, -4.072731, -2.4379277, 10.704806, -2.9496837, -2.90113, 2.569587]
Target sample: 13, Prediction:6, Target's Score:[-4.208486, 8.348949, -2.316021, -2.3377452, -3.6124458, -2.4540317, 12.576773, -3.1215732, -1.8392497, -1.0262495]
Target sample: 19, Prediction:1, Target's Score:[-3.776083, 9.091038, -2.8538213, -3.3888588, -2.888615, 0.23816387, 7.9110246, -2.6658797, -0.66773057, -0.9832823]
Target sample: 25, Prediction:1, Target's Score:[-3.2187052, 9.611975, -3.1102314, 0.33571076, -3.1239793, -2.523102, 8.421275, -3.6340513, -2.5590584, -0.19703618]
Target sample: 31, Prediction:6, Target's Score:[-3.6323304, 5.8781366, -0.38402444, -2.0967228, -3.7022147, -2.2748783, 12.125335, -2.5781305, -2.457974, -0.8638395]
Target sample: 37, Prediction:1, Target's Score:[-2.7548642, 10.135104, -3.576004, -3.103756, -3.2736504, -3.235838, 9.61783, -3.202856, -1.7860688, 1.1925722]
Target sample: 43, Prediction:1, Target's Score:[-2.9355187, 10.2885275, -4.017298, -2.9781494, -3.6075046, -2.9745107, 7.8200035, -3.3081603, -1.1643023, 2.8940768]
Target sample: 49, Prediction:6, Target's Score:[-3.7503893, 8.52428, -1.7259132, -1.8673587, -3.2663236, -3.2326083, 10.175286, -2.6942396, -1.9832991, -0.17149243]
Target sample: 55, Prediction:6, Target's Score:[-3.8592753, 5.57902, -2.7984052, -2.498513, -2.9168317, -2.3047945, 13.183836, -2.810308, -1.7489215, 0.19317493]
Target sample: 61, Prediction:6, Target's Score:[-4.655972, 7.701401, -2.8513353, -3.8813891, -2.3999283, -1.2137061, 12.399173, -2.355774, -0.057566926, -2.6708252]
Target sample: 67, Prediction:6, Target's Score:[-3.9464843, 9.18111, -1.6825581, -2.368798, -4.1109343, -2.55731, 11.599471, -3.4450974, -2.5323625, -0.12336025]
Target sample: 73, Prediction:6, Target's Score:[-3.0745454, 7.6812406, -1.6788663, -1.7659763, -3.150997, -2.7132912, 10.068369, -2.4262364, -2.1758647, -0.755739]
Target sample: 79, Prediction:1, Target's Score:[-2.9358215, 9.546264, -2.910694, -2.2803946, -3.1224055, -3.6508865, 9.083926, -2.7340517, -1.8686166, 0.88137746]
Target sample: 85, Prediction:1, Target's Score:[-3.739866, 8.746544, -2.2340384, -2.9531312, -3.0643072, -3.0967426, 8.654022, -2.1327097, -0.4724274, 0.30269304]
Target sample: 91, Prediction:6, Target's Score:[-3.9686327, 4.151127, -2.8538952, -3.1701026, -4.2219048, -2.2055895, 15.238591, -3.7518792, -3.734214, 4.5565624]
Current ATTACK acc on target samples: 62.500
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 00:35:16 Epoch 59, Val iteration 0, acc 93.800 (93.800)
2021-06-12 00:35:29 Epoch 59, Val iteration 19, acc 93.400 (92.940)
* Prec: 92.9400016784668
Per class accuracy =  [0.95007654 0.94496134 0.88572958 0.86735925 0.95627832 0.89124439
 0.96772244 0.92973452 0.95112709 0.94927313]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 1, 1, 1, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 6, 6, 1, 1, 1, 6, 6, 6, 6
ATTACK acc: 67.10526315789474
--------
------SUMMARY------
TIME ELAPSED (mins): 26
TARGET INDEX: 11
ResNet50 25.0 13.157894736842104 95.46000137329102 89.79000205993653
DPN92 62.5 57.89473684210526 95.50000267028808 93.68000106811523
MobileNetV2 56.25 34.21052631578947 91.22000160217286 89.59000129699707
GoogLeNet 62.5 67.10526315789474 95.41000213623047 92.9400016784668
True False False False True
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 119 images of target 12
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=12, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/12/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115]
# Targets: 20, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-12 00:35:49 Iteration 0 	 Training Loss: 8.592e-01 	 Loss in Target Net: 1.120e+00	  
tensor(0.0001, device='cuda:0')
 2021-06-12 00:37:08 Iteration 50 	 Training Loss: 3.536e-01 	 Loss in Target Net: 3.521e-01	  
tensor(-0.0520, device='cuda:0')
 2021-06-12 00:38:29 Iteration 100 	 Training Loss: 3.005e-01 	 Loss in Target Net: 3.573e-01	  
tensor(-0.1345, device='cuda:0')
 2021-06-12 00:39:53 Iteration 150 	 Training Loss: 2.765e-01 	 Loss in Target Net: 3.689e-01	  
tensor(-0.1914, device='cuda:0')
 2021-06-12 00:41:15 Iteration 200 	 Training Loss: 2.625e-01 	 Loss in Target Net: 3.723e-01	  
tensor(-0.2169, device='cuda:0')
 2021-06-12 00:42:35 Iteration 250 	 Training Loss: 2.578e-01 	 Loss in Target Net: 3.701e-01	  
tensor(-0.2356, device='cuda:0')
 2021-06-12 00:43:54 Iteration 300 	 Training Loss: 2.531e-01 	 Loss in Target Net: 3.685e-01	  
tensor(-0.2358, device='cuda:0')
 2021-06-12 00:45:16 Iteration 350 	 Training Loss: 2.507e-01 	 Loss in Target Net: 3.886e-01	  
tensor(-0.2361, device='cuda:0')
 2021-06-12 00:46:36 Iteration 400 	 Training Loss: 2.540e-01 	 Loss in Target Net: 3.589e-01	  
tensor(-0.2418, device='cuda:0')
 2021-06-12 00:47:56 Iteration 450 	 Training Loss: 2.548e-01 	 Loss in Target Net: 3.913e-01	  
tensor(-0.2396, device='cuda:0')
 2021-06-12 00:49:15 Iteration 500 	 Training Loss: 2.527e-01 	 Loss in Target Net: 3.659e-01	  
tensor(-0.2394, device='cuda:0')
 2021-06-12 00:50:35 Iteration 550 	 Training Loss: 2.568e-01 	 Loss in Target Net: 3.406e-01	  
tensor(-0.2357, device='cuda:0')
 2021-06-12 00:51:52 Iteration 600 	 Training Loss: 2.497e-01 	 Loss in Target Net: 3.262e-01	  
tensor(-0.2408, device='cuda:0')
 2021-06-12 00:53:12 Iteration 650 	 Training Loss: 2.510e-01 	 Loss in Target Net: 3.670e-01	  
tensor(-0.2372, device='cuda:0')
 2021-06-12 00:54:34 Iteration 700 	 Training Loss: 2.504e-01 	 Loss in Target Net: 3.428e-01	  
tensor(-0.2328, device='cuda:0')
 2021-06-12 00:55:54 Iteration 750 	 Training Loss: 2.478e-01 	 Loss in Target Net: 3.542e-01	  
tensor(-0.2357, device='cuda:0')
 2021-06-12 00:57:15 Iteration 800 	 Training Loss: 2.462e-01 	 Loss in Target Net: 3.474e-01	  
tensor(-0.2408, device='cuda:0')
 2021-06-12 00:58:36 Iteration 850 	 Training Loss: 2.506e-01 	 Loss in Target Net: 3.528e-01	  
tensor(-0.2389, device='cuda:0')
 2021-06-12 00:59:57 Iteration 900 	 Training Loss: 2.499e-01 	 Loss in Target Net: 3.907e-01	  
tensor(-0.2361, device='cuda:0')
 2021-06-12 01:01:17 Iteration 950 	 Training Loss: 2.549e-01 	 Loss in Target Net: 3.518e-01	  
tensor(-0.2339, device='cuda:0')
 2021-06-12 01:02:36 Iteration 999 	 Training Loss: 2.566e-01 	 Loss in Target Net: 3.635e-01	  
tensor(-0.2304, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 01:02:42, Val iteration 0, acc 94.200 (94.200)
2021-06-12 01:02:52, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-12 01:02:57, Epoch 0, Iteration 7, loss 0.408 (0.611), acc 90.385 (87.800)
2021-06-12 01:03:57, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-2.8759623, 7.1951694, -1.5306542, -0.3325118, -1.9723499, -2.3790033, 6.2367125, -2.7893138, -0.02036466, -1.559814]
Target sample: 7, Prediction:6, Target's Score:[-2.5387974, 4.246294, -2.2567582, -1.9619851, -2.2371724, -2.9052625, 6.1160254, -2.568982, 6.0536685, -1.9662229]
Target sample: 13, Prediction:6, Target's Score:[-3.121742, 4.2145224, -2.7601845, -1.8000884, -2.1907067, -2.8396218, 8.27556, -2.8780837, 3.7702625, -0.6643083]
Target sample: 19, Prediction:6, Target's Score:[-2.5921137, 0.32565522, -1.1490248, -1.0070189, -0.4549175, -2.6466448, 7.7836704, -3.1362376, -0.8409967, 3.711925]
Target sample: 25, Prediction:6, Target's Score:[-1.55163, 2.6927588, -0.027007911, -0.9268779, -1.3414813, -2.0981479, 6.4085593, -2.4280014, -0.88740903, 0.17432801]
Target sample: 31, Prediction:6, Target's Score:[-2.3103373, 3.6213844, -2.1856785, -0.5173448, -2.038161, -1.5231509, 7.4188766, -2.6047282, -0.6318438, 0.77253526]
Target sample: 37, Prediction:1, Target's Score:[-2.0609288, 8.537602, -1.8330741, -0.73149115, -2.3978589, -2.035541, 5.461264, -1.8579938, -0.8511459, -2.2605925]
Target sample: 43, Prediction:1, Target's Score:[-2.6529307, 6.7112575, -1.5640712, -0.9165155, -1.68073, -2.228611, 6.6369767, -2.136079, -0.5278063, -1.6534655]
Target sample: 49, Prediction:6, Target's Score:[-2.7757907, 3.9465208, -1.2499794, 0.53489655, -1.3696717, -1.6542127, 6.5267663, -2.4723842, -2.2852986, 0.78011173]
Target sample: 55, Prediction:6, Target's Score:[-2.886038, 3.9306471, -0.2080716, -0.19983472, -0.96592367, -1.6239154, 6.9712014, -3.000519, -2.5597708, 0.53613335]
Target sample: 61, Prediction:6, Target's Score:[-3.4256437, 3.1422606, -2.381265, -0.89878094, -1.7852163, -1.9991894, 8.5359745, -3.1260455, 0.27978864, 1.6553054]
Target sample: 67, Prediction:1, Target's Score:[-0.11076324, 6.0992846, -2.4307866, -0.4648453, -2.9384809, -2.1796927, 4.4859743, -3.0040383, 2.2961898, -1.7769781]
Target sample: 73, Prediction:6, Target's Score:[-2.5743344, 4.116327, -1.7786483, -0.32721326, -1.6774888, -1.3829799, 7.194672, -2.5164595, -1.3827758, 0.33048198]
Target sample: 79, Prediction:1, Target's Score:[-2.0709884, 6.171575, -1.7194625, 0.06867002, -2.0335743, -1.2675172, 5.6019278, -2.1818948, -2.150856, -0.44793123]
Target sample: 85, Prediction:6, Target's Score:[-3.1803288, 2.6333575, -1.8235284, 0.29712445, -1.7483056, -0.7875615, 7.4262743, -2.4104521, -0.8058129, 0.40415525]
Target sample: 91, Prediction:6, Target's Score:[-1.8714732, 4.9075046, -1.2006121, 0.33286917, -1.5220083, -1.5386835, 5.915504, -2.4606788, -1.4485854, -1.1193657]
Target sample: 97, Prediction:1, Target's Score:[-1.9283726, 9.174029, -2.0518866, -1.1129597, -2.4558275, -2.1070096, 4.960081, -2.092773, -0.8333371, -1.5974553]
Target sample: 103, Prediction:1, Target's Score:[-2.1097763, 8.864388, -1.5230845, 0.4220557, -2.740614, -1.7683157, 5.0649776, -2.6708353, -1.7266574, -1.8677243]
Target sample: 109, Prediction:6, Target's Score:[-3.067431, 6.1956544, -1.7638327, -0.98467773, -2.1014862, -1.9974682, 7.4163175, -2.471457, -1.4061896, 0.1675558]
Target sample: 115, Prediction:6, Target's Score:[-3.7588243, 1.4651932, -2.4010606, -2.1162174, -2.1599746, -3.3599868, 9.110834, -3.851448, 0.25015068, 6.7781367]
Current ATTACK acc on target samples: 65.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 01:04:57 Epoch 59, Val iteration 0, acc 90.000 (90.000)
2021-06-12 01:05:07 Epoch 59, Val iteration 19, acc 91.200 (90.210)
* Prec: 90.21000175476074
Per class accuracy =  [0.91628707 0.92730498 0.80491402 0.89749738 0.93132826 0.81655157
 0.95856606 0.87213004 0.96391175 0.93601152]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 8, 8, 8, 8, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 1, 1
ATTACK acc: 60.60606060606061
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 01:05:19, Val iteration 0, acc 94.800 (94.800)
2021-06-12 01:05:39, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-12 01:05:52, Epoch 0, Iteration 7, loss 0.175 (0.413), acc 96.154 (90.400)
2021-06-12 01:08:32, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.8270649, 10.627768, -4.2616315, -1.1305667, -0.9001216, -2.1799061, 3.3932424, -4.191702, 0.39774063, 0.5616538]
Target sample: 7, Prediction:1, Target's Score:[1.7885878, 7.234644, -4.0666533, -1.5815738, -1.5839154, -3.6841593, 6.0364804, -3.6374226, 0.32016042, -0.3427385]
Target sample: 13, Prediction:8, Target's Score:[0.67463535, 3.7383456, -4.267031, -1.5288247, -1.1475676, -3.8890483, 1.1812508, -2.6298344, 7.5490065, 0.7468856]
Target sample: 19, Prediction:9, Target's Score:[-1.0597358, 1.3971304, -3.404838, -0.8534022, 0.54108095, -3.390433, 3.3283048, -2.8653715, -0.081276156, 6.800934]
Target sample: 25, Prediction:1, Target's Score:[-1.7227025, 9.556725, -3.7362397, -1.8661355, -0.8107353, -1.6821482, 3.4790177, -4.0783596, 0.91861486, 0.42146775]
Target sample: 31, Prediction:1, Target's Score:[0.43138844, 8.806769, -4.580928, -1.3734823, -2.605501, -1.8376219, 7.430716, -3.770558, -0.2475234, -1.7550496]
Target sample: 37, Prediction:1, Target's Score:[-2.3708189, 12.631407, -4.599514, -1.806319, -1.6756331, -1.8836932, 3.6706707, -4.0208216, 1.6817594, -1.0725764]
Target sample: 43, Prediction:1, Target's Score:[-1.6727792, 9.641059, -4.901676, -1.6215155, -1.1859722, -2.5354593, 3.1648118, -3.6110103, 1.4007316, 1.8028542]
Target sample: 49, Prediction:1, Target's Score:[-1.2138381, 9.487779, -4.297977, -1.9078915, -1.6571771, -1.8743408, 6.2155857, -3.7086802, -0.7088887, 0.15669858]
Target sample: 55, Prediction:1, Target's Score:[-1.0841588, 5.302223, -2.4592152, -0.31110075, -0.631876, -2.0273495, 1.337908, -3.0761034, -1.469101, 4.8282733]
Target sample: 61, Prediction:9, Target's Score:[-0.6483414, 4.757394, -4.2574744, -1.5661309, -1.2513082, -2.101924, 4.46519, -3.372542, -0.5648364, 4.978599]
Target sample: 67, Prediction:1, Target's Score:[-1.1347394, 5.652506, -5.136158, 0.17094204, -1.5450424, -3.0484684, 1.0415422, -2.9548504, 3.743284, 3.6525013]
Target sample: 73, Prediction:6, Target's Score:[2.5980685, 2.6487288, -4.017997, -0.38493577, -0.004383645, -3.3519137, 3.1827185, -1.447769, -1.2248688, 2.3862371]
Target sample: 79, Prediction:1, Target's Score:[-0.43878615, 11.059389, -4.7495475, -1.7263523, -2.6346643, -1.6319146, 4.919738, -3.8658063, -0.60214025, 0.18225555]
Target sample: 85, Prediction:1, Target's Score:[0.10688869, 9.728547, -4.363106, -1.7906998, -2.5556192, -1.2019367, 4.4405212, -3.8468251, -0.34063718, 0.3051481]
Target sample: 91, Prediction:1, Target's Score:[-1.1381407, 10.612649, -4.458199, -1.6278876, -1.9839811, -0.99664754, 4.197676, -4.6114016, 0.013389371, 0.51062375]
Target sample: 97, Prediction:1, Target's Score:[-1.2215763, 11.925894, -4.5488095, -1.8782667, -1.932461, -1.7706954, 4.331569, -3.809897, 0.7476788, -1.3158914]
Target sample: 103, Prediction:1, Target's Score:[-0.2585968, 11.149387, -4.2752113, -1.7010683, -2.0925977, -1.3388481, 4.04279, -4.2377467, -0.88495016, 0.12203018]
Target sample: 109, Prediction:1, Target's Score:[-1.5742235, 11.49577, -4.6488433, -1.3598056, -1.4922353, -1.5450518, 4.278164, -3.9774258, 0.12270567, -0.7830836]
Target sample: 115, Prediction:9, Target's Score:[-0.44023058, 1.3513595, -3.7834954, -1.0634392, -0.9243515, -2.372914, 1.9820274, -3.162057, -1.7924721, 10.646416]
Current ATTACK acc on target samples: 5.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 01:11:08 Epoch 59, Val iteration 0, acc 92.400 (92.400)
2021-06-12 01:11:29 Epoch 59, Val iteration 19, acc 94.200 (93.260)
* Prec: 93.26000175476074
Per class accuracy =  [0.93922971 0.97036871 0.90292387 0.85701746 0.94468325 0.88274069
 0.96757596 0.92968868 0.96942059 0.96494976]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 6, 9, 9, 9, 1, 1, 8, 8, 1, 1, 6, 6, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 6, 6, 6, 9, 9, 9, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 9, 6, 1, 1
ATTACK acc: 11.11111111111111
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 01:11:33, Val iteration 0, acc 92.600 (92.600)
2021-06-12 01:11:38, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-12 01:11:40, Epoch 0, Iteration 7, loss 0.351 (0.375), acc 88.462 (90.000)
2021-06-12 01:12:08, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.7693729, 10.1422615, -5.1023865, 4.016598, -7.935203, -0.4067565, 6.119867, -8.054114, -0.7078264, 4.0774045]
Target sample: 7, Prediction:6, Target's Score:[-0.51532054, 5.0159855, -5.5789914, 1.2456295, -6.1462064, -3.7942414, 8.951396, -6.7392726, 7.750874, 0.17136712]
Target sample: 13, Prediction:1, Target's Score:[-2.0984793, 10.380395, -4.4891176, 0.7792831, -6.343208, -2.5767329, 5.189871, -6.6974916, 5.744711, 0.5125307]
Target sample: 19, Prediction:6, Target's Score:[-1.7173153, 3.3331752, -4.0903893, 3.8750834, -4.77052, -2.8255155, 9.344826, -6.35193, -0.5099794, 4.000949]
Target sample: 25, Prediction:1, Target's Score:[-0.6957097, 7.745618, -2.4503188, -1.7598469, -3.802814, -2.1346662, 7.6212454, -5.0222836, -2.4615748, 3.2372522]
Target sample: 31, Prediction:1, Target's Score:[0.8437061, 9.428491, -5.339817, -0.680675, -2.1855662, -3.3576176, 6.0127234, -3.567558, -1.0641867, 0.21580787]
Target sample: 37, Prediction:1, Target's Score:[-1.2365825, 17.344557, -4.2687836, -0.08473189, -7.106862, -0.6318786, 0.33741572, -5.829434, 1.0532675, 0.87389493]
Target sample: 43, Prediction:1, Target's Score:[0.47373182, 9.0683565, -4.5426154, 0.87447435, -3.780249, -4.2552752, -1.3595862, -3.0615704, 3.9413378, 3.017673]
Target sample: 49, Prediction:1, Target's Score:[-2.504198, 8.937321, -3.9047894, 0.18737176, -5.2989206, -0.6232811, 5.822787, -5.252192, -1.377968, 4.34661]
Target sample: 55, Prediction:6, Target's Score:[-2.3017666, 7.0774527, -4.3286433, 1.4433856, -7.146886, -1.5069339, 8.357136, -5.9766994, -1.4385519, 6.1489305]
Target sample: 61, Prediction:1, Target's Score:[-0.08740547, 10.050611, -4.3961887, -0.5862506, -6.876408, -2.4436536, 7.5816493, -6.7300906, 3.8827152, -0.019523075]
Target sample: 67, Prediction:1, Target's Score:[-0.6342975, 7.996787, -4.119842, -0.7604895, -6.313967, -3.0649543, 1.1541544, -5.8165665, 7.4884405, 4.492742]
Target sample: 73, Prediction:6, Target's Score:[-3.845759, 6.441809, -3.7714396, 1.5944252, -2.5007524, -1.626473, 7.5328364, -5.5003405, 0.27353293, 1.7087445]
Target sample: 79, Prediction:1, Target's Score:[-0.25481844, 10.318895, -4.4778957, -0.034118235, -4.2530694, -0.36011484, 1.4382509, -3.0815856, -3.3609006, 4.3670363]
Target sample: 85, Prediction:1, Target's Score:[0.4535476, 9.85609, -3.8187869, -1.2805853, -5.6974974, -2.3465838, 6.197035, -4.0084276, -1.4625889, 2.4220967]
Target sample: 91, Prediction:1, Target's Score:[-1.1085974, 10.2561035, -3.4826086, -0.64955944, -3.8291438, -1.5301269, 5.4324145, -5.371125, -1.6752242, 2.2943494]
Target sample: 97, Prediction:1, Target's Score:[-1.5432507, 11.770734, -4.00587, -0.50044674, -4.876069, -1.4913338, 2.2141342, -4.3761725, 1.735321, 1.4394971]
Target sample: 103, Prediction:1, Target's Score:[2.2810967, 10.102796, -1.7786276, -0.30758798, -2.3520887, -1.3375779, -1.0501194, -5.102441, -0.9000969, 0.785382]
Target sample: 109, Prediction:1, Target's Score:[-2.6839762, 10.643581, -2.761025, 0.22017056, -6.553392, 0.80218637, 5.2603655, -6.2736683, -1.7280298, 3.4101076]
Target sample: 115, Prediction:9, Target's Score:[-0.49673948, 6.2983117, -5.6381702, 0.36990383, -6.5422225, -1.6359551, 6.141197, -5.945146, -0.019467354, 7.8028507]
Current ATTACK acc on target samples: 20.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 01:12:36 Epoch 59, Val iteration 0, acc 88.800 (88.800)
2021-06-12 01:12:42 Epoch 59, Val iteration 19, acc 90.000 (89.360)
* Prec: 89.36000175476075
Per class accuracy =  [0.9268266  0.92043627 0.83972389 0.8215914  0.89446875 0.8245276
 0.93679863 0.89159738 0.92960341 0.94508017]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 6, 1, 8, 1, 8, 8, 1, 1, 1, 1, 1, 1, 6, 1, 6, 6, 6, 1, 6, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 1, 1, 6, 6, 6, 6, 8, 1, 1, 1, 1, 1, 1, 1, 9, 1, 6, 1, 1, 9, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1
ATTACK acc: 16.161616161616163
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 01:12:50, Val iteration 0, acc 96.200 (96.200)
2021-06-12 01:13:02, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-12 01:13:08, Epoch 0, Iteration 7, loss 1.175 (0.888), acc 63.462 (77.200)
2021-06-12 01:14:20, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.0615617, 13.152095, -4.3650727, 0.34988257, -2.5975852, -3.5430882, 2.3436236, -4.184648, -0.93932855, 0.89687616]
Target sample: 7, Prediction:0, Target's Score:[6.2360563, 1.232919, -4.017702, -0.76494, -2.3438644, -4.5554943, 3.8929589, -3.607048, 4.66213, -0.6871061]
Target sample: 13, Prediction:8, Target's Score:[1.3358538, 1.3660725, -4.4776278, -0.15807866, -1.340893, -1.6096016, 4.532629, -4.7632017, 7.459223, -2.2998853]
Target sample: 19, Prediction:6, Target's Score:[2.237496, 2.8384714, -4.434258, -1.0568085, -3.2028375, -3.3430197, 7.8138847, -2.7091796, -0.085003704, 2.0068064]
Target sample: 25, Prediction:1, Target's Score:[0.67911214, 8.450247, -2.219256, -3.2119102, -1.8077471, -2.3844142, 3.7239778, -3.7802958, 0.13997325, 0.46758533]
Target sample: 31, Prediction:6, Target's Score:[1.1597776, 6.6436357, -4.571758, -0.96588373, -2.0754108, -3.0003183, 7.798335, -4.275113, -0.30153146, -0.3579473]
Target sample: 37, Prediction:1, Target's Score:[0.5298753, 16.075666, -5.2164044, -3.3717434, -3.28595, -4.073312, 1.7934024, -3.8292358, 0.37490782, 1.0692811]
Target sample: 43, Prediction:1, Target's Score:[2.973903, 8.208091, -4.486575, -2.7872138, -2.865226, -3.8477297, 1.9509101, -3.8080971, 5.422098, -0.7077499]
Target sample: 49, Prediction:1, Target's Score:[0.13822101, 8.683082, -1.4466654, -1.1256716, -2.107544, -3.2751029, 5.922618, -3.8321915, -2.0626304, -0.8473627]
Target sample: 55, Prediction:1, Target's Score:[-0.015236683, 7.929189, -3.0919502, -1.3785273, -2.8395436, -2.1520905, 4.877548, -3.581641, -2.758629, 3.0797584]
Target sample: 61, Prediction:1, Target's Score:[1.6979887, 8.985947, -5.4718547, -1.4609597, -2.1619277, -3.7608755, 3.6349418, -3.9340367, 1.0455776, 1.4874817]
Target sample: 67, Prediction:1, Target's Score:[0.47872496, 8.117932, -5.3930044, -0.55266094, -2.6799722, -3.2973363, 1.4611608, -5.149462, 5.971627, 1.0969243]
Target sample: 73, Prediction:6, Target's Score:[3.3423917, 3.630335, -3.5078108, -0.50260293, -2.1742828, -1.9067323, 5.7619033, -2.2143576, -0.5577065, -1.8062845]
Target sample: 79, Prediction:1, Target's Score:[-0.033568747, 9.980476, -4.8288226, -2.4051828, -2.4483864, -2.476991, 5.9985113, -1.9661225, -2.190191, 0.43802142]
Target sample: 85, Prediction:1, Target's Score:[0.26596928, 10.818686, -4.929594, -0.046200313, -1.1811086, -3.16387, 2.5044248, -4.1168103, -0.44620898, 0.3475662]
Target sample: 91, Prediction:1, Target's Score:[-0.023935325, 7.706806, -2.384842, 0.61471915, -0.66052365, -3.171648, 4.0889378, -4.3356924, -1.1159449, -0.6733319]
Target sample: 97, Prediction:1, Target's Score:[-1.0960138, 13.116366, -4.1879425, 0.96389747, -0.9980443, -2.8052185, -0.05895245, -4.2556815, -0.8081101, 0.18851046]
Target sample: 103, Prediction:1, Target's Score:[1.7413654, 8.666604, -2.47822, -1.2090722, -2.7173226, -1.9837244, 4.477802, -3.774254, -0.9824643, -1.6839963]
Target sample: 109, Prediction:1, Target's Score:[-0.665064, 7.5944624, -3.7410026, -0.11416379, -2.2793233, -3.2143376, 3.8469458, -4.7149096, -2.5429485, 5.9030266]
Target sample: 115, Prediction:9, Target's Score:[4.152247, 1.9633372, -5.2470284, -0.52737963, -2.3376753, -5.167136, 5.093611, -4.8676505, 0.9867226, 6.0267525]
Current ATTACK acc on target samples: 15.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 01:15:30 Epoch 59, Val iteration 0, acc 90.800 (90.800)
2021-06-12 01:15:43 Epoch 59, Val iteration 19, acc 91.400 (91.660)
* Prec: 91.66000137329101
Per class accuracy =  [0.94343831 0.93208598 0.86812377 0.89129647 0.94024971 0.86439365
 0.95926539 0.8983048  0.95312358 0.9154122 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 6, 0, 8, 8, 8, 8, 8, 8, 1, 8, 3, 1, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 8, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 0, 0, 0, 1
ATTACK acc: 9.090909090909092
--------
------SUMMARY------
TIME ELAPSED (mins): 27
TARGET INDEX: 12
ResNet50 65.0 60.60606060606061 95.46000137329102 90.21000175476074
DPN92 5.0 11.11111111111111 95.50000267028808 93.26000175476074
MobileNetV2 20.0 16.161616161616163 91.22000160217286 89.36000175476075
GoogLeNet 15.0 9.090909090909092 95.41000213623047 91.66000137329101
True False False False True
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 142 images of target 14
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133, 139]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=14, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/14/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133, 139]
# Targets: 24, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-12 01:16:04 Iteration 0 	 Training Loss: 9.603e-01 	 Loss in Target Net: 1.079e+00	  
tensor(0.0008, device='cuda:0')
 2021-06-12 01:17:15 Iteration 50 	 Training Loss: 4.239e-01 	 Loss in Target Net: 4.179e-01	  
tensor(-0.0221, device='cuda:0')
 2021-06-12 01:18:28 Iteration 100 	 Training Loss: 3.824e-01 	 Loss in Target Net: 3.820e-01	  
tensor(-0.0591, device='cuda:0')
 2021-06-12 01:19:40 Iteration 150 	 Training Loss: 3.546e-01 	 Loss in Target Net: 3.750e-01	  
tensor(-0.0951, device='cuda:0')
 2021-06-12 01:20:52 Iteration 200 	 Training Loss: 3.439e-01 	 Loss in Target Net: 3.721e-01	  
tensor(-0.1196, device='cuda:0')
 2021-06-12 01:22:06 Iteration 250 	 Training Loss: 3.344e-01 	 Loss in Target Net: 3.719e-01	  
tensor(-0.1282, device='cuda:0')
 2021-06-12 01:23:18 Iteration 300 	 Training Loss: 3.321e-01 	 Loss in Target Net: 3.423e-01	  
tensor(-0.1360, device='cuda:0')
 2021-06-12 01:24:31 Iteration 350 	 Training Loss: 3.297e-01 	 Loss in Target Net: 3.475e-01	  
tensor(-0.1363, device='cuda:0')
 2021-06-12 01:25:43 Iteration 400 	 Training Loss: 3.309e-01 	 Loss in Target Net: 3.613e-01	  
tensor(-0.1328, device='cuda:0')
 2021-06-12 01:26:56 Iteration 450 	 Training Loss: 3.226e-01 	 Loss in Target Net: 3.226e-01	  
tensor(-0.1337, device='cuda:0')
 2021-06-12 01:28:10 Iteration 500 	 Training Loss: 3.263e-01 	 Loss in Target Net: 3.322e-01	  
tensor(-0.1309, device='cuda:0')
 2021-06-12 01:29:23 Iteration 550 	 Training Loss: 3.310e-01 	 Loss in Target Net: 3.198e-01	  
tensor(-0.1258, device='cuda:0')
 2021-06-12 01:30:36 Iteration 600 	 Training Loss: 3.324e-01 	 Loss in Target Net: 3.336e-01	  
tensor(-0.1232, device='cuda:0')
 2021-06-12 01:31:49 Iteration 650 	 Training Loss: 3.318e-01 	 Loss in Target Net: 3.520e-01	  
tensor(-0.1279, device='cuda:0')
 2021-06-12 01:33:06 Iteration 700 	 Training Loss: 3.344e-01 	 Loss in Target Net: 3.383e-01	  
tensor(-0.1282, device='cuda:0')
 2021-06-12 01:34:21 Iteration 750 	 Training Loss: 3.228e-01 	 Loss in Target Net: 3.221e-01	  
tensor(-0.1265, device='cuda:0')
 2021-06-12 01:35:33 Iteration 800 	 Training Loss: 3.246e-01 	 Loss in Target Net: 3.230e-01	  
tensor(-0.1256, device='cuda:0')
 2021-06-12 01:36:46 Iteration 850 	 Training Loss: 3.306e-01 	 Loss in Target Net: 3.197e-01	  
tensor(-0.1266, device='cuda:0')
 2021-06-12 01:37:58 Iteration 900 	 Training Loss: 3.301e-01 	 Loss in Target Net: 3.501e-01	  
tensor(-0.1241, device='cuda:0')
 2021-06-12 01:39:14 Iteration 950 	 Training Loss: 3.259e-01 	 Loss in Target Net: 3.123e-01	  
tensor(-0.1253, device='cuda:0')
 2021-06-12 01:40:26 Iteration 999 	 Training Loss: 3.238e-01 	 Loss in Target Net: 3.593e-01	  
tensor(-0.1275, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 01:40:32, Val iteration 0, acc 94.200 (94.200)
2021-06-12 01:40:42, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-12 01:40:47, Epoch 0, Iteration 7, loss 0.063 (0.318), acc 100.000 (91.600)
2021-06-12 01:41:47, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.2361283, -0.21692649, -2.1651793, -1.0126019, 0.67646927, -2.3181543, 4.8030562, -2.3213875, 4.056599, -0.3035137]
Target sample: 7, Prediction:6, Target's Score:[-1.0710253, -0.4965239, -2.5116715, -0.5757124, -0.2480868, -2.5750172, 6.616599, -2.6484196, 3.1781044, 0.30112725]
Target sample: 13, Prediction:6, Target's Score:[-0.5213039, -1.573707, -2.390328, -0.80994207, -0.12351525, -2.7567744, 6.104365, -2.609679, 4.854166, -0.209028]
Target sample: 19, Prediction:6, Target's Score:[-1.2181692, -1.7522527, -3.0721602, -0.48430896, -0.66055954, -2.679453, 7.3339505, -2.9786642, 5.2015653, 0.27093863]
Target sample: 25, Prediction:6, Target's Score:[-1.2630814, 0.93164885, -1.8323224, -1.2067859, -0.99327856, -2.7781224, 8.417079, -2.603352, -0.77390206, 2.0923097]
Target sample: 31, Prediction:6, Target's Score:[-2.0945168, 2.3397563, -1.3552939, -1.5476236, -1.350758, -2.9228942, 8.510655, -2.5823843, -1.5797957, 2.5821955]
Target sample: 37, Prediction:6, Target's Score:[-1.5479946, 1.1234056, -2.4860365, 0.90018845, -0.9309751, -1.9190352, 7.828344, -3.2758229, -0.6128266, 0.9074598]
Target sample: 43, Prediction:6, Target's Score:[-1.215425, 1.0524573, -1.7455832, 0.2735636, -0.5360645, -1.6512413, 6.3013268, -2.6642213, -0.11337989, 0.2879683]
Target sample: 49, Prediction:6, Target's Score:[-2.6840012, 2.88061, -2.8914735, -0.13546216, -1.139707, -2.6404586, 4.2626605, -3.1067803, 3.2252183, 2.200792]
Target sample: 55, Prediction:6, Target's Score:[-0.7526253, 3.700774, -2.0994563, -1.006415, -1.7045364, -2.190523, 6.25693, -2.733694, -1.1401083, 1.6630253]
Target sample: 61, Prediction:6, Target's Score:[-2.418375, 1.3135011, -1.2004551, -1.2130089, 0.68621963, -2.2985196, 6.1915936, -3.0061657, -1.5342889, 3.4599884]
Target sample: 67, Prediction:9, Target's Score:[-1.9173031, 2.4928916, -0.7601074, -1.6128197, -0.8333151, -2.979388, 4.7237196, -2.9180286, -1.7337672, 5.531883]
Target sample: 73, Prediction:6, Target's Score:[-2.3140852, 0.82948035, -1.7997559, -0.6683803, 0.3948893, -2.460381, 5.5946984, -2.6318994, 1.734115, 1.2941979]
Target sample: 79, Prediction:6, Target's Score:[-0.8218514, 0.5930936, -2.451743, -0.87451863, -0.714182, -2.6891506, 6.3754916, -2.2405453, 3.0362065, -0.2363418]
Target sample: 85, Prediction:6, Target's Score:[-0.76448065, 0.30886227, -2.8050556, -0.58794296, 0.8212848, -2.6572502, 5.87613, -2.2510633, 1.6418844, 0.38190597]
Target sample: 91, Prediction:6, Target's Score:[-1.7361907, 0.575929, -1.7446342, -1.3285393, -1.4365854, -2.7817729, 11.122027, -3.329134, -2.1942337, 2.85173]
Target sample: 97, Prediction:6, Target's Score:[-1.356218, 0.13742611, -2.2178617, -1.3902738, -1.1629739, -2.753057, 10.968325, -3.35544, -1.951293, 3.0707297]
Target sample: 103, Prediction:6, Target's Score:[-3.1137455, 0.49514446, -2.575308, 3.4079454, -0.16764542, -1.7577633, 5.4273033, -3.7274275, 1.7956293, 0.1944153]
Target sample: 109, Prediction:6, Target's Score:[-2.1141698, 0.5108496, -3.1159787, 0.9430589, -0.67750436, -1.7620957, 9.396303, -3.7954974, -0.13295634, 0.72531563]
Target sample: 115, Prediction:6, Target's Score:[-2.7962286, 3.0217497, -2.4325526, 2.7423081, -1.5221987, -0.64516973, 4.212885, -3.527178, -0.12362633, 1.0585483]
Target sample: 121, Prediction:6, Target's Score:[-1.6162889, 0.8537942, -2.2681453, -0.3642864, 0.07023764, -2.4013383, 7.1432576, -2.995396, -0.0133579075, 1.5691643]
Target sample: 127, Prediction:6, Target's Score:[-1.2671506, 1.3036206, -1.8877321, -1.8155426, -1.5578302, -3.1034133, 8.657983, -3.0344927, -1.934759, 4.630631]
Target sample: 133, Prediction:6, Target's Score:[-1.2449422, 1.8878821, -2.0245101, -0.38655955, 1.1656789, -1.8198994, 4.0720067, -2.0792964, 0.5390799, -0.13877985]
Target sample: 139, Prediction:6, Target's Score:[0.2974895, -1.8293005, -2.6955247, -1.2457925, -0.068771996, -2.9046557, 8.559305, -2.4268076, 1.7910596, 0.49596137]
Current ATTACK acc on target samples: 95.833
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 01:42:46 Epoch 59, Val iteration 0, acc 89.800 (89.800)
2021-06-12 01:42:56 Epoch 59, Val iteration 19, acc 90.800 (90.890)
* Prec: 90.89000205993652
Per class accuracy =  [0.93589173 0.93796255 0.84337444 0.83592029 0.91375521 0.89431493
 0.91872261 0.91048716 0.9508294  0.95267267]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 6, 6, 6, 8, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 9, 6, 6, 1, 6, 9, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 9, 6, 6, 6, 6, 6, 6, 6, 6, 8, 8, 6, 6, 6, 6, 6
ATTACK acc: 85.59322033898304
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 01:43:08, Val iteration 0, acc 94.800 (94.800)
2021-06-12 01:43:29, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-12 01:43:43, Epoch 0, Iteration 7, loss 0.682 (0.533), acc 82.692 (87.800)
2021-06-12 01:46:21, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:8, Target's Score:[0.95568275, 0.9143732, -4.4062743, -1.281211, -0.9709232, -4.383949, 4.183081, -1.684169, 5.6456094, 1.3321333]
Target sample: 7, Prediction:6, Target's Score:[-0.7803241, 1.406189, -2.7840075, -0.6712673, -1.6134397, -4.5216866, 8.138694, -3.3527732, 4.133341, 0.3427728]
Target sample: 13, Prediction:6, Target's Score:[-0.88295853, 2.9675386, -3.4017608, -0.83444464, -2.092361, -4.7834396, 6.1208014, -2.8032346, 5.5455947, 0.4585114]
Target sample: 19, Prediction:6, Target's Score:[-1.37953, 6.2469697, -4.120341, -1.1941085, -3.091805, -4.509048, 6.591813, -3.5031981, 3.2430315, 2.063412]
Target sample: 25, Prediction:6, Target's Score:[-0.37814522, 5.259882, -3.2789893, -0.4389488, -1.9287091, -5.362197, 6.5198746, -3.3814707, 3.295628, 0.039942347]
Target sample: 31, Prediction:1, Target's Score:[-1.4292606, 6.913875, -3.9124377, -0.10345409, -2.632169, -4.96573, 5.924078, -3.170147, 3.4364822, 0.29796198]
Target sample: 37, Prediction:6, Target's Score:[-1.5889001, 0.9213418, -1.5067611, 3.0428836, -0.2434257, -3.8367982, 8.937433, -2.6701047, -0.22835082, -2.5232399]
Target sample: 43, Prediction:6, Target's Score:[-2.349462, 0.25624165, -2.616528, 1.9730778, -1.0363861, -2.5624444, 5.0108504, -0.9003407, 1.9011316, 0.6026669]
Target sample: 49, Prediction:6, Target's Score:[-3.4431386, 0.6810746, -1.4275752, 3.1536715, -2.0486844, -2.5981982, 7.2732315, -1.9239267, 2.413368, -1.8034595]
Target sample: 55, Prediction:8, Target's Score:[0.21634121, 0.7702046, -2.9793177, -0.8849133, -2.3027494, -3.8734164, 3.3200572, -1.2826176, 5.133445, 2.1576195]
Target sample: 61, Prediction:6, Target's Score:[-2.301136, 3.6017904, -1.6641561, 3.3785272, -1.3072702, -4.4618635, 3.8139813, -3.0232534, 1.2046516, 1.0915197]
Target sample: 67, Prediction:1, Target's Score:[-0.016662179, 10.340767, -2.9521666, -0.057851404, -3.3799675, -5.010898, 4.637654, -3.5264695, 0.3730064, -0.004385991]
Target sample: 73, Prediction:6, Target's Score:[-1.0009408, 2.568304, -3.6143506, -0.48235112, -1.3664161, -4.5384173, 7.8062544, -3.350233, 3.2813692, 1.0180513]
Target sample: 79, Prediction:6, Target's Score:[-1.1558064, 3.294927, -3.638011, -0.9732397, -2.8212306, -4.179559, 7.4781775, -3.788688, 4.41268, 1.7027388]
Target sample: 85, Prediction:6, Target's Score:[0.30265817, 2.6189172, -3.4436905, -1.8285694, -2.5924356, -5.494675, 6.6805687, -3.7250807, 4.343985, 3.4683437]
Target sample: 91, Prediction:1, Target's Score:[-0.93238044, 9.36993, -3.4001222, 0.523944, -2.7858384, -4.791796, 6.715176, -3.7978172, 0.11154308, -0.60356534]
Target sample: 97, Prediction:6, Target's Score:[-1.9533083, 3.7347703, -3.1077697, 1.1121361, -1.893152, -4.035039, 9.011853, -3.3609893, 1.1687222, -0.34382787]
Target sample: 103, Prediction:6, Target's Score:[-2.8985786, -1.1491716, -0.007236289, 3.309276, -0.17744145, -3.572431, 11.1514, -3.8180766, -0.29991722, -2.236034]
Target sample: 109, Prediction:6, Target's Score:[-2.634511, -1.2221316, -1.4150001, 0.59178466, -0.30598056, -2.2258828, 15.117465, -4.1349993, -0.78178006, -2.6870594]
Target sample: 115, Prediction:3, Target's Score:[-2.8474832, -2.0918887, -0.9551291, 5.5043235, 4.5680184, -2.3225086, 2.7915945, -2.1156108, -0.12214733, -2.0691]
Target sample: 121, Prediction:6, Target's Score:[-0.842194, 3.8784666, -3.234463, -0.22346103, -2.34765, -3.6401725, 6.456279, -3.7050676, 2.0013506, 1.9880363]
Target sample: 127, Prediction:6, Target's Score:[-1.238664, 6.9520497, -3.3130503, 0.29841447, -3.1200972, -4.675035, 7.2525816, -3.4845812, 1.101154, 0.5996412]
Target sample: 133, Prediction:6, Target's Score:[0.37096113, 3.4862192, -3.8361955, -0.59535897, -2.1633902, -3.8963356, 5.8918376, -2.1303728, 2.4000819, 0.78466266]
Target sample: 139, Prediction:6, Target's Score:[-0.14006847, 1.7040662, -3.405061, -1.5416789, -1.7664875, -4.861251, 6.690644, -3.2373002, 4.031728, 2.8184798]
Current ATTACK acc on target samples: 75.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 01:48:55 Epoch 59, Val iteration 0, acc 92.200 (92.200)
2021-06-12 01:49:16 Epoch 59, Val iteration 19, acc 93.000 (93.070)
* Prec: 93.07000198364258
Per class accuracy =  [0.9529087  0.94436277 0.92530801 0.82722215 0.95096665 0.87916578
 0.94387426 0.95789849 0.96539342 0.95662486]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 6, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 9, 6, 6, 9, 9, 9, 3, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 8, 6, 6, 8, 6, 1, 6, 6, 6, 6, 6, 6, 1, 1, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 6, 6, 6, 6, 6, 6, 8, 8, 6, 6, 6, 8, 8
ATTACK acc: 70.33898305084746
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 01:49:20, Val iteration 0, acc 92.600 (92.600)
2021-06-12 01:49:26, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-12 01:49:28, Epoch 0, Iteration 7, loss 0.119 (0.314), acc 96.154 (90.200)
2021-06-12 01:49:56, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:9, Target's Score:[-0.83426714, 2.6772294, -4.620635, 4.393952, -0.35130033, -3.572962, 0.65295285, -2.368892, -2.6934762, 7.0923257]
Target sample: 7, Prediction:9, Target's Score:[0.067137584, 2.073307, -2.0060902, 2.6995835, 1.1417744, -4.5007873, -0.047291957, -1.9734203, -4.373372, 7.334725]
Target sample: 13, Prediction:9, Target's Score:[-0.17946596, 1.2684228, -3.1833668, 3.493045, 0.1850162, -3.2086532, 1.6384113, -0.96153295, -5.518544, 6.8387213]
Target sample: 19, Prediction:9, Target's Score:[-0.30464798, 1.9715103, -3.8535166, 1.7525315, 0.61563665, -4.228462, 3.0460773, -1.5100696, -4.4423184, 7.327791]
Target sample: 25, Prediction:3, Target's Score:[-0.26526865, 3.2345605, -4.306502, 4.2371683, 0.898399, -1.9057996, 3.879741, -2.6537595, -5.8437247, 3.0639858]
Target sample: 31, Prediction:1, Target's Score:[-1.6757009, 10.2190695, -4.608277, 3.3150113, -2.625655, -2.112472, 3.3915706, -3.3410978, -5.926935, 3.7739952]
Target sample: 37, Prediction:9, Target's Score:[-0.30314046, 6.335575, -3.8269763, 1.6896033, -2.0763097, -2.0672462, 2.2201092, -3.6868951, -6.1996293, 8.327284]
Target sample: 43, Prediction:1, Target's Score:[-0.5135247, 3.8859851, -1.5899113, 3.2299726, 0.86604565, -1.6154249, -1.606813, 3.2194638, -4.133434, -1.3805435]
Target sample: 49, Prediction:3, Target's Score:[-4.2321234, 3.4598348, -5.0053926, 6.047219, -3.9981048, 0.36174035, 1.5953827, -2.548056, 4.0866127, 0.49596006]
Target sample: 55, Prediction:1, Target's Score:[2.1936536, 5.3200717, -4.6928387, 0.3863843, -2.5874317, -1.5203922, 0.77824795, -0.45947117, -1.5395489, 2.4020345]
Target sample: 61, Prediction:3, Target's Score:[-0.45627412, 3.0534976, 0.48385626, 3.1824534, 2.824548, -2.1223252, -0.70902944, 0.17381024, -4.4059763, -1.658242]
Target sample: 67, Prediction:1, Target's Score:[0.19767323, 7.487694, -2.9826252, 0.6307804, 0.2859702, -4.305186, 0.25472763, -1.1038675, -5.4295, 5.407476]
Target sample: 73, Prediction:9, Target's Score:[2.191008, 2.1896372, -2.1857405, 1.8471105, 2.2774537, -4.805994, 1.9478806, -2.3707187, -5.202935, 4.5093403]
Target sample: 79, Prediction:9, Target's Score:[0.19558209, 4.6958585, -4.235981, 1.6795522, -1.3675194, -3.9468234, 4.2314644, -3.2307901, -3.5649738, 5.881256]
Target sample: 85, Prediction:9, Target's Score:[-2.0901678, 0.56249326, -3.9434447, 3.1515474, 0.117554456, -3.7954772, 6.2817855, -3.085638, -4.214742, 7.359421]
Target sample: 91, Prediction:1, Target's Score:[2.2842653, 9.695431, -1.5665075, 3.7864141, -2.5071285, -3.2015967, 1.0867898, -5.459597, -5.2644057, 1.539179]
Target sample: 97, Prediction:6, Target's Score:[-2.5792408, 3.6246178, -5.167465, 4.1998277, 0.34177777, -1.3572801, 9.039681, -4.707066, -5.1276383, 2.0698748]
Target sample: 103, Prediction:1, Target's Score:[-2.8114786, 6.2212057, -3.7810757, 5.87046, -2.4067905, -1.3518198, 3.1005347, -3.7387917, -2.0637155, 1.299188]
Target sample: 109, Prediction:6, Target's Score:[-3.2482018, 5.158129, -5.4560146, 5.736536, -5.8696647, 3.1027884, 8.360808, -7.0076737, -0.3725263, -0.14948216]
Target sample: 115, Prediction:1, Target's Score:[0.5536801, 5.469539, -1.6597346, 2.4451823, -1.4099004, -1.3121717, 2.7478163, -2.546787, -4.979656, 1.0213456]
Target sample: 121, Prediction:1, Target's Score:[0.599105, 3.5812128, -3.268797, 2.4133456, 2.407064, -0.24391395, -0.92866117, 0.65004265, -2.655233, -2.2294602]
Target sample: 127, Prediction:1, Target's Score:[-0.459407, 6.384733, -5.7507505, 3.6316292, -2.1109905, -1.0741196, 3.9343166, -3.8594337, -5.5911865, 5.2527776]
Target sample: 133, Prediction:1, Target's Score:[-1.6895899, 5.198842, -3.031733, 2.9400096, 1.9279683, -4.0906124, 0.63279015, -0.22247964, -6.341931, 5.153145]
Target sample: 139, Prediction:9, Target's Score:[1.7440922, 0.8173335, -1.4115567, 2.2239509, 1.4419191, -4.2637134, 0.047689926, -1.0267286, -4.299882, 5.0784764]
Current ATTACK acc on target samples: 8.333
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 01:50:23 Epoch 59, Val iteration 0, acc 90.400 (90.400)
2021-06-12 01:50:29 Epoch 59, Val iteration 19, acc 90.000 (89.550)
* Prec: 89.55000152587891
Per class accuracy =  [0.9218571  0.93126871 0.84342628 0.82593255 0.8912121  0.8273204
 0.94053474 0.89093946 0.93391428 0.94410946]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 1, 9, 9, 9, 3, 9, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 9, 9, 3, 1, 3, 1, 1, 3, 3, 3, 1, 1, 1, 1, 3, 9, 3, 3, 9, 1, 3, 9, 9, 9, 9, 1, 6, 9, 9, 9, 9, 1, 6, 9, 9, 1, 9, 6, 6, 6, 1, 9, 1, 1, 1, 1, 6, 6, 3, 1, 6, 6, 1, 6, 1, 6, 6, 6, 6, 1, 6, 1, 1, 6, 6, 6, 3, 3, 1, 6, 9, 1, 1, 1, 9, 1, 1, 9, 9, 9, 9, 9, 9, 9, 9, 9
ATTACK acc: 16.10169491525424
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 01:50:37, Val iteration 0, acc 96.200 (96.200)
2021-06-12 01:50:49, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-12 01:50:56, Epoch 0, Iteration 7, loss 0.856 (0.867), acc 73.077 (77.600)
2021-06-12 01:52:07, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[3.3915994, 0.6364043, -2.952992, 0.999633, -2.9243317, -3.8031156, 3.772214, -1.3253641, 1.7338142, 0.49724254]
Target sample: 7, Prediction:6, Target's Score:[-1.2510473, 2.096426, -2.701626, 1.5726511, -3.3157816, -3.5937464, 6.339118, -0.9005429, 2.5715992, -0.80817693]
Target sample: 13, Prediction:6, Target's Score:[2.3788218, -0.47178352, -2.667998, 2.5201519, -2.9436982, -3.6903934, 5.0080867, -0.5629105, 1.8487893, -1.3899909]
Target sample: 19, Prediction:6, Target's Score:[-0.061029598, 1.5159771, -3.1601758, 2.248013, -3.2665727, -3.6321628, 5.535905, -0.50360906, 2.544668, -1.2032194]
Target sample: 25, Prediction:6, Target's Score:[0.60866666, -0.22162604, -0.6285299, 1.51292, -1.5556619, -3.8922532, 5.483644, -2.3800395, 2.8483746, -1.7655517]
Target sample: 31, Prediction:6, Target's Score:[-0.9188924, 3.9320936, -1.3998126, 1.4236807, -2.2448835, -3.4886498, 7.8557215, -2.274367, -1.7498127, -1.1283871]
Target sample: 37, Prediction:6, Target's Score:[0.41830072, 2.5400834, -1.6477172, 3.8592515, -2.7625418, -2.4162984, 4.258623, -3.2184908, -0.8628824, -0.14269227]
Target sample: 43, Prediction:6, Target's Score:[-3.230719, 3.5154376, -1.995531, 2.511352, -2.6026285, -2.7571545, 6.6067986, -1.2171308, 1.2505288, -2.079775]
Target sample: 49, Prediction:1, Target's Score:[-4.6453886, 6.4198008, -2.5132823, 3.3883362, -1.9201518, -3.9556055, 5.2505164, -2.9965923, 2.4549887, -1.4904987]
Target sample: 55, Prediction:3, Target's Score:[-1.2949235, 3.7887058, -0.9465426, 4.509804, -3.2497313, -2.3862336, 2.5422697, -2.1600235, -0.4384125, -0.35117546]
Target sample: 61, Prediction:6, Target's Score:[-3.3989341, 4.4789524, -2.3039012, 4.5308104, -1.4799863, -3.7318437, 4.9792595, -2.156609, 0.14319395, -1.0539652]
Target sample: 67, Prediction:8, Target's Score:[-2.0953035, 2.907109, -1.2647495, 2.9160175, -3.091385, -4.239885, 3.947806, -1.9006897, 3.9737122, -1.1518118]
Target sample: 73, Prediction:6, Target's Score:[0.7443657, 0.55858743, -2.7410645, 0.8424534, -0.24305347, -4.370026, 5.1305513, -0.8438266, 2.3564036, -1.4265372]
Target sample: 79, Prediction:6, Target's Score:[-1.9602482, 3.6255527, -2.310795, 2.094392, -3.1877, -3.3731184, 6.399995, -1.7639289, -1.1351206, 1.6288891]
Target sample: 85, Prediction:6, Target's Score:[-2.4959483, 1.7118059, -2.9326043, 2.215669, -3.6188917, -3.178028, 5.358078, -2.2062624, 4.056702, 1.1013709]
Target sample: 91, Prediction:6, Target's Score:[-1.4063984, 2.7216234, -1.0305626, 3.2171032, -2.4159234, -1.8387942, 7.100675, -2.3167021, -2.5025973, -1.5126634]
Target sample: 97, Prediction:6, Target's Score:[-0.19697346, 1.5272013, -3.1974425, 1.1892712, -1.6706489, -2.9689176, 9.413546, -1.0949115, -1.3305142, -1.652391]
Target sample: 103, Prediction:6, Target's Score:[-2.0086129, 5.9662786, -2.5294628, 2.7341957, -1.0918814, -3.3743556, 6.908853, -3.1131353, -1.5362477, -1.9528629]
Target sample: 109, Prediction:6, Target's Score:[-2.8200514, 2.0559134, -1.3411461, 1.6727144, -2.4503903, -1.5117847, 10.518043, -3.074432, 0.21572064, -3.262961]
Target sample: 115, Prediction:3, Target's Score:[-1.3582057, 0.9729446, -1.9099386, 8.267948, -1.6347628, -1.8001566, 2.4096234, -2.6793091, -0.32501566, -1.905923]
Target sample: 121, Prediction:6, Target's Score:[-1.5717074, 0.673755, -2.5873532, 4.3673844, -3.0260491, -0.71924764, 6.254769, -1.6844704, -0.45791996, -1.2235612]
Target sample: 127, Prediction:6, Target's Score:[-0.40800607, 1.2311429, -3.6434896, 0.72849643, -2.7969801, -3.5836613, 8.168221, 1.1693214, 0.7025171, -1.5539333]
Target sample: 133, Prediction:6, Target's Score:[1.9572067, 0.8685796, -2.4427533, 3.764584, -2.435058, -4.018196, 3.7746704, 0.5819341, -1.0057569, -1.0117667]
Target sample: 139, Prediction:0, Target's Score:[4.0807123, -0.25140172, -2.7960563, 2.3725708, -3.166483, -3.2271817, 2.927627, -1.6569967, 1.171391, 0.5822779]
Current ATTACK acc on target samples: 79.167
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 01:53:16 Epoch 59, Val iteration 0, acc 93.600 (93.600)
2021-06-12 01:53:29 Epoch 59, Val iteration 19, acc 91.800 (92.030)
* Prec: 92.03000183105469
Per class accuracy =  [0.95688939 0.95098445 0.88963743 0.78950085 0.95342864 0.87863547
 0.94459057 0.94399537 0.94653136 0.94887548]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 0, 6, 6, 0, 6, 6, 6, 6, 6, 6, 6, 0, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 1, 6, 6, 3, 1, 6, 6, 6, 6, 3, 6, 6, 1, 1, 1, 6, 1, 6, 3, 1, 1, 3, 9, 6, 6, 9, 6, 6, 3, 6, 1, 6, 6, 6, 6, 8, 6, 8, 8, 6, 6, 0, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 3, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 0, 6, 6, 6, 0, 6, 0
ATTACK acc: 75.42372881355932
--------
------SUMMARY------
TIME ELAPSED (mins): 24
TARGET INDEX: 14
ResNet50 95.83333333333333 85.59322033898304 95.46000137329102 90.89000205993652
DPN92 75.0 70.33898305084746 95.50000267028808 93.07000198364258
MobileNetV2 8.333333333333334 16.10169491525424 91.22000160217286 89.55000152587891
GoogLeNet 79.16666666666667 75.42372881355932 95.41000213623047 92.03000183105469
True False False False True
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 92 images of target 15
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=15, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/15/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
# Targets: 16, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-12 01:53:49 Iteration 0 	 Training Loss: 8.987e-01 	 Loss in Target Net: 1.045e+00	  
tensor(0.0001, device='cuda:0')
 2021-06-12 01:55:02 Iteration 50 	 Training Loss: 3.931e-01 	 Loss in Target Net: 3.094e-01	  
tensor(-0.0446, device='cuda:0')
 2021-06-12 01:56:14 Iteration 100 	 Training Loss: 3.658e-01 	 Loss in Target Net: 2.966e-01	  
tensor(-0.0644, device='cuda:0')
 2021-06-12 01:57:25 Iteration 150 	 Training Loss: 3.660e-01 	 Loss in Target Net: 2.829e-01	  
tensor(-0.0652, device='cuda:0')
 2021-06-12 01:58:36 Iteration 200 	 Training Loss: 3.616e-01 	 Loss in Target Net: 2.843e-01	  
tensor(-0.0638, device='cuda:0')
 2021-06-12 01:59:47 Iteration 250 	 Training Loss: 3.644e-01 	 Loss in Target Net: 2.801e-01	  
tensor(-0.0612, device='cuda:0')
 2021-06-12 02:00:57 Iteration 300 	 Training Loss: 3.618e-01 	 Loss in Target Net: 2.883e-01	  
tensor(-0.0605, device='cuda:0')
 2021-06-12 02:02:08 Iteration 350 	 Training Loss: 3.610e-01 	 Loss in Target Net: 2.803e-01	  
tensor(-0.0601, device='cuda:0')
 2021-06-12 02:03:20 Iteration 400 	 Training Loss: 3.580e-01 	 Loss in Target Net: 2.857e-01	  
tensor(-0.0590, device='cuda:0')
 2021-06-12 02:04:32 Iteration 450 	 Training Loss: 3.621e-01 	 Loss in Target Net: 2.918e-01	  
tensor(-0.0587, device='cuda:0')
 2021-06-12 02:05:42 Iteration 500 	 Training Loss: 3.634e-01 	 Loss in Target Net: 2.999e-01	  
tensor(-0.0592, device='cuda:0')
 2021-06-12 02:06:53 Iteration 550 	 Training Loss: 3.632e-01 	 Loss in Target Net: 2.969e-01	  
tensor(-0.0581, device='cuda:0')
 2021-06-12 02:08:04 Iteration 600 	 Training Loss: 3.628e-01 	 Loss in Target Net: 2.917e-01	  
tensor(-0.0581, device='cuda:0')
 2021-06-12 02:09:19 Iteration 650 	 Training Loss: 3.619e-01 	 Loss in Target Net: 2.865e-01	  
tensor(-0.0582, device='cuda:0')
 2021-06-12 02:10:31 Iteration 700 	 Training Loss: 3.610e-01 	 Loss in Target Net: 2.962e-01	  
tensor(-0.0560, device='cuda:0')
 2021-06-12 02:11:42 Iteration 750 	 Training Loss: 3.612e-01 	 Loss in Target Net: 3.065e-01	  
tensor(-0.0562, device='cuda:0')
 2021-06-12 02:12:55 Iteration 800 	 Training Loss: 3.607e-01 	 Loss in Target Net: 2.986e-01	  
tensor(-0.0565, device='cuda:0')
 2021-06-12 02:14:06 Iteration 850 	 Training Loss: 3.594e-01 	 Loss in Target Net: 2.875e-01	  
tensor(-0.0573, device='cuda:0')
 2021-06-12 02:15:16 Iteration 900 	 Training Loss: 3.598e-01 	 Loss in Target Net: 2.917e-01	  
tensor(-0.0582, device='cuda:0')
 2021-06-12 02:16:25 Iteration 950 	 Training Loss: 3.592e-01 	 Loss in Target Net: 2.931e-01	  
tensor(-0.0570, device='cuda:0')
 2021-06-12 02:17:36 Iteration 999 	 Training Loss: 3.616e-01 	 Loss in Target Net: 2.904e-01	  
tensor(-0.0579, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 02:17:41, Val iteration 0, acc 94.200 (94.200)
2021-06-12 02:17:51, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-12 02:17:56, Epoch 0, Iteration 7, loss 0.394 (0.491), acc 90.385 (90.800)
2021-06-12 02:18:56, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.5665165, 4.662024, -1.1702555, -1.4611646, -2.3854542, -2.3929381, 7.19824, -2.578957, -1.0883968, 0.79156375]
Target sample: 7, Prediction:1, Target's Score:[-1.1677463, 7.172569, -1.1580337, -0.6414629, -2.5329635, -1.3652661, 3.8383546, -2.634039, -2.1469727, 0.5619265]
Target sample: 13, Prediction:1, Target's Score:[-2.5714638, 10.002527, -1.3229411, -0.6642549, -3.111127, -1.0903748, 2.4346297, -1.7743866, -3.1063817, 1.0681332]
Target sample: 19, Prediction:1, Target's Score:[-2.2201185, 8.577375, -1.9796844, -0.67831993, -2.7449925, -1.9378177, 2.4378304, -2.5245163, -1.1956731, 2.1466439]
Target sample: 25, Prediction:8, Target's Score:[1.0597806, -0.10579138, -1.2029487, -1.2250292, -1.8624579, -1.8070179, 2.3348649, -2.0892284, 3.8176622, 1.0198121]
Target sample: 31, Prediction:1, Target's Score:[0.15101133, 5.5186963, -0.74585783, 1.3054773, -2.7191124, 0.10620891, 0.55183125, -1.9478313, -2.4476464, 0.10460667]
Target sample: 37, Prediction:1, Target's Score:[-1.331637, 6.518268, -1.1322864, 0.69475955, -2.5663981, -0.7083118, 0.82149434, -2.6459064, -1.9601473, 2.181169]
Target sample: 43, Prediction:1, Target's Score:[-3.2760608, 11.900675, -1.7736375, -0.7526389, -3.0417573, -2.4574246, 3.444742, -2.916268, -2.5776732, 1.3077127]
Target sample: 49, Prediction:1, Target's Score:[-2.0717454, 8.820657, -1.2367445, 0.27668753, -2.5998302, -1.7646434, 1.9400245, -2.7762353, -1.8741736, 1.1614298]
Target sample: 55, Prediction:5, Target's Score:[-0.0494667, 3.3821647, -1.6387583, 1.8475788, -3.2029643, 3.9496715, 0.28581643, -1.9082623, -2.5332537, -0.2351061]
Target sample: 61, Prediction:1, Target's Score:[-2.068142, 7.706508, -1.483031, 0.32086593, -2.694002, -1.2070837, 2.5758777, -2.7083929, -2.092487, 1.5481026]
Target sample: 67, Prediction:1, Target's Score:[-0.6978231, 6.7527947, -2.0356467, 0.3694019, -2.654406, -1.2437023, 0.7459291, -2.431031, -1.4233576, 2.486009]
Target sample: 73, Prediction:1, Target's Score:[0.1985782, 5.2809515, -0.11244947, 1.3306333, -2.40678, -0.9996259, 0.29215774, -2.5716925, -2.5101237, 1.3572651]
Target sample: 79, Prediction:1, Target's Score:[-2.1748602, 5.8277025, -1.7932129, -0.34078896, -2.5908723, -0.69176805, 2.8755484, -2.7887175, -2.4774215, 4.0661254]
Target sample: 85, Prediction:6, Target's Score:[-1.8442084, 5.311364, -1.1949186, -0.77640504, -2.337204, -2.1563072, 6.761794, -2.7458007, -1.6166986, 0.59506404]
Target sample: 91, Prediction:1, Target's Score:[-1.2846217, 6.423656, -1.1345224, -0.6289909, -2.3521764, -1.8585424, 5.091438, -2.6643298, -1.9647262, 0.32895094]
Current ATTACK acc on target samples: 12.500
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 02:19:55 Epoch 59, Val iteration 0, acc 88.000 (88.000)
2021-06-12 02:20:05 Epoch 59, Val iteration 19, acc 88.600 (88.910)
* Prec: 88.91000099182129
Per class accuracy =  [0.93241976 0.91077319 0.8805672  0.79455328 0.86771526 0.84581761
 0.9201688  0.89422507 0.93962448 0.90130809]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 8, 1, 1, 1, 1, 0, 3, 5, 5, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 6, 1, 1, 6, 6, 1, 6, 1, 1, 1, 1
ATTACK acc: 9.210526315789474
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 02:20:17, Val iteration 0, acc 94.800 (94.800)
2021-06-12 02:20:38, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-12 02:20:52, Epoch 0, Iteration 7, loss 0.155 (0.513), acc 94.231 (87.800)
2021-06-12 02:23:30, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.4852246, 3.970137, -3.8607051, -0.65812427, -2.496955, -1.1562107, 9.392388, -1.6201675, -1.9560664, 0.3343016]
Target sample: 7, Prediction:6, Target's Score:[-1.2650589, 4.441061, -4.5088124, -0.37476048, -2.2908864, -1.6299459, 7.886513, -1.7412053, -1.6234937, 1.5630862]
Target sample: 13, Prediction:1, Target's Score:[-1.1613503, 10.629951, -5.061905, -1.3245097, -3.1598237, -2.506744, 4.058347, -0.7357735, -1.7369055, 1.6222384]
Target sample: 19, Prediction:1, Target's Score:[-1.9987212, 8.136713, -3.831285, 0.010258954, -3.2640047, -2.5056946, 5.190982, -0.8733405, -1.3326949, 1.0341909]
Target sample: 25, Prediction:1, Target's Score:[-0.69727916, 5.991615, -4.592011, 1.1769629, -3.697466, -3.384295, 4.748476, -0.106286824, -0.4582115, 1.5394661]
Target sample: 31, Prediction:1, Target's Score:[-0.3524592, 7.063038, -4.068942, 0.8689038, -3.7600443, -2.5125806, 4.178042, 0.7612881, -1.2451962, -0.38824123]
Target sample: 37, Prediction:1, Target's Score:[-1.7442199, 6.231534, -4.223165, -0.42591006, -2.313173, -1.2540125, 4.7175484, -0.05461234, -1.216523, 0.76295465]
Target sample: 43, Prediction:1, Target's Score:[-1.2359545, 7.41272, -4.90076, -0.7415577, -2.8988202, -1.7405177, 5.81942, -0.72216785, -0.6934789, 0.24061255]
Target sample: 49, Prediction:6, Target's Score:[-1.1478477, 2.6045525, -4.1674066, 0.53982514, -1.618957, -1.7597873, 7.483649, -1.1926272, -0.40948635, 0.064201675]
Target sample: 55, Prediction:1, Target's Score:[-0.78542095, 5.846646, -4.144581, 2.3667307, -3.061255, -2.5719721, 2.3573422, 0.5321357, -1.9069347, 1.8940203]
Target sample: 61, Prediction:1, Target's Score:[-1.3899986, 8.982347, -3.8931057, 0.8976354, -3.2293105, -3.0385478, 3.6662457, -0.39047265, -1.0451984, 0.034926906]
Target sample: 67, Prediction:1, Target's Score:[-0.6167806, 10.525469, -4.998676, -0.05625279, -3.0198371, -3.1477754, 0.91237354, -0.5607008, -0.43040657, 2.008448]
Target sample: 73, Prediction:1, Target's Score:[-0.83443207, 7.132676, -4.31251, 1.0373336, -3.0531924, -3.2178793, 1.2538648, 0.5502055, -0.61659896, 2.5879662]
Target sample: 79, Prediction:1, Target's Score:[-2.3704782, 8.876047, -4.8058953, -0.30727354, -2.8139925, -1.8701565, 4.351695, -1.4984528, -3.1331158, 4.159835]
Target sample: 85, Prediction:6, Target's Score:[-1.4501086, 4.816437, -4.1909666, -0.9191494, -2.5100694, -1.1123121, 9.4769, -1.5889337, -2.159561, 0.13359347]
Target sample: 91, Prediction:6, Target's Score:[-1.5715536, 2.4139292, -3.594163, 0.29896474, -1.7453794, -1.9421501, 10.071268, -1.9775275, -1.6482695, 0.10792248]
Current ATTACK acc on target samples: 31.250
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 02:26:04 Epoch 59, Val iteration 0, acc 93.800 (93.800)
2021-06-12 02:26:25 Epoch 59, Val iteration 19, acc 94.400 (93.610)
* Prec: 93.61000175476075
Per class accuracy =  [0.95717159 0.96676072 0.91905165 0.87260714 0.95511031 0.87400414
 0.95214887 0.95902019 0.95657608 0.94897432]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 23.68421052631579
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 02:26:29, Val iteration 0, acc 92.600 (92.600)
2021-06-12 02:26:34, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-12 02:26:37, Epoch 0, Iteration 7, loss 0.577 (0.379), acc 84.615 (89.800)
2021-06-12 02:27:04, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.0272067, 7.28617, -2.736336, -0.7801658, -5.1412115, -1.5752319, 9.533394, -4.422877, 0.77063715, -0.6726001]
Target sample: 7, Prediction:1, Target's Score:[-2.5308716, 9.400724, -3.4799325, 0.60177076, -3.259638, -1.3843676, 4.5040407, -4.6952996, 0.3484346, 0.74907255]
Target sample: 13, Prediction:1, Target's Score:[-2.4862056, 9.618858, -3.9196856, 1.8730494, -4.0374565, 0.87028474, 4.148461, -4.422819, -2.678912, 1.290982]
Target sample: 19, Prediction:1, Target's Score:[-3.8287153, 7.7143774, -4.4983425, 0.7107661, -4.128672, 0.79963017, 6.1109066, -5.1206503, 1.2361716, 1.282692]
Target sample: 25, Prediction:8, Target's Score:[-3.2290525, 3.8039205, -2.3958466, 2.1053624, -4.9792933, -1.5372423, 3.9119406, -3.6567366, 5.014915, 1.2165687]
Target sample: 31, Prediction:1, Target's Score:[-1.3436183, 10.054226, -2.355801, 2.522311, -4.6461926, -0.3122009, -1.1596999, 0.11771058, -0.9801684, -1.6134483]
Target sample: 37, Prediction:1, Target's Score:[-2.640248, 8.949842, -3.161702, 2.6704261, -4.5135255, -1.0813056, 5.3448467, -5.16394, 0.3791543, -0.5155831]
Target sample: 43, Prediction:1, Target's Score:[-3.8108497, 12.025555, -2.7465396, -0.3242427, -4.4581146, -0.14765729, 5.311031, -4.907948, 0.07716703, -0.7369994]
Target sample: 49, Prediction:1, Target's Score:[-2.6411247, 8.336615, -4.699962, 2.069939, -0.87288725, -2.2778673, 3.7901547, -3.2255957, -0.025180481, -0.18241572]
Target sample: 55, Prediction:1, Target's Score:[2.4653015, 6.871794, -5.4703817, 6.473471, -2.1012523, -0.21284376, -1.4955343, -3.4713748, -3.139975, 0.3537218]
Target sample: 61, Prediction:1, Target's Score:[-2.9192624, 13.097483, -3.175955, -0.07014902, -5.7814174, -0.6664543, 3.9017982, -3.9608073, -1.0721413, 0.9222027]
Target sample: 67, Prediction:1, Target's Score:[-2.8570251, 10.6700535, -5.0349374, 1.1644486, -3.4961045, -2.0227392, 3.0517538, -2.3748264, -0.755058, 1.9228718]
Target sample: 73, Prediction:1, Target's Score:[-3.4135995, 10.342899, -3.6438081, 1.8593383, -3.847187, -0.6822031, 0.6237448, -1.933228, 0.6887841, 0.28827903]
Target sample: 79, Prediction:6, Target's Score:[-2.649621, 5.7576957, -2.8347833, 4.5108953, -3.7192485, -0.89690423, 6.1034284, -5.7347264, -3.582862, 3.3188353]
Target sample: 85, Prediction:6, Target's Score:[-2.108843, 6.472467, -2.6655889, -0.20149912, -4.763234, -1.6131631, 10.135594, -5.2022634, 1.3994921, -1.2117802]
Target sample: 91, Prediction:1, Target's Score:[-2.7429683, 9.995977, -3.299081, 0.56659395, -4.449633, -2.1580286, 7.6271434, -5.3144174, 0.27912214, -0.23259692]
Current ATTACK acc on target samples: 18.750
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 02:27:32 Epoch 59, Val iteration 0, acc 89.400 (89.400)
2021-06-12 02:27:38 Epoch 59, Val iteration 19, acc 90.200 (89.370)
* Prec: 89.37000198364258
Per class accuracy =  [0.92170028 0.91996581 0.84540498 0.83024252 0.88887749 0.81914872
 0.93874424 0.89142005 0.93493923 0.94256443]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 1, 1, 6, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 6, 6, 1, 1, 6, 1, 1, 1, 6, 1, 1, 1, 1, 3, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1
ATTACK acc: 15.789473684210526
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 02:27:45, Val iteration 0, acc 96.200 (96.200)
2021-06-12 02:27:57, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-12 02:28:04, Epoch 0, Iteration 7, loss 0.470 (0.737), acc 88.462 (81.800)
2021-06-12 02:29:15, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-3.9747868, 10.225817, -3.035918, -2.318983, -4.75732, -1.8127611, 8.189674, -3.4087987, 2.1740727, -1.2536863]
Target sample: 7, Prediction:1, Target's Score:[-4.567199, 10.62362, -3.784498, -4.6065054, -4.4035606, 0.9004585, 9.515033, -3.1751115, 0.05809078, -0.51912403]
Target sample: 13, Prediction:1, Target's Score:[-2.8309283, 8.520509, -3.74083, -4.0405574, -3.4672189, 2.6966345, 6.7251706, -2.3604918, -2.276434, 0.82094026]
Target sample: 19, Prediction:1, Target's Score:[-2.4206393, 8.479146, -2.0638955, -1.4543517, -4.236354, -0.39478627, 5.893242, -2.3751378, -2.0497866, 0.65455234]
Target sample: 25, Prediction:6, Target's Score:[1.9001888, -0.33442897, 0.010502619, -1.3592076, -2.8026004, -2.4667873, 6.6250715, -2.467871, 1.9751086, -1.048381]
Target sample: 31, Prediction:6, Target's Score:[0.45892948, 2.325745, -1.5580525, 1.4559598, -3.4569817, -0.39482686, 3.8556597, -1.7222667, -0.16565391, -0.7718478]
Target sample: 37, Prediction:1, Target's Score:[-2.964729, 6.1180124, -3.331892, 0.63506943, -1.7474552, -2.6388361, 4.399337, -1.7449375, 2.4187956, -1.1306195]
Target sample: 43, Prediction:1, Target's Score:[-3.7221348, 8.505534, -2.4009168, -1.4079111, -1.903752, -1.1934197, 5.4346952, -3.253315, 0.909068, -0.9437742]
Target sample: 49, Prediction:1, Target's Score:[-1.8291618, 7.8396745, -2.818259, -0.9875493, -3.848274, -1.7444746, 5.35239, -1.7752533, 1.0579405, -1.2238967]
Target sample: 55, Prediction:1, Target's Score:[1.8805736, 4.7339673, -2.9728293, 1.0132356, -3.3735833, -1.4054434, 3.0554793, -1.2144443, -1.1141388, -0.57885116]
Target sample: 61, Prediction:6, Target's Score:[-3.1160436, 6.3322163, -2.1440566, -1.9226559, -4.1250696, -1.0971564, 9.335423, -3.2745016, -1.9117274, 1.9545795]
Target sample: 67, Prediction:1, Target's Score:[-2.2434604, 7.228437, -3.65754, -1.9571939, -4.3991156, -2.4626434, 3.2974553, -2.4030883, -0.55606914, 7.1888695]
Target sample: 73, Prediction:1, Target's Score:[-2.8343341, 6.9413733, -1.7087396, 1.1718743, -3.564004, -0.62279046, 3.3905962, -3.3307865, -1.1142399, 1.6980448]
Target sample: 79, Prediction:1, Target's Score:[-4.6495376, 12.981362, -4.1573935, -2.484067, -3.8482075, 0.26692182, 4.8807483, -3.31973, -1.3842573, 1.748151]
Target sample: 85, Prediction:1, Target's Score:[-3.6176646, 10.1429405, -2.7851965, -2.4217782, -4.528265, -1.3889552, 9.573581, -3.4682024, 0.0679377, -1.5482291]
Target sample: 91, Prediction:6, Target's Score:[-4.729398, 10.28625, -3.6606677, -3.3301828, -4.392528, -0.8945187, 10.757009, -3.3423266, 0.8538642, -1.5174376]
Current ATTACK acc on target samples: 25.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 02:30:24 Epoch 59, Val iteration 0, acc 92.400 (92.400)
2021-06-12 02:30:37 Epoch 59, Val iteration 19, acc 92.800 (92.840)
* Prec: 92.84000205993652
Per class accuracy =  [0.94849243 0.95207148 0.88580436 0.86719492 0.94981673 0.8832817
 0.95589957 0.94342641 0.94524523 0.95461578]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 6, 6, 9, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 6, 1, 1, 1, 6
ATTACK acc: 31.57894736842105
--------
------SUMMARY------
TIME ELAPSED (mins): 23
TARGET INDEX: 15
ResNet50 12.5 9.210526315789474 95.46000137329102 88.91000099182129
DPN92 31.25 23.68421052631579 95.50000267028808 93.61000175476075
MobileNetV2 18.75 15.789473684210526 91.22000160217286 89.37000198364258
GoogLeNet 25.0 31.57894736842105 95.41000213623047 92.84000205993652
True False False False True
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 136 images of target 16
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=16, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/16/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133]
# Targets: 23, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-12 02:30:59 Iteration 0 	 Training Loss: 8.822e-01 	 Loss in Target Net: 9.950e-01	  
tensor(0.0005, device='cuda:0')
 2021-06-12 02:32:13 Iteration 50 	 Training Loss: 3.971e-01 	 Loss in Target Net: 4.352e-01	  
tensor(-0.0539, device='cuda:0')
 2021-06-12 02:33:25 Iteration 100 	 Training Loss: 3.551e-01 	 Loss in Target Net: 3.850e-01	  
tensor(-0.1195, device='cuda:0')
 2021-06-12 02:34:36 Iteration 150 	 Training Loss: 3.231e-01 	 Loss in Target Net: 3.756e-01	  
tensor(-0.1821, device='cuda:0')
 2021-06-12 02:35:48 Iteration 200 	 Training Loss: 3.031e-01 	 Loss in Target Net: 3.796e-01	  
tensor(-0.2287, device='cuda:0')
 2021-06-12 02:36:57 Iteration 250 	 Training Loss: 2.941e-01 	 Loss in Target Net: 3.439e-01	  
tensor(-0.2502, device='cuda:0')
 2021-06-12 02:38:07 Iteration 300 	 Training Loss: 2.950e-01 	 Loss in Target Net: 3.378e-01	  
tensor(-0.2624, device='cuda:0')
 2021-06-12 02:39:17 Iteration 350 	 Training Loss: 2.868e-01 	 Loss in Target Net: 3.458e-01	  
tensor(-0.2717, device='cuda:0')
 2021-06-12 02:40:30 Iteration 400 	 Training Loss: 2.846e-01 	 Loss in Target Net: 3.583e-01	  
tensor(-0.2801, device='cuda:0')
 2021-06-12 02:41:41 Iteration 450 	 Training Loss: 2.844e-01 	 Loss in Target Net: 3.636e-01	  
tensor(-0.2845, device='cuda:0')
 2021-06-12 02:42:52 Iteration 500 	 Training Loss: 2.839e-01 	 Loss in Target Net: 3.552e-01	  
tensor(-0.2795, device='cuda:0')
 2021-06-12 02:44:03 Iteration 550 	 Training Loss: 2.814e-01 	 Loss in Target Net: 3.742e-01	  
tensor(-0.2843, device='cuda:0')
 2021-06-12 02:45:13 Iteration 600 	 Training Loss: 2.841e-01 	 Loss in Target Net: 3.603e-01	  
tensor(-0.2825, device='cuda:0')
 2021-06-12 02:46:23 Iteration 650 	 Training Loss: 2.833e-01 	 Loss in Target Net: 3.715e-01	  
tensor(-0.2748, device='cuda:0')
 2021-06-12 02:47:35 Iteration 700 	 Training Loss: 2.834e-01 	 Loss in Target Net: 3.704e-01	  
tensor(-0.2752, device='cuda:0')
 2021-06-12 02:48:47 Iteration 750 	 Training Loss: 2.829e-01 	 Loss in Target Net: 3.737e-01	  
tensor(-0.2734, device='cuda:0')
 2021-06-12 02:49:58 Iteration 800 	 Training Loss: 2.878e-01 	 Loss in Target Net: 3.780e-01	  
tensor(-0.2705, device='cuda:0')
 2021-06-12 02:51:10 Iteration 850 	 Training Loss: 2.856e-01 	 Loss in Target Net: 3.715e-01	  
tensor(-0.2747, device='cuda:0')
 2021-06-12 02:52:23 Iteration 900 	 Training Loss: 2.860e-01 	 Loss in Target Net: 3.760e-01	  
tensor(-0.2615, device='cuda:0')
 2021-06-12 02:53:36 Iteration 950 	 Training Loss: 2.826e-01 	 Loss in Target Net: 3.989e-01	  
tensor(-0.2623, device='cuda:0')
 2021-06-12 02:54:46 Iteration 999 	 Training Loss: 2.854e-01 	 Loss in Target Net: 3.671e-01	  
tensor(-0.2579, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 02:54:51, Val iteration 0, acc 94.200 (94.200)
2021-06-12 02:55:01, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-12 02:55:06, Epoch 0, Iteration 7, loss 0.944 (0.589), acc 82.692 (87.800)
2021-06-12 02:56:07, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-4.2895494, -0.25579628, 0.6488862, -0.9510341, 1.2330831, -3.283294, 11.500909, -3.6126316, -0.050729208, -0.93982166]
Target sample: 7, Prediction:6, Target's Score:[-5.058486, -0.26856562, 1.7902099, -0.4142038, 0.696878, -3.7478397, 12.887259, -4.297965, -0.27835676, -1.3101027]
Target sample: 13, Prediction:6, Target's Score:[-4.5791473, 3.3784795, 0.7722503, -0.5934085, -0.24265859, -3.5559843, 11.144648, -3.5961194, 1.21025, -3.921953]
Target sample: 19, Prediction:6, Target's Score:[-4.2970386, 1.1255952, 0.48509943, -1.1848496, 0.33422026, -3.884076, 12.0022955, -4.117429, 0.1539293, -0.61238474]
Target sample: 25, Prediction:6, Target's Score:[-4.409876, 5.5071645, 0.4693176, -1.6071607, -0.0037601069, -3.8162024, 10.370843, -3.5668848, -0.0017345184, -2.9340055]
Target sample: 31, Prediction:6, Target's Score:[-4.804029, 1.9379565, 0.42743737, -1.4867251, 0.5209735, -3.5014257, 10.762569, -4.084708, 2.237632, -2.0046976]
Target sample: 37, Prediction:6, Target's Score:[-4.9514117, 0.1344862, -0.8773956, -1.7758561, 0.5691237, -3.6435404, 10.087532, -4.4344754, 4.4979525, 0.38479874]
Target sample: 43, Prediction:6, Target's Score:[-4.6510477, -0.43972906, -0.51379794, -1.9282694, -0.019697316, -3.9143007, 10.072245, -4.653421, 7.7815814, -1.7443314]
Target sample: 49, Prediction:6, Target's Score:[-4.8610263, 0.39579272, -0.6389439, -1.5254171, -0.16406989, -2.525126, 8.706986, -4.356154, 4.4461093, 0.5101293]
Target sample: 55, Prediction:6, Target's Score:[-4.2838216, -0.67536134, 0.043339558, -0.8674951, 1.7468396, -3.1444595, 10.673913, -3.62582, 2.0644028, -1.9372422]
Target sample: 61, Prediction:6, Target's Score:[-4.5803714, 2.9995394, -0.40857807, -1.6991448, 0.58793604, -3.1119926, 9.480016, -4.1129293, 0.1314081, 0.7077135]
Target sample: 67, Prediction:6, Target's Score:[-5.595882, -1.974651, -0.5443594, -0.86011744, 4.9930425, -3.1992738, 10.74378, -4.122196, 2.130068, -1.6134439]
Target sample: 73, Prediction:6, Target's Score:[-4.440324, 5.444856, 0.6883648, -1.3411077, 0.25666654, -3.4984245, 9.8428135, -3.4116378, 0.91762376, -4.453526]
Target sample: 79, Prediction:6, Target's Score:[-4.15769, 2.1498935, -0.4950956, -1.8046894, -0.1624518, -3.7316413, 9.337207, -4.3833966, 1.2910345, 1.9437783]
Target sample: 85, Prediction:6, Target's Score:[-3.891095, 6.302898, -0.4479605, -2.1734831, -0.23379564, -3.9801464, 10.168914, -3.4013789, 1.4768165, -3.7998228]
Target sample: 91, Prediction:6, Target's Score:[-5.06681, 3.894817, -0.13192537, -1.799264, -0.49828252, -3.7065728, 10.54562, -3.9181232, 2.9151716, -2.2186282]
Target sample: 97, Prediction:6, Target's Score:[-4.0510798, -0.011812464, -1.0728961, -2.4844217, -0.6638548, -3.9475048, 8.620593, -4.6133056, 7.5782976, 0.6296517]
Target sample: 103, Prediction:6, Target's Score:[-5.3839498, -0.5914164, -1.7252783, -2.58924, -0.9295797, -3.5630102, 7.5140615, -4.8283362, 7.262855, 4.789074]
Target sample: 109, Prediction:6, Target's Score:[-5.1756716, -1.302392, -0.28962427, -1.2234528, 0.70026624, -3.4714794, 10.754118, -4.8947043, 4.545323, 0.33995125]
Target sample: 115, Prediction:6, Target's Score:[-4.5139656, 3.8893847, 0.42958716, -1.4393955, -0.4544046, -3.3401206, 10.012894, -3.520364, 0.3299334, -1.3805308]
Target sample: 121, Prediction:6, Target's Score:[-4.448417, 1.7547396, 0.14287521, -1.1219261, -0.56311244, -2.7481525, 8.649902, -3.640375, -0.9556798, 2.9144633]
Target sample: 127, Prediction:6, Target's Score:[-5.068897, -1.1013916, 0.55377614, -1.3322871, 0.18304464, -3.7956, 10.490714, -4.409674, -0.33137062, 4.771769]
Target sample: 133, Prediction:6, Target's Score:[-4.3950715, -0.9945217, 1.5930738, -0.113708936, 0.69811046, -3.4939196, 13.21533, -3.6975186, -0.25781024, -2.5390322]
Current ATTACK acc on target samples: 100.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 02:57:05 Epoch 59, Val iteration 0, acc 90.800 (90.800)
2021-06-12 02:57:16 Epoch 59, Val iteration 19, acc 92.000 (90.390)
* Prec: 90.39000244140625
Per class accuracy =  [0.91204224 0.95863376 0.81471922 0.79687794 0.90705398 0.90405497
 0.94906552 0.92217265 0.94687115 0.92594791]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 100.0
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 02:57:28, Val iteration 0, acc 94.800 (94.800)
2021-06-12 02:57:48, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-12 02:58:02, Epoch 0, Iteration 7, loss 0.491 (0.391), acc 84.615 (90.200)
2021-06-12 03:00:40, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-0.7222089, -0.14645234, -1.6899017, -1.4538627, -1.3641318, -0.9798373, 12.52532, -3.1997373, -0.87129307, -1.5761832]
Target sample: 7, Prediction:6, Target's Score:[-0.59635824, -0.6560554, -1.2078166, -0.94018525, -1.4419476, -1.872004, 12.374813, -3.0681887, 0.036150746, -2.1176975]
Target sample: 13, Prediction:6, Target's Score:[-0.3941274, -1.6879112, -1.3715521, -1.1022184, -1.2201377, -2.0524101, 13.059672, -3.2622147, 0.06571214, -1.523359]
Target sample: 19, Prediction:6, Target's Score:[-0.119227625, -1.5618976, -1.8495331, -1.7961668, -1.4754202, -1.4251298, 13.604307, -3.5871558, -1.1995443, -0.024335757]
Target sample: 25, Prediction:6, Target's Score:[0.6238394, 1.1343548, -1.8912264, -2.1980388, -1.8129721, -0.9450731, 12.108497, -2.9662704, -1.9187382, -1.5526199]
Target sample: 31, Prediction:6, Target's Score:[0.138736, 2.4001381, -2.2365336, -2.09576, -1.6707582, -0.99183583, 9.473318, -3.4251058, -0.16774255, -0.8427417]
Target sample: 37, Prediction:6, Target's Score:[-1.2489288, 1.5765659, -3.1135848, -1.2078493, -1.7229445, -0.7667833, 7.9969087, -3.117755, 1.0418557, 1.1052301]
Target sample: 43, Prediction:6, Target's Score:[-1.0080335, -0.21236485, -2.3554904, -1.1931899, -1.7219722, -0.9810698, 9.40834, -1.8837848, 1.853594, -1.4460267]
Target sample: 49, Prediction:6, Target's Score:[-0.8762112, 2.1165466, -3.0301874, -1.8366514, -2.8533623, -0.67743963, 7.695431, -3.3537908, 0.77849996, 2.6381931]
Target sample: 55, Prediction:6, Target's Score:[-0.6775527, -1.6798854, -1.4971193, -0.17834073, -0.31235316, -1.6822314, 9.380331, -2.4543383, -0.017246887, -0.44249865]
Target sample: 61, Prediction:9, Target's Score:[-2.2799513, 2.9517384, -2.118762, -0.47076488, 0.299518, -1.0187578, 2.309042, -3.4420974, -0.063342184, 4.382498]
Target sample: 67, Prediction:6, Target's Score:[-2.5233858, -2.7022438, -2.0677252, 0.9454076, 2.772891, -1.3059318, 7.222042, -2.3243778, 0.7058526, -0.28152567]
Target sample: 73, Prediction:6, Target's Score:[-0.45829663, -1.9910802, -0.99260956, -0.17350559, 2.1481984, -1.714101, 9.045247, -2.5948656, -0.9005319, -1.9254984]
Target sample: 79, Prediction:6, Target's Score:[-2.0981567, -0.043758392, -2.5410829, -0.98919165, 1.5169083, -1.1023827, 7.586256, -4.6152287, -0.92433965, 3.8198555]
Target sample: 85, Prediction:6, Target's Score:[-0.1396362, 3.3719842, -2.4584706, -1.7183033, 0.4254809, -0.549551, 6.192012, -2.9810448, 0.024843361, -1.6394573]
Target sample: 91, Prediction:6, Target's Score:[-0.18831444, 4.3678017, -3.0747838, -1.6066759, -2.094504, -1.7843972, 5.7869105, -2.531895, 1.858335, -0.1754925]
Target sample: 97, Prediction:6, Target's Score:[-0.3092134, 0.2738627, -2.639687, -0.99506104, -1.4666703, -1.0939215, 8.1431, -2.8024447, 1.8477147, -0.47424865]
Target sample: 103, Prediction:6, Target's Score:[-1.3344426, 3.139021, -3.4244754, -1.6512353, -3.0428798, -1.2615683, 5.561306, -3.0390968, 4.2695956, 1.3578279]
Target sample: 109, Prediction:6, Target's Score:[-0.9727465, 4.885064, -2.5834951, -2.0073092, -3.0701354, -0.23054358, 5.5905366, -3.0081809, 0.68133307, 1.3010197]
Target sample: 115, Prediction:1, Target's Score:[-0.48685086, 9.269969, -2.5533233, -2.4457896, -3.0366833, -1.4045626, 2.526271, -3.2466035, 0.733315, 1.2955097]
Target sample: 121, Prediction:6, Target's Score:[-0.44226864, 2.3486483, -2.232318, -1.5692335, -1.9417894, -1.4616683, 7.4172225, -2.91884, 0.06844202, 1.2523133]
Target sample: 127, Prediction:6, Target's Score:[-1.1214613, -1.2647107, -1.9294354, -2.0032299, -1.2016813, -0.7892593, 13.102911, -3.47215, -0.58903885, -0.19522831]
Target sample: 133, Prediction:6, Target's Score:[-0.18090628, -0.9082706, -1.4292741, -1.3118037, -1.4879078, -1.5547466, 13.516284, -3.1966496, -0.7512295, -2.1582634]
Current ATTACK acc on target samples: 91.304
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 03:03:14 Epoch 59, Val iteration 0, acc 92.800 (92.800)
2021-06-12 03:03:35 Epoch 59, Val iteration 19, acc 93.400 (92.810)
* Prec: 92.81000175476075
Per class accuracy =  [0.94683233 0.96150396 0.88242678 0.82487367 0.96154276 0.88805443
 0.95614548 0.94288831 0.96464591 0.95457398]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 4, 6, 6, 4, 6, 6, 6, 6, 6, 6, 6, 6, 4, 4, 6, 6, 6, 1, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 86.72566371681415
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 03:03:39, Val iteration 0, acc 92.600 (92.600)
2021-06-12 03:03:45, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-12 03:03:47, Epoch 0, Iteration 7, loss 0.248 (0.371), acc 90.385 (88.800)
2021-06-12 03:04:15, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[0.94288266, 4.6938, -2.9459133, 1.9369462, -2.2821877, -2.0406988, 3.2146378, -4.0914207, -0.93970627, 1.7753347]
Target sample: 7, Prediction:6, Target's Score:[2.9089298, 4.6514153, -2.07657, 3.67475, -5.10128, -2.8852375, 6.1715226, -5.2176394, 0.5136256, -2.387584]
Target sample: 13, Prediction:6, Target's Score:[-0.037144322, 2.534206, -1.9240203, 2.557861, -3.5726097, -2.6118405, 7.764503, -6.019796, 1.0641129, 0.5166363]
Target sample: 19, Prediction:6, Target's Score:[2.985569, 0.0037939623, -2.2338123, 3.0701387, -0.29573795, -3.2183976, 3.9153645, -4.370609, -3.2072153, 3.6094396]
Target sample: 25, Prediction:1, Target's Score:[3.0478714, 6.7898655, -4.201661, 3.1601965, -2.7538698, -2.4342315, 2.350935, -4.683548, -0.9181806, -0.08517381]
Target sample: 31, Prediction:3, Target's Score:[0.5288828, 0.31576762, -2.2172842, 5.080279, -1.5414907, -3.109276, 4.7946033, -4.7348166, 2.9952483, -1.8576376]
Target sample: 37, Prediction:3, Target's Score:[-0.8740895, -0.19197425, -4.006859, 4.9337487, -1.5959806, -2.7705967, 3.958236, -4.539899, 4.0467334, 1.3090885]
Target sample: 43, Prediction:3, Target's Score:[-1.446823, 0.11325046, -1.3884153, 4.308898, -0.9535344, -2.2881951, 3.7675729, -3.7760866, 3.4739828, -1.5611873]
Target sample: 49, Prediction:3, Target's Score:[1.5291543, 3.1196163, -1.9081178, 4.1905675, -0.024404455, -2.8443131, 1.9792627, -5.2870007, 2.1410725, -2.6170144]
Target sample: 55, Prediction:3, Target's Score:[1.3077377, -2.5873823, 0.67877704, 7.0170016, -1.3580555, -0.9865681, 3.3813257, -5.038633, 0.98254687, -3.162765]
Target sample: 61, Prediction:9, Target's Score:[0.419413, 2.8914192, -2.0714307, 1.9093702, -2.6416607, -2.8649697, 4.1364713, -4.511337, -3.7869432, 6.7648587]
Target sample: 67, Prediction:8, Target's Score:[-0.286915, -1.8909752, -0.54833716, 1.3179739, 1.305973, -3.9841044, 2.9507763, -2.1690068, 4.2325354, -0.67602265]
Target sample: 73, Prediction:8, Target's Score:[1.9796606, -0.661864, 1.5973833, 2.82633, 0.97422117, -4.197134, 0.7908838, -4.2134037, 4.5805755, -3.4373033]
Target sample: 79, Prediction:9, Target's Score:[0.7261258, 4.054482, -4.169837, 2.8085194, -1.2637724, -1.5826706, 2.7277215, -5.240903, -3.0649884, 5.2876797]
Target sample: 85, Prediction:1, Target's Score:[3.1288571, 4.831176, -3.9936686, 2.0711832, -0.72566646, -2.3184485, 1.4858397, -3.7827885, 1.6995287, -2.1407135]
Target sample: 91, Prediction:1, Target's Score:[0.07691337, 8.674234, -5.597568, 3.5998392, -3.1516914, -2.4685695, 2.3994546, -3.9586017, 0.3618119, 0.36272004]
Target sample: 97, Prediction:3, Target's Score:[-0.3228435, -2.838196, -0.29039395, 4.110648, -1.0484434, -3.4793987, 2.6229928, -3.3838298, 3.4195395, 1.4521055]
Target sample: 103, Prediction:6, Target's Score:[-2.4839106, 1.3730727, -4.3314285, 3.3279276, -1.206652, -1.300464, 4.7996964, -5.3223367, 3.0090415, 2.4119692]
Target sample: 109, Prediction:6, Target's Score:[0.17645548, 1.1432337, -2.370974, 4.8422866, -2.005538, -2.0456657, 5.7908955, -5.1725826, 0.35400826, -0.45368734]
Target sample: 115, Prediction:1, Target's Score:[3.9893384, 7.221038, -3.0550494, 2.6211383, -3.8141441, -2.8495955, 0.1095361, -2.4119444, -0.21859725, -1.3256963]
Target sample: 121, Prediction:3, Target's Score:[2.2681608, 1.1266317, -3.82663, 4.391712, -2.3399622, -2.039892, 2.5732272, -2.386034, -0.44640544, 0.90478665]
Target sample: 127, Prediction:6, Target's Score:[-0.22406875, 2.8642974, -2.8271003, 3.5886095, -4.2208734, -2.40557, 6.814229, -4.6033025, -0.34765095, 1.6119142]
Target sample: 133, Prediction:6, Target's Score:[0.5218237, 2.7648656, -1.9816548, 5.1443057, -4.658259, -2.431264, 7.147097, -5.0091324, -0.48850077, -0.75465983]
Current ATTACK acc on target samples: 30.435
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 03:04:42 Epoch 59, Val iteration 0, acc 89.800 (89.800)
2021-06-12 03:04:48 Epoch 59, Val iteration 19, acc 90.600 (89.550)
* Prec: 89.55000152587891
Per class accuracy =  [0.92667608 0.92348629 0.8426014  0.82751057 0.89734543 0.82538071
 0.93550504 0.89079063 0.93169274 0.94880729]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 3, 1, 1, 1, 6, 1, 6, 6, 1, 1, 6, 6, 1, 1, 6, 6, 3, 6, 6, 3, 1, 3, 8, 8, 3, 3, 3, 6, 3, 6, 6, 3, 6, 6, 3, 3, 3, 1, 6, 6, 1, 1, 1, 3, 3, 3, 4, 6, 6, 3, 0, 4, 3, 8, 8, 8, 8, 3, 8, 3, 8, 8, 8, 4, 4, 6, 6, 3, 3, 1, 3, 3, 1, 1, 1, 1, 1, 6, 6, 6, 3, 6, 4, 3, 3, 3, 6, 6, 3, 3, 3, 3, 6, 3, 1, 1, 1, 3, 3, 0, 6, 6, 1, 3, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 33.6283185840708
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 03:04:56, Val iteration 0, acc 96.200 (96.200)
2021-06-12 03:05:08, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-12 03:05:15, Epoch 0, Iteration 7, loss 1.124 (1.115), acc 63.462 (73.000)
2021-06-12 03:06:26, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[0.04853499, 2.65974, -4.052601, -0.7966819, -1.9412105, -3.2399664, 9.82162, -4.272338, -1.0771211, 2.8665404]
Target sample: 7, Prediction:6, Target's Score:[-0.1645182, 0.75029284, -2.5623362, -0.32621312, -2.8981247, -4.4786882, 12.136957, -4.220607, -0.5888628, 2.3663526]
Target sample: 13, Prediction:6, Target's Score:[-1.0657772, 4.6251225, -3.995331, -0.44799313, -2.9148135, -4.5643396, 11.881645, -4.252867, 1.6977714, -0.9732144]
Target sample: 19, Prediction:6, Target's Score:[1.5072415, 1.9644918, -4.052599, -1.3540969, -2.8791306, -4.099872, 10.488578, -4.2092247, 0.32182044, 2.3353062]
Target sample: 25, Prediction:6, Target's Score:[-0.0955469, 5.0750537, -4.8137255, -1.3943427, -2.5426762, -3.862037, 8.872143, -4.360628, 2.159546, 0.93992025]
Target sample: 31, Prediction:6, Target's Score:[1.0770812, 3.5590324, -4.1261024, -1.3670548, -2.844611, -4.0188203, 7.928606, -4.5549045, 2.2295446, 2.094038]
Target sample: 37, Prediction:6, Target's Score:[-0.2553543, 1.9229107, -4.1327214, 1.0606217, -2.6629949, -4.392678, 7.3432384, -4.937657, 1.4178717, 4.6011333]
Target sample: 43, Prediction:6, Target's Score:[0.46878988, 2.0215077, -3.176195, 0.36332393, -2.0177047, -4.695266, 8.400094, -3.7912445, 1.5446662, 0.8688525]
Target sample: 49, Prediction:6, Target's Score:[-0.03286308, 4.09832, -4.185734, -0.48872852, -2.670421, -2.94217, 7.6469445, -4.6389537, 1.0985757, 2.0975537]
Target sample: 55, Prediction:6, Target's Score:[3.6190853, 0.26048827, -2.3820865, -1.4630754, 0.70597184, -4.9207687, 8.019994, -2.922453, 0.7057161, -1.5857977]
Target sample: 61, Prediction:9, Target's Score:[-1.3195015, 3.9825249, -4.2682824, -1.4596295, -0.36486265, -3.2845228, 6.4454975, -4.571144, -1.7068806, 6.5363574]
Target sample: 67, Prediction:6, Target's Score:[0.1459992, 0.8160082, -3.9377239, 0.6104448, 0.92647713, -5.440027, 6.9477057, -3.1735773, 4.3415294, -1.2958574]
Target sample: 73, Prediction:6, Target's Score:[0.9166088, 4.3604465, -2.0507867, 0.5148289, 0.14588012, -6.1157274, 6.73883, -3.1752524, 1.4680269, -2.803]
Target sample: 79, Prediction:9, Target's Score:[0.31103736, 4.173107, -5.1242537, -2.2008693, -2.8817647, -5.1553445, 6.8457675, -4.9518385, -1.028922, 9.992428]
Target sample: 85, Prediction:6, Target's Score:[1.6044527, 4.887018, -4.2240353, -2.0571501, -3.000048, -3.6925986, 8.387644, -3.6184976, 3.0549846, -1.3508765]
Target sample: 91, Prediction:6, Target's Score:[0.77245325, 3.671781, -4.250009, -1.2178936, -3.338889, -5.083328, 8.8628845, -4.0337176, 1.2426965, 3.3579867]
Target sample: 97, Prediction:6, Target's Score:[0.56558406, -0.5473875, -3.5968037, -0.1809125, -2.3950305, -4.6732926, 9.708652, -4.7532244, 4.8364296, 0.9780831]
Target sample: 103, Prediction:6, Target's Score:[-0.85728896, 3.868843, -5.515039, -0.6833755, -3.4955733, -4.6154647, 8.421663, -4.156796, 1.6151822, 5.3800864]
Target sample: 109, Prediction:6, Target's Score:[0.25238502, 3.1961565, -4.1175246, -0.039318867, -2.871585, -4.309409, 7.6909094, -4.83037, 1.1702671, 3.8374817]
Target sample: 115, Prediction:1, Target's Score:[-0.7675368, 7.686959, -4.7718105, 0.29431605, -3.2655573, -3.2719133, 7.2559304, -4.411383, -1.3009462, 2.5629456]
Target sample: 121, Prediction:1, Target's Score:[-0.33013362, 8.746766, -3.0286458, 0.20360738, -2.8499894, -4.6368747, 6.5703177, -4.4564176, -1.1196756, 0.9147133]
Target sample: 127, Prediction:6, Target's Score:[-0.5297284, -0.16791488, -4.3154116, -1.2033162, -3.3289068, -3.4621122, 11.639134, -4.835647, 0.15944427, 6.026231]
Target sample: 133, Prediction:6, Target's Score:[-1.7920916, 0.85076886, -1.7674117, 1.3845263, -3.036338, -3.9013755, 11.037889, -4.6621428, -0.19959724, 2.0760393]
Current ATTACK acc on target samples: 82.609
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 03:07:36 Epoch 59, Val iteration 0, acc 92.000 (92.000)
2021-06-12 03:07:48 Epoch 59, Val iteration 19, acc 94.000 (92.260)
* Prec: 92.26000022888184
Per class accuracy =  [0.93182547 0.93927937 0.88915829 0.82949536 0.95033959 0.91876225
 0.948376   0.92926884 0.93899777 0.95132278]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 1, 6, 6, 9, 9, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 9, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 92.92035398230088
--------
------SUMMARY------
TIME ELAPSED (mins): 24
TARGET INDEX: 16
ResNet50 100.0 100.0 95.46000137329102 90.39000244140625
DPN92 91.30434782608695 86.72566371681415 95.50000267028808 92.81000175476075
MobileNetV2 30.434782608695652 33.6283185840708 91.22000160217286 89.55000152587891
GoogLeNet 82.6086956521739 92.92035398230088 95.41000213623047 92.26000022888184
True False False False True
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 129 images of target 17
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=17, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/17/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127]
# Targets: 22, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-12 03:08:10 Iteration 0 	 Training Loss: 8.766e-01 	 Loss in Target Net: 9.705e-01	  
tensor(-0.0002, device='cuda:0')
 2021-06-12 03:09:21 Iteration 50 	 Training Loss: 3.824e-01 	 Loss in Target Net: 4.262e-01	  
tensor(-0.0477, device='cuda:0')
 2021-06-12 03:10:32 Iteration 100 	 Training Loss: 3.322e-01 	 Loss in Target Net: 4.065e-01	  
tensor(-0.1008, device='cuda:0')
 2021-06-12 03:11:44 Iteration 150 	 Training Loss: 2.980e-01 	 Loss in Target Net: 3.667e-01	  
tensor(-0.1484, device='cuda:0')
 2021-06-12 03:12:54 Iteration 200 	 Training Loss: 2.832e-01 	 Loss in Target Net: 3.453e-01	  
tensor(-0.1747, device='cuda:0')
 2021-06-12 03:14:03 Iteration 250 	 Training Loss: 2.736e-01 	 Loss in Target Net: 3.736e-01	  
tensor(-0.1905, device='cuda:0')
 2021-06-12 03:15:13 Iteration 300 	 Training Loss: 2.721e-01 	 Loss in Target Net: 3.670e-01	  
tensor(-0.1998, device='cuda:0')
 2021-06-12 03:16:22 Iteration 350 	 Training Loss: 2.717e-01 	 Loss in Target Net: 3.708e-01	  
tensor(-0.2113, device='cuda:0')
 2021-06-12 03:17:33 Iteration 400 	 Training Loss: 2.689e-01 	 Loss in Target Net: 3.702e-01	  
tensor(-0.2107, device='cuda:0')
 2021-06-12 03:18:46 Iteration 450 	 Training Loss: 2.662e-01 	 Loss in Target Net: 3.557e-01	  
tensor(-0.2094, device='cuda:0')
 2021-06-12 03:19:57 Iteration 500 	 Training Loss: 2.597e-01 	 Loss in Target Net: 3.625e-01	  
tensor(-0.2192, device='cuda:0')
 2021-06-12 03:21:07 Iteration 550 	 Training Loss: 2.631e-01 	 Loss in Target Net: 3.538e-01	  
tensor(-0.2237, device='cuda:0')
 2021-06-12 03:22:16 Iteration 600 	 Training Loss: 2.648e-01 	 Loss in Target Net: 3.930e-01	  
tensor(-0.2255, device='cuda:0')
 2021-06-12 03:23:27 Iteration 650 	 Training Loss: 2.644e-01 	 Loss in Target Net: 3.554e-01	  
tensor(-0.2236, device='cuda:0')
 2021-06-12 03:24:41 Iteration 700 	 Training Loss: 2.595e-01 	 Loss in Target Net: 3.391e-01	  
tensor(-0.2287, device='cuda:0')
 2021-06-12 03:25:51 Iteration 750 	 Training Loss: 2.603e-01 	 Loss in Target Net: 3.289e-01	  
tensor(-0.2272, device='cuda:0')
 2021-06-12 03:27:05 Iteration 800 	 Training Loss: 2.567e-01 	 Loss in Target Net: 3.165e-01	  
tensor(-0.2241, device='cuda:0')
 2021-06-12 03:28:16 Iteration 850 	 Training Loss: 2.591e-01 	 Loss in Target Net: 3.403e-01	  
tensor(-0.2287, device='cuda:0')
 2021-06-12 03:29:26 Iteration 900 	 Training Loss: 2.584e-01 	 Loss in Target Net: 3.458e-01	  
tensor(-0.2321, device='cuda:0')
 2021-06-12 03:30:36 Iteration 950 	 Training Loss: 2.625e-01 	 Loss in Target Net: 3.523e-01	  
tensor(-0.2291, device='cuda:0')
 2021-06-12 03:31:46 Iteration 999 	 Training Loss: 2.539e-01 	 Loss in Target Net: 3.305e-01	  
tensor(-0.2282, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 03:31:51, Val iteration 0, acc 94.200 (94.200)
2021-06-12 03:32:01, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-12 03:32:07, Epoch 0, Iteration 7, loss 0.395 (0.578), acc 86.538 (86.000)
2021-06-12 03:33:07, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-3.2603123, 3.8627796, 0.8302051, 0.2387932, -1.4085133, -1.9223253, 7.5892196, -3.5135698, 0.9489355, -3.2168534]
Target sample: 7, Prediction:6, Target's Score:[-3.9014082, 3.007559, -0.69972235, 1.3622801, -1.343548, -1.574737, 9.315291, -3.88799, 0.6101443, -2.7058403]
Target sample: 13, Prediction:6, Target's Score:[-4.02791, 0.58514035, 0.3537499, 2.3943405, -1.0012444, -1.6261568, 8.533061, -3.9201035, 0.13496797, -1.2388562]
Target sample: 19, Prediction:6, Target's Score:[-2.8670485, 5.651233, 0.09939362, -0.81423324, -1.2720792, -2.5380893, 9.208262, -3.8581276, 0.15868372, -3.5937226]
Target sample: 25, Prediction:6, Target's Score:[-3.6604114, 3.2998617, 0.1863594, 0.47179434, -1.3899094, -2.2162166, 9.836602, -3.8265178, 0.97083765, -3.4821541]
Target sample: 31, Prediction:6, Target's Score:[-3.6015055, 1.128074, 0.66377354, 0.39703768, -0.9017136, -2.2903621, 9.874849, -3.770857, 2.3192344, -3.611227]
Target sample: 37, Prediction:6, Target's Score:[-3.0284145, 1.7403023, -0.011003854, 0.011551328, -1.3389229, -2.3637817, 9.520078, -3.776887, 2.7567492, -3.3038912]
Target sample: 43, Prediction:6, Target's Score:[-3.6998835, 2.4030344, -0.9272096, 0.62562764, -1.5396109, -1.849301, 10.081086, -3.8811896, 2.1304114, -3.1331983]
Target sample: 49, Prediction:6, Target's Score:[-3.5786376, 4.3848996, -0.3894784, 0.34922442, -1.6451542, -2.2106793, 10.998867, -4.1523795, 0.8540981, -4.397169]
Target sample: 55, Prediction:6, Target's Score:[-4.175794, 3.136265, 0.32683828, 0.77149963, -1.0117643, -1.8685558, 10.958138, -3.9712908, -0.23230621, -3.7307615]
Target sample: 61, Prediction:6, Target's Score:[-3.225415, 1.0106225, -0.37514254, 0.32605016, -0.65421796, -2.2343733, 10.962815, -2.8368793, 1.043031, -3.784194]
Target sample: 67, Prediction:6, Target's Score:[-4.3125987, 2.7208064, -0.55848366, 0.039052986, -1.2957582, -2.3830037, 13.734525, -4.0732894, 0.8404445, -4.4461417]
Target sample: 73, Prediction:6, Target's Score:[-3.8265755, 2.981699, -0.7255645, -0.2841394, -1.5462542, -2.3473566, 13.015443, -3.8685071, 0.44845447, -3.5955408]
Target sample: 79, Prediction:6, Target's Score:[-3.837287, 5.0483065, -0.8422445, -0.3437239, -1.569599, -2.4455242, 10.939848, -3.9364173, 0.6486863, -3.4610722]
Target sample: 85, Prediction:6, Target's Score:[-3.5217848, 1.5152977, -0.3770023, 0.6042598, -1.0618056, -2.0940492, 9.313582, -3.9054396, 2.6932793, -2.9655926]
Target sample: 91, Prediction:6, Target's Score:[-4.121797, 0.634158, 0.09273258, 1.6479985, -1.1063324, -1.8678852, 8.037903, -3.976669, 3.6043222, -2.7600632]
Target sample: 97, Prediction:6, Target's Score:[-3.6239605, 3.103416, -0.05265436, 0.804465, -1.6941189, -2.1628811, 7.9579067, -4.230405, 4.220354, -4.144678]
Target sample: 103, Prediction:6, Target's Score:[-2.2160196, 0.416075, -0.09376495, 0.734386, -1.6439264, -1.9128624, 6.0599895, -3.704208, 3.6613312, -1.1307204]
Target sample: 109, Prediction:6, Target's Score:[-3.0219612, 6.8611965, -1.1587071, 0.3844521, -2.711848, -1.9361887, 8.526744, -4.110557, 1.0083452, -3.6695297]
Target sample: 115, Prediction:6, Target's Score:[-3.6095135, 2.3235416, -0.08789976, 0.6789939, -1.4861907, -1.8095531, 9.825966, -3.6464105, 1.2357693, -3.2238276]
Target sample: 121, Prediction:6, Target's Score:[-3.690621, 1.1148269, 2.244784, 0.12450991, 1.8545566, -2.0342824, 7.112659, -3.3905053, 0.6076833, -3.7891974]
Target sample: 127, Prediction:6, Target's Score:[-3.657341, 0.63382185, 0.2013763, 2.1727166, -1.4128468, -1.8377639, 5.469949, -3.6129348, 0.006064228, 2.1768622]
Current ATTACK acc on target samples: 100.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 03:34:06 Epoch 59, Val iteration 0, acc 90.400 (90.400)
2021-06-12 03:34:16 Epoch 59, Val iteration 19, acc 93.400 (90.820)
* Prec: 90.82000122070312
Per class accuracy =  [0.94694058 0.95780565 0.82255013 0.82378451 0.93532342 0.85088829
 0.96908344 0.90488688 0.93622465 0.93927316]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 99.06542056074767
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 03:34:28, Val iteration 0, acc 94.800 (94.800)
2021-06-12 03:34:48, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-12 03:35:03, Epoch 0, Iteration 7, loss 0.264 (0.375), acc 92.308 (90.800)
2021-06-12 03:37:41, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.2330352, 2.1972122, 0.025782961, 0.009346303, -0.15751712, -1.8345497, 4.230575, 0.43942678, -0.22328922, -3.0779967]
Target sample: 7, Prediction:6, Target's Score:[-0.7795728, 0.6167565, -1.8999597, -1.3078088, -2.4957247, -0.95447564, 7.267355, -1.7323524, 3.832264, -2.2004764]
Target sample: 13, Prediction:6, Target's Score:[-1.8394933, 1.3832209, -1.5341846, 1.8697052, -0.063344456, -2.4413645, 5.821762, -1.6752112, 1.0905066, -2.2605364]
Target sample: 19, Prediction:1, Target's Score:[-1.144835, 7.5947185, -3.3001215, -0.94555, -0.33962056, -3.526933, 3.4312792, -3.117842, 0.8128066, 0.9697369]
Target sample: 25, Prediction:1, Target's Score:[-0.89384586, 6.227264, -3.2271564, 0.6329942, -2.2519798, -4.747849, 3.6093714, -3.5161288, 2.4964285, 2.086541]
Target sample: 31, Prediction:6, Target's Score:[-1.5642446, 0.11602536, -1.1585269, 1.1832137, -0.08114623, -3.8513973, 10.772344, -1.7675725, -0.048334204, -3.2337656]
Target sample: 37, Prediction:6, Target's Score:[0.13706627, 0.73748666, -2.537192, -0.23497412, -0.89848, -4.3665137, 10.42286, -1.9209964, 2.4065192, -3.3368971]
Target sample: 43, Prediction:6, Target's Score:[-0.51630664, -0.65382177, -2.0683486, -0.8254779, -0.5059758, -3.8055048, 12.344277, -1.9449553, 1.2986267, -2.930285]
Target sample: 49, Prediction:6, Target's Score:[-1.0841647, 8.025001, -3.5483077, -1.6379291, -2.013416, -4.639573, 9.394167, -2.9887693, 0.13816452, -1.1482788]
Target sample: 55, Prediction:6, Target's Score:[0.5657228, -0.0007517673, -1.1846615, -0.56535155, -0.5766559, -3.7206416, 12.238229, -1.9755183, -0.030614994, -4.348336]
Target sample: 61, Prediction:6, Target's Score:[-0.03832528, -0.8214726, -1.8881615, -1.1644578, 0.2809482, -3.9064937, 11.728046, -1.2778118, 1.0781088, -3.604434]
Target sample: 67, Prediction:6, Target's Score:[0.4313561, -0.0662289, -2.5753284, -2.0146484, 0.8537133, -3.8399007, 11.681948, -1.6023581, 1.6774315, -4.1281595]
Target sample: 73, Prediction:6, Target's Score:[-0.43322313, 5.9933066, -3.6848762, -1.321616, -1.8561143, -4.266441, 7.9017243, -2.7815464, 0.21757817, 0.65270454]
Target sample: 79, Prediction:1, Target's Score:[-0.90243566, 8.808461, -3.6316078, -0.20669469, -2.8489633, -3.5882094, 2.426811, -2.2677238, 0.9764016, 1.6681696]
Target sample: 85, Prediction:8, Target's Score:[-1.2671155, 2.105222, -2.8794167, 1.2915903, -1.6904354, -3.5311482, 4.2210608, -2.8827538, 5.159935, -0.12634899]
Target sample: 91, Prediction:6, Target's Score:[-3.458066, 1.1408855, -2.5667074, 3.7092772, -1.1585208, -3.5156078, 4.452372, -2.4654818, 4.4009995, -0.14286534]
Target sample: 97, Prediction:1, Target's Score:[-1.0748163, 5.2465343, -3.2860403, 0.6605021, -1.9868925, -4.2800846, 4.2220407, -3.131075, 4.0034227, 0.0480592]
Target sample: 103, Prediction:6, Target's Score:[-1.197607, -0.00023889914, -2.698243, 0.9363095, 0.8145741, -3.2076561, 6.231048, -2.3426495, 2.3622546, -0.5206]
Target sample: 109, Prediction:1, Target's Score:[0.98904926, 7.2869635, -2.6848965, -1.5360594, -1.4337426, -3.8159409, 5.1810308, -3.0680332, -1.2224706, 0.7440944]
Target sample: 115, Prediction:6, Target's Score:[-0.28860462, 1.4947524, -1.6956342, -0.29825437, -0.6538386, -2.7200437, 7.135876, -1.1348834, 0.71089417, -2.1914725]
Target sample: 121, Prediction:6, Target's Score:[-2.283719, 1.6745577, 0.3866697, 1.40651, -0.5213874, -3.7715893, 4.2351675, -0.49753657, 0.46052814, -0.7228029]
Target sample: 127, Prediction:1, Target's Score:[-2.6918557, 4.9730577, -1.499547, 0.8619221, -3.4234982, -3.3302538, 1.4783586, -2.3479197, 2.2743056, 4.094022]
Current ATTACK acc on target samples: 68.182
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 03:40:15 Epoch 59, Val iteration 0, acc 91.000 (91.000)
2021-06-12 03:40:36 Epoch 59, Val iteration 19, acc 93.800 (92.940)
* Prec: 92.94000244140625
Per class accuracy =  [0.94871335 0.96646029 0.91293129 0.86479315 0.93120123 0.8774533
 0.95300103 0.93789501 0.95829474 0.94896887]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 2, 1, 6, 6, 6, 1, 1, 1, 9, 1, 1, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 8, 8, 8, 8, 8, 6, 8, 8, 8, 6, 6, 6, 6, 6, 9, 9, 1, 1, 1, 1, 6, 1, 6, 6, 6, 6, 2, 6, 6, 6, 8, 8, 1, 1
ATTACK acc: 65.42056074766356
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 03:40:40, Val iteration 0, acc 92.600 (92.600)
2021-06-12 03:40:46, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-12 03:40:48, Epoch 0, Iteration 7, loss 0.167 (0.332), acc 94.231 (90.600)
2021-06-12 03:41:16, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:7, Target's Score:[1.4101298, 1.7181971, -0.99347067, 1.3182688, -0.2749171, -4.2136774, 1.3001873, 2.5145936, -4.4182014, 2.077122]
Target sample: 7, Prediction:1, Target's Score:[-0.19376254, 7.895655, -4.638598, -0.46926883, -3.9618473, -4.300915, 3.4692035, -1.6956929, -1.3270476, 5.751551]
Target sample: 13, Prediction:1, Target's Score:[3.061004, 3.3371806, -3.301155, 0.99009633, -2.2319586, -4.3869686, 3.2131114, 0.30698875, -3.8115475, 3.2924309]
Target sample: 19, Prediction:1, Target's Score:[-0.85376006, 11.992753, -2.3483117, -1.730849, -3.1233275, -3.4838614, 1.6952138, -0.06614372, -3.6532533, 2.1685202]
Target sample: 25, Prediction:6, Target's Score:[2.3297346, 4.1006227, -1.5973531, -0.4146925, 0.43531385, -4.743342, 5.739199, -3.676287, -0.44394907, -1.2772776]
Target sample: 31, Prediction:1, Target's Score:[1.1368752, 8.114621, -2.7489598, -0.6848141, -0.38282618, -4.9391904, 4.2664514, -3.117037, -3.623692, 2.5521138]
Target sample: 37, Prediction:6, Target's Score:[-0.41083243, 1.1951045, -3.35829, 0.65899146, 1.4669865, -5.195043, 8.925682, -3.901033, -0.0805372, 1.1525533]
Target sample: 43, Prediction:6, Target's Score:[-1.3125381, 4.537267, -5.7050433, 2.029804, -4.299593, -2.6832762, 11.331214, -6.5618005, -0.5356941, 3.6954427]
Target sample: 49, Prediction:1, Target's Score:[-0.11546586, 10.404544, -4.0120635, 0.91557205, -4.3147435, -3.8010283, 9.531661, -5.2879176, -2.348776, -0.4288879]
Target sample: 55, Prediction:6, Target's Score:[0.89467347, -0.8660657, -1.6881393, 3.960598, -4.050276, -1.6008341, 12.4576025, -4.9892497, -4.8857274, 1.1088744]
Target sample: 61, Prediction:6, Target's Score:[0.06485086, 2.1797874, 0.07095391, 0.37017, -1.9528581, -3.6078854, 6.641052, -0.03147318, -2.3913333, -0.9771397]
Target sample: 67, Prediction:6, Target's Score:[0.62899655, 2.2777033, -4.9420567, 1.6522208, -1.9507035, -4.2302585, 10.616608, -3.5697148, 1.2662414, -1.3502783]
Target sample: 73, Prediction:6, Target's Score:[4.1845903, 7.326734, -4.0999527, -1.2517086, -3.4315994, -4.917724, 8.254709, -3.6579607, -2.417023, 0.5057667]
Target sample: 79, Prediction:6, Target's Score:[2.9116256, 6.2725844, -3.1287637, 0.2415365, -4.7420335, -3.5061762, 9.083911, -4.276125, -2.9849539, 0.5775707]
Target sample: 85, Prediction:6, Target's Score:[1.7435585, 3.9855204, -4.0251203, 0.84130096, -4.102966, -3.0211334, 7.72749, -4.955515, -2.8209074, 5.0773005]
Target sample: 91, Prediction:6, Target's Score:[-1.2421314, 2.6472592, -4.564195, 1.5843287, -1.2336117, -3.5725884, 7.8692994, -3.6341202, -4.442452, 7.086275]
Target sample: 97, Prediction:6, Target's Score:[1.1794643, 1.2606022, -3.6199555, 2.5530071, -1.471655, -3.7633226, 5.999152, -3.2531688, -3.699567, 5.2733955]
Target sample: 103, Prediction:6, Target's Score:[-0.254222, -1.4117516, -3.2398374, 2.5733054, 0.4981144, -4.0265155, 5.629796, -2.477266, -0.90581983, 4.0293684]
Target sample: 109, Prediction:1, Target's Score:[-0.5152571, 10.076883, -4.3978863, -0.7190895, -5.0700674, -4.119036, 8.054992, -3.230132, -4.076537, 4.5829377]
Target sample: 115, Prediction:6, Target's Score:[-1.8586856, 1.547946, -1.9684778, 1.1273022, -0.3155208, -2.0862546, 10.623047, -3.3163643, -1.5716444, -1.8013419]
Target sample: 121, Prediction:4, Target's Score:[-2.254919, 1.2732008, -2.7523384, -0.02999705, 3.5597072, -4.5181675, 1.3292301, 3.1513026, -1.718311, 2.454801]
Target sample: 127, Prediction:9, Target's Score:[-1.4040452, 2.391861, -5.1080136, 0.2935628, -2.2788544, -5.1316295, 3.4510758, -1.6337643, -2.5987356, 12.58293]
Current ATTACK acc on target samples: 59.091
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 03:41:43 Epoch 59, Val iteration 0, acc 90.400 (90.400)
2021-06-12 03:41:49 Epoch 59, Val iteration 19, acc 89.800 (89.600)
* Prec: 89.60000152587891
Per class accuracy =  [0.92872227 0.93178442 0.84460932 0.82760447 0.89455728 0.81881584
 0.94053492 0.89205894 0.92945075 0.94715332]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 9, 4, 6, 9, 6, 9, 9, 9, 9, 1, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 1, 6, 1, 1, 1, 1, 6, 6, 6, 6, 1, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 1, 1, 9, 9, 6, 6, 6, 6, 6, 6, 9, 6, 6, 6, 6, 6, 6, 9, 9, 1, 1, 1, 6, 6, 6, 6, 6, 1, 3, 7, 1, 6, 9, 1, 1, 9, 9
ATTACK acc: 58.87850467289719
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 03:41:57, Val iteration 0, acc 96.200 (96.200)
2021-06-12 03:42:09, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-12 03:42:16, Epoch 0, Iteration 7, loss 0.557 (0.653), acc 78.846 (81.200)
2021-06-12 03:43:27, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[1.060499, 3.2027123, -2.289392, -1.4657373, -0.4276745, -5.7524133, 4.3815684, 1.0282608, -0.21164459, 0.58403546]
Target sample: 7, Prediction:6, Target's Score:[-1.7339262, 3.1840475, -2.2429311, -2.4577162, 0.24608539, -3.6929626, 9.2044325, -3.421503, 2.1414707, -1.1308376]
Target sample: 13, Prediction:6, Target's Score:[-1.2963572, 1.9192779, -3.7722657, 1.9564637, 0.058495242, -5.1037216, 9.716768, -0.6552804, -3.0054781, 0.2743038]
Target sample: 19, Prediction:1, Target's Score:[0.051374145, 7.4580464, -5.366963, 0.027951362, 0.021073481, -5.7301946, 6.645146, -2.2242754, -2.3584821, 1.5938711]
Target sample: 25, Prediction:6, Target's Score:[-0.18192673, 1.6909406, -3.5094883, -2.3326118, -0.46346763, -5.5393686, 8.127792, -1.9865228, -2.0254803, 6.3537073]
Target sample: 31, Prediction:6, Target's Score:[-0.15337387, 2.7890122, -3.3056679, -1.1820126, -0.8155413, -4.9427333, 9.245085, -0.82416034, -0.7763664, 0.064382315]
Target sample: 37, Prediction:6, Target's Score:[1.8545312, 0.4734061, -3.3052628, -0.58839244, -2.5180764, -4.610823, 8.071877, -2.56995, 4.707679, -1.4100169]
Target sample: 43, Prediction:6, Target's Score:[0.025902634, 2.486872, -4.792738, 2.1783264, -1.1177243, -4.7595263, 9.602464, -2.3555455, -0.67248845, -0.5034338]
Target sample: 49, Prediction:6, Target's Score:[-2.106397, 4.8618693, -4.9521475, 3.2077842, -0.71481746, -3.6289647, 8.864251, -3.000824, -2.6086187, 0.1701147]
Target sample: 55, Prediction:6, Target's Score:[-0.2545929, 1.4130741, -4.5279093, 3.048962, -2.7114568, -4.993061, 9.222729, -0.17326093, -1.8497322, 0.9323161]
Target sample: 61, Prediction:6, Target's Score:[-1.4009858, -1.8282351, -1.0249056, -0.11282313, -0.57521236, -3.8560314, 9.170836, 1.7241488, 1.0839611, -3.0834627]
Target sample: 67, Prediction:6, Target's Score:[0.29937497, -0.8719492, -4.117067, 0.6535954, 3.374376, -4.79157, 10.772363, -3.0400515, -0.36956078, -1.8125994]
Target sample: 73, Prediction:6, Target's Score:[-0.5923127, 2.076206, -5.619682, 2.1157937, 0.58815473, -6.111442, 6.2602134, -0.035776623, -2.8955843, 4.348506]
Target sample: 79, Prediction:1, Target's Score:[-1.2441394, 7.1779413, -5.209792, 0.71887136, -1.1897837, -5.6278515, 7.0321126, -2.1869822, -1.3285544, 1.9711078]
Target sample: 85, Prediction:6, Target's Score:[1.8697854, 1.4966838, -4.2111244, 0.5867629, -0.9598259, -4.578463, 6.8106666, -2.7254841, 0.5703524, 1.2496121]
Target sample: 91, Prediction:6, Target's Score:[-1.713632, 2.8098855, -4.3012176, 1.5650195, -2.8207777, -4.3515563, 7.339508, -1.8155302, -0.59234643, 3.9917626]
Target sample: 97, Prediction:6, Target's Score:[0.79986817, 3.5102034, -3.9550667, 1.1737471, -2.1282058, -4.4188867, 4.257464, -3.3069787, 0.5989886, 3.5884783]
Target sample: 103, Prediction:6, Target's Score:[2.576744, -0.8430297, -1.5073074, 0.8968512, -0.77987665, -3.6946094, 5.8746667, -2.9945514, 0.11412731, 0.46166947]
Target sample: 109, Prediction:1, Target's Score:[-1.3622005, 10.107708, -5.3059626, 0.4101361, -2.0582964, -5.438854, 3.3458178, -3.0044408, -3.2199743, 6.66602]
Target sample: 115, Prediction:6, Target's Score:[-2.0243344, 3.0336785, -3.1628907, -0.1409752, -1.3427365, -3.1716142, 6.741716, -2.44133, -2.6185513, 5.2509685]
Target sample: 121, Prediction:1, Target's Score:[-2.5958605, 4.4187913, -1.4568794, -0.13530573, 0.8225483, -4.58426, 3.9369435, 0.8015896, -1.9422537, 0.8378519]
Target sample: 127, Prediction:9, Target's Score:[-1.1031555, 1.6442869, -1.3826839, -1.3171064, -0.5844807, -5.3037167, 3.686383, -2.1256695, 2.3973663, 4.214544]
Current ATTACK acc on target samples: 77.273
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 03:44:36 Epoch 59, Val iteration 0, acc 92.200 (92.200)
2021-06-12 03:44:49 Epoch 59, Val iteration 19, acc 93.400 (92.290)
* Prec: 92.2900016784668
Per class accuracy =  [0.9464727  0.9369045  0.86570562 0.8392943  0.94524352 0.90544478
 0.94813654 0.93397704 0.95471937 0.94908553]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 6, 6, 6, 6, 6, 6, 6, 9, 6, 6, 1, 6, 9, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 9, 6, 6, 6, 6, 6, 6, 6, 9, 6, 1, 1, 1, 9, 6, 1, 6, 6, 6, 1, 4, 6, 6, 6, 6, 8, 9
ATTACK acc: 81.30841121495327
--------
------SUMMARY------
TIME ELAPSED (mins): 23
TARGET INDEX: 17
ResNet50 100.0 99.06542056074767 95.46000137329102 90.82000122070312
DPN92 68.18181818181819 65.42056074766356 95.50000267028808 92.94000244140625
MobileNetV2 59.09090909090909 58.87850467289719 91.22000160217286 89.60000152587891
GoogLeNet 77.27272727272727 81.30841121495327 95.41000213623047 92.2900016784668
True False False False True
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 106 images of target 19
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=19, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/19/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103]
# Targets: 18, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-12 03:45:10 Iteration 0 	 Training Loss: 9.746e-01 	 Loss in Target Net: 1.133e+00	  
tensor(0.0005, device='cuda:0')
 2021-06-12 03:46:21 Iteration 50 	 Training Loss: 4.437e-01 	 Loss in Target Net: 3.947e-01	  
tensor(-0.0397, device='cuda:0')
 2021-06-12 03:47:35 Iteration 100 	 Training Loss: 3.920e-01 	 Loss in Target Net: 4.030e-01	  
tensor(-0.0991, device='cuda:0')
 2021-06-12 03:48:45 Iteration 150 	 Training Loss: 3.760e-01 	 Loss in Target Net: 3.936e-01	  
tensor(-0.1305, device='cuda:0')
 2021-06-12 03:49:56 Iteration 200 	 Training Loss: 3.683e-01 	 Loss in Target Net: 4.058e-01	  
tensor(-0.1409, device='cuda:0')
 2021-06-12 03:51:06 Iteration 250 	 Training Loss: 3.579e-01 	 Loss in Target Net: 3.927e-01	  
tensor(-0.1458, device='cuda:0')
 2021-06-12 03:52:15 Iteration 300 	 Training Loss: 3.565e-01 	 Loss in Target Net: 4.263e-01	  
tensor(-0.1504, device='cuda:0')
 2021-06-12 03:53:25 Iteration 350 	 Training Loss: 3.538e-01 	 Loss in Target Net: 3.787e-01	  
tensor(-0.1494, device='cuda:0')
 2021-06-12 03:54:34 Iteration 400 	 Training Loss: 3.546e-01 	 Loss in Target Net: 3.703e-01	  
tensor(-0.1506, device='cuda:0')
 2021-06-12 03:55:44 Iteration 450 	 Training Loss: 3.456e-01 	 Loss in Target Net: 3.748e-01	  
tensor(-0.1491, device='cuda:0')
 2021-06-12 03:56:52 Iteration 500 	 Training Loss: 3.539e-01 	 Loss in Target Net: 3.886e-01	  
tensor(-0.1529, device='cuda:0')
 2021-06-12 03:58:04 Iteration 550 	 Training Loss: 3.503e-01 	 Loss in Target Net: 3.753e-01	  
tensor(-0.1545, device='cuda:0')
 2021-06-12 03:59:15 Iteration 600 	 Training Loss: 3.503e-01 	 Loss in Target Net: 3.739e-01	  
tensor(-0.1532, device='cuda:0')
 2021-06-12 04:00:24 Iteration 650 	 Training Loss: 3.492e-01 	 Loss in Target Net: 3.996e-01	  
tensor(-0.1490, device='cuda:0')
 2021-06-12 04:01:34 Iteration 700 	 Training Loss: 3.472e-01 	 Loss in Target Net: 3.586e-01	  
tensor(-0.1498, device='cuda:0')
 2021-06-12 04:02:48 Iteration 750 	 Training Loss: 3.493e-01 	 Loss in Target Net: 3.806e-01	  
tensor(-0.1510, device='cuda:0')
 2021-06-12 04:03:58 Iteration 800 	 Training Loss: 3.491e-01 	 Loss in Target Net: 3.816e-01	  
tensor(-0.1513, device='cuda:0')
 2021-06-12 04:05:10 Iteration 850 	 Training Loss: 3.564e-01 	 Loss in Target Net: 3.821e-01	  
tensor(-0.1495, device='cuda:0')
 2021-06-12 04:06:19 Iteration 900 	 Training Loss: 3.490e-01 	 Loss in Target Net: 3.580e-01	  
tensor(-0.1494, device='cuda:0')
 2021-06-12 04:07:28 Iteration 950 	 Training Loss: 3.529e-01 	 Loss in Target Net: 3.746e-01	  
tensor(-0.1500, device='cuda:0')
 2021-06-12 04:08:36 Iteration 999 	 Training Loss: 3.509e-01 	 Loss in Target Net: 3.934e-01	  
tensor(-0.1506, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 04:08:41, Val iteration 0, acc 94.200 (94.200)
2021-06-12 04:08:51, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-12 04:08:57, Epoch 0, Iteration 7, loss 0.446 (0.602), acc 88.462 (86.200)
2021-06-12 04:09:57, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-0.5666024, 0.87182856, -2.433006, -0.52505726, -2.6372633, -2.4552946, 8.767506, -1.1405412, 2.389049, -2.0428765]
Target sample: 7, Prediction:6, Target's Score:[-1.3106103, 0.8384156, -1.981883, -0.3129731, -2.5091166, -2.6961753, 9.336234, -1.4644927, 2.4566238, -2.1179907]
Target sample: 13, Prediction:6, Target's Score:[-0.34958455, 3.181773, -1.7322806, -0.95024997, -2.2366052, -2.6678348, 7.783501, -1.6896712, -0.18939571, -0.94706357]
Target sample: 19, Prediction:6, Target's Score:[0.2512449, -0.27445835, -1.6344142, -0.2111164, -2.1956198, -2.2783191, 8.1689625, -1.3448159, 1.1475968, -1.4169176]
Target sample: 25, Prediction:8, Target's Score:[-0.66848606, 0.60857165, -2.3534896, -1.5612462, -2.5589538, -2.9814682, 6.284479, -1.1517371, 6.326789, -1.7784936]
Target sample: 31, Prediction:6, Target's Score:[-0.559134, -0.80249745, -1.8116431, -1.2786192, -2.035962, -2.906831, 8.624005, -0.76166564, 3.0873508, -1.3338854]
Target sample: 37, Prediction:6, Target's Score:[-1.5269619, -0.54668266, -1.0984346, -0.054467298, -1.4312792, -2.3547003, 6.3999085, -2.3037148, -1.4898272, 4.5631247]
Target sample: 43, Prediction:6, Target's Score:[0.3702211, -1.1646354, -1.1894487, -1.273248, -1.9234443, -2.7799687, 8.49236, -1.3271245, 1.7278508, -0.7140611]
Target sample: 49, Prediction:6, Target's Score:[-1.6421852, 3.116697, -2.3613815, -1.2934434, -2.4202325, -3.2269142, 9.268289, -1.5343269, 1.9787395, -1.6502088]
Target sample: 55, Prediction:6, Target's Score:[-1.8695478, 2.4547362, -2.0215063, -0.5746005, -2.5141034, -3.0035748, 10.323927, -1.709908, 1.3239602, -2.1494532]
Target sample: 61, Prediction:6, Target's Score:[-0.4175836, -1.2056136, -0.95523983, -0.8951533, -1.6800069, -2.8930829, 9.3683815, -1.1717614, 0.43831405, -0.35114115]
Target sample: 67, Prediction:6, Target's Score:[-0.49619338, -0.25655094, -0.9920556, -0.4478576, -1.4440068, -2.4621537, 8.813962, -1.3557588, -0.59638196, -0.5417477]
Target sample: 73, Prediction:6, Target's Score:[0.6313468, -0.09403677, -2.068196, -1.4987144, -2.390371, -2.8879473, 7.588819, -0.7908209, 3.7143862, -2.0043864]
Target sample: 79, Prediction:6, Target's Score:[0.01058231, 2.3914244, -2.2441955, -1.1506181, -2.4532895, -2.652839, 7.057466, -1.5128564, 2.6223204, -1.8827351]
Target sample: 85, Prediction:6, Target's Score:[-0.1539478, 0.7960234, -1.4696882, -0.982948, -1.9315157, -2.6290503, 8.642783, -1.3400503, 0.94273895, -1.6537616]
Target sample: 91, Prediction:6, Target's Score:[-0.61424327, 3.3879025, -1.1081865, -0.96121967, -1.6730764, -2.49897, 7.4636936, -2.4787064, -0.98672235, -0.34031928]
Target sample: 97, Prediction:6, Target's Score:[-0.76505005, 2.224745, -2.5115795, -0.48350966, -2.4007406, -2.3824878, 8.319969, -1.0007327, 0.58123344, -1.3659854]
Target sample: 103, Prediction:6, Target's Score:[-1.4603695, -0.55412304, -1.4827371, -0.10974733, -2.057963, -2.5285192, 9.782968, -1.241604, 1.6512713, -1.7522556]
Current ATTACK acc on target samples: 94.444
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 04:10:56 Epoch 59, Val iteration 0, acc 87.800 (87.800)
2021-06-12 04:11:06 Epoch 59, Val iteration 19, acc 88.600 (89.190)
* Prec: 89.19000091552735
Per class accuracy =  [0.90956658 0.91713583 0.79861915 0.7483525  0.90440199 0.88437835
 0.95070252 0.90601978 0.96185534 0.93833515]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 8, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 95.45454545454545
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 04:11:18, Val iteration 0, acc 94.800 (94.800)
2021-06-12 04:11:38, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-12 04:11:53, Epoch 0, Iteration 7, loss 0.154 (0.385), acc 96.154 (91.400)
2021-06-12 04:14:31, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.511937, 4.234596, -2.2817683, -1.0076339, 0.020713279, -3.4661512, 6.560706, -2.4425943, 3.7893353, -2.4750004]
Target sample: 7, Prediction:6, Target's Score:[-1.3728397, 5.944237, -1.9409096, -1.1866914, -1.5085723, -3.8216712, 6.1958766, -1.773213, 1.50893, -1.626325]
Target sample: 13, Prediction:1, Target's Score:[-0.6179565, 8.632485, -2.4862056, -1.6522133, -0.87320936, -4.518234, 3.9141307, -2.748456, -0.6065656, 1.4305956]
Target sample: 19, Prediction:1, Target's Score:[1.018477, 7.738201, -1.9779931, -0.9641806, -1.6427433, -4.6324797, 3.8361332, -2.3472242, 0.58513826, -1.1210029]
Target sample: 25, Prediction:8, Target's Score:[1.6831107, 1.8366361, -2.2741766, -2.6118383, -1.282053, -5.117041, 4.1636443, -1.680609, 6.093969, -0.41123042]
Target sample: 31, Prediction:1, Target's Score:[0.15159938, 6.574315, -2.2228909, -2.8428473, -1.2084365, -5.2249093, 5.8273177, -2.409537, 2.9126952, -1.0998075]
Target sample: 37, Prediction:1, Target's Score:[-0.1929655, 8.441843, -3.3585196, -1.7138398, -1.7702274, -4.394713, 1.9462124, -3.0840354, 1.1808401, 3.4070098]
Target sample: 43, Prediction:6, Target's Score:[-1.1556399, 1.6024023, -2.0564656, -1.0376714, 0.0731786, -4.0049086, 7.39266, -2.4688978, 3.7717893, -1.7467626]
Target sample: 49, Prediction:1, Target's Score:[-2.3765628, 9.196674, -3.0070858, -2.5752428, -0.7561788, -5.0424385, 5.750129, -2.7638316, 2.2340298, -0.177817]
Target sample: 55, Prediction:6, Target's Score:[-1.638668, 2.0253234, -1.4466871, -0.7680657, -0.08412292, -3.835803, 10.658198, -2.9887679, 0.55965334, -2.1018054]
Target sample: 61, Prediction:6, Target's Score:[3.349968, -0.36573067, -2.062629, -1.398827, 1.1875814, -3.9293835, 7.6059866, -2.4017894, -1.3096156, -0.25669184]
Target sample: 67, Prediction:6, Target's Score:[3.0361104, 1.9498616, -1.8396368, -1.7815896, -0.046740614, -4.657885, 4.250062, -1.6720003, 2.2306218, -1.058997]
Target sample: 73, Prediction:6, Target's Score:[2.6723924, 5.1080413, -1.5587467, -2.1633816, -1.2000426, -5.0163236, 5.372446, -1.8970294, 1.4463145, -2.2999265]
Target sample: 79, Prediction:1, Target's Score:[0.06431604, 8.737249, -2.507173, -2.5988944, -2.1103003, -4.7738657, 1.5855067, -1.9326112, 4.8400645, -0.8245742]
Target sample: 85, Prediction:1, Target's Score:[1.7225543, 4.487917, -2.238888, -1.9191985, -1.8285718, -4.436142, 4.465248, -1.9458879, 3.308284, -1.1744963]
Target sample: 91, Prediction:1, Target's Score:[-1.6430262, 9.227161, -2.6810567, -1.5562295, -1.7284299, -4.2426805, 5.807817, -2.7754807, -0.56861293, 0.6550031]
Target sample: 97, Prediction:6, Target's Score:[-2.0544593, 5.8115616, -2.1367645, -0.83450246, -0.7470144, -4.1821446, 6.5481715, -2.6586688, 1.7829176, -1.0950831]
Target sample: 103, Prediction:1, Target's Score:[-0.32710758, 5.419181, -2.232352, -1.379318, -2.2061203, -3.8676484, 1.781398, -2.6629102, 3.0259397, 2.8526363]
Current ATTACK acc on target samples: 44.444
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 04:17:05 Epoch 59, Val iteration 0, acc 92.000 (92.000)
2021-06-12 04:17:25 Epoch 59, Val iteration 19, acc 91.800 (92.930)
* Prec: 92.93000144958496
Per class accuracy =  [0.96360105 0.96714028 0.87970223 0.86417874 0.92933013 0.90704055
 0.93750251 0.94108377 0.96609246 0.9404572 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 8, 1, 6, 1, 1, 1, 1, 9, 0, 1, 1, 1, 1, 1, 8, 8, 8, 8, 8, 6, 6, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 6, 1, 1, 8, 6, 1, 6, 6, 8, 6, 6, 6, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 1, 1, 8, 8, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 6, 6, 1, 6, 1, 1, 1
ATTACK acc: 26.136363636363637
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 04:17:29, Val iteration 0, acc 92.600 (92.600)
2021-06-12 04:17:35, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-12 04:17:37, Epoch 0, Iteration 7, loss 0.203 (0.331), acc 92.308 (90.400)
2021-06-12 04:18:05, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:8, Target's Score:[0.6855036, 2.2800055, -0.65328246, 2.05751, -4.7663784, -3.1436055, 2.452434, -6.738469, 9.946395, -1.7091017]
Target sample: 7, Prediction:8, Target's Score:[0.11986634, 2.0833576, -2.2355921, 3.0815217, -5.539951, -1.7883788, 3.9896312, -6.372999, 7.972365, -0.9188806]
Target sample: 13, Prediction:6, Target's Score:[-1.1201365, 2.2278216, -3.0874257, 4.0207124, -1.8097515, -2.9676592, 7.6302853, -5.7023177, 1.2184024, -0.024627518]
Target sample: 19, Prediction:0, Target's Score:[5.9365716, 1.2676985, -3.2055035, 0.567213, -1.5368953, -3.2139518, 0.53911716, -3.0192025, 3.3895931, -0.419937]
Target sample: 25, Prediction:8, Target's Score:[4.233322, 0.9354357, -2.379057, 3.9445038, -2.1705015, -3.4223597, -2.583151, -2.7727008, 4.6840034, -0.1450708]
Target sample: 31, Prediction:8, Target's Score:[1.6383901, 4.1891956, -3.4372234, 3.0469875, -4.266539, -4.1480083, 1.1650064, -3.582984, 5.0730295, 0.68026507]
Target sample: 37, Prediction:6, Target's Score:[1.0423911, 1.3570344, -3.789629, 3.5834234, -1.8533021, -3.1786888, 3.956087, -4.397733, -0.045840517, 3.713889]
Target sample: 43, Prediction:6, Target's Score:[0.004217446, -1.0739219, -2.3976169, 5.3048863, -3.5835268, -0.66494375, 10.616965, -5.9863157, -1.5664923, -0.3180518]
Target sample: 49, Prediction:1, Target's Score:[1.5736881, 7.5326433, -1.948123, -1.7170974, -5.240422, -2.657962, 2.720406, -5.3541007, 4.2842755, 1.1699848]
Target sample: 55, Prediction:1, Target's Score:[-0.9467406, 6.5703483, -3.0049338, 3.000957, -5.850334, -0.47273865, 5.4496694, -6.660212, 1.5309474, 0.7939517]
Target sample: 61, Prediction:6, Target's Score:[-0.6344255, 0.4122501, -3.244173, 6.3076997, -0.5558889, -1.1033199, 9.227737, -4.468744, -2.2011325, -3.3942492]
Target sample: 67, Prediction:4, Target's Score:[2.7404878, 0.89224094, -4.567967, 3.0969913, 4.593054, -0.99018794, -1.2369325, -0.9614125, -0.8648761, -2.336429]
Target sample: 73, Prediction:1, Target's Score:[3.1317499, 3.7009091, -3.1540546, 3.1308877, -2.949904, -3.4233582, 1.4859217, -3.7262852, 2.4664056, -0.32735223]
Target sample: 79, Prediction:3, Target's Score:[1.6691031, 2.8176126, -4.154745, 5.202296, -2.7298353, -2.2329361, 0.4988114, -2.3036356, -0.65063304, 2.2347574]
Target sample: 85, Prediction:6, Target's Score:[4.4899817, -0.48129827, -2.3879354, 2.569213, -3.8458023, -4.008218, 9.927498, -5.112214, 3.737265, -4.5599356]
Target sample: 91, Prediction:6, Target's Score:[2.1487207, 2.0447721, -1.3004558, 3.1668482, -3.578357, -0.091611855, 6.4595575, -5.803218, -1.6137409, -1.1104944]
Target sample: 97, Prediction:8, Target's Score:[-0.95263195, 1.3621066, -1.853171, 1.838672, -3.2447944, -2.1845648, 3.1797833, -6.5568347, 9.449661, -0.64079326]
Target sample: 103, Prediction:8, Target's Score:[0.92702186, 2.7847018, -3.685301, 4.1176796, -3.1570501, -1.3192033, 0.39413777, -4.064165, 4.972565, -0.60669565]
Current ATTACK acc on target samples: 33.333
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 04:18:32 Epoch 59, Val iteration 0, acc 89.600 (89.600)
2021-06-12 04:18:38 Epoch 59, Val iteration 19, acc 90.600 (89.400)
* Prec: 89.4000015258789
Per class accuracy =  [0.92169643 0.92816276 0.84110284 0.82917069 0.89321875 0.81966323
 0.93706445 0.89137249 0.92524753 0.94797197]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 8, 6, 3, 6, 3, 1, 1, 3, 0, 6, 6, 0, 0, 0, 0, 8, 3, 3, 8, 8, 1, 3, 3, 8, 0, 6, 6, 6, 6, 3, 6, 6, 6, 6, 0, 1, 1, 1, 1, 1, 6, 1, 6, 6, 1, 6, 6, 3, 6, 1, 0, 0, 0, 0, 3, 0, 8, 1, 1, 3, 3, 3, 1, 6, 3, 6, 6, 6, 6, 6, 6, 0, 6, 6, 1, 1, 6, 1, 8, 8, 8, 8, 6, 6, 8, 1
ATTACK acc: 34.09090909090909
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 04:18:46, Val iteration 0, acc 96.200 (96.200)
2021-06-12 04:18:58, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-12 04:19:05, Epoch 0, Iteration 7, loss 0.449 (0.676), acc 82.692 (82.800)
2021-06-12 04:20:15, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:8, Target's Score:[-5.2760873, 6.062093, -0.61443824, -0.6819656, -1.5433472, -4.4569683, 4.7952805, -4.7533364, 8.593483, -1.9893256]
Target sample: 7, Prediction:6, Target's Score:[-3.2270734, 5.5306234, -0.65037394, 0.37446144, -1.3943394, -3.999861, 6.8964076, -3.9351048, 1.2407942, -0.7266765]
Target sample: 13, Prediction:6, Target's Score:[-1.3554028, 5.342119, -1.7989278, -0.74273276, -1.6044302, -4.334109, 5.716457, -3.5105238, 1.084436, 1.3060122]
Target sample: 19, Prediction:0, Target's Score:[6.7217236, 2.527602, 0.7930072, -1.3329298, -2.4682384, -4.7791457, 3.9264219, -3.0987759, 0.2589991, -2.4240565]
Target sample: 25, Prediction:8, Target's Score:[-0.4901559, 2.67008, -1.3639286, -0.13597067, -2.6328783, -4.2427306, 4.6088557, -2.3129675, 6.0854826, -2.067206]
Target sample: 31, Prediction:6, Target's Score:[1.1790143, 3.5853188, -1.9673882, -0.9554653, -2.514745, -4.4825783, 5.786306, -3.1133304, 4.052866, -1.4507102]
Target sample: 37, Prediction:9, Target's Score:[0.03154345, 2.938503, -3.033009, -0.86420584, -2.618875, -4.448785, 3.5221775, -3.7899039, 3.4684434, 4.898281]
Target sample: 43, Prediction:6, Target's Score:[0.050402388, 1.0769433, -0.8601562, -0.4479141, -0.99951625, -3.2746625, 6.487538, -4.113811, 3.8732843, -1.682182]
Target sample: 49, Prediction:6, Target's Score:[-2.6739275, 4.8832874, -0.43184146, -1.3336079, -1.2672945, -4.68849, 7.1058645, -4.0810122, 4.99224, -2.3826072]
Target sample: 55, Prediction:6, Target's Score:[-4.7383366, 7.4782343, -2.7928522, 0.13403998, -1.8475899, -3.917058, 7.8535666, -4.30043, 2.8638277, -0.61739653]
Target sample: 61, Prediction:6, Target's Score:[-1.5081489, 2.486981, -1.8091776, 0.33684346, -0.37623578, -3.058859, 7.9346547, -3.8603396, 0.933007, -0.9800193]
Target sample: 67, Prediction:6, Target's Score:[2.2944226, 1.0675819, -0.46293917, 0.7132416, -2.143394, -4.2225666, 3.6676905, -3.056777, 1.1107676, 1.140488]
Target sample: 73, Prediction:0, Target's Score:[4.360855, 2.2539854, -0.87528175, -0.35933512, -2.6194026, -4.7363305, 4.204373, -2.8704956, 2.2675347, -1.4986929]
Target sample: 79, Prediction:8, Target's Score:[-0.72919816, 4.412431, -1.4261189, 0.23264079, -3.3401291, -4.014779, 4.443167, -3.0813074, 4.6443624, -1.023613]
Target sample: 85, Prediction:0, Target's Score:[7.986333, 1.4835937, -1.1103739, -1.8402681, -1.9901147, -4.9347568, 4.8326035, -3.320231, 0.89704204, -1.8777193]
Target sample: 91, Prediction:9, Target's Score:[-1.1461279, 3.096653, -0.5849821, 2.4856486, -1.4039422, -3.5607634, 2.0191956, -4.3724117, -0.21104413, 3.778545]
Target sample: 97, Prediction:1, Target's Score:[-4.6983724, 9.331015, -2.398659, -0.0070516635, -2.4288552, -4.327659, 5.1930523, -4.1101227, 4.402693, -0.8344907]
Target sample: 103, Prediction:6, Target's Score:[-2.390184, 4.131116, -0.02913733, 0.52254516, 0.07332899, -2.4346757, 4.3371367, -4.562072, 2.1067185, -1.6419632]
Current ATTACK acc on target samples: 50.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 04:21:25 Epoch 59, Val iteration 0, acc 93.400 (93.400)
2021-06-12 04:21:37 Epoch 59, Val iteration 19, acc 93.000 (92.130)
* Prec: 92.13000144958497
Per class accuracy =  [0.94809064 0.93932965 0.87857957 0.81858979 0.94413961 0.89513085
 0.9548579  0.9301239  0.95111994 0.95101139]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 8, 1, 6, 6, 9, 1, 1, 1, 0, 1, 1, 1, 6, 0, 8, 8, 8, 8, 8, 8, 6, 8, 1, 8, 1, 6, 6, 8, 6, 6, 6, 6, 6, 9, 1, 6, 8, 1, 8, 8, 8, 8, 1, 6, 8, 6, 6, 6, 6, 1, 6, 0, 6, 6, 6, 6, 6, 8, 6, 6, 8, 6, 6, 8, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 1, 6, 8, 1, 6, 8, 8, 1, 1, 6, 1, 1
ATTACK acc: 42.04545454545455
--------
------SUMMARY------
TIME ELAPSED (mins): 23
TARGET INDEX: 19
ResNet50 94.44444444444444 95.45454545454545 95.46000137329102 89.19000091552735
DPN92 44.44444444444444 26.136363636363637 95.50000267028808 92.93000144958496
MobileNetV2 33.333333333333336 34.09090909090909 91.22000160217286 89.4000015258789
GoogLeNet 50.0 42.04545454545455 95.41000213623047 92.13000144958497
Multi layer Code
bash launch/attack-end2end-12.sh 0 mean 1 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '1', '1', '20', 'False', 'False', 'False', 'True']
Multi layer Code
bash launch/attack-end2end-12.sh 0 mean 5 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '5', '1', '20', 'False', 'False', 'False', 'True']
Multi layer Code
bash launch/attack-end2end-12.sh 0 mean 6 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '6', '1', '20', 'False', 'False', 'False', 'True']
Multi layer Code
bash launch/attack-end2end-12.sh 0 mean 7 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '7', '1', '20', 'False', 'False', 'False', 'True']
Multi layer Code
bash launch/attack-end2end-12.sh 0 mean 8 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '8', '1', '20', 'False', 'False', 'False', 'True']
Multi layer Code
bash launch/attack-end2end-12.sh 0 mean 9 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '9', '1', '20', 'False', 'False', 'False', 'True']
Multi layer Code
bash launch/attack-end2end-12.sh 0 mean 10 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '10', '1', '20', 'False', 'False', 'False', 'True']
Multi layer Code
bash launch/attack-end2end-12.sh 0 mean 11 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '11', '1', '20', 'False', 'False', 'False', 'True']
Multi layer Code
bash launch/attack-end2end-12.sh 0 mean 12 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '12', '1', '20', 'False', 'False', 'False', 'True']
Multi layer Code
bash launch/attack-end2end-12.sh 0 mean 14 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '14', '1', '20', 'False', 'False', 'False', 'True']
Multi layer Code
bash launch/attack-end2end-12.sh 0 mean 15 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '15', '1', '20', 'False', 'False', 'False', 'True']
Multi layer Code
bash launch/attack-end2end-12.sh 0 mean 16 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '16', '1', '20', 'False', 'False', 'False', 'True']
Multi layer Code
bash launch/attack-end2end-12.sh 0 mean 17 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '17', '1', '20', 'False', 'False', 'False', 'True']
Multi layer Code
bash launch/attack-end2end-12.sh 0 mean 19 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '19', '1', '20', 'False', 'False', 'False', 'True']
