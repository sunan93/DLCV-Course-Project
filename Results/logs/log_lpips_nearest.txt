True False False False False
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 118 images of target 1
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=False, nearest=True, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=1, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/1/target-num-20
torch.Size([200, 1, 3, 32, 32]) torch.Size([20, 3, 32, 32])
Selected nearest neighbors: [1212, 1088, 659, 1698, 723]
Selected base image indices: [1212, 1088, 659, 1698, 723]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115]
# Targets: 20, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-10 21:26:59 Iteration 0 	 Training Loss: 7.981e-01 	 Loss in Target Net: 1.581e+00	  
tensor(-0.0002, device='cuda:0')
 2021-06-10 21:28:03 Iteration 50 	 Training Loss: 2.029e-01 	 Loss in Target Net: 6.060e-01	  
tensor(-0.0005, device='cuda:0')
 2021-06-10 21:29:10 Iteration 100 	 Training Loss: 1.699e-01 	 Loss in Target Net: 6.025e-01	  
tensor(-0.0062, device='cuda:0')
 2021-06-10 21:30:15 Iteration 150 	 Training Loss: 1.629e-01 	 Loss in Target Net: 6.126e-01	  
tensor(-0.0153, device='cuda:0')
 2021-06-10 21:31:21 Iteration 200 	 Training Loss: 1.528e-01 	 Loss in Target Net: 5.865e-01	  
tensor(-0.0242, device='cuda:0')
 2021-06-10 21:32:25 Iteration 250 	 Training Loss: 1.593e-01 	 Loss in Target Net: 6.167e-01	  
tensor(-0.0316, device='cuda:0')
 2021-06-10 21:33:30 Iteration 300 	 Training Loss: 1.466e-01 	 Loss in Target Net: 6.385e-01	  
tensor(-0.0370, device='cuda:0')
 2021-06-10 21:34:34 Iteration 350 	 Training Loss: 1.488e-01 	 Loss in Target Net: 5.763e-01	  
tensor(-0.0420, device='cuda:0')
 2021-06-10 21:35:41 Iteration 400 	 Training Loss: 1.469e-01 	 Loss in Target Net: 5.878e-01	  
tensor(-0.0444, device='cuda:0')
 2021-06-10 21:36:51 Iteration 450 	 Training Loss: 1.411e-01 	 Loss in Target Net: 5.722e-01	  
tensor(-0.0471, device='cuda:0')
 2021-06-10 21:37:57 Iteration 500 	 Training Loss: 1.425e-01 	 Loss in Target Net: 6.075e-01	  
tensor(-0.0491, device='cuda:0')
 2021-06-10 21:39:02 Iteration 550 	 Training Loss: 1.470e-01 	 Loss in Target Net: 6.090e-01	  
tensor(-0.0511, device='cuda:0')
 2021-06-10 21:40:07 Iteration 600 	 Training Loss: 1.398e-01 	 Loss in Target Net: 6.159e-01	  
tensor(-0.0532, device='cuda:0')
 2021-06-10 21:41:11 Iteration 650 	 Training Loss: 1.319e-01 	 Loss in Target Net: 6.386e-01	  
tensor(-0.0546, device='cuda:0')
 2021-06-10 21:42:16 Iteration 700 	 Training Loss: 1.424e-01 	 Loss in Target Net: 6.819e-01	  
tensor(-0.0563, device='cuda:0')
 2021-06-10 21:43:22 Iteration 750 	 Training Loss: 1.368e-01 	 Loss in Target Net: 6.099e-01	  
tensor(-0.0562, device='cuda:0')
 2021-06-10 21:44:26 Iteration 800 	 Training Loss: 1.363e-01 	 Loss in Target Net: 6.254e-01	  
tensor(-0.0562, device='cuda:0')
 2021-06-10 21:45:30 Iteration 850 	 Training Loss: 1.400e-01 	 Loss in Target Net: 6.106e-01	  
tensor(-0.0556, device='cuda:0')
 2021-06-10 21:46:34 Iteration 900 	 Training Loss: 1.361e-01 	 Loss in Target Net: 6.310e-01	  
tensor(-0.0561, device='cuda:0')
 2021-06-10 21:47:39 Iteration 950 	 Training Loss: 1.338e-01 	 Loss in Target Net: 5.883e-01	  
tensor(-0.0578, device='cuda:0')
 2021-06-10 21:48:44 Iteration 999 	 Training Loss: 1.304e-01 	 Loss in Target Net: 6.107e-01	  
tensor(-0.0605, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  659
poison index =  1698
poison index =  723
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-10 21:48:49, Val iteration 0, acc 94.200 (94.200)
2021-06-10 21:48:59, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-10 21:49:04, Epoch 0, Iteration 7, loss 0.117 (0.314), acc 96.154 (90.800)
2021-06-10 21:50:04, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-0.2983128, -0.03656987, -2.2617078, -1.0274438, -1.3001797, -2.237701, 6.4691105, -2.211393, 2.0062945, 1.0579399]
Target sample: 7, Prediction:6, Target's Score:[-1.6593894, 2.46659, -1.7938061, -1.4560612, -1.5400231, -1.629338, 5.0315323, -2.2970307, -0.19013517, 3.1876078]
Target sample: 13, Prediction:1, Target's Score:[-3.0836258, 7.517274, -1.7286289, -2.146218, -1.8604388, -1.7484791, 3.556105, -2.59027, -2.635674, 4.806773]
Target sample: 19, Prediction:1, Target's Score:[-2.2393405, 5.687577, -1.4353547, -1.0230651, -1.6499767, -1.3278226, 3.7298524, -2.146976, -1.4229188, 1.9184964]
Target sample: 25, Prediction:1, Target's Score:[-2.0380132, 6.205304, -1.8696933, -1.128203, -1.6796474, -0.78090054, 2.581063, -2.1365323, -1.2226648, 2.1463115]
Target sample: 31, Prediction:1, Target's Score:[-3.0414238, 10.1201315, -2.1357026, -2.151203, -2.1488545, -1.7195324, 3.0448284, -1.8644098, -2.3267078, 2.2946448]
Target sample: 37, Prediction:1, Target's Score:[-2.9920008, 9.902075, -2.1660223, -2.6413963, -2.1429932, -2.220804, 5.7319226, -2.2087457, -1.8545157, 0.7062501]
Target sample: 43, Prediction:6, Target's Score:[-0.68890876, 0.44579208, -2.09362, -0.98555976, -0.7665205, -2.1534014, 6.299537, -2.0091918, 1.2686261, 0.8362459]
Target sample: 49, Prediction:6, Target's Score:[-0.8321264, 1.8258623, -2.3426456, -1.096358, -0.9859397, -2.0201902, 6.696091, -2.2758267, 1.537641, -0.35418594]
Target sample: 55, Prediction:6, Target's Score:[0.17412286, 0.6787812, -2.2053876, -1.4668556, -1.4423813, -2.1950657, 8.603853, -2.6338465, 1.1266716, -0.44453758]
Target sample: 61, Prediction:1, Target's Score:[-0.9560477, 5.7434683, -0.90639144, -1.7255514, -1.6686802, -1.223434, 3.4034262, -1.8319486, -2.0565412, 1.3110222]
Target sample: 67, Prediction:6, Target's Score:[-2.4057212, 4.686551, -1.7230073, -1.1782469, -1.5702294, -1.111473, 5.0092206, -2.5212784, -1.5351249, 2.4605079]
Target sample: 73, Prediction:1, Target's Score:[-1.9106711, 4.065146, -2.0775201, -0.6323937, -1.6776035, -1.257771, 3.863971, -1.9788916, 0.14463302, 1.5633883]
Target sample: 79, Prediction:1, Target's Score:[-2.2842898, 7.265634, -1.7380184, -0.9063987, -1.7789292, -0.76036555, 2.311458, -1.91998, -1.9182075, 1.7994077]
Target sample: 85, Prediction:1, Target's Score:[-2.0531425, 6.510628, -1.3073545, -1.6334784, -2.1830308, -0.96265763, 3.4157958, -2.2765038, -1.7690701, 2.3538527]
Target sample: 91, Prediction:1, Target's Score:[-2.8113654, 6.196174, -1.7522703, -1.8744878, -2.0676305, -1.4988889, 4.4366326, -2.4567506, -2.1875813, 4.1200514]
Target sample: 97, Prediction:1, Target's Score:[-1.3049234, 4.660847, -1.4211684, -1.6671467, -1.5718887, -0.3136448, 3.0098808, -1.8883541, -1.9807667, 2.5663533]
Target sample: 103, Prediction:6, Target's Score:[-0.6202622, 0.78157216, -2.3576543, -1.0355958, -1.5871747, -1.1672742, 6.25732, -1.8778, 1.7486339, 0.013643926]
Target sample: 109, Prediction:6, Target's Score:[-1.2528249, 2.657015, -2.3945901, -1.1862295, -1.4121212, -2.211885, 5.7429457, -2.2601964, 1.5989829, 0.8545224]
Target sample: 115, Prediction:6, Target's Score:[0.7536749, -1.10455, -1.8267659, -1.4074382, -1.011822, -2.0394337, 6.08604, -2.3839424, 1.0465213, 2.0443387]
Current ATTACK acc on target samples: 45.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-10 21:51:03 Epoch 59, Val iteration 0, acc 90.600 (90.600)
2021-06-10 21:51:13 Epoch 59, Val iteration 19, acc 90.800 (89.440)
* Prec: 89.44000091552735
Per class accuracy =  [0.93250956 0.92910881 0.80870708 0.78417238 0.8844623  0.84425728
 0.96653592 0.90950258 0.93763059 0.94674305]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 8, 6, 6
ATTACK acc: 37.755102040816325
--------
DPN92
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  659
poison index =  1698
poison index =  723
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-10 21:51:25, Val iteration 0, acc 94.800 (94.800)
2021-06-10 21:51:45, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-10 21:51:59, Epoch 0, Iteration 7, loss 0.214 (0.395), acc 92.308 (91.600)
2021-06-10 21:54:37, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[3.7599165, 1.9266363, -2.727411, -4.035978, -3.0479102, -4.7441707, 7.7973914, -3.1002398, 3.2724483, 1.3163308]
Target sample: 7, Prediction:6, Target's Score:[0.83771235, 2.534005, -1.8658831, -3.7842028, -1.8283281, -4.048805, 10.412199, -2.3209627, 0.4588999, -0.008505286]
Target sample: 13, Prediction:1, Target's Score:[0.017459812, 9.1566, -1.7443858, -3.6777184, -2.7946465, -3.51798, 6.2979774, -1.9392365, -0.7388184, -0.58025557]
Target sample: 19, Prediction:1, Target's Score:[0.28936285, 8.420904, -1.9971067, -2.5055094, -2.706716, -4.1172347, 5.125592, -2.3927531, 0.47035608, -0.12382969]
Target sample: 25, Prediction:1, Target's Score:[0.114477195, 7.677723, -2.135541, -3.2566504, -2.4578526, -2.7706978, 5.697555, -3.129949, 0.27044246, 0.4204022]
Target sample: 31, Prediction:1, Target's Score:[1.7628229, 8.883857, -2.069518, -3.583844, -2.7177472, -2.962493, 4.5989404, -2.8636775, -1.1506735, 0.5727114]
Target sample: 37, Prediction:6, Target's Score:[2.7579892, 6.7737136, -1.6816585, -4.074625, -2.3895147, -3.4495797, 7.6911263, -2.6233888, -1.5259871, -1.0153688]
Target sample: 43, Prediction:6, Target's Score:[1.9853688, -0.2842657, -3.001524, -2.803299, -0.87182033, -4.4470654, 9.141228, -1.8615481, 3.1124332, -0.6301912]
Target sample: 49, Prediction:6, Target's Score:[-0.40513507, 2.1186042, -2.229737, -2.8268917, -2.303213, -4.0731945, 12.193781, -3.5871432, 2.0266597, -0.5218295]
Target sample: 55, Prediction:6, Target's Score:[2.1419775, 1.2039021, -2.1755946, -3.6275783, -2.081686, -4.8657885, 12.390564, -3.0710533, 2.5240624, -2.033565]
Target sample: 61, Prediction:6, Target's Score:[-0.08159357, 6.389077, -1.398663, -3.5652292, -1.74574, -2.9476557, 8.4178, -3.1480725, -1.2020053, -0.3053946]
Target sample: 67, Prediction:6, Target's Score:[-0.060351267, 5.760776, -1.6307498, -3.6524565, -2.6302714, -3.2579887, 7.7853737, -2.795636, -0.80465865, 1.703162]
Target sample: 73, Prediction:6, Target's Score:[1.2668481, 2.791915, -2.2240348, -3.326404, -2.1388469, -4.040345, 8.536085, -1.5271173, 1.853713, -0.81829435]
Target sample: 79, Prediction:1, Target's Score:[-0.33273336, 8.765846, -1.8962395, -3.5716033, -1.6852181, -2.704179, 4.549105, -3.5614002, 0.35388568, 0.5317569]
Target sample: 85, Prediction:1, Target's Score:[2.1938052, 8.617928, -1.5403638, -3.91365, -3.146897, -2.6929379, 5.230953, -3.6291356, -1.0627586, 0.45485622]
Target sample: 91, Prediction:1, Target's Score:[0.5426925, 9.060214, -1.5550913, -4.135473, -2.4414816, -3.2220347, 5.913825, -3.1035368, -1.4108796, 0.8348184]
Target sample: 97, Prediction:1, Target's Score:[3.095705, 6.6804266, -2.1047945, -4.046369, -2.300814, -3.1252913, 3.2649336, -1.3782761, -0.5224003, 0.8688926]
Target sample: 103, Prediction:6, Target's Score:[2.576504, -0.26423553, -2.6507504, -3.714804, -2.2439318, -3.9505363, 8.296086, -0.17955741, 2.1927323, 0.2826522]
Target sample: 109, Prediction:6, Target's Score:[2.7184522, 3.7479427, -2.8523712, -3.7212934, -3.0111763, -4.4993443, 8.768191, -3.42876, 3.0143123, -0.31210262]
Target sample: 115, Prediction:6, Target's Score:[0.623837, 1.6595553, -2.7454588, -3.479624, -2.6804008, -4.1733522, 9.177688, -3.1316485, 3.428673, 1.7041467]
Current ATTACK acc on target samples: 60.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-10 21:57:12 Epoch 59, Val iteration 0, acc 92.800 (92.800)
2021-06-10 21:57:33 Epoch 59, Val iteration 19, acc 92.400 (92.590)
* Prec: 92.59000205993652
Per class accuracy =  [0.93331093 0.9635266  0.88520867 0.85032305 0.94871455 0.89149186
 0.93130664 0.93110123 0.97122959 0.95143682]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 1, 1, 1, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 6, 1, 6, 1, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 6, 6
ATTACK acc: 56.12244897959184
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  659
poison index =  1698
poison index =  723
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-10 21:57:36, Val iteration 0, acc 92.600 (92.600)
2021-06-10 21:57:42, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-10 21:57:44, Epoch 0, Iteration 7, loss 0.484 (0.348), acc 84.615 (89.600)
2021-06-10 21:58:12, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:9, Target's Score:[-1.6175075, 1.54625, -2.842167, 4.648316, 0.121195, -3.5754118, 4.095836, -3.7809732, -4.4972672, 6.1532507]
Target sample: 7, Prediction:1, Target's Score:[-0.7727392, 7.6628556, -3.319099, -2.2308826, -2.7567186, -3.1782794, 3.3007255, -0.16188186, -3.1776507, 4.8879747]
Target sample: 13, Prediction:1, Target's Score:[-3.3559728, 13.552881, -1.7988845, -3.2044706, -2.803864, 0.09550838, 1.2060118, -2.2628913, -2.323439, 1.2750318]
Target sample: 19, Prediction:1, Target's Score:[-3.291289, 12.810729, -3.5178385, -0.8572043, 0.984173, -2.3565905, 1.2373601, -2.1496677, -3.5079215, 1.0500236]
Target sample: 25, Prediction:1, Target's Score:[-2.1679006, 13.275066, -3.8733716, -1.7189306, -1.2823341, -1.344219, -0.35819626, -3.1195967, -1.6319855, 2.582772]
Target sample: 31, Prediction:1, Target's Score:[-2.7090437, 13.41462, -4.2488766, -2.2591178, -1.5453144, -1.6916331, 2.571622, -1.7297037, -2.581859, 1.130736]
Target sample: 37, Prediction:1, Target's Score:[-1.4428189, 12.748587, -3.3780844, -1.7361373, -3.707634, -2.7794235, 5.4602065, -4.249292, -3.6279445, 3.0157456]
Target sample: 43, Prediction:6, Target's Score:[-1.6656617, 4.397043, -4.3779707, -0.16145954, 1.5717609, -4.574633, 6.883605, -2.189465, -1.7375283, 2.1193318]
Target sample: 49, Prediction:6, Target's Score:[-2.132531, 7.096447, -2.9052417, -0.8040111, -1.8453481, -2.9881938, 8.243686, -4.3757854, -2.7650497, 2.740801]
Target sample: 55, Prediction:6, Target's Score:[-0.09320232, 6.9745913, -3.9729664, -0.897421, -1.9354813, -4.589498, 8.250834, -5.198645, 2.555835, -0.8287607]
Target sample: 61, Prediction:1, Target's Score:[0.4464486, 9.548029, -2.5688932, -1.2238739, -2.6806011, -2.9739919, 3.6810694, -2.9504466, -3.397114, 2.3633096]
Target sample: 67, Prediction:1, Target's Score:[-2.1264133, 12.170715, -4.030758, -0.9110855, -3.6090386, -1.7098342, 3.7306187, -4.7239547, -0.9526081, 2.4707053]
Target sample: 73, Prediction:1, Target's Score:[-2.0700212, 10.045492, -4.3940125, 0.17854598, -0.5059956, -2.831241, 3.3775911, -4.04919, -0.069355145, 0.6185515]
Target sample: 79, Prediction:1, Target's Score:[-1.69604, 11.724129, -2.3819146, -0.23185962, -0.039186344, -2.9129465, 0.44628987, -3.1349638, -3.002019, 1.5799307]
Target sample: 85, Prediction:1, Target's Score:[-1.9647831, 13.802211, -2.7361362, -1.1507884, -4.468336, -1.4388318, 2.5496898, -4.847879, -3.626623, 4.215413]
Target sample: 91, Prediction:1, Target's Score:[-2.090086, 11.001774, -2.8724713, -2.5279267, -2.9206333, -1.7224057, 5.1264105, -3.1132216, -2.320415, 1.736775]
Target sample: 97, Prediction:1, Target's Score:[0.5038951, 6.909719, -3.0688276, -2.323198, -1.1338592, -3.46268, 3.606165, -0.25523967, -3.800907, 3.246863]
Target sample: 103, Prediction:6, Target's Score:[0.1948714, 0.35753495, -1.2120671, -0.66435134, 2.4883409, -4.3641686, 7.4680467, -1.52628, -4.8351436, 2.298452]
Target sample: 109, Prediction:6, Target's Score:[-2.8299875, 6.6325693, -5.1779323, 1.1053262, -2.262877, -3.5601447, 7.698849, -3.1457806, -2.7188642, 4.5332756]
Target sample: 115, Prediction:9, Target's Score:[-2.5983431, -0.94534254, -3.5697315, 0.40777484, 0.8869543, -4.941448, 6.248193, -1.8604577, -0.983775, 7.593916]
Current ATTACK acc on target samples: 25.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-10 21:58:39 Epoch 59, Val iteration 0, acc 89.200 (89.200)
2021-06-10 21:58:45 Epoch 59, Val iteration 19, acc 90.400 (89.310)
* Prec: 89.31000175476075
Per class accuracy =  [0.92099529 0.93082837 0.84223554 0.81561884 0.88997093 0.82820739
 0.93255588 0.88894817 0.93283825 0.94500669]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 9, 9, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 9, 6, 6, 9, 9, 9, 9, 6, 9, 9, 9
ATTACK acc: 26.53061224489796
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  659
poison index =  1698
poison index =  723
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-10 21:58:52, Val iteration 0, acc 96.200 (96.200)
2021-06-10 21:59:05, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-10 21:59:11, Epoch 0, Iteration 7, loss 0.699 (0.853), acc 75.000 (77.600)
2021-06-10 22:00:22, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:0, Target's Score:[6.2039475, -0.6693901, -0.17988554, -1.6590985, -0.5359333, -5.4637027, 2.1102765, -2.8488183, 0.8324002, 2.2490892]
Target sample: 7, Prediction:6, Target's Score:[5.6459136, 0.07927218, -2.1231844, -2.761115, -2.7382014, -4.659109, 7.3422375, 1.2630676, -2.4338088, 0.3642875]
Target sample: 13, Prediction:1, Target's Score:[-1.1285431, 7.8575478, -2.0695884, -0.95332855, -1.9407166, -3.5870273, 2.638613, -2.446159, -3.299198, 4.9376464]
Target sample: 19, Prediction:1, Target's Score:[-1.5495086, 11.354674, -2.1722038, 0.067144476, -2.9994287, -5.4832077, 2.855683, -0.75116336, -3.0225184, 1.692621]
Target sample: 25, Prediction:1, Target's Score:[-0.5848632, 10.826276, -2.741882, 0.8873816, -2.9366813, -4.7360725, 1.349588, -2.6164627, -2.1962285, 2.7515016]
Target sample: 31, Prediction:1, Target's Score:[-0.96323204, 9.475026, -2.9192512, 0.85319513, -3.510605, -4.051297, 0.8198556, -2.439915, -2.5080886, 5.257361]
Target sample: 37, Prediction:1, Target's Score:[1.1757498, 6.7462893, -1.4462686, -0.33939645, -3.5756319, -3.9790924, 4.3933287, -0.8287711, -2.2836657, 0.12514412]
Target sample: 43, Prediction:6, Target's Score:[3.9803588, -2.6587758, -2.3753476, -0.8781513, -3.3610408, -4.492339, 9.974699, -0.13333386, 3.6861126, -3.768511]
Target sample: 49, Prediction:6, Target's Score:[2.4814963, 0.30263668, -2.3547516, -0.54697025, -1.5179242, -4.500542, 10.006763, -2.2481344, 0.6219478, -2.2712886]
Target sample: 55, Prediction:6, Target's Score:[4.3835626, -1.9727235, -1.3769783, -1.1348788, -1.9949644, -4.4393024, 11.012122, -1.928657, 1.208161, -3.7822597]
Target sample: 61, Prediction:6, Target's Score:[1.1834494, 3.5527406, -0.7452158, -1.0251669, -2.411902, -3.8688996, 4.4162498, 0.9647393, -2.4643834, 0.38663077]
Target sample: 67, Prediction:6, Target's Score:[1.3935905, 5.03368, -2.0901434, 0.24031857, -2.522235, -4.646408, 5.8445654, -1.5084406, -2.5774767, 0.8166486]
Target sample: 73, Prediction:1, Target's Score:[2.1271799, 6.4578533, -3.0741422, 0.15220311, -2.4788258, -5.01514, 2.8964937, -1.0441519, -1.9968828, 1.9724346]
Target sample: 79, Prediction:1, Target's Score:[-0.52115846, 9.779327, -3.1825252, 1.5583874, -4.1223574, -3.7241955, 0.57685316, -2.3091934, -2.7823696, 4.735445]
Target sample: 85, Prediction:1, Target's Score:[0.12428562, 8.818312, -1.8247325, -0.4737099, -3.2059507, -2.5164678, 2.2426329, -3.8571136, -2.866287, 3.5663974]
Target sample: 91, Prediction:1, Target's Score:[1.4491965, 5.2701054, -2.5437932, -1.5624663, -0.9842712, -4.8579683, 4.348254, -1.4046752, -1.7639695, 2.0416048]
Target sample: 97, Prediction:1, Target's Score:[0.49565503, 7.638431, -3.0964086, -3.0500927, -3.3105314, -3.6804595, 2.9871917, 1.1828837, 0.053882398, 0.7666286]
Target sample: 103, Prediction:0, Target's Score:[6.073384, -2.3822222, -2.503227, -2.2209427, -4.5349956, 1.1673104, 5.60536, 0.1068352, 1.6755744, -3.0112991]
Target sample: 109, Prediction:0, Target's Score:[5.2309446, 2.2546854, -1.8770612, -1.2735279, -1.4875741, -5.471578, 0.9939767, -2.3312001, 0.9884498, 3.0064585]
Target sample: 115, Prediction:0, Target's Score:[6.1145735, 0.06291184, -1.9214078, -1.3638929, -1.6035353, -5.9442716, 3.2749557, 0.121944144, -0.29379246, 1.564618]
Current ATTACK acc on target samples: 30.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-10 22:01:31 Epoch 59, Val iteration 0, acc 90.800 (90.800)
2021-06-10 22:01:44 Epoch 59, Val iteration 19, acc 91.800 (91.870)
* Prec: 91.8700023651123
Per class accuracy =  [0.95027831 0.94000129 0.82541091 0.85441149 0.95116211 0.88356109
 0.95410588 0.92882698 0.94294091 0.95107898]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 0, 0, 0, 0, 0, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 6, 0, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 0, 6, 0, 0, 0, 0, 9, 0, 0, 0, 0, 0, 0
ATTACK acc: 25.510204081632654
--------
------SUMMARY------
TIME ELAPSED (mins): 21
TARGET INDEX: 1
ResNet50 45.0 37.755102040816325 95.46000137329102 89.44000091552735
DPN92 60.0 56.12244897959184 95.50000267028808 92.59000205993652
MobileNetV2 25.0 26.53061224489796 91.22000160217286 89.31000175476075
GoogLeNet 30.0 25.510204081632654 95.41000213623047 91.8700023651123
True False False False True
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 118 images of target 1
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=True, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=1, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/1/target-num-20
torch.Size([200, 1, 3, 32, 32]) torch.Size([20, 3, 32, 32])
Selected nearest neighbors: [1212, 1088, 659, 1698, 723]
Selected base image indices: [1212, 1088, 659, 1698, 723]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115]
# Targets: 20, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-10 22:02:23 Iteration 0 	 Training Loss: 7.761e-01 	 Loss in Target Net: 8.428e-01	  
tensor(-0.0008, device='cuda:0')
 2021-06-10 22:03:33 Iteration 50 	 Training Loss: 3.713e-01 	 Loss in Target Net: 4.345e-01	  
tensor(-0.0151, device='cuda:0')
 2021-06-10 22:04:42 Iteration 100 	 Training Loss: 3.315e-01 	 Loss in Target Net: 4.235e-01	  
tensor(-0.0294, device='cuda:0')
 2021-06-10 22:05:52 Iteration 150 	 Training Loss: 3.105e-01 	 Loss in Target Net: 4.066e-01	  
tensor(-0.0424, device='cuda:0')
 2021-06-10 22:07:02 Iteration 200 	 Training Loss: 2.979e-01 	 Loss in Target Net: 4.041e-01	  
tensor(-0.0524, device='cuda:0')
 2021-06-10 22:08:14 Iteration 250 	 Training Loss: 2.902e-01 	 Loss in Target Net: 3.718e-01	  
tensor(-0.0583, device='cuda:0')
 2021-06-10 22:09:24 Iteration 300 	 Training Loss: 2.880e-01 	 Loss in Target Net: 3.817e-01	  
tensor(-0.0621, device='cuda:0')
 2021-06-10 22:10:34 Iteration 350 	 Training Loss: 2.855e-01 	 Loss in Target Net: 3.612e-01	  
tensor(-0.0632, device='cuda:0')
 2021-06-10 22:11:44 Iteration 400 	 Training Loss: 2.868e-01 	 Loss in Target Net: 3.796e-01	  
tensor(-0.0658, device='cuda:0')
 2021-06-10 22:12:54 Iteration 450 	 Training Loss: 2.832e-01 	 Loss in Target Net: 3.765e-01	  
tensor(-0.0667, device='cuda:0')
 2021-06-10 22:14:04 Iteration 500 	 Training Loss: 2.845e-01 	 Loss in Target Net: 4.118e-01	  
tensor(-0.0673, device='cuda:0')
 2021-06-10 22:15:15 Iteration 550 	 Training Loss: 2.854e-01 	 Loss in Target Net: 3.737e-01	  
tensor(-0.0670, device='cuda:0')
 2021-06-10 22:16:25 Iteration 600 	 Training Loss: 2.804e-01 	 Loss in Target Net: 3.970e-01	  
tensor(-0.0687, device='cuda:0')
 2021-06-10 22:17:36 Iteration 650 	 Training Loss: 2.856e-01 	 Loss in Target Net: 4.049e-01	  
tensor(-0.0693, device='cuda:0')
 2021-06-10 22:18:50 Iteration 700 	 Training Loss: 2.821e-01 	 Loss in Target Net: 4.463e-01	  
tensor(-0.0697, device='cuda:0')
 2021-06-10 22:20:02 Iteration 750 	 Training Loss: 2.878e-01 	 Loss in Target Net: 3.989e-01	  
tensor(-0.0690, device='cuda:0')
 2021-06-10 22:21:13 Iteration 800 	 Training Loss: 2.804e-01 	 Loss in Target Net: 4.547e-01	  
tensor(-0.0695, device='cuda:0')
 2021-06-10 22:22:26 Iteration 850 	 Training Loss: 2.798e-01 	 Loss in Target Net: 3.851e-01	  
tensor(-0.0686, device='cuda:0')
 2021-06-10 22:23:38 Iteration 900 	 Training Loss: 2.777e-01 	 Loss in Target Net: 3.788e-01	  
tensor(-0.0676, device='cuda:0')
 2021-06-10 22:24:52 Iteration 950 	 Training Loss: 2.824e-01 	 Loss in Target Net: 3.744e-01	  
tensor(-0.0680, device='cuda:0')
 2021-06-10 22:26:04 Iteration 999 	 Training Loss: 2.807e-01 	 Loss in Target Net: 3.868e-01	  
tensor(-0.0678, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  659
poison index =  1698
poison index =  723
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-10 22:26:09, Val iteration 0, acc 94.200 (94.200)
2021-06-10 22:26:19, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-10 22:26:24, Epoch 0, Iteration 7, loss 0.319 (0.471), acc 90.385 (88.800)
2021-06-10 22:27:24, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-0.07478034, 0.30933863, -1.3613206, -2.6314006, -1.3790104, -3.3629248, 7.2072525, -2.1252089, 0.01992625, 3.3351731]
Target sample: 7, Prediction:6, Target's Score:[-2.042832, 4.610033, -1.6551888, -3.1042266, -1.5661011, -2.9055405, 7.8263993, -1.8709981, -1.0216973, 1.6120608]
Target sample: 13, Prediction:1, Target's Score:[-3.8552556, 9.977407, -1.2727815, -2.3037953, -2.3626194, -3.3424292, 7.9999776, -2.7274601, -2.2348225, -0.05418472]
Target sample: 19, Prediction:6, Target's Score:[-2.8239868, 4.592904, -0.5588871, -1.5199431, -0.7478537, -2.6578417, 8.0652895, -2.2950811, -0.26122302, -1.8863735]
Target sample: 25, Prediction:6, Target's Score:[-2.8399532, 5.28352, -1.5478925, -1.9801873, -1.4498568, -2.5725634, 6.553822, -2.0271106, 0.7358146, -0.2528377]
Target sample: 31, Prediction:1, Target's Score:[-3.529863, 8.6479025, -1.6261628, -2.4280035, -2.2010067, -2.9996696, 7.010721, -1.7479309, -1.3242282, 0.042174764]
Target sample: 37, Prediction:1, Target's Score:[-2.5776584, 9.158749, -1.3177192, -2.1561577, -2.1686006, -3.4920218, 8.729939, -2.134024, -1.7335556, -2.4762735]
Target sample: 43, Prediction:6, Target's Score:[-0.2520143, 1.2443044, -1.9692214, -1.5708597, -0.62435055, -3.4584422, 7.696393, -0.7927284, 0.442477, -0.77785504]
Target sample: 49, Prediction:6, Target's Score:[-0.29048666, 1.1003202, -1.7595445, -1.870374, -0.97038215, -3.396233, 8.950432, -1.8868101, 1.2611059, -1.1843479]
Target sample: 55, Prediction:6, Target's Score:[0.86807704, 0.48611462, -1.5375214, -3.0808005, -1.4782166, -3.8558872, 9.326616, -2.3441546, 2.7153864, -1.1506032]
Target sample: 61, Prediction:6, Target's Score:[-0.8386497, 5.1465936, -0.5226617, -1.7052205, -1.3719728, -2.859699, 7.548431, -1.8242778, -2.218069, -1.4655343]
Target sample: 67, Prediction:6, Target's Score:[-2.987854, 6.6084604, -1.0601382, -2.4830794, -1.7903535, -3.1276808, 9.363592, -2.5474503, -1.8495177, -0.2538101]
Target sample: 73, Prediction:6, Target's Score:[-1.9178799, 4.2586493, -1.5586897, -2.7480881, -1.2595909, -2.8349142, 7.9283166, -1.6559912, 1.6087372, -1.9132049]
Target sample: 79, Prediction:6, Target's Score:[-2.7332025, 5.1137547, -1.6593988, -2.3227484, -1.0615389, -2.6257157, 6.574, -1.6760001, 1.2390531, -0.95446175]
Target sample: 85, Prediction:1, Target's Score:[-2.4878008, 7.4440513, -0.9995301, -2.0702841, -1.8053734, -2.654291, 7.1170163, -2.1439755, -1.1065799, -1.4265119]
Target sample: 91, Prediction:6, Target's Score:[-3.1607444, 6.3682423, -0.7412585, -2.6001947, -1.149408, -3.0304585, 8.629677, -1.985362, -1.9437969, -0.5226559]
Target sample: 97, Prediction:1, Target's Score:[-1.4344825, 6.7337637, -1.192422, -2.2538128, -1.5805486, -2.4109883, 6.3201513, -1.7438809, -1.7969311, -0.7704683]
Target sample: 103, Prediction:6, Target's Score:[-0.77882093, 2.3872862, -1.902196, -2.5076232, -1.6142793, -2.5431144, 7.7633686, -0.7956167, 0.260588, -0.3430465]
Target sample: 109, Prediction:6, Target's Score:[-0.66597027, 2.1180093, -1.7393178, -2.696665, -1.4656968, -3.5066175, 8.280858, -2.2712648, 1.7316096, 0.15221837]
Target sample: 115, Prediction:6, Target's Score:[1.1581229, -0.010197679, -1.55103, -3.16129, -1.4047283, -3.561083, 7.5932493, -2.361094, 1.3995283, 1.8400483]
Current ATTACK acc on target samples: 75.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-10 22:28:23 Epoch 59, Val iteration 0, acc 90.000 (90.000)
2021-06-10 22:28:33 Epoch 59, Val iteration 19, acc 91.000 (91.290)
* Prec: 91.2900016784668
Per class accuracy =  [0.91995748 0.96400542 0.85092108 0.82692345 0.94961979 0.85553983
 0.96446116 0.91431577 0.94882503 0.93194319]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 78.57142857142857
--------
DPN92
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  659
poison index =  1698
poison index =  723
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-10 22:28:45, Val iteration 0, acc 94.800 (94.800)
2021-06-10 22:29:06, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-10 22:29:20, Epoch 0, Iteration 7, loss 0.101 (0.381), acc 98.077 (91.800)
2021-06-10 22:31:58, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[0.9406663, 2.3653202, -2.895895, -2.8707514, -1.2305273, -4.5389876, 8.656007, -3.027546, 1.0928483, 2.025792]
Target sample: 7, Prediction:6, Target's Score:[1.6404833, 0.6533366, -2.0017934, -2.7456498, 0.13198549, -4.0618606, 10.18242, -0.95296115, -1.2067276, -1.1538686]
Target sample: 13, Prediction:1, Target's Score:[-0.8137182, 8.080204, -2.6003494, -2.5032763, -1.4853357, -3.773791, 4.249517, -0.74135995, -0.1265367, 0.2727512]
Target sample: 19, Prediction:1, Target's Score:[-1.1117038, 7.845392, -3.5902529, -1.2975726, -2.3427773, -3.8855267, 2.1106944, -0.033317663, 2.38394, 0.46331343]
Target sample: 25, Prediction:1, Target's Score:[-0.75846255, 7.659564, -3.4531686, -1.7759715, -2.0075939, -3.7346957, 3.3366075, -1.7128439, 2.3371902, 0.6333756]
Target sample: 31, Prediction:1, Target's Score:[0.6606509, 9.506786, -2.9200408, -2.0324674, -2.1310997, -3.5866625, 2.1834252, -2.2042186, -0.36928472, 1.4498445]
Target sample: 37, Prediction:1, Target's Score:[2.0737543, 8.960571, -2.8957944, -2.687296, -1.9224951, -4.3218045, 4.5225573, -1.8679762, -1.7556293, 0.4969107]
Target sample: 43, Prediction:6, Target's Score:[0.10592245, -1.5587833, -3.3334978, -0.98205245, 2.1225045, -3.6177642, 9.515085, -0.5132604, 1.0064915, -2.3078713]
Target sample: 49, Prediction:6, Target's Score:[-1.1212184, 1.0642424, -2.4253774, -1.1140362, -0.32979062, -3.8953469, 11.445969, -3.0902584, 0.17784816, -0.20382772]
Target sample: 55, Prediction:6, Target's Score:[1.5097734, -0.8243355, -1.4413288, -2.5657225, 0.34789485, -4.4039183, 13.767042, -2.3027916, -0.9731545, -2.6102092]
Target sample: 61, Prediction:1, Target's Score:[-0.10446196, 6.0667043, -2.1227715, -1.9897755, -0.6489919, -3.094437, 5.359231, -1.8939471, -1.2760655, 0.19619337]
Target sample: 67, Prediction:1, Target's Score:[-1.0119298, 6.9685783, -2.6023977, -1.7442073, -1.2423245, -3.967471, 5.1414685, -2.1657624, -0.21396178, 1.3850633]
Target sample: 73, Prediction:6, Target's Score:[-0.08954109, 2.2983465, -3.614716, -1.5803097, -0.5343628, -3.888678, 4.872202, 0.71376604, 4.078375, -1.8231751]
Target sample: 79, Prediction:1, Target's Score:[-1.1841284, 8.531577, -3.3790793, -1.7373394, -1.4160038, -3.7476132, 2.610248, -1.9411341, 2.2014446, 0.6023809]
Target sample: 85, Prediction:1, Target's Score:[0.1974292, 9.073211, -3.0337002, -2.0455217, -2.6714764, -3.7562711, 3.574372, -2.3795373, 0.58717245, 1.0173941]
Target sample: 91, Prediction:1, Target's Score:[-0.22216082, 7.805303, -2.0064359, -3.1465578, -0.92900157, -3.6363685, 4.2659097, -2.216272, -0.27307767, 0.9210812]
Target sample: 97, Prediction:1, Target's Score:[0.29821473, 7.3048406, -4.054498, -1.7923958, -1.8392012, -3.3231242, 1.7932732, 0.73295265, 1.2763561, 0.112133496]
Target sample: 103, Prediction:6, Target's Score:[1.502801, -0.9933715, -2.4873414, -2.2117014, 0.21673785, -3.9960945, 9.838675, 0.3144714, 0.3045149, -2.0456161]
Target sample: 109, Prediction:6, Target's Score:[0.34605384, 2.8958066, -2.9004593, -2.2111616, -1.0096085, -4.209186, 8.518794, -2.801266, 1.1954975, 0.67003864]
Target sample: 115, Prediction:6, Target's Score:[-0.24730329, 0.9323962, -2.762908, -2.7517095, -0.50647795, -4.0741587, 8.634372, -2.7247655, 1.7697875, 2.2221086]
Current ATTACK acc on target samples: 45.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-10 22:34:33 Epoch 59, Val iteration 0, acc 93.200 (93.200)
2021-06-10 22:34:54 Epoch 59, Val iteration 19, acc 91.600 (92.650)
* Prec: 92.65000190734864
Per class accuracy =  [0.94508673 0.96838026 0.90397402 0.86724269 0.90986069 0.87534947
 0.92972566 0.94108222 0.96698349 0.95516667]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 43.87755102040816
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  659
poison index =  1698
poison index =  723
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-10 22:34:58, Val iteration 0, acc 92.600 (92.600)
2021-06-10 22:35:03, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-10 22:35:06, Epoch 0, Iteration 7, loss 0.277 (0.362), acc 88.462 (90.200)
2021-06-10 22:35:33, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:9, Target's Score:[-1.2103812, 0.9473484, -2.678157, 4.201019, -0.8674943, -3.339517, 4.924686, -4.247109, -4.8316097, 7.3003964]
Target sample: 7, Prediction:1, Target's Score:[-0.70969784, 6.4379325, -3.2772899, -1.6389896, -2.5535703, -2.903728, 4.1771803, -0.39195782, -3.4147155, 4.4802966]
Target sample: 13, Prediction:1, Target's Score:[-3.022546, 10.962924, -1.0058955, -2.5333273, -2.764687, -0.41558236, 4.1009107, -2.7959242, -2.8085604, 0.54545313]
Target sample: 19, Prediction:1, Target's Score:[-2.4397974, 11.498542, -3.468208, -0.8813083, 0.51852816, -2.339922, 2.5450327, -2.587724, -3.407795, 0.85053533]
Target sample: 25, Prediction:1, Target's Score:[-1.9509283, 11.828679, -3.3084319, -1.464005, -2.153548, -1.2657348, 1.7326986, -3.610518, -1.6430829, 2.0849435]
Target sample: 31, Prediction:1, Target's Score:[-2.9252138, 11.075983, -3.7338772, -1.416698, -1.823723, -1.420483, 4.966748, -2.486298, -2.5375, 0.55209625]
Target sample: 37, Prediction:1, Target's Score:[-1.6851996, 9.886724, -2.9158127, -1.2545041, -2.8916328, -2.6282625, 8.026788, -4.492401, -3.9546273, 2.1400106]
Target sample: 43, Prediction:6, Target's Score:[-1.3956012, 3.242417, -3.9900422, 0.6109359, 0.42951787, -3.8122563, 8.2064495, -3.038155, -1.9912946, 1.9552602]
Target sample: 49, Prediction:6, Target's Score:[-2.311526, 5.951779, -2.6811936, -0.104665756, -1.9885391, -2.56104, 9.821574, -5.0427966, -3.2664917, 2.411147]
Target sample: 55, Prediction:6, Target's Score:[-0.01588986, 5.389749, -4.1900625, -0.16970989, -1.8255804, -4.207188, 9.559788, -5.2784023, 2.1881971, -1.2167525]
Target sample: 61, Prediction:1, Target's Score:[0.49210766, 8.545159, -2.4245481, -0.9308034, -3.139528, -2.7270741, 4.984922, -3.2127814, -3.442162, 2.049838]
Target sample: 67, Prediction:1, Target's Score:[-1.944389, 9.668277, -3.3926992, -0.1290566, -3.9783525, -1.5250386, 6.5183473, -5.2894254, -1.755119, 2.0467272]
Target sample: 73, Prediction:1, Target's Score:[-2.1017883, 7.7184896, -3.663512, 0.48717624, -1.0914409, -2.493432, 5.6883235, -4.384448, -0.124344796, 0.1805065]
Target sample: 79, Prediction:1, Target's Score:[-1.9765745, 10.911509, -2.5804849, -0.09354615, -1.637155, -2.2262573, 2.5955613, -3.6735168, -2.6751997, 1.6039338]
Target sample: 85, Prediction:1, Target's Score:[-1.7756736, 11.860862, -2.418063, -0.9648893, -4.7483687, -1.1204396, 4.728363, -5.1730604, -3.7258074, 3.5723786]
Target sample: 91, Prediction:1, Target's Score:[-1.8833474, 8.218291, -2.3791158, -1.7479093, -2.782551, -1.6018679, 7.527189, -3.5122623, -2.644486, 1.0248188]
Target sample: 97, Prediction:1, Target's Score:[-0.069103755, 5.2632565, -2.7459986, -2.0475702, -0.8272921, -2.9544673, 5.01438, -0.24654663, -3.7187414, 2.5157118]
Target sample: 103, Prediction:6, Target's Score:[0.118717276, 0.33921486, -1.217525, -0.16087884, 0.786631, -3.4547439, 8.5809145, -2.027448, -4.6793337, 1.8991209]
Target sample: 109, Prediction:6, Target's Score:[-2.4104931, 6.373053, -5.202293, 1.3647933, -2.7858598, -3.0993838, 8.161495, -3.59924, -3.1280453, 4.5528054]
Target sample: 115, Prediction:6, Target's Score:[-2.7859385, -2.0257626, -3.2643862, 0.71886075, 1.3791698, -4.423767, 6.88119, -1.5505633, -1.2148744, 6.4966726]
Current ATTACK acc on target samples: 30.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-10 22:36:01 Epoch 59, Val iteration 0, acc 89.000 (89.000)
2021-06-10 22:36:07 Epoch 59, Val iteration 19, acc 90.800 (89.390)
* Prec: 89.39000129699707
Per class accuracy =  [0.92535181 0.92688644 0.84629894 0.82137655 0.89470718 0.82145604
 0.93232131 0.8898227  0.92867188 0.94679357]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 9, 9, 9, 9, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 9, 6, 6, 9, 9, 9, 9, 6, 9, 9, 9
ATTACK acc: 31.632653061224488
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  659
poison index =  1698
poison index =  723
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-10 22:36:14, Val iteration 0, acc 96.200 (96.200)
2021-06-10 22:36:26, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-10 22:36:33, Epoch 0, Iteration 7, loss 0.525 (0.517), acc 80.769 (86.600)
2021-06-10 22:37:44, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:0, Target's Score:[5.0604978, -0.9438985, -2.8414357, -2.704862, -0.9747507, -3.6370208, 3.9609623, -1.7912449, 0.53224397, 3.425718]
Target sample: 7, Prediction:6, Target's Score:[2.4802287, 0.5937813, -1.7351497, -1.2257657, -2.8266742, -3.5076208, 7.7379293, 1.2323936, -1.6093135, -1.0838636]
Target sample: 13, Prediction:6, Target's Score:[-1.7682002, 5.5190763, -2.3073416, -3.6393325, -1.8370918, -3.2306757, 6.1100984, -1.0266625, -3.0501516, 5.333339]
Target sample: 19, Prediction:1, Target's Score:[-2.8206654, 8.516606, -2.4242013, -2.538325, -1.441379, -4.9898586, 6.1808176, 1.1848809, -2.6841753, 1.1073251]
Target sample: 25, Prediction:1, Target's Score:[0.529018, 7.1901903, -2.4696662, -2.5012846, -2.344626, -3.0866625, 4.387566, -2.4859817, -1.5582289, 2.4403725]
Target sample: 31, Prediction:1, Target's Score:[-1.2014498, 6.364586, -2.6513226, -0.95609015, -1.9810396, -3.1693852, 3.4463713, -2.5408483, -2.6888201, 5.4920344]
Target sample: 37, Prediction:1, Target's Score:[-0.25066707, 8.427187, -2.4256716, -1.3783238, -2.370724, -3.0832815, 5.6541767, -1.3615178, -2.295384, -0.8348296]
Target sample: 43, Prediction:6, Target's Score:[-0.7631652, -1.2778224, -2.5208673, -2.2571778, -2.284847, -3.0311723, 10.816888, 0.4136374, 3.3659098, -2.4291832]
Target sample: 49, Prediction:6, Target's Score:[-1.3579317, 3.327556, -2.6127105, -0.89534336, -0.94805264, -3.7851262, 9.913741, -1.5758451, -0.15341687, -1.8585354]
Target sample: 55, Prediction:6, Target's Score:[0.11585199, 0.029106792, -2.0191789, -1.7041901, -1.4600215, -3.0497293, 12.052022, -1.888095, 0.56102455, -2.5944924]
Target sample: 61, Prediction:6, Target's Score:[0.7057612, 4.0046487, -1.2408985, -1.8961098, -1.3068883, -2.4223049, 5.914261, -1.1393442, -1.37243, -1.1893615]
Target sample: 67, Prediction:6, Target's Score:[-0.23033358, 5.885132, -2.2642877, -1.7502025, -1.8978739, -3.1868546, 7.6149616, -2.1345806, -2.462051, 0.50814176]
Target sample: 73, Prediction:1, Target's Score:[0.315755, 6.514291, -3.6077518, -2.0025294, -2.0764573, -3.530157, 4.900378, -0.79717577, -0.9783845, 1.3494422]
Target sample: 79, Prediction:1, Target's Score:[-0.0052973414, 7.508628, -3.8424935, -1.7789432, -3.2356205, -2.5911837, 3.9967446, -2.0018153, -1.7950846, 3.855897]
Target sample: 85, Prediction:9, Target's Score:[0.88735443, 4.4459457, -1.6599929, -2.0529397, -2.43278, -1.3910998, 3.2882593, -2.807625, -2.996539, 4.830286]
Target sample: 91, Prediction:6, Target's Score:[1.4325639, 4.4701195, -2.5636234, -3.2295847, -1.3158476, -4.078939, 6.755136, -0.11123103, -1.8275392, 0.54252905]
Target sample: 97, Prediction:1, Target's Score:[1.8479218, 7.8129807, -4.586903, -3.3140213, -1.4511576, -3.5467675, 3.547342, 1.345713, -0.8871461, -0.6899036]
Target sample: 103, Prediction:6, Target's Score:[3.9975088, -1.8632296, -1.9081638, -2.09078, -2.61055, 1.089365, 4.8614163, 0.40229806, 0.5381372, -2.3596804]
Target sample: 109, Prediction:6, Target's Score:[2.0864918, 3.397951, -3.0850053, -2.8068419, -1.6984401, -3.9680767, 3.8119745, -1.8902099, 1.8201677, 2.4170032]
Target sample: 115, Prediction:6, Target's Score:[1.5750263, 0.7964669, -3.073553, -2.0157835, -1.7341229, -4.676148, 4.9428134, -1.2369721, 1.5864726, 3.9257684]
Current ATTACK acc on target samples: 55.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-10 22:38:54 Epoch 59, Val iteration 0, acc 91.600 (91.600)
2021-06-10 22:39:06 Epoch 59, Val iteration 19, acc 93.200 (92.470)
* Prec: 92.47000122070312
Per class accuracy =  [0.94890401 0.9519874  0.88016643 0.83928865 0.95698425 0.87130878
 0.95970063 0.92939032 0.95287422 0.95686613]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 9, 6, 0, 0, 6, 1, 1, 1, 1, 6, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 9, 6, 6, 1, 9, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 8, 6, 6, 0, 9, 6, 0, 6, 1, 6, 6
ATTACK acc: 41.83673469387755
--------
------SUMMARY------
TIME ELAPSED (mins): 23
TARGET INDEX: 1
ResNet50 75.0 78.57142857142857 95.46000137329102 91.2900016784668
DPN92 45.0 43.87755102040816 95.50000267028808 92.65000190734864
MobileNetV2 30.0 31.632653061224488 91.22000160217286 89.39000129699707
GoogLeNet 55.0 41.83673469387755 95.41000213623047 92.47000122070312
True False False False False
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 84 images of target 5
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=False, nearest=True, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=5, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/5/target-num-20
torch.Size([200, 1, 3, 32, 32]) torch.Size([14, 3, 32, 32])
Selected nearest neighbors: [1088, 1212, 600, 1708, 1698]
Selected base image indices: [1088, 1212, 600, 1708, 1698]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79]
# Targets: 14, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-10 22:39:41 Iteration 0 	 Training Loss: 8.076e-01 	 Loss in Target Net: 1.118e+00	  
tensor(-0.0003, device='cuda:0')
 2021-06-10 22:40:50 Iteration 50 	 Training Loss: 1.989e-01 	 Loss in Target Net: 3.300e-01	  
tensor(0.0008, device='cuda:0')
 2021-06-10 22:41:53 Iteration 100 	 Training Loss: 1.665e-01 	 Loss in Target Net: 3.805e-01	  
tensor(-0.0053, device='cuda:0')
 2021-06-10 22:42:54 Iteration 150 	 Training Loss: 1.544e-01 	 Loss in Target Net: 3.359e-01	  
tensor(-0.0137, device='cuda:0')
 2021-06-10 22:43:56 Iteration 200 	 Training Loss: 1.461e-01 	 Loss in Target Net: 3.455e-01	  
tensor(-0.0243, device='cuda:0')
 2021-06-10 22:44:57 Iteration 250 	 Training Loss: 1.396e-01 	 Loss in Target Net: 3.313e-01	  
tensor(-0.0317, device='cuda:0')
 2021-06-10 22:46:01 Iteration 300 	 Training Loss: 1.322e-01 	 Loss in Target Net: 3.449e-01	  
tensor(-0.0379, device='cuda:0')
 2021-06-10 22:47:03 Iteration 350 	 Training Loss: 1.335e-01 	 Loss in Target Net: 3.028e-01	  
tensor(-0.0436, device='cuda:0')
 2021-06-10 22:48:05 Iteration 400 	 Training Loss: 1.345e-01 	 Loss in Target Net: 3.241e-01	  
tensor(-0.0486, device='cuda:0')
 2021-06-10 22:49:08 Iteration 450 	 Training Loss: 1.273e-01 	 Loss in Target Net: 3.474e-01	  
tensor(-0.0515, device='cuda:0')
 2021-06-10 22:50:10 Iteration 500 	 Training Loss: 1.307e-01 	 Loss in Target Net: 3.403e-01	  
tensor(-0.0535, device='cuda:0')
 2021-06-10 22:51:13 Iteration 550 	 Training Loss: 1.333e-01 	 Loss in Target Net: 3.727e-01	  
tensor(-0.0551, device='cuda:0')
 2021-06-10 22:52:15 Iteration 600 	 Training Loss: 1.202e-01 	 Loss in Target Net: 3.689e-01	  
tensor(-0.0544, device='cuda:0')
 2021-06-10 22:53:17 Iteration 650 	 Training Loss: 1.222e-01 	 Loss in Target Net: 3.290e-01	  
tensor(-0.0564, device='cuda:0')
 2021-06-10 22:54:21 Iteration 700 	 Training Loss: 1.228e-01 	 Loss in Target Net: 3.312e-01	  
tensor(-0.0581, device='cuda:0')
 2021-06-10 22:55:22 Iteration 750 	 Training Loss: 1.315e-01 	 Loss in Target Net: 3.328e-01	  
tensor(-0.0566, device='cuda:0')
 2021-06-10 22:56:26 Iteration 800 	 Training Loss: 1.193e-01 	 Loss in Target Net: 3.592e-01	  
tensor(-0.0568, device='cuda:0')
 2021-06-10 22:57:28 Iteration 850 	 Training Loss: 1.208e-01 	 Loss in Target Net: 3.260e-01	  
tensor(-0.0573, device='cuda:0')
 2021-06-10 22:58:30 Iteration 900 	 Training Loss: 1.243e-01 	 Loss in Target Net: 3.537e-01	  
tensor(-0.0569, device='cuda:0')
 2021-06-10 22:59:31 Iteration 950 	 Training Loss: 1.278e-01 	 Loss in Target Net: 3.552e-01	  
tensor(-0.0585, device='cuda:0')
 2021-06-10 23:00:32 Iteration 999 	 Training Loss: 1.238e-01 	 Loss in Target Net: 3.247e-01	  
tensor(-0.0589, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  600
poison index =  1708
poison index =  1698
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-10 23:00:37, Val iteration 0, acc 94.200 (94.200)
2021-06-10 23:00:47, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-10 23:00:52, Epoch 0, Iteration 7, loss 0.315 (0.486), acc 90.385 (87.800)
2021-06-10 23:01:52, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.8328586, 2.9957223, -2.1859608, -1.3998537, -2.5312343, -2.5987377, 7.318855, -3.4998474, 1.5910845, 3.1855462]
Target sample: 7, Prediction:6, Target's Score:[-1.8058665, 0.9855658, -1.8477093, -1.7106516, -2.1967216, -2.748178, 7.4215965, -3.1107194, 1.5522978, 3.5242975]
Target sample: 13, Prediction:6, Target's Score:[-1.5546334, 4.642398, -0.24439867, -2.2297947, -2.3477137, -2.3191204, 6.66341, -3.3527389, -1.9839818, 2.7739773]
Target sample: 19, Prediction:6, Target's Score:[-2.2705717, 1.9129727, -2.1611114, -2.07688, -2.3030674, -3.2469478, 9.622524, -3.7305748, 3.276493, 1.060848]
Target sample: 25, Prediction:6, Target's Score:[-2.4471514, 1.1289382, -2.1812985, -2.0881662, -2.4387872, -3.2797766, 10.292902, -3.444438, 2.67405, 1.8766412]
Target sample: 31, Prediction:6, Target's Score:[-2.3194642, 4.1992927, -0.12076799, -1.7428067, -2.0745497, -2.5455518, 6.860739, -3.593382, -1.6263041, 3.003185]
Target sample: 37, Prediction:1, Target's Score:[-2.4936154, 6.987502, -1.8273219, -2.1511054, -2.3806736, -1.9191825, 6.8353453, -3.1365962, -0.12197427, 0.23403028]
Target sample: 43, Prediction:6, Target's Score:[-2.717863, 4.2744656, -2.4935682, -2.2492225, -2.6890144, -2.7766883, 7.820438, -3.2246253, 3.6090481, 0.4926954]
Target sample: 49, Prediction:8, Target's Score:[-1.7512206, 4.6499157, -2.532396, -2.2322876, -2.5948503, -2.6593218, 4.8564653, -3.6787171, 5.0459223, 0.9085715]
Target sample: 55, Prediction:1, Target's Score:[-2.0549424, 6.8130393, -1.6212018, -2.127774, -2.6302407, -1.4951419, 4.692535, -3.5601234, -1.8993193, 3.880795]
Target sample: 61, Prediction:1, Target's Score:[0.98014617, 5.6085124, -1.9720938, -1.9654119, -1.2307861, -2.4542112, 3.436542, -3.0469315, 1.5331405, -0.8540442]
Target sample: 67, Prediction:1, Target's Score:[-1.5588404, 6.372391, -0.5881373, -2.1218576, -2.402939, -2.4959161, 6.2363296, -3.532642, -1.5201198, 1.6486046]
Target sample: 73, Prediction:6, Target's Score:[-2.8520105, 3.8825233, -1.9323171, -1.7107927, -2.27196, -2.7540987, 8.135807, -3.6605468, 0.046141244, 3.166992]
Target sample: 79, Prediction:6, Target's Score:[-2.9209642, 3.6786191, -2.209894, -1.4809781, -2.6119998, -2.4813218, 7.699208, -3.6086216, 1.489535, 2.4926271]
Current ATTACK acc on target samples: 64.286
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-10 23:02:51 Epoch 59, Val iteration 0, acc 89.200 (89.200)
2021-06-10 23:03:01 Epoch 59, Val iteration 19, acc 92.200 (90.300)
* Prec: 90.30000190734863
Per class accuracy =  [0.94486418 0.94462958 0.83300325 0.77715403 0.93433369 0.8491466
 0.94229065 0.90168512 0.95658675 0.94574497]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 1, 1, 1, 1, 6, 6, 1, 1, 1, 1, 6, 6, 6, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 74.28571428571429
--------
DPN92
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  600
poison index =  1708
poison index =  1698
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-10 23:03:13, Val iteration 0, acc 94.800 (94.800)
2021-06-10 23:03:33, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-10 23:03:48, Epoch 0, Iteration 7, loss 0.299 (0.373), acc 86.538 (89.000)
2021-06-10 23:06:26, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-2.684145, 5.446753, -0.9121042, -1.4697464, -1.5593141, -1.7717618, 4.0286965, -3.1994605, 2.4527383, -0.17082211]
Target sample: 7, Prediction:8, Target's Score:[-1.7888283, -1.5528017, -0.17343347, -2.18598, 0.019421645, -1.7802445, 2.6240282, -0.15070768, 2.7789872, 2.3781512]
Target sample: 13, Prediction:6, Target's Score:[-3.033853, -0.20707592, 0.8974927, -1.6547742, 0.15836467, -0.48688027, 7.104836, -1.7055146, -0.52715445, -0.4047323]
Target sample: 19, Prediction:6, Target's Score:[-3.4230828, 3.0229075, -1.2915897, -2.8282213, -1.1347363, -0.5718525, 7.4169397, -2.9616694, 3.3554785, -1.4208868]
Target sample: 25, Prediction:6, Target's Score:[-3.2500198, -0.17045991, -0.6401195, -0.8205824, -0.52249575, -1.1729785, 7.6167264, -2.1199164, 2.1289363, -0.8997347]
Target sample: 31, Prediction:6, Target's Score:[-3.0347004, 4.969324, 0.09053704, -2.279077, -0.9348886, -0.75669277, 6.475554, -2.8916922, 0.31233466, -1.7844014]
Target sample: 37, Prediction:1, Target's Score:[-0.85761243, 5.6245637, -0.5673333, -2.1313474, -1.1338707, -2.52522, 4.2386827, -2.9063666, 1.8218324, -1.395694]
Target sample: 43, Prediction:6, Target's Score:[-2.6684854, 3.8659518, -0.32314286, -2.6183424, -0.7247681, -2.0788465, 7.16525, -2.972327, 3.4830973, -2.9706254]
Target sample: 49, Prediction:1, Target's Score:[-2.6469026, 5.1848407, -1.0363326, -2.5735478, -0.9749654, -1.6385858, 4.400961, -2.7744467, 4.312514, -2.0819495]
Target sample: 55, Prediction:6, Target's Score:[-2.9620137, 0.07142101, -0.29219663, -2.4256852, -0.1935505, -0.05003639, 6.117297, -1.8326085, -0.6036563, 2.3360777]
Target sample: 61, Prediction:8, Target's Score:[-0.11003611, 3.441994, -0.6013256, -1.7036843, -1.1792012, -2.5015786, 3.5199702, -2.3103504, 3.9284523, -2.3443995]
Target sample: 67, Prediction:6, Target's Score:[-2.9696867, 1.6157868, -0.05634749, -1.8545827, -0.38177392, -1.3758478, 8.239137, -2.6055634, 0.9550152, -1.4260927]
Target sample: 73, Prediction:1, Target's Score:[-1.6493303, 6.804431, -1.6776495, -2.6787357, -1.9860799, -2.2447948, 4.761093, -3.124897, 1.7936547, 0.18063448]
Target sample: 79, Prediction:1, Target's Score:[-2.5550482, 6.0505304, -1.231078, -1.4494245, -1.9110907, -2.1823251, 4.753003, -3.0855794, 1.7563758, 0.026723122]
Current ATTACK acc on target samples: 50.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-10 23:09:00 Epoch 59, Val iteration 0, acc 93.200 (93.200)
2021-06-10 23:09:20 Epoch 59, Val iteration 19, acc 93.200 (93.320)
* Prec: 93.32000122070312
Per class accuracy =  [0.94039678 0.96508843 0.90787589 0.87302097 0.95180941 0.87364078
 0.95727869 0.93316919 0.96669551 0.96259262]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 8, 8, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 6, 8, 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 9, 1, 9, 8, 9, 6, 6, 6, 6, 1, 1, 6, 6, 6, 1, 6, 8, 8, 1, 8, 8, 6, 8
ATTACK acc: 58.57142857142857
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  600
poison index =  1708
poison index =  1698
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-10 23:09:24, Val iteration 0, acc 92.600 (92.600)
2021-06-10 23:09:29, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-10 23:09:31, Epoch 0, Iteration 7, loss 0.253 (0.369), acc 92.308 (90.200)
2021-06-10 23:09:59, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-2.820035, 6.388979, -1.9832268, 1.2734556, -3.7228553, -2.2558055, 5.2899213, -4.4327154, -0.020376276, 2.5182343]
Target sample: 7, Prediction:9, Target's Score:[-3.301064, 0.64247876, -0.6863281, 3.6576147, -2.2535708, -3.483232, 4.088931, 0.048523642, -2.626536, 4.131356]
Target sample: 13, Prediction:6, Target's Score:[-3.0820527, 5.971456, -1.5983217, 1.1288033, -4.4111733, -2.9013975, 6.02121, -1.8686019, -2.7476063, 3.7072096]
Target sample: 19, Prediction:6, Target's Score:[-3.4510663, 7.4778795, -3.417521, 0.21614322, -6.961711, -1.0229412, 9.173478, -5.166505, 2.2654226, 1.1303226]
Target sample: 25, Prediction:6, Target's Score:[-2.0426714, 4.480631, -2.03866, -0.55375504, -5.168375, -1.1897242, 8.104691, -4.4179263, 0.4577651, 2.5868702]
Target sample: 31, Prediction:1, Target's Score:[-1.6867554, 12.488005, -0.99502593, -2.2018974, -4.6129994, -2.3035405, 5.7079782, -5.385108, -4.215625, 3.5057154]
Target sample: 37, Prediction:1, Target's Score:[-1.7579489, 10.517875, -0.6906694, -0.78341746, -5.978944, 0.32647377, -0.32082096, -1.3896303, -1.5013916, 1.8612309]
Target sample: 43, Prediction:6, Target's Score:[-2.249327, 4.592273, -1.2511511, -0.13620871, -4.64738, -1.6853086, 6.2035284, -4.2853827, 2.7598116, 0.94031596]
Target sample: 49, Prediction:1, Target's Score:[-2.9965715, 4.646775, -1.969898, 1.1701022, -6.055881, 2.094267, 3.5033648, -5.8642564, 2.5548234, 3.1859043]
Target sample: 55, Prediction:1, Target's Score:[-2.455652, 9.698196, -3.1877356, -1.4976705, -6.7161517, -0.31091595, 5.2548447, -4.3728085, -2.990009, 6.842152]
Target sample: 61, Prediction:1, Target's Score:[-0.45504245, 7.3323865, -0.47313142, 0.93647784, -4.317347, -3.227062, 5.78242, -5.6030116, 1.5458915, -1.2702241]
Target sample: 67, Prediction:1, Target's Score:[-0.9403978, 10.007311, -1.6165338, -1.9347064, -4.914934, -3.4567895, 5.934552, -3.353946, -2.2958572, 2.8382237]
Target sample: 73, Prediction:1, Target's Score:[-0.93524736, 8.935329, -2.664825, -0.62690115, -5.9348965, -2.0562816, 4.020547, -4.652071, 2.4342892, 1.7461567]
Target sample: 79, Prediction:1, Target's Score:[-2.341455, 8.227136, 0.21548754, 0.38152656, -4.419915, -2.455148, 2.952811, -3.4387758, -0.86869764, 2.0154796]
Current ATTACK acc on target samples: 28.571
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-10 23:10:26 Epoch 59, Val iteration 0, acc 89.400 (89.400)
2021-06-10 23:10:33 Epoch 59, Val iteration 19, acc 90.400 (89.080)
* Prec: 89.08000183105469
Per class accuracy =  [0.92538327 0.90671133 0.8454669  0.82364522 0.89574215 0.82115536
 0.93229752 0.88641592 0.92222466 0.94607561]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 9, 9, 9, 3, 1, 1, 1, 1, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 8, 8, 8, 6, 1, 1, 1, 1, 1, 6, 6, 9, 6, 6, 6, 9, 6, 9, 1, 1, 1, 1, 1, 1, 1, 1, 8, 6, 9, 1, 1, 8, 1, 9
ATTACK acc: 30.0
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  600
poison index =  1708
poison index =  1698
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-10 23:10:40, Val iteration 0, acc 96.200 (96.200)
2021-06-10 23:10:52, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-10 23:10:59, Epoch 0, Iteration 7, loss 0.783 (0.869), acc 78.846 (79.400)
2021-06-10 23:12:10, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-2.5291622, 8.341787, -2.505784, 1.2812784, -2.839117, -4.3783126, 3.6740363, -2.8847961, 0.058306247, 1.7665721]
Target sample: 7, Prediction:9, Target's Score:[0.19026913, 1.1397238, 0.97201127, 0.28793555, -2.9513304, -3.3740528, 1.9575013, -4.1447444, 2.4756339, 3.4308677]
Target sample: 13, Prediction:1, Target's Score:[-1.1660681, 7.958618, -1.8101437, -2.0042183, -3.3388395, -4.1818156, 6.239618, -1.7036693, -2.6459816, 2.6265366]
Target sample: 19, Prediction:6, Target's Score:[-2.5885155, 7.543104, -3.5964503, -2.1504805, -3.3348982, -2.8666224, 9.864069, -2.7441447, -0.8641881, 0.6990443]
Target sample: 25, Prediction:6, Target's Score:[-3.6259677, 7.668624, -4.0925374, -2.2856536, -3.5762641, -2.96483, 8.008987, -3.4745748, 3.6242025, 0.6872474]
Target sample: 31, Prediction:1, Target's Score:[-2.1787903, 8.3228, -2.2574928, -1.7486671, -2.9992294, -3.7269347, 6.0239367, -2.8995855, -2.9568365, 4.393036]
Target sample: 37, Prediction:1, Target's Score:[-1.0919878, 10.383292, -3.0949955, -0.03923981, -3.9134312, -3.1392078, 3.3152378, -3.1820292, 0.1203821, 0.64180565]
Target sample: 43, Prediction:1, Target's Score:[-3.119432, 8.808224, -2.6707282, -1.4036195, -3.8921301, -3.9298518, 6.9160914, -1.8047258, 0.25559917, 0.8208294]
Target sample: 49, Prediction:1, Target's Score:[-2.4269712, 8.623938, -2.8043547, -1.6056919, -4.3609114, -2.813428, 3.7121255, -4.104811, 3.108258, 2.6732917]
Target sample: 55, Prediction:1, Target's Score:[-2.3907166, 11.094853, -2.1147683, -3.0953486, -4.5581903, -2.9287643, 6.4788513, -2.1184096, -2.2480924, 1.8792152]
Target sample: 61, Prediction:1, Target's Score:[1.8287129, 5.922988, -2.10022, -2.6438131, -3.13653, -3.8161824, 5.0741825, -2.7934368, 3.755643, -2.104875]
Target sample: 67, Prediction:1, Target's Score:[-1.3216145, 9.018376, -2.1090615, -2.9111555, -4.2687645, -4.0354557, 5.715791, -0.6763559, -2.5515807, 3.1234443]
Target sample: 73, Prediction:1, Target's Score:[-1.7559674, 8.434296, -3.2745216, -1.0428507, -3.8320413, -3.559499, 5.4187384, -3.2063031, -0.89903533, 3.6992693]
Target sample: 79, Prediction:1, Target's Score:[-2.213327, 7.58468, -1.4017346, 0.26194218, -4.0785875, -4.1329823, 4.0934577, -3.126058, -0.49734983, 3.499504]
Current ATTACK acc on target samples: 14.286
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-10 23:13:19 Epoch 59, Val iteration 0, acc 90.600 (90.600)
2021-06-10 23:13:32 Epoch 59, Val iteration 19, acc 92.200 (91.580)
* Prec: 91.58000144958496
Per class accuracy =  [0.94141022 0.92643532 0.82181593 0.83864939 0.95529077 0.88893823
 0.962634   0.91594494 0.95076442 0.95368845]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 8, 1, 8, 9, 1, 1, 1, 1, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 9, 6, 1, 9, 1, 1, 1, 1, 1, 1, 6, 1, 1, 6, 1, 1, 8, 1, 8
ATTACK acc: 27.142857142857142
--------
------SUMMARY------
TIME ELAPSED (mins): 20
TARGET INDEX: 5
ResNet50 64.28571428571429 74.28571428571429 95.46000137329102 90.30000190734863
DPN92 50.0 58.57142857142857 95.50000267028808 93.32000122070312
MobileNetV2 28.571428571428573 30.0 91.22000160217286 89.08000183105469
GoogLeNet 14.285714285714286 27.142857142857142 95.41000213623047 91.58000144958496
True False False False True
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 84 images of target 5
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=True, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=5, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/5/target-num-20
torch.Size([200, 1, 3, 32, 32]) torch.Size([14, 3, 32, 32])
Selected nearest neighbors: [1088, 1212, 600, 1708, 1698]
Selected base image indices: [1088, 1212, 600, 1708, 1698]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79]
# Targets: 14, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-10 23:14:07 Iteration 0 	 Training Loss: 7.520e-01 	 Loss in Target Net: 6.537e-01	  
tensor(-0.0011, device='cuda:0')
 2021-06-10 23:15:19 Iteration 50 	 Training Loss: 3.312e-01 	 Loss in Target Net: 3.288e-01	  
tensor(-0.0248, device='cuda:0')
 2021-06-10 23:16:32 Iteration 100 	 Training Loss: 2.714e-01 	 Loss in Target Net: 2.417e-01	  
tensor(-0.0576, device='cuda:0')
 2021-06-10 23:17:45 Iteration 150 	 Training Loss: 2.494e-01 	 Loss in Target Net: 2.349e-01	  
tensor(-0.0786, device='cuda:0')
 2021-06-10 23:18:57 Iteration 200 	 Training Loss: 2.428e-01 	 Loss in Target Net: 2.238e-01	  
tensor(-0.0858, device='cuda:0')
 2021-06-10 23:20:16 Iteration 250 	 Training Loss: 2.395e-01 	 Loss in Target Net: 2.331e-01	  
tensor(-0.0883, device='cuda:0')
 2021-06-10 23:21:37 Iteration 300 	 Training Loss: 2.392e-01 	 Loss in Target Net: 2.160e-01	  
tensor(-0.0887, device='cuda:0')
 2021-06-10 23:22:54 Iteration 350 	 Training Loss: 2.373e-01 	 Loss in Target Net: 2.165e-01	  
tensor(-0.0863, device='cuda:0')
 2021-06-10 23:24:10 Iteration 400 	 Training Loss: 2.394e-01 	 Loss in Target Net: 2.277e-01	  
tensor(-0.0866, device='cuda:0')
 2021-06-10 23:25:25 Iteration 450 	 Training Loss: 2.335e-01 	 Loss in Target Net: 2.318e-01	  
tensor(-0.0871, device='cuda:0')
 2021-06-10 23:26:47 Iteration 500 	 Training Loss: 2.341e-01 	 Loss in Target Net: 2.415e-01	  
tensor(-0.0865, device='cuda:0')
 2021-06-10 23:28:05 Iteration 550 	 Training Loss: 2.348e-01 	 Loss in Target Net: 2.485e-01	  
tensor(-0.0864, device='cuda:0')
 2021-06-10 23:29:22 Iteration 600 	 Training Loss: 2.354e-01 	 Loss in Target Net: 2.403e-01	  
tensor(-0.0834, device='cuda:0')
 2021-06-10 23:30:38 Iteration 650 	 Training Loss: 2.338e-01 	 Loss in Target Net: 2.351e-01	  
tensor(-0.0837, device='cuda:0')
 2021-06-10 23:31:53 Iteration 700 	 Training Loss: 2.333e-01 	 Loss in Target Net: 2.328e-01	  
tensor(-0.0852, device='cuda:0')
 2021-06-10 23:33:15 Iteration 750 	 Training Loss: 2.348e-01 	 Loss in Target Net: 2.289e-01	  
tensor(-0.0829, device='cuda:0')
 2021-06-10 23:34:35 Iteration 800 	 Training Loss: 2.353e-01 	 Loss in Target Net: 2.134e-01	  
tensor(-0.0852, device='cuda:0')
 2021-06-10 23:35:57 Iteration 850 	 Training Loss: 2.315e-01 	 Loss in Target Net: 2.432e-01	  
tensor(-0.0853, device='cuda:0')
 2021-06-10 23:37:15 Iteration 900 	 Training Loss: 2.339e-01 	 Loss in Target Net: 2.558e-01	  
tensor(-0.0847, device='cuda:0')
 2021-06-10 23:38:32 Iteration 950 	 Training Loss: 2.332e-01 	 Loss in Target Net: 2.392e-01	  
tensor(-0.0847, device='cuda:0')
 2021-06-10 23:39:46 Iteration 999 	 Training Loss: 2.326e-01 	 Loss in Target Net: 2.134e-01	  
tensor(-0.0839, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  600
poison index =  1708
poison index =  1698
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-10 23:39:52, Val iteration 0, acc 94.200 (94.200)
2021-06-10 23:40:01, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-10 23:40:07, Epoch 0, Iteration 7, loss 0.671 (0.594), acc 90.385 (88.600)
2021-06-10 23:41:07, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-4.224101, 0.14667343, 1.2357916, 1.4547197, -0.64997166, -2.07582, 10.43451, -3.9057145, -1.5085486, -0.9548954]
Target sample: 7, Prediction:6, Target's Score:[-2.155781, -0.20202121, 0.39324492, -0.06910924, -0.4804824, -1.6540403, 9.321472, -2.522697, -1.6327926, -1.0006868]
Target sample: 13, Prediction:6, Target's Score:[-3.26641, 0.9089464, 1.1702434, -0.24340111, -0.69732267, -2.0969522, 10.5385065, -3.16446, -2.0133789, -1.1536019]
Target sample: 19, Prediction:6, Target's Score:[-2.9715183, 4.8272386, -0.7917314, 0.4197908, -1.316645, -2.449489, 9.599415, -3.1736457, -1.1219357, -3.098119]
Target sample: 25, Prediction:6, Target's Score:[-3.1842623, 0.6146278, -0.5951151, 0.09789046, -1.1831903, -2.427769, 10.01788, -3.5181992, 0.14528732, -0.01120384]
Target sample: 31, Prediction:6, Target's Score:[-3.9027696, 2.7993927, 0.46976417, -0.94760764, 0.09715807, -2.2390907, 10.750649, -3.6771355, -2.1278946, -1.2879751]
Target sample: 37, Prediction:6, Target's Score:[-4.050428, 4.5890517, 0.3261238, -1.2506545, -0.8231736, -2.1170902, 10.189925, -2.9459677, -1.1333836, -2.8505478]
Target sample: 43, Prediction:6, Target's Score:[-3.303451, 2.934344, -0.33179635, -1.4572728, -0.98953444, -2.3060956, 9.119356, -2.3825724, 0.79074234, -2.115639]
Target sample: 49, Prediction:6, Target's Score:[-2.8300388, 2.7487109, 1.452097, -1.0193478, -1.3502336, -2.4839187, 8.700596, -3.3055038, -0.91872376, -1.0729184]
Target sample: 55, Prediction:6, Target's Score:[-3.313676, 5.775498, 0.15078191, -1.1028802, -1.4282491, -2.004902, 9.438283, -3.184902, -2.315686, -2.1033695]
Target sample: 61, Prediction:6, Target's Score:[-2.5718966, 7.062475, -0.76255083, -2.0332832, -1.0809549, -2.571817, 8.630301, -2.4261334, -1.242656, -3.096958]
Target sample: 67, Prediction:6, Target's Score:[-3.5656867, 3.0380764, 1.3186556, -0.095057555, -0.8182082, -2.3137453, 10.676453, -3.7417357, -2.8105226, -1.7530977]
Target sample: 73, Prediction:6, Target's Score:[-3.6857758, 4.5421405, -0.07609951, -0.58215207, -1.1265194, -2.1784837, 10.099756, -3.233779, -1.5378313, -2.2863455]
Target sample: 79, Prediction:6, Target's Score:[-4.0547853, -0.16009492, 1.7703232, 1.0262922, -0.67083925, -2.2376685, 10.337062, -3.998892, -1.2847621, -0.77559626]
Current ATTACK acc on target samples: 100.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-10 23:42:06 Epoch 59, Val iteration 0, acc 89.600 (89.600)
2021-06-10 23:42:16 Epoch 59, Val iteration 19, acc 90.400 (89.330)
* Prec: 89.33000144958496
Per class accuracy =  [0.90959873 0.93163541 0.81481739 0.80935342 0.9184289  0.81274317
 0.9518053  0.89068113 0.93188842 0.95524776]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 97.14285714285714
--------
DPN92
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  600
poison index =  1708
poison index =  1698
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-10 23:42:28, Val iteration 0, acc 94.800 (94.800)
2021-06-10 23:42:48, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-10 23:43:02, Epoch 0, Iteration 7, loss 0.289 (0.424), acc 90.385 (89.800)
2021-06-10 23:45:40, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-3.7878103, 3.5271187, -1.8094542, -1.8497527, -3.7462907, -2.3363724, 7.69811, -1.6931103, 2.5625243, 1.9220748]
Target sample: 7, Prediction:6, Target's Score:[-1.965769, -0.98055345, -2.8382685, -2.914639, -3.712646, -1.8881416, 6.447396, -1.1161295, 3.6750374, 5.7963357]
Target sample: 13, Prediction:6, Target's Score:[-3.3373482, -0.85766536, 0.44190365, -1.2483425, -1.3448148, 0.36958316, 9.041628, -2.6124845, -2.4371672, 2.430153]
Target sample: 19, Prediction:6, Target's Score:[-4.6227303, -1.3334147, -1.4101377, -2.017912, -2.701073, 0.6643963, 10.321369, -2.0382729, 2.9411347, 0.63321143]
Target sample: 25, Prediction:6, Target's Score:[-3.6698265, -1.846284, -1.6274412, -0.6595857, -2.2639916, -0.9213344, 8.919426, -1.5304319, 3.0049007, 1.0313376]
Target sample: 31, Prediction:6, Target's Score:[-3.2530494, 4.257373, -0.5386924, -1.7162241, -1.963521, 0.70196265, 7.29961, -2.2033856, -1.8814377, -0.24056786]
Target sample: 37, Prediction:6, Target's Score:[-2.7980635, 1.3502, -1.1193943, -2.4376202, -2.424434, -1.4379666, 7.8910003, -0.7352469, 2.2632887, -0.12653509]
Target sample: 43, Prediction:6, Target's Score:[-3.0714092, 0.43087456, -0.949063, -3.1664228, -2.7424185, -0.9616955, 10.376305, -0.44968688, 1.8692068, -0.91577613]
Target sample: 49, Prediction:6, Target's Score:[-3.0497856, 1.1560959, -1.8240288, -2.501793, -2.6957886, -2.0163066, 6.7936745, -0.50529766, 5.583983, -0.5002823]
Target sample: 55, Prediction:6, Target's Score:[-3.3047402, 0.7275646, -1.4836798, -2.9258678, -2.2949712, 1.9014179, 6.604318, -2.8123994, -1.9200087, 6.0281386]
Target sample: 61, Prediction:6, Target's Score:[-0.34644797, 0.4528769, -2.289354, -1.9899698, -2.8703954, -2.4339209, 6.6114974, -0.22220308, 4.168282, -0.6485342]
Target sample: 67, Prediction:6, Target's Score:[-3.5926945, 1.4498129, -0.94069296, -1.2678593, -1.9514455, -1.3957567, 9.713393, -2.3440025, -0.88964504, 1.676118]
Target sample: 73, Prediction:6, Target's Score:[-2.730219, 1.8346715, -1.988122, -2.91191, -3.3858953, -1.3019735, 9.0271225, -1.5180466, 1.9208384, 1.5245012]
Target sample: 79, Prediction:6, Target's Score:[-3.4678006, 2.426389, -1.7763224, -1.9210292, -3.6358302, -1.713096, 9.248323, -1.6121701, 1.256388, 1.6719811]
Current ATTACK acc on target samples: 100.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-10 23:48:14 Epoch 59, Val iteration 0, acc 92.800 (92.800)
2021-06-10 23:48:35 Epoch 59, Val iteration 19, acc 92.800 (92.830)
* Prec: 92.83000144958496
Per class accuracy =  [0.96377078 0.95697459 0.89690786 0.83240813 0.94001595 0.90627762
 0.94156259 0.92745534 0.96369532 0.95288586]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 9, 9, 9, 9, 9, 6, 9, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 8, 6, 6
ATTACK acc: 87.14285714285714
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  600
poison index =  1708
poison index =  1698
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-10 23:48:38, Val iteration 0, acc 92.600 (92.600)
2021-06-10 23:48:44, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-10 23:48:46, Epoch 0, Iteration 7, loss 0.226 (0.371), acc 94.231 (90.000)
2021-06-10 23:49:14, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.9875124, 4.8093424, -1.9450123, 1.0432484, -3.5188468, -2.39636, 5.1776133, -4.106742, 0.23752062, 2.9618497]
Target sample: 7, Prediction:6, Target's Score:[-2.4105692, -0.06130231, -1.7200203, 3.0728664, -2.175365, -3.0211153, 4.67255, 0.37281904, -2.1210916, 3.6532998]
Target sample: 13, Prediction:6, Target's Score:[-2.7966413, 4.7623796, -1.3496772, 1.0147364, -4.133277, -2.7849262, 7.431026, -1.7007715, -2.8129148, 2.6453114]
Target sample: 19, Prediction:6, Target's Score:[-3.227936, 6.810701, -3.2308495, -0.0311649, -6.6153426, -1.0273159, 10.410607, -5.370335, 1.7124085, 0.8634881]
Target sample: 25, Prediction:6, Target's Score:[-1.8629686, 3.9171, -2.1890748, -0.4461553, -5.1185217, -0.7157262, 9.004837, -4.595966, 0.22710137, 2.036305]
Target sample: 31, Prediction:1, Target's Score:[-1.3616701, 10.587016, -0.70620245, -1.9407984, -4.4577675, -2.2881632, 7.260781, -5.3474813, -4.5693603, 3.1871028]
Target sample: 37, Prediction:1, Target's Score:[-1.3741812, 9.897822, -0.77642393, -0.834933, -5.9219565, -0.16864556, 1.7126778, -1.9274688, -2.2264833, 1.9850432]
Target sample: 43, Prediction:6, Target's Score:[-1.6638924, 3.865689, -1.6189663, -0.6230944, -4.084681, -1.7735872, 6.6701927, -3.8316233, 2.225811, 1.1008945]
Target sample: 49, Prediction:1, Target's Score:[-2.4407315, 4.0921016, -2.4730697, 1.1798027, -5.664227, 1.9438345, 3.4288623, -5.582292, 2.3812242, 3.4612935]
Target sample: 55, Prediction:1, Target's Score:[-2.024406, 8.826757, -3.4084191, -1.1521206, -6.4446993, -0.58212423, 6.028647, -4.177331, -2.7567143, 6.0348673]
Target sample: 61, Prediction:1, Target's Score:[-0.344114, 7.4661736, -1.462027, 1.1208714, -4.186351, -2.9721453, 5.381057, -5.3066964, 0.6268768, -0.015158929]
Target sample: 67, Prediction:1, Target's Score:[-0.5714586, 8.818239, -1.8734729, -1.3389977, -4.7461033, -3.411941, 7.377829, -4.252191, -2.8816798, 3.2139883]
Target sample: 73, Prediction:1, Target's Score:[-0.883204, 7.5862527, -2.8683617, -0.65495545, -5.66498, -1.8716552, 5.2031555, -4.5597734, 2.018358, 2.013042]
Target sample: 79, Prediction:1, Target's Score:[-1.3324224, 6.493703, 0.19295543, 0.3469473, -4.1292152, -2.634193, 3.0265474, -2.949555, -1.343391, 2.647184]
Current ATTACK acc on target samples: 42.857
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-10 23:49:41 Epoch 59, Val iteration 0, acc 89.800 (89.800)
2021-06-10 23:49:47 Epoch 59, Val iteration 19, acc 90.600 (89.300)
* Prec: 89.30000114440918
Per class accuracy =  [0.92931779 0.91774409 0.84457081 0.82205141 0.89122325 0.82658211
 0.92989841 0.88862692 0.93068144 0.94599519]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 9, 9, 9, 3, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 9, 1, 1, 1, 1, 1, 1, 1, 6, 6, 8, 6, 8, 6, 8, 6, 1, 6, 1, 1, 1, 6, 1, 1, 1, 6, 6, 9, 6, 6, 6, 1, 1, 1, 1, 1, 6, 6, 8, 6, 9, 1, 1, 8, 1, 9
ATTACK acc: 42.857142857142854
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  600
poison index =  1708
poison index =  1698
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-10 23:49:55, Val iteration 0, acc 96.200 (96.200)
2021-06-10 23:50:07, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-10 23:50:14, Epoch 0, Iteration 7, loss 0.826 (0.927), acc 78.846 (79.600)
2021-06-10 23:51:25, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-4.458026, 7.1596265, -3.157144, 3.2254856, -4.431798, -1.9005972, 6.272537, -3.4115505, 1.788995, -1.1494212]
Target sample: 7, Prediction:6, Target's Score:[-3.1778805, 1.7952827, -2.6699657, 1.9191766, -4.748934, -0.7000686, 6.6118217, -3.7749355, 5.05657, -0.3922861]
Target sample: 13, Prediction:6, Target's Score:[-3.1915812, 6.172629, -1.4787472, 3.6445465, -4.3539987, -0.66228867, 6.3962936, -2.5914648, -2.8995385, -1.091215]
Target sample: 19, Prediction:6, Target's Score:[-5.377641, 4.4527993, -3.9678717, -0.26320952, -4.8017697, 0.38388905, 9.529948, -3.8473089, 3.8448634, -0.07091601]
Target sample: 25, Prediction:6, Target's Score:[-5.747941, 5.5472026, -4.1131606, -0.4072223, -5.01739, -0.47826594, 9.064979, -3.7912855, 4.6716394, 0.15267651]
Target sample: 31, Prediction:1, Target's Score:[-4.718295, 10.759743, -3.0353916, 1.9889346, -4.978732, -0.789482, 6.786956, -3.3493648, -2.493121, -0.24683554]
Target sample: 37, Prediction:1, Target's Score:[-3.6285026, 11.274791, -3.5860393, 1.0272815, -4.901481, -1.5320739, 5.9696794, -3.154064, -0.6040408, -0.93535465]
Target sample: 43, Prediction:6, Target's Score:[-4.6200643, 7.8856025, -2.8844714, -0.29506, -4.9425325, -1.5285494, 9.47661, -2.3316875, 0.8180479, -1.6719116]
Target sample: 49, Prediction:1, Target's Score:[-4.052556, 6.3344874, -2.3242786, -0.3386968, -4.878823, -0.94407916, 5.0194354, -4.364536, 5.124014, 0.3314764]
Target sample: 55, Prediction:1, Target's Score:[-4.5882807, 9.115512, -2.363551, 2.7566876, -5.116673, -1.1875763, 5.928112, -3.238106, -1.8364153, 0.46611917]
Target sample: 61, Prediction:8, Target's Score:[0.7131416, 3.5512145, -3.124143, 0.2556963, -3.9745789, -0.7976196, 4.1384134, -2.9292393, 4.5050845, -2.3958127]
Target sample: 67, Prediction:1, Target's Score:[-3.5373046, 9.889394, -3.4808605, 0.8374573, -5.633719, -0.4768252, 7.2399793, -2.2096262, -2.767838, 0.060567547]
Target sample: 73, Prediction:1, Target's Score:[-3.81489, 10.0376625, -3.6375802, 0.25185022, -5.1509724, -0.12591724, 7.283803, -3.7163136, -1.0019014, -0.21184321]
Target sample: 79, Prediction:1, Target's Score:[-4.650761, 7.874232, -2.9243076, 2.7744343, -4.8516517, -1.4405354, 7.0495358, -3.5140026, 0.482733, -0.86767566]
Current ATTACK acc on target samples: 35.714
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-10 23:52:34 Epoch 59, Val iteration 0, acc 92.000 (92.000)
2021-06-10 23:52:47 Epoch 59, Val iteration 19, acc 89.600 (91.270)
* Prec: 91.2700023651123
Per class accuracy =  [0.93838633 0.93819443 0.86220035 0.80710953 0.94355683 0.86426081
 0.94697877 0.92565127 0.94053369 0.95641183]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 6, 8, 8, 1, 6, 1, 1, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 8, 6, 6, 1, 1, 1, 1, 6, 6, 9, 6, 8, 1, 9, 6, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 6, 6, 6, 6, 6, 8
ATTACK acc: 50.0
--------
------SUMMARY------
TIME ELAPSED (mins): 25
TARGET INDEX: 5
ResNet50 100.0 97.14285714285714 95.46000137329102 89.33000144958496
DPN92 100.0 87.14285714285714 95.50000267028808 92.83000144958496
MobileNetV2 42.857142857142854 42.857142857142854 91.22000160217286 89.30000114440918
GoogLeNet 35.714285714285715 50.0 95.41000213623047 91.2700023651123
True False False False False
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 96 images of target 6
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=False, nearest=True, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=6, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/6/target-num-20
torch.Size([200, 1, 3, 32, 32]) torch.Size([16, 3, 32, 32])
Selected nearest neighbors: [1212, 1088, 600, 1708, 770]
Selected base image indices: [1212, 1088, 600, 1708, 770]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
# Targets: 16, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-10 23:53:21 Iteration 0 	 Training Loss: 7.778e-01 	 Loss in Target Net: 9.662e-01	  
tensor(7.2156e-05, device='cuda:0')
 2021-06-10 23:54:26 Iteration 50 	 Training Loss: 2.062e-01 	 Loss in Target Net: 4.148e-01	  
tensor(-0.0135, device='cuda:0')
 2021-06-10 23:55:33 Iteration 100 	 Training Loss: 1.812e-01 	 Loss in Target Net: 4.096e-01	  
tensor(-0.0268, device='cuda:0')
 2021-06-10 23:56:37 Iteration 150 	 Training Loss: 1.690e-01 	 Loss in Target Net: 4.376e-01	  
tensor(-0.0395, device='cuda:0')
 2021-06-10 23:57:39 Iteration 200 	 Training Loss: 1.581e-01 	 Loss in Target Net: 4.893e-01	  
tensor(-0.0490, device='cuda:0')
 2021-06-10 23:58:42 Iteration 250 	 Training Loss: 1.575e-01 	 Loss in Target Net: 5.112e-01	  
tensor(-0.0528, device='cuda:0')
 2021-06-10 23:59:46 Iteration 300 	 Training Loss: 1.555e-01 	 Loss in Target Net: 4.558e-01	  
tensor(-0.0569, device='cuda:0')
 2021-06-11 00:00:48 Iteration 350 	 Training Loss: 1.507e-01 	 Loss in Target Net: 4.911e-01	  
tensor(-0.0597, device='cuda:0')
 2021-06-11 00:01:53 Iteration 400 	 Training Loss: 1.542e-01 	 Loss in Target Net: 5.045e-01	  
tensor(-0.0609, device='cuda:0')
 2021-06-11 00:02:56 Iteration 450 	 Training Loss: 1.403e-01 	 Loss in Target Net: 4.609e-01	  
tensor(-0.0621, device='cuda:0')
 2021-06-11 00:04:00 Iteration 500 	 Training Loss: 1.465e-01 	 Loss in Target Net: 5.124e-01	  
tensor(-0.0641, device='cuda:0')
 2021-06-11 00:05:01 Iteration 550 	 Training Loss: 1.434e-01 	 Loss in Target Net: 5.145e-01	  
tensor(-0.0649, device='cuda:0')
 2021-06-11 00:06:02 Iteration 600 	 Training Loss: 1.396e-01 	 Loss in Target Net: 4.864e-01	  
tensor(-0.0660, device='cuda:0')
 2021-06-11 00:07:03 Iteration 650 	 Training Loss: 1.383e-01 	 Loss in Target Net: 5.034e-01	  
tensor(-0.0678, device='cuda:0')
 2021-06-11 00:08:06 Iteration 700 	 Training Loss: 1.395e-01 	 Loss in Target Net: 4.792e-01	  
tensor(-0.0677, device='cuda:0')
 2021-06-11 00:09:07 Iteration 750 	 Training Loss: 1.379e-01 	 Loss in Target Net: 4.695e-01	  
tensor(-0.0671, device='cuda:0')
 2021-06-11 00:10:08 Iteration 800 	 Training Loss: 1.349e-01 	 Loss in Target Net: 5.223e-01	  
tensor(-0.0705, device='cuda:0')
 2021-06-11 00:11:10 Iteration 850 	 Training Loss: 1.412e-01 	 Loss in Target Net: 5.198e-01	  
tensor(-0.0708, device='cuda:0')
 2021-06-11 00:12:11 Iteration 900 	 Training Loss: 1.311e-01 	 Loss in Target Net: 5.107e-01	  
tensor(-0.0708, device='cuda:0')
 2021-06-11 00:13:12 Iteration 950 	 Training Loss: 1.330e-01 	 Loss in Target Net: 4.739e-01	  
tensor(-0.0709, device='cuda:0')
 2021-06-11 00:14:13 Iteration 999 	 Training Loss: 1.391e-01 	 Loss in Target Net: 5.095e-01	  
tensor(-0.0714, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  600
poison index =  1708
poison index =  770
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 00:14:18, Val iteration 0, acc 94.200 (94.200)
2021-06-11 00:14:28, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 00:14:33, Epoch 0, Iteration 7, loss 0.192 (0.255), acc 92.308 (94.600)
2021-06-11 00:15:33, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-4.43466, 8.723641, -2.1438282, -1.6063058, -2.8350348, -2.6639497, 8.916865, -2.3255389, 0.890621, -2.3694854]
Target sample: 7, Prediction:6, Target's Score:[-4.246662, 6.455905, -1.2095357, -2.1522734, -2.0469596, -2.4397466, 7.2911606, -3.5213053, -2.3623204, 4.4115424]
Target sample: 13, Prediction:9, Target's Score:[-3.4549205, 4.4419107, -1.5646087, -1.8199345, -2.5772474, -2.2563856, 5.4752955, -3.331993, -1.6644663, 6.941231]
Target sample: 19, Prediction:1, Target's Score:[-3.856863, 9.513416, -2.8355384, -2.1249514, -2.9286742, -2.0892873, 5.5696855, -2.3229532, 0.49294847, 0.74681956]
Target sample: 25, Prediction:1, Target's Score:[-4.6387753, 13.845198, -3.3962333, -2.5136847, -3.570856, -2.0317698, 5.074021, -2.772197, -0.64574665, 0.83326125]
Target sample: 31, Prediction:1, Target's Score:[-3.5994728, 7.831898, -2.4920635, -1.7953695, -2.6219637, -1.9444238, 4.791704, -2.420856, -0.34766656, 2.758049]
Target sample: 37, Prediction:1, Target's Score:[-4.55101, 12.373767, -2.5297213, -2.7072752, -2.5855303, -2.7372725, 6.218061, -2.6128182, -0.4234206, -0.28313908]
Target sample: 43, Prediction:1, Target's Score:[-2.8191712, 8.187966, -2.2669725, -1.3568097, -2.2203863, -0.5816144, 5.626653, -2.4576588, 0.25528574, -2.2256174]
Target sample: 49, Prediction:1, Target's Score:[-3.660341, 10.4620285, -2.498819, -1.8503225, -2.3708684, -2.766905, 5.7979784, -2.4577568, 2.099166, -2.6160817]
Target sample: 55, Prediction:6, Target's Score:[-5.425492, 9.2175455, -1.7032685, -2.3546298, -2.767292, -3.714484, 11.167532, -3.487126, -0.11343323, -0.63818246]
Target sample: 61, Prediction:1, Target's Score:[-4.9827833, 12.892599, -2.5750616, -2.3097136, -3.2392719, -2.8972979, 7.3569236, -2.880399, -0.5139046, -0.68802476]
Target sample: 67, Prediction:1, Target's Score:[-3.4393525, 9.770226, -2.2044559, -1.8276986, -2.388719, -1.893429, 5.1509275, -2.5456092, 0.6571258, -1.1373434]
Target sample: 73, Prediction:1, Target's Score:[-4.8512735, 12.278768, -2.688247, -2.1285496, -3.1704836, -2.940367, 5.98659, -2.4984229, -0.8939813, 1.0766776]
Target sample: 79, Prediction:1, Target's Score:[-4.2982774, 6.459725, -2.061498, -1.616963, -2.8469584, -2.533208, 6.071271, -3.14628, -1.8242618, 5.9964576]
Target sample: 85, Prediction:6, Target's Score:[-3.8850162, 3.4852827, -1.9532491, -0.75927466, -2.0007434, -2.806771, 7.5466685, -3.315705, -0.3976497, 4.2768307]
Target sample: 91, Prediction:1, Target's Score:[-3.9054704, 11.016112, -2.6098006, -2.041597, -2.8724942, -2.8510466, 5.9697585, -2.434471, 2.4239619, -2.5440772]
Current ATTACK acc on target samples: 25.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 00:16:32 Epoch 59, Val iteration 0, acc 90.800 (90.800)
2021-06-11 00:16:43 Epoch 59, Val iteration 19, acc 91.800 (90.930)
* Prec: 90.93000183105468
Per class accuracy =  [0.94410938 0.94023388 0.83820479 0.78802932 0.95073272 0.87439256
 0.92678667 0.91883249 0.96796498 0.94150541]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 6, 9, 9, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 6, 9, 9, 9, 6, 6, 1, 1, 1, 1, 1, 1, 1, 6
ATTACK acc: 16.25
--------
DPN92
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  600
poison index =  1708
poison index =  770
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 00:16:54, Val iteration 0, acc 94.800 (94.800)
2021-06-11 00:17:14, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 00:17:29, Epoch 0, Iteration 7, loss 0.898 (0.590), acc 86.538 (87.400)
2021-06-11 00:20:07, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.8698887, 4.619914, -3.3791194, -3.7070777, -2.4262445, -2.5089238, 8.120066, -0.5797199, 4.466791, -2.5246117]
Target sample: 7, Prediction:6, Target's Score:[-2.6300697, 4.1067176, -1.6531923, -3.1622076, -2.2494743, -3.4641707, 10.061851, -1.780387, 0.6174623, 0.39080313]
Target sample: 13, Prediction:6, Target's Score:[-2.3716354, 6.681941, -2.3075492, -2.8369129, -3.6357226, -2.8295512, 8.491285, -1.9017403, -0.8324448, 1.782986]
Target sample: 19, Prediction:6, Target's Score:[-0.8229707, 1.5531223, -2.613419, -2.019998, -2.36852, -3.8122456, 11.312474, -1.6520146, 2.582647, -1.8796141]
Target sample: 25, Prediction:1, Target's Score:[-1.1271254, 7.400243, -3.6015303, -3.0153146, -3.2916086, -3.0282094, 6.8577456, -0.9451483, 1.7639347, -0.7879233]
Target sample: 31, Prediction:6, Target's Score:[-0.48727268, 2.7711594, -2.3253267, -2.3507874, -2.361563, -3.5684736, 9.276202, -1.0115743, 1.4302242, -1.1300818]
Target sample: 37, Prediction:1, Target's Score:[-1.2622446, 9.416783, -3.4053457, -3.0846016, -2.341761, -2.5734837, 4.5755587, -0.9696998, 1.1862518, -1.3534288]
Target sample: 43, Prediction:6, Target's Score:[-2.0627797, 3.43685, -2.6832879, -1.5311835, -1.1026802, -2.906961, 10.650796, -2.4067254, 0.9502557, -2.0830324]
Target sample: 49, Prediction:6, Target's Score:[-3.159205, 5.5569806, -2.6445985, -3.490192, 0.113855466, -2.6108267, 9.018585, -1.6803142, 1.8971714, -2.796804]
Target sample: 55, Prediction:6, Target's Score:[-3.0290623, 7.139254, -2.3044317, -3.8755143, -2.406426, -2.5047112, 10.268515, -1.3446971, 0.5480673, -2.2622385]
Target sample: 61, Prediction:6, Target's Score:[-1.8200375, 6.9731035, -3.4252448, -3.2681797, -3.136261, -2.9459183, 8.4490185, -1.2747488, 2.0615587, -1.3876661]
Target sample: 67, Prediction:6, Target's Score:[-1.523071, 1.8502389, -2.2756429, -2.9015496, -2.3667731, -3.3313217, 12.50497, -1.7092463, 2.0208545, -2.007423]
Target sample: 73, Prediction:6, Target's Score:[-0.19415349, 2.7417028, -2.6272628, -2.8063953, -3.3911357, -3.7555761, 9.331744, -1.0951378, 2.4178467, -0.37080798]
Target sample: 79, Prediction:1, Target's Score:[-0.19958626, 7.846119, -3.4909422, -2.4781957, -3.8681035, -3.209481, 5.7911053, -1.4900575, 0.18946809, 1.1408458]
Target sample: 85, Prediction:6, Target's Score:[-2.6341958, 5.559388, -2.811671, -2.5900862, -2.4230492, -3.3620853, 9.150052, -2.1799197, 1.8965249, -0.37151828]
Target sample: 91, Prediction:6, Target's Score:[-1.6668644, 5.788237, -3.5312173, -4.0955424, -1.5543472, -2.5225258, 6.661082, 0.113989115, 3.5852983, -2.5887644]
Current ATTACK acc on target samples: 81.250
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 00:22:42 Epoch 59, Val iteration 0, acc 94.000 (94.000)
2021-06-11 00:23:02 Epoch 59, Val iteration 19, acc 93.400 (93.410)
* Prec: 93.41000099182129
Per class accuracy =  [0.9457501  0.96395236 0.91028016 0.86223729 0.9521396  0.89138864
 0.95329321 0.94551998 0.97048976 0.94829207]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 6, 1, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 6, 6, 6, 6, 8, 6, 8, 6, 6, 6, 6
ATTACK acc: 72.5
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  600
poison index =  1708
poison index =  770
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 00:23:06, Val iteration 0, acc 92.600 (92.600)
2021-06-11 00:23:11, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 00:23:13, Epoch 0, Iteration 7, loss 0.272 (0.340), acc 92.308 (89.800)
2021-06-11 00:23:41, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.754555, 8.908459, -5.4803, 0.9643802, -3.6811743, -2.6752198, 7.17606, -4.9227567, 2.0143476, -0.21168551]
Target sample: 7, Prediction:1, Target's Score:[-1.4908468, 7.25631, -3.1553195, -0.12877105, -0.9190455, -2.275157, 7.1127334, -5.4247403, -3.9180326, 3.3316255]
Target sample: 13, Prediction:9, Target's Score:[-3.52753, 5.5207987, -2.976975, 2.5040612, -3.2261684, -2.4955451, 7.395661, -6.4483604, -4.039067, 7.6762505]
Target sample: 19, Prediction:6, Target's Score:[-4.1118517, 6.9332175, -3.4584188, 3.2722402, -2.4745853, -2.4927058, 8.0037985, -4.871421, -1.0720978, 0.6248114]
Target sample: 25, Prediction:6, Target's Score:[-3.4933553, 6.7272468, -4.2853646, 1.2226714, -3.2897992, -2.3654606, 9.907549, -3.7297044, -2.0970767, 1.7501622]
Target sample: 31, Prediction:1, Target's Score:[-3.2365825, 7.7895026, -4.6266813, 0.7656044, 1.9222709, -1.4884368, 6.2634273, -4.5163198, -4.226172, 1.7688988]
Target sample: 37, Prediction:1, Target's Score:[-2.9263415, 8.6364565, -4.4320097, 1.0819237, 0.40067643, -2.365092, 6.028408, -5.4517965, -4.5337715, 3.996622]
Target sample: 43, Prediction:6, Target's Score:[-1.9845952, 0.60556406, -1.1411464, 4.388594, -2.8060265, -3.0222597, 10.296496, -5.8497167, 0.78671443, -1.0046842]
Target sample: 49, Prediction:6, Target's Score:[-3.406996, 2.7131467, -4.0612183, 3.9571445, 2.149066, -3.2490213, 9.968449, -5.5405025, -0.78530616, -1.4070721]
Target sample: 55, Prediction:6, Target's Score:[-4.2669106, 6.1910763, -4.476099, 2.0306454, -1.8775052, -2.3967254, 16.239248, -6.774337, -2.1878927, -2.1090698]
Target sample: 61, Prediction:1, Target's Score:[-4.1950974, 7.4919133, -5.1712723, 2.5542061, 1.492101, -0.97191674, 4.9911766, -4.9933505, -3.1272714, 2.3418965]
Target sample: 67, Prediction:6, Target's Score:[-4.0459075, 4.3453383, -2.449191, 3.178133, 5.742893, -1.800405, 6.468441, -6.296317, -4.6370964, -0.058093205]
Target sample: 73, Prediction:6, Target's Score:[-2.7894266, 7.3410573, -3.739968, 0.8799683, 0.98748237, -2.6776896, 7.7483377, -4.917749, -3.4966183, 1.0504155]
Target sample: 79, Prediction:1, Target's Score:[-1.7514197, 9.3319845, -4.7331476, -0.95582044, -5.464824, -1.4913844, 6.3380055, -6.1809316, -1.1690918, 6.452025]
Target sample: 85, Prediction:9, Target's Score:[-3.7380114, -0.200443, -0.57809716, 0.49836665, -1.352444, -3.1628544, 4.499528, -2.991555, -0.03785135, 7.3831015]
Target sample: 91, Prediction:1, Target's Score:[1.3069404, 9.335132, -4.489464, -1.1366578, -4.192123, -3.8095665, 4.8800025, -4.197428, 3.0813951, -0.46500596]
Current ATTACK acc on target samples: 43.750
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 00:24:09 Epoch 59, Val iteration 0, acc 89.000 (89.000)
2021-06-11 00:24:15 Epoch 59, Val iteration 19, acc 90.400 (89.450)
* Prec: 89.45000076293945
Per class accuracy =  [0.91920684 0.9249244  0.85192832 0.82786793 0.89268803 0.82327746
 0.93656768 0.89065603 0.92761573 0.9467629 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 1, 1, 6, 6, 1, 6, 9, 9, 9, 6, 6, 6, 6, 6, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 4, 4, 4, 6, 4, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 9, 9, 6, 1, 9, 1, 1, 1, 1, 1, 8, 6, 6
ATTACK acc: 52.5
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  600
poison index =  1708
poison index =  770
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 00:24:23, Val iteration 0, acc 96.200 (96.200)
2021-06-11 00:24:35, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 00:24:41, Epoch 0, Iteration 7, loss 0.903 (0.896), acc 71.154 (77.000)
2021-06-11 00:25:52, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-3.5021925, 7.931745, -3.5581462, -4.007878, -2.3873801, 3.9626179, 7.9837155, -3.2540457, -0.28890598, -2.8353963]
Target sample: 7, Prediction:1, Target's Score:[-4.0106835, 9.304015, -1.5656953, -2.6244233, -0.83219093, 1.5823531, 6.620517, -4.4456906, -2.339183, -1.6686616]
Target sample: 13, Prediction:9, Target's Score:[-4.151049, 3.9211874, -5.326435, -2.3186967, -3.032372, 1.3628975, 6.969735, -4.503492, -0.63810843, 7.770113]
Target sample: 19, Prediction:6, Target's Score:[-3.8269508, 3.3918161, -3.3155441, -0.55879027, -0.9086321, 2.0945177, 7.676664, -3.5561123, 0.61657083, -1.6093413]
Target sample: 25, Prediction:6, Target's Score:[-4.927382, 9.731762, -4.1317515, -1.6823714, -4.0751576, 1.8137555, 10.30512, -4.048562, -1.9459769, -1.0317504]
Target sample: 31, Prediction:6, Target's Score:[-4.5785055, 4.31986, -3.8115153, -2.0467384, -1.5449467, 2.74289, 10.88644, -3.4687643, -1.5748552, -0.9249778]
Target sample: 37, Prediction:1, Target's Score:[-2.8605533, 7.4511733, -5.8723326, -0.9854453, 1.897444, 2.3781092, 6.2206936, -5.0969095, -2.155834, -0.95891196]
Target sample: 43, Prediction:6, Target's Score:[-3.2235243, 7.5042434, -3.6092672, -2.1224153, -1.3872964, 1.9395528, 9.239547, -3.5130544, -1.7353069, -3.0897822]
Target sample: 49, Prediction:6, Target's Score:[-4.549344, 8.945324, -3.747323, -3.3227472, -1.8832846, 0.3261863, 10.340056, -3.9060986, -0.22013986, -1.9796852]
Target sample: 55, Prediction:6, Target's Score:[-4.6659207, 8.260669, -3.125912, -2.8328254, -3.017725, 1.8821156, 11.841347, -3.740693, -1.8623223, -2.738976]
Target sample: 61, Prediction:6, Target's Score:[-4.320362, 3.1264548, -3.0494113, -1.889935, -2.2868123, 2.340379, 11.278589, -3.7659209, -0.6453653, -0.79090637]
Target sample: 67, Prediction:6, Target's Score:[-4.431393, 5.2321496, -1.3240199, -2.7342129, -2.4589205, 1.3607749, 11.358101, -4.1605215, -1.602425, -1.2473134]
Target sample: 73, Prediction:1, Target's Score:[-4.210325, 9.781451, -4.732746, -1.8665199, -2.1225562, 1.029667, 8.4452505, -3.825946, -1.3139347, -1.1761574]
Target sample: 79, Prediction:6, Target's Score:[-4.080914, 4.934002, -4.3903666, -0.76150256, -3.2679765, 1.3880808, 8.027974, -4.6656857, -1.727029, 4.5653872]
Target sample: 85, Prediction:6, Target's Score:[-4.91089, 5.2536693, -1.8292477, 0.705777, -2.6442676, 2.708779, 5.2592816, -4.851397, -2.1891398, 2.5285425]
Target sample: 91, Prediction:1, Target's Score:[-3.26948, 12.338029, -4.828672, -4.7010274, -1.6241231, 3.125801, 6.040708, -3.65138, -0.8763112, -2.4957433]
Current ATTACK acc on target samples: 68.750
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 00:27:02 Epoch 59, Val iteration 0, acc 92.200 (92.200)
2021-06-11 00:27:14 Epoch 59, Val iteration 19, acc 92.000 (92.220)
* Prec: 92.22000122070312
Per class accuracy =  [0.95794275 0.93925396 0.89628004 0.86340328 0.91740212 0.86296821
 0.95397609 0.93009283 0.9464079  0.95077523]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 6, 6, 1, 1, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 6, 1, 1, 6, 1, 1, 6, 6, 6, 6, 1, 6, 1, 6, 6, 1, 6, 1, 1, 1, 1, 6
ATTACK acc: 50.0
--------
------SUMMARY------
TIME ELAPSED (mins): 20
TARGET INDEX: 6
ResNet50 25.0 16.25 95.46000137329102 90.93000183105468
DPN92 81.25 72.5 95.50000267028808 93.41000099182129
MobileNetV2 43.75 52.5 91.22000160217286 89.45000076293945
GoogLeNet 68.75 50.0 95.41000213623047 92.22000122070312
True False False False True
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 96 images of target 6
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=True, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=6, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/6/target-num-20
torch.Size([200, 1, 3, 32, 32]) torch.Size([16, 3, 32, 32])
Selected nearest neighbors: [1212, 1088, 600, 1708, 770]
Selected base image indices: [1212, 1088, 600, 1708, 770]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
# Targets: 16, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 00:27:51 Iteration 0 	 Training Loss: 7.506e-01 	 Loss in Target Net: 6.076e-01	  
tensor(-0.0003, device='cuda:0')
 2021-06-11 00:29:02 Iteration 50 	 Training Loss: 3.687e-01 	 Loss in Target Net: 3.494e-01	  
tensor(-0.0394, device='cuda:0')
 2021-06-11 00:30:14 Iteration 100 	 Training Loss: 3.276e-01 	 Loss in Target Net: 3.549e-01	  
tensor(-0.0750, device='cuda:0')
 2021-06-11 00:31:27 Iteration 150 	 Training Loss: 3.170e-01 	 Loss in Target Net: 3.213e-01	  
tensor(-0.0881, device='cuda:0')
 2021-06-11 00:32:37 Iteration 200 	 Training Loss: 3.085e-01 	 Loss in Target Net: 2.980e-01	  
tensor(-0.0955, device='cuda:0')
 2021-06-11 00:33:47 Iteration 250 	 Training Loss: 3.060e-01 	 Loss in Target Net: 3.424e-01	  
tensor(-0.0962, device='cuda:0')
 2021-06-11 00:34:57 Iteration 300 	 Training Loss: 3.072e-01 	 Loss in Target Net: 3.539e-01	  
tensor(-0.0989, device='cuda:0')
 2021-06-11 00:36:06 Iteration 350 	 Training Loss: 2.998e-01 	 Loss in Target Net: 3.599e-01	  
tensor(-0.1018, device='cuda:0')
 2021-06-11 00:37:17 Iteration 400 	 Training Loss: 3.061e-01 	 Loss in Target Net: 3.297e-01	  
tensor(-0.1012, device='cuda:0')
 2021-06-11 00:38:29 Iteration 450 	 Training Loss: 3.001e-01 	 Loss in Target Net: 3.221e-01	  
tensor(-0.1031, device='cuda:0')
 2021-06-11 00:39:37 Iteration 500 	 Training Loss: 3.000e-01 	 Loss in Target Net: 3.414e-01	  
tensor(-0.1010, device='cuda:0')
 2021-06-11 00:40:47 Iteration 550 	 Training Loss: 3.010e-01 	 Loss in Target Net: 3.446e-01	  
tensor(-0.1009, device='cuda:0')
 2021-06-11 00:41:56 Iteration 600 	 Training Loss: 3.020e-01 	 Loss in Target Net: 3.688e-01	  
tensor(-0.1008, device='cuda:0')
 2021-06-11 00:43:05 Iteration 650 	 Training Loss: 3.036e-01 	 Loss in Target Net: 3.608e-01	  
tensor(-0.1013, device='cuda:0')
 2021-06-11 00:44:15 Iteration 700 	 Training Loss: 3.024e-01 	 Loss in Target Net: 3.304e-01	  
tensor(-0.1018, device='cuda:0')
 2021-06-11 00:45:23 Iteration 750 	 Training Loss: 3.019e-01 	 Loss in Target Net: 3.110e-01	  
tensor(-0.1001, device='cuda:0')
 2021-06-11 00:46:32 Iteration 800 	 Training Loss: 3.031e-01 	 Loss in Target Net: 3.249e-01	  
tensor(-0.1001, device='cuda:0')
 2021-06-11 00:47:41 Iteration 850 	 Training Loss: 3.090e-01 	 Loss in Target Net: 3.217e-01	  
tensor(-0.0984, device='cuda:0')
 2021-06-11 00:48:50 Iteration 900 	 Training Loss: 2.986e-01 	 Loss in Target Net: 3.187e-01	  
tensor(-0.0994, device='cuda:0')
 2021-06-11 00:49:58 Iteration 950 	 Training Loss: 3.002e-01 	 Loss in Target Net: 3.210e-01	  
tensor(-0.0983, device='cuda:0')
 2021-06-11 00:51:05 Iteration 999 	 Training Loss: 2.982e-01 	 Loss in Target Net: 3.161e-01	  
tensor(-0.0986, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  600
poison index =  1708
poison index =  770
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 00:51:11, Val iteration 0, acc 94.200 (94.200)
2021-06-11 00:51:20, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 00:51:26, Epoch 0, Iteration 7, loss 0.776 (0.712), acc 84.615 (85.800)
2021-06-11 00:52:26, Epoch 30, Iteration 7, loss 0.000 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.3548167, 3.0258348, 0.36612433, -1.8383056, -1.2144098, -1.6586195, 7.357938, -1.800667, -1.1321467, -1.6942184]
Target sample: 7, Prediction:6, Target's Score:[-1.9596171, 1.7253261, 1.1727879, -1.8324687, -0.3801421, -1.6390336, 8.374968, -2.0033832, -2.3117003, -1.0783156]
Target sample: 13, Prediction:6, Target's Score:[-2.1953404, 4.1402817, -0.084250845, -1.8077481, -1.0113237, -0.83354914, 5.804131, -1.7103274, -2.2188292, -0.09276345]
Target sample: 19, Prediction:6, Target's Score:[-1.7626851, 2.6042995, 0.48388556, -1.6223983, -0.8882827, -1.3003664, 6.4368353, -0.9397285, -1.8238612, -1.1589832]
Target sample: 25, Prediction:1, Target's Score:[-2.106374, 5.019214, 0.5951439, -1.6126747, -1.0512148, -1.290522, 4.936243, -1.6817236, -2.5226693, -0.3299851]
Target sample: 31, Prediction:6, Target's Score:[-1.0310653, 2.4579153, -0.0071913716, -1.3846706, -1.1351987, -1.1059798, 5.6978626, -0.84121966, -1.9572725, -0.6788583]
Target sample: 37, Prediction:1, Target's Score:[-1.9086787, 9.171217, -0.2681097, -2.0351598, -1.6475682, -2.0010169, 3.1537905, -1.8177866, -2.2089787, -0.5650496]
Target sample: 43, Prediction:1, Target's Score:[-1.0722634, 4.4496055, 0.706987, -1.2811247, -0.5373308, -0.23495904, 3.231564, -1.7852359, -1.736824, -1.8014443]
Target sample: 49, Prediction:1, Target's Score:[-1.5284218, 6.8769593, -0.40880793, -1.428558, -1.7476645, -1.9090106, 4.6761384, -2.1808, -1.1421759, -1.2491871]
Target sample: 55, Prediction:6, Target's Score:[-1.8881631, 3.5561438, 0.6799313, -1.7516643, -0.777237, -1.8112932, 7.1002235, -2.0914996, -1.9553959, -1.0314118]
Target sample: 61, Prediction:1, Target's Score:[-2.0429735, 6.7337346, 0.36507425, -1.571734, -1.3331562, -1.5720547, 4.197255, -1.3127058, -2.2802415, -1.25679]
Target sample: 67, Prediction:6, Target's Score:[-1.5667882, 3.1007178, 1.3296224, -0.92755616, -0.722448, -0.9558885, 4.652601, -1.6337881, -2.2601714, -1.0390524]
Target sample: 73, Prediction:1, Target's Score:[-2.0623107, 5.671506, 0.045901887, -1.6177013, -1.2321088, -1.34817, 4.1960454, -1.277181, -2.1985226, -0.23952092]
Target sample: 79, Prediction:6, Target's Score:[-2.2026258, 4.178256, -0.13573004, -1.9587133, -1.2074995, -1.0432824, 5.04699, -1.6063937, -2.3410802, 1.2198191]
Target sample: 85, Prediction:6, Target's Score:[-1.6019379, 3.41791, -0.2633839, -1.4140993, -1.0484443, -1.3146799, 6.3400984, -2.0026796, -1.7130896, -0.38491678]
Target sample: 91, Prediction:6, Target's Score:[-1.316687, 3.8270981, 0.14916457, -1.647427, -1.296521, -1.7821572, 6.5265446, -2.0412838, -1.0027292, -1.3819773]
Current ATTACK acc on target samples: 62.500
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 00:53:25 Epoch 59, Val iteration 0, acc 89.400 (89.400)
2021-06-11 00:53:35 Epoch 59, Val iteration 19, acc 90.400 (89.200)
* Prec: 89.2000015258789
Per class accuracy =  [0.94964887 0.95663376 0.91517532 0.80153703 0.86411227 0.83188969
 0.9063569  0.89777249 0.91104578 0.88518218]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 6, 6, 1, 6, 6, 6, 6, 6, 1, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 6, 6, 6, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 57.5
--------
DPN92
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  600
poison index =  1708
poison index =  770
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 00:53:47, Val iteration 0, acc 94.800 (94.800)
2021-06-11 00:54:07, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 00:54:21, Epoch 0, Iteration 7, loss 0.108 (0.403), acc 98.077 (91.000)
2021-06-11 00:57:00, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.4211981, 5.3077955, -4.8287954, -1.2482312, -2.6486983, -0.59107804, 8.921631, -3.4877987, 3.6661708, -3.3213718]
Target sample: 7, Prediction:6, Target's Score:[-2.7774334, 3.8830137, -3.0996423, -1.8562262, -1.2385308, -2.074634, 9.747179, -4.900345, -0.8556784, 3.523521]
Target sample: 13, Prediction:6, Target's Score:[-2.4161482, 5.076795, -3.2867658, -2.387268, -1.8260531, -2.048224, 8.2908125, -4.975185, -1.411238, 5.345701]
Target sample: 19, Prediction:6, Target's Score:[-0.7745637, -0.36033526, -3.145169, -0.18698439, -1.2161614, -1.6767964, 10.270191, -3.3091362, 2.6339664, -1.9419056]
Target sample: 25, Prediction:6, Target's Score:[-1.3231937, 6.2653613, -4.1787, -1.7029967, -2.2925239, -1.548217, 8.589796, -4.3138704, 1.7868619, -0.9150242]
Target sample: 31, Prediction:6, Target's Score:[-1.2685229, 1.9233735, -3.3130105, -1.19062, -0.8353878, -1.9860208, 8.728772, -3.7181432, 1.5337455, 0.42729494]
Target sample: 37, Prediction:1, Target's Score:[-1.9953619, 10.563805, -4.6809216, -2.3917456, -2.3087971, -1.3806621, 7.205822, -4.9640346, 1.2571954, -0.8777771]
Target sample: 43, Prediction:6, Target's Score:[-2.3202238, 4.0073533, -3.823389, -1.0682484, -0.80100316, -0.75299966, 10.535006, -4.631759, 0.7003797, -1.5132198]
Target sample: 49, Prediction:6, Target's Score:[-2.252788, 6.2130833, -4.307184, -2.026068, -0.9702558, -0.52415997, 10.083207, -4.959622, 1.4532582, -2.354314]
Target sample: 55, Prediction:6, Target's Score:[-2.7464447, 4.8338394, -3.4187455, -1.7714138, -1.3365489, -0.33938617, 12.7672825, -5.003984, 0.08348703, -2.7205582]
Target sample: 61, Prediction:6, Target's Score:[-2.3711674, 8.12782, -4.52962, -2.0908976, -1.9049999, -1.091019, 8.737843, -4.86431, 1.7127937, -1.3345605]
Target sample: 67, Prediction:6, Target's Score:[-1.77062, 0.25784284, -3.4502363, -0.780777, -1.0399289, -1.0383773, 12.472583, -3.9519439, 2.1040218, -2.5138211]
Target sample: 73, Prediction:6, Target's Score:[-0.5615779, 2.9111345, -4.447476, -1.1194414, -2.523291, -1.8863187, 8.496467, -3.5217204, 2.4971378, 0.49547297]
Target sample: 79, Prediction:6, Target's Score:[-1.7500383, 6.308705, -4.5959387, -1.9230179, -2.7830806, -2.6930547, 6.5509176, -4.8806114, 0.20309523, 5.971358]
Target sample: 85, Prediction:6, Target's Score:[-2.7446923, 5.966758, -4.0766582, -1.5777398, -1.5885304, -2.0569794, 9.447215, -5.051536, 0.64924586, 1.4101018]
Target sample: 91, Prediction:6, Target's Score:[-1.628051, 7.8454876, -4.9143476, -2.4623823, -2.7193081, -0.91726923, 8.62005, -4.295646, 2.5911386, -1.7400622]
Current ATTACK acc on target samples: 93.750
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 00:59:34 Epoch 59, Val iteration 0, acc 93.000 (93.000)
2021-06-11 00:59:55 Epoch 59, Val iteration 19, acc 93.600 (93.320)
* Prec: 93.32000160217285
Per class accuracy =  [0.95931069 0.96344903 0.89986218 0.83759593 0.95790432 0.89684269
 0.95418274 0.9505935  0.96190293 0.95148242]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 1, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6
ATTACK acc: 81.25
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  600
poison index =  1708
poison index =  770
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 00:59:58, Val iteration 0, acc 92.600 (92.600)
2021-06-11 01:00:04, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 01:00:06, Epoch 0, Iteration 7, loss 0.326 (0.353), acc 88.462 (89.600)
2021-06-11 01:00:34, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.3739523, 8.9594345, -5.094334, 0.35835624, -4.153958, -2.9512365, 8.367694, -5.040513, 2.860586, -1.6188477]
Target sample: 7, Prediction:6, Target's Score:[-1.3610598, 6.339973, -2.560775, -0.29635254, -1.009228, -2.6218154, 9.379185, -5.141786, -3.5740263, 1.1460187]
Target sample: 13, Prediction:6, Target's Score:[-3.4794195, 4.658966, -2.764495, 2.3387141, -3.4945953, -2.589883, 9.545884, -6.3196936, -4.003818, 6.4112144]
Target sample: 19, Prediction:6, Target's Score:[-3.9834676, 5.8291163, -3.2116048, 3.1061795, -2.7808046, -2.50465, 10.038395, -4.987296, -0.13764805, -1.0679549]
Target sample: 25, Prediction:6, Target's Score:[-3.531308, 5.8168516, -3.9951878, 1.4872166, -3.4285276, -2.510597, 11.7873535, -4.006594, -1.4124287, 0.07709153]
Target sample: 31, Prediction:6, Target's Score:[-3.3199308, 6.2868, -4.3480177, 0.9831755, 1.6440183, -1.4221755, 8.902037, -4.5124636, -3.8847044, -0.014673673]
Target sample: 37, Prediction:6, Target's Score:[-3.0567112, 7.4825997, -4.053207, 0.724041, 0.44966066, -2.4616942, 7.758693, -5.008793, -3.775055, 2.2777355]
Target sample: 43, Prediction:6, Target's Score:[-1.54268, 1.6732969, -1.4894876, 3.6363652, -3.361684, -3.1039972, 11.22072, -6.0210705, 1.0761098, -1.8333328]
Target sample: 49, Prediction:6, Target's Score:[-3.3221877, 2.7330225, -4.0200305, 3.4737473, 1.8164074, -3.0500262, 10.728917, -5.432025, -0.05085407, -2.596993]
Target sample: 55, Prediction:6, Target's Score:[-3.8643553, 6.252561, -4.016441, 1.323617, -1.9936653, -2.742485, 16.774492, -6.4828405, -1.5292944, -3.4156854]
Target sample: 61, Prediction:6, Target's Score:[-4.320397, 6.2341504, -5.0004034, 2.359971, 1.3235091, -0.8390396, 6.892244, -4.7610335, -2.6035984, 1.045682]
Target sample: 67, Prediction:6, Target's Score:[-4.439127, 2.8088827, -2.5272062, 2.9073532, 5.6583214, -1.5563109, 9.164515, -5.900261, -3.911319, -1.8641267]
Target sample: 73, Prediction:6, Target's Score:[-2.8136432, 6.301561, -3.5429473, 0.693002, 0.9889345, -2.5881119, 9.348282, -4.645225, -3.0424623, -0.3955977]
Target sample: 79, Prediction:6, Target's Score:[-1.5196913, 8.012467, -4.0316634, -1.2889646, -5.2902727, -1.7890531, 8.199899, -5.907167, -0.6963348, 4.6243205]
Target sample: 85, Prediction:6, Target's Score:[-3.730523, -0.7343622, 0.017194517, 0.4225196, -1.7494289, -3.5016844, 6.208305, -2.6826074, -0.12156372, 6.1362715]
Target sample: 91, Prediction:1, Target's Score:[1.6642687, 9.135184, -4.1333113, -1.5243675, -4.541517, -4.022312, 6.216481, -4.4619565, 3.701211, -1.7337133]
Current ATTACK acc on target samples: 87.500
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 01:01:01 Epoch 59, Val iteration 0, acc 89.600 (89.600)
2021-06-11 01:01:07 Epoch 59, Val iteration 19, acc 90.400 (89.420)
* Prec: 89.42000160217285
Per class accuracy =  [0.92039989 0.9251889  0.83863556 0.83384528 0.89199452 0.82570511
 0.93720817 0.89295841 0.93137951 0.94074239]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 1, 1, 6, 6, 1, 6, 6, 6, 9, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 4, 4, 4, 6, 4, 6, 1, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 9, 1, 1, 6, 1, 1, 8, 6, 6
ATTACK acc: 72.5
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  600
poison index =  1708
poison index =  770
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 01:01:15, Val iteration 0, acc 96.200 (96.200)
2021-06-11 01:01:27, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 01:01:34, Epoch 0, Iteration 7, loss 0.455 (0.841), acc 92.308 (77.400)
2021-06-11 01:02:44, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-3.6065223, 7.868318, -4.2831683, -2.5925071, -1.8091205, -2.209013, 9.643462, -3.1860487, 2.6748376, -2.4527214]
Target sample: 7, Prediction:6, Target's Score:[-3.3633728, 7.382756, -3.4508522, -3.0992885, -1.3100513, -2.5961814, 8.645035, -3.6229634, -1.6861842, 3.1202462]
Target sample: 13, Prediction:6, Target's Score:[-4.1698093, 4.6817636, -4.435258, -2.8331609, -3.0075803, -2.6144886, 9.196003, -3.8575175, -0.9492501, 7.9980574]
Target sample: 19, Prediction:6, Target's Score:[-3.213514, 5.9988284, -4.051093, -0.016041743, -1.8764513, -2.2913682, 8.5657835, -3.3613658, 0.566103, -0.28060862]
Target sample: 25, Prediction:6, Target's Score:[-3.9595187, 9.865016, -3.9568408, -2.129762, -3.020294, -3.027245, 9.906728, -3.4819088, -1.6601954, 1.4982629]
Target sample: 31, Prediction:6, Target's Score:[-3.9765384, 5.370856, -4.0149775, -2.5055528, -1.7673247, -2.5152328, 10.9349, -3.1170568, -0.02825335, 1.6546556]
Target sample: 37, Prediction:1, Target's Score:[-2.7278452, 9.827034, -4.546917, -1.8269696, 0.24603565, -2.8778977, 7.8254786, -3.9024665, -1.4588649, -0.5168914]
Target sample: 43, Prediction:6, Target's Score:[-2.7320504, 7.1626296, -3.655126, -1.4469006, 0.83946085, -1.9761428, 7.627965, -2.9023633, -0.5887153, -2.2857995]
Target sample: 49, Prediction:6, Target's Score:[-3.360109, 6.141169, -3.935341, -3.1340501, -1.9773382, -2.7304535, 9.955433, -3.788158, 4.6687775, -1.7942779]
Target sample: 55, Prediction:6, Target's Score:[-4.2723575, 7.7545905, -2.8906364, -2.1586192, -2.8945446, -2.3477638, 12.231957, -3.4822235, 0.028822329, -1.9141233]
Target sample: 61, Prediction:6, Target's Score:[-4.2657237, 6.3124776, -3.9785128, -1.679066, -2.25354, -2.6281745, 10.157128, -3.5121303, 1.0096911, 0.87490594]
Target sample: 67, Prediction:6, Target's Score:[-3.8335326, 9.209169, -3.5650449, -2.1525235, -2.7066562, -2.9373028, 9.320705, -3.2003608, -0.74638397, 0.6462973]
Target sample: 73, Prediction:1, Target's Score:[-3.7334979, 11.883647, -4.4364557, -2.187915, -2.0749722, -2.6432042, 7.6953135, -3.3789039, -1.1764855, 0.08577761]
Target sample: 79, Prediction:6, Target's Score:[-3.7157023, 6.3406634, -4.502072, -2.4695616, -2.677842, -3.2704937, 8.252944, -3.9452925, -0.13001612, 6.1254854]
Target sample: 85, Prediction:6, Target's Score:[-3.922462, 5.5574756, -3.8653138, -1.6227317, -2.3103664, -2.6625316, 8.453782, -3.9039083, -0.8243449, 5.11558]
Target sample: 91, Prediction:1, Target's Score:[-2.6781719, 8.582578, -3.9083183, -3.1665757, -0.69562536, -2.5761247, 8.140445, -3.172656, 1.416626, -1.8995332]
Current ATTACK acc on target samples: 81.250
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 01:03:53 Epoch 59, Val iteration 0, acc 93.200 (93.200)
2021-06-11 01:04:06 Epoch 59, Val iteration 19, acc 94.000 (92.730)
* Prec: 92.73000144958496
Per class accuracy =  [0.94179795 0.94281442 0.89256609 0.89956429 0.95307634 0.88098691
 0.93143728 0.92266037 0.95465715 0.95278706]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 1, 1, 6, 6, 6, 6, 6, 6, 9, 6, 6, 6, 6, 6, 1, 1, 1, 6, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 6, 6, 6, 1, 6, 6, 6, 6, 1, 1, 1, 6, 6
ATTACK acc: 58.75
--------
------SUMMARY------
TIME ELAPSED (mins): 23
TARGET INDEX: 6
ResNet50 62.5 57.5 95.46000137329102 89.2000015258789
DPN92 93.75 81.25 95.50000267028808 93.32000160217285
MobileNetV2 87.5 72.5 91.22000160217286 89.42000160217285
GoogLeNet 81.25 58.75 95.41000213623047 92.73000144958496
True False False False False
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 129 images of target 7
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=False, nearest=True, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=7, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/7/target-num-20
torch.Size([200, 1, 3, 32, 32]) torch.Size([22, 3, 32, 32])
Selected nearest neighbors: [1088, 1212, 1698, 600, 1829]
Selected base image indices: [1088, 1212, 1698, 600, 1829]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127]
# Targets: 22, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 01:04:42 Iteration 0 	 Training Loss: 7.567e-01 	 Loss in Target Net: 1.141e+00	  
tensor(-7.3255e-05, device='cuda:0')
 2021-06-11 01:05:48 Iteration 50 	 Training Loss: 1.590e-01 	 Loss in Target Net: 5.367e-01	  
tensor(0.0025, device='cuda:0')
 2021-06-11 01:06:57 Iteration 100 	 Training Loss: 1.399e-01 	 Loss in Target Net: 4.810e-01	  
tensor(-0.0152, device='cuda:0')
 2021-06-11 01:08:05 Iteration 150 	 Training Loss: 1.269e-01 	 Loss in Target Net: 4.901e-01	  
tensor(-0.0376, device='cuda:0')
 2021-06-11 01:09:15 Iteration 200 	 Training Loss: 1.251e-01 	 Loss in Target Net: 4.801e-01	  
tensor(-0.0610, device='cuda:0')
 2021-06-11 01:10:21 Iteration 250 	 Training Loss: 1.194e-01 	 Loss in Target Net: 4.926e-01	  
tensor(-0.0783, device='cuda:0')
 2021-06-11 01:11:28 Iteration 300 	 Training Loss: 1.153e-01 	 Loss in Target Net: 4.630e-01	  
tensor(-0.0928, device='cuda:0')
 2021-06-11 01:12:34 Iteration 350 	 Training Loss: 1.156e-01 	 Loss in Target Net: 4.366e-01	  
tensor(-0.1065, device='cuda:0')
 2021-06-11 01:13:40 Iteration 400 	 Training Loss: 1.079e-01 	 Loss in Target Net: 4.551e-01	  
tensor(-0.1160, device='cuda:0')
 2021-06-11 01:14:45 Iteration 450 	 Training Loss: 1.104e-01 	 Loss in Target Net: 4.760e-01	  
tensor(-0.1228, device='cuda:0')
 2021-06-11 01:15:50 Iteration 500 	 Training Loss: 1.097e-01 	 Loss in Target Net: 5.178e-01	  
tensor(-0.1284, device='cuda:0')
 2021-06-11 01:16:56 Iteration 550 	 Training Loss: 1.082e-01 	 Loss in Target Net: 4.714e-01	  
tensor(-0.1343, device='cuda:0')
 2021-06-11 01:17:59 Iteration 600 	 Training Loss: 1.044e-01 	 Loss in Target Net: 4.195e-01	  
tensor(-0.1426, device='cuda:0')
 2021-06-11 01:19:05 Iteration 650 	 Training Loss: 1.020e-01 	 Loss in Target Net: 4.801e-01	  
tensor(-0.1504, device='cuda:0')
 2021-06-11 01:20:10 Iteration 700 	 Training Loss: 1.060e-01 	 Loss in Target Net: 4.898e-01	  
tensor(-0.1546, device='cuda:0')
 2021-06-11 01:21:16 Iteration 750 	 Training Loss: 1.015e-01 	 Loss in Target Net: 4.320e-01	  
tensor(-0.1581, device='cuda:0')
 2021-06-11 01:22:22 Iteration 800 	 Training Loss: 1.044e-01 	 Loss in Target Net: 4.712e-01	  
tensor(-0.1622, device='cuda:0')
 2021-06-11 01:23:27 Iteration 850 	 Training Loss: 1.065e-01 	 Loss in Target Net: 4.508e-01	  
tensor(-0.1631, device='cuda:0')
 2021-06-11 01:24:33 Iteration 900 	 Training Loss: 9.853e-02 	 Loss in Target Net: 5.012e-01	  
tensor(-0.1667, device='cuda:0')
 2021-06-11 01:25:38 Iteration 950 	 Training Loss: 9.535e-02 	 Loss in Target Net: 3.824e-01	  
tensor(-0.1758, device='cuda:0')
 2021-06-11 01:26:43 Iteration 999 	 Training Loss: 1.002e-01 	 Loss in Target Net: 4.697e-01	  
tensor(-0.1799, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  600
poison index =  1829
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 01:26:48, Val iteration 0, acc 94.200 (94.200)
2021-06-11 01:26:58, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 01:27:03, Epoch 0, Iteration 7, loss 0.912 (0.861), acc 82.692 (88.000)
2021-06-11 01:28:04, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-3.7054698, 0.45020542, -1.1644292, -2.443523, 0.79068947, -4.314558, 9.874353, -2.5324702, 2.101874, 1.211012]
Target sample: 7, Prediction:6, Target's Score:[-3.4866984, 2.3793135, -0.6030931, -2.02709, -0.36442307, -4.045582, 11.062772, -2.5910718, -0.15087003, 0.11902869]
Target sample: 13, Prediction:6, Target's Score:[-4.0228987, 1.3259556, 0.06714172, -2.1725419, 1.3218403, -4.172917, 13.038227, -3.2729876, -1.2687553, -0.5248913]
Target sample: 19, Prediction:1, Target's Score:[-2.9906113, 9.247289, -1.4812436, -0.5770859, -3.4866192, -4.0510826, 9.238698, -2.56751, -0.5074265, -2.5166225]
Target sample: 25, Prediction:6, Target's Score:[-1.1344242, 7.7662377, -1.854013, -1.4635946, -3.699546, -4.2181387, 7.9932117, -2.2361944, 3.732897, -4.6197805]
Target sample: 31, Prediction:6, Target's Score:[-2.4869785, 5.74047, -2.9441452, -2.5766988, -3.0287628, -4.783189, 9.068418, -2.946384, 8.485329, -4.2516937]
Target sample: 37, Prediction:6, Target's Score:[-3.4191418, 8.053574, -1.5652455, -0.84433776, -3.579076, -4.1337166, 8.903701, -3.244193, 4.635164, -4.527662]
Target sample: 43, Prediction:1, Target's Score:[-3.987719, 14.556865, -2.1610212, -1.4766366, -5.6214266, -4.602689, 10.045154, -3.4083254, 2.0049057, -5.0058966]
Target sample: 49, Prediction:1, Target's Score:[-3.0582597, 11.180006, -1.074186, -1.6040999, -4.038515, -4.591392, 10.571576, -3.0174074, 0.28263944, -4.323091]
Target sample: 55, Prediction:6, Target's Score:[-2.9950004, 6.2163568, -1.313029, -1.6677608, -1.7313482, -4.4549603, 11.558964, -3.1362472, 0.5640881, -2.727665]
Target sample: 61, Prediction:6, Target's Score:[-3.5642762, 4.6260376, -1.8638867, -1.4943213, -1.5631207, -4.252424, 10.594775, -3.2786243, 4.8058596, -3.7348397]
Target sample: 67, Prediction:6, Target's Score:[-4.489, 7.0022993, -1.9692512, -2.0940313, -1.9753778, -3.963597, 10.918931, -3.3059826, 3.2647543, -3.0994282]
Target sample: 73, Prediction:6, Target's Score:[-3.9284813, 8.835345, -1.3298771, -2.0279043, -2.6429565, -4.234945, 10.761245, -3.0818477, 0.13257554, -2.1660903]
Target sample: 79, Prediction:1, Target's Score:[-3.5565078, 11.754639, -1.5061045, -1.6165626, -3.902061, -3.9747984, 9.673604, -2.835635, -0.49271485, -3.2270916]
Target sample: 85, Prediction:1, Target's Score:[-2.6332114, 10.251953, -1.3527668, -0.6401888, -4.0170617, -3.7896798, 8.244758, -3.0768597, 1.8574923, -4.561117]
Target sample: 91, Prediction:1, Target's Score:[-2.8207304, 10.249594, -2.2588065, -1.2061938, -4.3462543, -3.1262429, 6.7008038, -2.6500425, 2.330912, -2.5990698]
Target sample: 97, Prediction:6, Target's Score:[-3.0779192, 8.275445, -2.8874938, -2.1669414, -3.3196764, -4.136828, 9.1998, -3.0231853, 5.2758536, -3.849563]
Target sample: 103, Prediction:1, Target's Score:[-3.1022763, 10.31139, -3.0356278, -1.24095, -4.1960096, -3.502141, 7.7265463, -2.9562354, 2.8575652, -2.569638]
Target sample: 109, Prediction:1, Target's Score:[-3.3405676, 10.479935, -2.17434, -1.6940922, -3.787698, -4.028063, 9.522429, -2.9094837, 0.18470153, -1.9299259]
Target sample: 115, Prediction:6, Target's Score:[-3.0660443, 3.0418983, -0.20323576, -2.0111585, -0.41931948, -4.150457, 11.379159, -2.8670666, 0.12300897, -1.5365081]
Target sample: 121, Prediction:6, Target's Score:[-4.3403196, 2.1979468, -1.1471331, -1.3652074, -0.79824966, -4.169589, 8.546264, -2.3913457, 1.4816173, 2.2525702]
Target sample: 127, Prediction:6, Target's Score:[-4.1860933, 0.8481326, -1.1207519, -1.8852147, 0.15880573, -3.8670657, 10.318028, -2.8197055, 3.119536, -0.30117506]
Current ATTACK acc on target samples: 63.636
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 01:29:03 Epoch 59, Val iteration 0, acc 91.600 (91.600)
2021-06-11 01:29:13 Epoch 59, Val iteration 19, acc 92.600 (91.740)
* Prec: 91.74000129699706
Per class accuracy =  [0.93720094 0.9447312  0.87612987 0.85123238 0.92245445 0.87610131
 0.95989755 0.93072988 0.96389483 0.9122391 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 8, 6, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 72.89719626168224
--------
DPN92
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  600
poison index =  1829
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 01:29:24, Val iteration 0, acc 94.800 (94.800)
2021-06-11 01:29:45, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 01:29:59, Epoch 0, Iteration 7, loss 0.324 (0.422), acc 90.385 (90.600)
2021-06-11 01:32:37, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.2105017, 0.03229567, -0.49407542, -0.25555775, -2.1335368, -2.4505289, 8.590009, -3.7451239, 3.610407, -0.546337]
Target sample: 7, Prediction:6, Target's Score:[-3.8787577, 1.6299541, 0.06526226, -0.18339929, -1.2559559, -1.3996389, 8.758907, -4.209194, -0.77620953, 1.6513728]
Target sample: 13, Prediction:6, Target's Score:[-3.469356, 0.4889441, 1.5697612, -0.94993067, -0.990303, -1.4369992, 10.999149, -4.6280303, -0.3522841, -0.7969418]
Target sample: 19, Prediction:1, Target's Score:[-1.6922107, 9.484824, -1.7655371, -0.7210839, -2.4469655, -3.5261304, 6.946312, -3.6744907, -1.2195351, -0.7953823]
Target sample: 25, Prediction:1, Target's Score:[-0.513891, 12.106492, -1.5000093, -0.8597046, -2.5340695, -4.290075, 3.4271553, -3.7042065, -1.2409686, -0.26469263]
Target sample: 31, Prediction:1, Target's Score:[-1.0775851, 11.822787, -1.3842605, -1.0502295, -2.4962888, -4.322561, 3.6662142, -3.903546, -0.5536538, -0.07776718]
Target sample: 37, Prediction:1, Target's Score:[-1.6091297, 8.836884, -0.9365033, -1.7709333, -0.8985544, -3.5783603, 5.249093, -4.158859, -0.7205773, 0.13056001]
Target sample: 43, Prediction:1, Target's Score:[-0.9053189, 12.409361, -1.5245327, -1.7308244, -1.8918595, -3.9835832, 3.7207901, -4.355216, -1.5220437, 0.43049455]
Target sample: 49, Prediction:1, Target's Score:[-1.3531876, 9.51881, -0.5648587, -1.6218493, 0.004382807, -4.2801704, 6.768211, -4.6554327, -2.076979, -1.136858]
Target sample: 55, Prediction:6, Target's Score:[-2.2072978, 4.9806485, -0.6696038, -1.5447413, -1.6669108, -2.9727457, 10.040264, -4.325872, -2.4424505, 1.3020043]
Target sample: 61, Prediction:1, Target's Score:[-2.3416102, 7.077739, -0.7746013, -0.5491997, -2.1353636, -3.0213974, 6.4458294, -3.3564897, -0.12146402, -0.7241025]
Target sample: 67, Prediction:6, Target's Score:[-2.9572568, 5.9866858, -1.7361876, -1.4940611, -1.9497072, -1.4237531, 6.5361085, -4.0680366, 0.7203593, 0.853135]
Target sample: 73, Prediction:1, Target's Score:[-1.9897965, 8.279674, -0.24259585, -1.8003615, -1.8672376, -2.9385283, 6.992487, -4.249759, -0.6808291, -0.9442341]
Target sample: 79, Prediction:1, Target's Score:[-2.4190798, 9.794837, -0.8228842, -2.0846033, -0.8617504, -3.2835126, 7.1243587, -4.563951, -1.7968069, -0.47926116]
Target sample: 85, Prediction:1, Target's Score:[-1.4212488, 10.891183, -1.2158499, -1.1393479, -2.2009575, -3.152704, 3.9259355, -4.189124, -1.392096, 0.50196284]
Target sample: 91, Prediction:1, Target's Score:[-0.14541167, 12.949145, -2.168942, -2.1850755, -3.3767407, -3.259596, 3.1157737, -3.6958318, -1.6292074, 1.0487173]
Target sample: 97, Prediction:1, Target's Score:[-0.67417735, 12.041056, -1.9863311, -1.3653442, -3.14834, -4.3776383, 4.668848, -3.5774682, -0.67321175, -0.28087053]
Target sample: 103, Prediction:1, Target's Score:[-0.81639093, 11.372541, -2.134278, -1.397949, -2.8515751, -3.1618738, 4.1409435, -3.8436966, -1.243722, 0.5401555]
Target sample: 109, Prediction:1, Target's Score:[-1.3452545, 9.581444, -1.4666005, -1.5982816, -2.4479642, -3.7667103, 6.320207, -3.8104568, -0.98369247, 0.09226126]
Target sample: 115, Prediction:6, Target's Score:[-2.7759514, 2.7071035, 0.27420574, -1.4188249, -0.67914397, -2.4295056, 10.830299, -4.535942, -2.2648344, 0.7412115]
Target sample: 121, Prediction:9, Target's Score:[-3.5043137, 1.3709176, 0.41192943, 3.2238662, -1.7316167, -3.0123515, 2.8303409, -2.2459815, -0.93014747, 3.978621]
Target sample: 127, Prediction:6, Target's Score:[-3.337821, 0.5859498, -0.096612155, -0.07536211, -1.6050243, -1.4637815, 8.294783, -4.0928035, 2.052281, 0.14899068]
Current ATTACK acc on target samples: 31.818
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 01:35:11 Epoch 59, Val iteration 0, acc 92.600 (92.600)
2021-06-11 01:35:32 Epoch 59, Val iteration 19, acc 92.800 (93.010)
* Prec: 93.01000099182129
Per class accuracy =  [0.92857679 0.96265386 0.89364946 0.84772478 0.9600001  0.88855341
 0.94465882 0.94661047 0.9721438  0.95777602]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 6, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 6, 1, 6, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 34.57943925233645
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  600
poison index =  1829
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 01:35:36, Val iteration 0, acc 92.600 (92.600)
2021-06-11 01:35:42, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 01:35:44, Epoch 0, Iteration 7, loss 0.387 (0.371), acc 86.538 (89.600)
2021-06-11 01:36:11, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:9, Target's Score:[-2.8128464, 2.1804364, -2.3988142, 5.0083547, -2.550421, -2.6360412, 2.1361568, -4.570724, 0.87912583, 5.030831]
Target sample: 7, Prediction:3, Target's Score:[-1.6661353, 2.4361613, 1.5940236, 4.3811784, -4.3668914, -1.9664431, 1.7201179, -4.3714957, -1.8522806, 4.3657093]
Target sample: 13, Prediction:6, Target's Score:[-1.6005441, -1.690048, -1.2435433, 5.48744, -3.357345, -2.2838292, 9.622775, -6.270297, -1.1055789, 2.6742027]
Target sample: 19, Prediction:1, Target's Score:[-1.6175436, 10.302589, -4.250618, 3.4426317, -5.2521777, -1.088441, 5.438876, -6.019095, -4.7850456, 4.094056]
Target sample: 25, Prediction:1, Target's Score:[-1.3211976, 10.60754, -2.737353, 0.7661946, -3.962206, -2.4859183, 5.7954793, -6.6589866, -0.7062159, 0.96190923]
Target sample: 31, Prediction:1, Target's Score:[1.5180837, 13.4646225, -2.979088, 2.3146882, -5.878627, -2.6763065, 1.2734244, -6.4282627, -1.9119928, 1.5740569]
Target sample: 37, Prediction:1, Target's Score:[-1.7409555, 12.021763, -4.6733675, 4.016408, -3.758321, -1.2707362, 2.0535522, -6.740953, -0.2191402, 0.6002405]
Target sample: 43, Prediction:1, Target's Score:[-1.2327933, 12.848311, -5.0500817, 0.9119129, -2.0296125, 0.42086065, 2.523829, -6.629232, -2.7686856, 1.307969]
Target sample: 49, Prediction:1, Target's Score:[-0.8189711, 13.419292, -3.3991551, 0.2348877, -3.4237146, -1.3290902, 4.360412, -6.136154, -4.965288, 2.3517413]
Target sample: 55, Prediction:1, Target's Score:[-1.7382663, 11.4443035, -4.2918277, 3.6285677, -5.459018, -2.4692645, 4.061161, -6.679376, -3.9505947, 5.765459]
Target sample: 61, Prediction:1, Target's Score:[-1.920233, 6.12122, -2.0235572, 1.7384696, -5.302625, -2.524852, 5.56652, -6.033721, 0.83770895, 3.7905765]
Target sample: 67, Prediction:1, Target's Score:[-2.383185, 7.3939342, -3.1855705, 1.7636824, -5.4077272, -1.113128, 5.341603, -6.801304, 0.76280916, 3.8842719]
Target sample: 73, Prediction:1, Target's Score:[-0.066361345, 10.20756, -2.5167215, 5.142785, -4.948196, -1.1570007, 2.4847758, -8.062822, -4.82812, 4.041928]
Target sample: 79, Prediction:1, Target's Score:[-0.5007892, 16.136219, -3.15182, -0.85636246, -5.683695, -1.6578152, 2.3475308, -5.97906, -2.3044102, 1.9097843]
Target sample: 85, Prediction:1, Target's Score:[-0.32886386, 10.913529, -3.673442, 2.7935193, -5.8773704, -0.5301494, 4.6193438, -7.1941156, -0.052115165, -0.42264125]
Target sample: 91, Prediction:1, Target's Score:[-0.3467666, 12.655323, -2.885742, 0.64129084, -5.8596616, -2.1094012, 1.7268751, -5.92507, 0.59406024, 1.757461]
Target sample: 97, Prediction:1, Target's Score:[-0.5590098, 14.020477, -4.301752, 0.2442637, -5.209734, -2.6480353, 3.1126702, -6.335208, 1.8757246, 0.05590542]
Target sample: 103, Prediction:1, Target's Score:[-1.08142, 12.297441, -4.183952, 1.1055527, -5.854337, -2.0779536, 2.3779793, -5.75402, -3.9837148, 7.452173]
Target sample: 109, Prediction:1, Target's Score:[-0.8408311, 8.244191, -4.5254455, 4.22967, -4.798827, -2.2680812, 5.3219075, -5.6290984, -4.7818003, 5.3325753]
Target sample: 115, Prediction:1, Target's Score:[-1.5367239, 5.2226386, -2.0689332, 3.7511117, -3.2294269, -3.6917768, 3.8475502, -5.054924, -0.10206454, 3.1323035]
Target sample: 121, Prediction:9, Target's Score:[-3.2978683, -1.050015, -2.1041164, 4.405526, -2.3296096, -3.1732306, 3.9162478, -4.009406, -1.0696867, 9.005705]
Target sample: 127, Prediction:9, Target's Score:[0.08248327, 6.446801, -2.5292423, 4.752075, -5.925123, -1.32318, 1.3560753, -6.346494, -3.4905207, 7.2774167]
Current ATTACK acc on target samples: 4.545
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 01:36:39 Epoch 59, Val iteration 0, acc 88.800 (88.800)
2021-06-11 01:36:45 Epoch 59, Val iteration 19, acc 90.200 (89.280)
* Prec: 89.28000144958496
Per class accuracy =  [0.92539185 0.92007897 0.84478896 0.82052048 0.88446163 0.82596336
 0.93298163 0.88831089 0.93176227 0.94989753]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 9, 3, 9, 9, 3, 3, 3, 3, 3, 3, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 6, 6, 6, 1, 3, 9, 1, 9, 9, 9, 6, 3, 3, 9, 3, 3
ATTACK acc: 8.411214953271028
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  600
poison index =  1829
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 01:36:53, Val iteration 0, acc 96.200 (96.200)
2021-06-11 01:37:05, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 01:37:11, Epoch 0, Iteration 7, loss 0.452 (0.758), acc 86.538 (80.600)
2021-06-11 01:38:22, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.9205493, 2.9379733, -2.0316594, 0.61044824, -2.1476028, -2.822703, 7.751142, -3.718367, 3.1393318, -1.7973055]
Target sample: 7, Prediction:6, Target's Score:[-1.9951967, 3.0717669, -0.14145128, 0.34781486, -1.5595921, -2.0230143, 7.328462, -2.2493296, -1.0610682, -1.7109563]
Target sample: 13, Prediction:6, Target's Score:[-3.4486768, 5.125313, -1.3068931, 1.3053756, -3.03366, -3.0447268, 9.887377, -2.0580363, -1.3621025, -2.0505629]
Target sample: 19, Prediction:6, Target's Score:[-0.3308008, 6.746992, -1.8614397, 2.4922478, -3.394908, -2.8632765, 6.9519687, -3.3403728, -2.4291322, -1.9332883]
Target sample: 25, Prediction:1, Target's Score:[-1.3315817, 11.496571, -2.5119545, 0.072933465, -3.4058175, -3.2257128, 4.5433183, -3.3813145, -1.8824806, -0.32329]
Target sample: 31, Prediction:6, Target's Score:[-0.09445556, 6.1260066, -1.7524307, 0.4210159, -3.0342886, -3.4922862, 8.666055, -3.4139726, -1.908664, -1.4930186]
Target sample: 37, Prediction:6, Target's Score:[-1.4882921, 6.836073, -1.815432, 0.5095034, -3.7246876, -3.4771183, 8.038769, -3.7944806, -0.17478624, -0.88602936]
Target sample: 43, Prediction:1, Target's Score:[-3.1091433, 8.72919, -2.5135305, 1.1982732, -4.232226, -2.4460635, 6.7404656, -3.3943586, -2.4525208, 1.5201855]
Target sample: 49, Prediction:1, Target's Score:[-3.3299985, 9.719851, -2.2874207, 0.77302134, -3.6635754, -2.8915262, 7.0646915, -2.339993, -2.114689, -0.89327294]
Target sample: 55, Prediction:6, Target's Score:[-1.9908731, 6.1544905, -2.5230596, 0.83050835, -2.684154, -3.24726, 8.514013, -2.7955084, -0.5494, -1.6905413]
Target sample: 61, Prediction:6, Target's Score:[-3.4999373, 4.5522985, -1.9665214, 1.6638318, -2.5081987, -2.3330123, 7.70276, -2.7450252, 1.105603, -1.9625752]
Target sample: 67, Prediction:6, Target's Score:[-4.470427, 5.7692266, -2.1644711, 1.2415161, -0.28873068, -2.9280074, 7.0113883, -3.864686, 1.7692797, -2.068347]
Target sample: 73, Prediction:1, Target's Score:[-3.1666512, 6.865945, -1.5741116, 0.8863459, -2.8210478, -3.5082898, 6.253846, -2.2241273, -1.957646, 1.2737601]
Target sample: 79, Prediction:1, Target's Score:[-3.243994, 8.0818, -2.004868, 0.9150117, -2.457338, -2.3918147, 5.6723447, -3.6010547, -1.9528171, 1.0156589]
Target sample: 85, Prediction:1, Target's Score:[-3.3076792, 10.803045, -2.9609706, -0.96183723, -4.2505016, -0.37086624, 6.379189, -3.5002084, -2.9818, 1.1907599]
Target sample: 91, Prediction:1, Target's Score:[-0.10861232, 10.299269, -2.2877028, -1.394159, -4.3029914, -2.426248, 6.0147443, -3.4711297, -2.403821, 0.123719946]
Target sample: 97, Prediction:6, Target's Score:[0.86478174, 6.8987594, -1.8752695, -1.3579972, -3.0959783, -2.7281926, 8.1840925, -3.8564801, -1.691707, -1.3190755]
Target sample: 103, Prediction:1, Target's Score:[-1.8990465, 9.281436, -2.2184958, 0.47446796, -3.7218845, -2.250014, 3.8356154, -2.973646, -1.3164899, 0.8316133]
Target sample: 109, Prediction:1, Target's Score:[-2.9896758, 10.483003, -1.8336099, 0.25988546, -4.3150587, -2.5075755, 5.9769235, -3.1651778, -1.9022652, 0.03595443]
Target sample: 115, Prediction:6, Target's Score:[-2.9974022, 3.8341398, -2.1476076, 0.89873946, -2.9457805, -2.8164062, 8.660779, -2.8043456, -0.057369146, 0.38522625]
Target sample: 121, Prediction:1, Target's Score:[-3.259581, 4.370888, -1.952212, 3.0571191, -1.5498171, -2.6625338, 4.1616535, -3.1341987, -0.7835163, 1.7784946]
Target sample: 127, Prediction:6, Target's Score:[-3.0834732, 4.124037, -1.3996153, 0.6506496, -0.23734918, -1.2043403, 4.7776847, -3.7613626, 1.917989, -1.7796514]
Current ATTACK acc on target samples: 54.545
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 01:39:31 Epoch 59, Val iteration 0, acc 93.400 (93.400)
2021-06-11 01:39:43 Epoch 59, Val iteration 19, acc 91.200 (92.020)
* Prec: 92.02000198364257
Per class accuracy =  [0.958166   0.93995582 0.85295181 0.81746701 0.95215788 0.89377126
 0.94420395 0.93363075 0.9532767  0.95396678]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 1, 6, 1, 1, 1, 6, 1, 6, 6, 1, 6, 1, 1, 1, 1, 6, 6, 1, 1, 6, 1, 1, 1, 6, 1, 6, 6, 6, 6, 1, 1, 1, 1, 1, 6, 6, 1, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 6, 1, 1, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 49.532710280373834
--------
------SUMMARY------
TIME ELAPSED (mins): 22
TARGET INDEX: 7
ResNet50 63.63636363636363 72.89719626168224 95.46000137329102 91.74000129699706
DPN92 31.818181818181817 34.57943925233645 95.50000267028808 93.01000099182129
MobileNetV2 4.545454545454546 8.411214953271028 91.22000160217286 89.28000144958496
GoogLeNet 54.54545454545455 49.532710280373834 95.41000213623047 92.02000198364257
True False False False True
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 129 images of target 7
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=True, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=7, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/7/target-num-20
torch.Size([200, 1, 3, 32, 32]) torch.Size([22, 3, 32, 32])
Selected nearest neighbors: [1088, 1212, 1698, 600, 1829]
Selected base image indices: [1088, 1212, 1698, 600, 1829]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127]
# Targets: 22, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 01:40:21 Iteration 0 	 Training Loss: 7.290e-01 	 Loss in Target Net: 6.062e-01	  
tensor(-0.0011, device='cuda:0')
 2021-06-11 01:41:33 Iteration 50 	 Training Loss: 3.000e-01 	 Loss in Target Net: 3.368e-01	  
tensor(-0.0355, device='cuda:0')
 2021-06-11 01:42:46 Iteration 100 	 Training Loss: 2.567e-01 	 Loss in Target Net: 3.181e-01	  
tensor(-0.0800, device='cuda:0')
 2021-06-11 01:43:59 Iteration 150 	 Training Loss: 2.447e-01 	 Loss in Target Net: 2.945e-01	  
tensor(-0.1040, device='cuda:0')
 2021-06-11 01:45:11 Iteration 200 	 Training Loss: 2.379e-01 	 Loss in Target Net: 2.969e-01	  
tensor(-0.1136, device='cuda:0')
 2021-06-11 01:46:24 Iteration 250 	 Training Loss: 2.353e-01 	 Loss in Target Net: 2.941e-01	  
tensor(-0.1211, device='cuda:0')
 2021-06-11 01:47:39 Iteration 300 	 Training Loss: 2.291e-01 	 Loss in Target Net: 3.085e-01	  
tensor(-0.1283, device='cuda:0')
 2021-06-11 01:48:54 Iteration 350 	 Training Loss: 2.268e-01 	 Loss in Target Net: 3.052e-01	  
tensor(-0.1327, device='cuda:0')
 2021-06-11 01:50:06 Iteration 400 	 Training Loss: 2.266e-01 	 Loss in Target Net: 2.890e-01	  
tensor(-0.1344, device='cuda:0')
 2021-06-11 01:51:20 Iteration 450 	 Training Loss: 2.295e-01 	 Loss in Target Net: 2.842e-01	  
tensor(-0.1324, device='cuda:0')
 2021-06-11 01:52:35 Iteration 500 	 Training Loss: 2.334e-01 	 Loss in Target Net: 2.907e-01	  
tensor(-0.1326, device='cuda:0')
 2021-06-11 01:53:52 Iteration 550 	 Training Loss: 2.285e-01 	 Loss in Target Net: 3.003e-01	  
tensor(-0.1298, device='cuda:0')
 2021-06-11 01:55:05 Iteration 600 	 Training Loss: 2.267e-01 	 Loss in Target Net: 3.219e-01	  
tensor(-0.1302, device='cuda:0')
 2021-06-11 01:56:19 Iteration 650 	 Training Loss: 2.299e-01 	 Loss in Target Net: 3.137e-01	  
tensor(-0.1325, device='cuda:0')
 2021-06-11 01:57:33 Iteration 700 	 Training Loss: 2.289e-01 	 Loss in Target Net: 2.967e-01	  
tensor(-0.1345, device='cuda:0')
 2021-06-11 01:58:46 Iteration 750 	 Training Loss: 2.264e-01 	 Loss in Target Net: 3.014e-01	  
tensor(-0.1339, device='cuda:0')
 2021-06-11 01:59:58 Iteration 800 	 Training Loss: 2.271e-01 	 Loss in Target Net: 3.079e-01	  
tensor(-0.1338, device='cuda:0')
 2021-06-11 02:01:11 Iteration 850 	 Training Loss: 2.282e-01 	 Loss in Target Net: 2.931e-01	  
tensor(-0.1344, device='cuda:0')
 2021-06-11 02:02:25 Iteration 900 	 Training Loss: 2.273e-01 	 Loss in Target Net: 2.868e-01	  
tensor(-0.1329, device='cuda:0')
 2021-06-11 02:03:39 Iteration 950 	 Training Loss: 2.263e-01 	 Loss in Target Net: 2.921e-01	  
tensor(-0.1354, device='cuda:0')
 2021-06-11 02:04:52 Iteration 999 	 Training Loss: 2.249e-01 	 Loss in Target Net: 3.252e-01	  
tensor(-0.1329, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  600
poison index =  1829
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 02:04:57, Val iteration 0, acc 94.200 (94.200)
2021-06-11 02:05:07, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 02:05:13, Epoch 0, Iteration 7, loss 0.720 (0.605), acc 86.538 (88.000)
2021-06-11 02:06:13, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-4.130366, 0.2658343, -0.36005333, -1.4288799, 1.1409707, -3.5174203, 8.975597, -3.2196121, 3.1352313, -0.82544833]
Target sample: 7, Prediction:6, Target's Score:[-4.373292, 0.21004595, 0.4346538, -0.1657849, 0.5482578, -2.9481416, 10.391232, -3.2752995, 0.4597761, -1.2127789]
Target sample: 13, Prediction:6, Target's Score:[-5.39639, 2.0265553, 0.7302128, -0.59225297, 0.0703124, -3.3432138, 12.242837, -3.986494, -0.9989106, -0.68092096]
Target sample: 19, Prediction:6, Target's Score:[-4.707722, 7.7481604, -0.036077354, -0.84397656, -0.8657607, -3.0519602, 8.174619, -2.982927, -0.77400243, -2.672964]
Target sample: 25, Prediction:6, Target's Score:[-3.8730457, 6.5837007, -0.34474644, -1.1036792, -0.33160606, -3.2133992, 7.4671016, -2.5906878, 0.72626394, -3.324637]
Target sample: 31, Prediction:6, Target's Score:[-4.4550533, 5.156315, -0.8642181, -1.4266375, -1.4452685, -3.8597622, 9.511843, -3.574787, 4.033346, -3.0600672]
Target sample: 37, Prediction:6, Target's Score:[-4.8162417, 5.552485, -0.22854523, -0.91262436, -0.5884149, -3.505874, 9.181922, -3.3675337, 1.8003206, -3.105893]
Target sample: 43, Prediction:1, Target's Score:[-5.012811, 11.175213, -0.40000683, -1.9536791, -1.744534, -3.5619466, 8.388726, -3.3021598, -0.027597224, -3.5954535]
Target sample: 49, Prediction:1, Target's Score:[-4.2669415, 8.607914, 0.5241019, -1.4368083, -0.81072026, -3.3839962, 8.516502, -3.2058907, -0.756159, -3.7919652]
Target sample: 55, Prediction:6, Target's Score:[-5.0855503, 5.309965, -0.14533044, -0.7466113, -0.6004326, -3.4991918, 11.330898, -3.731814, 0.061265998, -2.8475623]
Target sample: 61, Prediction:6, Target's Score:[-4.449957, 4.11143, -0.4006226, -0.48647204, -0.50756705, -3.2320082, 9.556743, -3.1211796, 1.5136031, -2.9530141]
Target sample: 67, Prediction:6, Target's Score:[-4.942704, 4.6171107, -0.7021259, -0.9708394, 0.123994835, -3.073694, 10.039277, -3.402041, 1.1578705, -2.82418]
Target sample: 73, Prediction:6, Target's Score:[-4.7980905, 6.063509, 0.15634242, -1.1412044, -0.8799528, -3.0394576, 9.784676, -3.2998106, -0.49308628, -2.3301644]
Target sample: 79, Prediction:1, Target's Score:[-4.4978137, 10.379395, -0.21911204, -1.9667795, -1.141128, -2.9484348, 7.3258963, -2.8141396, -0.70543635, -3.450355]
Target sample: 85, Prediction:1, Target's Score:[-3.17243, 8.410638, -0.3455584, -1.4808968, -1.1257733, -2.785533, 6.448069, -2.9199095, 0.557486, -3.6082478]
Target sample: 91, Prediction:1, Target's Score:[-3.9834683, 7.236357, -0.6810013, -2.0736396, -1.7741014, -2.5994148, 6.9405107, -2.892592, 0.9494266, -1.1325656]
Target sample: 97, Prediction:6, Target's Score:[-3.9167607, 5.462537, -1.00806, -2.1982293, -1.7288766, -3.7174184, 8.493461, -3.3172317, 4.350136, -2.4108484]
Target sample: 103, Prediction:6, Target's Score:[-3.9675539, 6.7391677, -1.1569755, -1.4373498, -1.6520342, -3.1674056, 7.9386816, -3.1138542, 1.8913275, -2.0709467]
Target sample: 109, Prediction:6, Target's Score:[-4.638911, 8.494414, -0.083777085, -1.5577265, -1.4811281, -3.28395, 8.891983, -3.0483985, -0.49667674, -2.7945626]
Target sample: 115, Prediction:6, Target's Score:[-4.7180276, 4.025511, 0.6336615, -1.1182039, -0.34755397, -3.201744, 10.696256, -3.3661163, -0.31132612, -2.2426496]
Target sample: 121, Prediction:6, Target's Score:[-4.2009163, -0.13186671, -0.3255154, -0.6005919, 1.043577, -3.0432558, 7.589779, -2.8659513, 0.6870985, 1.8702209]
Target sample: 127, Prediction:6, Target's Score:[-4.8678327, 0.302425, -0.8230715, -0.020318154, 1.9749186, -3.513009, 9.787747, -3.585794, 2.5660312, -1.7880256]
Current ATTACK acc on target samples: 77.273
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 02:07:11 Epoch 59, Val iteration 0, acc 91.600 (91.600)
2021-06-11 02:07:22 Epoch 59, Val iteration 19, acc 90.600 (90.670)
* Prec: 90.67000045776368
Per class accuracy =  [0.94800344 0.94176662 0.80642976 0.79723149 0.93920709 0.88202735
 0.97115613 0.90233562 0.95585154 0.92342198]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 1, 1, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 1, 1, 6, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 82.24299065420561
--------
DPN92
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  600
poison index =  1829
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 02:07:33, Val iteration 0, acc 94.800 (94.800)
2021-06-11 02:07:54, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 02:08:08, Epoch 0, Iteration 7, loss 0.434 (0.417), acc 88.462 (90.000)
2021-06-11 02:10:46, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-3.1368792, 0.37163842, -0.87165105, -0.069794625, -0.9106843, -2.4745183, 8.903783, -4.1141963, 2.2824824, 0.2992616]
Target sample: 7, Prediction:6, Target's Score:[-4.144332, -0.7351993, 0.87013596, 0.74251974, 0.88509065, -1.705795, 8.67374, -4.312982, 0.6626358, -0.6956547]
Target sample: 13, Prediction:6, Target's Score:[-3.8203425, 0.12347383, 2.6243804, -0.11653651, 0.4275163, -1.6052389, 9.737694, -5.230203, -0.64387655, -1.2523558]
Target sample: 19, Prediction:1, Target's Score:[-1.973493, 8.825058, -2.2377365, -1.290058, -1.5921482, -2.74305, 8.315306, -5.211459, -0.60738826, -1.1201519]
Target sample: 25, Prediction:1, Target's Score:[-1.9892132, 9.512974, -1.858352, -1.1376888, -1.6978955, -3.3807957, 6.5075645, -4.949849, 0.06664357, -0.7085532]
Target sample: 31, Prediction:1, Target's Score:[-1.8178946, 9.203874, -2.0418465, -1.0926155, -2.1000369, -3.3853714, 6.161265, -4.839031, 1.2909484, -1.0148357]
Target sample: 37, Prediction:6, Target's Score:[-1.4823221, 6.532588, -0.6994626, -2.0109882, -0.83037794, -3.3639379, 7.581478, -5.2639127, 0.8335949, -0.9721486]
Target sample: 43, Prediction:1, Target's Score:[-1.4022995, 12.943275, -2.4695468, -2.5738323, -2.8258214, -3.1021483, 4.4551563, -5.233646, 0.8983897, -0.26677072]
Target sample: 49, Prediction:1, Target's Score:[-0.91336966, 10.469008, -1.3582038, -2.37666, -1.5474035, -3.2747564, 7.773551, -5.4128613, -1.109203, -1.8739233]
Target sample: 55, Prediction:6, Target's Score:[-1.247056, 2.0636926, -0.4687554, -1.0053756, -0.35307539, -2.1295373, 12.885605, -4.4815927, -1.5839218, -3.440703]
Target sample: 61, Prediction:6, Target's Score:[-2.8685334, 3.4650586, -1.2348124, -0.39245814, -0.36053628, -1.7586026, 9.475308, -4.3071294, 0.31120571, -2.058661]
Target sample: 67, Prediction:6, Target's Score:[-3.3878586, 0.7234446, -0.78416693, -0.9987632, 0.064894125, 0.29562074, 10.309665, -4.637863, 0.69767666, -2.0274014]
Target sample: 73, Prediction:6, Target's Score:[-2.676198, 2.3119245, 0.4123828, -1.0710974, -0.23100321, -0.8313734, 10.368768, -4.986146, 0.060984716, -3.100641]
Target sample: 79, Prediction:1, Target's Score:[-2.5728242, 9.372094, -1.5383997, -2.0504797, -0.55528396, -2.042765, 6.877071, -5.7473955, -0.9024532, -0.46792072]
Target sample: 85, Prediction:6, Target's Score:[-2.5760152, 6.0149093, -0.4644157, -0.25014308, -0.620149, -2.6380556, 7.013185, -4.9333444, -0.39028582, -0.8406902]
Target sample: 91, Prediction:1, Target's Score:[-1.0231097, 11.695542, -2.9299746, -2.830227, -2.6050568, -2.5188363, 3.6224585, -4.9524493, 0.7932601, 1.1461354]
Target sample: 97, Prediction:6, Target's Score:[-1.4265853, 7.0951242, -1.7933246, -1.5145844, -1.1657287, -3.3690639, 7.7186804, -4.8190365, 0.92906344, -1.3342311]
Target sample: 103, Prediction:1, Target's Score:[-1.4624617, 11.954564, -2.579466, -1.9639606, -2.622742, -2.916189, 4.793652, -5.0505476, 0.43637964, -0.1916252]
Target sample: 109, Prediction:1, Target's Score:[-1.630233, 11.122496, -1.5508944, -2.020076, -2.27379, -3.2837453, 5.9128723, -5.363423, -0.7200612, 0.19181086]
Target sample: 115, Prediction:6, Target's Score:[-2.1354945, 1.3733488, 0.55805314, -0.2781804, 0.3385978, -2.6400008, 11.936638, -5.04615, -1.8068391, -2.0618305]
Target sample: 121, Prediction:9, Target's Score:[-4.107908, 1.0100607, -0.32719842, 3.028737, -0.77962744, -3.81363, 2.621914, -3.1526108, -0.8481374, 6.7135997]
Target sample: 127, Prediction:6, Target's Score:[-3.6713176, -1.62584, 1.4197328, 0.25824928, 0.64055634, -2.5297964, 6.988316, -4.5280414, 3.5663352, -0.24007328]
Current ATTACK acc on target samples: 54.545
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 02:13:20 Epoch 59, Val iteration 0, acc 92.400 (92.400)
2021-06-11 02:13:41 Epoch 59, Val iteration 19, acc 93.200 (93.180)
* Prec: 93.18000259399415
Per class accuracy =  [0.96053335 0.96727256 0.90929901 0.85009596 0.93959242 0.89240276
 0.93422385 0.94496275 0.96137583 0.9582607 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 1, 6, 6, 1, 6, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 1, 1, 1, 6, 6, 1, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 1, 6, 1, 1, 1, 6, 1, 1, 1, 1, 1, 6, 1, 6, 1, 1, 1, 1, 1, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 57.94392523364486
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  600
poison index =  1829
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 02:13:45, Val iteration 0, acc 92.600 (92.600)
2021-06-11 02:13:50, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 02:13:53, Epoch 0, Iteration 7, loss 0.225 (0.369), acc 90.385 (90.800)
2021-06-11 02:14:20, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:9, Target's Score:[-2.6184595, 0.8411085, -2.4712899, 4.3012886, -3.2379727, -2.9586518, 4.39545, -4.8287334, 2.4230013, 4.4889317]
Target sample: 7, Prediction:9, Target's Score:[-1.2866393, 1.0986214, 2.0152614, 3.4996471, -4.2595577, -2.039175, 3.5565326, -4.421517, -1.4389827, 3.6110709]
Target sample: 13, Prediction:6, Target's Score:[-1.6589968, -3.2088947, -0.90936756, 5.3011208, -3.2091744, -1.8435074, 11.853126, -5.9507346, -0.6963842, 0.6273665]
Target sample: 19, Prediction:1, Target's Score:[-0.9743668, 9.947225, -3.7810423, 3.15339, -4.725677, -1.2617427, 6.1940517, -6.0252633, -4.51009, 2.3568351]
Target sample: 25, Prediction:1, Target's Score:[-1.5484171, 8.580868, -2.1991186, 0.50484204, -3.732435, -2.6555524, 8.186316, -6.613558, 0.39009583, -0.49849147]
Target sample: 31, Prediction:1, Target's Score:[1.4728127, 12.031354, -2.3224132, 1.606914, -5.6361547, -3.1454334, 4.0120134, -6.514015, -1.8238182, 0.7355636]
Target sample: 37, Prediction:1, Target's Score:[-1.74953, 10.291974, -3.8768628, 3.8704112, -3.6384933, -1.8337821, 4.2434025, -6.908848, 0.5193392, -0.48640886]
Target sample: 43, Prediction:1, Target's Score:[-1.6587329, 11.591186, -4.7286606, 0.8968509, -1.0995764, 0.29687434, 4.0045905, -6.385379, -3.330087, 0.858138]
Target sample: 49, Prediction:1, Target's Score:[-0.77941835, 11.847465, -2.8410976, 0.070296794, -2.3693078, -1.3993263, 5.232404, -5.903188, -5.2941318, 1.8709297]
Target sample: 55, Prediction:1, Target's Score:[-1.8330851, 8.8719225, -3.4537992, 3.863556, -5.060243, -2.2991736, 6.6144223, -6.733058, -4.5368676, 4.9875703]
Target sample: 61, Prediction:6, Target's Score:[-2.111647, 4.0946665, -1.6653444, 1.9069619, -5.203381, -2.5633323, 8.350105, -6.257467, 1.5821116, 2.2494638]
Target sample: 67, Prediction:6, Target's Score:[-2.7420127, 4.7980523, -2.6514866, 1.8090012, -5.1127553, -1.1011058, 8.509445, -6.9020467, 1.6427305, 2.1323044]
Target sample: 73, Prediction:1, Target's Score:[-0.32762784, 7.7893343, -1.7163159, 5.154034, -4.49842, -1.2630683, 5.5008554, -8.016979, -5.237111, 3.023847]
Target sample: 79, Prediction:1, Target's Score:[-0.23565868, 15.601303, -3.0014222, -1.0685344, -5.26766, -1.9830176, 3.3008611, -5.944163, -2.551575, 1.5758896]
Target sample: 85, Prediction:1, Target's Score:[-0.59045815, 8.975812, -2.9650917, 2.2425306, -5.6915865, -0.47992492, 7.383398, -7.0039406, 0.56985176, -2.0503116]
Target sample: 91, Prediction:1, Target's Score:[-0.350867, 11.597885, -2.700243, 0.4664629, -5.717083, -2.3063557, 3.9986472, -5.954796, 0.81445706, 0.5525606]
Target sample: 97, Prediction:1, Target's Score:[-0.9785205, 12.72217, -4.0395675, 0.043832988, -4.7277064, -2.8789523, 5.4032087, -6.192987, 1.9253048, -0.8445609]
Target sample: 103, Prediction:1, Target's Score:[-0.95315444, 12.302503, -3.9503052, 0.5206144, -5.517199, -2.318785, 3.1752338, -5.5774975, -3.8611507, 6.5961227]
Target sample: 109, Prediction:1, Target's Score:[-0.6647409, 7.910168, -4.229332, 3.6479628, -4.57656, -2.137834, 6.7052975, -5.6361623, -4.462791, 3.8217857]
Target sample: 115, Prediction:6, Target's Score:[-1.5991642, 3.7356756, -2.026895, 3.5164375, -3.592908, -3.3173604, 5.843509, -5.1215744, 1.0327535, 1.8941458]
Target sample: 121, Prediction:9, Target's Score:[-3.2893274, -2.013327, -1.9576674, 3.8442276, -3.0523112, -3.280874, 5.086871, -3.8774512, 0.08325906, 8.790956]
Target sample: 127, Prediction:9, Target's Score:[0.17431572, 4.625508, -2.0243702, 4.235985, -5.9658446, -1.3143383, 3.3038743, -6.349845, -3.048478, 6.728299]
Current ATTACK acc on target samples: 18.182
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 02:14:48 Epoch 59, Val iteration 0, acc 89.400 (89.400)
2021-06-11 02:14:54 Epoch 59, Val iteration 19, acc 90.600 (89.260)
* Prec: 89.26000137329102
Per class accuracy =  [0.92380962 0.91525804 0.84170859 0.82288661 0.89112639 0.82174957
 0.93351605 0.89143467 0.92993551 0.95021312]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 3, 9, 9, 3, 3, 3, 3, 3, 6, 6, 6, 6, 1, 1, 1, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 6, 1, 1, 1, 6, 6, 6, 1, 6, 1, 1, 6, 1, 6, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 9, 1, 1, 1, 6, 6, 6, 1, 6, 9, 6, 6, 9, 9, 6, 3, 3, 9, 3, 3
ATTACK acc: 23.364485981308412
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  600
poison index =  1829
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 02:15:01, Val iteration 0, acc 96.200 (96.200)
2021-06-11 02:15:13, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 02:15:20, Epoch 0, Iteration 7, loss 0.493 (0.694), acc 88.462 (82.200)
2021-06-11 02:16:31, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:8, Target's Score:[-2.009929, 0.120280564, -3.1162648, -1.085972, -1.3066057, -3.1518388, 6.68644, -3.7433317, 9.570537, -1.9185945]
Target sample: 7, Prediction:6, Target's Score:[-3.1456885, 0.7644731, -2.1652076, -1.6382966, -0.08969621, -0.49782458, 7.44627, -2.2941246, 3.8519034, -2.201445]
Target sample: 13, Prediction:6, Target's Score:[-2.364404, 5.565904, -2.8179257, -1.0324755, -1.6066958, -3.2070749, 11.374615, -3.3108854, 0.11274086, -2.696554]
Target sample: 19, Prediction:1, Target's Score:[-1.9297023, 9.105067, -3.4101832, 0.24757579, -2.6654747, -3.5100086, 6.79743, -3.5154939, -0.47376424, -0.6135546]
Target sample: 25, Prediction:1, Target's Score:[-0.13350746, 8.517622, -2.8054347, 0.08056476, -2.1092858, -4.1835456, 5.530388, -3.481142, -0.20344569, -1.1752903]
Target sample: 31, Prediction:6, Target's Score:[1.5244421, 4.838349, -1.3909724, 0.14845955, -2.9864733, -4.130181, 7.0759478, -3.7410805, 0.05865263, -1.3591002]
Target sample: 37, Prediction:1, Target's Score:[-0.7690915, 8.010342, -1.8987019, 0.18107727, -2.9464753, -4.2902503, 5.8556256, -4.5052342, 1.1805177, -0.77481294]
Target sample: 43, Prediction:1, Target's Score:[-2.8115227, 9.328392, -2.0479264, 1.4354116, -3.502059, -3.81858, 6.3560896, -4.1787047, -1.438793, 0.71086997]
Target sample: 49, Prediction:1, Target's Score:[-2.6250412, 10.147882, -2.7758024, -0.8584213, -1.527501, -3.06728, 4.851267, -2.4673772, -0.99592245, -0.6481972]
Target sample: 55, Prediction:6, Target's Score:[-0.78340185, 4.2116184, -3.398554, 2.2864337, -1.6508139, -4.1095304, 7.2127395, -2.5678363, 0.53126216, -1.7053635]
Target sample: 61, Prediction:6, Target's Score:[-3.4253802, 1.6731815, -1.5795105, 1.4043778, -1.2459008, -3.5059502, 9.181888, -3.0639334, 2.7796962, -2.197246]
Target sample: 67, Prediction:6, Target's Score:[-4.134341, 2.8001387, -2.197531, 1.0935476, 1.2764584, -3.8408668, 8.365364, -3.8673515, 2.8573184, -2.3304389]
Target sample: 73, Prediction:1, Target's Score:[-3.0347257, 7.299517, -2.631159, 0.9726254, -1.7983788, -3.266694, 6.698794, -3.2511914, -0.94543296, -0.018180283]
Target sample: 79, Prediction:1, Target's Score:[-3.013887, 9.719761, -1.6818947, -1.1210938, -2.8565245, -3.0046906, 5.408765, -2.983625, -1.436374, 0.9993634]
Target sample: 85, Prediction:1, Target's Score:[-2.2673445, 9.204432, -1.6990227, 0.20429447, -4.0541954, -1.8257357, 6.6155524, -3.7051358, -1.6623085, -0.7742418]
Target sample: 91, Prediction:1, Target's Score:[1.4438457, 8.618424, -1.9884104, -1.162467, -3.8978388, -3.6715088, 5.3943057, -3.8862295, -0.8700307, 0.07022056]
Target sample: 97, Prediction:6, Target's Score:[2.1220622, 6.546927, -2.713946, -1.3072476, -3.3226995, -3.9793894, 7.549384, -4.083679, -0.42132843, -0.3449573]
Target sample: 103, Prediction:1, Target's Score:[-0.94964373, 8.208064, -2.9348538, -0.5513562, -3.1763291, -3.4910917, 5.719483, -3.7542472, -0.7336083, 1.7046838]
Target sample: 109, Prediction:1, Target's Score:[-2.7624335, 10.042402, -2.157135, 0.26270762, -3.767909, -3.7472503, 5.974268, -3.2728994, -0.2620983, -0.2753236]
Target sample: 115, Prediction:6, Target's Score:[-2.8766813, 3.5505183, -2.6019216, -0.007042503, -2.4050715, -3.2957592, 10.099342, -2.9374554, 2.0562913, -1.5623245]
Target sample: 121, Prediction:6, Target's Score:[-2.8641768, 3.5007198, -2.5907757, 1.272809, -0.9466573, -3.7876363, 4.3873687, -3.1049266, 2.1499062, 2.0217972]
Target sample: 127, Prediction:6, Target's Score:[-3.4396613, 2.1297803, -3.909751, -0.010876721, -0.04315211, -0.5562983, 5.6489716, -3.537939, 4.432127, -0.6796291]
Current ATTACK acc on target samples: 45.455
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 02:17:41 Epoch 59, Val iteration 0, acc 92.400 (92.400)
2021-06-11 02:17:53 Epoch 59, Val iteration 19, acc 93.600 (92.770)
* Prec: 92.77000198364257
Per class accuracy =  [0.94261445 0.95676116 0.90252882 0.84646324 0.95291651 0.89357854
 0.94637891 0.93057668 0.95620459 0.9498323 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 6, 8, 8, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 1, 1, 6, 1, 6, 6, 1, 6, 1, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 6, 6, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 8, 6, 6, 8, 8, 6, 6
ATTACK acc: 49.532710280373834
--------
------SUMMARY------
TIME ELAPSED (mins): 24
TARGET INDEX: 7
ResNet50 77.27272727272727 82.24299065420561 95.46000137329102 90.67000045776368
DPN92 54.54545454545455 57.94392523364486 95.50000267028808 93.18000259399415
MobileNetV2 18.181818181818183 23.364485981308412 91.22000160217286 89.26000137329102
GoogLeNet 45.45454545454545 49.532710280373834 95.41000213623047 92.77000198364257
True False False False False
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 170 images of target 8
All target indices used in crafting poisons: [1, 6, 11, 16, 21, 26, 31, 36, 41, 46, 51, 56, 61, 66, 71, 76, 81, 86, 91, 96, 101, 106, 111, 116, 121, 126, 131, 136, 141, 146, 151, 156, 161, 166]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=False, nearest=True, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=8, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/8/target-num-20
torch.Size([200, 1, 3, 32, 32]) torch.Size([34, 3, 32, 32])
Selected nearest neighbors: [1212, 1088, 1698, 600, 770]
Selected base image indices: [1212, 1088, 1698, 600, 770]
Target indices: [1, 6, 11, 16, 21, 26, 31, 36, 41, 46, 51, 56, 61, 66, 71, 76, 81, 86, 91, 96, 101, 106, 111, 116, 121, 126, 131, 136, 141, 146, 151, 156, 161, 166]
# Targets: 34, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 02:18:32 Iteration 0 	 Training Loss: 7.874e-01 	 Loss in Target Net: 1.078e+00	  
tensor(-0.0002, device='cuda:0')
 2021-06-11 02:19:47 Iteration 50 	 Training Loss: 1.444e-01 	 Loss in Target Net: 1.992e-01	  
tensor(0.0030, device='cuda:0')
 2021-06-11 02:21:00 Iteration 100 	 Training Loss: 1.220e-01 	 Loss in Target Net: 2.416e-01	  
tensor(-0.0020, device='cuda:0')
 2021-06-11 02:22:26 Iteration 150 	 Training Loss: 1.158e-01 	 Loss in Target Net: 1.917e-01	  
tensor(-0.0089, device='cuda:0')
 2021-06-11 02:24:08 Iteration 200 	 Training Loss: 1.097e-01 	 Loss in Target Net: 1.880e-01	  
tensor(-0.0133, device='cuda:0')
 2021-06-11 02:25:37 Iteration 250 	 Training Loss: 9.844e-02 	 Loss in Target Net: 1.688e-01	  
tensor(-0.0161, device='cuda:0')
 2021-06-11 02:26:59 Iteration 300 	 Training Loss: 1.013e-01 	 Loss in Target Net: 1.594e-01	  
tensor(-0.0181, device='cuda:0')
 2021-06-11 02:28:20 Iteration 350 	 Training Loss: 9.756e-02 	 Loss in Target Net: 1.788e-01	  
tensor(-0.0194, device='cuda:0')
 2021-06-11 02:29:51 Iteration 400 	 Training Loss: 9.734e-02 	 Loss in Target Net: 1.522e-01	  
tensor(-0.0207, device='cuda:0')
 2021-06-11 02:31:24 Iteration 450 	 Training Loss: 9.184e-02 	 Loss in Target Net: 1.672e-01	  
tensor(-0.0212, device='cuda:0')
 2021-06-11 02:32:46 Iteration 500 	 Training Loss: 9.241e-02 	 Loss in Target Net: 1.550e-01	  
tensor(-0.0214, device='cuda:0')
 2021-06-11 02:34:08 Iteration 550 	 Training Loss: 8.980e-02 	 Loss in Target Net: 1.670e-01	  
tensor(-0.0230, device='cuda:0')
 2021-06-11 02:35:28 Iteration 600 	 Training Loss: 9.147e-02 	 Loss in Target Net: 1.633e-01	  
tensor(-0.0231, device='cuda:0')
 2021-06-11 02:37:02 Iteration 650 	 Training Loss: 9.135e-02 	 Loss in Target Net: 1.501e-01	  
tensor(-0.0228, device='cuda:0')
 2021-06-11 02:38:35 Iteration 700 	 Training Loss: 9.164e-02 	 Loss in Target Net: 1.508e-01	  
tensor(-0.0233, device='cuda:0')
 2021-06-11 02:40:01 Iteration 750 	 Training Loss: 8.855e-02 	 Loss in Target Net: 1.778e-01	  
tensor(-0.0228, device='cuda:0')
 2021-06-11 02:41:22 Iteration 800 	 Training Loss: 9.114e-02 	 Loss in Target Net: 1.696e-01	  
tensor(-0.0219, device='cuda:0')
 2021-06-11 02:43:00 Iteration 850 	 Training Loss: 9.100e-02 	 Loss in Target Net: 1.569e-01	  
tensor(-0.0221, device='cuda:0')
 2021-06-11 02:44:35 Iteration 900 	 Training Loss: 9.099e-02 	 Loss in Target Net: 1.588e-01	  
tensor(-0.0222, device='cuda:0')
 2021-06-11 02:46:32 Iteration 950 	 Training Loss: 9.261e-02 	 Loss in Target Net: 1.568e-01	  
tensor(-0.0228, device='cuda:0')
 2021-06-11 02:47:59 Iteration 999 	 Training Loss: 8.975e-02 	 Loss in Target Net: 1.769e-01	  
tensor(-0.0222, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  1698
poison index =  600
poison index =  770
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 02:48:04, Val iteration 0, acc 94.200 (94.200)
2021-06-11 02:48:14, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 02:48:19, Epoch 0, Iteration 7, loss 0.456 (0.863), acc 88.462 (86.800)
2021-06-11 02:49:20, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-3.3657174, 3.6498861, -2.5626554, 1.6775604, -2.1171737, -2.6094775, 9.299709, -3.4141724, 0.15648624, -0.5697147]
Target sample: 6, Prediction:6, Target's Score:[-2.53064, 2.189844, -1.8664085, 0.41001174, -0.59375846, -3.0841196, 8.6364565, -3.6279645, 2.262842, -1.6613338]
Target sample: 11, Prediction:6, Target's Score:[-3.344007, 3.147585, -2.0805135, 0.8290616, -1.682606, -2.8756762, 8.014378, -3.632648, 1.1985729, 0.55828273]
Target sample: 16, Prediction:6, Target's Score:[-3.192069, 0.55225724, -1.2993805, 0.030076107, -1.5071334, -3.4174426, 13.313521, -3.9371727, 0.17962521, -0.5939909]
Target sample: 21, Prediction:1, Target's Score:[-4.5485454, 10.727734, -2.320754, -0.464601, -3.2278528, -3.60114, 9.138425, -4.020752, -1.9427097, 0.42269155]
Target sample: 26, Prediction:1, Target's Score:[-4.3368616, 11.908397, -2.3950644, -0.41176823, -3.464184, -3.6999843, 7.877057, -3.787101, -2.4450474, 0.91726667]
Target sample: 31, Prediction:1, Target's Score:[-5.250985, 13.145682, -2.6994517, -0.45146495, -3.9980266, -4.1115804, 9.216832, -3.8808968, -2.5062644, 0.7142236]
Target sample: 36, Prediction:1, Target's Score:[-5.789672, 15.675705, -3.410161, -1.0204756, -4.4119883, -4.23897, 8.03023, -3.9255373, -2.7965775, 2.0776234]
Target sample: 41, Prediction:1, Target's Score:[-5.2200284, 13.516033, -3.3847644, -0.22415866, -4.1194377, -3.8457658, 7.698595, -3.7760336, -1.565916, 1.1078209]
Target sample: 46, Prediction:6, Target's Score:[-2.1283796, 6.394401, -2.4368353, 0.092726916, -1.8822615, -3.115736, 6.5850363, -2.90552, 1.1988168, -1.6530781]
Target sample: 51, Prediction:1, Target's Score:[-2.6062768, 7.1322246, -2.3050175, 0.8551397, -2.3638937, -3.0555809, 6.0536666, -3.0888355, 1.6846497, -2.1452103]
Target sample: 56, Prediction:1, Target's Score:[-2.760321, 8.680692, -2.7382205, 0.2954968, -2.7079625, -3.250305, 6.5899835, -2.9257092, 1.1633341, -2.1788516]
Target sample: 61, Prediction:1, Target's Score:[-4.2231555, 11.775762, -2.9408638, 0.056875832, -3.623365, -3.3931875, 7.238245, -3.1231446, -0.45442775, -1.136898]
Target sample: 66, Prediction:1, Target's Score:[-4.984979, 12.204272, -2.9219785, -0.116433516, -3.7784019, -3.8829608, 9.306665, -3.5545247, -1.4914306, -0.59971756]
Target sample: 71, Prediction:1, Target's Score:[-4.9187503, 12.173381, -2.4548903, -0.060374342, -3.553864, -4.020831, 9.608854, -3.763804, -1.748707, -1.0829108]
Target sample: 76, Prediction:1, Target's Score:[-3.8799124, 9.991815, -2.0114365, -0.7207289, -2.7543216, -3.7185931, 8.950502, -3.8181102, -2.0873382, 0.2010513]
Target sample: 81, Prediction:6, Target's Score:[-3.758814, 6.569192, -1.3787484, -0.24501531, -2.186906, -3.5981276, 10.704828, -3.721104, -2.20601, -0.047709566]
Target sample: 86, Prediction:6, Target's Score:[-3.1645205, 1.8912741, -1.2301383, 0.08902786, -1.3471695, -3.5000894, 12.487693, -3.3438838, -0.81756926, -0.9462394]
Target sample: 91, Prediction:6, Target's Score:[-3.2964885, 5.4712896, -2.5011363, 0.21191145, -2.2379816, -3.068176, 9.135081, -3.2199676, 1.9565884, -2.295239]
Target sample: 96, Prediction:1, Target's Score:[-3.9548154, 9.046138, -2.8901505, 1.1212567, -2.9633665, -2.9342253, 7.078355, -3.257204, -0.11285325, -0.97042215]
Target sample: 101, Prediction:6, Target's Score:[-3.0837958, 6.6732492, -1.6089909, -0.16050918, -1.6847821, -3.6605024, 9.4206505, -3.5418468, -0.6515747, -1.5581993]
Target sample: 106, Prediction:6, Target's Score:[-4.6285324, 7.1028757, -2.5490744, -0.89456755, -3.075091, -4.080254, 12.925204, -4.1969447, -1.9576323, 1.5132561]
Target sample: 111, Prediction:1, Target's Score:[-4.463632, 13.291522, -2.6999326, -0.76889956, -3.9429839, -4.09877, 8.812767, -3.7412, -1.9498438, -0.25242484]
Target sample: 116, Prediction:1, Target's Score:[-5.9590764, 14.384596, -3.1298501, -0.2916961, -4.369525, -4.2492747, 9.687826, -4.0908136, -2.2306926, 0.44379726]
Target sample: 121, Prediction:1, Target's Score:[-5.672245, 14.958957, -3.8703442, 0.13121139, -4.6542907, -3.7740347, 7.7000704, -3.9309218, -2.4848764, 1.7952352]
Target sample: 126, Prediction:1, Target's Score:[-4.4791985, 9.84133, -2.9214828, 1.5711167, -3.0297616, -3.154132, 6.717811, -3.6634727, -0.6289944, -0.08276884]
Target sample: 131, Prediction:6, Target's Score:[-3.1833823, 5.6372137, -2.4853327, 2.2754035, -2.1301632, -2.8861804, 7.0671515, -3.044472, 0.8784128, -1.9745479]
Target sample: 136, Prediction:1, Target's Score:[-2.5241787, 6.3016906, -2.8844116, 1.1633089, -2.6812673, -2.697127, 6.2874365, -3.0844855, 2.0591328, -1.7756126]
Target sample: 141, Prediction:1, Target's Score:[-0.6182872, 6.2843685, -2.2518992, -1.0088476, -2.0419817, -2.8274288, 4.2305493, -2.992017, 1.4534354, -0.08638881]
Target sample: 146, Prediction:6, Target's Score:[-4.3321586, 8.511507, -2.4567716, -0.91939217, -3.176225, -3.5318382, 9.896525, -3.8226736, -2.0458138, 2.0243204]
Target sample: 151, Prediction:1, Target's Score:[-4.0629463, 10.423179, -1.8854134, -0.53719044, -3.207169, -3.6987839, 8.319632, -3.8477683, -2.1966507, 0.84584713]
Target sample: 156, Prediction:6, Target's Score:[-3.011305, 5.4505434, -1.3289771, -0.44156054, -1.9947166, -3.362545, 9.682925, -3.878361, -2.7424934, 1.7448227]
Target sample: 161, Prediction:6, Target's Score:[-3.453608, 0.32094952, -0.820205, -0.016993942, -1.0057268, -3.6359134, 12.714165, -4.293042, -0.8650164, 1.1711495]
Target sample: 166, Prediction:6, Target's Score:[-3.2508478, 2.5058787, -2.5762134, 0.55672777, -1.5863205, -3.0182383, 10.747804, -3.4324923, 0.17436421, 0.014033999]
Current ATTACK acc on target samples: 44.118
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 02:50:19 Epoch 59, Val iteration 0, acc 89.200 (89.200)
2021-06-11 02:50:29 Epoch 59, Val iteration 19, acc 92.600 (91.470)
* Prec: 91.47000160217286
Per class accuracy =  [0.93700613 0.93552273 0.86239294 0.82298272 0.94586259 0.86244483
 0.93799077 0.93603998 0.95836203 0.94714786]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 1, 1, 1, 8, 1, 1, 1, 1, 6, 1, 6, 1, 1, 1, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 45.588235294117645
--------
DPN92
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  1698
poison index =  600
poison index =  770
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 02:50:41, Val iteration 0, acc 94.800 (94.800)
2021-06-11 02:51:01, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 02:51:15, Epoch 0, Iteration 7, loss 0.501 (0.498), acc 88.462 (88.600)
2021-06-11 02:53:53, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.56892, 2.1301808, -1.3854743, -1.6869129, -2.408316, -2.6491876, 11.8756075, -3.118234, 0.712981, -0.5598577]
Target sample: 6, Prediction:6, Target's Score:[-3.316994, 2.9302084, -1.9634951, -2.6009386, -0.7922537, -3.0932407, 9.604021, -3.7688165, 3.8909512, -0.5599768]
Target sample: 11, Prediction:6, Target's Score:[-2.8763545, 3.0394785, -2.0626106, -3.0009792, -2.7514007, -2.7595003, 11.514716, -2.8732188, 1.4275798, 0.7086845]
Target sample: 16, Prediction:6, Target's Score:[-2.9981709, -0.9992534, 0.09708135, -2.3167577, -0.9935454, -3.3064642, 14.631509, -3.830104, 1.5789145, -1.5405996]
Target sample: 21, Prediction:1, Target's Score:[-1.6192939, 9.373439, -0.6783757, -4.22381, -1.9353716, -2.7206714, 9.164277, -3.7289565, -2.0413296, -1.1059953]
Target sample: 26, Prediction:6, Target's Score:[-2.3519533, 7.941653, -0.76398575, -3.5673127, -1.7164961, -3.2538335, 8.559938, -3.8821957, -1.8298805, 1.2882806]
Target sample: 31, Prediction:1, Target's Score:[-2.1845064, 10.421512, -1.5646888, -3.976292, -2.9867227, -3.1164207, 8.957014, -4.377911, -0.2506582, -0.448783]
Target sample: 36, Prediction:1, Target's Score:[-1.3795425, 9.896566, -1.5637019, -3.5319066, -3.3772087, -3.0907378, 7.89841, -3.5615501, -0.865199, 0.031579755]
Target sample: 41, Prediction:1, Target's Score:[-2.0754254, 9.92259, -1.7121763, -3.4757376, -3.2371078, -2.9863129, 7.8659825, -3.8341513, -0.7823399, 0.76478297]
Target sample: 46, Prediction:6, Target's Score:[-1.0383233, 5.8348894, -2.1738355, -3.749081, -2.689361, -3.569923, 7.0666723, -3.1199217, 3.3576043, 0.4485572]
Target sample: 51, Prediction:1, Target's Score:[-2.271122, 9.304285, -1.8835849, -3.4705212, -2.3846288, -2.9281793, 6.9381995, -3.473125, 1.6443694, -1.0670727]
Target sample: 56, Prediction:1, Target's Score:[-1.3222054, 9.131891, -2.1607647, -3.7469802, -2.9041564, -3.0180392, 6.779734, -3.4152973, 1.9627923, -0.90218496]
Target sample: 61, Prediction:1, Target's Score:[-1.4511865, 10.3874855, -1.3560436, -3.8860176, -2.9606912, -3.150394, 7.2856255, -4.2655883, 1.8158687, -1.9751186]
Target sample: 66, Prediction:1, Target's Score:[-2.4733336, 10.480861, -1.2606776, -3.841184, -2.8419108, -3.121955, 10.086305, -4.3607707, -0.20001067, -1.9795457]
Target sample: 71, Prediction:6, Target's Score:[-2.3448403, 7.4685864, -0.4502348, -3.366595, -1.4562922, -3.4785357, 11.74305, -4.644293, -0.58290535, -2.4439387]
Target sample: 76, Prediction:1, Target's Score:[-1.8179461, 10.342522, -1.2563289, -3.5253873, -2.3831654, -3.2929149, 9.536266, -4.2506127, -0.93212223, -1.9358599]
Target sample: 81, Prediction:6, Target's Score:[-1.1302837, 7.193659, 0.04657398, -3.311975, -1.0561405, -3.4515243, 10.078035, -4.4177814, -1.9388356, -1.572216]
Target sample: 86, Prediction:6, Target's Score:[-1.0661238, 2.721877, 0.09379922, -2.212426, -0.74769914, -3.2836652, 11.740501, -3.0513132, -0.81854826, -3.0097005]
Target sample: 91, Prediction:6, Target's Score:[-1.6430196, 5.704381, -1.3678366, -2.5375245, -2.5957763, -2.9412112, 10.877783, -3.4232492, 1.0680479, -2.7536497]
Target sample: 96, Prediction:6, Target's Score:[-1.9225516, 8.276169, -1.3319436, -3.1655366, -1.8044887, -2.9726157, 9.81097, -3.4847217, -1.198053, -1.7675673]
Target sample: 101, Prediction:6, Target's Score:[-0.91531557, 5.762839, -1.371678, -3.599941, -1.9691604, -2.6965468, 10.427979, -2.0006368, -1.4811888, -1.7061474]
Target sample: 106, Prediction:6, Target's Score:[-2.306262, 6.2940335, -0.51789695, -3.0595615, -2.045592, -3.4612782, 12.464518, -4.3653708, -2.268741, -0.29023996]
Target sample: 111, Prediction:1, Target's Score:[-1.8052318, 9.555783, -0.096238025, -3.69236, -1.0438664, -3.5343602, 9.465308, -4.6193066, -1.8868827, -1.8528973]
Target sample: 116, Prediction:6, Target's Score:[-2.81988, 9.443072, -0.15425478, -3.7583025, -0.82887095, -3.442601, 9.515185, -4.5308657, -1.3454571, -1.5993456]
Target sample: 121, Prediction:1, Target's Score:[-1.7064143, 12.853717, -1.6010007, -4.0540094, -2.148941, -3.057919, 6.6358504, -4.4771657, -1.3376236, -0.59409696]
Target sample: 126, Prediction:1, Target's Score:[-2.2967925, 8.827308, -1.7649395, -3.2427692, -1.8382114, -3.028105, 7.0563126, -4.041465, 1.2410345, -0.507146]
Target sample: 131, Prediction:6, Target's Score:[-2.4904852, 6.1367726, -0.6979482, -3.0922515, -1.2538295, -3.3358717, 8.571752, -3.873461, 1.8947988, -1.4821149]
Target sample: 136, Prediction:6, Target's Score:[-2.3218143, 7.8341746, -2.403825, -3.190762, -3.5712671, -3.0607045, 9.307476, -3.995886, 0.9296052, 0.8831863]
Target sample: 141, Prediction:1, Target's Score:[-1.0724548, 6.4640803, -2.8824272, -3.779384, -3.831296, -3.816533, 6.298584, -3.9309812, 3.902101, 3.0330236]
Target sample: 146, Prediction:6, Target's Score:[-2.55668, 8.844095, -1.5558091, -3.462861, -3.0605052, -3.3633418, 10.664494, -4.6095905, -1.4059438, 0.96799904]
Target sample: 151, Prediction:6, Target's Score:[-2.4275568, 8.7226305, -1.3249229, -3.4805179, -2.4586635, -3.555416, 10.406584, -4.588121, -1.3337721, 0.4939801]
Target sample: 156, Prediction:6, Target's Score:[-2.4303207, 6.671878, -0.025514297, -3.0134022, -1.3222429, -3.3601053, 10.4316845, -4.455188, -0.7981435, -1.2912265]
Target sample: 161, Prediction:6, Target's Score:[-3.090509, 0.90022683, 0.39284065, -2.2694342, 0.10413153, -2.8673239, 14.253214, -3.787741, -1.465786, -1.8256294]
Target sample: 166, Prediction:6, Target's Score:[-3.5181236, 2.8923423, -2.5208063, -2.9015694, -2.7998173, -3.0948734, 11.352101, -3.9851243, 0.35671636, 4.5952387]
Current ATTACK acc on target samples: 61.765
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 02:56:28 Epoch 59, Val iteration 0, acc 93.600 (93.600)
2021-06-11 02:56:49 Epoch 59, Val iteration 19, acc 92.600 (92.930)
* Prec: 92.93000106811523
Per class accuracy =  [0.9436655  0.95513085 0.90181439 0.81164537 0.95162105 0.91215184
 0.9375056  0.95652311 0.96693653 0.9557025 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 1, 6, 1, 6, 6, 6, 1, 1, 6, 6, 1, 1, 6, 1, 6, 6, 6, 1, 6, 1, 1, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 1, 1, 1, 8, 1, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 63.23529411764706
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  1698
poison index =  600
poison index =  770
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 02:56:53, Val iteration 0, acc 92.600 (92.600)
2021-06-11 02:56:58, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 02:57:00, Epoch 0, Iteration 7, loss 0.481 (0.346), acc 84.615 (89.600)
2021-06-11 02:57:28, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-3.0205865, 3.1730297, -0.3983253, 3.02018, -4.0721416, -1.3720728, 8.870554, -6.249617, -1.0958483, 1.5045013]
Target sample: 6, Prediction:9, Target's Score:[-1.27078, 6.6363425, -0.619459, 0.5459552, -3.5169485, -3.5228584, 2.5928335, -5.2808414, -2.6830065, 7.473139]
Target sample: 11, Prediction:1, Target's Score:[-2.7902448, 9.90562, -2.2785316, 2.5452716, -5.013209, -2.4393628, 2.594003, -4.9544816, -3.2408128, 6.0470304]
Target sample: 16, Prediction:6, Target's Score:[1.7097901, 4.3053327, 2.5820563, 2.6835754, -3.503038, -3.2451923, 7.055791, -6.5390296, -4.3302693, -0.3545697]
Target sample: 21, Prediction:6, Target's Score:[-1.3924674, 5.6138024, 2.292633, 3.1913426, -2.3442874, -4.0683994, 9.016474, -5.163447, -2.6546402, -4.0992026]
Target sample: 26, Prediction:1, Target's Score:[-0.3795798, 13.043554, -2.0424569, 0.22210982, -5.726194, -3.3024244, 6.934243, -5.5001373, -3.6277616, 0.75021714]
Target sample: 31, Prediction:1, Target's Score:[-1.0322429, 17.858885, -3.4839647, -1.1952976, -5.529468, -2.8394623, 2.7290173, -5.0790544, -0.8702872, -0.15099621]
Target sample: 36, Prediction:1, Target's Score:[-2.0125878, 16.49227, -4.1230164, -1.2238265, -5.2176228, -2.966004, 5.196677, -5.241681, -0.40269697, -0.092097655]
Target sample: 41, Prediction:1, Target's Score:[-2.6283576, 14.410664, -4.9738774, 0.99492705, -4.5153913, -1.9768794, 3.8174424, -5.7161837, -0.49847943, 1.4811335]
Target sample: 46, Prediction:1, Target's Score:[-2.4049284, 9.8827915, -4.7408323, 1.8508584, -0.55234724, -3.1078272, 3.4397278, -4.4733996, 0.180293, 0.2995292]
Target sample: 51, Prediction:1, Target's Score:[-2.97894, 11.930551, -5.3389716, 0.73075104, -2.9386477, -1.2498254, 3.25136, -5.358186, 3.1757758, -0.83874154]
Target sample: 56, Prediction:1, Target's Score:[-2.6192064, 11.140704, -5.0128922, 1.8285164, -1.9631379, -2.6434076, 4.414236, -4.8877435, 1.0561861, -0.92034185]
Target sample: 61, Prediction:1, Target's Score:[-1.0495771, 11.604742, -5.4753175, 2.3431225, -1.1908684, -2.5237002, 2.5958185, -5.8165793, -0.34691027, 0.25424477]
Target sample: 66, Prediction:1, Target's Score:[-1.744599, 13.961636, -5.1214566, 0.8006762, -5.423503, -3.1252747, 5.4273458, -5.9772315, 0.8822309, 0.7099885]
Target sample: 71, Prediction:1, Target's Score:[0.43404782, 7.7304277, -2.2148566, 1.4175206, 2.4929388, -4.747444, 2.1608107, -4.4670014, 0.8049189, -3.2185087]
Target sample: 76, Prediction:1, Target's Score:[-0.73964536, 15.199577, -3.3369632, 0.5990972, -4.8319097, -3.035701, 5.1673517, -6.8834724, -3.318547, 1.5908183]
Target sample: 81, Prediction:1, Target's Score:[1.9151713, 13.218352, -2.4323523, 0.8363396, -5.0440207, -3.596641, 2.163165, -6.4849343, -2.3083367, 2.1086624]
Target sample: 86, Prediction:1, Target's Score:[0.5629104, 8.176171, -1.5117325, -0.34753948, -3.0795958, -3.705195, 5.191363, -4.5242777, -0.094194025, -0.3467835]
Target sample: 91, Prediction:1, Target's Score:[-0.8276124, 10.829907, -3.1419954, -0.2691873, -5.673321, -1.3009994, 5.603069, -6.0486426, 1.5845994, -0.3955008]
Target sample: 96, Prediction:1, Target's Score:[-2.134366, 14.724626, -5.0690517, -0.7739042, -5.297979, -1.3361545, 4.3710794, -5.4653172, -1.4676447, 2.8241348]
Target sample: 101, Prediction:1, Target's Score:[0.8682455, 11.445683, -1.8804162, -0.8784431, -5.2896757, -3.1014128, 5.2768154, -5.847148, -0.086425975, -0.15790588]
Target sample: 106, Prediction:1, Target's Score:[-1.5319781, 11.788075, -2.1472807, -0.9261768, -5.89868, -3.5545795, 8.210346, -5.3345137, -0.5192393, 0.27819955]
Target sample: 111, Prediction:1, Target's Score:[-0.42800385, 12.066202, -1.3903047, -0.36235592, -5.0386195, -3.943588, 6.652118, -5.4189434, -1.139105, -0.63273853]
Target sample: 116, Prediction:1, Target's Score:[-0.7897513, 14.900942, -2.558712, -0.58367753, -4.9130774, -3.9857688, 5.705207, -5.704855, -1.1589353, -0.5181104]
Target sample: 121, Prediction:1, Target's Score:[0.20793559, 13.374134, -3.3759332, -0.8966402, -4.535023, -3.6207385, 3.7547002, -4.5235715, 0.76569325, -0.7968236]
Target sample: 126, Prediction:1, Target's Score:[-1.0224795, 10.028618, -3.8110812, 1.1199323, -2.9589784, -3.6092048, 6.231581, -5.417305, 1.8616892, -2.054871]
Target sample: 131, Prediction:1, Target's Score:[-1.3670765, 8.895609, -4.037014, -0.65323186, 2.9906623, -2.9712474, 1.1658572, -2.4359465, -0.62765306, -0.5905505]
Target sample: 136, Prediction:1, Target's Score:[-1.7304542, 10.5817795, -4.58723, 0.866549, -4.8669004, -2.2815127, 5.061528, -5.6248007, 1.3099911, 1.6226094]
Target sample: 141, Prediction:1, Target's Score:[-0.3428203, 7.1770997, -3.2221687, 2.560885, -2.734114, -3.100198, 3.040803, -5.4616103, -2.9901059, 5.439204]
Target sample: 146, Prediction:1, Target's Score:[-1.8056285, 14.042822, -3.4652812, 0.65023696, -4.3750696, -3.3390923, 2.996153, -5.0170636, -2.1715958, 2.8823464]
Target sample: 151, Prediction:1, Target's Score:[-0.7696729, 13.70522, -3.2218764, -1.0579401, -4.7673583, -3.442081, 5.4162683, -5.854336, -1.9824657, 2.350921]
Target sample: 156, Prediction:1, Target's Score:[0.21860774, 8.904162, -1.6255566, 1.846267, -5.5104294, -3.6675189, 5.6139355, -6.1369963, -3.7444742, 4.4910836]
Target sample: 161, Prediction:6, Target's Score:[-0.018513571, -0.22219625, 2.2012866, 3.8285213, 1.9038043, -3.7387743, 7.722008, -4.687516, -3.2373502, -3.3909392]
Target sample: 166, Prediction:9, Target's Score:[-3.380263, 5.41473, -3.00823, 1.6647978, -4.229829, -2.3010447, 6.6764665, -6.2599926, -2.1875982, 7.9873257]
Current ATTACK acc on target samples: 11.765
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 02:57:56 Epoch 59, Val iteration 0, acc 88.800 (88.800)
2021-06-11 02:58:02 Epoch 59, Val iteration 19, acc 90.800 (89.350)
* Prec: 89.35000190734863
Per class accuracy =  [0.92470724 0.92245966 0.84129584 0.82966123 0.88791775 0.82402273
 0.93323535 0.88511135 0.93445909 0.94926972]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 9, 1, 1, 9, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 3, 6, 6, 6, 1, 6, 9, 9, 9
ATTACK acc: 10.294117647058824
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  1698
poison index =  600
poison index =  770
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 02:58:10, Val iteration 0, acc 96.200 (96.200)
2021-06-11 02:58:22, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 02:58:28, Epoch 0, Iteration 7, loss 0.498 (0.513), acc 84.615 (86.600)
2021-06-11 02:59:39, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.8564982, 2.7189698, -1.9042072, 0.5939336, -2.438622, -2.3631296, 6.887741, -1.903021, 1.6912415, -0.36386347]
Target sample: 6, Prediction:6, Target's Score:[-2.230128, 2.5968864, -0.4913998, -2.0369499, -1.7694119, -2.7181954, 3.9441204, -2.0866263, 1.6013637, 3.2797432]
Target sample: 11, Prediction:6, Target's Score:[-1.9320884, 3.02668, -0.6838578, -1.7669232, -1.8575017, -2.344481, 7.7378664, -2.7129073, 0.9341415, -0.34326285]
Target sample: 16, Prediction:6, Target's Score:[-2.8328624, 2.0423427, -1.8288813, -1.4392889, -1.8359429, -1.9045534, 11.591937, -2.4091992, 0.5239949, -1.8629408]
Target sample: 21, Prediction:1, Target's Score:[-2.390714, 10.837669, -2.1139002, -2.4630356, -2.535837, -3.0235417, 5.90626, -2.3962922, -1.3564473, -0.39006782]
Target sample: 26, Prediction:1, Target's Score:[-1.9400306, 12.585607, -2.1897898, -2.9203427, -2.8285244, -3.395593, 3.990791, -2.3405538, -1.4019859, 0.5271043]
Target sample: 31, Prediction:1, Target's Score:[-2.0430973, 14.195896, -2.3491607, -2.1088374, -3.3350034, -3.3618674, 2.3207192, -2.609956, -1.6754445, 1.0606655]
Target sample: 36, Prediction:1, Target's Score:[-1.9125285, 13.282821, -2.1161757, -2.3694618, -3.4637659, -3.5643039, 2.342677, -2.879785, -1.4137733, 2.1972933]
Target sample: 41, Prediction:1, Target's Score:[-2.7075837, 11.706658, -2.5909634, -1.932195, -2.9371512, -3.3458166, 3.4566967, -3.0469666, -0.12743995, 1.6189721]
Target sample: 46, Prediction:1, Target's Score:[-2.0330763, 8.3375635, -2.2520707, -1.6637049, -2.4959476, -3.1435478, 4.1405087, -2.3022518, 1.4638748, 0.021136455]
Target sample: 51, Prediction:1, Target's Score:[-2.8019037, 7.646446, -2.3717945, -2.0964363, -2.523985, -3.1526523, 4.6998925, -2.6559722, 4.313036, -0.9850747]
Target sample: 56, Prediction:1, Target's Score:[-0.8434514, 8.251874, -2.4979463, -1.6850481, -2.6232643, -3.145733, 4.0289006, -2.788456, 1.1778731, 0.19820529]
Target sample: 61, Prediction:1, Target's Score:[-1.1353273, 10.896815, -3.2012188, -1.4447042, -2.6006439, -3.4718874, 3.0203717, -2.8568475, 0.90956867, -0.0375411]
Target sample: 66, Prediction:1, Target's Score:[-1.1459067, 10.835451, -3.531406, -0.54964083, -2.8669033, -3.843166, 3.926097, -3.1566, -0.072600335, 0.49159652]
Target sample: 71, Prediction:1, Target's Score:[-0.36924082, 8.608874, -3.0604758, -0.9756527, -2.34708, -3.721074, 5.22317, -3.171338, 0.8759043, -0.9930463]
Target sample: 76, Prediction:1, Target's Score:[-1.3808005, 12.44424, -3.3607478, -2.2596655, -2.3121223, -3.2706218, 3.654015, -2.6578233, -1.0012727, 0.22718412]
Target sample: 81, Prediction:1, Target's Score:[-0.30312884, 8.610599, -2.7698147, -1.6619877, -1.8964702, -3.6254773, 5.2441897, -2.703977, -0.39811453, -0.42528456]
Target sample: 86, Prediction:6, Target's Score:[-1.4577816, 0.5099629, -1.5066874, -0.94676435, -1.7075005, -2.7517302, 9.144786, -2.2083778, 3.1063514, -2.1382077]
Target sample: 91, Prediction:6, Target's Score:[-2.131199, 5.527115, -1.6744165, -2.2203548, -2.6148715, -2.639062, 5.5639563, -2.2964244, 2.9389937, -0.39001384]
Target sample: 96, Prediction:6, Target's Score:[-1.9989383, 3.57836, -1.1939696, -0.8841163, -1.6424366, -1.789232, 6.299626, -2.7348256, 1.0454482, -0.62875074]
Target sample: 101, Prediction:1, Target's Score:[-1.1309404, 7.066539, -2.0624924, -2.5237367, -1.8704807, -2.40322, 5.4404597, -2.421438, -0.49221566, 0.46712983]
Target sample: 106, Prediction:6, Target's Score:[-2.578645, 7.54391, -2.206093, -1.9864919, -2.607171, -3.1420572, 10.1952715, -2.8575835, -1.2340746, -1.0601058]
Target sample: 111, Prediction:1, Target's Score:[-1.4105716, 11.649104, -2.7516475, -1.6846647, -2.2400382, -3.8365993, 5.2651744, -3.131528, -1.8296728, 0.054627232]
Target sample: 116, Prediction:1, Target's Score:[-1.4405959, 8.846681, -2.2291505, -1.0162559, -2.2726328, -3.344711, 5.8991923, -2.7997494, -0.76366496, -0.8108211]
Target sample: 121, Prediction:1, Target's Score:[-0.7579357, 7.9827986, -2.8400638, -1.2090025, -2.4146664, -3.5582325, 3.9674988, -3.3138683, -0.762159, 3.006499]
Target sample: 126, Prediction:1, Target's Score:[-1.8751812, 8.855383, -2.846207, -1.3379027, -2.1263194, -3.460832, 3.7549415, -3.1602871, 1.1005594, 1.1815736]
Target sample: 131, Prediction:6, Target's Score:[-2.178117, 3.2844481, -1.4686972, -1.4715862, -2.2349832, -2.4986827, 5.479432, -2.7036095, 2.7509449, 1.1158364]
Target sample: 136, Prediction:1, Target's Score:[-1.6703717, 5.8436127, -2.761336, -1.4100766, -2.6453052, -2.9367876, 4.626435, -2.8317735, 2.7096756, 1.1580888]
Target sample: 141, Prediction:1, Target's Score:[-1.3871973, 8.580896, -2.547099, -1.524193, -2.9329731, -2.9556618, 3.6201234, -2.5350704, 1.1872798, 0.57073474]
Target sample: 146, Prediction:1, Target's Score:[-1.3485054, 7.2400026, -2.1177633, -0.32432416, -2.5956814, -3.0577133, 5.322265, -2.989123, -1.2987015, 1.2511499]
Target sample: 151, Prediction:1, Target's Score:[-2.0958526, 11.422425, -2.5689943, -2.280153, -2.6447048, -3.1847966, 4.949181, -2.9098504, -0.82057416, 0.2141226]
Target sample: 156, Prediction:1, Target's Score:[-2.2564144, 12.077357, -1.8882587, -2.9455323, -3.1578574, -3.4567862, 4.496184, -2.2824647, -1.0272608, 0.5280953]
Target sample: 161, Prediction:6, Target's Score:[-2.1900702, 4.5207157, -0.43960938, -0.4050025, -1.5119953, -2.9739425, 7.5747633, -2.688419, -0.38862, -1.4442788]
Target sample: 166, Prediction:6, Target's Score:[-2.6309962, 0.4539069, -2.0588293, -1.6359372, -1.446201, -2.891234, 7.9044676, -2.4651523, 0.35412374, 4.5198]
Current ATTACK acc on target samples: 32.353
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 03:00:48 Epoch 59, Val iteration 0, acc 92.800 (92.800)
2021-06-11 03:01:01 Epoch 59, Val iteration 19, acc 94.400 (92.570)
* Prec: 92.57000198364258
Per class accuracy =  [0.93824398 0.91231213 0.882479   0.90227555 0.94609913 0.88735211
 0.94654834 0.93792948 0.94911534 0.95359865]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 9, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 28.676470588235293
--------
------SUMMARY------
TIME ELAPSED (mins): 29
TARGET INDEX: 8
ResNet50 44.11764705882353 45.588235294117645 95.46000137329102 91.47000160217286
DPN92 61.76470588235294 63.23529411764706 95.50000267028808 92.93000106811523
MobileNetV2 11.764705882352942 10.294117647058824 91.22000160217286 89.35000190734863
GoogLeNet 32.35294117647059 28.676470588235293 95.41000213623047 92.57000198364258
True False False False True
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 170 images of target 8
All target indices used in crafting poisons: [1, 6, 11, 16, 21, 26, 31, 36, 41, 46, 51, 56, 61, 66, 71, 76, 81, 86, 91, 96, 101, 106, 111, 116, 121, 126, 131, 136, 141, 146, 151, 156, 161, 166]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=True, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=8, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/8/target-num-20
torch.Size([200, 1, 3, 32, 32]) torch.Size([34, 3, 32, 32])
Selected nearest neighbors: [1212, 1088, 1698, 600, 770]
Selected base image indices: [1212, 1088, 1698, 600, 770]
Target indices: [1, 6, 11, 16, 21, 26, 31, 36, 41, 46, 51, 56, 61, 66, 71, 76, 81, 86, 91, 96, 101, 106, 111, 116, 121, 126, 131, 136, 141, 146, 151, 156, 161, 166]
# Targets: 34, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 03:01:47 Iteration 0 	 Training Loss: 7.474e-01 	 Loss in Target Net: 6.546e-01	  
tensor(-0.0006, device='cuda:0')
 2021-06-11 03:03:13 Iteration 50 	 Training Loss: 3.015e-01 	 Loss in Target Net: 2.566e-01	  
tensor(-0.0138, device='cuda:0')
 2021-06-11 03:04:39 Iteration 100 	 Training Loss: 2.568e-01 	 Loss in Target Net: 2.165e-01	  
tensor(-0.0249, device='cuda:0')
 2021-06-11 03:06:14 Iteration 150 	 Training Loss: 2.452e-01 	 Loss in Target Net: 2.098e-01	  
tensor(-0.0297, device='cuda:0')
 2021-06-11 03:07:45 Iteration 200 	 Training Loss: 2.403e-01 	 Loss in Target Net: 2.035e-01	  
tensor(-0.0321, device='cuda:0')
 2021-06-11 03:09:13 Iteration 250 	 Training Loss: 2.422e-01 	 Loss in Target Net: 2.103e-01	  
tensor(-0.0331, device='cuda:0')
 2021-06-11 03:10:50 Iteration 300 	 Training Loss: 2.348e-01 	 Loss in Target Net: 2.026e-01	  
tensor(-0.0329, device='cuda:0')
 2021-06-11 03:12:29 Iteration 350 	 Training Loss: 2.326e-01 	 Loss in Target Net: 2.008e-01	  
tensor(-0.0327, device='cuda:0')
 2021-06-11 03:14:06 Iteration 400 	 Training Loss: 2.333e-01 	 Loss in Target Net: 1.993e-01	  
tensor(-0.0319, device='cuda:0')
 2021-06-11 03:15:41 Iteration 450 	 Training Loss: 2.298e-01 	 Loss in Target Net: 1.934e-01	  
tensor(-0.0322, device='cuda:0')
 2021-06-11 03:17:20 Iteration 500 	 Training Loss: 2.288e-01 	 Loss in Target Net: 1.952e-01	  
tensor(-0.0317, device='cuda:0')
 2021-06-11 03:19:00 Iteration 550 	 Training Loss: 2.296e-01 	 Loss in Target Net: 1.960e-01	  
tensor(-0.0319, device='cuda:0')
 2021-06-11 03:20:45 Iteration 600 	 Training Loss: 2.299e-01 	 Loss in Target Net: 1.995e-01	  
tensor(-0.0304, device='cuda:0')
 2021-06-11 03:22:29 Iteration 650 	 Training Loss: 2.307e-01 	 Loss in Target Net: 1.978e-01	  
tensor(-0.0302, device='cuda:0')
 2021-06-11 03:24:21 Iteration 700 	 Training Loss: 2.313e-01 	 Loss in Target Net: 1.920e-01	  
tensor(-0.0293, device='cuda:0')
 2021-06-11 03:25:57 Iteration 750 	 Training Loss: 2.294e-01 	 Loss in Target Net: 1.927e-01	  
tensor(-0.0291, device='cuda:0')
 2021-06-11 03:27:54 Iteration 800 	 Training Loss: 2.289e-01 	 Loss in Target Net: 1.921e-01	  
tensor(-0.0287, device='cuda:0')
 2021-06-11 03:29:32 Iteration 850 	 Training Loss: 2.290e-01 	 Loss in Target Net: 2.019e-01	  
tensor(-0.0279, device='cuda:0')
 2021-06-11 03:31:17 Iteration 900 	 Training Loss: 2.281e-01 	 Loss in Target Net: 1.969e-01	  
tensor(-0.0279, device='cuda:0')
 2021-06-11 03:32:55 Iteration 950 	 Training Loss: 2.291e-01 	 Loss in Target Net: 1.996e-01	  
tensor(-0.0280, device='cuda:0')
 2021-06-11 03:34:23 Iteration 999 	 Training Loss: 2.327e-01 	 Loss in Target Net: 2.056e-01	  
tensor(-0.0265, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  1698
poison index =  600
poison index =  770
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 03:34:28, Val iteration 0, acc 94.200 (94.200)
2021-06-11 03:34:38, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 03:34:43, Epoch 0, Iteration 7, loss 0.104 (0.224), acc 96.154 (96.000)
2021-06-11 03:35:43, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.8935506, 3.0218925, -1.4698199, -1.2543199, -2.216476, -3.8831656, 9.781772, -2.4144597, 1.8561325, 0.19590744]
Target sample: 6, Prediction:6, Target's Score:[-2.730642, -0.009831819, -0.6534287, -1.639175, -1.4519616, -4.1098447, 9.606641, -2.8450801, 2.5636559, 1.9269879]
Target sample: 11, Prediction:6, Target's Score:[-2.775191, 2.3599608, -0.5007568, -1.7819301, -1.4945467, -4.0861936, 9.601326, -2.4271307, 0.4936106, 1.3358148]
Target sample: 16, Prediction:6, Target's Score:[-2.2956612, -0.9986385, 0.23361035, -1.6906145, -1.3442867, -4.476477, 13.796567, -2.5305607, -0.2513542, 0.27299482]
Target sample: 21, Prediction:6, Target's Score:[-3.5762885, 7.975878, -0.7970306, -2.068206, -2.35884, -4.795017, 11.387322, -2.3253875, -0.5720078, -1.882061]
Target sample: 26, Prediction:6, Target's Score:[-3.228001, 9.260728, -0.6191205, -2.3338146, -2.5053263, -4.576778, 9.286524, -1.9915655, -1.1615866, -1.1079446]
Target sample: 31, Prediction:1, Target's Score:[-3.7141938, 11.334623, -0.37173253, -2.314557, -3.3068514, -5.3759093, 10.444426, -1.8605293, -0.9729647, -2.7072875]
Target sample: 36, Prediction:1, Target's Score:[-3.8286283, 12.989826, -0.5087004, -2.5755663, -3.2314553, -5.4892445, 9.124365, -1.7990483, -0.89553976, -2.5586514]
Target sample: 41, Prediction:1, Target's Score:[-3.2000215, 9.894353, -1.2213676, -1.9693968, -2.7459624, -4.783036, 8.120154, -2.0426183, 1.3082871, -2.37438]
Target sample: 46, Prediction:8, Target's Score:[0.038220916, -0.093999535, -2.366861, -3.056948, 0.12029785, -3.6945763, 3.976219, -1.6466539, 8.267262, -1.0266639]
Target sample: 51, Prediction:6, Target's Score:[-1.4785335, 2.7727635, -1.7928895, -1.5287921, -1.3002229, -3.9073586, 6.365205, -2.2841487, 6.0013533, -2.2067661]
Target sample: 56, Prediction:8, Target's Score:[-1.087548, 2.3694806, -2.4122074, -2.0512896, -2.1703937, -4.262414, 6.769636, -2.5007284, 8.111266, -2.158086]
Target sample: 61, Prediction:6, Target's Score:[-2.4695196, 6.1292324, -2.207985, -2.279056, -2.792323, -4.4182997, 8.362497, -1.8292842, 5.0081873, -2.7429588]
Target sample: 66, Prediction:6, Target's Score:[-3.0400229, 9.857196, -1.4248433, -2.1887944, -3.3951159, -5.268519, 10.395667, -1.7445121, 1.567934, -3.759562]
Target sample: 71, Prediction:6, Target's Score:[-3.3190436, 9.51239, -0.7880199, -2.237669, -2.8479347, -5.2399282, 10.752872, -1.4678372, 0.6851045, -4.056404]
Target sample: 76, Prediction:6, Target's Score:[-3.7980587, 8.542108, -0.7804297, -2.3749487, -2.5083354, -5.012349, 11.397743, -2.2858589, 0.2245896, -2.4267294]
Target sample: 81, Prediction:6, Target's Score:[-3.5102313, 5.9701586, -0.5149519, -2.1884923, -2.2085888, -4.7954493, 12.346724, -2.3079438, 0.07965111, -1.9862933]
Target sample: 86, Prediction:6, Target's Score:[-2.745713, 0.31352216, -0.2707925, -2.08521, -1.4936359, -4.674229, 13.678674, -1.8873092, 0.98900855, -1.1129205]
Target sample: 91, Prediction:6, Target's Score:[-2.2574196, 2.665574, -0.8169352, -1.837025, -2.2242906, -4.4691157, 10.746857, -1.6549023, 2.2869697, -1.7427613]
Target sample: 96, Prediction:6, Target's Score:[-3.451119, 7.347267, -0.7230251, -1.3865976, -2.1866422, -4.2835207, 8.665465, -1.8009064, -0.16516602, -1.1458356]
Target sample: 101, Prediction:6, Target's Score:[-2.7681198, 5.2665195, -0.5265207, -1.8817474, -1.6528097, -4.828594, 11.288499, -1.3966471, -0.7535362, -1.8655909]
Target sample: 106, Prediction:6, Target's Score:[-3.5875678, 3.2641628, -1.10334, -2.5339143, -2.31504, -5.0935135, 14.992407, -2.979155, -0.6388073, 0.9383035]
Target sample: 111, Prediction:6, Target's Score:[-3.2651546, 10.340969, -1.2370912, -2.1242206, -3.1373117, -5.0510726, 10.861248, -2.1546059, -0.6366568, -2.52134]
Target sample: 116, Prediction:1, Target's Score:[-3.8187444, 11.180841, -1.2798461, -2.755968, -3.46409, -5.2081957, 11.054034, -1.4387645, -0.22620964, -2.9280872]
Target sample: 121, Prediction:1, Target's Score:[-3.2649877, 12.450946, -1.918109, -2.323984, -3.60895, -4.7201657, 8.251281, -1.6414934, -0.039044928, -2.0708334]
Target sample: 126, Prediction:6, Target's Score:[-2.3868027, 4.415975, -2.0673885, -2.1884785, -1.3423611, -4.0900617, 7.653395, -2.3839889, 4.1870575, -1.094987]
Target sample: 131, Prediction:6, Target's Score:[-0.9708876, -0.07547156, -0.9839386, -2.3847246, 0.50205076, -4.2548046, 7.0846686, -0.9788624, 4.9081078, -2.2740052]
Target sample: 136, Prediction:8, Target's Score:[-0.8419737, 0.40279484, -2.4399762, -2.085424, -2.209081, -3.56965, 6.343381, -2.8724906, 8.952119, -1.1307424]
Target sample: 141, Prediction:8, Target's Score:[-1.3441001, 3.2301793, -1.9404004, -2.1123753, -2.018112, -3.5507596, 5.699927, -2.4370127, 6.107802, -1.0263286]
Target sample: 146, Prediction:6, Target's Score:[-3.3526614, 8.136724, -0.69910455, -2.3205326, -2.7469509, -4.599765, 9.875999, -2.6573732, 0.028279383, -0.69428444]
Target sample: 151, Prediction:1, Target's Score:[-4.026855, 9.7061405, -0.17458116, -2.0025933, -2.3279092, -4.9397273, 9.657367, -2.1558692, -0.56297976, -2.1349342]
Target sample: 156, Prediction:6, Target's Score:[-3.3902004, 6.5932536, -0.43502635, -2.3034625, -2.0955858, -4.5841575, 10.230291, -2.6234448, -0.11310484, -0.3504332]
Target sample: 161, Prediction:6, Target's Score:[-2.9132755, -0.88050365, 0.04804895, -2.6239355, -1.2418703, -4.492972, 13.701139, -3.6322026, 0.016160328, 2.8223908]
Target sample: 166, Prediction:6, Target's Score:[-2.93251, 0.6377792, -1.1966146, -1.696457, -1.513017, -3.9683928, 11.776789, -3.006855, 1.0417347, 1.5715246]
Current ATTACK acc on target samples: 70.588
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 03:36:42 Epoch 59, Val iteration 0, acc 91.800 (91.800)
2021-06-11 03:36:52 Epoch 59, Val iteration 19, acc 91.600 (91.900)
* Prec: 91.9000015258789
Per class accuracy =  [0.93959683 0.94826189 0.90814263 0.82480593 0.91149058 0.89048406
 0.95128333 0.92144832 0.96176151 0.92900274]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 8, 6, 8, 6, 8, 8, 6, 6, 6, 8, 8, 6, 6, 6, 1, 6, 6, 6, 6, 1, 1, 1, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 8, 8, 8, 6, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 76.47058823529412
--------
DPN92
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  1698
poison index =  600
poison index =  770
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 03:37:04, Val iteration 0, acc 94.800 (94.800)
2021-06-11 03:37:25, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 03:37:39, Epoch 0, Iteration 7, loss 0.114 (0.413), acc 92.308 (90.600)
2021-06-11 03:40:18, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.441807, 2.7290368, -1.4598082, -0.961745, -1.3215684, -2.9440706, 7.85743, -0.28482246, -0.30729574, -0.57279354]
Target sample: 6, Prediction:6, Target's Score:[-3.2299495, 1.070173, -2.4282882, -2.0821965, -0.045314867, -2.7461984, 8.336461, -1.1457729, 3.010391, -0.44809505]
Target sample: 11, Prediction:6, Target's Score:[-3.3368137, 2.3181179, -1.5661954, -2.7491882, -1.3434696, -2.3369694, 9.694272, -0.9383113, -0.011041671, 0.58060527]
Target sample: 16, Prediction:6, Target's Score:[-2.0198917, -2.5642455, -0.75775206, -2.4668965, -0.5163102, -2.1763504, 11.583435, -1.119116, 0.27157205, 0.057636235]
Target sample: 21, Prediction:6, Target's Score:[-2.7471528, 4.2782917, -0.13177104, -3.2654262, -1.4464716, -1.9972143, 8.943073, -0.7100959, -2.2274296, -0.37379944]
Target sample: 26, Prediction:6, Target's Score:[-2.2751043, 3.888269, -0.36255175, -3.2370126, -1.1906418, -2.4087806, 6.388096, -0.7669514, -1.9492328, 2.2361333]
Target sample: 31, Prediction:1, Target's Score:[-2.692826, 8.725621, -1.4349585, -2.9740963, -2.8786616, -2.968909, 6.2289042, -0.9276327, -0.61269045, -0.10397565]
Target sample: 36, Prediction:1, Target's Score:[-1.6544894, 9.08093, -1.4928327, -2.7731168, -3.1086946, -3.2372646, 5.7688465, -0.632093, -1.4308906, -0.14871486]
Target sample: 41, Prediction:1, Target's Score:[-2.368457, 7.713875, -1.4588948, -2.592782, -2.8796844, -2.8723752, 6.5069776, -0.43296003, -1.033253, -0.23694287]
Target sample: 46, Prediction:6, Target's Score:[-1.7366356, 5.222327, -2.3476262, -3.0890496, -2.028473, -3.125906, 6.857307, -0.36075532, 1.1608276, -0.23835881]
Target sample: 51, Prediction:6, Target's Score:[-2.7922654, 5.7266984, -2.5743546, -2.5713146, -1.5085392, -2.819589, 6.2769322, -0.2031504, 2.0754178, -1.3077294]
Target sample: 56, Prediction:6, Target's Score:[-1.236617, 6.191956, -2.4745543, -2.8197787, -1.9863698, -3.276291, 6.285679, 0.29478425, 1.095103, -1.7673908]
Target sample: 61, Prediction:1, Target's Score:[-1.5240532, 6.78888, -2.4076085, -3.0917263, -1.9527466, -3.2452123, 5.647278, -0.8132481, 2.5219471, -1.5969279]
Target sample: 66, Prediction:6, Target's Score:[-2.53088, 6.8197365, -1.7463144, -2.7405298, -2.2549846, -3.2453406, 8.423224, -0.3727944, -0.0940345, -1.9146595]
Target sample: 71, Prediction:6, Target's Score:[-1.9274932, 2.5048187, -1.7792453, -2.7560918, 0.68627894, -2.8982038, 10.1497345, -0.85675985, -0.56505746, -2.251184]
Target sample: 76, Prediction:6, Target's Score:[-2.4744782, 6.9264607, -1.4048734, -2.9219253, -1.3975538, -3.0176284, 8.294105, -0.6717064, -1.4955254, -1.4836507]
Target sample: 81, Prediction:6, Target's Score:[-1.2171435, 3.5536313, -0.471553, -2.5073142, -0.29390317, -2.9254892, 8.370597, -1.0532846, -2.1208599, -1.0182767]
Target sample: 86, Prediction:6, Target's Score:[-1.5554428, 1.637496, -0.35679522, -2.287035, 0.22366448, -3.0618749, 9.577323, 0.24253644, -1.7152064, -2.4130776]
Target sample: 91, Prediction:6, Target's Score:[-1.7558968, 5.507437, -1.4948659, -2.2247372, -2.1426363, -3.0252275, 8.012465, 0.35569292, -0.5089556, -2.413405]
Target sample: 96, Prediction:6, Target's Score:[-2.428507, 6.2923465, -1.5193101, -2.2127745, -1.4992962, -2.8518708, 8.258693, -0.39592075, -1.7658925, -1.5398123]
Target sample: 101, Prediction:6, Target's Score:[-2.3498812, 4.7177167, -0.8289088, -3.1417112, -1.5608954, -2.8530965, 9.09087, -0.24206729, -1.4620433, -1.0382068]
Target sample: 106, Prediction:6, Target's Score:[-2.534804, 3.1477904, -0.7204172, -3.1966572, -1.8989952, -2.7794406, 10.777472, -1.1321988, -2.0492327, 0.73770016]
Target sample: 111, Prediction:1, Target's Score:[-2.2955575, 7.7697897, -0.6171015, -3.0816438, -1.5008177, -3.2506716, 6.847551, -0.96177053, -1.5304415, -1.0207398]
Target sample: 116, Prediction:1, Target's Score:[-2.9664474, 7.477656, -0.71600056, -3.1304584, -0.89565176, -2.9674737, 6.7721367, -0.7644095, -1.1469753, -1.3202713]
Target sample: 121, Prediction:1, Target's Score:[-2.5785487, 9.875817, -1.3313737, -3.242502, -2.0772681, -3.129321, 5.891532, -1.1070749, -1.4024913, -0.5111869]
Target sample: 126, Prediction:1, Target's Score:[-2.8041627, 6.119566, -2.3242393, -2.8007867, -0.8734246, -2.8665073, 6.03976, -0.99603224, 1.2402444, -0.41819763]
Target sample: 131, Prediction:6, Target's Score:[-2.014678, 1.9550805, -1.7330843, -2.4867258, 0.32606465, -3.0156395, 6.7071548, -0.2404321, 2.771988, -1.9952266]
Target sample: 136, Prediction:6, Target's Score:[-2.0168502, 3.778363, -2.2159839, -2.9110096, -2.5135438, -2.905702, 9.183251, -0.6585624, 1.2250063, -0.6434342]
Target sample: 141, Prediction:6, Target's Score:[-0.4606484, 0.8735335, -2.9514713, -3.4552562, -1.9054602, -3.6113703, 6.8814683, -0.9505293, 4.4968715, 1.4252334]
Target sample: 146, Prediction:6, Target's Score:[-2.650617, 3.4703095, -1.034528, -3.0824966, -2.4891176, -2.7050245, 10.641495, -1.3334415, -1.1698036, 0.70680475]
Target sample: 151, Prediction:6, Target's Score:[-2.4843626, 5.1172075, -1.074561, -2.7425559, -1.8005726, -3.1402266, 9.05808, -1.4000045, -1.5910168, 0.4094892]
Target sample: 156, Prediction:6, Target's Score:[-2.8442273, 3.8834047, -0.29362172, -2.699971, -0.84164995, -2.204829, 8.314063, -1.2161, -1.2397811, -0.55712533]
Target sample: 161, Prediction:6, Target's Score:[-2.2561555, -0.4502229, -0.102487914, -2.4962776, -0.16609155, -2.1609046, 11.226777, -0.8141724, -1.5152886, -0.983329]
Target sample: 166, Prediction:6, Target's Score:[-3.169875, 0.74529016, -2.2571206, -2.5801165, -1.9311432, -2.1767852, 8.132103, -1.7019818, 1.2109661, 4.0778913]
Current ATTACK acc on target samples: 76.471
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 03:42:53 Epoch 59, Val iteration 0, acc 91.800 (91.800)
2021-06-11 03:43:14 Epoch 59, Val iteration 19, acc 93.800 (93.070)
* Prec: 93.07000198364258
Per class accuracy =  [0.94876713 0.96111676 0.90131396 0.82650196 0.95906397 0.89642138
 0.95692473 0.94052719 0.97227442 0.94365939]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 6, 6, 1, 1, 1, 1, 6, 1, 1, 6, 1, 6, 6, 6, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 1, 6, 1, 1, 6, 6, 1, 1, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 1, 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 74.26470588235294
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  1698
poison index =  600
poison index =  770
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 03:43:18, Val iteration 0, acc 92.600 (92.600)
2021-06-11 03:43:24, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 03:43:26, Epoch 0, Iteration 7, loss 0.444 (0.398), acc 86.538 (90.000)
2021-06-11 03:43:54, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.9889984, 1.3424878, 0.09561207, 2.8342984, -3.3025224, -1.1932558, 11.187123, -6.3189898, -3.3054943, 1.6906174]
Target sample: 6, Prediction:9, Target's Score:[-1.76214, 2.9447465, -0.7329317, 0.9241752, -2.0891497, -3.4622946, 5.729012, -5.0722322, -4.4087877, 8.012963]
Target sample: 11, Prediction:9, Target's Score:[-2.7910273, 4.927935, -1.7859358, 2.3640494, -3.6188145, -2.552127, 5.918115, -4.5171776, -5.1608877, 7.2993994]
Target sample: 16, Prediction:6, Target's Score:[0.7357301, 0.82345647, 3.01949, 3.0268023, -1.8292743, -3.0775201, 9.617277, -6.403943, -6.0334744, 0.16132946]
Target sample: 21, Prediction:6, Target's Score:[-2.2389135, 3.2940032, 1.9209286, 3.2977464, -1.4925938, -3.7889457, 12.091682, -5.0515833, -3.902619, -4.1055927]
Target sample: 26, Prediction:1, Target's Score:[-0.5116164, 10.871862, -1.6288717, -0.00044365227, -5.053975, -3.2288084, 8.993087, -5.461981, -4.7799015, 0.8534739]
Target sample: 31, Prediction:1, Target's Score:[-1.4752824, 16.858194, -3.1985304, -1.7976432, -4.9116488, -2.9864948, 4.2789006, -5.0440474, -1.6651423, 0.042928807]
Target sample: 36, Prediction:1, Target's Score:[-2.4016593, 15.516494, -3.6778588, -1.7079277, -4.567809, -2.9219778, 6.409595, -5.1438494, -1.1517092, -0.26559272]
Target sample: 41, Prediction:1, Target's Score:[-2.9353566, 12.393081, -4.098583, 0.6925023, -2.6754794, -1.7872118, 5.372769, -5.5311313, -2.7735522, 1.4456881]
Target sample: 46, Prediction:1, Target's Score:[-2.8141937, 7.8273764, -4.0680237, 1.398512, 1.5657126, -2.931633, 4.938465, -4.0837145, -2.3475382, 0.6234307]
Target sample: 51, Prediction:1, Target's Score:[-3.4945703, 12.134558, -4.902304, 0.18853109, -2.108276, -0.6606626, 3.5189717, -4.980808, 0.9931969, -0.5761627]
Target sample: 56, Prediction:1, Target's Score:[-2.7681398, 9.627135, -3.833061, 1.395349, -0.36733368, -3.003755, 6.1519904, -5.0045576, -1.815325, -0.2876626]
Target sample: 61, Prediction:1, Target's Score:[-1.5442706, 9.72131, -4.608986, 1.6446716, 0.18648826, -2.5932002, 4.671892, -5.7695923, -2.705847, 1.107686]
Target sample: 66, Prediction:1, Target's Score:[-2.32007, 12.829677, -4.5090165, -0.09850173, -4.370613, -2.7360537, 6.9928203, -5.7929406, -0.5325512, 0.61234474]
Target sample: 71, Prediction:1, Target's Score:[-0.88483775, 5.97376, -2.3175073, 1.5283622, 3.6757743, -4.358885, 4.1799808, -4.094228, -1.0081902, -2.5843956]
Target sample: 76, Prediction:1, Target's Score:[-1.4321607, 10.658881, -2.6683855, 1.1316876, -3.3578377, -2.7711737, 8.665569, -6.997523, -5.0292583, 1.8756919]
Target sample: 81, Prediction:1, Target's Score:[0.9887198, 8.693893, -1.8371129, 1.6699572, -3.1791291, -3.296409, 5.330966, -6.363038, -3.9570358, 2.0278957]
Target sample: 86, Prediction:6, Target's Score:[-0.11737473, 5.9844356, -1.5873047, 0.11714326, -2.003058, -3.4177115, 8.045927, -4.7612524, -2.1452744, -0.06519394]
Target sample: 91, Prediction:1, Target's Score:[-0.86254966, 10.260078, -2.9457233, -0.7433065, -5.3892436, -1.2324263, 7.6165056, -6.4158974, 0.13892546, -0.36079693]
Target sample: 96, Prediction:1, Target's Score:[-2.0111759, 13.05636, -4.3301644, -1.7438327, -4.5512605, -1.3374852, 6.186974, -5.3252454, -2.3947215, 2.5442934]
Target sample: 101, Prediction:1, Target's Score:[0.42949262, 10.542934, -1.7253932, -1.2956573, -5.139104, -2.973532, 6.9844995, -6.0251484, -1.0054718, 0.2700166]
Target sample: 106, Prediction:6, Target's Score:[-1.9782696, 9.769627, -1.4250219, -0.75340146, -4.8721204, -3.2727797, 10.017009, -5.654882, -1.7764814, -0.008565636]
Target sample: 111, Prediction:1, Target's Score:[-0.94921947, 9.713022, -1.1494955, -0.5543601, -4.124757, -3.2242725, 8.676253, -5.6017356, -2.3952053, -0.33903453]
Target sample: 116, Prediction:1, Target's Score:[-1.0977526, 13.372427, -2.3143125, -1.064059, -3.637286, -3.8101852, 6.7935076, -5.4114404, -1.8626236, -0.8951182]
Target sample: 121, Prediction:1, Target's Score:[-0.17538732, 12.999889, -2.6911333, -1.6561561, -3.7150042, -3.618768, 4.183663, -4.020267, -0.2805583, -0.9453156]
Target sample: 126, Prediction:1, Target's Score:[-1.4222808, 9.619444, -3.2880192, 0.47340792, -2.1127722, -3.3938138, 6.869341, -5.1170993, 0.26946104, -1.8326108]
Target sample: 131, Prediction:1, Target's Score:[-1.9493079, 8.230761, -3.8495476, -0.9619332, 3.6903594, -2.9542575, 2.2891402, -1.7468059, -2.1116276, -0.49827737]
Target sample: 136, Prediction:1, Target's Score:[-2.0113544, 8.990746, -3.812412, 0.6167348, -3.6584458, -1.8156724, 6.3594427, -5.636397, -1.4138193, 2.455645]
Target sample: 141, Prediction:9, Target's Score:[-0.6262886, 4.317217, -2.6903658, 2.3994136, -1.1899282, -2.8093905, 5.23985, -5.257366, -5.1209126, 5.8316946]
Target sample: 146, Prediction:1, Target's Score:[-2.2427154, 10.363458, -2.5468986, 0.9919656, -3.2322862, -2.9879093, 6.646105, -5.4554405, -4.465795, 3.0201669]
Target sample: 151, Prediction:1, Target's Score:[-1.4769536, 11.186895, -2.7000635, -1.0564241, -3.8791003, -3.1194682, 8.14079, -5.921714, -3.5024981, 2.4011745]
Target sample: 156, Prediction:6, Target's Score:[-0.24075575, 5.0983205, -1.4824859, 1.9625063, -4.269427, -3.0127325, 9.489102, -6.2055397, -5.52936, 4.246374]
Target sample: 161, Prediction:6, Target's Score:[-0.2834865, -3.009546, 2.0900576, 4.2389207, 2.7460346, -3.188081, 9.714997, -4.5178576, -5.095565, -2.6486695]
Target sample: 166, Prediction:6, Target's Score:[-2.9800103, 2.733021, -2.849971, 0.99702895, -3.0545135, -2.3662145, 9.311662, -5.9159036, -4.6221085, 8.816343]
Current ATTACK acc on target samples: 23.529
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 03:44:21 Epoch 59, Val iteration 0, acc 89.400 (89.400)
2021-06-11 03:44:27 Epoch 59, Val iteration 19, acc 90.600 (89.150)
* Prec: 89.15000114440917
Per class accuracy =  [0.93097449 0.90768152 0.83944398 0.8289783  0.88276135 0.82628118
 0.92867807 0.88926914 0.92662403 0.95011358]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 9, 6, 9, 9, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 3, 1, 1, 1, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 9, 9, 9
ATTACK acc: 30.88235294117647
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  1698
poison index =  600
poison index =  770
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 03:44:35, Val iteration 0, acc 96.200 (96.200)
2021-06-11 03:44:47, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 03:44:54, Epoch 0, Iteration 7, loss 0.495 (0.640), acc 84.615 (82.200)
2021-06-11 03:46:05, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-4.235692, 4.4125333, -2.326066, -0.5659463, -2.97576, -3.4727235, 8.473485, -1.766959, 3.595526, -1.0273558]
Target sample: 6, Prediction:6, Target's Score:[-4.48368, 4.522415, -0.18673494, -2.0929606, -2.3751776, -4.0357084, 5.954022, -2.764809, 4.5038295, 1.0784034]
Target sample: 11, Prediction:6, Target's Score:[-3.3983357, 2.7972395, 0.5636491, -3.2694023, -1.8228433, -3.3157356, 9.013589, -2.073187, 3.2461562, -1.6225201]
Target sample: 16, Prediction:6, Target's Score:[-4.371905, 2.0916827, -2.8768978, -1.8552094, -2.070819, -3.430653, 14.82383, -2.4750519, 3.478602, -3.2128694]
Target sample: 21, Prediction:1, Target's Score:[-3.3025365, 9.65297, -1.9413989, -3.2502387, -2.9126291, -3.5344393, 8.98886, -2.9635544, 0.16821745, -0.8179996]
Target sample: 26, Prediction:1, Target's Score:[-3.3669422, 13.309275, -1.6591306, -4.192782, -4.167297, -3.5916364, 6.403085, -2.648567, -0.15344217, 0.16456139]
Target sample: 31, Prediction:1, Target's Score:[-3.38965, 15.168227, -1.8939521, -2.9770944, -4.031796, -4.095779, 3.9382014, -3.3009107, -0.3720738, 1.0489917]
Target sample: 36, Prediction:1, Target's Score:[-3.2571356, 12.1507845, -2.0308313, -2.7274833, -3.57038, -4.1046934, 2.6941772, -3.519316, 0.32662103, 4.1328683]
Target sample: 41, Prediction:1, Target's Score:[-4.276856, 12.422278, -3.0892754, -2.2770994, -3.7741127, -4.160873, 4.6162586, -3.8355289, 1.9113346, 2.572941]
Target sample: 46, Prediction:1, Target's Score:[-2.7889454, 7.4874587, -3.0615797, -2.6225054, -2.3288395, -4.381881, 5.5155773, -2.1950803, 4.4349895, 0.059144385]
Target sample: 51, Prediction:1, Target's Score:[-3.9153879, 8.400672, -3.6954188, -2.3333473, -2.7854588, -4.379626, 7.161048, -2.9141722, 5.7371726, -1.1499982]
Target sample: 56, Prediction:1, Target's Score:[-2.3591788, 7.623694, -2.9817467, -1.7483782, -2.6943688, -4.603899, 6.817652, -3.0490675, 3.4605765, -0.35953665]
Target sample: 61, Prediction:1, Target's Score:[-2.67531, 9.416887, -3.151845, -0.9296865, -2.6930404, -4.486523, 4.541161, -3.4851835, 3.4345887, 0.13530469]
Target sample: 66, Prediction:1, Target's Score:[-2.3653271, 9.877713, -3.8468444, 0.078450754, -3.255108, -4.19996, 5.860738, -3.5278046, 1.0164258, 0.44519496]
Target sample: 71, Prediction:1, Target's Score:[-1.9850793, 7.9042306, -3.2494879, -1.3088651, -1.9992638, -4.5165963, 7.103186, -3.4263718, 2.2787623, -0.707005]
Target sample: 76, Prediction:1, Target's Score:[-1.8768907, 9.9418955, -3.801715, -1.9719619, -2.2905223, -3.876095, 7.655402, -3.0209365, -0.4585645, -0.22545636]
Target sample: 81, Prediction:6, Target's Score:[-0.08510818, 6.3861613, -3.150416, -2.7366903, -2.030201, -4.3797693, 10.107189, -2.6815736, 0.23814556, -1.5880114]
Target sample: 86, Prediction:6, Target's Score:[-2.0835817, 0.6593547, -1.8690572, -1.657973, -2.149835, -3.6029942, 11.83434, -1.8708745, 4.080629, -3.2372682]
Target sample: 91, Prediction:6, Target's Score:[-2.6661534, 5.6197686, -2.1696444, -2.6216989, -2.649035, -3.3957918, 6.9167705, -2.9574864, 5.878568, -1.8248414]
Target sample: 96, Prediction:6, Target's Score:[-3.4247377, 4.1982594, -3.2302604, -1.8729353, -0.49778226, -3.3803065, 8.461888, -1.5830715, 3.7154112, -2.2747219]
Target sample: 101, Prediction:6, Target's Score:[-2.6811721, 6.3340554, -2.59429, -4.127588, -1.3962742, -3.3211777, 8.994946, -1.7229204, 2.4294653, -1.7985245]
Target sample: 106, Prediction:6, Target's Score:[-3.779226, 6.037993, -2.8951964, -3.1117587, -3.5353413, -3.8929248, 14.558957, -3.4931986, 0.77511644, -0.577999]
Target sample: 111, Prediction:1, Target's Score:[-1.1743647, 9.7136545, -3.1997106, -2.637729, -2.9521325, -4.666648, 9.071689, -3.517583, -0.14538386, -0.40939748]
Target sample: 116, Prediction:6, Target's Score:[-3.3272352, 8.195962, -2.906507, -1.7046633, -2.831766, -4.1471276, 8.854357, -2.9035501, 1.4268658, -0.5670939]
Target sample: 121, Prediction:1, Target's Score:[-1.1715908, 6.5601454, -3.8832095, -1.8860359, -3.329881, -4.3155274, 5.3421693, -4.2293105, 1.9160447, 5.08752]
Target sample: 126, Prediction:1, Target's Score:[-3.2964938, 9.711166, -2.9559689, -2.6188219, -2.2856424, -4.3590875, 4.7013826, -3.7183275, 3.0936542, 1.84164]
Target sample: 131, Prediction:6, Target's Score:[-3.687586, 3.6309621, -2.1248913, -1.8420365, -2.6840136, -3.5333295, 7.3061943, -3.1930685, 6.085528, 0.16562349]
Target sample: 136, Prediction:6, Target's Score:[-2.6103606, 5.1714053, -3.34173, -1.9809072, -2.56925, -3.9960876, 6.161476, -2.631696, 4.111462, 1.7993125]
Target sample: 141, Prediction:1, Target's Score:[-2.3030326, 6.945618, -2.493165, -1.733274, -3.3858576, -4.0045877, 5.0272536, -2.3744862, 4.165025, 0.26544154]
Target sample: 146, Prediction:6, Target's Score:[-2.9470484, 6.6425595, -1.8526464, -0.97734326, -3.6050992, -3.952606, 8.004589, -3.2734168, 1.1138914, 0.9299626]
Target sample: 151, Prediction:1, Target's Score:[-2.6809146, 9.6868925, -2.6979122, -2.2474737, -3.1093566, -3.5897257, 7.3435287, -3.2090611, 0.27359417, 0.31027734]
Target sample: 156, Prediction:1, Target's Score:[-2.5241802, 9.692229, -1.9062767, -2.7301934, -3.9439008, -4.148299, 8.775008, -2.7179532, -0.47938803, 0.061988838]
Target sample: 161, Prediction:6, Target's Score:[-3.4597561, 2.0664642, -0.45811638, -0.82825065, -0.99052906, -3.7860324, 11.522156, -2.6137664, 1.8486086, -3.2096608]
Target sample: 166, Prediction:6, Target's Score:[-4.983616, 4.51904, -2.3139381, -1.7235601, -1.7901487, -3.5654292, 10.720541, -2.7315283, 2.5374403, -0.56430537]
Current ATTACK acc on target samples: 47.059
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 03:47:14 Epoch 59, Val iteration 0, acc 92.400 (92.400)
2021-06-11 03:47:27 Epoch 59, Val iteration 19, acc 93.600 (92.710)
* Prec: 92.71000137329102
Per class accuracy =  [0.93763225 0.94929298 0.89571745 0.86555523 0.9651353  0.89493225
 0.95782766 0.92090298 0.95090285 0.93596958]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 8, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 8, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 1, 6, 1, 1, 6, 6, 6, 1, 8, 1, 8, 1, 6, 1, 1, 6, 6, 1, 6, 1, 1, 6, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 8, 6, 6
ATTACK acc: 46.3235294117647
--------
------SUMMARY------
TIME ELAPSED (mins): 32
TARGET INDEX: 8
ResNet50 70.58823529411765 76.47058823529412 95.46000137329102 91.9000015258789
DPN92 76.47058823529412 74.26470588235294 95.50000267028808 93.07000198364258
MobileNetV2 23.529411764705884 30.88235294117647 91.22000160217286 89.15000114440917
GoogLeNet 47.05882352941177 46.3235294117647 95.41000213623047 92.71000137329102
True False False False False
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 104 images of target 9
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=False, nearest=True, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=9, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/9/target-num-20
torch.Size([200, 1, 3, 32, 32]) torch.Size([18, 3, 32, 32])
Selected nearest neighbors: [1088, 1212, 1698, 1829, 600]
Selected base image indices: [1088, 1212, 1698, 1829, 600]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103]
# Targets: 18, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 03:48:04 Iteration 0 	 Training Loss: 7.408e-01 	 Loss in Target Net: 9.775e-01	  
tensor(-0.0005, device='cuda:0')
 2021-06-11 03:49:09 Iteration 50 	 Training Loss: 2.002e-01 	 Loss in Target Net: 6.488e-01	  
tensor(-0.0017, device='cuda:0')
 2021-06-11 03:50:12 Iteration 100 	 Training Loss: 1.760e-01 	 Loss in Target Net: 8.046e-01	  
tensor(-0.0013, device='cuda:0')
 2021-06-11 03:51:15 Iteration 150 	 Training Loss: 1.673e-01 	 Loss in Target Net: 7.730e-01	  
tensor(-0.0003, device='cuda:0')
 2021-06-11 03:52:15 Iteration 200 	 Training Loss: 1.535e-01 	 Loss in Target Net: 6.732e-01	  
tensor(0.0014, device='cuda:0')
 2021-06-11 03:53:16 Iteration 250 	 Training Loss: 1.532e-01 	 Loss in Target Net: 6.632e-01	  
tensor(0.0031, device='cuda:0')
 2021-06-11 03:54:18 Iteration 300 	 Training Loss: 1.429e-01 	 Loss in Target Net: 7.650e-01	  
tensor(0.0052, device='cuda:0')
 2021-06-11 03:55:19 Iteration 350 	 Training Loss: 1.438e-01 	 Loss in Target Net: 7.014e-01	  
tensor(0.0065, device='cuda:0')
 2021-06-11 03:56:21 Iteration 400 	 Training Loss: 1.458e-01 	 Loss in Target Net: 6.995e-01	  
tensor(0.0064, device='cuda:0')
 2021-06-11 03:57:24 Iteration 450 	 Training Loss: 1.374e-01 	 Loss in Target Net: 6.929e-01	  
tensor(0.0065, device='cuda:0')
 2021-06-11 03:58:25 Iteration 500 	 Training Loss: 1.387e-01 	 Loss in Target Net: 6.424e-01	  
tensor(0.0063, device='cuda:0')
 2021-06-11 03:59:28 Iteration 550 	 Training Loss: 1.463e-01 	 Loss in Target Net: 6.065e-01	  
tensor(0.0065, device='cuda:0')
 2021-06-11 04:00:30 Iteration 600 	 Training Loss: 1.461e-01 	 Loss in Target Net: 6.286e-01	  
tensor(0.0054, device='cuda:0')
 2021-06-11 04:01:33 Iteration 650 	 Training Loss: 1.402e-01 	 Loss in Target Net: 6.948e-01	  
tensor(0.0061, device='cuda:0')
 2021-06-11 04:02:35 Iteration 700 	 Training Loss: 1.359e-01 	 Loss in Target Net: 7.292e-01	  
tensor(0.0068, device='cuda:0')
 2021-06-11 04:03:41 Iteration 750 	 Training Loss: 1.330e-01 	 Loss in Target Net: 7.024e-01	  
tensor(0.0068, device='cuda:0')
 2021-06-11 04:04:47 Iteration 800 	 Training Loss: 1.400e-01 	 Loss in Target Net: 7.557e-01	  
tensor(0.0055, device='cuda:0')
 2021-06-11 04:05:49 Iteration 850 	 Training Loss: 1.426e-01 	 Loss in Target Net: 7.291e-01	  
tensor(0.0059, device='cuda:0')
 2021-06-11 04:06:52 Iteration 900 	 Training Loss: 1.378e-01 	 Loss in Target Net: 6.861e-01	  
tensor(0.0046, device='cuda:0')
 2021-06-11 04:07:54 Iteration 950 	 Training Loss: 1.352e-01 	 Loss in Target Net: 7.151e-01	  
tensor(0.0043, device='cuda:0')
 2021-06-11 04:08:54 Iteration 999 	 Training Loss: 1.347e-01 	 Loss in Target Net: 6.732e-01	  
tensor(0.0045, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  1829
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 04:08:59, Val iteration 0, acc 94.200 (94.200)
2021-06-11 04:09:09, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 04:09:14, Epoch 0, Iteration 7, loss 0.522 (0.958), acc 82.692 (84.200)
2021-06-11 04:10:14, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[0.34091085, 7.673732, -4.236982, -1.416602, -3.731888, -2.3270252, 4.226996, -1.6611091, -1.7969267, 3.1297076]
Target sample: 7, Prediction:6, Target's Score:[-2.7502, 3.4267178, -3.5078945, -0.653332, -2.5531218, -2.4257452, 11.117886, -1.5702705, 2.0468702, -2.9872324]
Target sample: 13, Prediction:1, Target's Score:[-3.181998, 9.995091, -3.4916651, -2.654753, -3.7725554, -3.1124609, 9.671421, -0.8638432, -1.0605371, -1.3454214]
Target sample: 19, Prediction:1, Target's Score:[-4.3762403, 14.71, -2.8595898, -2.0552967, -4.5482316, -2.879025, 8.243662, -2.5625722, -3.6293907, 0.18267183]
Target sample: 25, Prediction:9, Target's Score:[1.0166237, -0.86320156, -2.5306368, 0.9598173, -2.9362047, -0.9994186, 3.3615973, 1.7324631, -3.2718685, 3.715397]
Target sample: 31, Prediction:1, Target's Score:[-4.103099, 15.863148, -3.230131, -2.702441, -4.381752, -3.2589226, 6.765772, -1.0052444, -3.3457928, -0.38522404]
Target sample: 37, Prediction:1, Target's Score:[-2.8023767, 9.59497, -4.158564, 0.3286378, -3.9516137, -1.0217243, 8.798239, -3.0308423, -3.4654083, -0.07452728]
Target sample: 43, Prediction:1, Target's Score:[-3.0404437, 9.739221, -3.9434927, -1.8854351, -3.7149696, -2.41928, 8.699469, 0.051880565, -1.3898396, -1.9191301]
Target sample: 49, Prediction:6, Target's Score:[-0.7749401, 3.6693218, -4.025426, -0.9945956, -2.9812906, -2.321081, 7.259965, -1.2489668, 2.9099047, -1.3487563]
Target sample: 55, Prediction:6, Target's Score:[-0.16038308, 4.5806003, -4.17983, -1.075322, -2.9529035, -2.331601, 6.5868096, -1.7788267, 1.2534503, 0.22283515]
Target sample: 61, Prediction:1, Target's Score:[-0.070267014, 9.750643, -4.2585196, -2.5813022, -3.3599813, -3.1490538, 4.2812495, -1.5249333, -2.962504, 4.099521]
Target sample: 67, Prediction:6, Target's Score:[-3.732287, 4.9761953, -4.177111, -0.9240593, -3.227769, -2.1590207, 14.63991, -2.301876, -3.7382002, 0.8743123]
Target sample: 73, Prediction:6, Target's Score:[-2.687878, 6.4781284, -5.085808, 0.34939265, -4.152555, -1.6016333, 11.398799, -1.654545, -1.5921845, -1.2602184]
Target sample: 79, Prediction:1, Target's Score:[-2.8546338, 13.273952, -4.631587, -2.3770509, -4.8495073, -2.9950871, 7.8765144, -2.6649134, -1.6781739, 1.1206235]
Target sample: 85, Prediction:1, Target's Score:[-4.339859, 11.232412, -3.981019, -1.3085784, -3.9588673, -3.185676, 10.889488, -3.2853878, -3.7267177, 1.8948076]
Target sample: 91, Prediction:1, Target's Score:[-1.5040066, 9.75035, -3.5494177, -0.31777737, -3.6878126, -2.322136, 5.129753, -1.6687359, -3.3130934, 1.6839408]
Target sample: 97, Prediction:6, Target's Score:[0.013886608, 2.9513242, -3.9670606, -1.5324019, -2.410155, -1.8074987, 8.135459, -1.3906281, 1.6309624, -1.4728677]
Target sample: 103, Prediction:6, Target's Score:[-1.3460041, 3.114152, -3.77756, -1.114074, -2.5144057, -2.4796765, 9.121907, -1.7049359, 3.7216892, -2.8895485]
Current ATTACK acc on target samples: 38.889
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 04:11:13 Epoch 59, Val iteration 0, acc 92.400 (92.400)
2021-06-11 04:11:23 Epoch 59, Val iteration 19, acc 91.800 (91.840)
* Prec: 91.84000167846679
Per class accuracy =  [0.92520426 0.95102528 0.85721335 0.84954597 0.92147317 0.88209863
 0.94951271 0.95117836 0.94448817 0.95391195]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 1, 6, 6, 6, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 6, 1, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 1, 9, 9, 1, 1, 1, 1, 1, 6, 6, 6, 6, 1, 1, 1, 6, 1, 1, 1, 1, 1, 6, 1, 6, 6, 6, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 45.348837209302324
--------
DPN92
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  1829
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 04:11:35, Val iteration 0, acc 94.800 (94.800)
2021-06-11 04:11:55, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 04:12:09, Epoch 0, Iteration 7, loss 0.113 (0.371), acc 96.154 (91.800)
2021-06-11 04:14:47, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[1.4343915, 7.9871984, -2.3285809, -1.7817311, -2.3090127, -0.8189003, 2.1767995, -3.7446623, 0.75618935, -0.861206]
Target sample: 7, Prediction:6, Target's Score:[-0.7085997, 2.9800203, -1.1182909, -0.26321718, -0.53457063, -2.4400785, 6.84796, -3.098722, 0.4374017, -1.6872921]
Target sample: 13, Prediction:6, Target's Score:[-1.7775738, 3.3784058, -2.483977, -2.5058498, -1.4853477, -1.5930352, 9.777858, -3.3848572, 1.168438, -0.7078668]
Target sample: 19, Prediction:1, Target's Score:[-0.9763017, 8.433545, -1.6006573, -1.1882821, -1.148829, -2.0324533, 3.812122, -4.1542554, -0.4470196, -0.19523668]
Target sample: 25, Prediction:3, Target's Score:[-3.4229348, -2.1455252, 1.1301676, 6.331522, -2.5120072, -0.6968852, 1.8500799, 0.68758434, -1.0554796, 0.33898982]
Target sample: 31, Prediction:1, Target's Score:[-1.0198542, 12.568775, -2.8747334, -2.8376632, -2.6130338, -2.2563179, 3.7635286, -4.2873073, -0.2964402, 0.4200287]
Target sample: 37, Prediction:6, Target's Score:[-1.3555597, 4.966915, -0.068896316, -1.1822051, -0.51474917, -1.4037048, 5.4093947, -4.0080037, -0.16787323, -1.2564126]
Target sample: 43, Prediction:6, Target's Score:[-2.0867028, 5.0653667, -1.3997601, -2.879254, -1.5706941, -0.74384284, 6.5748606, -3.6156383, 2.8832848, -1.8384624]
Target sample: 49, Prediction:6, Target's Score:[2.5652876, 2.44532, -3.3590584, -0.88328665, -2.037063, -3.4664197, 5.362455, -2.5638227, 1.4428753, 0.9339266]
Target sample: 55, Prediction:6, Target's Score:[0.61304134, -0.8167067, -2.257148, 1.0808716, -1.1302361, -2.862472, 7.205681, -1.9941945, 1.3772335, -0.83420646]
Target sample: 61, Prediction:6, Target's Score:[-0.26856646, 6.7424955, -2.5301425, -1.3221905, -0.94040626, -2.076123, 7.498682, -4.314323, -1.0612284, -1.2064523]
Target sample: 67, Prediction:6, Target's Score:[-1.9876239, 2.8742075, -0.79043126, -1.9066795, 0.12498056, -1.8671439, 11.945319, -4.1013618, -1.853128, -2.0014126]
Target sample: 73, Prediction:6, Target's Score:[-0.906604, 1.9797916, -2.2433288, -1.2957737, -1.3636729, -2.3595042, 10.652343, -3.4744027, -1.0202304, 0.4426023]
Target sample: 79, Prediction:6, Target's Score:[-1.0575943, 6.6867957, -2.5060763, -2.1052897, -1.9705467, -2.429766, 8.657824, -4.2300754, -1.3049085, 0.7696972]
Target sample: 85, Prediction:6, Target's Score:[-2.3511848, 2.6681437, 0.40548155, -1.2235606, 0.6267273, -2.0309598, 10.238327, -4.608394, -1.5829564, -1.7051312]
Target sample: 91, Prediction:1, Target's Score:[-1.2651585, 8.863419, -2.6437922, -1.4247743, -1.516734, -1.188852, 2.8347542, -3.9038055, 1.1056312, -0.36497647]
Target sample: 97, Prediction:6, Target's Score:[1.3958472, -0.02050115, -2.073628, -0.2695941, -0.6016278, -2.5163972, 7.7091684, -2.3351371, 0.8583733, -1.7696995]
Target sample: 103, Prediction:6, Target's Score:[0.912343, 2.231549, -1.4254017, -0.2060901, -0.64655024, -2.5596561, 7.1417484, -3.3846192, 0.2912011, -1.9358047]
Current ATTACK acc on target samples: 72.222
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 04:17:22 Epoch 59, Val iteration 0, acc 93.000 (93.000)
2021-06-11 04:17:42 Epoch 59, Val iteration 19, acc 92.800 (92.880)
* Prec: 92.88000221252442
Per class accuracy =  [0.95858162 0.97975083 0.87137241 0.89244241 0.94751481 0.85393948
 0.92975195 0.93924899 0.95831262 0.95706315]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 1, 1, 6, 6, 1, 1, 1, 1, 6, 1, 1, 1, 1, 6, 1, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 1, 1, 1, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 6, 6, 6, 1, 6, 1, 1, 6, 6
ATTACK acc: 66.27906976744185
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  1829
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 04:17:46, Val iteration 0, acc 92.600 (92.600)
2021-06-11 04:17:52, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 04:17:54, Epoch 0, Iteration 7, loss 0.268 (0.301), acc 88.462 (90.600)
2021-06-11 04:18:21, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.3977927, 10.947209, -3.8180597, 0.41886115, -3.0795429, -3.3090234, 5.528989, -3.9303453, -1.8427488, 1.1339242]
Target sample: 7, Prediction:6, Target's Score:[1.4395481, 4.8388543, -0.8651912, 4.4215803, -1.9405284, -2.9229298, 5.252217, -5.143485, -5.000348, 0.49032873]
Target sample: 13, Prediction:6, Target's Score:[-1.2775729, 8.977495, -1.6985112, 0.29098755, -2.6624923, -4.113456, 9.186411, -4.4654098, -0.07521147, -3.56008]
Target sample: 19, Prediction:1, Target's Score:[0.08514479, 11.614302, -3.1859117, 0.7460517, -3.677168, -3.439996, 4.082467, -3.620485, 1.0532434, -3.0047832]
Target sample: 25, Prediction:6, Target's Score:[-2.8839905, -1.526067, 1.7583095, 3.9402502, -4.076203, -2.6923127, 4.3526464, -1.5499507, -1.0417176, 4.2232976]
Target sample: 31, Prediction:1, Target's Score:[-0.04656559, 12.161, -4.509112, -0.7165856, -3.1376147, -3.4023666, 3.8276212, -4.8828254, -1.161402, 2.519214]
Target sample: 37, Prediction:1, Target's Score:[0.15873177, 11.672882, -4.3473525, 1.5164279, -3.7067938, -3.5258183, 7.1738167, -5.7154727, -2.041127, -0.5339579]
Target sample: 43, Prediction:1, Target's Score:[1.2941227, 9.2752905, -2.396988, -0.5353843, -4.238626, -4.0512557, 7.6572413, -4.1374264, 1.0905828, -3.3860888]
Target sample: 49, Prediction:1, Target's Score:[-0.68316054, 10.391532, -4.411338, 3.8439412, -4.715706, -3.7090294, 8.106913, -6.612732, 1.1117123, -2.6318097]
Target sample: 55, Prediction:6, Target's Score:[-0.72279215, 1.8044113, -0.28068784, 5.165497, -1.6336126, -3.291462, 9.039275, -5.674467, -3.078338, -0.7878111]
Target sample: 61, Prediction:6, Target's Score:[0.8698261, 1.3921021, -2.1748848, 4.0416303, -2.0496836, -3.8388114, 5.0038114, -5.2939854, -1.9639919, 4.5633097]
Target sample: 67, Prediction:6, Target's Score:[-1.0029681, 7.49243, -3.668517, 1.6894447, -4.1787777, -2.6968946, 10.708414, -5.883326, -3.3664896, 1.4877739]
Target sample: 73, Prediction:6, Target's Score:[-0.73368174, 6.355354, -6.3836956, 2.2924757, -3.736252, -4.203169, 7.4445453, -5.2173886, 0.124907635, 4.6841273]
Target sample: 79, Prediction:6, Target's Score:[2.3354695, 6.837025, -5.1317196, 1.6252623, -5.221103, -4.060047, 7.4993587, -5.026457, 1.7906653, -0.06261741]
Target sample: 85, Prediction:6, Target's Score:[-0.28194985, 5.492617, 0.34021553, 5.0936217, -4.117912, -2.5870533, 7.316232, -5.073063, -4.21453, -1.384234]
Target sample: 91, Prediction:1, Target's Score:[-0.5903342, 11.396267, -3.9379, 1.9882464, -3.6120803, -3.140068, 6.7006783, -5.7847137, -5.4658966, 3.1469982]
Target sample: 97, Prediction:3, Target's Score:[-1.1425078, 2.5110414, 0.31158525, 5.936425, 0.40288094, -4.357293, 4.115158, -3.6042018, -2.4174101, -1.1799517]
Target sample: 103, Prediction:3, Target's Score:[-1.405401, 1.23114, 1.2411591, 7.45197, 0.6022906, -3.667406, 7.340214, -6.5319085, -5.1507497, -0.50782907]
Current ATTACK acc on target samples: 50.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 04:18:49 Epoch 59, Val iteration 0, acc 90.200 (90.200)
2021-06-11 04:18:55 Epoch 59, Val iteration 19, acc 90.400 (89.430)
* Prec: 89.43000106811523
Per class accuracy =  [0.92142175 0.92589502 0.84749316 0.82582971 0.88693894 0.81990893
 0.94035764 0.88894994 0.93192992 0.95014657]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 1, 1, 1, 3, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 6, 6, 6, 1, 1, 6, 1, 6, 1, 6, 1, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 1, 6, 1, 6, 6, 6, 6, 9, 6, 1, 1, 1, 1, 6, 1, 1, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 6, 1, 1, 3, 3, 1, 6
ATTACK acc: 44.18604651162791
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  1829
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 04:19:02, Val iteration 0, acc 96.200 (96.200)
2021-06-11 04:19:14, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 04:19:21, Epoch 0, Iteration 7, loss 0.724 (0.796), acc 75.000 (78.800)
2021-06-11 04:20:32, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:0, Target's Score:[3.5100107, 1.9847002, 0.8051644, 0.07948162, -1.1963465, -3.2772033, 3.2639453, -2.1886842, -0.79335475, -2.1981869]
Target sample: 7, Prediction:6, Target's Score:[-1.1301804, -0.80032974, 0.1129072, 2.757032, 0.02468878, -4.287867, 6.055138, -2.8813083, 3.2054203, -3.099563]
Target sample: 13, Prediction:6, Target's Score:[-0.8047676, 1.8543837, -1.6420367, 1.3486656, -3.2099178, -2.8277194, 6.6593876, -2.744301, 3.274882, -1.9526148]
Target sample: 19, Prediction:6, Target's Score:[-3.063713, 3.5679483, -2.9938178, 3.379781, -2.041313, -3.4828887, 7.6732626, -2.0825315, 1.7760222, -2.767866]
Target sample: 25, Prediction:3, Target's Score:[-3.8564944, -0.20290197, 2.051282, 3.0499084, -1.1392704, 2.3603213, 2.2208252, -0.15438245, -2.6076868, -1.7229801]
Target sample: 31, Prediction:1, Target's Score:[-0.2573597, 9.524219, -2.4683554, 0.92150205, -0.38753897, -4.118257, 3.23484, -3.562932, -1.2968276, -1.5855618]
Target sample: 37, Prediction:6, Target's Score:[-0.4387688, 4.913243, -2.4844427, 3.890029, -0.16036212, -2.724435, 5.9418044, -3.644931, -2.75144, -2.5399222]
Target sample: 43, Prediction:6, Target's Score:[-3.3108058, 1.7111285, -1.8279729, 1.0600628, -2.4013681, -1.6254194, 6.765115, -1.1031623, 3.2132065, -2.5263462]
Target sample: 49, Prediction:8, Target's Score:[0.69497836, -2.4383981, -0.7502801, 1.1931206, -2.5760338, -4.0010805, 5.722885, -2.2011955, 7.776983, -3.4932568]
Target sample: 55, Prediction:6, Target's Score:[-0.17414704, -1.4063466, -2.4123049, 1.6377758, -2.334969, -3.1229167, 5.9031477, -1.3288833, 5.7544603, -2.5751102]
Target sample: 61, Prediction:1, Target's Score:[-1.4227316, 4.6261873, -2.5868468, 2.1616392, -1.9174023, -3.560017, 3.8415813, -1.6981205, 1.6392114, -1.1040756]
Target sample: 67, Prediction:6, Target's Score:[-1.2900316, 1.405748, -1.1141353, 2.7453785, -2.272301, -2.4713585, 9.920265, -2.169136, -2.0355656, -2.741413]
Target sample: 73, Prediction:6, Target's Score:[0.6690946, 3.2907577, -3.1163955, -0.78242147, -3.3046014, -3.7315254, 6.83132, -3.2053561, 5.350389, -2.058197]
Target sample: 79, Prediction:6, Target's Score:[0.9784256, 5.09071, -3.9100027, -0.5859491, -3.5976825, -3.944185, 6.391016, -3.5005684, 4.357449, -1.325656]
Target sample: 85, Prediction:6, Target's Score:[-2.127067, 4.250388, -1.5192466, 3.6391532, -0.7795317, -3.0033252, 6.0977764, -3.0031343, -1.7816696, -1.7801322]
Target sample: 91, Prediction:6, Target's Score:[-2.3866434, 4.088803, -1.8312883, 1.118418, -1.8506474, -2.1555429, 6.5834436, -3.4102528, 2.0749428, -2.2648876]
Target sample: 97, Prediction:6, Target's Score:[1.8844957, -2.1866813, 0.022554398, 2.5949895, -0.5164332, -4.3986163, 5.0977902, -2.836279, 4.0661674, -3.7743862]
Target sample: 103, Prediction:6, Target's Score:[-0.38939288, -1.4236232, -0.1522507, 2.9697978, -0.52106863, -4.0266743, 6.0742226, -3.286627, 3.8940828, -3.1860478]
Current ATTACK acc on target samples: 72.222
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 04:21:41 Epoch 59, Val iteration 0, acc 93.600 (93.600)
2021-06-11 04:21:54 Epoch 59, Val iteration 19, acc 92.200 (92.390)
* Prec: 92.3900016784668
Per class accuracy =  [0.95798555 0.94525437 0.8876665  0.79346561 0.9507018  0.90317528
 0.95621558 0.94775187 0.94103782 0.95322532]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 8, 6, 8, 8, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 1, 1, 6, 1, 1, 1, 1, 8, 1, 1, 1, 1, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 8, 8, 6, 8, 8, 8, 8, 8, 8, 1, 6, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 1, 8, 8, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 8, 8, 6, 6
ATTACK acc: 59.30232558139535
--------
------SUMMARY------
TIME ELAPSED (mins): 20
TARGET INDEX: 9
ResNet50 38.888888888888886 45.348837209302324 95.46000137329102 91.84000167846679
DPN92 72.22222222222223 66.27906976744185 95.50000267028808 92.88000221252442
MobileNetV2 50.0 44.18604651162791 91.22000160217286 89.43000106811523
GoogLeNet 72.22222222222223 59.30232558139535 95.41000213623047 92.3900016784668
True False False False True
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 104 images of target 9
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=True, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=9, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/9/target-num-20
torch.Size([200, 1, 3, 32, 32]) torch.Size([18, 3, 32, 32])
Selected nearest neighbors: [1088, 1212, 1698, 1829, 600]
Selected base image indices: [1088, 1212, 1698, 1829, 600]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103]
# Targets: 18, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 04:22:31 Iteration 0 	 Training Loss: 7.319e-01 	 Loss in Target Net: 6.037e-01	  
tensor(-0.0014, device='cuda:0')
 2021-06-11 04:23:39 Iteration 50 	 Training Loss: 3.571e-01 	 Loss in Target Net: 4.461e-01	  
tensor(-0.0203, device='cuda:0')
 2021-06-11 04:24:47 Iteration 100 	 Training Loss: 3.280e-01 	 Loss in Target Net: 4.219e-01	  
tensor(-0.0285, device='cuda:0')
 2021-06-11 04:25:55 Iteration 150 	 Training Loss: 3.145e-01 	 Loss in Target Net: 4.680e-01	  
tensor(-0.0329, device='cuda:0')
 2021-06-11 04:27:04 Iteration 200 	 Training Loss: 3.039e-01 	 Loss in Target Net: 4.489e-01	  
tensor(-0.0339, device='cuda:0')
 2021-06-11 04:28:12 Iteration 250 	 Training Loss: 2.987e-01 	 Loss in Target Net: 4.587e-01	  
tensor(-0.0339, device='cuda:0')
 2021-06-11 04:29:20 Iteration 300 	 Training Loss: 2.989e-01 	 Loss in Target Net: 4.366e-01	  
tensor(-0.0333, device='cuda:0')
 2021-06-11 04:30:28 Iteration 350 	 Training Loss: 2.971e-01 	 Loss in Target Net: 4.390e-01	  
tensor(-0.0312, device='cuda:0')
 2021-06-11 04:31:36 Iteration 400 	 Training Loss: 2.956e-01 	 Loss in Target Net: 4.427e-01	  
tensor(-0.0303, device='cuda:0')
 2021-06-11 04:32:45 Iteration 450 	 Training Loss: 2.974e-01 	 Loss in Target Net: 4.195e-01	  
tensor(-0.0298, device='cuda:0')
 2021-06-11 04:33:53 Iteration 500 	 Training Loss: 2.973e-01 	 Loss in Target Net: 4.460e-01	  
tensor(-0.0299, device='cuda:0')
 2021-06-11 04:35:00 Iteration 550 	 Training Loss: 2.939e-01 	 Loss in Target Net: 4.636e-01	  
tensor(-0.0279, device='cuda:0')
 2021-06-11 04:36:08 Iteration 600 	 Training Loss: 2.951e-01 	 Loss in Target Net: 4.197e-01	  
tensor(-0.0262, device='cuda:0')
 2021-06-11 04:37:15 Iteration 650 	 Training Loss: 2.975e-01 	 Loss in Target Net: 4.549e-01	  
tensor(-0.0254, device='cuda:0')
 2021-06-11 04:38:22 Iteration 700 	 Training Loss: 2.971e-01 	 Loss in Target Net: 4.611e-01	  
tensor(-0.0247, device='cuda:0')
 2021-06-11 04:39:30 Iteration 750 	 Training Loss: 2.993e-01 	 Loss in Target Net: 4.710e-01	  
tensor(-0.0247, device='cuda:0')
 2021-06-11 04:40:38 Iteration 800 	 Training Loss: 2.974e-01 	 Loss in Target Net: 4.804e-01	  
tensor(-0.0245, device='cuda:0')
 2021-06-11 04:41:47 Iteration 850 	 Training Loss: 2.934e-01 	 Loss in Target Net: 4.338e-01	  
tensor(-0.0245, device='cuda:0')
 2021-06-11 04:42:55 Iteration 900 	 Training Loss: 2.942e-01 	 Loss in Target Net: 4.214e-01	  
tensor(-0.0245, device='cuda:0')
 2021-06-11 04:44:03 Iteration 950 	 Training Loss: 2.949e-01 	 Loss in Target Net: 4.187e-01	  
tensor(-0.0239, device='cuda:0')
 2021-06-11 04:45:10 Iteration 999 	 Training Loss: 2.961e-01 	 Loss in Target Net: 4.547e-01	  
tensor(-0.0238, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  1829
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 04:45:15, Val iteration 0, acc 94.200 (94.200)
2021-06-11 04:45:25, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 04:45:31, Epoch 0, Iteration 7, loss 0.129 (0.405), acc 98.077 (90.600)
2021-06-11 04:46:31, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.7978506, 3.510748, -0.27299935, -0.90290457, -1.368816, -1.3874727, 7.323023, -2.549697, -1.2029297, -0.33462355]
Target sample: 7, Prediction:6, Target's Score:[-2.9410403, 1.0604268, 0.72811764, -0.5410476, -0.5177282, -2.05685, 9.762205, -2.7545314, -0.85287786, -1.850767]
Target sample: 13, Prediction:6, Target's Score:[-3.250735, 3.7491136, 0.67738914, -1.7850323, -1.11506, -2.6648982, 9.905722, -2.8184965, -1.307713, -1.3640394]
Target sample: 19, Prediction:6, Target's Score:[-3.9467354, 6.5113983, -0.6506338, -1.1122918, -1.6347569, -2.5589225, 8.678529, -3.2094886, -1.9790337, -0.08821207]
Target sample: 25, Prediction:6, Target's Score:[-1.9702897, -0.8723316, 0.29234165, 0.42789528, -0.45549247, -0.79375166, 6.991357, -1.4292952, -0.99986756, -1.1591313]
Target sample: 31, Prediction:1, Target's Score:[-4.036356, 11.135194, -0.74891514, -3.3012476, -2.586097, -2.8799872, 7.38583, -2.402039, -2.7493806, 0.1628227]
Target sample: 37, Prediction:6, Target's Score:[-2.359249, 2.0841148, -0.032086153, 0.5842589, -0.77026474, -1.5409214, 8.460155, -3.221219, -2.2469609, -0.9291011]
Target sample: 43, Prediction:6, Target's Score:[-3.1574943, 5.3042893, -0.12460876, -1.6594731, -1.4925386, -2.0539508, 8.581395, -2.5772452, -1.5055958, -1.3041078]
Target sample: 49, Prediction:6, Target's Score:[-2.7147717, 0.439294, -0.044818416, 0.8017192, -0.8593754, -1.8149834, 8.307363, -2.5896406, -0.15954068, -1.332992]
Target sample: 55, Prediction:6, Target's Score:[-2.7396297, 0.62870944, 0.6596403, -0.6570339, -0.33962905, -1.8683078, 9.593619, -2.7121048, -0.8559334, -1.6707971]
Target sample: 61, Prediction:6, Target's Score:[-3.3754544, 2.5218782, 0.5697832, -0.6023693, -0.55893147, -2.0901084, 8.97302, -3.0117357, -1.5783538, -0.8217109]
Target sample: 67, Prediction:6, Target's Score:[-3.8172483, 3.6586661, -0.01881346, -1.4352633, -1.0791522, -2.4252684, 9.796746, -3.013648, -1.8041837, 0.17050244]
Target sample: 73, Prediction:6, Target's Score:[-2.7940488, 2.7282574, -0.65109444, -0.9144099, -1.3663357, -1.9291369, 8.641253, -2.837638, -1.4601325, 0.62088406]
Target sample: 79, Prediction:6, Target's Score:[-2.9837863, 4.601793, -0.28001782, -1.5780293, -1.5891392, -1.9603899, 6.9291816, -2.5266955, -1.9995402, 1.4045624]
Target sample: 85, Prediction:6, Target's Score:[-3.0342476, 3.1446404, 0.25836343, -1.4286996, -0.98641443, -2.4280295, 10.181133, -3.0672445, -1.5189759, -1.0871438]
Target sample: 91, Prediction:6, Target's Score:[-3.412728, 4.0328326, -0.008489479, -0.1417752, -1.1152683, -1.9056289, 8.405055, -3.1521642, -1.6923038, -0.9939736]
Target sample: 97, Prediction:6, Target's Score:[-2.378319, 0.60552806, 0.6688941, -0.49251163, -0.49113396, -1.8388754, 8.720367, -2.5202408, -0.783684, -1.4558061]
Target sample: 103, Prediction:6, Target's Score:[-2.7805731, -0.10374988, 1.4016079, -0.5190611, -0.042565092, -2.0381434, 9.800868, -3.0455387, -0.82773876, -1.803029]
Current ATTACK acc on target samples: 94.444
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 04:47:30 Epoch 59, Val iteration 0, acc 91.800 (91.800)
2021-06-11 04:47:40 Epoch 59, Val iteration 19, acc 91.400 (90.930)
* Prec: 90.93000183105468
Per class accuracy =  [0.95624127 0.95991712 0.80791354 0.77247381 0.92714727 0.91572874
 0.96541146 0.90850313 0.94229845 0.93866825]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 1, 6, 6, 1, 1, 1, 6, 6, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 90.69767441860465
--------
DPN92
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  1829
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 04:47:52, Val iteration 0, acc 94.800 (94.800)
2021-06-11 04:48:12, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 04:48:27, Epoch 0, Iteration 7, loss 0.512 (0.459), acc 90.385 (89.800)
2021-06-11 04:51:05, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[0.41541782, 5.903863, -3.3462152, -1.1655935, -2.787135, -2.2614214, 5.627512, -1.8556015, 2.78191, -2.7697022]
Target sample: 7, Prediction:6, Target's Score:[0.08291025, 0.79083073, -2.478049, -1.1955436, -0.9309988, -4.343057, 8.750227, -0.76324326, 3.8417716, -3.2573228]
Target sample: 13, Prediction:6, Target's Score:[-0.41276962, 2.8756175, -3.1714277, -1.7939279, -2.106116, -3.8959918, 10.232766, -1.6339476, 3.2254739, -2.7780375]
Target sample: 19, Prediction:1, Target's Score:[-1.3176605, 11.675397, -2.471457, -1.5870752, -2.3719313, -4.3442297, 4.079989, -2.945464, 2.4111989, -2.543695]
Target sample: 25, Prediction:3, Target's Score:[-2.0788453, -2.6626725, 0.045808, 4.8897676, -2.3417323, -2.5862436, 1.9202894, 3.8453348, 1.115822, -1.711497]
Target sample: 31, Prediction:1, Target's Score:[-1.4044838, 11.897456, -3.8700876, -1.5189142, -2.8904061, -4.1766486, 4.6068983, -2.8186195, 2.1331565, -1.3487537]
Target sample: 37, Prediction:1, Target's Score:[-1.3350133, 7.4761167, -0.95115596, -0.609441, -1.7298476, -3.8378704, 5.4778194, -2.9406106, 1.9314326, -2.9657035]
Target sample: 43, Prediction:6, Target's Score:[-0.79639643, 3.053372, -2.3310637, -2.1610885, -1.5086243, -2.9072392, 8.67542, -2.130225, 4.540823, -3.9278138]
Target sample: 49, Prediction:6, Target's Score:[1.7807833, 0.7362205, -3.36804, -0.61258924, -2.2496345, -4.743624, 8.180531, -1.2979255, 4.206881, -2.0803533]
Target sample: 55, Prediction:6, Target's Score:[1.2326268, -0.8591782, -2.6696303, -0.837764, -2.2794774, -3.893053, 8.070561, -0.20358573, 3.945778, -2.0185277]
Target sample: 61, Prediction:6, Target's Score:[-0.10956085, 5.6188264, -3.2001007, 0.029987514, -1.9318287, -4.0780463, 7.402305, -2.0269141, 2.5107331, -3.6359463]
Target sample: 67, Prediction:6, Target's Score:[-1.0529978, 7.238829, -2.6223803, -1.4090592, -1.7078983, -4.10487, 8.9353695, -2.617531, 1.2087318, -3.2812774]
Target sample: 73, Prediction:6, Target's Score:[0.2535721, -0.012534842, -2.2969959, -0.4524836, -1.9780409, -4.221682, 11.772346, -2.1377275, 1.543125, -1.9233199]
Target sample: 79, Prediction:1, Target's Score:[-1.2434014, 8.653924, -3.949575, -1.5021533, -3.2742207, -4.542923, 7.135486, -2.6378021, 2.7483823, -0.7815388]
Target sample: 85, Prediction:6, Target's Score:[-1.549226, 5.4873967, -1.2454231, -0.057967685, -0.8879983, -4.579033, 8.764647, -2.9797468, 1.0285268, -3.410233]
Target sample: 91, Prediction:1, Target's Score:[-1.1460623, 7.9225698, -3.613009, -1.3180035, -2.3322403, -3.0700386, 5.6044087, -2.2016025, 3.0743132, -2.3682373]
Target sample: 97, Prediction:6, Target's Score:[2.4083662, -0.73109126, -2.8204582, -1.3062912, -1.8495123, -4.461018, 7.7863355, -0.54450697, 3.9855895, -1.972085]
Target sample: 103, Prediction:6, Target's Score:[0.9552138, 0.63326335, -2.6631017, -1.1526186, -1.3598361, -4.4148912, 8.674829, -1.4658335, 4.4362288, -3.1255906]
Current ATTACK acc on target samples: 61.111
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 04:53:39 Epoch 59, Val iteration 0, acc 92.400 (92.400)
2021-06-11 04:54:00 Epoch 59, Val iteration 19, acc 95.800 (93.080)
* Prec: 93.08000144958496
Per class accuracy =  [0.92045614 0.96797278 0.90457698 0.87280231 0.9430792  0.88767433
 0.94378392 0.93625083 0.97833056 0.95602638]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 6, 8, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 8, 6, 6, 1, 1, 1, 6, 1, 6, 1, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6
ATTACK acc: 68.6046511627907
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  1829
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 04:54:04, Val iteration 0, acc 92.600 (92.600)
2021-06-11 04:54:09, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 04:54:12, Epoch 0, Iteration 7, loss 0.770 (0.323), acc 76.923 (89.800)
2021-06-11 04:54:39, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.5921535, 11.799007, -4.30357, 1.0769436, -3.9306304, -2.770346, 4.770958, -3.9839847, -2.4645038, 1.865553]
Target sample: 7, Prediction:3, Target's Score:[1.183213, 5.218326, -1.103432, 5.567821, -2.4163284, -2.1771855, 3.9441257, -5.2691164, -5.017301, 0.47660947]
Target sample: 13, Prediction:1, Target's Score:[-1.5248446, 9.16689, -2.7087173, 1.2097731, -3.2816572, -3.2818313, 8.5902405, -4.407227, -0.99774176, -2.354276]
Target sample: 19, Prediction:1, Target's Score:[-0.17960685, 9.74845, -2.797845, 1.939077, -2.8869262, -3.14879, 3.9732456, -3.4045355, 0.14752525, -2.9566152]
Target sample: 25, Prediction:9, Target's Score:[-2.0567317, -0.87861705, -0.11597261, 3.4333282, -4.4674077, -2.471705, 3.8244674, -1.1353401, -0.64232934, 4.843001]
Target sample: 31, Prediction:1, Target's Score:[-0.19682997, 10.784385, -4.170095, 0.39438888, -3.2004704, -2.9022303, 3.756319, -4.725498, -2.2260768, 2.9203103]
Target sample: 37, Prediction:1, Target's Score:[0.12648502, 10.988584, -4.1594896, 2.3651671, -3.7517314, -3.1790557, 6.531899, -5.6564717, -2.638937, -0.18407421]
Target sample: 43, Prediction:1, Target's Score:[0.46552816, 9.182828, -3.04108, 0.68053436, -4.5750074, -3.1666405, 7.555831, -4.193017, 0.014051553, -2.537832]
Target sample: 49, Prediction:1, Target's Score:[-1.013423, 10.427933, -4.4642043, 4.7438226, -4.938354, -2.9226613, 7.4032164, -6.8597817, 0.16577975, -2.0762587]
Target sample: 55, Prediction:6, Target's Score:[-0.5250834, 2.7702985, -1.1370994, 5.517455, -2.1434872, -2.6872544, 7.955168, -5.7684646, -3.0079257, -0.60992855]
Target sample: 61, Prediction:6, Target's Score:[0.5526805, 1.6576697, -2.7806385, 4.228198, -2.44298, -3.1032825, 5.2050476, -5.170246, -2.7234333, 4.9373736]
Target sample: 67, Prediction:6, Target's Score:[-0.85324156, 7.009193, -3.7467089, 2.2375894, -4.410434, -2.069944, 9.944412, -5.7562013, -3.6983187, 1.719043]
Target sample: 73, Prediction:6, Target's Score:[-1.126016, 5.589758, -6.1388607, 2.9948988, -3.5284176, -3.7161784, 7.414252, -5.320291, -0.389119, 4.623705]
Target sample: 79, Prediction:6, Target's Score:[1.6494353, 6.2429233, -5.270528, 2.659894, -5.0601363, -3.355393, 7.303228, -5.17143, 1.0016971, 0.38246578]
Target sample: 85, Prediction:6, Target's Score:[-0.8063072, 5.808979, -0.22702739, 5.8645115, -4.504303, -2.054944, 7.306694, -5.297096, -4.4851513, -1.2008005]
Target sample: 91, Prediction:1, Target's Score:[-0.7983656, 11.919046, -4.5904455, 2.7693315, -4.27362, -2.5421867, 5.736076, -5.766859, -5.312446, 3.3547559]
Target sample: 97, Prediction:3, Target's Score:[-1.082015, 3.3849733, -0.30242008, 6.460256, -0.5724056, -3.548473, 3.5462394, -3.8775833, -2.18066, -1.4264393]
Target sample: 103, Prediction:3, Target's Score:[-1.5033451, 1.6017833, 0.8218168, 8.090847, 0.36605483, -3.028431, 6.29719, -6.6012444, -4.841282, -0.7922361]
Current ATTACK acc on target samples: 33.333
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 04:55:07 Epoch 59, Val iteration 0, acc 89.200 (89.200)
2021-06-11 04:55:13 Epoch 59, Val iteration 19, acc 90.800 (89.370)
* Prec: 89.37000160217285
Per class accuracy =  [0.91897207 0.92299986 0.84764436 0.82365736 0.88879003 0.82134074
 0.93911507 0.88978187 0.92863204 0.95195599]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 3, 3, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 6, 6, 1, 1, 1, 1, 6, 1, 1, 1, 1, 6, 6, 6, 1, 1, 6, 1, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 1, 6, 1, 6, 6, 6, 1, 3, 6, 1, 6, 1, 1, 6, 1, 1, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 1, 1, 1, 3, 3, 1, 6
ATTACK acc: 39.53488372093023
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  1829
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 04:55:20, Val iteration 0, acc 96.200 (96.200)
2021-06-11 04:55:32, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 04:55:39, Epoch 0, Iteration 7, loss 0.424 (0.589), acc 86.538 (83.200)
2021-06-11 04:56:50, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[0.21059524, -0.82603234, 0.28935793, -0.22037452, 0.33133507, -2.2606144, 6.815578, -1.5561004, -1.8204442, -0.89451754]
Target sample: 7, Prediction:6, Target's Score:[-2.1809912, -2.6724613, 2.8940613, -1.1361487, 1.9504706, -2.9565706, 8.184298, -1.378324, -0.6084179, -2.024816]
Target sample: 13, Prediction:6, Target's Score:[-2.5631487, 0.41203952, -0.5725781, 0.6864853, -1.7376893, -2.4335008, 10.008744, -1.8062294, -0.57349813, -1.3552904]
Target sample: 19, Prediction:6, Target's Score:[-2.270884, 1.0476811, -2.7855773, 1.6929604, -1.4783888, -3.2548869, 13.45335, -2.9585006, -0.81211746, -2.55767]
Target sample: 25, Prediction:3, Target's Score:[-3.0326405, -0.601045, -2.2238324, 4.5677176, 0.018760715, -1.0631312, 3.9986377, -0.014552621, -2.7583678, 1.1838686]
Target sample: 31, Prediction:1, Target's Score:[-0.40574932, 8.545825, -2.1000059, -1.9562372, -0.692364, -3.4098926, 5.3175645, -3.0464835, -1.215514, -0.96956253]
Target sample: 37, Prediction:6, Target's Score:[0.27091286, 2.5776708, -1.0372169, 3.13301, -1.1676188, -3.0038161, 9.007838, -4.0416875, -2.8331647, -2.8342865]
Target sample: 43, Prediction:6, Target's Score:[-3.0344946, 0.8990175, -0.11243725, 0.08891006, -1.1534442, -2.0625968, 8.999457, -0.60462046, -1.2567933, -1.6979051]
Target sample: 49, Prediction:6, Target's Score:[-0.8096622, -2.2749891, 1.0567948, -1.8920468, -0.643145, -2.9297225, 8.430894, -1.1936404, 2.6019106, -2.2679882]
Target sample: 55, Prediction:6, Target's Score:[-1.1595598, -2.0263875, -0.025857419, -1.1544971, 0.9928202, -2.9729328, 8.207809, -0.9048888, 0.6713574, -1.5590395]
Target sample: 61, Prediction:6, Target's Score:[-2.0082798, 1.2276874, -2.1254714, 0.97685164, -0.716431, -2.6118884, 8.048216, -1.5805125, -0.555168, -0.59210545]
Target sample: 67, Prediction:6, Target's Score:[-2.8937848, 1.0432826, -1.1996461, -0.97839314, -1.2790183, -3.0546083, 14.4155035, -2.2849765, -1.3099605, -2.393689]
Target sample: 73, Prediction:6, Target's Score:[1.885314, 2.011191, -2.1745765, -2.1407213, -2.0598378, -3.8565705, 9.224008, -1.7390864, -0.012566717, -1.0633222]
Target sample: 79, Prediction:6, Target's Score:[1.4392995, 3.2692182, -2.8270218, -1.210529, -2.4249048, -3.8256106, 8.244519, -2.226251, -0.02417964, -0.33865133]
Target sample: 85, Prediction:6, Target's Score:[-1.8118292, 0.33227277, -0.8529497, 1.0930109, -0.426383, -2.9202297, 11.027808, -2.4184833, -1.6264014, -2.342538]
Target sample: 91, Prediction:6, Target's Score:[-2.1717963, 0.2623243, -1.2444113, 0.7842038, -1.0692965, -1.6381769, 10.1439, -2.756912, -1.0455791, -1.1905594]
Target sample: 97, Prediction:6, Target's Score:[-0.036498703, -2.4382892, 1.4762748, -1.0829769, 1.629026, -2.916147, 7.88861, -2.206398, 0.19966185, -2.4461288]
Target sample: 103, Prediction:6, Target's Score:[-1.989998, -2.2467644, 3.613274, -0.79324734, 0.6398558, -2.5436249, 7.8132925, -2.0660326, 0.15867954, -2.5164459]
Current ATTACK acc on target samples: 88.889
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 04:57:59 Epoch 59, Val iteration 0, acc 93.400 (93.400)
2021-06-11 04:58:12 Epoch 59, Val iteration 19, acc 93.000 (92.430)
* Prec: 92.43000221252441
Per class accuracy =  [0.96311517 0.94571165 0.87342789 0.89029127 0.95280488 0.84515924
 0.94633778 0.92070576 0.93523678 0.96639803]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 1, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 93.02325581395348
--------
------SUMMARY------
TIME ELAPSED (mins): 22
TARGET INDEX: 9
ResNet50 94.44444444444444 90.69767441860465 95.46000137329102 90.93000183105468
DPN92 61.111111111111114 68.6046511627907 95.50000267028808 93.08000144958496
MobileNetV2 33.333333333333336 39.53488372093023 91.22000160217286 89.37000160217285
GoogLeNet 88.88888888888889 93.02325581395348 95.41000213623047 92.43000221252441
True False False False False
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 142 images of target 10
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133, 139]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=False, nearest=True, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=10, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/10/target-num-20
torch.Size([200, 1, 3, 32, 32]) torch.Size([24, 3, 32, 32])
Selected nearest neighbors: [1088, 1212, 770, 1698, 600]
Selected base image indices: [1088, 1212, 770, 1698, 600]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133, 139]
# Targets: 24, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 04:58:48 Iteration 0 	 Training Loss: 8.480e-01 	 Loss in Target Net: 1.052e+00	  
tensor(-7.8732e-05, device='cuda:0')
 2021-06-11 04:59:51 Iteration 50 	 Training Loss: 2.066e-01 	 Loss in Target Net: 5.310e-01	  
tensor(0.0037, device='cuda:0')
 2021-06-11 05:00:57 Iteration 100 	 Training Loss: 1.638e-01 	 Loss in Target Net: 4.968e-01	  
tensor(0.0014, device='cuda:0')
 2021-06-11 05:02:03 Iteration 150 	 Training Loss: 1.461e-01 	 Loss in Target Net: 4.598e-01	  
tensor(-0.0056, device='cuda:0')
 2021-06-11 05:03:09 Iteration 200 	 Training Loss: 1.364e-01 	 Loss in Target Net: 4.535e-01	  
tensor(-0.0107, device='cuda:0')
 2021-06-11 05:04:14 Iteration 250 	 Training Loss: 1.409e-01 	 Loss in Target Net: 5.367e-01	  
tensor(-0.0140, device='cuda:0')
 2021-06-11 05:05:17 Iteration 300 	 Training Loss: 1.369e-01 	 Loss in Target Net: 4.686e-01	  
tensor(-0.0153, device='cuda:0')
 2021-06-11 05:06:20 Iteration 350 	 Training Loss: 1.247e-01 	 Loss in Target Net: 5.602e-01	  
tensor(-0.0175, device='cuda:0')
 2021-06-11 05:07:23 Iteration 400 	 Training Loss: 1.285e-01 	 Loss in Target Net: 4.756e-01	  
tensor(-0.0200, device='cuda:0')
 2021-06-11 05:08:27 Iteration 450 	 Training Loss: 1.335e-01 	 Loss in Target Net: 5.489e-01	  
tensor(-0.0200, device='cuda:0')
 2021-06-11 05:09:29 Iteration 500 	 Training Loss: 1.275e-01 	 Loss in Target Net: 5.123e-01	  
tensor(-0.0204, device='cuda:0')
 2021-06-11 05:10:35 Iteration 550 	 Training Loss: 1.225e-01 	 Loss in Target Net: 5.227e-01	  
tensor(-0.0204, device='cuda:0')
 2021-06-11 05:11:40 Iteration 600 	 Training Loss: 1.306e-01 	 Loss in Target Net: 5.318e-01	  
tensor(-0.0210, device='cuda:0')
 2021-06-11 05:12:43 Iteration 650 	 Training Loss: 1.270e-01 	 Loss in Target Net: 4.745e-01	  
tensor(-0.0198, device='cuda:0')
 2021-06-11 05:13:45 Iteration 700 	 Training Loss: 1.225e-01 	 Loss in Target Net: 4.289e-01	  
tensor(-0.0207, device='cuda:0')
 2021-06-11 05:14:48 Iteration 750 	 Training Loss: 1.251e-01 	 Loss in Target Net: 4.197e-01	  
tensor(-0.0209, device='cuda:0')
 2021-06-11 05:15:51 Iteration 800 	 Training Loss: 1.212e-01 	 Loss in Target Net: 4.613e-01	  
tensor(-0.0211, device='cuda:0')
 2021-06-11 05:16:54 Iteration 850 	 Training Loss: 1.198e-01 	 Loss in Target Net: 5.384e-01	  
tensor(-0.0220, device='cuda:0')
 2021-06-11 05:17:57 Iteration 900 	 Training Loss: 1.221e-01 	 Loss in Target Net: 4.742e-01	  
tensor(-0.0221, device='cuda:0')
 2021-06-11 05:19:00 Iteration 950 	 Training Loss: 1.217e-01 	 Loss in Target Net: 4.932e-01	  
tensor(-0.0214, device='cuda:0')
 2021-06-11 05:20:01 Iteration 999 	 Training Loss: 1.171e-01 	 Loss in Target Net: 5.597e-01	  
tensor(-0.0213, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  770
poison index =  1698
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 05:20:06, Val iteration 0, acc 94.200 (94.200)
2021-06-11 05:20:16, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 05:20:21, Epoch 0, Iteration 7, loss 0.151 (0.213), acc 98.077 (93.800)
2021-06-11 05:21:21, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.525984, 2.5152848, -1.361482, 1.0222135, -1.5949686, -0.45064324, 5.823775, -1.8578291, -3.0056367, 0.5449038]
Target sample: 7, Prediction:6, Target's Score:[-1.8058176, 1.5106889, -1.3365762, 0.69121915, -1.1557802, -0.20405978, 7.524904, -2.0303638, -2.0005307, -1.0999043]
Target sample: 13, Prediction:6, Target's Score:[-1.0688043, 0.05308479, -1.1504349, 1.4628924, -1.3743348, -2.4055014, 6.5302052, -2.12647, -2.5891008, 2.782772]
Target sample: 19, Prediction:6, Target's Score:[-0.9615803, 0.015712375, -0.28703144, 1.2445484, -1.3036275, -1.9217885, 9.278593, -1.5918252, -3.672438, -0.70969194]
Target sample: 25, Prediction:6, Target's Score:[-0.5571952, 0.75855964, -1.3224823, 2.327444, -2.013445, -1.3974332, 5.476422, -1.3468558, -3.633842, 1.805779]
Target sample: 31, Prediction:9, Target's Score:[-1.6501545, 0.5213559, -0.7084258, 1.0378257, 0.24031731, -1.7031286, 2.051542, -2.3344624, -3.5273027, 6.198952]
Target sample: 37, Prediction:9, Target's Score:[0.36646685, 1.881802, -2.3118832, 2.262663, -2.0959651, -0.6494203, -0.45795596, -2.1057193, -2.603612, 5.829544]
Target sample: 43, Prediction:6, Target's Score:[-1.5863348, 3.9233932, -0.78467476, 0.027477909, -2.5652924, -2.435553, 4.644742, -1.187895, -2.9460285, 3.0274477]
Target sample: 49, Prediction:6, Target's Score:[-1.8912169, 3.5668344, -1.2237123, 0.22638616, -2.2719421, 0.22613999, 5.3077416, -1.6151869, -2.2868693, 0.061780564]
Target sample: 55, Prediction:6, Target's Score:[-2.0873606, 5.1812625, 0.06818441, 0.6943145, -2.4873521, -1.2302563, 5.4260564, -1.2138667, -3.2685828, -0.9754453]
Target sample: 61, Prediction:6, Target's Score:[-1.4544435, 1.9987783, -0.7086782, 1.3605009, -1.8785632, -2.0564597, 4.877048, -1.6020807, -3.6359174, 3.213261]
Target sample: 67, Prediction:9, Target's Score:[-2.0825891, 2.2834077, -0.5787281, 2.5002208, -0.55040485, -0.92360705, 2.0016236, -2.1079433, -3.2023652, 2.7626264]
Target sample: 73, Prediction:1, Target's Score:[-2.5378535, 6.534889, -1.4580277, 0.9870776, -0.38207984, 0.13805315, 1.7541205, -2.7875304, -2.082552, -0.06614274]
Target sample: 79, Prediction:6, Target's Score:[-1.2307358, 1.0675982, -0.020628244, 1.4011189, 0.7620587, -0.7413272, 5.390352, -2.7815907, -2.9901123, -0.7799404]
Target sample: 85, Prediction:6, Target's Score:[-1.5254761, -0.20987192, 0.13700882, 3.58913, -0.6261581, -1.5663478, 5.348173, -2.2885604, -3.2273023, 0.4588462]
Target sample: 91, Prediction:6, Target's Score:[-1.4502108, 1.8064638, -0.21087444, 0.75070566, -0.83932346, -1.3787727, 7.577839, -2.671224, -3.4651597, -0.029018525]
Target sample: 97, Prediction:6, Target's Score:[-0.8102498, 1.4520434, -1.8243457, 2.1795325, -2.4149652, 0.00030220766, 3.35334, -1.6309657, -3.4987767, 3.305597]
Target sample: 103, Prediction:6, Target's Score:[-0.336446, 1.7261857, -1.4536536, 2.155747, -2.197289, -1.26491, 4.085856, -1.9412457, -3.1617558, 2.4974942]
Target sample: 109, Prediction:6, Target's Score:[-1.1366392, 2.6016173, -0.5618522, 2.409377, -1.031911, -1.9215165, 4.433449, -2.0703883, -3.159803, 0.5307719]
Target sample: 115, Prediction:9, Target's Score:[-0.8951595, 1.9076382, -1.4202511, 0.6722712, -1.8025047, 1.2412286, 2.3840578, -2.4765534, -2.6538825, 3.165812]
Target sample: 121, Prediction:6, Target's Score:[-1.6889689, 5.6641994, -1.1510946, 0.31611314, -2.4790983, -1.3300476, 7.033262, -2.418745, -2.923905, -0.92314446]
Target sample: 127, Prediction:6, Target's Score:[-1.801692, 4.681225, -1.3883362, 0.9134228, -2.0294335, -1.4141655, 7.2464585, -2.9253926, -3.4598322, 0.29190725]
Target sample: 133, Prediction:6, Target's Score:[-1.5030335, 1.6129097, -1.5569074, 0.41755474, -2.0396197, 0.23106137, 4.9257674, -1.1189475, -3.0736806, 2.2196937]
Target sample: 139, Prediction:6, Target's Score:[-1.1197804, 0.8357139, -1.4699913, 0.6793908, -1.8233235, -0.6104879, 8.491037, -1.2936975, -2.7164748, -0.87482345]
Current ATTACK acc on target samples: 79.167
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 05:22:20 Epoch 59, Val iteration 0, acc 90.400 (90.400)
2021-06-11 05:22:30 Epoch 59, Val iteration 19, acc 92.600 (90.850)
* Prec: 90.85000190734863
Per class accuracy =  [0.93673953 0.91576    0.86665011 0.81994439 0.93185396 0.86604711
 0.94386414 0.93774249 0.94048742 0.92931028]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 9, 6, 6, 6, 6, 6, 6, 6, 9, 9, 9, 9, 9, 9, 9, 6, 6, 6, 9, 1, 1, 9, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 3, 6, 9, 6, 1, 1, 1, 1, 1, 1, 1, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 9, 9, 9, 9, 3, 9, 9, 6, 1, 6, 6, 9, 6, 5, 9, 1, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 68.64406779661017
--------
DPN92
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  770
poison index =  1698
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 05:22:42, Val iteration 0, acc 94.800 (94.800)
2021-06-11 05:23:02, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 05:23:17, Epoch 0, Iteration 7, loss 0.461 (0.404), acc 88.462 (90.200)
2021-06-11 05:25:55, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-0.49482805, 1.4509541, -2.5713694, -1.5680043, -1.4088204, -2.3528378, 9.280851, -2.8023536, 0.7662361, -0.08345653]
Target sample: 7, Prediction:6, Target's Score:[-0.13359794, 1.049672, -2.8751063, -1.0399027, -1.866168, -3.9910207, 9.067701, -2.3669636, 2.1841207, 0.19642591]
Target sample: 13, Prediction:6, Target's Score:[-0.436308, -0.81838393, -2.728383, -1.2740452, 0.17926835, -3.738035, 10.440273, -2.320604, 2.5035672, -1.5907296]
Target sample: 19, Prediction:6, Target's Score:[-1.6406783, -0.4001218, -1.917833, -1.0361748, 1.6711339, -2.8835254, 10.420171, -2.586665, 0.7965322, -2.232051]
Target sample: 25, Prediction:6, Target's Score:[-1.1393265, 4.897491, -2.7680888, -0.013817761, -1.1956333, -3.587473, 8.034239, -2.7329705, 0.75217074, -2.018342]
Target sample: 31, Prediction:6, Target's Score:[-1.2130654, 5.6070323, -2.562684, -0.16163953, -0.89987004, -3.2205687, 7.037176, -2.9525871, 0.5839335, -1.9876131]
Target sample: 37, Prediction:6, Target's Score:[0.3588373, 4.1440034, -3.8457706, -0.8886805, -2.4535465, -3.6278203, 5.6624203, -3.0510597, 0.91127706, 3.0488293]
Target sample: 43, Prediction:6, Target's Score:[-0.86029935, 0.5095723, -2.2769845, -0.024788316, -1.673103, -4.0313263, 8.641707, -2.4023068, 1.170573, 1.1755371]
Target sample: 49, Prediction:6, Target's Score:[-0.06826027, 2.1618109, -2.6809423, -0.9169349, -1.8375823, -3.437207, 8.19599, -2.4808722, 1.2134056, 0.06986174]
Target sample: 55, Prediction:6, Target's Score:[-1.4726726, 2.5313568, -2.153904, 1.1950527, -1.3446108, -3.1630156, 8.508538, -2.5848546, 0.6431817, -1.9594414]
Target sample: 61, Prediction:6, Target's Score:[-0.008066893, 0.7393894, -2.6094732, 1.7457172, -1.2872114, -2.2993996, 8.197018, -1.5374417, -0.1876847, -2.583349]
Target sample: 67, Prediction:6, Target's Score:[0.7416432, 0.6183599, -2.1441386, 0.5034748, -0.60235864, -1.5911453, 3.7580812, -1.9465761, -0.5583393, 1.4000975]
Target sample: 73, Prediction:6, Target's Score:[-0.20146519, 3.5285563, -2.7806816, -0.60968, -2.3901157, -3.2809827, 5.0747514, -2.4738352, 3.200852, 0.14612095]
Target sample: 79, Prediction:6, Target's Score:[-1.0281613, 3.711527, -2.7665324, -1.007544, -0.85912573, -3.465914, 8.700562, -2.9770722, 2.3240938, -2.4131854]
Target sample: 85, Prediction:6, Target's Score:[-2.2425084, -1.1357623, -2.304959, 1.2346601, 3.3393772, -1.1097155, 8.002373, -2.5643737, -0.69023186, -2.339023]
Target sample: 91, Prediction:6, Target's Score:[-1.3489227, 4.3760934, -2.8239756, -0.43744013, -0.3944625, -3.4387107, 9.2690935, -2.8834546, 0.5010081, -2.5895743]
Target sample: 97, Prediction:6, Target's Score:[-0.98700655, 5.304559, -3.0119598, 0.13225184, -1.2458116, -3.246613, 6.775926, -3.2375023, 0.98180205, -1.233087]
Target sample: 103, Prediction:6, Target's Score:[-0.7489739, 1.3818884, -2.5423365, -0.03656571, -1.1519755, -3.8817549, 9.221453, -2.570736, 1.9173669, -1.3774322]
Target sample: 109, Prediction:6, Target's Score:[-0.9027267, 2.843047, -2.8802793, -1.0038944, -1.4412789, -4.270549, 9.523494, -3.2847538, 1.8699807, -0.20672463]
Target sample: 115, Prediction:6, Target's Score:[-0.82237834, 1.1559703, -2.4638972, -0.75624853, -0.8398905, -3.5159938, 8.927445, -2.7799685, 1.1429211, 0.16401334]
Target sample: 121, Prediction:6, Target's Score:[-1.8331326, 0.6973453, -2.0023787, 2.102624, -0.3953146, -3.3818758, 10.1126995, -2.8134623, 0.4338898, -2.7215488]
Target sample: 127, Prediction:6, Target's Score:[-1.5505626, -0.30299985, -2.2739112, 0.24210005, -0.30021665, -2.8709903, 11.790999, -3.0606892, 0.30342463, -1.7741086]
Target sample: 133, Prediction:6, Target's Score:[-0.9565442, 2.9481027, -2.6308072, -1.0722853, -1.6550188, -3.3545363, 6.105521, -2.2079525, 3.523837, -0.4793607]
Target sample: 139, Prediction:6, Target's Score:[-0.16006485, 1.5038444, -2.7319598, -1.4022871, -1.5613333, -3.4512687, 9.248909, -2.5954494, 1.507813, -0.12660708]
Current ATTACK acc on target samples: 100.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 05:28:30 Epoch 59, Val iteration 0, acc 93.400 (93.400)
2021-06-11 05:28:50 Epoch 59, Val iteration 19, acc 92.600 (93.100)
* Prec: 93.10000114440918
Per class accuracy =  [0.96686303 0.97103642 0.88693164 0.86572963 0.94210792 0.88148433
 0.93081044 0.95709318 0.96105784 0.94678156]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 6, 1, 6, 6, 9, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 93.22033898305085
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  770
poison index =  1698
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 05:28:54, Val iteration 0, acc 92.600 (92.600)
2021-06-11 05:29:00, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 05:29:02, Epoch 0, Iteration 7, loss 0.272 (0.368), acc 92.308 (89.400)
2021-06-11 05:29:30, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.2713255, 1.5825466, -3.5635626, 2.019673, -3.9754705, -1.8755534, 4.9931993, -2.6565838, 0.3220802, 4.543048]
Target sample: 7, Prediction:6, Target's Score:[-2.5107708, -1.4910837, -3.248271, 4.6952333, -3.6867626, -1.1451371, 7.845455, -3.3414047, -0.68815285, 3.675121]
Target sample: 13, Prediction:3, Target's Score:[-2.4686644, -3.0118291, -2.116995, 5.5387673, -1.3796387, -2.0392509, 5.162422, -1.5510027, 0.49935263, 1.4979751]
Target sample: 19, Prediction:6, Target's Score:[-3.1948323, -2.0644631, -1.2688582, 5.0362296, 1.5576752, -1.7744471, 7.6265483, 0.15379402, -5.3861756, -0.53645307]
Target sample: 25, Prediction:6, Target's Score:[-1.3788276, 1.4754846, -1.3635553, 3.4390678, -0.20470837, -3.2291281, 8.57004, -0.93743813, -6.1378474, -0.08805642]
Target sample: 31, Prediction:6, Target's Score:[-0.94783586, -1.7853224, 0.46997926, 2.9365058, 1.5025618, -3.2697783, 5.9506187, -0.5529814, -4.7438197, 0.5747694]
Target sample: 37, Prediction:9, Target's Score:[0.5930088, 0.0802861, -3.6604896, 4.035667, -1.8207017, -3.2501066, 1.9384289, -2.0601873, -3.1133919, 7.376215]
Target sample: 43, Prediction:6, Target's Score:[-1.5380937, -2.5852985, -1.5619535, 5.0593853, -1.6946137, -3.3570185, 6.0982037, -3.7478046, -1.1973641, 4.6315904]
Target sample: 49, Prediction:9, Target's Score:[-1.8881142, 2.0115438, -0.93831056, 2.7889764, -4.0937757, -2.2091599, 4.3648643, -4.7112684, 0.43096638, 4.371122]
Target sample: 55, Prediction:6, Target's Score:[-1.7856181, 3.0007474, 0.28737876, 2.4886336, -4.096179, -2.2905614, 3.6043367, -0.20325407, -4.1422477, 3.298214]
Target sample: 61, Prediction:6, Target's Score:[-2.548642, 0.26691115, -2.213559, 6.374815, -2.1417713, -0.7797209, 7.622564, -5.6652036, -3.8833241, 3.0842664]
Target sample: 67, Prediction:3, Target's Score:[-0.09103055, 1.6561949, -1.7720077, 3.4625347, -2.4831784, -1.0378271, 2.252282, -0.27537706, -4.657349, 3.075195]
Target sample: 73, Prediction:1, Target's Score:[-3.8428671, 4.819876, -0.96538323, 4.07203, -2.0133274, -4.060613, 1.4868056, -2.6923435, 2.495682, 0.8921317]
Target sample: 79, Prediction:6, Target's Score:[-4.129078, -0.5181122, -1.130512, 5.0137596, -0.4699106, -2.930245, 6.319539, -2.2517753, -1.0610878, 1.3043175]
Target sample: 85, Prediction:6, Target's Score:[-3.7791808, -3.702162, -0.015290432, 6.2831473, 0.3113805, -0.6024005, 11.430378, -3.9299614, -4.8879113, -0.99214417]
Target sample: 91, Prediction:6, Target's Score:[-1.7107122, 0.3490344, -2.641931, 7.0417957, -0.38181123, -0.81960636, 7.0994363, -1.1435078, -6.5437493, -1.1054392]
Target sample: 97, Prediction:6, Target's Score:[-1.1343683, 3.8557825, -3.6281586, 3.8835847, -2.0985727, -1.4508396, 5.3381534, -2.9720175, -5.7828956, 4.119237]
Target sample: 103, Prediction:6, Target's Score:[-1.7014239, -0.0116145685, -3.44401, 2.9037664, 0.5249579, -3.9736633, 7.106915, -1.8875254, -1.7630659, 2.3826623]
Target sample: 109, Prediction:6, Target's Score:[-1.3517123, -2.9429488, -0.14064142, 2.0685291, -0.8769743, -4.626762, 7.2966433, -2.7401097, 2.462925, 0.9884669]
Target sample: 115, Prediction:6, Target's Score:[-3.0577884, 0.9872818, -1.9519165, 2.01085, -3.3740149, -0.46687382, 4.7021127, -3.4415433, 0.2843348, 4.445121]
Target sample: 121, Prediction:3, Target's Score:[-3.9542975, -1.208601, -2.149998, 6.701807, -2.7858124, -2.2717545, 6.646778, -2.0967689, -0.34408683, 1.6128725]
Target sample: 127, Prediction:6, Target's Score:[-3.138082, 0.9414809, -2.3202434, 5.226304, -0.2221599, -2.6016233, 9.649462, -3.9968321, -4.205244, 0.79403174]
Target sample: 133, Prediction:6, Target's Score:[-1.5905252, -0.49525073, -1.7284223, 6.5993423, -3.6697392, -1.6410121, 7.2513804, -3.233928, -4.1625705, 2.7823908]
Target sample: 139, Prediction:6, Target's Score:[-2.944199, -1.5917484, -3.126024, 5.0364103, -2.324432, -1.4774085, 7.179118, -3.4001572, 0.85565406, 1.9148452]
Current ATTACK acc on target samples: 75.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 05:29:57 Epoch 59, Val iteration 0, acc 89.600 (89.600)
2021-06-11 05:30:03 Epoch 59, Val iteration 19, acc 90.200 (89.340)
* Prec: 89.34000167846679
Per class accuracy =  [0.92601351 0.9276909  0.83651957 0.82811464 0.89272351 0.81910288
 0.92836339 0.8892623  0.93425664 0.94812906]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 3, 6, 6, 6, 6, 6, 6, 6, 3, 6, 3, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 1, 6, 3, 6, 3, 9, 9, 9, 9, 9, 6, 6, 9, 9, 9, 3, 1, 9, 6, 6, 6, 6, 3, 3, 3, 3, 6, 3, 3, 3, 3, 3, 3, 9, 1, 9, 1, 6, 6, 3, 3, 6, 3, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 3, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 9, 3, 6, 6, 6, 6, 3, 6, 3, 6, 6
ATTACK acc: 65.2542372881356
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  770
poison index =  1698
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 05:30:11, Val iteration 0, acc 96.200 (96.200)
2021-06-11 05:30:23, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 05:30:29, Epoch 0, Iteration 7, loss 0.505 (0.540), acc 86.538 (84.800)
2021-06-11 05:31:40, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.2481909, -0.9771551, -1.159628, -0.11262784, 0.14989948, 2.5429544, 2.7587519, -1.4293072, 0.6483842, -0.13564983]
Target sample: 7, Prediction:6, Target's Score:[-2.9947648, 0.9179083, -1.267997, 0.99842733, -0.666704, -2.9573078, 4.739532, -2.8706133, 3.880039, 0.25428075]
Target sample: 13, Prediction:6, Target's Score:[-2.1002607, 0.41683924, -0.95863533, 0.04306809, 1.6918073, -2.6839545, 6.0262055, -2.849071, 0.9160211, -0.47143212]
Target sample: 19, Prediction:6, Target's Score:[-1.9422975, -1.0347865, -1.6525819, 1.656694, 0.29685187, -3.045634, 9.222498, -2.5422726, 1.4479401, -2.3856833]
Target sample: 25, Prediction:6, Target's Score:[-2.2403705, 3.1760223, -1.709419, -0.8086914, -0.113638066, -2.567895, 7.1514564, -1.6620606, 0.38916832, -1.5951563]
Target sample: 31, Prediction:6, Target's Score:[-2.4200404, 1.9451325, -0.6620415, -0.56546426, 2.5081003, -3.2418175, 6.2899632, -1.8741019, -0.72337574, -1.2279416]
Target sample: 37, Prediction:1, Target's Score:[-0.98405385, 3.843367, -1.7226955, 0.21288526, -0.7885019, -2.4518898, 3.7576942, -2.3299258, -0.46638405, 0.957132]
Target sample: 43, Prediction:6, Target's Score:[-2.4580398, 1.2641376, -0.28387207, 1.8973186, -1.0306683, -2.1570568, 4.929681, -2.3376071, 0.11759105, 0.08262604]
Target sample: 49, Prediction:6, Target's Score:[-3.2669044, 2.5371816, 0.45595944, 2.319421, -0.3065026, -2.64408, 2.9299455, -2.8122227, 0.2835645, 0.53640217]
Target sample: 55, Prediction:6, Target's Score:[-2.4277906, 4.573218, -0.3774147, -0.0741634, -0.62059003, -2.8768353, 5.2177496, -1.7696913, -1.1063939, -0.5154498]
Target sample: 61, Prediction:6, Target's Score:[-2.20186, 0.91316915, -2.6034076, 3.777861, -1.5030521, -1.3629743, 7.1429286, -2.9679399, 0.23907933, -1.411104]
Target sample: 67, Prediction:6, Target's Score:[-2.5217557, -1.3009965, -0.639498, 2.9920378, 0.47130054, -1.8032998, 4.8212767, -1.3449439, 0.8453496, -1.4966263]
Target sample: 73, Prediction:8, Target's Score:[-4.6391335, 3.3905678, -0.06786171, -0.002331609, -1.3053324, -2.3603804, 4.022155, -1.9790559, 4.9015203, -1.9289905]
Target sample: 79, Prediction:6, Target's Score:[-4.220047, 4.4328303, -1.7781754, -1.101023, -1.72517, -2.0911689, 6.9219007, -1.8300672, 3.3519673, -1.9340179]
Target sample: 85, Prediction:6, Target's Score:[-3.469294, -1.3724729, -1.7408242, 3.7592745, 2.8313403, -1.9220986, 5.9387302, -3.2498446, 1.9083072, -2.6466687]
Target sample: 91, Prediction:6, Target's Score:[-2.4227486, 2.6642501, -2.5880287, -0.8177386, 0.3775644, -2.2305334, 7.3169746, -1.9545093, 0.8527278, -1.1746542]
Target sample: 97, Prediction:6, Target's Score:[-1.1797521, 4.2605495, -1.759904, -0.05841746, -0.21349743, -2.9901812, 4.300655, -3.1450148, -0.5487207, 1.3762021]
Target sample: 103, Prediction:6, Target's Score:[-1.4635413, 2.0660784, -2.1759865, 1.0239383, -0.8772802, -2.391954, 6.242166, -2.9902809, 1.6965944, -1.1063274]
Target sample: 109, Prediction:6, Target's Score:[-1.4696867, 0.15173136, -1.1743755, 0.41727787, 1.1033592, -2.181359, 4.721514, -2.7766812, 2.2498727, -1.0164449]
Target sample: 115, Prediction:6, Target's Score:[-1.4207022, 1.143976, 1.2052951, -0.45156187, -1.038692, -2.201678, 4.1514196, -2.3553975, 0.1177949, 0.8772113]
Target sample: 121, Prediction:6, Target's Score:[-2.5747905, 2.0165327, -1.6803552, 1.303502, -0.28624123, -2.4100735, 5.391404, -2.8059978, 1.5116299, -0.438062]
Target sample: 127, Prediction:6, Target's Score:[-2.7859693, 2.5385864, -1.5503498, 1.631679, -0.90522295, -2.4876, 6.2634196, -2.2851431, -0.57607424, 0.1835411]
Target sample: 133, Prediction:6, Target's Score:[-2.751248, 0.48968908, -1.3421504, 0.35983092, -1.4819622, -0.31993988, 4.2585263, -0.62765336, 2.4386692, -0.99387646]
Target sample: 139, Prediction:6, Target's Score:[-3.4425402, -0.41034716, -0.9881058, 2.0104563, -0.62986475, -2.9664667, 6.652922, -2.3575866, 3.6566422, -1.4910065]
Current ATTACK acc on target samples: 91.667
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 05:32:50 Epoch 59, Val iteration 0, acc 93.600 (93.600)
2021-06-11 05:33:02 Epoch 59, Val iteration 19, acc 94.000 (93.250)
* Prec: 93.25000114440918
Per class accuracy =  [0.95888496 0.95864458 0.8958322  0.84625384 0.9687527  0.8927216
 0.96134787 0.93468012 0.95600416 0.94915991]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 8, 8, 6, 6, 8, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 1, 6, 1, 6, 6, 9, 6, 6, 6, 6, 6, 6, 6, 8, 1, 6, 1, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 3, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 8, 8, 8, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 3, 6, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6
ATTACK acc: 80.50847457627118
--------
------SUMMARY------
TIME ELAPSED (mins): 21
TARGET INDEX: 10
ResNet50 79.16666666666667 68.64406779661017 95.46000137329102 90.85000190734863
DPN92 100.0 93.22033898305085 95.50000267028808 93.10000114440918
MobileNetV2 75.0 65.2542372881356 91.22000160217286 89.34000167846679
GoogLeNet 91.66666666666667 80.50847457627118 95.41000213623047 93.25000114440918
True False False False True
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 142 images of target 10
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133, 139]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=True, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=10, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/10/target-num-20
torch.Size([200, 1, 3, 32, 32]) torch.Size([24, 3, 32, 32])
Selected nearest neighbors: [1088, 1212, 770, 1698, 600]
Selected base image indices: [1088, 1212, 770, 1698, 600]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133, 139]
# Targets: 24, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 05:33:41 Iteration 0 	 Training Loss: 7.750e-01 	 Loss in Target Net: 6.421e-01	  
tensor(-0.0004, device='cuda:0')
 2021-06-11 05:34:52 Iteration 50 	 Training Loss: 3.370e-01 	 Loss in Target Net: 3.946e-01	  
tensor(-0.0158, device='cuda:0')
 2021-06-11 05:36:05 Iteration 100 	 Training Loss: 3.034e-01 	 Loss in Target Net: 3.739e-01	  
tensor(-0.0270, device='cuda:0')
 2021-06-11 05:37:17 Iteration 150 	 Training Loss: 2.987e-01 	 Loss in Target Net: 3.519e-01	  
tensor(-0.0275, device='cuda:0')
 2021-06-11 05:38:28 Iteration 200 	 Training Loss: 2.914e-01 	 Loss in Target Net: 3.732e-01	  
tensor(-0.0268, device='cuda:0')
 2021-06-11 05:39:40 Iteration 250 	 Training Loss: 2.927e-01 	 Loss in Target Net: 3.668e-01	  
tensor(-0.0261, device='cuda:0')
 2021-06-11 05:40:50 Iteration 300 	 Training Loss: 2.927e-01 	 Loss in Target Net: 3.575e-01	  
tensor(-0.0266, device='cuda:0')
 2021-06-11 05:41:59 Iteration 350 	 Training Loss: 2.912e-01 	 Loss in Target Net: 3.553e-01	  
tensor(-0.0253, device='cuda:0')
 2021-06-11 05:43:09 Iteration 400 	 Training Loss: 2.882e-01 	 Loss in Target Net: 3.416e-01	  
tensor(-0.0250, device='cuda:0')
 2021-06-11 05:44:22 Iteration 450 	 Training Loss: 2.863e-01 	 Loss in Target Net: 3.360e-01	  
tensor(-0.0250, device='cuda:0')
 2021-06-11 05:45:37 Iteration 500 	 Training Loss: 2.940e-01 	 Loss in Target Net: 3.377e-01	  
tensor(-0.0251, device='cuda:0')
 2021-06-11 05:46:51 Iteration 550 	 Training Loss: 2.908e-01 	 Loss in Target Net: 3.465e-01	  
tensor(-0.0235, device='cuda:0')
 2021-06-11 05:48:07 Iteration 600 	 Training Loss: 2.856e-01 	 Loss in Target Net: 3.360e-01	  
tensor(-0.0240, device='cuda:0')
 2021-06-11 05:49:22 Iteration 650 	 Training Loss: 2.906e-01 	 Loss in Target Net: 3.709e-01	  
tensor(-0.0232, device='cuda:0')
 2021-06-11 05:50:38 Iteration 700 	 Training Loss: 2.910e-01 	 Loss in Target Net: 3.423e-01	  
tensor(-0.0236, device='cuda:0')
 2021-06-11 05:51:54 Iteration 750 	 Training Loss: 2.877e-01 	 Loss in Target Net: 3.445e-01	  
tensor(-0.0235, device='cuda:0')
 2021-06-11 05:53:07 Iteration 800 	 Training Loss: 2.920e-01 	 Loss in Target Net: 3.423e-01	  
tensor(-0.0229, device='cuda:0')
 2021-06-11 05:54:22 Iteration 850 	 Training Loss: 2.877e-01 	 Loss in Target Net: 3.365e-01	  
tensor(-0.0228, device='cuda:0')
 2021-06-11 05:55:36 Iteration 900 	 Training Loss: 2.900e-01 	 Loss in Target Net: 3.346e-01	  
tensor(-0.0233, device='cuda:0')
 2021-06-11 05:56:49 Iteration 950 	 Training Loss: 2.950e-01 	 Loss in Target Net: 3.420e-01	  
tensor(-0.0225, device='cuda:0')
 2021-06-11 05:58:00 Iteration 999 	 Training Loss: 2.894e-01 	 Loss in Target Net: 3.496e-01	  
tensor(-0.0225, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  770
poison index =  1698
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 05:58:05, Val iteration 0, acc 94.200 (94.200)
2021-06-11 05:58:15, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 05:58:21, Epoch 0, Iteration 7, loss 0.143 (0.360), acc 96.154 (90.600)
2021-06-11 05:59:21, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-0.6903512, 4.0902076, -2.3862612, -1.7859764, -2.8740764, -2.1679292, 9.148161, -0.75577104, -1.9943587, -0.61157364]
Target sample: 7, Prediction:6, Target's Score:[-0.0198307, 2.5081208, -2.7800212, -2.619853, -2.062636, -3.3463724, 11.216355, -0.20768324, -1.61356, -1.1043974]
Target sample: 13, Prediction:6, Target's Score:[-0.5584613, 1.2991327, -2.601207, -2.306535, -2.5360584, -3.0977726, 11.073132, -0.9654992, -1.9639459, 1.6341975]
Target sample: 19, Prediction:6, Target's Score:[-0.091930605, -0.2755913, -1.8500589, -1.2558047, -2.138481, -2.577316, 9.813545, -0.2956273, -2.3797426, 1.0495118]
Target sample: 25, Prediction:6, Target's Score:[-1.5717596, 2.1378856, -1.5771352, -1.4418972, -2.0365953, -2.028622, 6.7488775, -1.6263702, -2.3904448, 3.7568934]
Target sample: 31, Prediction:6, Target's Score:[-1.7695726, 4.853308, -1.6760255, -1.4059703, -1.970458, -2.1753106, 7.419364, -1.6184802, -2.196362, 0.48836455]
Target sample: 37, Prediction:6, Target's Score:[0.03581036, 0.947427, -1.9184089, -0.029563257, -2.4389489, -2.0011544, 5.40105, -1.5690751, -2.619612, 4.204375]
Target sample: 43, Prediction:6, Target's Score:[-0.9857524, 2.0551095, -1.8800336, -1.439781, -2.3393457, -2.6331246, 7.6644816, -1.0900768, -2.108806, 2.731939]
Target sample: 49, Prediction:6, Target's Score:[-0.829827, 3.4882886, -2.0628355, -1.6429566, -2.6578946, -2.485647, 7.7729864, -1.0757565, -1.5362129, 1.0009164]
Target sample: 55, Prediction:6, Target's Score:[-1.1164571, 4.825215, -1.8431947, -1.6080545, -2.800612, -1.8411611, 7.306506, -0.42242622, -2.1304948, -0.40200207]
Target sample: 61, Prediction:6, Target's Score:[-0.64374894, 0.52085567, -2.194779, -0.3469723, -2.3261428, -1.8115349, 7.5630546, -1.1376352, -2.0104725, 2.3819215]
Target sample: 67, Prediction:6, Target's Score:[-0.62496805, 2.3411283, -1.5966039, -0.105419636, -2.664832, -0.47177675, 5.125748, -0.58200705, -2.113881, 0.6995856]
Target sample: 73, Prediction:1, Target's Score:[-1.2153115, 9.638291, -2.0253592, -2.4286149, -2.9552848, -2.417171, 5.615547, -1.0592747, -0.89362335, -2.3263428]
Target sample: 79, Prediction:6, Target's Score:[-0.5240482, 4.676101, -1.5871204, -1.9306477, -2.4569573, -2.4244308, 8.217237, -0.66001105, -1.4392922, -1.9061954]
Target sample: 85, Prediction:6, Target's Score:[-1.5382093, -0.49994254, -1.410303, 0.058095217, -2.043432, -2.3636355, 8.7660055, -0.7485842, -1.9389092, 1.7077241]
Target sample: 91, Prediction:6, Target's Score:[-1.3589461, 2.8081417, -0.98813474, -1.1836035, -1.7872885, -1.9828753, 7.4878035, -0.64246535, -1.9857025, -0.39916965]
Target sample: 97, Prediction:6, Target's Score:[-1.7264135, 2.6033766, -1.6074435, -0.91104704, -2.1963015, -1.7385017, 7.5216217, -1.1622819, -2.6193829, 1.8057842]
Target sample: 103, Prediction:6, Target's Score:[0.20336112, 0.23698525, -1.6202893, -1.0037463, -2.285454, -2.56687, 8.411498, -0.08089087, -1.8245437, 0.5337946]
Target sample: 109, Prediction:6, Target's Score:[-0.45479605, 0.6214548, -1.8517284, -1.8505316, -2.2522135, -2.8657465, 9.857527, -0.3363709, -1.682357, 0.7974297]
Target sample: 115, Prediction:6, Target's Score:[-1.080997, 2.031193, -1.6906773, -1.0848948, -2.042351, -1.8460245, 7.1793976, -1.5782233, -1.8919041, 1.9824455]
Target sample: 121, Prediction:6, Target's Score:[-0.9419983, 1.862001, -1.9153203, -1.7260287, -2.317846, -2.7498786, 7.11539, -1.7251779, -2.0226562, 4.4007225]
Target sample: 127, Prediction:6, Target's Score:[-1.4602169, 3.5345607, -1.9726592, -1.0779186, -2.1610544, -2.0898612, 8.315019, -1.718028, -1.8949736, 0.48762146]
Target sample: 133, Prediction:6, Target's Score:[-0.83897126, 1.5223953, -2.3352113, -1.7423863, -2.4486341, -1.7423602, 8.456466, 0.3215511, -2.2373252, 1.0344914]
Target sample: 139, Prediction:6, Target's Score:[-0.8666641, 2.0027063, -2.336407, -1.6155592, -2.7293577, -2.276538, 10.132401, -0.7975978, -2.079518, 0.5451868]
Current ATTACK acc on target samples: 95.833
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 06:00:20 Epoch 59, Val iteration 0, acc 90.600 (90.600)
2021-06-11 06:00:30 Epoch 59, Val iteration 19, acc 90.400 (90.540)
* Prec: 90.54000205993653
Per class accuracy =  [0.95076814 0.93198579 0.85653983 0.86572626 0.91483032 0.77587923
 0.94698387 0.91104528 0.93234804 0.96378983]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 9, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 91.52542372881356
--------
DPN92
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  770
poison index =  1698
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 06:00:43, Val iteration 0, acc 94.800 (94.800)
2021-06-11 06:01:03, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 06:01:17, Epoch 0, Iteration 7, loss 0.267 (0.421), acc 92.308 (90.800)
2021-06-11 06:03:55, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.2279202, 3.2647984, -2.1068516, -1.918553, -1.4003209, -1.1774867, 8.091042, -3.526145, -1.1839135, 1.5217023]
Target sample: 7, Prediction:6, Target's Score:[-1.4596778, 1.9578581, -2.5060258, -1.7733274, -0.9484554, -2.0059779, 8.401741, -3.5441504, 0.6798642, 1.5215633]
Target sample: 13, Prediction:6, Target's Score:[-1.7656213, -1.3975272, -2.5341804, -2.4374304, 1.9264429, -2.0513785, 10.693336, -2.8465037, 0.9961094, -0.25235823]
Target sample: 19, Prediction:6, Target's Score:[-2.2366962, -0.6865305, -1.3236326, -1.4017195, 1.4966207, -1.4203838, 11.056913, -3.1698356, -1.1274946, -0.88770807]
Target sample: 25, Prediction:6, Target's Score:[-1.3601584, 5.960662, -2.0684016, -1.1369604, -1.3090087, -2.290338, 8.130482, -3.5231214, -2.3569043, 0.3553914]
Target sample: 31, Prediction:6, Target's Score:[-1.5882215, 6.3051457, -1.2272594, -1.5128264, -0.7930313, -2.064234, 6.659374, -3.3044255, -1.8235503, -0.2572773]
Target sample: 37, Prediction:1, Target's Score:[-0.47978973, 8.054469, -3.1791403, -2.3088164, -2.5561209, -2.2550373, 4.1148114, -4.1861973, -1.0975715, 4.2988276]
Target sample: 43, Prediction:6, Target's Score:[-1.7093563, 4.892858, -1.3735603, -1.985683, -1.5075879, -2.0830986, 5.824905, -3.708145, -1.2033532, 3.195368]
Target sample: 49, Prediction:6, Target's Score:[-1.9181826, 2.9327803, -1.1993153, -1.7201804, -0.79483104, -1.6923584, 8.049386, -3.4593215, -1.2569841, 1.3769555]
Target sample: 55, Prediction:6, Target's Score:[-2.4506812, 4.162196, -0.21588875, 0.35365757, -1.6211523, -1.2893661, 6.9774203, -2.8813999, -1.9916905, -0.66456366]
Target sample: 61, Prediction:6, Target's Score:[-0.5492798, 3.2445412, -2.6913786, 0.15800892, -1.5235277, -1.2519033, 7.834299, -2.4249427, -2.1796057, -0.27004385]
Target sample: 67, Prediction:6, Target's Score:[-1.0743092, 0.6964113, -1.4145081, 0.36008358, 0.56463814, -0.29850432, 5.4979506, -2.7301002, -1.7212859, 0.40527627]
Target sample: 73, Prediction:6, Target's Score:[-1.9524308, 4.7529, -1.6056294, -0.037626524, -1.9623748, -0.9609947, 5.3446846, -2.8682284, -0.42861956, 0.050854385]
Target sample: 79, Prediction:6, Target's Score:[-2.0253456, 4.2819834, -2.015403, -1.6502781, -0.6007915, -1.3547747, 7.626609, -3.1552343, -0.04193307, -0.7083647]
Target sample: 85, Prediction:6, Target's Score:[-2.9408875, -0.33944458, -1.5421427, -0.2565885, 1.1014869, -1.4816743, 10.6083555, -3.1424017, -0.9316055, -0.7669903]
Target sample: 91, Prediction:6, Target's Score:[-1.8404566, 3.6752417, -2.0400462, -0.60568297, -0.67360836, -1.7658557, 9.453467, -2.7258046, -2.3239787, -0.7811146]
Target sample: 97, Prediction:6, Target's Score:[-1.496213, 6.5714355, -2.2077744, -0.8030485, -1.8163291, -1.7684572, 6.7879934, -3.5539613, -1.522859, 0.20465833]
Target sample: 103, Prediction:6, Target's Score:[-2.2776394, 2.1177306, -1.6554618, -0.49371362, -0.42959982, -1.5047622, 9.705532, -3.2595518, -0.8578617, -1.0199258]
Target sample: 109, Prediction:6, Target's Score:[-2.4042242, 4.0175014, -1.7208284, -1.5772026, 0.10229722, -2.2871635, 8.556221, -3.664572, -0.76362723, 0.10071635]
Target sample: 115, Prediction:6, Target's Score:[-1.6851177, 2.298791, -1.441915, -1.0033387, 0.10270093, -1.4296542, 7.4758353, -3.4451115, -1.6378798, 1.0797321]
Target sample: 121, Prediction:6, Target's Score:[-2.8038468, 2.516696, -1.2771624, 3.2055387, -0.6661514, -1.9405537, 7.865423, -3.5118954, -2.475724, -0.5297761]
Target sample: 127, Prediction:6, Target's Score:[-2.0960293, 1.8507543, -1.8171737, 0.32056022, -0.94190717, -1.4202849, 10.107934, -3.5026886, -2.1586947, -0.0052750856]
Target sample: 133, Prediction:6, Target's Score:[-2.4499884, 1.2916205, -2.315703, -1.5793586, -0.090803154, -1.4401978, 6.959702, -2.817079, 1.2472993, 1.506888]
Target sample: 139, Prediction:6, Target's Score:[-0.8449258, 2.315801, -2.8567488, -2.4032657, -0.14060766, -1.9408233, 8.654777, -3.3610675, 0.7385908, 0.19900516]
Current ATTACK acc on target samples: 95.833
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 06:06:30 Epoch 59, Val iteration 0, acc 92.400 (92.400)
2021-06-11 06:06:50 Epoch 59, Val iteration 19, acc 92.600 (92.840)
* Prec: 92.84000129699707
Per class accuracy =  [0.94310422 0.9534128  0.89994914 0.86292347 0.94657555 0.86137761
 0.95080365 0.95035478 0.95783359 0.95402067]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 6, 1, 9, 6, 1, 6, 1, 6, 1, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 86.44067796610169
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  770
poison index =  1698
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 06:06:54, Val iteration 0, acc 92.600 (92.600)
2021-06-11 06:07:00, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 06:07:02, Epoch 0, Iteration 7, loss 0.292 (0.403), acc 86.538 (88.000)
2021-06-11 06:07:30, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.6132655, 0.71863, -2.7314491, 2.1015923, -3.6851366, -1.9343867, 6.239426, -2.4326563, 0.23107481, 3.2055728]
Target sample: 7, Prediction:6, Target's Score:[-2.89654, -2.04142, -2.7596266, 4.5078325, -3.452563, -0.71102285, 9.453879, -3.1793087, -1.3562682, 2.5091074]
Target sample: 13, Prediction:6, Target's Score:[-2.6999207, -2.7943416, -1.7004168, 5.3326993, -1.5792801, -1.8477485, 5.3448005, -1.414465, 0.5824019, 0.87344074]
Target sample: 19, Prediction:6, Target's Score:[-3.9056225, -3.08203, -0.002638124, 5.2329226, 1.9248751, -1.8249593, 8.866452, -0.26490298, -4.8975563, -1.9677881]
Target sample: 25, Prediction:6, Target's Score:[-1.9893819, -1.0992836, -0.06768081, 3.8396032, 0.82715476, -3.081102, 10.004254, -1.1745206, -6.122353, -1.0649445]
Target sample: 31, Prediction:6, Target's Score:[-1.1458806, -3.2361114, 1.470999, 3.136492, 2.2795835, -3.155444, 6.448491, -0.37147048, -5.060815, -0.28794268]
Target sample: 37, Prediction:9, Target's Score:[0.080002174, -1.0860027, -3.2297933, 4.6269093, -1.3693738, -3.1871214, 2.6015754, -1.5478475, -2.3911054, 5.6063123]
Target sample: 43, Prediction:6, Target's Score:[-2.22345, -2.6652591, -1.2047168, 5.3580375, -0.97143304, -3.3272164, 6.5954986, -3.5276327, -1.873358, 3.929959]
Target sample: 49, Prediction:6, Target's Score:[-2.2456818, 0.82284784, -0.5074463, 3.3142397, -3.3348866, -2.4616091, 4.7152514, -4.3358502, 0.53397954, 3.620099]
Target sample: 55, Prediction:6, Target's Score:[-2.4680672, 1.3234067, 0.4452, 2.9839702, -3.6839724, -2.1152647, 4.9021173, -0.14792731, -3.4494505, 2.306129]
Target sample: 61, Prediction:6, Target's Score:[-3.0489547, -1.0536469, -1.789524, 6.7394986, -1.2955612, -0.9244572, 9.258859, -5.056307, -4.143123, 1.3971875]
Target sample: 67, Prediction:6, Target's Score:[-0.8407838, 0.023257174, -1.5309831, 4.1032763, -0.9804308, -0.9784068, 4.236799, -0.5529518, -4.8042207, 1.4006584]
Target sample: 73, Prediction:3, Target's Score:[-3.9602323, 4.2114925, -0.57279843, 4.625637, -1.8570828, -3.9422405, 1.5382642, -2.5347893, 2.1739945, 0.47609434]
Target sample: 79, Prediction:6, Target's Score:[-4.0777965, -1.372936, -0.056692638, 5.627162, -0.49025828, -2.628501, 6.2843175, -1.649044, -1.2759888, -0.25870922]
Target sample: 85, Prediction:6, Target's Score:[-4.1221857, -4.678779, 1.2086582, 6.584353, 0.44249526, -0.31340367, 12.337032, -3.8968756, -5.2326155, -2.2686086]
Target sample: 91, Prediction:6, Target's Score:[-2.1870103, -1.7843106, -1.3771155, 7.073206, 0.31352577, -0.8112069, 9.161501, -1.6976072, -6.633794, -1.9914601]
Target sample: 97, Prediction:6, Target's Score:[-2.0957167, 1.5190855, -2.4418705, 4.0607977, -0.3654429, -1.1888498, 6.914701, -2.7022293, -5.555952, 1.9496707]
Target sample: 103, Prediction:6, Target's Score:[-1.7994925, -1.0061239, -2.3796654, 3.1402814, 1.5347471, -4.1119733, 6.8555865, -1.353635, -2.1866653, 1.416129]
Target sample: 109, Prediction:6, Target's Score:[-1.2263929, -2.8002036, 0.103455774, 2.0702684, -0.6371699, -4.658264, 6.872265, -2.570787, 2.2546175, 0.71029913]
Target sample: 115, Prediction:6, Target's Score:[-3.3871367, -0.2296485, -0.9251921, 2.2521486, -3.3671916, -0.38629502, 5.510335, -3.070383, 0.75238824, 2.9691107]
Target sample: 121, Prediction:6, Target's Score:[-4.423561, -1.5721971, -1.1828834, 6.9627805, -2.2945786, -2.2789001, 7.522912, -2.0475464, -0.9489494, 0.3640312]
Target sample: 127, Prediction:6, Target's Score:[-3.4560955, -0.5456508, -1.4085777, 5.9024825, 0.4441448, -2.5145414, 10.429824, -3.8497756, -4.518914, -0.40390864]
Target sample: 133, Prediction:6, Target's Score:[-2.1547933, -1.8175169, -0.6481438, 7.0020885, -2.9225528, -1.3434687, 7.8522363, -3.1431055, -3.9182394, 1.1591276]
Target sample: 139, Prediction:6, Target's Score:[-3.478265, -2.1211734, -2.0909603, 5.1322536, -1.8868542, -1.404607, 7.9437537, -3.4731462, 0.4634468, 1.0146545]
Current ATTACK acc on target samples: 91.667
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 06:07:57 Epoch 59, Val iteration 0, acc 89.400 (89.400)
2021-06-11 06:08:03 Epoch 59, Val iteration 19, acc 90.000 (89.290)
* Prec: 89.29000091552734
Per class accuracy =  [0.92091019 0.92501981 0.84220442 0.82335755 0.89169015 0.82280211
 0.93555316 0.89168493 0.92906279 0.94289958]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 3, 6, 6, 6, 6, 6, 6, 6, 3, 6, 3, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 3, 9, 6, 9, 9, 3, 3, 6, 6, 9, 3, 3, 9, 6, 6, 6, 6, 6, 3, 3, 3, 3, 6, 3, 3, 3, 6, 3, 3, 4, 9, 9, 6, 3, 3, 3, 3, 6, 3, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 3, 6, 3, 6, 6, 3, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 3, 6, 6, 6, 6, 3, 6, 3, 6, 6
ATTACK acc: 68.64406779661017
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  770
poison index =  1698
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 06:08:11, Val iteration 0, acc 96.200 (96.200)
2021-06-11 06:08:23, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 06:08:29, Epoch 0, Iteration 7, loss 0.633 (0.668), acc 82.692 (82.600)
2021-06-11 06:09:40, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.0343425, -0.14496219, -2.5638454, 0.44297478, -1.0224817, 1.2675973, 6.467352, -2.7561655, -0.66739064, 0.063353285]
Target sample: 7, Prediction:6, Target's Score:[-2.372057, 3.0182004, -2.4899619, -0.858671, -1.8612597, -2.9410195, 7.4871416, -3.2955794, 3.5031548, -0.16233826]
Target sample: 13, Prediction:6, Target's Score:[-0.97221035, 1.7090818, -2.0848176, -1.3013613, -1.1175311, -2.916478, 8.718916, -2.3445497, 0.07755606, 0.27573764]
Target sample: 19, Prediction:6, Target's Score:[-1.5440848, -1.4630198, -2.3269036, 1.154274, -0.8965957, -3.1180384, 9.239001, -2.0432804, 3.3645363, -2.3262248]
Target sample: 25, Prediction:6, Target's Score:[-1.546005, 3.3404489, -1.9434277, -0.08276207, -2.0310235, -2.7223213, 7.923094, -2.3188229, 0.33016378, -0.91544205]
Target sample: 31, Prediction:6, Target's Score:[-1.2598393, 1.5585971, -0.8761342, -0.3078505, 2.4226644, -3.845707, 7.5356274, -2.669504, -1.2495714, -1.2716153]
Target sample: 37, Prediction:6, Target's Score:[1.7969458, 2.5081916, -1.0036862, -2.1389718, -3.338992, -2.4206736, 6.3068147, -2.3133142, -0.9495117, 1.6117496]
Target sample: 43, Prediction:6, Target's Score:[-0.14282311, 2.7448773, -1.0436993, 0.2746006, -3.1442378, -2.91718, 6.9143333, -2.596593, -0.056768045, 0.011504289]
Target sample: 49, Prediction:6, Target's Score:[-2.242138, 1.8367623, 0.71007293, 2.0724814, -1.478482, -3.8371253, 4.6687903, -2.7082915, -0.16142158, 1.189222]
Target sample: 55, Prediction:6, Target's Score:[-1.6752481, 5.898195, -0.8070943, 0.09555807, -1.8249433, -3.5870793, 7.0710506, -1.7257005, -2.6391282, -0.7685133]
Target sample: 61, Prediction:6, Target's Score:[-2.0566347, 1.7769527, -3.2593336, 2.550627, -3.2233837, 0.1220886, 7.9778104, -3.4360378, -0.5722046, 0.17233932]
Target sample: 67, Prediction:6, Target's Score:[-1.4674625, -0.61069953, -0.6900751, 1.3325782, -1.7539386, -0.444537, 5.805453, -1.1148489, 0.2907229, -1.3018788]
Target sample: 73, Prediction:1, Target's Score:[-3.4599829, 7.8287745, -0.8628494, 0.050743423, -2.5080836, -4.3575163, 5.4378505, -1.4253094, -0.04777102, -0.6303686]
Target sample: 79, Prediction:6, Target's Score:[-2.529213, 6.1802917, -1.4843917, -0.4267055, -2.903645, -2.6405492, 8.054634, -2.198618, -0.65128845, -1.3710725]
Target sample: 85, Prediction:6, Target's Score:[-3.7723424, -1.0015043, -2.1995804, 4.354853, 2.5500607, -1.8805572, 5.0549126, -2.2362175, 0.5933761, -1.4304351]
Target sample: 91, Prediction:6, Target's Score:[-2.839974, 3.0912576, -3.4434905, -1.0866834, 0.60890466, -1.7876377, 8.010689, -1.6952745, 0.15924121, -0.98950815]
Target sample: 97, Prediction:6, Target's Score:[-0.88694376, 4.8438654, -1.5085714, -1.3195413, -2.4414227, -2.777654, 7.2686524, -2.7759528, -0.96628976, 0.6083054]
Target sample: 103, Prediction:6, Target's Score:[0.9462387, 1.7621881, -1.9080985, -1.8365743, -3.742091, -2.2898006, 8.275832, -2.6911645, 1.1641563, 0.36766577]
Target sample: 109, Prediction:6, Target's Score:[1.4704274, 3.9263, -1.2513107, -1.4337013, -2.5749264, -3.6263034, 7.343896, -2.7965975, -0.40239894, -0.6108822]
Target sample: 115, Prediction:6, Target's Score:[0.38727564, 1.8689141, 1.5224196, -1.6269879, -3.2188325, -3.9046037, 4.8489256, -1.73684, 0.43605804, 1.4804275]
Target sample: 121, Prediction:6, Target's Score:[-1.0072556, 1.1283206, -1.9524018, 1.0410663, -0.6256466, -3.3243608, 6.5067306, -2.1753879, 0.8020382, -0.34514362]
Target sample: 127, Prediction:6, Target's Score:[-2.3590784, 4.427284, -3.138875, 1.0804965, -2.7323825, -1.3252735, 6.584308, -3.130058, -0.70405775, 1.3433152]
Target sample: 133, Prediction:6, Target's Score:[-1.1563244, 0.8482597, -1.7150929, -1.0216539, -2.5973177, -2.047495, 5.23135, 0.84926957, 1.1223933, 0.53276366]
Target sample: 139, Prediction:6, Target's Score:[-1.5555245, -0.078348495, -1.6711726, 1.8081163, -1.17016, -1.5629563, 7.12351, -3.112456, 2.0817015, -1.8248862]
Current ATTACK acc on target samples: 95.833
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 06:10:49 Epoch 59, Val iteration 0, acc 93.000 (93.000)
2021-06-11 06:11:02 Epoch 59, Val iteration 19, acc 92.400 (92.800)
* Prec: 92.80000152587891
Per class accuracy =  [0.94115222 0.94508481 0.8919117  0.83824624 0.9507658  0.91003187
 0.95442725 0.93647587 0.95882257 0.9485642 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 6, 6, 6, 6, 6, 9, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 3, 6, 6, 6, 1, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 91.52542372881356
--------
------SUMMARY------
TIME ELAPSED (mins): 24
TARGET INDEX: 10
ResNet50 95.83333333333333 91.52542372881356 95.46000137329102 90.54000205993653
DPN92 95.83333333333333 86.44067796610169 95.50000267028808 92.84000129699707
MobileNetV2 91.66666666666667 68.64406779661017 91.22000160217286 89.29000091552734
GoogLeNet 95.83333333333333 91.52542372881356 95.41000213623047 92.80000152587891
True False False False False
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 92 images of target 11
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=False, nearest=True, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=11, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/11/target-num-20
torch.Size([200, 1, 3, 32, 32]) torch.Size([16, 3, 32, 32])
Selected nearest neighbors: [1212, 1088, 770, 1708, 1698]
Selected base image indices: [1212, 1088, 770, 1708, 1698]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
# Targets: 16, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 06:11:36 Iteration 0 	 Training Loss: 7.920e-01 	 Loss in Target Net: 9.510e-01	  
tensor(-0.0002, device='cuda:0')
 2021-06-11 06:12:43 Iteration 50 	 Training Loss: 1.886e-01 	 Loss in Target Net: 1.816e-01	  
tensor(-0.0116, device='cuda:0')
 2021-06-11 06:13:47 Iteration 100 	 Training Loss: 1.484e-01 	 Loss in Target Net: 1.957e-01	  
tensor(-0.0207, device='cuda:0')
 2021-06-11 06:14:56 Iteration 150 	 Training Loss: 1.353e-01 	 Loss in Target Net: 1.840e-01	  
tensor(-0.0239, device='cuda:0')
 2021-06-11 06:16:02 Iteration 200 	 Training Loss: 1.267e-01 	 Loss in Target Net: 1.984e-01	  
tensor(-0.0253, device='cuda:0')
 2021-06-11 06:17:08 Iteration 250 	 Training Loss: 1.230e-01 	 Loss in Target Net: 1.887e-01	  
tensor(-0.0249, device='cuda:0')
 2021-06-11 06:18:13 Iteration 300 	 Training Loss: 1.218e-01 	 Loss in Target Net: 1.853e-01	  
tensor(-0.0262, device='cuda:0')
 2021-06-11 06:19:17 Iteration 350 	 Training Loss: 1.225e-01 	 Loss in Target Net: 2.128e-01	  
tensor(-0.0242, device='cuda:0')
 2021-06-11 06:20:20 Iteration 400 	 Training Loss: 1.183e-01 	 Loss in Target Net: 2.046e-01	  
tensor(-0.0240, device='cuda:0')
 2021-06-11 06:21:24 Iteration 450 	 Training Loss: 1.168e-01 	 Loss in Target Net: 1.994e-01	  
tensor(-0.0244, device='cuda:0')
 2021-06-11 06:22:28 Iteration 500 	 Training Loss: 1.161e-01 	 Loss in Target Net: 1.906e-01	  
tensor(-0.0240, device='cuda:0')
 2021-06-11 06:23:32 Iteration 550 	 Training Loss: 1.204e-01 	 Loss in Target Net: 1.971e-01	  
tensor(-0.0241, device='cuda:0')
 2021-06-11 06:24:37 Iteration 600 	 Training Loss: 1.131e-01 	 Loss in Target Net: 1.806e-01	  
tensor(-0.0234, device='cuda:0')
 2021-06-11 06:25:40 Iteration 650 	 Training Loss: 1.103e-01 	 Loss in Target Net: 2.112e-01	  
tensor(-0.0232, device='cuda:0')
 2021-06-11 06:26:45 Iteration 700 	 Training Loss: 1.145e-01 	 Loss in Target Net: 1.860e-01	  
tensor(-0.0228, device='cuda:0')
 2021-06-11 06:27:49 Iteration 750 	 Training Loss: 1.154e-01 	 Loss in Target Net: 1.979e-01	  
tensor(-0.0225, device='cuda:0')
 2021-06-11 06:28:55 Iteration 800 	 Training Loss: 1.115e-01 	 Loss in Target Net: 1.964e-01	  
tensor(-0.0233, device='cuda:0')
 2021-06-11 06:29:59 Iteration 850 	 Training Loss: 1.127e-01 	 Loss in Target Net: 1.905e-01	  
tensor(-0.0229, device='cuda:0')
 2021-06-11 06:31:07 Iteration 900 	 Training Loss: 1.119e-01 	 Loss in Target Net: 2.049e-01	  
tensor(-0.0229, device='cuda:0')
 2021-06-11 06:32:11 Iteration 950 	 Training Loss: 1.143e-01 	 Loss in Target Net: 2.329e-01	  
tensor(-0.0229, device='cuda:0')
 2021-06-11 06:33:17 Iteration 999 	 Training Loss: 1.172e-01 	 Loss in Target Net: 2.151e-01	  
tensor(-0.0228, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  770
poison index =  1708
poison index =  1698
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 06:33:22, Val iteration 0, acc 94.200 (94.200)
2021-06-11 06:33:32, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 06:33:38, Epoch 0, Iteration 7, loss 0.177 (0.269), acc 96.154 (94.800)
2021-06-11 06:34:38, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-3.730175, 12.448403, -2.7989788, -1.3642781, -4.159369, -3.5278063, 5.991789, -2.1036346, 3.618414, -4.1921864]
Target sample: 7, Prediction:1, Target's Score:[-3.9166434, 10.936636, -2.653164, -1.6662036, -3.8046875, -2.3370326, 7.351034, -2.0678968, 0.6444302, -2.2895296]
Target sample: 13, Prediction:1, Target's Score:[-3.6883123, 8.945741, -2.1208305, -1.6296366, -3.496182, -2.9183214, 6.333353, -2.8071406, -0.15189631, 1.757249]
Target sample: 19, Prediction:1, Target's Score:[-3.4214282, 11.263638, -3.315107, -0.46968684, -3.7957885, -2.303869, 4.767946, -1.9278316, 1.337184, -1.9582046]
Target sample: 25, Prediction:1, Target's Score:[-4.2065525, 10.7589855, -1.9409015, -0.8507286, -3.4463584, -3.5291631, 7.712617, -2.2074091, 0.84122187, -2.943484]
Target sample: 31, Prediction:1, Target's Score:[-4.4425464, 11.179896, -2.114458, -0.42003512, -3.673402, -3.3861809, 7.4896226, -2.057869, 0.26828796, -2.6534166]
Target sample: 37, Prediction:1, Target's Score:[-3.0424485, 12.005918, -2.6614077, -1.6566164, -3.3543916, -3.1418555, 4.345488, -1.9762962, 1.6676202, -2.0193086]
Target sample: 43, Prediction:1, Target's Score:[-2.8335226, 12.469046, -2.4367294, -2.3680315, -3.783499, -2.4986866, 4.3151307, -1.7882112, 2.2526329, -3.1642032]
Target sample: 49, Prediction:1, Target's Score:[-4.2212677, 14.882354, -2.8785565, -2.1613927, -4.5194745, -4.144871, 7.0259824, -1.5282512, 1.7156767, -3.9796321]
Target sample: 55, Prediction:1, Target's Score:[-3.8349645, 9.194548, -3.154397, -0.9330394, -3.9091444, -3.7539277, 8.209037, -1.9685161, 1.7991924, -1.4234897]
Target sample: 61, Prediction:6, Target's Score:[-5.1502323, 8.541461, -2.9831595, 0.21923515, -3.937397, -3.985567, 10.333338, -1.7490476, 2.800437, -3.8644853]
Target sample: 67, Prediction:6, Target's Score:[-4.6469364, 8.771366, -2.9037647, -0.5041925, -3.8764005, -4.0844746, 9.723971, -2.0886219, 3.1800365, -3.3414557]
Target sample: 73, Prediction:1, Target's Score:[-4.259195, 11.975819, -3.0405235, -0.52912873, -4.077753, -3.7856731, 7.3943844, -1.8290135, 2.0806968, -3.734742]
Target sample: 79, Prediction:1, Target's Score:[-3.9441824, 13.913397, -3.3003826, -1.4006736, -4.3424606, -3.8692086, 6.0365763, -1.6778486, 1.9510034, -3.1755145]
Target sample: 85, Prediction:1, Target's Score:[-3.5566013, 11.759681, -2.49912, -0.9588389, -4.076422, -3.5491998, 5.979289, -2.0134091, 3.6620638, -4.572577]
Target sample: 91, Prediction:1, Target's Score:[-3.8987327, 11.971097, -2.6638508, -2.0289917, -4.1330986, -1.9774401, 6.754283, -2.007068, 0.7813795, -2.6027186]
Current ATTACK acc on target samples: 12.500
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 06:35:36 Epoch 59, Val iteration 0, acc 91.600 (91.600)
2021-06-11 06:35:47 Epoch 59, Val iteration 19, acc 92.400 (91.810)
* Prec: 91.81000213623047
Per class accuracy =  [0.95809183 0.96652083 0.86669548 0.7338641  0.95234586 0.92081112
 0.93601366 0.95097425 0.96551624 0.93055592]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 2.6315789473684212
--------
DPN92
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  770
poison index =  1708
poison index =  1698
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 06:35:58, Val iteration 0, acc 94.800 (94.800)
2021-06-11 06:36:18, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 06:36:32, Epoch 0, Iteration 7, loss 0.837 (0.584), acc 84.615 (87.400)
2021-06-11 06:39:11, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.8728397, 11.894744, -3.1430159, -1.6572748, -3.5364518, -4.2691593, 4.9940658, -3.4790344, 2.174154, -0.7833867]
Target sample: 7, Prediction:1, Target's Score:[-2.019943, 8.156541, -2.7220578, -1.6459173, -2.5577133, -2.8411338, 8.036895, -3.4559386, -0.028387252, -0.57440543]
Target sample: 13, Prediction:1, Target's Score:[-3.4882224, 10.627819, -1.5964146, -2.4087694, -2.7637858, -4.531521, 8.161246, -4.1182647, 0.80858356, -0.3552503]
Target sample: 19, Prediction:6, Target's Score:[-2.8096595, 6.451411, -2.0646472, -1.1245713, -3.3124156, -3.14526, 9.799212, -2.818404, 1.2635915, -1.901344]
Target sample: 25, Prediction:1, Target's Score:[-3.8342543, 10.355145, -1.6368301, -1.8836775, -2.6667538, -4.258335, 8.269653, -4.007161, 0.62064654, -0.6087398]
Target sample: 31, Prediction:1, Target's Score:[-2.9973087, 9.366251, -2.0702293, -1.951287, -2.4788585, -4.146393, 8.346658, -3.8083334, 0.6241708, -0.54768115]
Target sample: 37, Prediction:1, Target's Score:[-1.7790686, 13.27991, -2.6189077, -1.9342507, -2.8234818, -4.359325, 3.4655428, -3.8144372, 1.2156911, -0.2990095]
Target sample: 43, Prediction:1, Target's Score:[-2.426637, 8.958231, -3.1242476, -1.8444688, -2.354406, -3.955351, 7.038397, -3.6620038, 2.1511197, -0.48258048]
Target sample: 49, Prediction:6, Target's Score:[-3.7934341, 8.972028, -1.6621116, -2.6171186, -2.4351785, -3.92741, 10.1556835, -3.5155935, 0.538033, -1.3738664]
Target sample: 55, Prediction:6, Target's Score:[-4.411737, 7.9809217, -2.1690872, -2.0872202, -2.4351246, -3.8779998, 11.201139, -3.8537123, 0.7689691, -0.757495]
Target sample: 61, Prediction:6, Target's Score:[-4.1053853, 7.4322534, -2.9310439, -1.2927467, -1.2561163, -3.9071558, 10.738747, -3.8627324, 1.6944239, -2.162371]
Target sample: 67, Prediction:6, Target's Score:[-4.1299224, 9.342509, -1.880725, -2.1037822, -2.504106, -4.2877154, 9.896828, -3.8664596, 1.1048188, -1.2268932]
Target sample: 73, Prediction:1, Target's Score:[-2.228609, 9.818503, -3.0526662, -1.8062105, -3.2211847, -3.9091945, 7.5452924, -3.9752295, 0.22281998, 0.96867657]
Target sample: 79, Prediction:1, Target's Score:[-2.526588, 9.93281, -3.1517065, -2.0932262, -3.086848, -4.2197547, 7.8233895, -3.4677944, 1.8621567, -0.7439161]
Target sample: 85, Prediction:1, Target's Score:[-1.5512803, 10.956123, -2.993024, -1.2036225, -2.4440265, -4.081563, 4.2131033, -3.441992, 2.4107401, -1.5537561]
Target sample: 91, Prediction:1, Target's Score:[-2.0634327, 9.567083, -2.804045, -1.9338477, -2.7436604, -1.7609372, 6.3407927, -3.6009712, -0.18044958, -0.47657168]
Current ATTACK acc on target samples: 31.250
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 06:41:46 Epoch 59, Val iteration 0, acc 92.000 (92.000)
2021-06-11 06:42:07 Epoch 59, Val iteration 19, acc 92.400 (92.490)
* Prec: 92.4900016784668
Per class accuracy =  [0.94076969 0.96485344 0.91467629 0.80275293 0.95714933 0.90405967
 0.92974253 0.93976922 0.95118962 0.94606363]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1
ATTACK acc: 44.73684210526316
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  770
poison index =  1708
poison index =  1698
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 06:42:10, Val iteration 0, acc 92.600 (92.600)
2021-06-11 06:42:16, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 06:42:18, Epoch 0, Iteration 7, loss 0.285 (0.374), acc 92.308 (89.400)
2021-06-11 06:42:46, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-2.9963143, 7.6027536, -0.47600558, -0.69072807, -2.031548, -1.4481238, 7.441035, -3.9438412, -3.0357175, -0.19112287]
Target sample: 7, Prediction:6, Target's Score:[-1.278734, 6.844036, -0.16948065, 2.0293252, -3.4381654, -2.438673, 10.120995, -6.8556366, -3.76852, -0.8181529]
Target sample: 13, Prediction:1, Target's Score:[-1.6519157, 9.840627, -2.3070283, -1.559825, -5.169838, -1.1650969, 9.147938, -7.6080365, -3.1794653, 3.9103353]
Target sample: 19, Prediction:1, Target's Score:[-3.6429052, 10.974132, -5.7835603, 3.0277193, -4.122651, -2.398634, 7.5648475, -4.358038, 0.29095694, -1.2899165]
Target sample: 25, Prediction:6, Target's Score:[-3.574094, 5.0431585, -1.163763, 2.8991044, -1.7571328, -3.8325322, 8.942701, -5.4793854, -2.3023095, 1.4504303]
Target sample: 31, Prediction:6, Target's Score:[-1.820958, 9.896995, -3.1684163, 1.6946528, -6.4346266, -1.9187231, 13.505536, -8.480845, -4.901594, 1.8855047]
Target sample: 37, Prediction:1, Target's Score:[-1.3443229, 10.387834, -2.851839, -0.35403994, 0.88703007, -2.3578339, 2.6339703, -4.9127803, -4.074685, 2.2852917]
Target sample: 43, Prediction:1, Target's Score:[-1.4240232, 10.4646015, -2.244609, 1.6485839, 4.1763988, -4.2652802, 1.1257027, -4.864729, -4.241002, -0.04018821]
Target sample: 49, Prediction:6, Target's Score:[-2.2200596, 9.077554, 0.16965058, 0.8535912, -5.6765413, -2.414411, 12.634227, -6.870518, -2.0056958, -3.3201215]
Target sample: 55, Prediction:6, Target's Score:[-2.200747, 7.4223375, -1.7548636, 0.26743016, -3.9075546, -2.8739383, 11.603967, -5.1854706, -3.7158024, 0.56362975]
Target sample: 61, Prediction:6, Target's Score:[-3.3349178, 5.4838653, -1.8237408, 2.6175938, -0.95222825, -2.2760243, 10.85938, -6.127513, -2.083159, -2.1442554]
Target sample: 67, Prediction:6, Target's Score:[-2.8064344, 6.9376454, -2.1591096, 0.82810485, -3.068337, -3.3616872, 12.718301, -5.2254343, -1.940799, -1.7046181]
Target sample: 73, Prediction:1, Target's Score:[-1.0769119, 10.991042, -3.131784, 0.59428203, -4.4952397, -2.699514, 9.80683, -5.7883906, -3.5306847, -0.40772706]
Target sample: 79, Prediction:1, Target's Score:[-2.7857234, 6.891185, -1.2148886, 2.1596947, 1.2552805, -2.7661667, 6.872595, -5.9318085, -4.689081, 0.4766562]
Target sample: 85, Prediction:1, Target's Score:[-0.9544386, 10.03538, 0.26591006, 1.4103622, -2.31463, -3.6278138, 3.2663388, -3.4568133, -4.7929063, 0.43981856]
Target sample: 91, Prediction:6, Target's Score:[-2.1324956, 8.431764, -2.3368416, -0.10653512, -3.8180835, -1.4220828, 8.701138, -5.9093475, -4.035523, 2.858701]
Current ATTACK acc on target samples: 50.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 06:43:13 Epoch 59, Val iteration 0, acc 88.800 (88.800)
2021-06-11 06:43:19 Epoch 59, Val iteration 19, acc 91.200 (89.420)
* Prec: 89.42000122070313
Per class accuracy =  [0.92411732 0.92062064 0.85186996 0.82279213 0.88955978 0.82679358
 0.93641027 0.88902227 0.93097713 0.94724047]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 6, 1, 6, 1, 1, 6, 1, 6, 1, 1, 1, 6, 6, 1, 1, 6, 1, 1, 1, 6, 6, 6, 6, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 1, 6, 1, 6, 1, 1, 6, 1, 1, 6, 1, 1, 1, 1, 6, 1, 1, 1, 1, 6, 6, 1
ATTACK acc: 43.421052631578945
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  770
poison index =  1708
poison index =  1698
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 06:43:27, Val iteration 0, acc 96.200 (96.200)
2021-06-11 06:43:39, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 06:43:45, Epoch 0, Iteration 7, loss 0.907 (0.911), acc 71.154 (77.000)
2021-06-11 06:44:56, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-4.46244, 10.587308, -4.575048, -3.7562075, -2.4422622, -0.16259, 8.352329, -3.1961951, 0.26570037, -0.6010914]
Target sample: 7, Prediction:1, Target's Score:[-4.710811, 11.168804, -3.9108336, -2.6577537, -2.93221, 0.5903356, 7.4663854, -3.8360202, -2.712462, 1.549455]
Target sample: 13, Prediction:6, Target's Score:[-4.934204, 7.6932416, -3.931455, -1.5682436, -3.2298596, 1.8390524, 11.8294115, -3.6852112, -2.1378257, -1.8829033]
Target sample: 19, Prediction:1, Target's Score:[-4.8631096, 7.668811, -4.0861664, -2.216879, -3.0418863, 4.5851912, 6.9792495, -2.7855844, -0.6687404, -1.5291934]
Target sample: 25, Prediction:6, Target's Score:[-4.1799574, 7.4372, -4.855296, 1.045482, -2.4686148, 3.1334376, 9.063065, -4.158463, -3.186381, -1.8323385]
Target sample: 31, Prediction:6, Target's Score:[-5.014612, 6.195473, -1.8721129, -1.9032314, -3.1080384, 2.1348188, 9.505391, -3.555922, -2.2133884, -0.16503647]
Target sample: 37, Prediction:1, Target's Score:[-4.3126636, 12.076391, -5.1486945, -3.4215047, -1.9413235, -0.093467064, 8.193164, -4.0704837, -2.0998476, 0.8299037]
Target sample: 43, Prediction:1, Target's Score:[-4.3545403, 11.542427, -5.0649347, -3.1215637, -2.5616488, 0.021463387, 6.8989534, -4.2044196, -1.7385291, 2.6076922]
Target sample: 49, Prediction:1, Target's Score:[-5.5239854, 10.114001, -3.264739, -2.5973032, -2.9466338, 2.410077, 9.136433, -3.7358856, -2.3971984, -1.1798757]
Target sample: 55, Prediction:6, Target's Score:[-4.823093, 3.9540336, -2.8975935, -3.0415387, -2.771261, 2.433587, 14.003922, -3.2081065, -2.1614778, -1.4952269]
Target sample: 61, Prediction:6, Target's Score:[-5.6888967, 5.61198, -3.569907, -2.8672607, -2.3765094, 2.8842309, 14.018622, -2.4423337, -1.4550713, -4.1310062]
Target sample: 67, Prediction:6, Target's Score:[-5.6990266, 7.021466, -3.3485162, -3.2476132, -3.8585227, 4.2855234, 13.6152115, -4.0312424, -3.8220885, -0.9003477]
Target sample: 73, Prediction:1, Target's Score:[-5.0689735, 8.230141, -3.1463206, -1.6091179, -2.8121147, 3.5294123, 7.9603577, -3.3677707, -2.9607618, -0.7340162]
Target sample: 79, Prediction:1, Target's Score:[-4.277268, 11.161484, -4.724486, -2.3533063, -2.0939624, -1.3840023, 7.709905, -3.705451, -1.4432269, 1.1080533]
Target sample: 85, Prediction:1, Target's Score:[-3.9309902, 11.7777815, -4.3708696, -4.4526076, -1.6872324, 0.6856271, 5.885541, -2.383957, -1.0789012, -0.4155027]
Target sample: 91, Prediction:6, Target's Score:[-5.6126604, 7.4793215, -4.2987766, -3.4410517, -3.48675, 1.3164825, 12.697099, -4.378222, -3.0430655, 2.7725208]
Current ATTACK acc on target samples: 43.750
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 06:46:05 Epoch 59, Val iteration 0, acc 92.000 (92.000)
2021-06-11 06:46:17 Epoch 59, Val iteration 19, acc 92.200 (92.060)
* Prec: 92.06000137329102
Per class accuracy =  [0.94755839 0.9474286  0.89165827 0.85807612 0.91536526 0.86129212
 0.95282012 0.92873722 0.94637111 0.95499128]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 1, 6, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1
ATTACK acc: 52.63157894736842
--------
------SUMMARY------
TIME ELAPSED (mins): 21
TARGET INDEX: 11
ResNet50 12.5 2.6315789473684212 95.46000137329102 91.81000213623047
DPN92 31.25 44.73684210526316 95.50000267028808 92.4900016784668
MobileNetV2 50.0 43.421052631578945 91.22000160217286 89.42000122070313
GoogLeNet 43.75 52.63157894736842 95.41000213623047 92.06000137329102
True False False False True
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 92 images of target 11
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=True, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=11, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/11/target-num-20
torch.Size([200, 1, 3, 32, 32]) torch.Size([16, 3, 32, 32])
Selected nearest neighbors: [1212, 1088, 770, 1708, 1698]
Selected base image indices: [1212, 1088, 770, 1708, 1698]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
# Targets: 16, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 06:46:53 Iteration 0 	 Training Loss: 7.349e-01 	 Loss in Target Net: 5.955e-01	  
tensor(-0.0013, device='cuda:0')
 2021-06-11 06:48:08 Iteration 50 	 Training Loss: 3.174e-01 	 Loss in Target Net: 2.573e-01	  
tensor(-0.0589, device='cuda:0')
 2021-06-11 06:49:23 Iteration 100 	 Training Loss: 2.855e-01 	 Loss in Target Net: 2.439e-01	  
tensor(-0.0789, device='cuda:0')
 2021-06-11 06:50:37 Iteration 150 	 Training Loss: 2.801e-01 	 Loss in Target Net: 2.437e-01	  
tensor(-0.0782, device='cuda:0')
 2021-06-11 06:51:56 Iteration 200 	 Training Loss: 2.771e-01 	 Loss in Target Net: 2.345e-01	  
tensor(-0.0793, device='cuda:0')
 2021-06-11 06:53:17 Iteration 250 	 Training Loss: 2.754e-01 	 Loss in Target Net: 2.458e-01	  
tensor(-0.0768, device='cuda:0')
 2021-06-11 06:54:36 Iteration 300 	 Training Loss: 2.753e-01 	 Loss in Target Net: 2.321e-01	  
tensor(-0.0752, device='cuda:0')
 2021-06-11 06:55:54 Iteration 350 	 Training Loss: 2.758e-01 	 Loss in Target Net: 2.342e-01	  
tensor(-0.0731, device='cuda:0')
 2021-06-11 06:57:12 Iteration 400 	 Training Loss: 2.770e-01 	 Loss in Target Net: 2.326e-01	  
tensor(-0.0731, device='cuda:0')
 2021-06-11 06:58:27 Iteration 450 	 Training Loss: 2.745e-01 	 Loss in Target Net: 2.335e-01	  
tensor(-0.0732, device='cuda:0')
 2021-06-11 06:59:48 Iteration 500 	 Training Loss: 2.781e-01 	 Loss in Target Net: 2.247e-01	  
tensor(-0.0734, device='cuda:0')
 2021-06-11 07:01:05 Iteration 550 	 Training Loss: 2.763e-01 	 Loss in Target Net: 2.329e-01	  
tensor(-0.0724, device='cuda:0')
 2021-06-11 07:02:20 Iteration 600 	 Training Loss: 2.777e-01 	 Loss in Target Net: 2.346e-01	  
tensor(-0.0720, device='cuda:0')
 2021-06-11 07:03:34 Iteration 650 	 Training Loss: 2.750e-01 	 Loss in Target Net: 2.289e-01	  
tensor(-0.0722, device='cuda:0')
 2021-06-11 07:04:49 Iteration 700 	 Training Loss: 2.769e-01 	 Loss in Target Net: 2.424e-01	  
tensor(-0.0723, device='cuda:0')
 2021-06-11 07:06:09 Iteration 750 	 Training Loss: 2.741e-01 	 Loss in Target Net: 2.326e-01	  
tensor(-0.0729, device='cuda:0')
 2021-06-11 07:07:26 Iteration 800 	 Training Loss: 2.761e-01 	 Loss in Target Net: 2.339e-01	  
tensor(-0.0723, device='cuda:0')
 2021-06-11 07:08:41 Iteration 850 	 Training Loss: 2.735e-01 	 Loss in Target Net: 2.449e-01	  
tensor(-0.0721, device='cuda:0')
 2021-06-11 07:09:55 Iteration 900 	 Training Loss: 2.736e-01 	 Loss in Target Net: 2.288e-01	  
tensor(-0.0723, device='cuda:0')
 2021-06-11 07:11:13 Iteration 950 	 Training Loss: 2.776e-01 	 Loss in Target Net: 2.291e-01	  
tensor(-0.0723, device='cuda:0')
 2021-06-11 07:12:27 Iteration 999 	 Training Loss: 2.767e-01 	 Loss in Target Net: 2.311e-01	  
tensor(-0.0722, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  770
poison index =  1708
poison index =  1698
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 07:12:33, Val iteration 0, acc 94.200 (94.200)
2021-06-11 07:12:42, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 07:12:48, Epoch 0, Iteration 7, loss 0.367 (0.554), acc 90.385 (87.600)
2021-06-11 07:13:47, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.3473153, 8.282863, -1.3412216, -2.93506, -2.1792426, -2.5416043, 4.2505293, -1.4430262, 0.29495618, -1.206099]
Target sample: 7, Prediction:6, Target's Score:[-2.9112706, 5.1203227, -0.80306154, -2.8513856, -1.7015594, -1.9889657, 7.066713, -1.7686648, -1.7962513, 1.485816]
Target sample: 13, Prediction:9, Target's Score:[-3.2809663, 3.7540636, -1.0375073, -3.4143295, -1.8708564, -2.5130835, 6.0680695, -2.401983, -1.6170382, 6.155175]
Target sample: 19, Prediction:1, Target's Score:[-2.8263, 8.879472, -1.9019994, -2.738289, -2.0028963, -2.5767405, 5.437229, -1.584558, -0.7460962, -0.119341]
Target sample: 25, Prediction:1, Target's Score:[-3.1675408, 11.200204, -1.7265308, -3.4966233, -2.240237, -2.8552802, 5.564866, -1.6410277, -1.6276507, -0.22742276]
Target sample: 31, Prediction:1, Target's Score:[-2.6517441, 7.1767077, -0.6493062, -3.10533, -1.9023745, -2.6965868, 6.0220475, -1.4479324, -1.7325994, 0.81814075]
Target sample: 37, Prediction:1, Target's Score:[-1.9932095, 9.397223, -1.5558846, -3.0383189, -2.0571845, -2.5894227, 3.9314005, -1.5275108, -0.80877596, 0.06211542]
Target sample: 43, Prediction:1, Target's Score:[-2.105305, 10.8627825, -1.9411806, -3.3012521, -2.225689, -2.3318484, 3.1167746, -1.3032411, -0.6851253, -0.28285605]
Target sample: 49, Prediction:1, Target's Score:[-3.2270644, 9.388017, -0.80875516, -3.5683177, -1.9269664, -2.7890692, 5.6853266, -1.2109452, -1.885081, 0.14949019]
Target sample: 55, Prediction:6, Target's Score:[-2.5426333, 6.955795, -1.2822636, -3.4428992, -2.1489615, -3.1761942, 8.223304, -1.0338835, -1.7112095, -0.011373504]
Target sample: 61, Prediction:6, Target's Score:[-2.8077211, 6.2837496, -1.2175589, -3.5966644, -2.0782607, -3.178082, 10.87499, -1.1864885, -1.5008084, -1.7582066]
Target sample: 67, Prediction:1, Target's Score:[-2.6021857, 9.345634, -1.5828177, -3.5642743, -2.2200732, -3.1110485, 6.731458, -1.5975211, -1.419803, -0.17132036]
Target sample: 73, Prediction:1, Target's Score:[-2.7437167, 10.388916, -1.4518137, -3.745089, -2.3726006, -3.1314366, 6.5529203, -1.2114174, -1.5680226, -0.9184732]
Target sample: 79, Prediction:1, Target's Score:[-2.1501594, 10.4837675, -1.5913647, -3.3855171, -2.163169, -2.8742492, 4.751025, -1.2699983, -1.1368706, -0.85844576]
Target sample: 85, Prediction:1, Target's Score:[-1.4250112, 8.258873, -1.2421275, -2.69043, -2.0669115, -2.499316, 3.5216224, -1.3299296, 0.70561695, -1.3928158]
Target sample: 91, Prediction:1, Target's Score:[-2.6215644, 6.3630366, -0.98717755, -3.1680515, -1.9124802, -2.0944319, 6.346512, -1.529491, -1.8081074, 1.2538297]
Current ATTACK acc on target samples: 18.750
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 07:14:46 Epoch 59, Val iteration 0, acc 88.000 (88.000)
2021-06-11 07:14:56 Epoch 59, Val iteration 19, acc 89.600 (89.050)
* Prec: 89.05000076293945
Per class accuracy =  [0.900415   0.92252391 0.79916505 0.67399287 0.9545034  0.84519156
 0.97828981 0.90789392 0.95299886 0.97035125]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 6, 1, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6
ATTACK acc: 17.105263157894736
--------
DPN92
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  770
poison index =  1708
poison index =  1698
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 07:15:08, Val iteration 0, acc 94.800 (94.800)
2021-06-11 07:15:28, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 07:15:43, Epoch 0, Iteration 7, loss 0.138 (0.425), acc 98.077 (90.600)
2021-06-11 07:18:21, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-2.5674574, 13.50953, -4.3191953, -1.8364562, -3.6519241, -4.2761674, 3.3111846, -2.680971, 2.5884454, 0.35782382]
Target sample: 7, Prediction:6, Target's Score:[-2.3582168, 7.846367, -2.992341, -1.4152162, -2.824986, -2.5953329, 8.049709, -2.5658627, -0.7585308, -0.009820212]
Target sample: 13, Prediction:1, Target's Score:[-3.5108516, 10.702855, -2.4689238, -1.6576234, -2.5529106, -4.9137545, 7.8545494, -3.6792498, 0.28401718, 0.36826405]
Target sample: 19, Prediction:6, Target's Score:[-2.9572048, 5.536901, -2.4950333, -0.56609696, -2.377431, -2.9642296, 8.611328, -1.7009928, 0.92039454, -1.6855608]
Target sample: 25, Prediction:1, Target's Score:[-3.8045194, 11.293388, -2.6267068, -1.0323513, -2.8543727, -4.613277, 6.4719005, -3.299129, 0.5738448, 0.3236469]
Target sample: 31, Prediction:1, Target's Score:[-2.795539, 10.590403, -3.2095711, -1.6376852, -2.8084338, -4.2741637, 6.481944, -2.8571982, 0.24090388, 0.67768526]
Target sample: 37, Prediction:1, Target's Score:[-2.364535, 15.005727, -4.212054, -2.730456, -3.3333397, -4.5459375, 2.9024472, -3.292968, 1.598372, 1.4231305]
Target sample: 43, Prediction:1, Target's Score:[-2.259516, 8.841383, -3.930033, -1.4032506, -2.6701012, -3.469505, 5.7836413, -2.2412646, 2.0903933, -0.36987796]
Target sample: 49, Prediction:1, Target's Score:[-3.368674, 9.333054, -2.5511189, -1.3816215, -2.588577, -3.9798892, 8.59711, -2.6303988, 0.38104475, -1.4055929]
Target sample: 55, Prediction:6, Target's Score:[-3.6159146, 7.953899, -2.8312647, -0.7745845, -2.3011537, -3.8543482, 8.677891, -3.1016052, 0.13732302, 0.09194158]
Target sample: 61, Prediction:6, Target's Score:[-3.496976, 7.6325526, -3.6328464, -0.28231177, -1.8752404, -3.526758, 8.280853, -2.6136215, 1.0892969, -1.1954708]
Target sample: 67, Prediction:1, Target's Score:[-3.4829736, 10.672988, -3.1373858, -1.1362407, -2.6876273, -4.558912, 6.388374, -2.7139978, 1.0308118, 0.0398322]
Target sample: 73, Prediction:1, Target's Score:[-2.4265134, 11.81862, -4.027716, -1.6797936, -3.339774, -4.365113, 5.2071366, -3.2197382, 0.38932747, 2.0716205]
Target sample: 79, Prediction:1, Target's Score:[-2.5958796, 12.672652, -4.5266733, -1.9633942, -3.5531166, -4.49465, 4.23264, -2.8835325, 1.6988305, 1.8519216]
Target sample: 85, Prediction:1, Target's Score:[-2.6448636, 14.151578, -4.1514874, -1.7741086, -3.4388804, -4.432539, 2.4339466, -2.6554527, 3.0062513, -0.05644195]
Target sample: 91, Prediction:1, Target's Score:[-2.675673, 9.208282, -3.2397673, -1.5320209, -2.8236673, -1.6790087, 6.39578, -2.8917334, -0.5101261, 0.13654731]
Current ATTACK acc on target samples: 25.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 07:20:55 Epoch 59, Val iteration 0, acc 93.400 (93.400)
2021-06-11 07:21:16 Epoch 59, Val iteration 19, acc 93.800 (92.980)
* Prec: 92.98000106811523
Per class accuracy =  [0.96470093 0.96378142 0.88858122 0.81101875 0.95358994 0.90180666
 0.94708645 0.94958135 0.96197701 0.95727027]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 6, 6, 1, 1, 6, 6, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6
ATTACK acc: 27.63157894736842
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  770
poison index =  1708
poison index =  1698
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 07:21:20, Val iteration 0, acc 92.600 (92.600)
2021-06-11 07:21:25, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 07:21:27, Epoch 0, Iteration 7, loss 0.359 (0.365), acc 88.462 (89.200)
2021-06-11 07:21:55, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-2.8047595, 8.095603, -0.4814302, -1.1553593, -2.4170797, -1.7581792, 6.992133, -3.114879, -2.5770042, -0.5134243]
Target sample: 7, Prediction:6, Target's Score:[-1.3590126, 7.0041213, -0.19458914, 1.3290043, -3.6898234, -2.6472473, 9.940221, -6.1789384, -3.4632022, -0.4892615]
Target sample: 13, Prediction:6, Target's Score:[-1.8679534, 8.973772, -1.8079182, -1.8288174, -4.8589087, -1.2961755, 9.401641, -6.9034095, -2.8888385, 3.3529336]
Target sample: 19, Prediction:1, Target's Score:[-3.3313825, 11.6521845, -5.689284, 2.8197472, -4.4431033, -2.5104127, 6.526864, -4.260527, 0.5422203, -0.9940552]
Target sample: 25, Prediction:6, Target's Score:[-3.5742118, 4.815575, -0.80351806, 2.6072562, -1.9192963, -3.6988807, 9.027134, -4.9302797, -2.10274, 0.8236966]
Target sample: 31, Prediction:6, Target's Score:[-1.8927155, 9.567728, -2.753246, 1.1751711, -6.3826313, -2.1187358, 13.807429, -7.8156376, -4.5717387, 1.2503659]
Target sample: 37, Prediction:1, Target's Score:[-1.3097453, 10.209507, -2.4302711, -0.8558601, 0.005343429, -3.0007622, 3.1371777, -4.330857, -3.5309074, 2.4267535]
Target sample: 43, Prediction:1, Target's Score:[-1.0658348, 10.958184, -2.214384, 0.9155736, 3.1021814, -4.562951, 0.47944602, -4.029521, -3.2772312, 0.0666723]
Target sample: 49, Prediction:6, Target's Score:[-2.2607136, 9.737714, 0.35570458, 0.16761315, -5.517677, -2.6943295, 11.339009, -5.941657, -1.9594002, -2.9561565]
Target sample: 55, Prediction:6, Target's Score:[-1.9932914, 7.325646, -1.3871524, -0.5193623, -3.8119314, -3.1643975, 11.543318, -4.3973618, -3.4785378, 0.1187112]
Target sample: 61, Prediction:6, Target's Score:[-3.3942194, 5.821843, -1.9274013, 1.9623466, -0.5092702, -2.3763323, 9.522742, -5.2114563, -1.6450628, -1.9926788]
Target sample: 67, Prediction:6, Target's Score:[-2.554268, 6.96863, -1.4088206, 0.016112298, -3.0242712, -3.611118, 12.696368, -4.6150894, -2.027347, -2.1991227]
Target sample: 73, Prediction:1, Target's Score:[-0.83995676, 11.261436, -2.8658502, 0.034411103, -4.6967034, -2.9639165, 9.381994, -5.1235676, -2.9176834, -0.9787141]
Target sample: 79, Prediction:6, Target's Score:[-2.6817584, 6.8855257, -1.0188868, 1.2962537, 0.5063049, -2.8737788, 6.9750714, -5.1733775, -4.17216, 0.5393542]
Target sample: 85, Prediction:1, Target's Score:[-0.2405608, 9.677394, 0.19716322, 1.0915751, -2.5726364, -3.6344275, 1.6960515, -2.1297045, -4.2992926, 0.52981454]
Target sample: 91, Prediction:6, Target's Score:[-2.214316, 8.413772, -2.1747422, -0.43312734, -4.378816, -1.4349542, 9.05169, -5.45897, -3.7168334, 2.5968668]
Current ATTACK acc on target samples: 62.500
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 07:22:23 Epoch 59, Val iteration 0, acc 89.600 (89.600)
2021-06-11 07:22:29 Epoch 59, Val iteration 19, acc 90.400 (89.310)
* Prec: 89.31000137329102
Per class accuracy =  [0.91639388 0.92074952 0.84312474 0.83170807 0.884169   0.82892835
 0.93598986 0.89071718 0.93197967 0.94349478]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 6, 1, 6, 6, 6, 6, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 1, 1, 1, 6, 1, 6, 1, 1, 1, 1, 6, 1, 1, 1, 6, 1, 1, 1, 6, 1, 1, 1, 1, 6, 6, 1
ATTACK acc: 42.10526315789474
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  770
poison index =  1708
poison index =  1698
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 07:22:36, Val iteration 0, acc 96.200 (96.200)
2021-06-11 07:22:48, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 07:22:55, Epoch 0, Iteration 7, loss 0.580 (0.910), acc 82.692 (76.800)
2021-06-11 07:24:05, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.8572314, 7.944494, -3.545335, -1.6763207, -2.4877462, -3.3198543, 9.3771715, -2.5400333, -1.1404747, 0.27967945]
Target sample: 7, Prediction:6, Target's Score:[-2.6397192, 6.554873, -2.7464855, -1.6068108, -2.741292, -2.7825298, 7.811028, -2.7233605, -2.6511831, 3.545842]
Target sample: 13, Prediction:6, Target's Score:[-3.547023, 7.3226695, -2.6082408, -1.6713644, -2.2191317, -2.569711, 10.265568, -2.974291, -1.498952, -0.46456376]
Target sample: 19, Prediction:6, Target's Score:[-4.074503, 5.4749656, -2.4422889, -2.8203933, -2.9427364, -1.0649781, 9.360561, -2.675535, 3.2080147, -1.9861729]
Target sample: 25, Prediction:1, Target's Score:[-3.4624631, 9.531636, -3.5210576, -1.3139294, -2.4600194, -2.442713, 9.226382, -3.1956062, -1.7707032, -0.5614078]
Target sample: 31, Prediction:6, Target's Score:[-3.437159, 4.7219253, -1.5020247, -1.31942, -2.4869301, -2.7272518, 10.514144, -2.8452032, -1.9842352, 1.1022737]
Target sample: 37, Prediction:6, Target's Score:[-2.3605444, 8.388312, -3.5203075, -2.415103, -2.0920525, -3.8236372, 9.270708, -2.784307, -1.9494599, 1.3181485]
Target sample: 43, Prediction:6, Target's Score:[-2.1740606, 6.813523, -3.6926932, -2.3962338, -2.2663162, -3.5792518, 8.060634, -2.9886034, -1.8899297, 4.133252]
Target sample: 49, Prediction:6, Target's Score:[-3.9334896, 8.779292, -2.9366713, -2.1587965, -2.7266815, -3.196623, 11.389542, -2.5707672, -1.7780149, -0.829249]
Target sample: 55, Prediction:6, Target's Score:[-3.5139163, 3.1619835, -3.20472, -2.1166432, -2.4988418, -1.998675, 13.976345, -2.39346, -1.134069, -0.22689606]
Target sample: 61, Prediction:6, Target's Score:[-3.7692258, 2.7790384, -2.7572997, -1.6815706, -1.7759748, -1.9103835, 12.972898, -1.9688622, 1.3105315, -3.1386502]
Target sample: 67, Prediction:6, Target's Score:[-3.3972604, 8.310996, -2.822608, -2.7297943, -3.247486, -2.3500445, 11.552711, -2.7882235, -1.9670285, -0.5197426]
Target sample: 73, Prediction:6, Target's Score:[-2.646003, 6.448558, -2.014517, -2.057017, -2.622301, -2.9360256, 9.997743, -1.946976, -2.3481078, 0.16277252]
Target sample: 79, Prediction:6, Target's Score:[-2.1996136, 7.2273326, -3.4016826, -2.3536818, -1.8331171, -4.0052495, 8.905086, -2.418327, -2.305089, 2.415073]
Target sample: 85, Prediction:6, Target's Score:[-2.0797684, 6.9845533, -2.790483, -1.8393945, -1.0070604, -3.4139545, 7.3375344, -2.3932774, -1.4217387, 0.6513051]
Target sample: 91, Prediction:6, Target's Score:[-3.2491167, 4.707615, -3.3791342, -2.1247644, -2.6720896, -2.8963935, 10.930345, -3.0335016, -2.789713, 4.5344095]
Current ATTACK acc on target samples: 93.750
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 07:25:14 Epoch 59, Val iteration 0, acc 93.000 (93.000)
2021-06-11 07:25:27 Epoch 59, Val iteration 19, acc 94.000 (92.600)
* Prec: 92.60000190734863
Per class accuracy =  [0.94487574 0.94797629 0.88903736 0.89201686 0.94540711 0.89724352
 0.91504538 0.93065708 0.94573495 0.95197887]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 1, 1, 1, 1, 6, 1, 1, 1, 6, 6, 6, 6, 6, 1, 6, 1, 6, 6, 6, 6
ATTACK acc: 80.26315789473684
--------
------SUMMARY------
TIME ELAPSED (mins): 25
TARGET INDEX: 11
ResNet50 18.75 17.105263157894736 95.46000137329102 89.05000076293945
DPN92 25.0 27.63157894736842 95.50000267028808 92.98000106811523
MobileNetV2 62.5 42.10526315789474 91.22000160217286 89.31000137329102
GoogLeNet 93.75 80.26315789473684 95.41000213623047 92.60000190734863
True False False False False
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 119 images of target 12
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=False, nearest=True, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=12, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/12/target-num-20
torch.Size([200, 1, 3, 32, 32]) torch.Size([20, 3, 32, 32])
Selected nearest neighbors: [1212, 1088, 723, 1698, 1708]
Selected base image indices: [1212, 1088, 723, 1698, 1708]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115]
# Targets: 20, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 07:26:04 Iteration 0 	 Training Loss: 7.791e-01 	 Loss in Target Net: 1.366e+00	  
tensor(-4.2212e-05, device='cuda:0')
 2021-06-11 07:27:07 Iteration 50 	 Training Loss: 1.699e-01 	 Loss in Target Net: 5.271e-01	  
tensor(0.0073, device='cuda:0')
 2021-06-11 07:28:11 Iteration 100 	 Training Loss: 1.400e-01 	 Loss in Target Net: 4.517e-01	  
tensor(0.0032, device='cuda:0')
 2021-06-11 07:29:16 Iteration 150 	 Training Loss: 1.270e-01 	 Loss in Target Net: 3.903e-01	  
tensor(-0.0054, device='cuda:0')
 2021-06-11 07:30:24 Iteration 200 	 Training Loss: 1.278e-01 	 Loss in Target Net: 4.358e-01	  
tensor(-0.0148, device='cuda:0')
 2021-06-11 07:31:36 Iteration 250 	 Training Loss: 1.212e-01 	 Loss in Target Net: 4.068e-01	  
tensor(-0.0248, device='cuda:0')
 2021-06-11 07:32:42 Iteration 300 	 Training Loss: 1.113e-01 	 Loss in Target Net: 4.407e-01	  
tensor(-0.0346, device='cuda:0')
 2021-06-11 07:33:49 Iteration 350 	 Training Loss: 1.173e-01 	 Loss in Target Net: 4.692e-01	  
tensor(-0.0449, device='cuda:0')
 2021-06-11 07:34:53 Iteration 400 	 Training Loss: 1.106e-01 	 Loss in Target Net: 4.549e-01	  
tensor(-0.0523, device='cuda:0')
 2021-06-11 07:35:58 Iteration 450 	 Training Loss: 1.039e-01 	 Loss in Target Net: 4.683e-01	  
tensor(-0.0576, device='cuda:0')
 2021-06-11 07:37:04 Iteration 500 	 Training Loss: 1.084e-01 	 Loss in Target Net: 4.719e-01	  
tensor(-0.0616, device='cuda:0')
 2021-06-11 07:38:10 Iteration 550 	 Training Loss: 1.081e-01 	 Loss in Target Net: 4.156e-01	  
tensor(-0.0653, device='cuda:0')
 2021-06-11 07:39:18 Iteration 600 	 Training Loss: 1.212e-01 	 Loss in Target Net: 4.530e-01	  
tensor(-0.0706, device='cuda:0')
 2021-06-11 07:40:25 Iteration 650 	 Training Loss: 1.057e-01 	 Loss in Target Net: 4.228e-01	  
tensor(-0.0749, device='cuda:0')
 2021-06-11 07:41:31 Iteration 700 	 Training Loss: 1.077e-01 	 Loss in Target Net: 4.142e-01	  
tensor(-0.0764, device='cuda:0')
 2021-06-11 07:42:42 Iteration 750 	 Training Loss: 1.055e-01 	 Loss in Target Net: 4.181e-01	  
tensor(-0.0782, device='cuda:0')
 2021-06-11 07:43:49 Iteration 800 	 Training Loss: 1.075e-01 	 Loss in Target Net: 3.944e-01	  
tensor(-0.0795, device='cuda:0')
 2021-06-11 07:44:57 Iteration 850 	 Training Loss: 1.077e-01 	 Loss in Target Net: 3.865e-01	  
tensor(-0.0821, device='cuda:0')
 2021-06-11 07:46:03 Iteration 900 	 Training Loss: 9.921e-02 	 Loss in Target Net: 4.035e-01	  
tensor(-0.0812, device='cuda:0')
 2021-06-11 07:47:10 Iteration 950 	 Training Loss: 1.059e-01 	 Loss in Target Net: 3.833e-01	  
tensor(-0.0812, device='cuda:0')
 2021-06-11 07:48:14 Iteration 999 	 Training Loss: 1.032e-01 	 Loss in Target Net: 4.015e-01	  
tensor(-0.0813, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  723
poison index =  1698
poison index =  1708
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 07:48:19, Val iteration 0, acc 94.200 (94.200)
2021-06-11 07:48:29, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 07:48:35, Epoch 0, Iteration 7, loss 0.244 (0.526), acc 98.077 (88.600)
2021-06-11 07:49:36, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-3.96901, 7.3923383, -1.6890049, -0.80889153, -2.2899315, -2.4779758, 7.179531, -3.5943646, -1.3100175, 1.8294444]
Target sample: 7, Prediction:8, Target's Score:[-1.1922934, -0.26766336, -1.7517873, -2.5665185, -2.6892073, -2.8840835, 6.691638, -2.816432, 7.7512875, -0.011781782]
Target sample: 13, Prediction:6, Target's Score:[-2.734839, 1.5101566, -2.2760344, -2.0808449, -2.0616412, -3.1781206, 8.1568, -2.101431, 5.0817356, -0.03901793]
Target sample: 19, Prediction:6, Target's Score:[-2.959127, -0.041949064, -0.6201827, -2.5247393, -1.264359, -3.469786, 10.009245, -2.6563926, -0.56503505, 4.323273]
Target sample: 25, Prediction:6, Target's Score:[-3.9405868, 2.9147255, -0.53724694, -1.6773866, -2.119967, -3.10062, 8.226008, -3.4857328, 0.25030813, 3.6976397]
Target sample: 31, Prediction:6, Target's Score:[-3.7767808, 1.6886338, -1.2044762, -1.0012128, -2.1397102, -2.8822927, 8.841516, -3.0496843, 0.9220609, 2.8437538]
Target sample: 37, Prediction:1, Target's Score:[-4.3011203, 8.204973, -1.4617552, -0.35744542, -2.079443, -2.0843132, 5.8888674, -2.4633327, -1.4560792, 0.3495382]
Target sample: 43, Prediction:6, Target's Score:[-3.8028908, 2.7251184, -1.2403867, -0.71605396, -1.6269529, -2.4774654, 7.4977913, -2.3880029, 0.6513558, 1.5970746]
Target sample: 49, Prediction:6, Target's Score:[-4.933665, 2.5527248, -1.057698, -1.4818863, -1.7394214, -3.0007339, 9.91257, -3.4792843, -3.1908274, 6.6463275]
Target sample: 55, Prediction:6, Target's Score:[-4.3763494, 1.5309422, 0.024908163, -0.99564147, -1.0855247, -2.876295, 8.712119, -3.650878, -3.0631971, 5.970488]
Target sample: 61, Prediction:6, Target's Score:[-4.097887, 1.9162723, -2.4012294, -1.3904624, -2.3418765, -2.5983238, 9.425748, -3.5043318, -0.61535007, 5.8419952]
Target sample: 67, Prediction:6, Target's Score:[-3.4242458, 3.9089208, -1.7361207, 1.3548874, -3.1482224, -1.9574107, 5.797643, -2.7964902, 1.928221, 0.31714287]
Target sample: 73, Prediction:6, Target's Score:[-3.6812677, 3.740548, -1.4329472, 0.63280714, -1.2710032, -1.753888, 6.496571, -2.4919553, -1.6722975, 1.6403204]
Target sample: 79, Prediction:6, Target's Score:[-4.6305585, 6.2244225, -1.4554543, -0.71718377, -1.9263637, -2.302156, 7.3357697, -3.3134322, -3.6690576, 4.6671915]
Target sample: 85, Prediction:6, Target's Score:[-4.30184, 3.153413, -1.6415082, -0.7678666, -2.0744774, -2.5198035, 7.774934, -3.2724283, -1.3753269, 5.2322154]
Target sample: 91, Prediction:6, Target's Score:[-3.9086268, 2.6346722, -0.15319552, 0.04227884, -1.8739715, -2.603265, 7.7243567, -3.7744095, -1.692867, 3.8176658]
Target sample: 97, Prediction:6, Target's Score:[-4.2860494, 6.087192, -1.2415563, -1.388947, -1.6900966, -2.4337196, 6.7509704, -3.0439398, -1.9609945, 3.421611]
Target sample: 103, Prediction:1, Target's Score:[-4.3191247, 8.563072, -0.485359, -0.3151266, -2.5534925, -2.4811492, 6.18407, -3.43409, -3.1889927, 2.2706213]
Target sample: 109, Prediction:6, Target's Score:[-4.717798, 4.5937037, -1.3100218, -1.9617276, -1.5866323, -2.6296926, 9.148455, -2.343529, -2.1847353, 3.2410247]
Target sample: 115, Prediction:6, Target's Score:[-4.387855, -0.3073289, -1.8917015, -2.7979925, -1.9014775, -4.275793, 11.085692, -3.8800683, 0.5614988, 8.050601]
Current ATTACK acc on target samples: 80.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 07:50:35 Epoch 59, Val iteration 0, acc 92.200 (92.200)
2021-06-11 07:50:45 Epoch 59, Val iteration 19, acc 93.600 (92.280)
* Prec: 92.28000106811524
Per class accuracy =  [0.94313882 0.94867312 0.87655863 0.83194047 0.93539238 0.91229986
 0.96149318 0.9221785  0.94512947 0.95020067]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 8, 8, 8, 8, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 1, 6, 6, 6, 1, 1, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 1, 6, 1, 6, 6, 6, 9, 1, 6, 6, 1, 6, 6, 9, 6, 6, 6, 6, 1, 6, 1, 1, 1, 6, 6, 6, 6, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 73.73737373737374
--------
DPN92
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  723
poison index =  1698
poison index =  1708
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 07:50:57, Val iteration 0, acc 94.800 (94.800)
2021-06-11 07:51:17, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 07:51:31, Epoch 0, Iteration 7, loss 0.267 (0.437), acc 90.385 (90.400)
2021-06-11 07:54:10, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.9502604, 9.7913885, -3.370455, -1.5116156, -3.6202176, -1.8498119, 4.91551, -2.9101176, -0.40615052, 1.4547697]
Target sample: 7, Prediction:1, Target's Score:[-0.10429544, 8.797776, -3.9227176, -2.267905, -3.7183833, -2.974093, 6.007189, -2.6586728, 0.2373639, 1.1250076]
Target sample: 13, Prediction:1, Target's Score:[-1.4328157, 8.100811, -3.2942033, -1.4335272, -3.864622, -2.6636596, 3.7852376, -3.0077918, 2.0384388, 2.223857]
Target sample: 19, Prediction:9, Target's Score:[-1.0797378, 1.1056815, -2.2331848, -1.6731207, -3.3326333, -1.9474062, 7.0177617, -3.0483253, -1.93714, 7.5184083]
Target sample: 25, Prediction:1, Target's Score:[-1.9624306, 9.354573, -3.2538083, -2.5031033, -2.86603, -1.8236003, 4.6308174, -2.1459212, 1.3598295, -0.23652226]
Target sample: 31, Prediction:1, Target's Score:[-0.83456045, 11.154986, -4.0189857, -2.441762, -4.2947674, -2.1959474, 5.4475827, -1.7590979, 0.21091494, -0.63129705]
Target sample: 37, Prediction:1, Target's Score:[-1.8351593, 14.6809025, -3.4732556, -2.8630419, -4.4480886, -2.1380324, 2.9654245, -2.2021043, 0.95286304, -0.89390063]
Target sample: 43, Prediction:1, Target's Score:[-1.2797585, 11.805747, -4.0093083, -2.564623, -3.9601386, -2.9800987, 3.2589586, -2.6197453, 1.0471869, 1.8898294]
Target sample: 49, Prediction:1, Target's Score:[-1.6092018, 10.752149, -3.275898, -2.90297, -4.3848467, -1.3507684, 5.507704, -2.2172847, -1.3440379, 1.4528122]
Target sample: 55, Prediction:1, Target's Score:[-2.2945035, 5.2065144, -1.5803208, -0.7565058, -3.500405, -1.375719, 4.4185085, -3.0640776, -1.5052656, 4.871534]
Target sample: 61, Prediction:9, Target's Score:[-0.9128547, 6.020079, -3.0307817, -2.5423598, -4.3758297, -1.4770051, 5.176434, -3.380173, -1.2951676, 6.2907085]
Target sample: 67, Prediction:1, Target's Score:[-2.335964, 5.645385, -4.040357, -0.79695797, -3.3183966, -2.3771832, 3.3609557, -2.6735096, 3.5993907, 3.3676941]
Target sample: 73, Prediction:1, Target's Score:[0.29737607, 5.7368793, -3.493723, -1.491966, -2.9228027, -1.9124595, 5.125991, -3.1381276, -1.9546525, 4.1796165]
Target sample: 79, Prediction:1, Target's Score:[-1.027042, 12.900234, -4.153373, -2.473642, -4.589312, -2.3571093, 4.972463, -2.4214208, -0.6481902, 0.46183777]
Target sample: 85, Prediction:1, Target's Score:[-0.39996457, 12.620955, -3.489179, -3.0953553, -4.6105413, -1.669471, 2.994153, -2.2173958, 0.17379162, 0.32991922]
Target sample: 91, Prediction:1, Target's Score:[-0.7927806, 10.786451, -3.78218, -2.636524, -4.3070393, -2.1429563, 5.0180387, -3.1043425, -0.3548981, 1.9066089]
Target sample: 97, Prediction:1, Target's Score:[-0.98008734, 12.920721, -3.579041, -3.0954833, -4.104652, -1.6147624, 3.3135583, -1.7182448, 0.56609094, -1.0328119]
Target sample: 103, Prediction:1, Target's Score:[-0.35880676, 12.362586, -3.1357307, -2.406773, -4.148346, -1.6346928, 2.5793557, -2.2227135, -0.35381427, -0.048817407]
Target sample: 109, Prediction:1, Target's Score:[-2.2995167, 12.343257, -3.7617357, -2.2620132, -4.059571, -1.8064926, 5.0527387, -2.7060935, -0.30458114, 0.46401903]
Target sample: 115, Prediction:9, Target's Score:[-0.58256227, 1.467104, -3.2453687, -1.9599253, -4.8282003, -2.1814144, 4.759601, -3.3235085, -1.6826686, 11.980365]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 07:56:44 Epoch 59, Val iteration 0, acc 92.600 (92.600)
2021-06-11 07:57:04 Epoch 59, Val iteration 19, acc 92.800 (92.630)
* Prec: 92.63000183105468
Per class accuracy =  [0.92716771 0.97323486 0.90395207 0.82263789 0.95537251 0.88961042
 0.94049949 0.91329159 0.97476629 0.96149197]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 9, 9, 9, 1, 1, 1, 8, 1, 1, 1, 6, 6, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 9, 9, 9, 9, 6, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 9, 1, 1, 1
ATTACK acc: 6.0606060606060606
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  723
poison index =  1698
poison index =  1708
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 07:57:08, Val iteration 0, acc 92.600 (92.600)
2021-06-11 07:57:14, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 07:57:16, Epoch 0, Iteration 7, loss 0.516 (0.354), acc 80.769 (89.200)
2021-06-11 07:57:44, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.8801394, 9.240395, -4.4265556, 4.0969043, -8.479387, 0.02581925, 8.097506, -8.488455, -2.3930748, 4.5227494]
Target sample: 7, Prediction:6, Target's Score:[-0.69896364, 3.530382, -5.1309576, 1.5713197, -6.3454647, -2.904637, 11.992427, -6.942686, 5.322247, -0.13902359]
Target sample: 13, Prediction:1, Target's Score:[-2.8041897, 10.050004, -4.1653438, 1.2263032, -6.8606567, -1.5123632, 8.0533285, -7.2658978, 3.4068189, 0.19662035]
Target sample: 19, Prediction:6, Target's Score:[-2.1213853, 2.7895727, -4.0696635, 4.351208, -5.368052, -2.1513832, 10.774881, -6.6094623, -1.2641596, 3.900854]
Target sample: 25, Prediction:1, Target's Score:[-0.20736709, 10.337842, -2.5346057, -2.1488984, -5.172258, -2.2331727, 5.812346, -5.4373236, -3.2129056, 5.0556498]
Target sample: 31, Prediction:1, Target's Score:[0.47682887, 9.547912, -5.2804227, -0.27282774, -3.8403816, -2.5606742, 7.0592976, -4.0812645, -0.99562573, 0.20271075]
Target sample: 37, Prediction:1, Target's Score:[-1.8475189, 17.134409, -3.886411, -0.031245053, -7.711979, 0.030116387, 2.4972677, -6.5587997, -0.022656467, 0.79334897]
Target sample: 43, Prediction:1, Target's Score:[0.06369662, 7.1922746, -4.602636, 1.5505567, -5.0196347, -3.134095, 1.2215136, -3.5739496, 3.9635265, 2.62791]
Target sample: 49, Prediction:1, Target's Score:[-2.7637272, 10.12234, -3.3925793, -0.36693686, -6.389771, -0.045078628, 5.3172874, -5.6098757, -2.1682107, 5.599144]
Target sample: 55, Prediction:6, Target's Score:[-1.918007, 6.189282, -4.1465483, 2.085284, -7.548885, -1.0090406, 8.831354, -6.3308363, -2.7765563, 6.875035]
Target sample: 61, Prediction:6, Target's Score:[-0.45954874, 9.244929, -3.9613085, -0.001260221, -7.444326, -1.5811158, 9.722527, -7.167799, 2.1057963, -0.16728397]
Target sample: 67, Prediction:1, Target's Score:[-1.0559164, 8.017439, -4.0983768, -0.47840983, -6.4731364, -2.0464036, 3.0923104, -6.1924815, 5.190714, 4.373694]
Target sample: 73, Prediction:6, Target's Score:[-4.3446074, 7.443297, -3.8027823, 2.324227, -3.5840087, -1.0579377, 9.257596, -6.695636, -0.9077148, 1.6610509]
Target sample: 79, Prediction:1, Target's Score:[0.2258157, 11.061013, -4.214738, -0.13368626, -4.7114644, -0.19194517, 0.16326655, -3.2238193, -4.1358333, 5.4445353]
Target sample: 85, Prediction:1, Target's Score:[1.1912856, 10.620343, -3.6905673, -1.1803968, -6.360706, -2.1699092, 5.5624514, -4.7250423, -2.139603, 3.1557102]
Target sample: 91, Prediction:1, Target's Score:[-0.7530829, 11.677081, -3.4122753, -0.55227363, -5.288589, -0.9253076, 4.6787634, -5.6563635, -2.5096319, 3.0443814]
Target sample: 97, Prediction:1, Target's Score:[-1.9681876, 11.527375, -4.0128403, -0.028876737, -5.6243386, -0.91715425, 4.294224, -5.284043, 0.94858634, 1.3730408]
Target sample: 103, Prediction:1, Target's Score:[2.0966196, 10.727891, -1.6249847, -0.1800883, -3.1670535, -0.6071103, -1.2697103, -5.671599, -1.5757831, 1.6000633]
Target sample: 109, Prediction:1, Target's Score:[-2.9073806, 10.757129, -2.4411569, 0.6057479, -7.2626023, 1.9634309, 4.791606, -6.7223325, -3.1870313, 4.7052026]
Target sample: 115, Prediction:9, Target's Score:[-0.479575, 6.315529, -5.298586, 0.33075976, -7.188585, -1.1971927, 6.0440135, -6.4859314, -0.40308857, 8.632822]
Current ATTACK acc on target samples: 25.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 07:58:11 Epoch 59, Val iteration 0, acc 88.800 (88.800)
2021-06-11 07:58:17 Epoch 59, Val iteration 19, acc 90.200 (89.100)
* Prec: 89.10000228881836
Per class accuracy =  [0.92127634 0.9096142  0.8405517  0.82671169 0.89369128 0.81865934
 0.93107033 0.88911318 0.93006898 0.94599982]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 6, 1, 8, 6, 8, 8, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 6, 6, 1, 1, 1, 6, 6, 6, 6, 8, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1
ATTACK acc: 11.11111111111111
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  723
poison index =  1698
poison index =  1708
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 07:58:25, Val iteration 0, acc 96.200 (96.200)
2021-06-11 07:58:37, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 07:58:43, Epoch 0, Iteration 7, loss 0.771 (0.966), acc 75.000 (77.400)
2021-06-11 07:59:54, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-3.3886876, 13.20854, -2.279142, 1.9564829, -4.8476353, -4.6535153, 2.258098, -2.5204961, -2.2024543, 2.4539557]
Target sample: 7, Prediction:6, Target's Score:[1.0400609, 2.9401653, -1.6117587, -2.3736959, -3.8035238, -4.271489, 8.388697, -3.3551822, -0.5298164, 3.5684423]
Target sample: 13, Prediction:6, Target's Score:[-2.2146494, 6.115233, -1.6772993, -0.901519, -3.9054263, -4.169452, 8.052842, -3.1836743, 2.1271336, -0.2616365]
Target sample: 19, Prediction:6, Target's Score:[-1.3403087, -0.06344943, -0.6840514, -2.4219434, -4.6200004, -4.8278704, 11.232179, -3.0326562, -4.1874204, 9.9415865]
Target sample: 25, Prediction:6, Target's Score:[-2.0759735, 5.712653, -0.021115657, -1.7813113, -3.9181361, -3.913439, 5.7606926, -3.0595014, -2.2501564, 5.552425]
Target sample: 31, Prediction:6, Target's Score:[-1.2268876, 2.8476949, -2.8390565, -0.88210374, -4.168638, -4.3382225, 10.0871315, -3.9921672, -2.3752902, 6.864971]
Target sample: 37, Prediction:1, Target's Score:[-2.551121, 11.986901, -1.7429502, -0.73845947, -3.6426141, -4.9660153, 5.0260477, -3.0486507, -1.3244851, 0.9853737]
Target sample: 43, Prediction:6, Target's Score:[-1.8301198, 4.84224, -1.6213876, 0.38800108, -3.2494707, -4.813581, 4.8473, -3.0895932, 1.5218309, 3.0065682]
Target sample: 49, Prediction:6, Target's Score:[-2.8674157, 5.0783563, -0.58328986, -0.89259523, -3.7705338, -4.0812964, 7.1974397, -3.397996, -3.0106027, 6.324297]
Target sample: 55, Prediction:9, Target's Score:[-3.088246, 2.3904767, 2.564355, -1.2119192, -4.1707454, -3.9095504, 5.220198, -3.3616593, -4.334903, 9.93414]
Target sample: 61, Prediction:1, Target's Score:[-2.6390872, 8.679579, -2.7446556, -2.5425324, -4.306846, -5.0034194, 6.2733417, -3.3748534, -2.74007, 8.396446]
Target sample: 67, Prediction:1, Target's Score:[-1.5834534, 13.589916, -3.873513, -0.7425893, -4.297659, -4.9067473, 3.479363, -3.4650295, -0.94808185, 2.7331364]
Target sample: 73, Prediction:9, Target's Score:[-1.2793187, 3.262411, -0.98273116, 0.2799514, -4.107496, -4.1216817, 5.2978735, -2.2547746, -3.4158103, 7.320945]
Target sample: 79, Prediction:1, Target's Score:[-2.0930202, 7.2418923, -2.0443742, -0.6011054, -4.644907, -3.9261057, 5.1978188, -2.2873104, -3.8335655, 6.9815197]
Target sample: 85, Prediction:1, Target's Score:[-1.097693, 6.199799, -3.4386978, 2.7511857, -3.7520852, -4.098529, 2.8417523, -3.631917, -1.9485348, 6.1656494]
Target sample: 91, Prediction:9, Target's Score:[-0.71246725, 3.6609356, -2.0218866, 2.539053, -2.8375587, -4.6837587, 4.5013623, -3.8548882, -2.8139296, 6.216564]
Target sample: 97, Prediction:1, Target's Score:[-1.5435029, 8.945371, -1.1808264, 2.0347326, -2.5240605, -4.6791472, 1.413376, -3.08796, -2.2389317, 2.858049]
Target sample: 103, Prediction:1, Target's Score:[-1.3734317, 11.633643, -2.803629, 0.22080004, -4.2318125, -3.1711636, 2.2493184, -3.058858, -2.3151793, 2.836695]
Target sample: 109, Prediction:9, Target's Score:[-2.8629, 4.255362, -1.0748606, -0.57509065, -3.4076564, -5.5044656, 5.2226133, -3.3335228, -3.7418113, 11.038873]
Target sample: 115, Prediction:9, Target's Score:[-0.85328156, -1.4457252, -2.408221, -3.2471309, -3.1933167, -6.0633492, 7.5248814, -4.3744617, -4.6473937, 18.743408]
Current ATTACK acc on target samples: 35.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 08:01:03 Epoch 59, Val iteration 0, acc 90.400 (90.400)
2021-06-11 08:01:16 Epoch 59, Val iteration 19, acc 91.600 (91.460)
* Prec: 91.46000175476074
Per class accuracy =  [0.95501634 0.93280099 0.82037023 0.86474377 0.95550173 0.87845471
 0.94571965 0.91625969 0.92799265 0.94596262]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 9, 6, 9, 9, 9, 1, 6, 1, 6, 1, 6, 6, 6, 6, 6, 6, 1, 6, 1, 9, 9, 9, 9, 6, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 6, 6, 1, 6, 9, 9, 9, 6, 9, 9, 6, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 9, 1, 9, 9, 9, 9, 9, 9, 1, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 6, 9, 1, 6, 9, 1, 1
ATTACK acc: 18.181818181818183
--------
------SUMMARY------
TIME ELAPSED (mins): 22
TARGET INDEX: 12
ResNet50 80.0 73.73737373737374 95.46000137329102 92.28000106811524
DPN92 0.0 6.0606060606060606 95.50000267028808 92.63000183105468
MobileNetV2 25.0 11.11111111111111 91.22000160217286 89.10000228881836
GoogLeNet 35.0 18.181818181818183 95.41000213623047 91.46000175476074
True False False False True
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 119 images of target 12
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=True, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=12, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/12/target-num-20
torch.Size([200, 1, 3, 32, 32]) torch.Size([20, 3, 32, 32])
Selected nearest neighbors: [1212, 1088, 723, 1698, 1708]
Selected base image indices: [1212, 1088, 723, 1698, 1708]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115]
# Targets: 20, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 08:01:55 Iteration 0 	 Training Loss: 7.287e-01 	 Loss in Target Net: 7.472e-01	  
tensor(-0.0010, device='cuda:0')
 2021-06-11 08:03:08 Iteration 50 	 Training Loss: 3.070e-01 	 Loss in Target Net: 3.485e-01	  
tensor(-0.0222, device='cuda:0')
 2021-06-11 08:04:20 Iteration 100 	 Training Loss: 2.569e-01 	 Loss in Target Net: 3.024e-01	  
tensor(-0.0520, device='cuda:0')
 2021-06-11 08:05:31 Iteration 150 	 Training Loss: 2.396e-01 	 Loss in Target Net: 2.843e-01	  
tensor(-0.0700, device='cuda:0')
 2021-06-11 08:06:41 Iteration 200 	 Training Loss: 2.292e-01 	 Loss in Target Net: 2.720e-01	  
tensor(-0.0785, device='cuda:0')
 2021-06-11 08:07:52 Iteration 250 	 Training Loss: 2.268e-01 	 Loss in Target Net: 2.755e-01	  
tensor(-0.0819, device='cuda:0')
 2021-06-11 08:09:02 Iteration 300 	 Training Loss: 2.240e-01 	 Loss in Target Net: 2.715e-01	  
tensor(-0.0843, device='cuda:0')
 2021-06-11 08:10:12 Iteration 350 	 Training Loss: 2.237e-01 	 Loss in Target Net: 2.771e-01	  
tensor(-0.0843, device='cuda:0')
 2021-06-11 08:11:23 Iteration 400 	 Training Loss: 2.245e-01 	 Loss in Target Net: 2.745e-01	  
tensor(-0.0855, device='cuda:0')
 2021-06-11 08:12:35 Iteration 450 	 Training Loss: 2.254e-01 	 Loss in Target Net: 2.695e-01	  
tensor(-0.0849, device='cuda:0')
 2021-06-11 08:13:46 Iteration 500 	 Training Loss: 2.212e-01 	 Loss in Target Net: 2.773e-01	  
tensor(-0.0871, device='cuda:0')
 2021-06-11 08:14:55 Iteration 550 	 Training Loss: 2.226e-01 	 Loss in Target Net: 2.844e-01	  
tensor(-0.0864, device='cuda:0')
 2021-06-11 08:16:07 Iteration 600 	 Training Loss: 2.204e-01 	 Loss in Target Net: 2.839e-01	  
tensor(-0.0827, device='cuda:0')
 2021-06-11 08:17:17 Iteration 650 	 Training Loss: 2.256e-01 	 Loss in Target Net: 2.763e-01	  
tensor(-0.0829, device='cuda:0')
 2021-06-11 08:18:31 Iteration 700 	 Training Loss: 2.278e-01 	 Loss in Target Net: 3.060e-01	  
tensor(-0.0830, device='cuda:0')
 2021-06-11 08:19:42 Iteration 750 	 Training Loss: 2.200e-01 	 Loss in Target Net: 2.964e-01	  
tensor(-0.0838, device='cuda:0')
 2021-06-11 08:20:56 Iteration 800 	 Training Loss: 2.194e-01 	 Loss in Target Net: 2.890e-01	  
tensor(-0.0845, device='cuda:0')
 2021-06-11 08:22:09 Iteration 850 	 Training Loss: 2.292e-01 	 Loss in Target Net: 2.794e-01	  
tensor(-0.0848, device='cuda:0')
 2021-06-11 08:23:22 Iteration 900 	 Training Loss: 2.222e-01 	 Loss in Target Net: 2.879e-01	  
tensor(-0.0842, device='cuda:0')
 2021-06-11 08:24:33 Iteration 950 	 Training Loss: 2.197e-01 	 Loss in Target Net: 2.791e-01	  
tensor(-0.0839, device='cuda:0')
 2021-06-11 08:25:45 Iteration 999 	 Training Loss: 2.187e-01 	 Loss in Target Net: 2.752e-01	  
tensor(-0.0851, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  723
poison index =  1698
poison index =  1708
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 08:25:50, Val iteration 0, acc 94.200 (94.200)
2021-06-11 08:26:00, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 08:26:05, Epoch 0, Iteration 7, loss 0.200 (0.421), acc 96.154 (91.800)
2021-06-11 08:27:05, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.5710595, 6.0312185, -0.29441836, -1.661249, -2.306079, -3.8065252, 8.492008, -3.2971864, 0.22212698, -0.778654]
Target sample: 7, Prediction:6, Target's Score:[-1.0624142, 2.3763554, -2.276423, -4.023965, -2.9332626, -4.6940036, 10.455054, -2.8319328, 5.7890396, -0.750849]
Target sample: 13, Prediction:6, Target's Score:[-0.30181107, 4.5265646, -2.733762, -3.7482214, -2.8982382, -4.5104136, 10.003897, -2.668512, 3.7284405, -1.367054]
Target sample: 19, Prediction:6, Target's Score:[-0.7424189, 0.8800622, -0.90208125, -2.9880083, -1.9098834, -4.321263, 9.728029, -2.3362072, 0.99525374, 1.6533924]
Target sample: 25, Prediction:6, Target's Score:[-2.0514576, 3.4996755, -0.6148184, -3.1429784, -2.4512887, -4.0041475, 10.079572, -2.7286916, 0.8664009, 0.59562033]
Target sample: 31, Prediction:6, Target's Score:[-1.4654746, 4.5953984, -1.0557313, -1.9155315, -2.7497067, -3.7419057, 9.547728, -2.364751, -0.2399794, -0.56550425]
Target sample: 37, Prediction:1, Target's Score:[-0.84919465, 12.514317, -1.2261766, -2.1174343, -3.4945195, -3.9588282, 5.9079165, -2.6093469, -0.3376121, -3.8707283]
Target sample: 43, Prediction:6, Target's Score:[-0.4557379, 6.9707665, -1.1900667, -2.6701243, -2.870517, -4.0196834, 7.2888246, -2.1875744, 0.9645365, -1.8246367]
Target sample: 49, Prediction:6, Target's Score:[-2.6291966, 3.3151956, 0.13458788, -3.060299, -2.4550452, -4.091655, 8.765489, -2.184079, -1.8271873, 4.072162]
Target sample: 55, Prediction:9, Target's Score:[-3.0576768, -0.51100737, 1.0228956, -2.4879982, -1.427322, -3.3996418, 6.7320957, -2.8539703, -1.8285123, 7.8574615]
Target sample: 61, Prediction:6, Target's Score:[-2.223076, 1.8649812, -1.5405499, -3.4174376, -2.3467932, -4.0449386, 10.577845, -3.0280004, 0.28377, 3.922217]
Target sample: 67, Prediction:1, Target's Score:[0.6707481, 10.070973, -1.6540184, -2.3857079, -3.8050518, -4.0410833, 6.185491, -2.6647527, 0.941009, -3.3400493]
Target sample: 73, Prediction:1, Target's Score:[-0.2995131, 8.376959, -1.3291495, -2.4456532, -2.88816, -3.5350122, 6.666857, -2.2355723, -0.9098936, -1.4124385]
Target sample: 79, Prediction:1, Target's Score:[-1.7485871, 7.63482, -0.35803023, -1.9987342, -2.2785296, -3.1973343, 7.340734, -2.4454968, -1.9256464, -1.0176024]
Target sample: 85, Prediction:6, Target's Score:[-2.5622563, 2.8108382, -0.06818214, -1.8441421, -2.1550078, -3.4791744, 8.176973, -2.4923809, -0.5218171, 2.1829333]
Target sample: 91, Prediction:6, Target's Score:[-2.3229084, 3.288839, -0.13751556, -2.014129, -2.317692, -3.893744, 8.79219, -2.656468, -0.2681341, 1.5776173]
Target sample: 97, Prediction:1, Target's Score:[-0.78103805, 11.173026, -0.9546729, -1.9985931, -3.246618, -3.7995481, 5.788663, -2.6396377, -0.62262154, -2.9477284]
Target sample: 103, Prediction:1, Target's Score:[-0.95179796, 10.334758, -0.29055616, -2.085516, -3.1556623, -3.8569882, 6.7889423, -2.719495, -1.4896437, -2.5917163]
Target sample: 109, Prediction:6, Target's Score:[-2.5088024, 5.4677415, -0.098366804, -2.5368974, -2.1773968, -3.7498112, 8.53242, -2.329161, -1.425366, 0.8531891]
Target sample: 115, Prediction:6, Target's Score:[-3.050635, -1.377394, -1.3410403, -4.1081176, -2.702773, -5.4316435, 11.120056, -3.2845879, 1.1904731, 9.049568]
Current ATTACK acc on target samples: 65.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 08:28:04 Epoch 59, Val iteration 0, acc 89.400 (89.400)
2021-06-11 08:28:15 Epoch 59, Val iteration 19, acc 91.400 (90.200)
* Prec: 90.20000114440919
Per class accuracy =  [0.9427457  0.92837496 0.86312114 0.81742407 0.85035827 0.86482567
 0.95713418 0.91040815 0.94555932 0.94193693]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 8, 8, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 6, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 6, 1, 6, 6, 6, 1, 6, 6, 6, 6, 1, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 1
ATTACK acc: 62.62626262626262
--------
DPN92
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  723
poison index =  1698
poison index =  1708
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 08:28:26, Val iteration 0, acc 94.800 (94.800)
2021-06-11 08:28:47, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 08:29:01, Epoch 0, Iteration 7, loss 0.189 (0.407), acc 98.077 (92.200)
2021-06-11 08:31:39, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.7378062, 6.096482, -2.081591, -2.0549831, -1.4751979, -2.690533, 6.3082676, -1.5593808, -1.5420699, 1.0951971]
Target sample: 7, Prediction:6, Target's Score:[0.98150074, 3.7555697, -2.976269, -2.2599378, -1.6601626, -3.6609974, 8.028454, -0.77341795, -1.0230687, -0.026572857]
Target sample: 13, Prediction:6, Target's Score:[0.7254413, 2.1375086, -2.812288, -1.4305594, -2.982381, -3.3849313, 6.7627926, -0.46903104, 0.8502871, 0.9300878]
Target sample: 19, Prediction:6, Target's Score:[-0.956288, 0.45306236, -1.4725609, -1.7366996, -2.3917506, -3.1606994, 8.365671, -1.9095126, -2.124693, 5.299528]
Target sample: 25, Prediction:1, Target's Score:[-1.4168575, 5.9337506, -2.1435642, -2.5804787, -1.5250864, -2.1102796, 5.5500164, -1.6163226, -1.0218631, 1.2803164]
Target sample: 31, Prediction:6, Target's Score:[-0.23424587, 5.2079024, -2.7680242, -2.4906845, -2.8554928, -2.4672217, 8.061529, -0.6174372, -2.2133794, 0.7566665]
Target sample: 37, Prediction:1, Target's Score:[-1.247339, 10.203547, -2.8700235, -2.7143464, -2.5197318, -1.8998065, 2.512188, -0.6138066, -0.7046796, 0.25379494]
Target sample: 43, Prediction:1, Target's Score:[-0.59170747, 7.641011, -3.4160984, -3.035161, -2.7018182, -2.476424, 3.476687, -0.94195056, -0.40650797, 2.831665]
Target sample: 49, Prediction:1, Target's Score:[-1.237262, 6.8179884, -2.1110866, -2.8600116, -3.0080044, -2.2412145, 6.7457027, -0.15549174, -2.3985453, 0.8434748]
Target sample: 55, Prediction:6, Target's Score:[-1.2886976, 4.616618, -1.2657722, -2.5092046, -1.9610809, -2.1600711, 5.989042, -1.4808047, -2.5803864, 2.9773657]
Target sample: 61, Prediction:9, Target's Score:[0.6453053, 3.4622614, -2.7512906, -2.6036277, -3.6340213, -2.592366, 5.6648946, -1.9472917, -2.2601247, 6.423301]
Target sample: 67, Prediction:1, Target's Score:[-0.48001626, 5.087431, -3.6809561, -0.7165249, -2.5803938, -2.6257305, 3.8393724, -0.45130205, 0.82894784, 1.1206646]
Target sample: 73, Prediction:6, Target's Score:[1.8578974, 2.0722291, -2.8543441, -2.802946, -0.95534414, -3.0131595, 6.857665, 0.6748612, -2.3482494, 0.85708374]
Target sample: 79, Prediction:1, Target's Score:[-0.37797132, 8.017406, -3.2133265, -2.411578, -3.0800052, -1.8708144, 4.815258, -0.8741212, -2.483192, 1.8699133]
Target sample: 85, Prediction:1, Target's Score:[-0.10294316, 7.8392725, -2.6971152, -2.7614536, -2.8350031, -1.6735755, 4.1338162, -1.0240504, -1.6407014, 1.1309139]
Target sample: 91, Prediction:1, Target's Score:[0.043014046, 7.70416, -3.2428112, -2.8563082, -3.1006594, -1.9603435, 5.0161686, -1.7048213, -1.827048, 2.3194752]
Target sample: 97, Prediction:1, Target's Score:[-0.697614, 9.113377, -3.1565225, -2.94857, -2.160009, -2.1905797, 3.748286, -0.15952148, -0.8173627, -0.32650417]
Target sample: 103, Prediction:1, Target's Score:[0.53205657, 8.083007, -3.0375898, -2.8209066, -2.6730266, -1.9497787, 4.033437, -0.35279465, -2.101624, 0.675437]
Target sample: 109, Prediction:1, Target's Score:[-1.6633275, 7.5403514, -2.7750058, -2.4397953, -2.2332106, -1.9471444, 5.8923354, -1.0961778, -2.0409362, 1.1426967]
Target sample: 115, Prediction:9, Target's Score:[0.13320312, 1.1984891, -2.454456, -2.2650712, -4.7425923, -2.3746388, 5.723856, -2.0431292, -2.6512792, 9.909712]
Current ATTACK acc on target samples: 35.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 08:34:13 Epoch 59, Val iteration 0, acc 92.400 (92.400)
2021-06-11 08:34:33 Epoch 59, Val iteration 19, acc 92.600 (92.860)
* Prec: 92.8600009918213
Per class accuracy =  [0.92787709 0.96018337 0.91722939 0.87443567 0.95624933 0.8751134
 0.94579569 0.93516115 0.94473958 0.94783803]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 9, 6, 1, 1, 6, 8, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 9, 6, 6, 6, 6, 0, 6, 1, 6, 1, 1, 1, 6, 1, 1, 6, 6, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 6, 6, 6, 6, 1
ATTACK acc: 36.36363636363637
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  723
poison index =  1698
poison index =  1708
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 08:34:37, Val iteration 0, acc 92.600 (92.600)
2021-06-11 08:34:43, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 08:34:45, Epoch 0, Iteration 7, loss 0.286 (0.380), acc 86.538 (90.000)
2021-06-11 08:35:13, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.8231938, 8.327172, -4.3887963, 3.778509, -7.934543, 0.14360164, 9.090919, -8.419527, -2.02276, 3.5018601]
Target sample: 7, Prediction:6, Target's Score:[-0.4511404, 3.3161402, -5.3729835, 1.7061996, -6.131332, -3.0200458, 11.953892, -6.8448687, 5.4059315, -0.35584304]
Target sample: 13, Prediction:1, Target's Score:[-2.6234722, 9.856208, -4.4971914, 0.95852035, -6.556567, -1.5033358, 8.078333, -7.274134, 3.9946902, -0.1523758]
Target sample: 19, Prediction:6, Target's Score:[-1.6647133, 1.6972804, -3.9691308, 4.071685, -4.462849, -2.1601508, 11.452904, -6.575506, -1.8723338, 3.6683397]
Target sample: 25, Prediction:1, Target's Score:[-0.54442847, 8.279648, -2.4303873, -2.1455305, -3.9308398, -1.8297166, 6.8172398, -5.074096, -3.3392186, 4.4613767]
Target sample: 31, Prediction:1, Target's Score:[0.44913137, 9.339559, -5.2358794, -0.47506398, -3.4019747, -2.997656, 7.573006, -4.3717804, -0.72045845, 0.10769732]
Target sample: 37, Prediction:1, Target's Score:[-1.629508, 17.833778, -4.31258, -1.02975, -7.394326, -0.2641388, 2.426816, -6.403144, 0.46734393, 0.68183625]
Target sample: 43, Prediction:1, Target's Score:[-0.17693125, 7.029835, -4.848703, 0.7836329, -3.8105567, -3.446824, 1.96351, -3.5599928, 3.7083166, 2.6160226]
Target sample: 49, Prediction:1, Target's Score:[-2.7657871, 8.332132, -3.3830214, 0.037331477, -5.45546, 0.041289654, 6.8495364, -5.830396, -2.1729286, 4.6154175]
Target sample: 55, Prediction:6, Target's Score:[-1.7976953, 4.7356706, -4.135422, 2.2397668, -6.89148, -1.3840413, 9.019853, -5.9825172, -2.6043189, 7.0205173]
Target sample: 61, Prediction:6, Target's Score:[-0.9002908, 9.255742, -4.341583, -0.23072968, -7.2020297, -1.6670965, 10.507679, -7.3616376, 2.5354395, -0.3224469]
Target sample: 67, Prediction:1, Target's Score:[-1.3248188, 7.6361437, -4.113996, -0.62384653, -6.2588687, -1.9639345, 3.749931, -6.0327163, 5.3654027, 3.8504193]
Target sample: 73, Prediction:6, Target's Score:[-4.2481723, 5.8211985, -3.6956716, 1.8133928, -2.2513967, -1.4622171, 9.6996765, -6.529575, -0.76818305, 1.8801508]
Target sample: 79, Prediction:1, Target's Score:[-0.6902932, 9.545425, -4.302891, -0.121004894, -4.282408, -0.21679313, 2.5508566, -3.2114525, -4.1931953, 5.1833057]
Target sample: 85, Prediction:1, Target's Score:[0.48816207, 9.509339, -3.8111098, -1.0855436, -5.7800913, -1.9503549, 7.261445, -4.694683, -2.0058734, 2.3269224]
Target sample: 91, Prediction:1, Target's Score:[-1.0336047, 10.162258, -3.4740567, -0.67075926, -4.2966905, -0.8375216, 6.3137097, -5.78299, -2.4446476, 2.3544886]
Target sample: 97, Prediction:1, Target's Score:[-1.9233328, 11.519314, -4.2421074, -0.5933046, -4.877208, -0.9909976, 4.417802, -4.950558, 0.78150326, 1.1518068]
Target sample: 103, Prediction:1, Target's Score:[1.2931967, 9.628445, -1.960313, -0.590131, -2.167587, -0.62365544, 0.9785083, -5.388878, -2.0614507, 1.1871128]
Target sample: 109, Prediction:1, Target's Score:[-2.6126127, 9.621211, -2.2396019, 0.14311536, -6.6558824, 1.1329266, 6.4612074, -6.6822104, -3.081395, 4.176483]
Target sample: 115, Prediction:9, Target's Score:[-0.4279849, 5.3590484, -5.170154, 0.52946705, -6.4523854, -1.3045739, 7.279597, -6.2995524, -0.93697506, 7.6636214]
Current ATTACK acc on target samples: 30.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 08:35:40 Epoch 59, Val iteration 0, acc 88.800 (88.800)
2021-06-11 08:35:46 Epoch 59, Val iteration 19, acc 90.800 (89.450)
* Prec: 89.45000190734864
Per class accuracy =  [0.92472132 0.91588957 0.84221894 0.82425914 0.90110048 0.82619142
 0.93459177 0.89411249 0.93168259 0.94708678]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 6, 1, 8, 6, 8, 8, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 1, 1, 1, 1, 1, 1, 9, 9, 6, 6, 1, 1, 9, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1
ATTACK acc: 23.232323232323232
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  723
poison index =  1698
poison index =  1708
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 08:35:54, Val iteration 0, acc 96.200 (96.200)
2021-06-11 08:36:06, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 08:36:13, Epoch 0, Iteration 7, loss 0.558 (0.531), acc 82.692 (87.800)
2021-06-11 08:37:24, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-3.2117822, 10.727037, -3.7541966, -0.34590912, -3.3321836, -2.8545852, 6.0034175, -3.1646721, -1.2222043, 1.2817514]
Target sample: 7, Prediction:6, Target's Score:[0.8934199, 2.0592215, -3.599163, -2.2060735, -2.6573355, -3.8173783, 7.617732, -3.0774572, 1.5399607, 3.3674493]
Target sample: 13, Prediction:6, Target's Score:[-2.6908472, 4.6852193, -1.9885608, -2.422629, -2.668623, -3.2319307, 9.22101, -3.5640228, 1.5273212, 1.236653]
Target sample: 19, Prediction:6, Target's Score:[-2.5421343, 4.8729873, -3.5178046, -3.1716816, -3.6541395, -3.2222133, 12.51672, -2.5159178, -2.3006668, 3.6416187]
Target sample: 25, Prediction:1, Target's Score:[-1.9684757, 7.2667994, -1.636119, -2.0179946, -2.7919776, -2.5896158, 6.6520605, -3.0775821, -1.1001402, 1.3751738]
Target sample: 31, Prediction:6, Target's Score:[-2.22268, 7.4298854, -3.5962398, -2.0553203, -3.5388107, -3.191384, 11.850999, -2.7392244, -0.71042025, -1.1275386]
Target sample: 37, Prediction:1, Target's Score:[-3.2370584, 11.830282, -2.9049926, -2.992256, -2.646068, -3.3188078, 6.9207606, -1.872215, -1.4171827, -0.2502356]
Target sample: 43, Prediction:1, Target's Score:[-1.8269283, 6.846268, -3.2749317, -2.9905503, -2.3833191, -3.397406, 6.2536936, -2.0796423, 2.4020844, 0.5587094]
Target sample: 49, Prediction:6, Target's Score:[-3.4329965, 7.9896502, -2.2597914, -2.3269076, -2.9824932, -2.8011467, 10.273195, -2.5529644, -2.0215387, 0.2120987]
Target sample: 55, Prediction:6, Target's Score:[-3.1121879, 4.0925665, -0.6998369, -1.4477719, -3.510336, -2.770555, 7.951591, -2.0542839, -2.0353658, 3.6847277]
Target sample: 61, Prediction:1, Target's Score:[-2.0309246, 8.427088, -3.8904545, -1.8216128, -3.260866, -3.6377017, 8.287343, -3.140215, -1.0439063, 2.2307951]
Target sample: 67, Prediction:1, Target's Score:[-1.3851175, 8.358396, -2.9247015, 0.46669894, -2.028357, -4.3179636, 4.105165, -3.8803444, 0.86183035, 0.88402975]
Target sample: 73, Prediction:6, Target's Score:[-1.0447737, 1.1608942, -1.8721, -0.6767436, -2.0718617, -1.9955766, 5.500486, -1.4647999, -2.3057122, 4.8786883]
Target sample: 79, Prediction:6, Target's Score:[-2.6365182, 6.198402, -3.472395, -1.8447379, -3.6567001, -1.9925086, 9.210934, -1.1288786, -2.2595522, 1.6820098]
Target sample: 85, Prediction:1, Target's Score:[-0.5389617, 8.527204, -4.114815, -0.46946728, -3.2963376, -2.5166168, 5.7623744, -2.7864764, -1.0329186, 0.5866504]
Target sample: 91, Prediction:6, Target's Score:[-2.715934, 4.9091725, -1.793524, -0.35380763, -2.9876008, -2.5356767, 8.336798, -2.3386545, -2.0703044, 1.6610694]
Target sample: 97, Prediction:1, Target's Score:[-2.7927418, 11.245283, -3.1756535, -1.127384, -2.1296875, -2.1218371, 5.1174946, -2.6827526, -1.7883228, -0.4224725]
Target sample: 103, Prediction:1, Target's Score:[-0.4269539, 8.37978, -1.4103307, -0.50908303, -3.4782476, -1.7896346, 5.3644147, -2.9778454, -2.1379342, -0.900767]
Target sample: 109, Prediction:6, Target's Score:[-2.4909127, 5.339097, -2.1006472, -0.16123922, -3.6325083, -3.531865, 7.0436587, -3.0214825, -2.8244689, 5.5146]
Target sample: 115, Prediction:9, Target's Score:[-0.5220704, 0.47462952, -4.6025743, -2.737403, -3.8790631, -5.017325, 8.933532, -4.0913234, -2.7421904, 14.360347]
Current ATTACK acc on target samples: 50.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 08:38:33 Epoch 59, Val iteration 0, acc 92.400 (92.400)
2021-06-11 08:38:45 Epoch 59, Val iteration 19, acc 93.600 (92.620)
* Prec: 92.62000160217285
Per class accuracy =  [0.95992009 0.9564812  0.89043072 0.86374982 0.95462983 0.87545125
 0.95703554 0.93617802 0.93053061 0.93828094]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 6, 9, 9, 9, 1, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 1, 6, 1, 6, 1, 1, 1, 1, 1, 1, 6, 1, 1, 6, 1, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 6, 1, 1, 6, 6, 1, 6, 9, 9, 6, 1
ATTACK acc: 47.474747474747474
--------
------SUMMARY------
TIME ELAPSED (mins): 24
TARGET INDEX: 12
ResNet50 65.0 62.62626262626262 95.46000137329102 90.20000114440919
DPN92 35.0 36.36363636363637 95.50000267028808 92.8600009918213
MobileNetV2 30.0 23.232323232323232 91.22000160217286 89.45000190734864
GoogLeNet 50.0 47.474747474747474 95.41000213623047 92.62000160217285
True False False False False
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 142 images of target 14
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133, 139]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=False, nearest=True, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=14, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/14/target-num-20
torch.Size([200, 1, 3, 32, 32]) torch.Size([24, 3, 32, 32])
Selected nearest neighbors: [1088, 1212, 600, 770, 1698]
Selected base image indices: [1088, 1212, 600, 770, 1698]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133, 139]
# Targets: 24, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 08:39:22 Iteration 0 	 Training Loss: 8.673e-01 	 Loss in Target Net: 1.111e+00	  
tensor(-3.7665e-05, device='cuda:0')
 2021-06-11 08:40:25 Iteration 50 	 Training Loss: 2.441e-01 	 Loss in Target Net: 6.790e-01	  
tensor(0.0026, device='cuda:0')
 2021-06-11 08:41:29 Iteration 100 	 Training Loss: 2.363e-01 	 Loss in Target Net: 5.634e-01	  
tensor(0.0053, device='cuda:0')
 2021-06-11 08:42:33 Iteration 150 	 Training Loss: 2.115e-01 	 Loss in Target Net: 4.963e-01	  
tensor(0.0068, device='cuda:0')
 2021-06-11 08:43:37 Iteration 200 	 Training Loss: 2.097e-01 	 Loss in Target Net: 5.426e-01	  
tensor(0.0086, device='cuda:0')
 2021-06-11 08:44:39 Iteration 250 	 Training Loss: 2.048e-01 	 Loss in Target Net: 4.921e-01	  
tensor(0.0100, device='cuda:0')
 2021-06-11 08:45:41 Iteration 300 	 Training Loss: 1.913e-01 	 Loss in Target Net: 4.861e-01	  
tensor(0.0121, device='cuda:0')
 2021-06-11 08:46:44 Iteration 350 	 Training Loss: 1.974e-01 	 Loss in Target Net: 5.280e-01	  
tensor(0.0138, device='cuda:0')
 2021-06-11 08:47:46 Iteration 400 	 Training Loss: 1.975e-01 	 Loss in Target Net: 5.453e-01	  
tensor(0.0143, device='cuda:0')
 2021-06-11 08:48:48 Iteration 450 	 Training Loss: 1.968e-01 	 Loss in Target Net: 4.918e-01	  
tensor(0.0143, device='cuda:0')
 2021-06-11 08:49:49 Iteration 500 	 Training Loss: 1.809e-01 	 Loss in Target Net: 4.909e-01	  
tensor(0.0157, device='cuda:0')
 2021-06-11 08:50:51 Iteration 550 	 Training Loss: 1.909e-01 	 Loss in Target Net: 4.989e-01	  
tensor(0.0153, device='cuda:0')
 2021-06-11 08:51:54 Iteration 600 	 Training Loss: 1.897e-01 	 Loss in Target Net: 5.187e-01	  
tensor(0.0162, device='cuda:0')
 2021-06-11 08:52:56 Iteration 650 	 Training Loss: 1.826e-01 	 Loss in Target Net: 4.644e-01	  
tensor(0.0159, device='cuda:0')
 2021-06-11 08:53:59 Iteration 700 	 Training Loss: 1.847e-01 	 Loss in Target Net: 4.696e-01	  
tensor(0.0175, device='cuda:0')
 2021-06-11 08:55:06 Iteration 750 	 Training Loss: 1.867e-01 	 Loss in Target Net: 5.004e-01	  
tensor(0.0171, device='cuda:0')
 2021-06-11 08:56:09 Iteration 800 	 Training Loss: 1.829e-01 	 Loss in Target Net: 5.417e-01	  
tensor(0.0177, device='cuda:0')
 2021-06-11 08:57:18 Iteration 850 	 Training Loss: 1.815e-01 	 Loss in Target Net: 4.493e-01	  
tensor(0.0185, device='cuda:0')
 2021-06-11 08:58:21 Iteration 900 	 Training Loss: 1.820e-01 	 Loss in Target Net: 4.706e-01	  
tensor(0.0194, device='cuda:0')
 2021-06-11 08:59:25 Iteration 950 	 Training Loss: 1.838e-01 	 Loss in Target Net: 4.409e-01	  
tensor(0.0190, device='cuda:0')
 2021-06-11 09:00:26 Iteration 999 	 Training Loss: 1.817e-01 	 Loss in Target Net: 4.356e-01	  
tensor(0.0207, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  600
poison index =  770
poison index =  1698
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 09:00:32, Val iteration 0, acc 94.200 (94.200)
2021-06-11 09:00:41, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 09:00:47, Epoch 0, Iteration 7, loss 0.695 (0.492), acc 82.692 (90.200)
2021-06-11 09:01:47, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-0.7041, 0.33410275, -1.151999, -1.318393, -1.290383, -2.0012963, 7.6456213, -1.0504206, 0.07116205, -0.43796116]
Target sample: 7, Prediction:6, Target's Score:[-1.0793641, 1.0840528, -1.3142838, -0.39026573, -2.3374062, -1.8032062, 7.742285, -1.1289229, -0.48149434, -0.19506946]
Target sample: 13, Prediction:6, Target's Score:[-1.3043071, 0.16399978, -0.6811546, -1.0330673, -1.9345956, -2.0000973, 8.519752, -1.1465707, 0.29506597, -0.7822406]
Target sample: 19, Prediction:6, Target's Score:[-0.13358712, -0.005261399, -1.9494307, -0.1503711, -2.4197783, -1.7542373, 7.2111993, -1.6094843, 1.8147815, -0.90727234]
Target sample: 25, Prediction:6, Target's Score:[-0.040763788, 4.0030665, -1.0904833, -1.4880431, -2.5479078, -2.4143715, 7.088524, -1.6425211, -1.045835, -0.7361949]
Target sample: 31, Prediction:6, Target's Score:[-1.4335771, 3.696023, -0.6211142, -1.3566698, -2.2105906, -2.1978362, 8.208399, -1.6132756, -1.5160053, -0.8720165]
Target sample: 37, Prediction:6, Target's Score:[1.1689513, -0.08903742, -1.9313664, 0.7770873, -2.5680296, -1.5137254, 7.421733, -1.8861417, 0.34718078, -1.6160305]
Target sample: 43, Prediction:6, Target's Score:[-1.6085147, 1.432618, -1.2967057, -0.9409402, -1.9947441, -1.9009004, 9.374469, -1.4095247, -0.28214872, -1.272409]
Target sample: 49, Prediction:6, Target's Score:[-2.6950557, 1.5881233, -1.2989713, -0.8623885, -2.101353, -2.1346068, 9.858721, -1.7372853, -0.16813621, -0.34997237]
Target sample: 55, Prediction:6, Target's Score:[-1.3134805, 3.8644867, -1.3954574, -1.0895842, -2.476473, -2.12078, 7.9532557, -1.6635677, -1.0235403, -0.64727014]
Target sample: 61, Prediction:6, Target's Score:[-1.6095948, 2.9799106, -0.8458833, -1.2808322, -1.815564, -2.1713395, 8.46679, -1.8809744, -1.181395, -0.5725134]
Target sample: 67, Prediction:6, Target's Score:[-1.2632194, 2.8817506, 0.70173013, -1.8534485, -2.4616938, -2.6629019, 7.180042, -2.2174768, -2.087638, 1.8703383]
Target sample: 73, Prediction:6, Target's Score:[-1.0864615, 2.7088797, -0.41620344, -1.151722, -1.9634113, -2.2086663, 7.457015, -1.7187629, -1.2551422, -0.27957538]
Target sample: 79, Prediction:6, Target's Score:[-1.4343385, 1.763676, -0.69038856, -0.87979454, -1.7509255, -1.9023782, 8.353931, -1.0350368, -1.008882, -1.3261156]
Target sample: 85, Prediction:6, Target's Score:[-0.6791973, 2.245746, -1.1545789, -0.99947923, -2.3165126, -2.222468, 7.2212224, -1.4497871, -0.9220995, 0.36919078]
Target sample: 91, Prediction:6, Target's Score:[-0.064342834, 1.691705, -0.5781551, -0.44694024, -2.205744, -2.2938664, 8.115169, -2.0483792, -1.0059141, -1.0652469]
Target sample: 97, Prediction:6, Target's Score:[-0.54193926, 2.3328445, -1.1597327, -1.4329994, -2.312617, -2.106047, 8.065862, -1.7852569, -0.6854523, -0.27777973]
Target sample: 103, Prediction:6, Target's Score:[-0.1914162, 1.9257863, -1.8203195, -0.25678185, -2.519835, -2.1258254, 7.185018, -2.4541197, 1.4629006, -1.1158295]
Target sample: 109, Prediction:6, Target's Score:[-0.59335864, 2.0090806, -2.0822296, -0.76214135, -2.532339, -2.0885553, 9.252607, -1.8355094, 0.22304478, -1.4826547]
Target sample: 115, Prediction:6, Target's Score:[-1.1514747, 1.2250775, -1.554244, -0.4690947, -1.8640438, -2.3266659, 9.41553, -1.8609686, 0.53077066, -1.8428918]
Target sample: 121, Prediction:6, Target's Score:[1.7339936, 3.053614, -1.8798491, -1.0412183, -2.5009053, -2.2709167, 6.263289, -1.5248787, -0.416346, -1.3192526]
Target sample: 127, Prediction:6, Target's Score:[-0.73595566, 2.9865992, -0.94189316, -1.0572549, -2.638126, -2.3172076, 7.211699, -1.8610524, -2.073641, 1.5218507]
Target sample: 133, Prediction:6, Target's Score:[-0.7758667, 4.1812277, -1.6250733, -0.8244717, -2.3369396, -2.035646, 6.577012, -2.028822, -1.8555822, 0.80988884]
Target sample: 139, Prediction:6, Target's Score:[0.03582927, -0.31767744, -0.8137032, -0.9447074, -2.2382424, -1.8719493, 7.0888066, -0.80618626, -0.16041765, 0.12983143]
Current ATTACK acc on target samples: 100.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 09:02:46 Epoch 59, Val iteration 0, acc 89.200 (89.200)
2021-06-11 09:02:56 Epoch 59, Val iteration 19, acc 89.800 (90.360)
* Prec: 90.36000137329101
Per class accuracy =  [0.92526054 0.93258892 0.83408594 0.81898653 0.92944208 0.7953081
 0.984858   0.89654858 0.95861428 0.95688893]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 0, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 95.76271186440678
--------
DPN92
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  600
poison index =  770
poison index =  1698
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 09:03:08, Val iteration 0, acc 94.800 (94.800)
2021-06-11 09:03:28, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 09:03:42, Epoch 0, Iteration 7, loss 0.450 (0.397), acc 88.462 (90.400)
2021-06-11 09:06:21, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:8, Target's Score:[-0.91102314, -1.4950126, -3.8416555, 1.0702707, -0.9176468, -3.4129574, 4.660454, -0.8892207, 5.6254826, 0.31425676]
Target sample: 7, Prediction:6, Target's Score:[-1.7850509, -1.5865718, -3.1268148, 0.44531497, -0.82367873, -3.2407396, 8.067336, -1.5700773, 4.6370277, -0.80136293]
Target sample: 13, Prediction:6, Target's Score:[-1.1203322, -1.0098486, -3.6897476, 0.6902141, -1.2631536, -3.634985, 6.1458244, -0.9062213, 5.414435, -0.41749272]
Target sample: 19, Prediction:8, Target's Score:[-1.4530884, 0.26178, -3.6725976, 0.31679013, -1.368808, -3.0344892, 4.91553, -0.6722298, 5.4189444, -0.5034217]
Target sample: 25, Prediction:6, Target's Score:[-1.4511358, 0.38769352, -2.9539874, 0.4960995, -0.7679257, -3.6754963, 6.2745104, -1.2038049, 4.5224433, -1.4041526]
Target sample: 31, Prediction:6, Target's Score:[-1.673408, 3.2627883, -2.9700863, 0.3923166, -1.2319607, -3.2024243, 5.1792307, -1.2164236, 3.5215974, -1.8267847]
Target sample: 37, Prediction:6, Target's Score:[-2.1070416, -0.83443403, -2.0862656, 4.8285184, -0.30589578, -2.6290925, 6.6424403, -1.7596812, 1.1730471, -2.7240384]
Target sample: 43, Prediction:6, Target's Score:[-1.2660624, -1.2485564, -3.296465, 2.50519, -0.6112311, -1.5247759, 5.4719853, -1.2247239, 1.9709469, -0.5998899]
Target sample: 49, Prediction:6, Target's Score:[-2.6297247, -1.7540253, -2.5581636, 4.861906, -1.5441203, -2.4490476, 6.719888, -0.8845724, 2.4608226, -2.0266519]
Target sample: 55, Prediction:8, Target's Score:[0.41707176, -1.3470944, -3.402823, 0.755616, -1.3822006, -2.3745444, 2.7822073, -0.9879894, 4.9277864, 0.8096339]
Target sample: 61, Prediction:3, Target's Score:[-2.0558548, 0.82083595, -1.547184, 3.0875554, 1.0386579, -0.84002817, 1.1452416, -2.5802145, 1.9827126, -0.83956695]
Target sample: 67, Prediction:1, Target's Score:[-1.390995, 6.443349, -2.306722, 1.2191616, -1.5896348, -2.5710447, 2.4706397, -1.8013258, 1.9197177, -2.1450393]
Target sample: 73, Prediction:6, Target's Score:[-1.7388448, -0.7223813, -3.5130405, 0.037756305, -0.8910971, -3.6214104, 6.6686587, -1.3368306, 5.697794, -0.3538486]
Target sample: 79, Prediction:6, Target's Score:[-1.9957603, -1.1169355, -3.1870563, 0.027307946, -1.2484689, -2.8685627, 7.043099, -1.8441825, 5.7592487, -0.3425491]
Target sample: 85, Prediction:6, Target's Score:[-1.3485317, -1.8177904, -3.423625, 0.19653827, -1.2132658, -3.66011, 7.3953915, -1.2724929, 5.2612987, 0.104261644]
Target sample: 91, Prediction:6, Target's Score:[-2.2063842, 2.3371084, -2.3672884, 2.242683, -0.63350683, -2.5690782, 7.649248, -1.7004037, 1.0726913, -3.6058881]
Target sample: 97, Prediction:6, Target's Score:[-2.3765178, 0.09312954, -2.7820148, 2.1186488, -0.41250682, -2.5791225, 7.246451, -2.0344758, 2.9152236, -1.9853587]
Target sample: 103, Prediction:6, Target's Score:[-2.4514608, -1.434769, -0.8921356, 3.0728421, -0.6666542, -2.0460963, 8.896155, -2.8619263, 0.9307775, -2.334577]
Target sample: 109, Prediction:6, Target's Score:[-2.877779, -1.8262495, -2.6230934, 0.99364114, -0.5234331, -2.0275862, 13.001163, -3.1915903, 1.7342736, -2.4324691]
Target sample: 115, Prediction:3, Target's Score:[-2.7358258, -1.3746481, -0.9258224, 6.7048874, 1.7882582, -0.77175295, 0.8041878, -2.091916, 0.91633165, -2.113048]
Target sample: 121, Prediction:6, Target's Score:[-1.6490589, 2.3810377, -2.8985925, 0.2155518, 0.17186858, -1.0528233, 4.35745, -2.7687187, 1.7955232, -0.32657272]
Target sample: 127, Prediction:6, Target's Score:[-2.1739147, 1.5311538, -2.567465, 1.581409, -0.9673571, -2.740346, 6.487871, -1.7826113, 3.084443, -2.233417]
Target sample: 133, Prediction:6, Target's Score:[-0.4643354, -0.29406098, -3.723739, 0.7803265, -1.205365, -3.1474059, 4.8947535, -0.82884926, 4.373805, -0.18802065]
Target sample: 139, Prediction:6, Target's Score:[-0.41859508, -1.8168182, -3.467054, 0.20152526, -1.275128, -3.3528166, 6.8331056, -1.094378, 4.405397, 0.18611547]
Current ATTACK acc on target samples: 75.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 09:08:55 Epoch 59, Val iteration 0, acc 92.400 (92.400)
2021-06-11 09:09:16 Epoch 59, Val iteration 19, acc 92.200 (92.950)
* Prec: 92.9500015258789
Per class accuracy =  [0.95286326 0.96766536 0.9050553  0.83512028 0.95842979 0.88102614
 0.93018698 0.93864369 0.97066182 0.95602801]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 6, 6, 8, 8, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 1, 6, 1, 1, 6, 6, 3, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 8, 8, 8, 8, 3, 1, 1, 1, 1, 1, 6, 6, 6, 8, 6, 6, 8, 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 8, 8, 8, 6, 6, 6, 6, 6
ATTACK acc: 75.42372881355932
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  600
poison index =  770
poison index =  1698
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 09:09:20, Val iteration 0, acc 92.600 (92.600)
2021-06-11 09:09:25, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 09:09:28, Epoch 0, Iteration 7, loss 0.264 (0.356), acc 92.308 (89.400)
2021-06-11 09:09:55, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:9, Target's Score:[-1.7338209, 4.105334, -5.2818894, 4.1489105, -0.8639466, -3.2516146, 2.122255, -3.0506878, -4.609473, 8.558262]
Target sample: 7, Prediction:9, Target's Score:[-0.6074528, 3.39105, -3.1380002, 2.5142617, 0.0966686, -4.0313115, 1.6351293, -2.7096367, -5.716979, 8.711847]
Target sample: 13, Prediction:9, Target's Score:[-0.61777955, 2.7295554, -4.509505, 3.3522482, -0.88965106, -2.7907887, 2.9550962, -1.9800448, -6.8329773, 8.71855]
Target sample: 19, Prediction:9, Target's Score:[-0.68020564, 3.608246, -4.8434815, 1.1374636, 0.0724093, -3.9492948, 3.90757, -2.1392882, -5.50064, 8.518459]
Target sample: 25, Prediction:6, Target's Score:[-1.3166223, 3.6706991, -4.949592, 4.1638646, 0.19250697, -1.5998272, 5.4732814, -3.3891563, -7.0172668, 4.916776]
Target sample: 31, Prediction:1, Target's Score:[-2.0388808, 11.559344, -5.2251453, 2.636294, -3.367805, -1.9456209, 4.2258554, -3.5835829, -7.171179, 5.1324925]
Target sample: 37, Prediction:9, Target's Score:[-1.013785, 6.8510084, -4.55296, 1.6281847, -3.2286766, -0.63794965, 2.3748586, -4.011174, -6.7326846, 9.490076]
Target sample: 43, Prediction:3, Target's Score:[-1.0653892, 3.6501768, -2.3581388, 3.7215157, -0.46939588, -0.9950884, 0.3044659, 2.6698656, -4.8249044, -0.4318393]
Target sample: 49, Prediction:3, Target's Score:[-4.9804273, 3.8069518, -5.983355, 5.465499, -4.2512035, 0.500191, 4.299818, -2.69565, 2.7943013, 1.1845785]
Target sample: 55, Prediction:1, Target's Score:[1.2501738, 5.390359, -5.3906856, 0.29078892, -3.4932234, -0.82802445, 2.6679187, -0.39721984, -2.5192184, 3.1591518]
Target sample: 61, Prediction:1, Target's Score:[-1.0719522, 4.3523793, 0.26892906, 2.3563952, 1.6343944, -2.2384014, 0.74651587, 0.17099723, -5.3770666, -0.62868696]
Target sample: 67, Prediction:1, Target's Score:[-0.45108432, 7.814197, -3.873142, 1.1417893, -0.7211689, -3.8034806, 1.8229498, -2.4080086, -6.516042, 7.186849]
Target sample: 73, Prediction:9, Target's Score:[0.9935691, 3.102058, -3.813867, 2.3925738, 1.3637154, -4.149672, 3.78751, -3.2476797, -6.5684724, 6.2845]
Target sample: 79, Prediction:9, Target's Score:[0.038320813, 6.079991, -4.5181413, 1.156144, -2.0874457, -3.6915252, 5.099113, -3.6029727, -4.932411, 6.585217]
Target sample: 85, Prediction:9, Target's Score:[-2.3536909, 2.7702081, -4.368075, 2.6123996, -1.395816, -3.7294567, 7.4346724, -4.1193104, -5.8590655, 9.120408]
Target sample: 91, Prediction:1, Target's Score:[0.9990416, 10.264015, -2.636319, 4.230538, -3.1589406, -2.517455, 2.1219625, -5.778378, -6.685746, 3.3598652]
Target sample: 97, Prediction:6, Target's Score:[-3.0210717, 4.196797, -6.01892, 4.758788, -1.2087073, -0.19955106, 9.124347, -5.0514193, -6.1942234, 3.7612405]
Target sample: 103, Prediction:1, Target's Score:[-3.462062, 6.077972, -4.424971, 6.0540276, -2.9828646, -0.40466645, 4.3377557, -4.265591, -3.3024073, 2.5396461]
Target sample: 109, Prediction:6, Target's Score:[-3.4497676, 4.520839, -4.9896235, 5.0309033, -5.9545803, 4.100975, 8.292795, -6.903189, -1.418217, 0.911909]
Target sample: 115, Prediction:1, Target's Score:[0.21591438, 6.2238717, -2.3889093, 2.5535746, -3.011946, -0.6311761, 4.1084094, -3.4728377, -5.970814, 2.5373607]
Target sample: 121, Prediction:1, Target's Score:[-0.07299197, 4.055954, -3.7661674, 2.210341, 1.7905084, 0.0009878911, 0.7188412, 0.043843463, -3.9732146, -0.8226792]
Target sample: 127, Prediction:9, Target's Score:[-1.0548109, 6.0896964, -5.9580774, 3.6141071, -2.4761465, -0.6551811, 4.5291047, -4.160224, -6.0170655, 6.2349195]
Target sample: 133, Prediction:9, Target's Score:[-2.1624932, 5.713162, -3.8193607, 3.3732972, 1.1371852, -3.6856847, 2.3781009, -1.4019742, -7.8093696, 6.4903464]
Target sample: 139, Prediction:9, Target's Score:[0.7406449, 2.3227763, -3.307578, 2.552456, -0.084409565, -3.8044198, 1.8333701, -1.6472633, -5.595855, 7.1107955]
Current ATTACK acc on target samples: 12.500
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 09:10:23 Epoch 59, Val iteration 0, acc 89.400 (89.400)
2021-06-11 09:10:29 Epoch 59, Val iteration 19, acc 90.400 (89.360)
* Prec: 89.36000137329101
Per class accuracy =  [0.92793163 0.92570216 0.84080571 0.82606333 0.89567017 0.82032842
 0.92661727 0.88900303 0.93109881 0.94735338]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 1, 9, 9, 9, 3, 9, 6, 1, 1, 1, 1, 1, 6, 1, 9, 1, 9, 9, 6, 9, 9, 3, 1, 9, 9, 1, 3, 6, 9, 9, 1, 1, 9, 9, 9, 3, 6, 9, 1, 9, 9, 9, 9, 9, 1, 6, 9, 9, 9, 9, 1, 6, 9, 9, 1, 9, 9, 6, 6, 1, 9, 1, 1, 1, 1, 6, 6, 6, 9, 6, 6, 1, 6, 6, 6, 6, 6, 6, 1, 9, 1, 1, 6, 6, 6, 6, 3, 1, 6, 9, 6, 1, 1, 9, 1, 1, 9, 9, 9, 9, 9, 9, 9, 9, 9
ATTACK acc: 22.033898305084747
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  600
poison index =  770
poison index =  1698
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 09:10:36, Val iteration 0, acc 96.200 (96.200)
2021-06-11 09:10:48, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 09:10:55, Epoch 0, Iteration 7, loss 0.517 (0.542), acc 82.692 (84.200)
2021-06-11 09:12:06, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[0.6785094, 8.337542, -3.9222534, -1.5608894, -2.6304514, -3.461644, 1.0929255, -2.4711177, 1.9630048, 1.9674668]
Target sample: 7, Prediction:1, Target's Score:[-0.55309933, 6.6300454, -3.4123998, -1.22266, -2.6965618, -3.2349684, 3.5525153, -2.0879552, 2.0983505, 0.9164066]
Target sample: 13, Prediction:1, Target's Score:[1.9306912, 3.3880274, -3.344624, 1.0086769, -2.3378236, -2.8824701, 3.0918112, -2.280258, 0.9001576, 0.5175865]
Target sample: 19, Prediction:1, Target's Score:[0.0664239, 8.554192, -4.057457, -0.62266487, -2.6941504, -3.50654, 1.5991393, -2.1246245, 1.3737948, 1.4017837]
Target sample: 25, Prediction:1, Target's Score:[1.0614651, 3.8981867, -2.7240388, -1.1657517, -0.8254804, -2.8898032, 2.0865657, -2.4406588, 2.9833374, 0.012696197]
Target sample: 31, Prediction:1, Target's Score:[-1.4763567, 11.835836, -3.2413266, -1.4701933, -2.7147665, -3.1880825, 2.540723, -2.3065233, -0.090360016, 0.08995389]
Target sample: 37, Prediction:1, Target's Score:[-0.17692132, 5.5429683, -3.6857266, 1.6470646, -1.7006438, -1.6677303, 3.3541386, -2.9161763, 0.34150344, -0.7497013]
Target sample: 43, Prediction:6, Target's Score:[-1.3992467, 3.5651343, -3.2257004, -0.91253537, -0.40696496, -1.5376177, 6.1282206, -1.3761206, 0.4048418, -1.253954]
Target sample: 49, Prediction:1, Target's Score:[-2.5442579, 6.85871, -3.188161, -0.92979395, 0.032146603, -2.6708941, 4.880677, -1.7272179, 0.9430486, -1.6677718]
Target sample: 55, Prediction:1, Target's Score:[0.20940603, 6.5313134, -2.8843222, -1.9780301, -1.3548795, -1.8384522, 2.3437884, -1.4997567, 0.53705865, -0.07856537]
Target sample: 61, Prediction:1, Target's Score:[-2.6775281, 9.285078, -3.4726527, -0.26790676, -1.8457994, -3.3010864, 4.2105265, -1.6335703, 0.09668335, -0.41346842]
Target sample: 67, Prediction:1, Target's Score:[-1.4692645, 8.749433, -3.2011442, -0.8875855, -2.2808166, -3.038687, 1.5886165, -2.2131968, 1.6956499, 1.0479212]
Target sample: 73, Prediction:1, Target's Score:[0.52864814, 6.3314023, -3.6967738, -1.0997499, -1.8874788, -3.536607, 2.5750766, -2.3586059, 3.0675535, 0.06936412]
Target sample: 79, Prediction:1, Target's Score:[-1.2232821, 8.154979, -3.7135706, -1.062991, -2.5377676, -3.2124693, 3.5087142, -2.4410627, -0.17740801, 2.6947708]
Target sample: 85, Prediction:1, Target's Score:[-0.7279488, 6.079565, -3.6374526, -0.77271175, -2.0472121, -3.2562075, 2.3826814, -2.6628017, 2.0204484, 2.6190379]
Target sample: 91, Prediction:6, Target's Score:[1.1575142, 2.4982674, -2.0494645, 1.8497728, -1.1282037, -2.5168223, 3.401168, -2.5629873, 0.10097659, -0.761441]
Target sample: 97, Prediction:6, Target's Score:[-0.31317994, 4.4056067, -4.767965, -0.45264578, -0.005708531, -2.1828213, 7.7434683, -2.0017092, -0.4796457, -1.9661137]
Target sample: 103, Prediction:1, Target's Score:[-2.5211523, 8.585659, -3.3840196, -0.22304772, -0.43539998, -3.0555196, 4.942065, -2.522975, 0.2542567, -1.6602081]
Target sample: 109, Prediction:6, Target's Score:[-2.205166, 4.86709, -2.7793183, -0.7234105, -1.7994109, -1.7021503, 8.660008, -2.0356572, 0.04806885, -2.3518481]
Target sample: 115, Prediction:3, Target's Score:[-1.3784283, 2.66183, -3.7347393, 4.3699017, -1.018606, -0.89667165, 3.5038943, -2.2797408, 0.079661936, -1.3128281]
Target sample: 121, Prediction:6, Target's Score:[-1.1269207, 3.3270051, -3.1640427, 0.788051, -1.3444116, -1.4416251, 4.3312535, -1.080311, -0.011243554, -0.28732848]
Target sample: 127, Prediction:6, Target's Score:[-0.07127305, 5.1930594, -4.1765184, -0.70758593, -1.7315141, -3.2403405, 5.632974, -2.1850004, 1.1477844, 0.12306856]
Target sample: 133, Prediction:1, Target's Score:[-0.7555473, 6.795263, -3.524482, 0.45260423, -2.4014962, -3.1231039, 2.0294764, -1.1926235, 0.951817, 0.758006]
Target sample: 139, Prediction:0, Target's Score:[3.9492304, 1.8227166, -3.1769829, -0.93383384, -2.1671133, -2.9860914, 1.710361, -2.7125137, 1.4175975, 3.0829666]
Current ATTACK acc on target samples: 25.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 09:13:15 Epoch 59, Val iteration 0, acc 93.400 (93.400)
2021-06-11 09:13:28 Epoch 59, Val iteration 19, acc 92.800 (92.790)
* Prec: 92.7900016784668
Per class accuracy =  [0.9329275  0.96044662 0.88897246 0.8691049  0.96277058 0.87901163
 0.95375404 0.92363909 0.96404909 0.9399431 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 6, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 9, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 1, 6, 1, 1, 1, 6, 1, 6, 1, 1, 6, 6, 6, 6, 1, 6, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 6
ATTACK acc: 26.271186440677965
--------
------SUMMARY------
TIME ELAPSED (mins): 21
TARGET INDEX: 14
ResNet50 100.0 95.76271186440678 95.46000137329102 90.36000137329101
DPN92 75.0 75.42372881355932 95.50000267028808 92.9500015258789
MobileNetV2 12.5 22.033898305084747 91.22000160217286 89.36000137329101
GoogLeNet 25.0 26.271186440677965 95.41000213623047 92.7900016784668
True False False False True
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 142 images of target 14
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133, 139]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=True, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=14, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/14/target-num-20
torch.Size([200, 1, 3, 32, 32]) torch.Size([24, 3, 32, 32])
Selected nearest neighbors: [1088, 1212, 600, 770, 1698]
Selected base image indices: [1088, 1212, 600, 770, 1698]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133, 139]
# Targets: 24, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 09:14:07 Iteration 0 	 Training Loss: 7.838e-01 	 Loss in Target Net: 6.465e-01	  
tensor(-0.0009, device='cuda:0')
 2021-06-11 09:15:18 Iteration 50 	 Training Loss: 3.712e-01 	 Loss in Target Net: 4.349e-01	  
tensor(-0.0171, device='cuda:0')
 2021-06-11 09:16:32 Iteration 100 	 Training Loss: 3.419e-01 	 Loss in Target Net: 3.885e-01	  
tensor(-0.0331, device='cuda:0')
 2021-06-11 09:17:44 Iteration 150 	 Training Loss: 3.241e-01 	 Loss in Target Net: 3.894e-01	  
tensor(-0.0420, device='cuda:0')
 2021-06-11 09:19:01 Iteration 200 	 Training Loss: 3.193e-01 	 Loss in Target Net: 3.663e-01	  
tensor(-0.0479, device='cuda:0')
 2021-06-11 09:20:13 Iteration 250 	 Training Loss: 3.176e-01 	 Loss in Target Net: 3.617e-01	  
tensor(-0.0519, device='cuda:0')
 2021-06-11 09:21:24 Iteration 300 	 Training Loss: 3.125e-01 	 Loss in Target Net: 3.967e-01	  
tensor(-0.0518, device='cuda:0')
 2021-06-11 09:22:35 Iteration 350 	 Training Loss: 3.064e-01 	 Loss in Target Net: 3.641e-01	  
tensor(-0.0557, device='cuda:0')
 2021-06-11 09:23:48 Iteration 400 	 Training Loss: 3.039e-01 	 Loss in Target Net: 3.936e-01	  
tensor(-0.0555, device='cuda:0')
 2021-06-11 09:25:02 Iteration 450 	 Training Loss: 3.057e-01 	 Loss in Target Net: 3.825e-01	  
tensor(-0.0547, device='cuda:0')
 2021-06-11 09:26:14 Iteration 500 	 Training Loss: 3.067e-01 	 Loss in Target Net: 3.949e-01	  
tensor(-0.0555, device='cuda:0')
 2021-06-11 09:27:26 Iteration 550 	 Training Loss: 2.994e-01 	 Loss in Target Net: 3.673e-01	  
tensor(-0.0557, device='cuda:0')
 2021-06-11 09:28:38 Iteration 600 	 Training Loss: 3.031e-01 	 Loss in Target Net: 3.557e-01	  
tensor(-0.0571, device='cuda:0')
 2021-06-11 09:29:50 Iteration 650 	 Training Loss: 3.025e-01 	 Loss in Target Net: 3.283e-01	  
tensor(-0.0575, device='cuda:0')
 2021-06-11 09:31:04 Iteration 700 	 Training Loss: 2.991e-01 	 Loss in Target Net: 3.664e-01	  
tensor(-0.0579, device='cuda:0')
 2021-06-11 09:32:18 Iteration 750 	 Training Loss: 3.004e-01 	 Loss in Target Net: 3.823e-01	  
tensor(-0.0544, device='cuda:0')
 2021-06-11 09:33:32 Iteration 800 	 Training Loss: 3.068e-01 	 Loss in Target Net: 3.793e-01	  
tensor(-0.0539, device='cuda:0')
 2021-06-11 09:34:45 Iteration 850 	 Training Loss: 3.032e-01 	 Loss in Target Net: 3.678e-01	  
tensor(-0.0530, device='cuda:0')
 2021-06-11 09:35:56 Iteration 900 	 Training Loss: 3.006e-01 	 Loss in Target Net: 4.260e-01	  
tensor(-0.0554, device='cuda:0')
 2021-06-11 09:37:09 Iteration 950 	 Training Loss: 3.018e-01 	 Loss in Target Net: 3.503e-01	  
tensor(-0.0555, device='cuda:0')
 2021-06-11 09:38:22 Iteration 999 	 Training Loss: 2.979e-01 	 Loss in Target Net: 3.446e-01	  
tensor(-0.0565, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  600
poison index =  770
poison index =  1698
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 09:38:28, Val iteration 0, acc 94.200 (94.200)
2021-06-11 09:38:37, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 09:38:43, Epoch 0, Iteration 7, loss 0.146 (0.297), acc 96.154 (91.600)
2021-06-11 09:39:43, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-0.63508135, -0.111424774, -1.7747874, -0.7224078, -1.9503747, -2.0406764, 7.0497317, -0.46429428, 2.050139, -1.4896624]
Target sample: 7, Prediction:6, Target's Score:[-1.4955057, -0.30510423, -1.9471277, 0.009812003, -2.10525, -2.1964984, 8.317527, -0.6407634, 1.7626348, -1.5124195]
Target sample: 13, Prediction:6, Target's Score:[-0.3690046, -1.4301777, -1.3251637, -0.24749897, -1.4716883, -2.2708256, 6.5744977, -0.82419086, 2.5171301, -1.2359694]
Target sample: 19, Prediction:8, Target's Score:[-1.1806885, 0.43309867, -2.0170748, -0.27893496, -2.0078382, -1.6878662, 4.7379417, -1.517342, 5.409791, -1.9394584]
Target sample: 25, Prediction:1, Target's Score:[-1.0708927, 7.38705, -1.7827508, -1.6919289, -3.4740312, -3.01839, 5.2049704, -1.5494355, 2.6234546, -2.7133844]
Target sample: 31, Prediction:1, Target's Score:[-2.2418573, 7.854857, -2.0223503, -1.9438245, -3.622267, -3.4746106, 7.794023, -1.0340128, 1.5969299, -3.0403476]
Target sample: 37, Prediction:6, Target's Score:[-0.56338954, 4.0399747, -2.15856, 0.2209435, -3.119316, -2.1902905, 7.52335, -0.7826531, 0.691897, -3.7647157]
Target sample: 43, Prediction:6, Target's Score:[2.0611694, -1.0993879, -1.9517815, 0.9075546, -1.7366408, -0.87210363, 4.809147, 0.37191054, -0.9418425, -1.6029775]
Target sample: 49, Prediction:6, Target's Score:[-2.2344017, 2.6114097, -1.9517319, -0.78136814, -2.5866327, -2.3822658, 8.071037, -1.1269376, 3.175625, -2.9026563]
Target sample: 55, Prediction:6, Target's Score:[-1.2401407, 2.6432843, -2.321041, -1.0266165, -2.8520648, -1.7255661, 7.2550535, 0.17710367, 1.315347, -2.3232856]
Target sample: 61, Prediction:1, Target's Score:[-1.2595578, 6.2982135, -1.4751381, -1.49825, -2.6572092, -2.6447275, 5.5877805, -1.1803715, 0.8918554, -2.1567364]
Target sample: 67, Prediction:1, Target's Score:[-1.4459668, 5.670809, -0.9673523, -1.4794041, -2.4571288, -2.9280832, 4.179478, -2.2923331, 0.30594572, 1.3165053]
Target sample: 73, Prediction:6, Target's Score:[-1.5196217, 0.37514654, -1.4547412, -0.4838199, -1.886185, -2.4048698, 8.381446, -0.7199925, 1.302744, -1.7053628]
Target sample: 79, Prediction:6, Target's Score:[-1.837247, 0.38549292, -1.8529403, -0.3509157, -2.2045877, -2.2732053, 8.756674, -0.3206249, 2.0060585, -2.42177]
Target sample: 85, Prediction:6, Target's Score:[-1.6437241, 0.49093056, -1.7662052, -0.63883203, -2.1146052, -2.4503286, 7.7302785, -0.95352554, 2.8786588, -1.6334845]
Target sample: 91, Prediction:6, Target's Score:[-1.4177841, 1.3255049, -2.1378658, -0.16707842, -3.0633636, -2.319649, 10.645404, -0.3783678, 0.7801603, -3.4055455]
Target sample: 97, Prediction:6, Target's Score:[-1.6173334, 0.76245815, -2.7765334, -0.32495224, -3.1272836, -2.5300496, 12.020039, -0.339471, 0.8364999, -3.062211]
Target sample: 103, Prediction:6, Target's Score:[-1.6277821, 1.3951945, -2.3618746, -0.00057500787, -3.03932, -2.5184045, 11.618566, -0.79492974, 0.9005814, -3.7230077]
Target sample: 109, Prediction:6, Target's Score:[-2.0477207, 1.2310548, -2.360305, -0.4755603, -2.9732091, -2.102864, 11.851832, -0.77306485, 0.878865, -3.3852332]
Target sample: 115, Prediction:6, Target's Score:[-0.38970032, 1.7815869, -2.5590708, 1.0392709, -2.8313978, -1.4809428, 7.4191885, -0.90284204, 0.5752221, -2.7446039]
Target sample: 121, Prediction:6, Target's Score:[-1.6365962, 5.281085, -2.1960022, -0.7307507, -3.4811046, -2.1910164, 7.4081454, -1.1835467, 1.8100321, -3.1831095]
Target sample: 127, Prediction:6, Target's Score:[-1.1444304, 1.3068724, -1.919057, -0.43491745, -2.8216257, -2.4711356, 9.738566, -0.2121969, 0.02245925, -2.1999576]
Target sample: 133, Prediction:6, Target's Score:[0.61047393, 1.1809961, -1.0150466, -0.25011447, -1.9022416, -2.0254269, 5.155885, -0.98145723, 0.5951728, -1.4389225]
Target sample: 139, Prediction:6, Target's Score:[-0.9972862, -1.154499, -1.8363014, -0.8094122, -1.9482404, -2.5491757, 7.837046, -0.58314025, 1.7984184, 0.12978947]
Current ATTACK acc on target samples: 79.167
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 09:40:42 Epoch 59, Val iteration 0, acc 91.400 (91.400)
2021-06-11 09:40:53 Epoch 59, Val iteration 19, acc 91.400 (91.040)
* Prec: 91.0400016784668
Per class accuracy =  [0.93480239 0.96166663 0.86534086 0.80504018 0.92545783 0.89279128
 0.93627414 0.91219667 0.94954145 0.92128734]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 85.59322033898304
--------
DPN92
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  600
poison index =  770
poison index =  1698
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 09:41:05, Val iteration 0, acc 94.800 (94.800)
2021-06-11 09:41:25, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 09:41:39, Epoch 0, Iteration 7, loss 0.292 (0.415), acc 92.308 (90.800)
2021-06-11 09:44:17, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.5968407, 1.6649439, -4.366792, 0.15770884, 0.08096079, -1.7452127, 4.301612, -1.2725474, 3.1722345, -0.14929031]
Target sample: 7, Prediction:6, Target's Score:[-2.635662, 2.491848, -3.5839732, -0.027258933, -0.6498867, -1.6311837, 7.7622046, -2.5603774, 3.054393, -1.952472]
Target sample: 13, Prediction:6, Target's Score:[-2.5194468, 3.1325078, -3.977913, 0.06220323, -1.1268021, -1.7067639, 6.355038, -2.2422223, 3.8516269, -1.5660818]
Target sample: 19, Prediction:1, Target's Score:[-2.6273758, 6.4301853, -4.376736, -0.64651984, -1.9177289, -1.4249376, 5.230168, -2.7398129, 2.8072715, -0.4167448]
Target sample: 25, Prediction:6, Target's Score:[-1.9584383, 3.8886304, -3.7055504, -0.090577915, -0.34010106, -2.1553953, 5.9153585, -2.3531797, 2.905563, -1.8197538]
Target sample: 31, Prediction:6, Target's Score:[-2.5455856, 3.9397922, -3.4687777, 0.046698846, -0.4305918, -1.4120163, 6.779696, -2.7560768, 1.3969591, -1.2578496]
Target sample: 37, Prediction:6, Target's Score:[-2.7038867, 0.4005605, -2.4963439, 2.5338154, 0.956322, -0.89946234, 7.4000635, -2.786348, -0.29411328, -1.8570021]
Target sample: 43, Prediction:6, Target's Score:[-2.6085713, 0.8728722, -3.2139893, 1.1603317, -0.2553232, -0.25349355, 6.343017, -2.2008886, 0.8355106, -0.42789978]
Target sample: 49, Prediction:6, Target's Score:[-3.51234, 0.6296662, -2.8042412, 3.677313, -1.6852846, 0.015135974, 6.39486, -1.597276, 1.6406338, -2.4833882]
Target sample: 55, Prediction:8, Target's Score:[-1.551606, 0.44519413, -3.8557074, 0.77878845, -1.6877165, -0.2269874, 2.9373696, -1.3788378, 3.2690616, 1.5292264]
Target sample: 61, Prediction:6, Target's Score:[-3.299701, 1.3770936, -2.8436694, 3.722353, 0.3980142, -0.77150303, 4.115974, -3.0275874, -0.8618169, 1.4932148]
Target sample: 67, Prediction:1, Target's Score:[-1.961426, 6.354768, -3.4040892, 0.42800027, -1.7306619, -1.6339526, 6.2527347, -3.0141723, 0.28915492, -1.2506171]
Target sample: 73, Prediction:6, Target's Score:[-2.205609, 2.458993, -3.7569406, 0.11612118, -0.393435, -1.945848, 8.02241, -2.966706, 2.263865, -1.3121324]
Target sample: 79, Prediction:6, Target's Score:[-3.0152817, 3.966174, -4.0170646, -0.3669355, -1.9509311, -1.2023692, 5.9862275, -2.8972335, 4.571386, -0.7689702]
Target sample: 85, Prediction:6, Target's Score:[-2.7961245, 3.9606564, -3.9396367, 0.0027661957, -1.3915911, -1.9114064, 6.0682564, -2.9536006, 2.9063702, 0.34124926]
Target sample: 91, Prediction:6, Target's Score:[-2.695707, 4.4034243, -3.622824, 1.3910483, -0.8902411, -1.6328765, 8.911912, -3.3132706, -0.009068845, -2.2129517]
Target sample: 97, Prediction:6, Target's Score:[-3.196871, 1.2942017, -3.470597, 0.4128492, 0.05000704, -1.4557574, 10.956511, -3.5004985, 0.6660843, -1.476835]
Target sample: 103, Prediction:6, Target's Score:[-3.436608, 0.1865906, -2.1784158, 2.5374124, -0.050102178, -1.2728517, 9.838442, -3.6767812, 0.38460928, -2.0519888]
Target sample: 109, Prediction:6, Target's Score:[-3.1469967, 0.34184337, -3.111138, 0.4049147, -0.35928944, -0.44813606, 13.284548, -3.7968872, 0.28633466, -3.156726]
Target sample: 115, Prediction:4, Target's Score:[-2.6808124, -2.930854, -1.5875201, 4.111198, 5.9978433, -0.57380605, 3.0294716, -1.8681526, -1.5028946, -1.6512282]
Target sample: 121, Prediction:6, Target's Score:[-2.4834006, 2.0600348, -3.5277278, -0.06895929, -0.8469805, -0.7262123, 8.546749, -3.4809077, -0.44129172, 1.2631779]
Target sample: 127, Prediction:6, Target's Score:[-2.5836818, 3.9929533, -3.6251724, 0.64840573, -1.3913041, -1.4564888, 8.338826, -2.967064, 0.55591315, -1.2092563]
Target sample: 133, Prediction:6, Target's Score:[-1.203122, 2.1901813, -3.9145708, -0.12166028, -0.5136358, -0.7313648, 6.2795515, -1.7520071, 1.3773267, -1.3552234]
Target sample: 139, Prediction:6, Target's Score:[-1.9822686, 2.237086, -3.5606594, 0.18766701, -1.0854805, -1.3937472, 6.5990314, -2.2950191, 2.2042844, -0.67257845]
Current ATTACK acc on target samples: 83.333
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 09:46:52 Epoch 59, Val iteration 0, acc 93.800 (93.800)
2021-06-11 09:47:13 Epoch 59, Val iteration 19, acc 93.400 (92.800)
* Prec: 92.80000114440918
Per class accuracy =  [0.9334617  0.95432179 0.89015782 0.84538684 0.95044624 0.87577896
 0.95770831 0.94990495 0.96215246 0.95985334]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 1, 6, 1, 1, 6, 6, 9, 9, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 3, 6, 6, 9, 9, 9, 6, 1, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6
ATTACK acc: 81.35593220338983
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  600
poison index =  770
poison index =  1698
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 09:47:17, Val iteration 0, acc 92.600 (92.600)
2021-06-11 09:47:22, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 09:47:25, Epoch 0, Iteration 7, loss 0.285 (0.360), acc 86.538 (88.600)
2021-06-11 09:47:52, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:9, Target's Score:[-2.0773642, 2.1341114, -4.572578, 4.6741176, -0.61787874, -3.62435, 3.6693687, -2.4255636, -2.859296, 5.8885784]
Target sample: 7, Prediction:9, Target's Score:[-0.9033125, 1.0328817, -2.4696484, 3.1400409, 0.45149294, -4.1456213, 2.7496371, -1.6483763, -4.485205, 6.445494]
Target sample: 13, Prediction:9, Target's Score:[-0.84572715, 0.52888507, -2.8472333, 3.2894416, -0.0141735505, -3.1134331, 4.528325, -1.1764686, -5.3737426, 5.1743717]
Target sample: 19, Prediction:9, Target's Score:[-0.893667, 1.795848, -3.737878, 1.494571, -0.33414057, -4.002326, 4.868891, -1.8604636, -4.2096543, 7.0427804]
Target sample: 25, Prediction:6, Target's Score:[-1.3109894, 1.243706, -3.6903183, 4.7182913, 0.81067437, -1.9652541, 6.6202044, -2.7139492, -5.8896565, 2.342902]
Target sample: 31, Prediction:1, Target's Score:[-2.0639753, 7.7109447, -4.217687, 3.194241, -2.351717, -2.0011492, 5.6128716, -3.0509245, -5.9203296, 3.318447]
Target sample: 37, Prediction:9, Target's Score:[-0.42969063, 4.3490267, -3.2649984, 1.8745503, -2.6419322, -1.153998, 3.8957417, -3.3788183, -5.880875, 6.80804]
Target sample: 43, Prediction:7, Target's Score:[-1.1302062, 1.556876, -0.63949835, 3.5370393, 0.28835976, -2.0244, 1.3148257, 3.546518, -4.148723, -2.1090813]
Target sample: 49, Prediction:3, Target's Score:[-4.7511106, 3.1480966, -5.1415057, 6.7566032, -4.3304663, -0.06200555, 2.9575288, -2.4230115, 3.610395, 0.47874013]
Target sample: 55, Prediction:1, Target's Score:[1.3607047, 4.918419, -4.1429124, 0.17228599, -2.8380208, -1.7688557, 2.0821893, 0.02054557, -1.5335269, 1.9116554]
Target sample: 61, Prediction:3, Target's Score:[-0.9611609, 1.671029, 1.5884563, 2.7682579, 1.505517, -2.7849567, 1.8290261, 1.7759125, -4.1969056, -2.9981987]
Target sample: 67, Prediction:1, Target's Score:[-0.47473446, 5.849776, -2.709799, 0.5090104, -0.21140337, -4.4804034, 2.9018576, -1.4683955, -4.572844, 4.87273]
Target sample: 73, Prediction:6, Target's Score:[1.2189037, 1.0786984, -2.3332078, 2.167651, 1.7021072, -4.498673, 4.49939, -2.5862074, -4.6721816, 3.5995777]
Target sample: 79, Prediction:6, Target's Score:[-0.5877343, 4.1920853, -3.8885741, 1.6203184, -2.1253679, -3.655492, 5.9711328, -3.8895566, -3.400927, 5.942685]
Target sample: 85, Prediction:6, Target's Score:[-2.3908648, 0.86523134, -3.4405365, 2.7191663, -0.9245969, -3.7047389, 7.7084823, -3.058548, -3.9158247, 6.3006926]
Target sample: 91, Prediction:1, Target's Score:[1.1121897, 6.8651457, -2.0811687, 4.6463556, -2.2342775, -2.7563062, 3.2706394, -5.0923214, -5.0739293, 1.5621058]
Target sample: 97, Prediction:6, Target's Score:[-2.6887927, 2.1159196, -4.45902, 4.5722136, -0.4898971, -1.231564, 10.698184, -4.6314054, -5.445805, 1.7550887]
Target sample: 103, Prediction:3, Target's Score:[-3.2452357, 4.3690486, -4.0919957, 6.7935824, -2.8445013, -1.3537807, 5.0906096, -3.4493742, -1.4940156, 0.44885617]
Target sample: 109, Prediction:6, Target's Score:[-3.336331, 3.4927633, -4.6720347, 5.7061467, -6.112265, 3.198209, 9.483044, -7.1319494, -0.73702157, 0.34414488]
Target sample: 115, Prediction:6, Target's Score:[0.105941676, 3.501308, -1.1603756, 2.1755831, -1.7077855, -1.195625, 4.712682, -2.4973164, -4.380728, 0.6235072]
Target sample: 121, Prediction:3, Target's Score:[0.20412219, 2.1271818, -2.985284, 2.5242336, 2.2838933, -1.1513382, 1.4619907, 1.0712643, -2.7164993, -2.6168683]
Target sample: 127, Prediction:6, Target's Score:[-1.3394343, 4.7599306, -5.2699194, 3.3843408, -2.622337, -1.4298872, 6.313647, -4.3529606, -4.6884375, 5.436319]
Target sample: 133, Prediction:9, Target's Score:[-2.2868598, 3.2711678, -2.5795515, 3.3415802, 1.3768463, -4.0622525, 3.2061582, -0.41726735, -5.300684, 3.6671536]
Target sample: 139, Prediction:9, Target's Score:[0.3451859, 0.6677522, -1.7150804, 2.1071637, 0.3546261, -3.8597906, 3.2614708, -1.3164117, -4.1019173, 4.3975244]
Current ATTACK acc on target samples: 33.333
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 09:48:20 Epoch 59, Val iteration 0, acc 89.600 (89.600)
2021-06-11 09:48:26 Epoch 59, Val iteration 19, acc 90.000 (89.370)
* Prec: 89.37000122070313
Per class accuracy =  [0.92246512 0.92765127 0.84677014 0.82696973 0.88561194 0.82549563
 0.92911685 0.88983075 0.93090204 0.94793838]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 9, 9, 9, 9, 9, 3, 9, 9, 9, 9, 9, 9, 6, 1, 9, 9, 6, 6, 6, 6, 3, 1, 6, 6, 6, 6, 6, 3, 3, 6, 6, 6, 9, 9, 6, 1, 3, 9, 1, 3, 3, 3, 1, 1, 3, 1, 6, 6, 6, 6, 9, 1, 3, 3, 9, 9, 9, 6, 6, 9, 6, 9, 9, 6, 6, 9, 9, 1, 9, 6, 6, 6, 1, 9, 1, 1, 6, 6, 6, 6, 6, 9, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 1, 9, 9, 9, 3, 9, 9, 9, 9, 9, 6
ATTACK acc: 45.76271186440678
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  600
poison index =  770
poison index =  1698
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 09:48:33, Val iteration 0, acc 96.200 (96.200)
2021-06-11 09:48:45, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 09:48:52, Epoch 0, Iteration 7, loss 0.530 (0.610), acc 80.769 (83.800)
2021-06-11 09:50:03, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[2.8169258, 3.5774708, -2.731349, -2.585226, -3.5456035, -2.7429929, 4.979099, -1.6753714, 0.5157995, 1.4242649]
Target sample: 7, Prediction:6, Target's Score:[-0.12945299, 4.573937, -2.4195917, -2.5211756, -3.3398395, -2.4531264, 7.264737, -1.7703799, 0.8421461, -0.024604287]
Target sample: 13, Prediction:6, Target's Score:[1.7920129, 2.7921088, -2.487903, -0.72689825, -2.9903853, -1.9893609, 5.7146554, -1.4838128, -0.33821827, -0.2532913]
Target sample: 19, Prediction:6, Target's Score:[0.93448687, 3.8291693, -2.65741, -1.1694326, -2.9187894, -2.606953, 5.091637, -1.6642326, 0.6945431, 0.4949797]
Target sample: 25, Prediction:6, Target's Score:[2.1396763, 1.3499798, -0.7798185, -1.8263328, -2.1468492, -2.6759512, 6.3506584, -2.2400968, 1.2850866, -1.4313297]
Target sample: 31, Prediction:6, Target's Score:[-0.7054094, 4.320366, -1.1307986, -2.0307834, -2.5375473, -2.2968845, 9.283666, -2.104363, -1.6554061, -1.1231415]
Target sample: 37, Prediction:6, Target's Score:[1.9096438, 3.0725853, -2.3302422, 0.21079335, -1.8551826, -2.1425166, 4.7911706, -2.1513608, -1.240378, -0.23302941]
Target sample: 43, Prediction:6, Target's Score:[-1.2307479, 4.179722, -2.211981, -1.8487517, -1.1537892, -1.7998207, 7.015939, -0.49686295, -0.44398052, -1.9937584]
Target sample: 49, Prediction:6, Target's Score:[-1.4600449, 4.3853884, -1.0822623, -1.1951492, -0.9170517, -2.6689568, 6.336794, -2.2335148, 1.0669327, -2.2143838]
Target sample: 55, Prediction:1, Target's Score:[1.5691166, 4.4766407, -1.1493745, -1.1065781, -2.0052507, -2.6306877, 3.3340678, -1.8361496, 0.37943035, -1.0076494]
Target sample: 61, Prediction:1, Target's Score:[-2.0696757, 6.2721624, -2.0039332, -0.63666415, -1.4575658, -2.7803037, 5.04052, -1.8494176, -0.051043045, -0.44267443]
Target sample: 67, Prediction:6, Target's Score:[0.4784862, 4.061899, -1.0189555, -1.9103123, -2.8424478, -2.8249145, 4.9543514, -2.3083518, 1.0698692, 0.36453417]
Target sample: 73, Prediction:6, Target's Score:[2.8117454, 2.5383053, -2.315525, -2.4882567, -2.692533, -3.1500027, 6.2466455, -2.0820034, 1.1533179, 0.009669635]
Target sample: 79, Prediction:6, Target's Score:[-1.055336, 4.894597, -2.62627, -1.8153759, -3.0081863, -2.7583675, 6.84507, -2.209398, -0.5092881, 2.2715416]
Target sample: 85, Prediction:6, Target's Score:[1.3880317, 1.933502, -1.9032986, -2.1004984, -2.9576283, -2.4258914, 6.7235155, -2.3829434, 0.1606596, 1.5954115]
Target sample: 91, Prediction:6, Target's Score:[-0.83903533, 2.4851964, -0.7594332, 3.076011, -1.5535437, -1.7419723, 4.4612217, -2.5004263, -2.0134943, -0.5829843]
Target sample: 97, Prediction:6, Target's Score:[-0.7095053, 1.8688605, -2.2338016, -1.7203361, -1.8479565, -1.7325613, 11.124591, -1.4144406, -1.9601377, -1.353687]
Target sample: 103, Prediction:6, Target's Score:[-2.3993576, 5.3758197, -1.0723803, 0.47180256, 0.11569384, -3.2604434, 6.9231725, -3.045807, -1.4343947, -1.6503961]
Target sample: 109, Prediction:6, Target's Score:[-2.6552362, 2.9373748, -1.5433478, -1.5928988, -1.4782113, -1.2434703, 10.107899, -1.8051043, -0.3059379, -2.4081664]
Target sample: 115, Prediction:3, Target's Score:[-1.4877584, 0.6300276, -2.029229, 5.607303, -0.6444099, -0.7017502, 3.1781871, -2.0289593, -1.151179, -1.3386958]
Target sample: 121, Prediction:6, Target's Score:[-1.6517944, 1.4932313, -1.9160829, -0.29825863, -1.4480425, -0.47885907, 6.2351274, -0.96875966, -0.17684741, -0.7696145]
Target sample: 127, Prediction:6, Target's Score:[-0.3835467, 2.3942182, -2.2938151, -2.4295738, -3.2022307, -2.4250124, 9.8682375, -1.2224033, -0.07890271, -0.20397918]
Target sample: 133, Prediction:1, Target's Score:[0.8691603, 4.434888, -3.2837539, -0.27569085, -3.1169178, -2.407675, 4.3902597, -0.8419344, -0.543039, 0.80567056]
Target sample: 139, Prediction:0, Target's Score:[4.2980094, 2.5848472, -2.1721783, -2.0121386, -3.235933, -2.6576679, 3.8790755, -2.100239, 0.6913515, 0.7599144]
Current ATTACK acc on target samples: 79.167
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 09:51:13 Epoch 59, Val iteration 0, acc 92.200 (92.200)
2021-06-11 09:51:25 Epoch 59, Val iteration 19, acc 93.400 (92.770)
* Prec: 92.77000160217285
Per class accuracy =  [0.95022948 0.94898778 0.89060516 0.8592035  0.94442329 0.89957065
 0.96195849 0.93587785 0.94286588 0.9444018 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 1, 6, 6, 1, 6, 6, 6, 1, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 1, 6, 6, 6
ATTACK acc: 83.89830508474576
--------
------SUMMARY------
TIME ELAPSED (mins): 24
TARGET INDEX: 14
ResNet50 79.16666666666667 85.59322033898304 95.46000137329102 91.0400016784668
DPN92 83.33333333333333 81.35593220338983 95.50000267028808 92.80000114440918
MobileNetV2 33.333333333333336 45.76271186440678 91.22000160217286 89.37000122070313
GoogLeNet 79.16666666666667 83.89830508474576 95.41000213623047 92.77000160217285
True False False False False
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 92 images of target 15
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=False, nearest=True, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=15, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/15/target-num-20
torch.Size([200, 1, 3, 32, 32]) torch.Size([16, 3, 32, 32])
Selected nearest neighbors: [1212, 1088, 770, 1708, 600]
Selected base image indices: [1212, 1088, 770, 1708, 600]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
# Targets: 16, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 09:52:02 Iteration 0 	 Training Loss: 8.242e-01 	 Loss in Target Net: 9.557e-01	  
tensor(0.0001, device='cuda:0')
 2021-06-11 09:53:07 Iteration 50 	 Training Loss: 1.977e-01 	 Loss in Target Net: 3.150e-01	  
tensor(-0.0073, device='cuda:0')
 2021-06-11 09:54:11 Iteration 100 	 Training Loss: 1.574e-01 	 Loss in Target Net: 3.456e-01	  
tensor(-0.0252, device='cuda:0')
 2021-06-11 09:55:16 Iteration 150 	 Training Loss: 1.468e-01 	 Loss in Target Net: 3.100e-01	  
tensor(-0.0393, device='cuda:0')
 2021-06-11 09:56:20 Iteration 200 	 Training Loss: 1.404e-01 	 Loss in Target Net: 3.096e-01	  
tensor(-0.0446, device='cuda:0')
 2021-06-11 09:57:25 Iteration 250 	 Training Loss: 1.345e-01 	 Loss in Target Net: 3.002e-01	  
tensor(-0.0486, device='cuda:0')
 2021-06-11 09:58:28 Iteration 300 	 Training Loss: 1.355e-01 	 Loss in Target Net: 2.926e-01	  
tensor(-0.0515, device='cuda:0')
 2021-06-11 09:59:30 Iteration 350 	 Training Loss: 1.321e-01 	 Loss in Target Net: 3.017e-01	  
tensor(-0.0544, device='cuda:0')
 2021-06-11 10:00:36 Iteration 400 	 Training Loss: 1.316e-01 	 Loss in Target Net: 2.918e-01	  
tensor(-0.0565, device='cuda:0')
 2021-06-11 10:01:38 Iteration 450 	 Training Loss: 1.321e-01 	 Loss in Target Net: 3.039e-01	  
tensor(-0.0574, device='cuda:0')
 2021-06-11 10:02:40 Iteration 500 	 Training Loss: 1.293e-01 	 Loss in Target Net: 3.139e-01	  
tensor(-0.0581, device='cuda:0')
 2021-06-11 10:03:46 Iteration 550 	 Training Loss: 1.287e-01 	 Loss in Target Net: 2.868e-01	  
tensor(-0.0580, device='cuda:0')
 2021-06-11 10:04:48 Iteration 600 	 Training Loss: 1.271e-01 	 Loss in Target Net: 3.015e-01	  
tensor(-0.0578, device='cuda:0')
 2021-06-11 10:05:52 Iteration 650 	 Training Loss: 1.295e-01 	 Loss in Target Net: 2.740e-01	  
tensor(-0.0583, device='cuda:0')
 2021-06-11 10:06:57 Iteration 700 	 Training Loss: 1.250e-01 	 Loss in Target Net: 2.818e-01	  
tensor(-0.0606, device='cuda:0')
 2021-06-11 10:07:59 Iteration 750 	 Training Loss: 1.287e-01 	 Loss in Target Net: 3.044e-01	  
tensor(-0.0605, device='cuda:0')
 2021-06-11 10:09:05 Iteration 800 	 Training Loss: 1.261e-01 	 Loss in Target Net: 3.452e-01	  
tensor(-0.0600, device='cuda:0')
 2021-06-11 10:10:09 Iteration 850 	 Training Loss: 1.247e-01 	 Loss in Target Net: 2.814e-01	  
tensor(-0.0631, device='cuda:0')
 2021-06-11 10:11:11 Iteration 900 	 Training Loss: 1.222e-01 	 Loss in Target Net: 3.111e-01	  
tensor(-0.0636, device='cuda:0')
 2021-06-11 10:12:15 Iteration 950 	 Training Loss: 1.213e-01 	 Loss in Target Net: 3.208e-01	  
tensor(-0.0643, device='cuda:0')
 2021-06-11 10:13:17 Iteration 999 	 Training Loss: 1.243e-01 	 Loss in Target Net: 3.207e-01	  
tensor(-0.0626, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  770
poison index =  1708
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 10:13:23, Val iteration 0, acc 94.200 (94.200)
2021-06-11 10:13:32, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 10:13:38, Epoch 0, Iteration 7, loss 0.192 (0.257), acc 92.308 (94.800)
2021-06-11 10:14:38, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-3.155826, 2.222672, -3.184657, -1.2127007, -2.7663798, -0.48094907, 8.5834055, -3.3845325, 4.7674026, -1.3056175]
Target sample: 7, Prediction:6, Target's Score:[-2.7342749, 0.8591332, -2.7046783, -1.4624593, -2.2441719, -0.8589072, 8.616138, -2.8153665, 4.194628, -0.77984923]
Target sample: 13, Prediction:6, Target's Score:[-3.677756, 5.069123, -2.4366555, -0.91384166, -2.0179803, 0.13727093, 6.7897167, -2.0628557, -1.2713971, 0.44443196]
Target sample: 19, Prediction:6, Target's Score:[-3.602866, 4.812124, -2.5057936, -0.14118043, -2.366166, -0.4410028, 5.561851, -2.5328174, 1.1654289, 0.12603305]
Target sample: 25, Prediction:6, Target's Score:[-2.5179777, -0.44081473, -1.795255, -0.92246246, -1.5275339, -0.42670584, 5.986727, -1.6996539, 3.0062602, 0.39893162]
Target sample: 31, Prediction:1, Target's Score:[-2.4026809, 3.858782, -2.6913102, 1.555461, -2.3170073, 0.52444726, 2.9875324, 0.031876855, -1.0402962, -0.45171976]
Target sample: 37, Prediction:6, Target's Score:[-2.544935, 0.3334654, -2.7378006, -1.9407192, -1.4614663, -0.704012, 5.8210416, -2.3854492, 5.5102806, 0.18485369]
Target sample: 43, Prediction:6, Target's Score:[-3.6206057, 6.0663958, -3.6992848, -1.0790031, -3.062054, -1.0181187, 7.4002495, -3.746967, 4.6129007, -1.7671766]
Target sample: 49, Prediction:6, Target's Score:[-2.611965, 4.274638, -3.0489974, -1.1765791, -2.3831978, -1.2179568, 5.257041, -3.189866, 4.6442904, -0.4729386]
Target sample: 55, Prediction:3, Target's Score:[-2.767949, 0.9844074, -1.5621201, 3.791374, -1.96145, 0.64581174, 3.454459, 1.7945073, -2.0839992, -2.2271233]
Target sample: 61, Prediction:6, Target's Score:[-3.787588, 2.7703817, -2.1553216, 1.1823435, -2.4699523, 0.15963586, 6.072513, -0.6166582, -0.6621158, -0.42640787]
Target sample: 67, Prediction:1, Target's Score:[-2.9506924, 5.1904836, -2.9626694, -0.045683935, -2.4378195, -0.5652078, 4.0807695, -2.6704128, -0.5361366, 2.9654233]
Target sample: 73, Prediction:3, Target's Score:[-2.6793768, 2.626462, -1.3992081, 3.1138942, -1.6868644, -0.6801482, 3.0173752, -1.9888723, -0.10135145, -0.1512366]
Target sample: 79, Prediction:6, Target's Score:[-3.9489145, 1.8765237, -2.3049157, -0.45703012, -2.645318, -0.98710597, 8.620622, -3.0319417, -0.036093876, 2.990155]
Target sample: 85, Prediction:6, Target's Score:[-3.375301, 1.606511, -2.9464247, -0.57191354, -2.5336294, -0.49270168, 8.896827, -3.3406813, 4.2044234, -1.3657746]
Target sample: 91, Prediction:6, Target's Score:[-2.954633, 0.0869327, -2.3360987, -0.89924663, -2.0014522, -0.8389341, 8.471239, -2.8183725, 4.8687553, -1.5033174]
Current ATTACK acc on target samples: 75.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 10:15:37 Epoch 59, Val iteration 0, acc 90.800 (90.800)
2021-06-11 10:15:47 Epoch 59, Val iteration 19, acc 91.600 (91.390)
* Prec: 91.39000129699707
Per class accuracy =  [0.94279241 0.95133635 0.84566068 0.78375217 0.91252771 0.90227731
 0.96587819 0.92128364 0.96645386 0.9480766 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 5, 6, 6, 9, 6, 8, 6, 8, 1, 1, 1, 1, 1, 8, 6, 6, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 1, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 8, 6, 6, 6
ATTACK acc: 73.6842105263158
--------
DPN92
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  770
poison index =  1708
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 10:15:58, Val iteration 0, acc 94.800 (94.800)
2021-06-11 10:16:19, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 10:16:33, Epoch 0, Iteration 7, loss 0.688 (0.546), acc 84.615 (87.800)
2021-06-11 10:19:11, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.1120892, 4.9106674, -4.0966916, -2.1023762, -3.5013893, -2.0557723, 10.915505, -2.2897274, 3.2941065, -2.6986055]
Target sample: 7, Prediction:6, Target's Score:[-1.4104527, 6.4055567, -4.3233585, -1.4784675, -3.1815155, -2.4444237, 8.69186, -2.6047218, 2.324333, -1.7087735]
Target sample: 13, Prediction:1, Target's Score:[-0.45985818, 8.846361, -4.1555023, -2.442609, -3.9479978, -2.7660365, 7.4679317, -2.5386662, 0.22635403, 0.070329905]
Target sample: 19, Prediction:6, Target's Score:[-1.5675138, 6.3118663, -3.2155588, -1.6300484, -3.6988807, -2.8321602, 9.251309, -2.350948, 1.5696586, -1.5464075]
Target sample: 25, Prediction:6, Target's Score:[-1.6058365, 2.4872596, -3.5170953, -1.2135386, -3.496298, -3.460884, 11.372026, -1.7521023, 3.35805, -1.8728044]
Target sample: 31, Prediction:6, Target's Score:[-0.78426266, 3.3698566, -3.4765968, -0.736774, -3.5658062, -1.8415948, 9.552521, -1.0414318, 1.4969844, -2.6771586]
Target sample: 37, Prediction:6, Target's Score:[-1.4406533, 5.579978, -3.9111795, -0.9246888, -3.5039222, -1.44698, 7.2285256, -1.5328999, 2.3801198, -2.166219]
Target sample: 43, Prediction:1, Target's Score:[-0.96911, 10.030597, -4.749116, -1.9407881, -3.5683684, -2.042984, 5.4632745, -2.3005013, 2.2808163, -1.9230806]
Target sample: 49, Prediction:6, Target's Score:[-2.1455066, 3.202196, -4.140802, -1.4101522, -1.5909201, -2.2314646, 9.114787, -2.0257397, 4.6489496, -3.1895618]
Target sample: 55, Prediction:6, Target's Score:[-0.35829267, 4.1676035, -3.8023925, 0.093057774, -3.4342623, -2.4236314, 8.125812, -2.3207982, -0.20434976, 0.49290487]
Target sample: 61, Prediction:6, Target's Score:[-0.8090979, 6.5521526, -3.4448137, -0.9608328, -3.7962444, -2.6643698, 8.812404, -2.2659085, 1.2705753, -2.3911602]
Target sample: 67, Prediction:6, Target's Score:[-0.8660112, 5.9040084, -4.03278, -1.583598, -3.6258206, -2.32235, 7.695854, -2.400048, 2.1373522, -0.63170314]
Target sample: 73, Prediction:6, Target's Score:[-0.6077368, 4.8162313, -3.7323766, -1.1148397, -3.7350426, -2.9716585, 7.5763006, -2.0265317, 1.3848543, 0.7010906]
Target sample: 79, Prediction:1, Target's Score:[-1.3276634, 9.485622, -4.55936, -1.7809806, -4.1331406, -1.8332024, 6.1731095, -2.872606, -0.76162416, 1.9406528]
Target sample: 85, Prediction:6, Target's Score:[-1.932651, 5.8233376, -4.286466, -1.9377873, -3.4496675, -2.3297777, 10.625749, -2.3185132, 3.021356, -2.9431174]
Target sample: 91, Prediction:6, Target's Score:[-1.8530779, 3.6405625, -3.5687346, -0.9883309, -2.7119188, -2.737763, 11.334722, -2.3593864, 2.892062, -3.377129]
Current ATTACK acc on target samples: 81.250
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 10:21:46 Epoch 59, Val iteration 0, acc 93.000 (93.000)
2021-06-11 10:22:06 Epoch 59, Val iteration 19, acc 92.400 (92.650)
* Prec: 92.65000038146972
Per class accuracy =  [0.9581297  0.94865635 0.89630376 0.81419064 0.95743466 0.90633249
 0.93672981 0.94965308 0.95348042 0.94569524]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 1, 1, 6, 6, 1, 1, 6, 1, 1, 1, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 6, 1, 1, 1, 1, 6, 6, 6, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 63.1578947368421
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  770
poison index =  1708
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 10:22:10, Val iteration 0, acc 92.600 (92.600)
2021-06-11 10:22:15, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 10:22:17, Epoch 0, Iteration 7, loss 0.380 (0.379), acc 92.308 (89.400)
2021-06-11 10:22:45, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.5728648, 8.813228, -2.8358154, -1.1274462, -5.5701904, -1.6340041, 8.988512, -4.784705, 0.16132142, -0.21025804]
Target sample: 7, Prediction:1, Target's Score:[-2.1209486, 10.450804, -3.1992888, -0.010058001, -3.4373004, -1.8036335, 4.010942, -4.4925947, -0.45034915, 1.3196727]
Target sample: 13, Prediction:1, Target's Score:[-2.1972158, 10.615048, -4.1048136, 1.6406493, -3.6238291, 0.53353137, 3.822682, -4.9529805, -3.6685169, 2.2354257]
Target sample: 19, Prediction:1, Target's Score:[-3.7456248, 8.572909, -3.9789605, 0.36722952, -4.313856, 0.6551152, 6.2418184, -5.579844, 0.58634555, 1.4791845]
Target sample: 25, Prediction:6, Target's Score:[-3.64268, 3.939448, -1.7424142, 2.2013042, -4.851896, -1.2649288, 6.0751705, -3.9849358, 2.5737772, 0.9034735]
Target sample: 31, Prediction:1, Target's Score:[-1.6066811, 10.383984, -2.1475902, 1.6110106, -3.6715872, -0.62477815, -0.73949933, 0.657234, -2.6889048, -0.866481]
Target sample: 37, Prediction:1, Target's Score:[-2.444371, 9.244852, -2.7085724, 2.7083755, -4.3855147, -1.2769477, 6.0180445, -5.6241183, -0.83284575, -0.44215164]
Target sample: 43, Prediction:1, Target's Score:[-3.8510003, 13.317669, -2.7139866, -0.78665096, -4.191484, -0.062414125, 3.4619288, -4.0716877, -0.8851802, 0.099913664]
Target sample: 49, Prediction:1, Target's Score:[-2.4087088, 10.459387, -4.6557827, 1.5372415, -1.1653521, -2.3780892, 3.4586685, -3.6506991, -1.4543493, 0.57581764]
Target sample: 55, Prediction:1, Target's Score:[2.4009316, 7.3530755, -5.3173494, 5.8207192, -2.1878643, -0.7332382, -0.20854992, -3.7686174, -3.8591108, 0.77912885]
Target sample: 61, Prediction:1, Target's Score:[-2.755936, 13.478109, -2.6276886, -0.7570013, -5.525295, -1.3733032, 4.404768, -4.0233374, -2.238992, 1.727384]
Target sample: 67, Prediction:1, Target's Score:[-2.8711276, 11.078123, -4.396182, 0.4082139, -2.79953, -2.2857475, 3.66619, -2.62259, -2.7819085, 2.930757]
Target sample: 73, Prediction:1, Target's Score:[-3.35196, 11.148074, -3.1914096, 1.5694051, -3.4893444, -0.8784609, 0.811054, -1.8909007, -1.1665835, 0.75131994]
Target sample: 79, Prediction:6, Target's Score:[-2.694261, 5.3493886, -2.067611, 4.3918014, -3.1838114, -1.195281, 7.1171236, -5.5744524, -4.8064756, 2.9267623]
Target sample: 85, Prediction:6, Target's Score:[-1.7417222, 7.651871, -2.7637467, -0.35573027, -5.205597, -1.6272453, 9.94735, -5.495095, 0.8896236, -1.0808424]
Target sample: 91, Prediction:1, Target's Score:[-2.4315066, 11.368673, -3.1819127, 0.16079581, -4.8858795, -2.3067687, 7.222626, -5.4072137, -0.5581954, 0.2966967]
Current ATTACK acc on target samples: 25.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 10:23:12 Epoch 59, Val iteration 0, acc 89.600 (89.600)
2021-06-11 10:23:18 Epoch 59, Val iteration 19, acc 90.200 (89.310)
* Prec: 89.31000137329102
Per class accuracy =  [0.92362025 0.9182341  0.84404375 0.8256883  0.89045367 0.82186847
 0.93352367 0.89036758 0.93204314 0.94717251]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1
ATTACK acc: 10.526315789473685
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  770
poison index =  1708
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 10:23:26, Val iteration 0, acc 96.200 (96.200)
2021-06-11 10:23:38, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 10:23:44, Epoch 0, Iteration 7, loss 0.913 (0.895), acc 71.154 (77.400)
2021-06-11 10:24:55, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-3.246221, 7.860303, -1.582336, -2.573228, -4.074352, 1.0446695, 9.09402, -4.029728, -0.25416848, -2.24038]
Target sample: 7, Prediction:6, Target's Score:[-4.2611146, 9.31099, -3.289281, -3.7845988, -4.2315373, 2.1446505, 11.068244, -3.4003756, -1.6344408, -1.9117321]
Target sample: 13, Prediction:1, Target's Score:[-1.6331797, 8.34034, -3.5441804, -4.089822, -1.5076796, 3.1737716, 6.3679338, -2.7541351, -2.670088, -1.648697]
Target sample: 19, Prediction:6, Target's Score:[-3.6042287, 5.854214, -2.2978764, -1.931621, -2.0839162, 4.4221096, 7.3579354, -2.7815993, -3.06461, -1.8497599]
Target sample: 25, Prediction:6, Target's Score:[0.33726695, 1.3230757, -1.6634871, -2.3465216, -0.7113158, -0.2761912, 8.091307, -2.9423475, -0.02127217, -1.8150233]
Target sample: 31, Prediction:6, Target's Score:[-1.1715977, 3.0954173, -1.2863313, -1.3789138, -2.796536, 2.484565, 7.3781137, -2.0803525, -1.3428267, -2.9030101]
Target sample: 37, Prediction:6, Target's Score:[-1.5496676, 4.76956, -4.4902797, -1.4906309, 0.20127656, -0.19786215, 7.1309414, -2.236917, 0.9823795, -3.1340458]
Target sample: 43, Prediction:6, Target's Score:[-3.255371, 6.175132, -2.4135823, -1.3193241, -1.9261825, 0.9288721, 7.8224545, -3.639187, -0.24072845, -2.139503]
Target sample: 49, Prediction:6, Target's Score:[-0.164341, 4.747525, -4.7809434, -1.3824342, -2.8222606, 1.152385, 5.505627, -1.658997, 1.7627128, -2.3450766]
Target sample: 55, Prediction:1, Target's Score:[3.3005345, 3.9690535, -3.3360014, -0.41950682, -1.5524513, 0.6538435, 3.3120577, -2.149277, -1.4562787, -2.320346]
Target sample: 61, Prediction:6, Target's Score:[-2.9544075, 4.223363, -2.4869664, -2.1562622, -2.491286, 2.976749, 10.484406, -3.2068145, -1.8895681, -2.5026987]
Target sample: 67, Prediction:1, Target's Score:[-1.3131168, 9.268724, -5.663196, -2.1378136, -2.8734608, -0.06152026, 5.222614, -2.952572, -0.5835219, 1.1137456]
Target sample: 73, Prediction:1, Target's Score:[-3.618385, 6.055194, -1.5218525, 1.4153391, -1.903391, 2.4836097, 3.8946173, -4.3743744, -1.6280345, -0.7921901]
Target sample: 79, Prediction:1, Target's Score:[-4.3312354, 13.070302, -5.1061635, -2.6117039, -2.8740137, 2.945973, 5.373028, -3.5457757, -2.7601724, -0.111522004]
Target sample: 85, Prediction:6, Target's Score:[-3.1410205, 7.620068, -2.5516827, -1.5894006, -3.3771038, 0.8320762, 10.451535, -4.21901, -1.3115841, -2.7300892]
Target sample: 91, Prediction:6, Target's Score:[-4.4720116, 7.9619384, -3.016838, -3.084476, -3.942859, 1.8901412, 12.375079, -3.3347476, -1.3654554, -3.0202742]
Current ATTACK acc on target samples: 68.750
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 10:26:04 Epoch 59, Val iteration 0, acc 92.000 (92.000)
2021-06-11 10:26:17 Epoch 59, Val iteration 19, acc 92.200 (92.070)
* Prec: 92.07000198364258
Per class accuracy =  [0.95597352 0.9411495  0.89682754 0.86199313 0.91466811 0.85462999
 0.95436701 0.93237096 0.94345437 0.94827263]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 1, 1, 6, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 6, 6, 1, 6, 1, 6, 1, 1, 1, 1, 6, 6, 1, 1, 1, 6, 1, 1, 1, 1, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 6, 1, 6, 6, 6, 6, 6, 1, 6, 6, 6
ATTACK acc: 48.68421052631579
--------
------SUMMARY------
TIME ELAPSED (mins): 21
TARGET INDEX: 15
ResNet50 75.0 73.6842105263158 95.46000137329102 91.39000129699707
DPN92 81.25 63.1578947368421 95.50000267028808 92.65000038146972
MobileNetV2 25.0 10.526315789473685 91.22000160217286 89.31000137329102
GoogLeNet 68.75 48.68421052631579 95.41000213623047 92.07000198364258
True False False False True
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 92 images of target 15
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=True, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=15, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/15/target-num-20
torch.Size([200, 1, 3, 32, 32]) torch.Size([16, 3, 32, 32])
Selected nearest neighbors: [1212, 1088, 770, 1708, 600]
Selected base image indices: [1212, 1088, 770, 1708, 600]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
# Targets: 16, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 10:26:54 Iteration 0 	 Training Loss: 7.759e-01 	 Loss in Target Net: 5.765e-01	  
tensor(0.0003, device='cuda:0')
 2021-06-11 10:28:07 Iteration 50 	 Training Loss: 3.543e-01 	 Loss in Target Net: 3.167e-01	  
tensor(-0.0276, device='cuda:0')
 2021-06-11 10:29:18 Iteration 100 	 Training Loss: 3.363e-01 	 Loss in Target Net: 3.013e-01	  
tensor(-0.0408, device='cuda:0')
 2021-06-11 10:30:28 Iteration 150 	 Training Loss: 3.319e-01 	 Loss in Target Net: 3.027e-01	  
tensor(-0.0414, device='cuda:0')
 2021-06-11 10:31:41 Iteration 200 	 Training Loss: 3.308e-01 	 Loss in Target Net: 3.014e-01	  
tensor(-0.0393, device='cuda:0')
 2021-06-11 10:32:51 Iteration 250 	 Training Loss: 3.320e-01 	 Loss in Target Net: 2.958e-01	  
tensor(-0.0394, device='cuda:0')
 2021-06-11 10:34:03 Iteration 300 	 Training Loss: 3.328e-01 	 Loss in Target Net: 2.839e-01	  
tensor(-0.0387, device='cuda:0')
 2021-06-11 10:35:14 Iteration 350 	 Training Loss: 3.281e-01 	 Loss in Target Net: 3.009e-01	  
tensor(-0.0398, device='cuda:0')
 2021-06-11 10:36:24 Iteration 400 	 Training Loss: 3.279e-01 	 Loss in Target Net: 2.921e-01	  
tensor(-0.0397, device='cuda:0')
 2021-06-11 10:37:35 Iteration 450 	 Training Loss: 3.311e-01 	 Loss in Target Net: 2.860e-01	  
tensor(-0.0397, device='cuda:0')
 2021-06-11 10:38:45 Iteration 500 	 Training Loss: 3.298e-01 	 Loss in Target Net: 2.968e-01	  
tensor(-0.0407, device='cuda:0')
 2021-06-11 10:39:57 Iteration 550 	 Training Loss: 3.301e-01 	 Loss in Target Net: 2.983e-01	  
tensor(-0.0405, device='cuda:0')
 2021-06-11 10:41:08 Iteration 600 	 Training Loss: 3.290e-01 	 Loss in Target Net: 2.921e-01	  
tensor(-0.0410, device='cuda:0')
 2021-06-11 10:42:18 Iteration 650 	 Training Loss: 3.289e-01 	 Loss in Target Net: 2.931e-01	  
tensor(-0.0408, device='cuda:0')
 2021-06-11 10:43:36 Iteration 700 	 Training Loss: 3.287e-01 	 Loss in Target Net: 2.924e-01	  
tensor(-0.0418, device='cuda:0')
 2021-06-11 10:44:48 Iteration 750 	 Training Loss: 3.258e-01 	 Loss in Target Net: 2.855e-01	  
tensor(-0.0425, device='cuda:0')
 2021-06-11 10:46:00 Iteration 800 	 Training Loss: 3.240e-01 	 Loss in Target Net: 2.993e-01	  
tensor(-0.0432, device='cuda:0')
 2021-06-11 10:47:12 Iteration 850 	 Training Loss: 3.259e-01 	 Loss in Target Net: 2.965e-01	  
tensor(-0.0425, device='cuda:0')
 2021-06-11 10:48:25 Iteration 900 	 Training Loss: 3.243e-01 	 Loss in Target Net: 2.913e-01	  
tensor(-0.0427, device='cuda:0')
 2021-06-11 10:49:35 Iteration 950 	 Training Loss: 3.310e-01 	 Loss in Target Net: 2.860e-01	  
tensor(-0.0420, device='cuda:0')
 2021-06-11 10:50:44 Iteration 999 	 Training Loss: 3.276e-01 	 Loss in Target Net: 2.900e-01	  
tensor(-0.0417, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  770
poison index =  1708
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 10:50:49, Val iteration 0, acc 94.200 (94.200)
2021-06-11 10:50:59, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 10:51:04, Epoch 0, Iteration 7, loss 0.562 (0.580), acc 86.538 (87.000)
2021-06-11 10:52:04, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.1183075, 10.128041, -3.9431422, -3.660302, -3.7306464, -3.193986, 10.88598, -3.1539378, 0.3991729, -2.536222]
Target sample: 7, Prediction:1, Target's Score:[-0.86247134, 10.331873, -3.4266207, -3.1551392, -3.5219455, -2.9050758, 8.863324, -2.7710104, -0.034121852, -2.4665067]
Target sample: 13, Prediction:1, Target's Score:[-1.5050261, 13.509647, -2.8315008, -3.3100693, -3.6253421, -2.8332515, 7.166004, -3.1045146, -1.2565998, -2.2072134]
Target sample: 19, Prediction:1, Target's Score:[-0.73224956, 10.221738, -2.1867325, -2.9700308, -3.4582503, -2.0415642, 6.017193, -2.698679, -0.3916454, -1.7445462]
Target sample: 25, Prediction:6, Target's Score:[-1.1689911, 3.4984298, -1.7644584, -1.5990679, -2.055443, -1.600673, 6.387142, -1.484359, 0.3743677, -0.53500944]
Target sample: 31, Prediction:1, Target's Score:[-0.9109614, 8.207188, -2.3140283, -2.1626697, -3.0456457, -1.7557861, 5.49658, -2.147032, -1.7346519, 0.37661284]
Target sample: 37, Prediction:1, Target's Score:[-0.46192753, 6.6845636, -2.1156588, -2.713698, -2.328781, -2.6168919, 6.2668204, -2.6201127, -0.61377347, 0.54821175]
Target sample: 43, Prediction:1, Target's Score:[-2.0172348, 11.194964, -3.3070588, -2.9575796, -3.446417, -2.6335983, 8.870652, -3.244698, -0.019646894, -2.4001114]
Target sample: 49, Prediction:1, Target's Score:[-1.0158912, 8.756783, -2.9135413, -2.4679592, -2.9234548, -2.4060185, 6.942374, -2.8013372, 0.50143635, -1.6357826]
Target sample: 55, Prediction:1, Target's Score:[-0.410729, 6.9602537, -1.2581965, -1.6397758, -2.3242388, -1.7767876, 5.4658623, -2.1533027, -1.6780344, -1.1654501]
Target sample: 61, Prediction:1, Target's Score:[-1.0071607, 11.054267, -2.4998207, -2.4183967, -3.4878292, -2.09216, 6.2437596, -2.70827, -0.999678, -2.0766356]
Target sample: 67, Prediction:1, Target's Score:[-0.8906651, 9.639768, -2.4168262, -2.2210457, -3.3781617, -1.8510596, 5.196611, -2.744216, -1.6195842, 0.28547317]
Target sample: 73, Prediction:1, Target's Score:[-0.6897084, 8.1933775, -2.0944543, -2.0971677, -2.9753091, -1.1473309, 5.4375844, -2.6908529, -1.6506771, -0.26980937]
Target sample: 79, Prediction:1, Target's Score:[-2.2217462, 8.565173, -2.4850693, -2.7561958, -2.8655097, -2.355047, 7.7708516, -3.2438328, -1.83662, 1.4532454]
Target sample: 85, Prediction:6, Target's Score:[-1.5107582, 9.8361435, -3.7063823, -2.723763, -3.2492914, -2.7657545, 10.226063, -3.1133962, -0.018939178, -2.9078116]
Target sample: 91, Prediction:1, Target's Score:[-0.6531434, 9.648686, -3.1572063, -2.5854867, -3.2793105, -2.4121842, 8.416687, -2.868396, -0.052838754, -3.0046754]
Current ATTACK acc on target samples: 18.750
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 10:53:03 Epoch 59, Val iteration 0, acc 89.600 (89.600)
2021-06-11 10:53:13 Epoch 59, Val iteration 19, acc 91.400 (89.820)
* Prec: 89.82000160217285
Per class accuracy =  [0.92356215 0.95644111 0.82138252 0.85245833 0.87744406 0.80365091
 0.96106604 0.91842053 0.93239914 0.93665053]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 6, 1, 1, 6, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 6, 1, 6, 6, 1, 1, 1, 1, 1
ATTACK acc: 19.736842105263158
--------
DPN92
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  770
poison index =  1708
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 10:53:25, Val iteration 0, acc 94.800 (94.800)
2021-06-11 10:53:45, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 10:54:00, Epoch 0, Iteration 7, loss 0.126 (0.428), acc 98.077 (90.600)
2021-06-11 10:56:38, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.1612203, 1.8568063, -2.4571464, -0.07687867, -2.4489322, -1.5000719, 11.35528, -2.725393, 0.37729585, -1.9076066]
Target sample: 7, Prediction:6, Target's Score:[-2.0766609, 1.838509, -2.5169957, -0.09039162, -1.7166045, -1.9856095, 11.31073, -2.8867302, 0.18947908, -1.7618668]
Target sample: 13, Prediction:1, Target's Score:[-1.979601, 10.396693, -3.9250114, -2.3206327, -3.1983657, -3.1228254, 7.370754, -4.019031, -0.49350452, 1.7517081]
Target sample: 19, Prediction:6, Target's Score:[-2.4979897, 6.0423427, -2.8499079, -0.9783375, -2.5926266, -2.7279267, 8.616578, -3.3437645, 0.78949964, -0.07809891]
Target sample: 25, Prediction:6, Target's Score:[-1.2264938, 1.8446275, -2.5087593, 0.72471124, -2.8038025, -3.338983, 8.838165, -2.1841931, 2.1260424, -1.1357818]
Target sample: 31, Prediction:6, Target's Score:[-0.18860106, 3.5687163, -2.9979625, 0.20206961, -3.13873, -1.7798216, 7.0775065, -1.3255816, 0.6122897, -1.7017878]
Target sample: 37, Prediction:1, Target's Score:[-2.1584942, 8.196414, -3.5848198, -1.0023336, -2.6924486, -1.7263654, 4.6050873, -2.307959, 1.3896474, -0.34831023]
Target sample: 43, Prediction:6, Target's Score:[-2.126158, 5.664485, -3.210165, -0.23616427, -2.7650762, -1.8982803, 7.1058793, -2.5367558, 2.0355794, -1.6674159]
Target sample: 49, Prediction:6, Target's Score:[-1.7801925, 3.1078079, -3.1340206, 0.71207076, -2.0184584, -1.7333169, 7.1135664, -2.3369532, 1.8250265, -1.430421]
Target sample: 55, Prediction:6, Target's Score:[-1.3888558, 2.6680393, -2.928104, 1.1675705, -2.3943129, -2.0308993, 8.198799, -2.458933, -1.1171728, 0.63017255]
Target sample: 61, Prediction:1, Target's Score:[-1.8059163, 7.7418547, -2.8938315, -0.58874387, -3.0121841, -3.0621607, 7.0002136, -2.8520617, 1.0399246, -1.1556759]
Target sample: 67, Prediction:1, Target's Score:[-1.5668147, 7.643837, -3.7652388, -0.8956812, -2.9971716, -3.1765168, 3.8686163, -3.232254, 2.3364568, 2.1872337]
Target sample: 73, Prediction:6, Target's Score:[-1.2465835, 4.422688, -3.3081763, -0.0372949, -3.1145842, -3.0478418, 5.7825427, -2.6735451, 0.6902625, 2.898545]
Target sample: 79, Prediction:1, Target's Score:[-2.7681086, 9.253475, -3.60548, -1.2648472, -2.8417833, -2.0195174, 6.529927, -3.6952257, -1.2750696, 2.1188986]
Target sample: 85, Prediction:6, Target's Score:[-2.043597, 2.6059785, -2.80235, -0.1936988, -2.5224683, -1.569403, 11.352739, -2.7287858, 0.40094572, -2.1713347]
Target sample: 91, Prediction:6, Target's Score:[-2.1078446, 0.42574516, -1.9717779, 0.84418553, -1.6541908, -2.1814775, 11.691777, -2.8810506, 0.5956218, -2.463853]
Current ATTACK acc on target samples: 68.750
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 10:59:13 Epoch 59, Val iteration 0, acc 93.200 (93.200)
2021-06-11 10:59:34 Epoch 59, Val iteration 19, acc 93.800 (93.270)
* Prec: 93.27000160217285
Per class accuracy =  [0.95472526 0.96067539 0.90740167 0.83394389 0.95042048 0.90208095
 0.95805546 0.94543168 0.96059892 0.95514873]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 6, 1, 1, 6, 6, 1, 1, 1, 8, 6, 1, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 6, 1, 6, 1, 1, 6, 8, 6, 1, 1, 1, 1, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 1, 6, 1, 6, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 52.63157894736842
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  770
poison index =  1708
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 10:59:37, Val iteration 0, acc 92.600 (92.600)
2021-06-11 10:59:43, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 10:59:45, Epoch 0, Iteration 7, loss 0.299 (0.372), acc 88.462 (89.000)
2021-06-11 11:00:13, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.4984623, 8.14265, -2.2636673, -1.1536137, -5.6518416, -1.6232301, 9.343282, -4.814007, 0.5141851, -0.6906355]
Target sample: 7, Prediction:1, Target's Score:[-2.158159, 9.661239, -2.5541425, 0.29101834, -3.8255978, -1.7115084, 4.5665045, -4.8763638, 0.38749716, 0.5771964]
Target sample: 13, Prediction:1, Target's Score:[-1.8008851, 9.890531, -3.4947934, 1.2024075, -4.4479437, 0.64753616, 4.2675257, -4.570668, -3.513047, 2.1846406]
Target sample: 19, Prediction:1, Target's Score:[-3.6599681, 8.478885, -3.560561, 0.0755049, -4.9370985, 1.0724361, 6.257995, -5.5097203, 1.0021467, 1.1703154]
Target sample: 25, Prediction:6, Target's Score:[-3.1129773, 4.4321938, -1.4421304, 1.5930886, -5.4894505, -1.0315849, 5.036106, -4.0374856, 4.0125556, 0.38250738]
Target sample: 31, Prediction:1, Target's Score:[-0.5509658, 10.596047, -2.1580873, 1.817884, -5.1069393, -0.4626866, -0.75106823, -0.1714019, -2.3176668, -0.49472815]
Target sample: 37, Prediction:1, Target's Score:[-1.2455324, 10.004987, -3.425882, 1.6979579, -5.142026, -0.69693834, 5.430932, -5.7514567, -0.8828999, 0.36823183]
Target sample: 43, Prediction:1, Target's Score:[-3.3203466, 13.01134, -2.361398, -0.8855437, -5.005115, -0.59077877, 4.1358924, -4.2321444, -0.41878295, 0.056889698]
Target sample: 49, Prediction:1, Target's Score:[-1.7157739, 9.6760435, -4.818905, 1.6225749, -1.3280268, -2.2176023, 2.9360244, -3.2319267, -0.72339654, 0.19577466]
Target sample: 55, Prediction:1, Target's Score:[3.020594, 6.961706, -5.040208, 6.0243454, -3.1099176, -0.33502358, -0.68871516, -3.8950121, -3.4145272, 0.83999175]
Target sample: 61, Prediction:1, Target's Score:[-2.7255974, 13.049141, -2.0750244, -0.72582173, -6.21617, -0.6085798, 3.7706254, -3.3504634, -1.7965515, 1.0777515]
Target sample: 67, Prediction:1, Target's Score:[-2.5518615, 12.070439, -4.850208, 0.14679122, -3.7303352, -2.5744774, 2.7038922, -2.0439544, -1.5715313, 2.839137]
Target sample: 73, Prediction:1, Target's Score:[-3.0868022, 10.918432, -2.798719, 1.2370564, -4.3162704, -1.1134161, 0.6075422, -1.7088729, -0.7340505, 1.4145372]
Target sample: 79, Prediction:6, Target's Score:[-1.8226706, 5.5877876, -2.532351, 4.2106366, -4.2348914, -0.46196958, 6.7168074, -5.549022, -4.6467805, 3.0879648]
Target sample: 85, Prediction:6, Target's Score:[-1.8212306, 6.9519215, -2.1485353, -0.43871745, -5.344351, -1.4955566, 10.416783, -5.4683394, 1.1970228, -1.5507028]
Target sample: 91, Prediction:1, Target's Score:[-2.2142885, 10.443563, -2.6592312, 0.12531924, -5.0427165, -2.1782138, 7.8061314, -5.526329, -0.16646694, -0.22377163]
Current ATTACK acc on target samples: 25.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 11:00:40 Epoch 59, Val iteration 0, acc 89.000 (89.000)
2021-06-11 11:00:46 Epoch 59, Val iteration 19, acc 90.400 (89.210)
* Prec: 89.21000137329102
Per class accuracy =  [0.92099856 0.91978767 0.83852885 0.82756315 0.88305737 0.81921437
 0.93474909 0.89444925 0.92975911 0.94693673]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 6, 1, 1, 6, 1, 1, 1
ATTACK acc: 15.789473684210526
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  1212
poison index =  1088
poison index =  770
poison index =  1708
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 11:00:54, Val iteration 0, acc 96.200 (96.200)
2021-06-11 11:01:06, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 11:01:13, Epoch 0, Iteration 7, loss 0.480 (0.790), acc 88.462 (78.000)
2021-06-11 11:02:24, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.7444541, 4.4249387, -2.3167586, -1.4210784, -2.7823875, -2.9037764, 7.8668942, -3.0209374, 4.125724, -1.2214226]
Target sample: 7, Prediction:6, Target's Score:[-3.6386755, 7.1868653, -2.8472886, -2.8071868, -3.4652624, -2.3608677, 9.06865, -3.012961, 2.2329473, -0.34377584]
Target sample: 13, Prediction:6, Target's Score:[0.8083731, 4.3647943, -2.1084778, -1.395268, -1.6119599, -2.8530786, 4.516438, -2.4185765, -1.472129, 2.1751115]
Target sample: 19, Prediction:6, Target's Score:[-0.10413654, 2.379681, -0.27957013, -0.5289776, -0.65739274, -3.47367, 4.2060738, -1.3152772, -0.7580192, 0.5439242]
Target sample: 25, Prediction:6, Target's Score:[1.5206556, -0.2381568, -0.7668483, -1.3324775, -1.232784, -3.813797, 5.3210454, -1.7485167, 2.2502737, 0.060478143]
Target sample: 31, Prediction:6, Target's Score:[0.41204205, -0.048596293, 0.76016027, 2.212539, -2.4561024, -2.0300598, 3.828628, -2.202931, 0.31165892, -0.77399904]
Target sample: 37, Prediction:8, Target's Score:[0.19811232, 1.4625121, -3.6934013, 1.7289755, -0.43411982, -4.4277477, 3.5777574, -1.5131832, 4.1791945, -1.0747676]
Target sample: 43, Prediction:6, Target's Score:[-3.4524662, 5.1113753, -1.8778946, -0.86220306, -1.5617195, -3.1748514, 5.7877755, -3.04287, 3.438896, -0.36262187]
Target sample: 49, Prediction:8, Target's Score:[-0.58679, 3.1478913, -3.613181, 0.22826998, -2.575636, -3.8146892, 3.921036, -1.2337857, 5.479685, -0.9479918]
Target sample: 55, Prediction:0, Target's Score:[4.5021863, 1.9440175, -2.6016104, 2.262981, -0.036748078, -4.444546, 2.3803456, -1.1382575, -1.32648, -1.5236162]
Target sample: 61, Prediction:6, Target's Score:[-0.8620119, 1.5158535, -0.38129863, -0.4077839, -1.5018625, -3.3876123, 7.1129246, -2.8835528, -1.192817, 2.000288]
Target sample: 67, Prediction:9, Target's Score:[-0.2652306, 4.586329, -3.5304282, -1.8690627, -2.3203113, -4.129058, 3.439599, -2.2355433, -0.31764585, 6.6398425]
Target sample: 73, Prediction:3, Target's Score:[-2.4499724, 2.6236377, 0.66562855, 3.3474205, -1.6636208, -3.333518, 1.5970781, -2.889616, 0.26598984, 1.8420783]
Target sample: 79, Prediction:1, Target's Score:[-2.313923, 6.4398656, -3.2265754, -0.96566635, -1.6827089, -3.284432, 5.242641, -3.255877, -1.157895, 4.2047744]
Target sample: 85, Prediction:6, Target's Score:[-2.2562926, 4.4307766, -2.580173, -0.854331, -2.3988893, -2.9014676, 8.630796, -3.2317932, 2.7209945, -1.5513002]
Target sample: 91, Prediction:6, Target's Score:[-3.9093153, 5.8866076, -2.9581442, -1.8781675, -3.099779, -2.8949566, 9.274866, -3.1306565, 4.1383142, -1.4203954]
Current ATTACK acc on target samples: 62.500
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 11:03:34 Epoch 59, Val iteration 0, acc 93.200 (93.200)
2021-06-11 11:03:46 Epoch 59, Val iteration 19, acc 94.000 (93.050)
* Prec: 93.05000190734863
Per class accuracy =  [0.9542406  0.94033026 0.9039057  0.8842465  0.9507487  0.87372549
 0.94091655 0.93986198 0.95880173 0.95598896]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 1, 6, 6, 6, 6, 6, 6, 1, 1, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 3, 3, 6, 6, 6, 8, 8, 8, 1, 8, 1, 6, 8, 8, 8, 1, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 9, 6, 1, 1, 1, 9, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 67.10526315789474
--------
------SUMMARY------
TIME ELAPSED (mins): 24
TARGET INDEX: 15
ResNet50 18.75 19.736842105263158 95.46000137329102 89.82000160217285
DPN92 68.75 52.63157894736842 95.50000267028808 93.27000160217285
MobileNetV2 25.0 15.789473684210526 91.22000160217286 89.21000137329102
GoogLeNet 62.5 67.10526315789474 95.41000213623047 93.05000190734863
True False False False False
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 136 images of target 16
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=False, nearest=True, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=16, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/16/target-num-20
torch.Size([200, 1, 3, 32, 32]) torch.Size([23, 3, 32, 32])
Selected nearest neighbors: [1088, 1212, 1698, 600, 1829]
Selected base image indices: [1088, 1212, 1698, 600, 1829]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133]
# Targets: 23, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 11:04:23 Iteration 0 	 Training Loss: 7.314e-01 	 Loss in Target Net: 8.630e-01	  
tensor(-0.0003, device='cuda:0')
 2021-06-11 11:05:28 Iteration 50 	 Training Loss: 1.864e-01 	 Loss in Target Net: 5.756e-01	  
tensor(-0.0038, device='cuda:0')
 2021-06-11 11:06:32 Iteration 100 	 Training Loss: 1.630e-01 	 Loss in Target Net: 5.937e-01	  
tensor(-0.0092, device='cuda:0')
 2021-06-11 11:07:38 Iteration 150 	 Training Loss: 1.502e-01 	 Loss in Target Net: 6.415e-01	  
tensor(-0.0175, device='cuda:0')
 2021-06-11 11:08:40 Iteration 200 	 Training Loss: 1.484e-01 	 Loss in Target Net: 7.282e-01	  
tensor(-0.0266, device='cuda:0')
 2021-06-11 11:09:44 Iteration 250 	 Training Loss: 1.373e-01 	 Loss in Target Net: 7.046e-01	  
tensor(-0.0362, device='cuda:0')
 2021-06-11 11:10:51 Iteration 300 	 Training Loss: 1.384e-01 	 Loss in Target Net: 6.909e-01	  
tensor(-0.0461, device='cuda:0')
 2021-06-11 11:11:57 Iteration 350 	 Training Loss: 1.320e-01 	 Loss in Target Net: 7.290e-01	  
tensor(-0.0561, device='cuda:0')
 2021-06-11 11:13:03 Iteration 400 	 Training Loss: 1.271e-01 	 Loss in Target Net: 7.416e-01	  
tensor(-0.0629, device='cuda:0')
 2021-06-11 11:14:06 Iteration 450 	 Training Loss: 1.268e-01 	 Loss in Target Net: 6.579e-01	  
tensor(-0.0690, device='cuda:0')
 2021-06-11 11:15:11 Iteration 500 	 Training Loss: 1.249e-01 	 Loss in Target Net: 6.004e-01	  
tensor(-0.0740, device='cuda:0')
 2021-06-11 11:16:15 Iteration 550 	 Training Loss: 1.290e-01 	 Loss in Target Net: 7.196e-01	  
tensor(-0.0791, device='cuda:0')
 2021-06-11 11:17:18 Iteration 600 	 Training Loss: 1.210e-01 	 Loss in Target Net: 6.506e-01	  
tensor(-0.0825, device='cuda:0')
 2021-06-11 11:18:21 Iteration 650 	 Training Loss: 1.182e-01 	 Loss in Target Net: 7.051e-01	  
tensor(-0.0842, device='cuda:0')
 2021-06-11 11:19:25 Iteration 700 	 Training Loss: 1.241e-01 	 Loss in Target Net: 7.017e-01	  
tensor(-0.0894, device='cuda:0')
 2021-06-11 11:20:29 Iteration 750 	 Training Loss: 1.177e-01 	 Loss in Target Net: 6.918e-01	  
tensor(-0.0904, device='cuda:0')
 2021-06-11 11:21:32 Iteration 800 	 Training Loss: 1.222e-01 	 Loss in Target Net: 7.021e-01	  
tensor(-0.0909, device='cuda:0')
 2021-06-11 11:22:35 Iteration 850 	 Training Loss: 1.149e-01 	 Loss in Target Net: 6.662e-01	  
tensor(-0.0920, device='cuda:0')
 2021-06-11 11:23:37 Iteration 900 	 Training Loss: 1.192e-01 	 Loss in Target Net: 7.459e-01	  
tensor(-0.0905, device='cuda:0')
 2021-06-11 11:24:38 Iteration 950 	 Training Loss: 1.176e-01 	 Loss in Target Net: 6.013e-01	  
tensor(-0.0902, device='cuda:0')
 2021-06-11 11:25:43 Iteration 999 	 Training Loss: 1.228e-01 	 Loss in Target Net: 6.570e-01	  
tensor(-0.0910, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  600
poison index =  1829
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 11:25:49, Val iteration 0, acc 94.200 (94.200)
2021-06-11 11:25:58, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 11:26:04, Epoch 0, Iteration 7, loss 0.155 (0.282), acc 96.154 (94.800)
2021-06-11 11:27:04, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.4815276, 0.8689185, -1.7629787, -0.4733515, -0.64111763, -0.504202, 4.7898116, -2.318279, 0.14219077, 2.579347]
Target sample: 7, Prediction:6, Target's Score:[-2.9884574, 0.2316607, -1.5057775, -0.023224533, -0.61904764, -0.99423414, 5.5540195, -2.3379467, 0.059039194, 2.837964]
Target sample: 13, Prediction:6, Target's Score:[-2.5341794, 2.675654, -1.5776463, -0.80418843, -0.9069928, -0.31129807, 4.4385457, -2.4599335, 0.31421578, 1.3458955]
Target sample: 19, Prediction:6, Target's Score:[-3.0994036, -1.064755, -1.0545268, 0.27667385, -0.4711531, -2.5179703, 8.673513, -2.5013423, 0.24443787, 1.7381966]
Target sample: 25, Prediction:6, Target's Score:[-3.0989082, -0.8649554, -0.961847, -0.13208577, -0.4011117, -2.7010324, 8.472353, -2.4387088, 0.22858092, 2.119172]
Target sample: 31, Prediction:6, Target's Score:[-2.5802777, -0.770134, -0.7501979, 0.32004434, -0.14620772, -2.367929, 5.952613, -2.1598575, 1.2934957, 1.4033209]
Target sample: 37, Prediction:6, Target's Score:[-3.191756, -1.2692748, -1.1165535, 0.36052957, -0.3029613, -2.7266815, 6.9041796, -2.403005, 1.455332, 2.5197906]
Target sample: 43, Prediction:6, Target's Score:[-3.6275666, -1.3280188, -1.3997638, 0.23393136, -0.673606, -2.5328796, 8.912446, -2.3444092, 2.2748077, 0.7219134]
Target sample: 49, Prediction:6, Target's Score:[-3.2979848, -0.09624867, -1.3394715, -0.16756526, -0.4429266, -1.8181312, 7.798585, -2.1422985, 0.85240996, 0.8738483]
Target sample: 55, Prediction:6, Target's Score:[-2.905641, -1.644575, -1.0885136, 0.7730546, 0.15254912, -2.1593716, 8.078344, -1.748687, 0.59392905, 0.151132]
Target sample: 61, Prediction:6, Target's Score:[-3.3256335, -1.2155687, -1.0196398, -0.21661851, 0.013500489, -2.9657178, 7.156604, -2.6382327, -0.081258506, 4.5373445]
Target sample: 67, Prediction:6, Target's Score:[-3.223214, -0.12733823, -1.1952391, -0.536349, 1.3038658, -2.2035432, 5.5183773, -2.2907248, 0.3633771, 2.6016219]
Target sample: 73, Prediction:6, Target's Score:[-2.303858, 2.7094412, -1.012831, -0.9159973, 0.40033996, -1.0151962, 3.118312, -2.0769842, 0.7437178, 0.5017654]
Target sample: 79, Prediction:9, Target's Score:[-2.6418877, 0.031367, -0.85757047, -1.0431114, -0.10616841, -3.1515107, 4.488855, -2.4560413, -0.56224716, 6.5397267]
Target sample: 85, Prediction:6, Target's Score:[-2.0984862, 3.6721988, -0.7690279, -1.0798326, -0.49325895, -2.1628156, 5.001731, -2.239653, 0.75322646, -0.42646587]
Target sample: 91, Prediction:6, Target's Score:[-3.0356178, 0.20321187, -1.0055367, -0.31755874, -0.42601466, -2.3658185, 7.3273563, -2.2658665, 1.5339653, 0.5506831]
Target sample: 97, Prediction:6, Target's Score:[-2.744062, -0.5645349, -1.1593887, -0.25223505, -0.75662225, -2.6375616, 6.658954, -2.1942601, 2.718021, 1.1415412]
Target sample: 103, Prediction:6, Target's Score:[-3.2786837, -0.7242652, -1.5741976, -0.36203983, -0.8677492, -2.9933417, 5.3812704, -2.5549767, 3.1260123, 4.1058993]
Target sample: 109, Prediction:6, Target's Score:[-3.3209817, -1.3816547, -1.1315507, -0.12078678, -0.19306213, -2.5221798, 7.5378923, -2.35815, 1.9834403, 1.7338096]
Target sample: 115, Prediction:6, Target's Score:[-3.3846295, -0.12179716, -1.2247872, -0.5231885, -0.39114094, -2.712529, 8.449464, -2.2093062, 0.29955542, 2.0477078]
Target sample: 121, Prediction:6, Target's Score:[-2.7178543, -0.60400414, -0.9610088, -0.037796505, -0.104552574, -2.1020174, 6.434857, -2.0407603, -0.0667555, 2.3904727]
Target sample: 127, Prediction:6, Target's Score:[-2.7287364, 3.564079, -1.424413, -1.3894497, -0.7051698, -0.80016947, 3.9528193, -2.5764208, -0.33358586, 2.635586]
Target sample: 133, Prediction:6, Target's Score:[-2.4686866, 0.08815343, -1.2878909, 0.63656956, -0.19363621, -1.2606128, 5.325518, -2.3800714, 0.49382788, 1.2294294]
Current ATTACK acc on target samples: 95.652
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 11:28:03 Epoch 59, Val iteration 0, acc 90.200 (90.200)
2021-06-11 11:28:13 Epoch 59, Val iteration 19, acc 89.600 (89.950)
* Prec: 89.9500015258789
Per class accuracy =  [0.93165338 0.97054243 0.77289643 0.78286838 0.93315177 0.90595837
 0.93910608 0.88072646 0.95400259 0.92220078]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 9, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 9, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 9, 9, 9, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 95.57522123893806
--------
DPN92
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  600
poison index =  1829
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 11:28:25, Val iteration 0, acc 94.800 (94.800)
2021-06-11 11:28:45, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 11:29:00, Epoch 0, Iteration 7, loss 0.500 (0.470), acc 82.692 (88.400)
2021-06-11 11:31:40, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[0.7954703, 4.282978, -1.6885656, -2.4736419, -1.3088222, -1.8156537, 8.815363, -2.9658692, -1.4147972, -1.8956661]
Target sample: 7, Prediction:6, Target's Score:[0.70674366, 1.256234, -0.7662039, -1.6522067, -1.1057938, -1.8494356, 10.326457, -2.9779284, -0.42562115, -3.2034793]
Target sample: 13, Prediction:6, Target's Score:[1.317201, 0.30499643, -0.6606825, -1.6594483, -1.4639117, -2.792003, 10.663784, -2.7471998, -0.37008223, -2.2751396]
Target sample: 19, Prediction:6, Target's Score:[1.5708553, 1.1294332, -1.3164881, -2.0564022, -1.2915312, -3.1790695, 10.92926, -2.893273, -1.6113738, -0.93533313]
Target sample: 25, Prediction:6, Target's Score:[1.4693271, 6.94397, -2.0749118, -3.150426, -1.9655997, -3.0479226, 7.6754913, -2.4771059, -2.0720987, -0.9209126]
Target sample: 31, Prediction:1, Target's Score:[0.5456367, 6.7271075, -1.5257549, -2.9964843, -1.641717, -2.7298968, 6.394039, -3.419972, 0.653303, -1.6587471]
Target sample: 37, Prediction:6, Target's Score:[0.24013193, 3.8816793, -2.1563158, -2.2833831, -2.2648141, -2.9900105, 5.225126, -3.3378003, 3.681407, 0.34506541]
Target sample: 43, Prediction:6, Target's Score:[1.1827744, 0.32859144, -1.0157242, -2.4067895, -2.2393212, -2.8213823, 7.95903, -3.032211, 4.7027407, -2.3134995]
Target sample: 49, Prediction:6, Target's Score:[0.3966126, 2.2838724, -1.701597, -1.9334322, -1.8048908, -2.4939206, 8.066112, -3.4280915, 1.1134146, -0.16065292]
Target sample: 55, Prediction:6, Target's Score:[0.17119943, -1.057804, -1.107101, -0.96289206, 0.14624712, -2.9008944, 8.188917, -2.135781, 0.93205893, -1.0056144]
Target sample: 61, Prediction:1, Target's Score:[-1.5368891, 5.072229, -1.3650413, -2.276255, -0.5944259, -3.476054, 3.5198417, -3.2119792, 0.61753756, 3.531611]
Target sample: 67, Prediction:6, Target's Score:[-0.04911346, -0.3632662, -0.6572481, -1.4734627, -0.04833573, -2.6212475, 6.9004965, -2.6530943, 2.1816406, -0.95843214]
Target sample: 73, Prediction:6, Target's Score:[1.9313031, 1.9638721, -0.49577162, -1.1341553, -0.16825421, -2.986967, 5.59447, -2.2746549, -0.37243956, -1.7831024]
Target sample: 79, Prediction:6, Target's Score:[-0.4075438, 2.4366374, -1.353896, -2.5256152, 1.3837366, -4.154269, 7.0102673, -4.109275, -2.1114173, 4.1386476]
Target sample: 85, Prediction:1, Target's Score:[0.43570462, 8.708293, -1.986559, -3.258729, -1.0448899, -3.172508, 5.0696154, -3.4309738, -0.32801372, -0.6376134]
Target sample: 91, Prediction:1, Target's Score:[-0.069617555, 7.5996337, -1.9665147, -2.5514944, -1.8975381, -3.4539485, 4.784743, -2.8402321, 1.4343638, -0.69615805]
Target sample: 97, Prediction:6, Target's Score:[1.6037029, 0.8541271, -1.3447281, -2.2600014, -1.7195562, -3.4159763, 6.511912, -3.1747043, 3.945072, -0.66670525]
Target sample: 103, Prediction:8, Target's Score:[-0.09701342, 1.7559974, -1.5552932, -2.9892845, -2.6122391, -3.6911595, 3.4886243, -3.4793046, 7.9571133, 1.5845963]
Target sample: 109, Prediction:6, Target's Score:[-0.5119145, 4.0359607, -1.2906351, -2.607973, -1.8898976, -2.6312234, 5.6250424, -3.2118227, 1.908521, 0.8859686]
Target sample: 115, Prediction:1, Target's Score:[-0.01086707, 9.496369, -1.6134925, -3.5063956, -1.5746571, -3.0561771, 3.809793, -3.411597, -0.45278275, 0.6579158]
Target sample: 121, Prediction:1, Target's Score:[1.3345641, 5.462064, -1.8975092, -2.2910836, -1.5965052, -2.7535691, 5.3918114, -2.47325, -1.2530481, 0.3923394]
Target sample: 127, Prediction:6, Target's Score:[0.2991987, 0.14408354, -0.86811084, -2.6870189, -0.42569098, -1.9120342, 10.518262, -3.026265, -1.084723, -0.6651453]
Target sample: 133, Prediction:6, Target's Score:[1.4384692, 0.90160024, -0.6560858, -1.4835763, -1.2865341, -1.7516546, 11.624173, -2.88535, -1.9341034, -3.6298804]
Current ATTACK acc on target samples: 69.565
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 11:34:16 Epoch 59, Val iteration 0, acc 93.600 (93.600)
2021-06-11 11:34:37 Epoch 59, Val iteration 19, acc 93.000 (92.970)
* Prec: 92.97000160217286
Per class accuracy =  [0.93551853 0.97111836 0.90644801 0.84213964 0.94600129 0.88193458
 0.93911059 0.95901587 0.963686   0.95364117]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 1, 6, 6, 1, 6, 8, 6, 8, 6, 6, 6, 6, 6, 6, 6, 8, 6, 4, 4, 6, 6, 1, 1, 1, 6, 1, 6, 1, 1, 1, 1, 6, 1, 6, 6, 6, 6, 6, 6, 8, 6, 6, 8, 6, 6, 1, 1, 1, 1, 1, 1, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 67.2566371681416
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  600
poison index =  1829
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 11:34:41, Val iteration 0, acc 92.600 (92.600)
2021-06-11 11:34:46, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 11:34:49, Epoch 0, Iteration 7, loss 0.544 (0.344), acc 86.538 (89.200)
2021-06-11 11:35:16, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[1.559288, 4.9332533, -3.9746966, 1.2401863, -2.2746096, -2.4889407, 3.1458368, -4.3111825, -0.42787296, 2.9159963]
Target sample: 7, Prediction:6, Target's Score:[3.395412, 4.960489, -2.2914765, 2.8716896, -5.5388184, -3.332908, 7.3312573, -5.860706, -0.18025814, -1.0755479]
Target sample: 13, Prediction:6, Target's Score:[0.8268911, 3.230946, -2.5931807, 1.8574384, -4.0616665, -3.2942467, 7.506795, -5.985673, 1.2717831, 1.5413513]
Target sample: 19, Prediction:9, Target's Score:[4.4188747, 0.82823175, -3.6641521, 2.9055932, -1.8255877, -2.895502, 2.9743145, -4.4520826, -3.086823, 5.131568]
Target sample: 25, Prediction:1, Target's Score:[3.5046487, 7.8809676, -5.346349, 2.7306495, -3.588058, -2.4475276, 1.8154087, -4.8010077, -0.7142786, 1.286419]
Target sample: 31, Prediction:6, Target's Score:[0.41076657, 2.0867982, -3.5542562, 4.7886095, -3.1899326, -3.1543958, 5.9444284, -5.663276, 2.5433533, 0.09350546]
Target sample: 37, Prediction:3, Target's Score:[-0.73979306, 0.39023107, -4.94218, 4.85339, -2.3725798, -3.0765562, 3.9469347, -5.050908, 4.3784056, 2.9513454]
Target sample: 43, Prediction:6, Target's Score:[-1.4615436, -0.39326388, -2.009714, 4.5230336, -0.68991816, -2.9375277, 5.4927936, -3.6621025, 1.997096, -0.55928457]
Target sample: 49, Prediction:3, Target's Score:[0.9129749, 3.6543512, -3.0611, 4.5579405, 0.014435929, -3.1447709, 3.2066164, -5.657066, 0.62026507, -0.7649557]
Target sample: 55, Prediction:3, Target's Score:[0.90240246, -2.3578908, -0.574516, 7.289463, -1.6226279, -1.4487416, 4.9084034, -5.379219, 0.49133247, -1.9185039]
Target sample: 61, Prediction:9, Target's Score:[0.65847105, 3.2723486, -3.375738, 1.591717, -3.3914702, -3.1052465, 5.5258417, -5.2897387, -3.5774689, 8.026622]
Target sample: 67, Prediction:6, Target's Score:[0.53867054, -2.2670693, -1.2728359, 1.5751363, 1.194867, -4.4789615, 4.575137, -2.3711555, 2.6318603, 0.16923773]
Target sample: 73, Prediction:8, Target's Score:[2.4786716, 0.20091774, 0.091827124, 2.5172899, 0.6449119, -4.49077, 2.4441943, -4.2593017, 3.2512367, -2.6168144]
Target sample: 79, Prediction:9, Target's Score:[1.2529584, 4.841907, -5.0804157, 2.2604315, -2.3224032, -1.8263268, 3.0294075, -5.489625, -2.4651194, 6.1608043]
Target sample: 85, Prediction:1, Target's Score:[3.38526, 6.3815656, -4.940566, 1.7140064, -1.3101653, -2.6387057, 1.2701846, -3.9069304, 1.5793499, -1.2348592]
Target sample: 91, Prediction:1, Target's Score:[0.27428746, 10.299481, -6.297295, 2.8838866, -4.2664638, -2.8011377, 2.2504728, -4.325455, 0.20568274, 2.1298223]
Target sample: 97, Prediction:6, Target's Score:[0.5179437, -2.1891236, -1.4968544, 3.5374775, -1.4715775, -3.7241108, 3.617102, -3.9527159, 2.5355263, 2.9270177]
Target sample: 103, Prediction:9, Target's Score:[-1.9556779, 1.96438, -5.6283226, 3.1227226, -1.7178775, -1.9708745, 4.37938, -5.387824, 2.703885, 4.849213]
Target sample: 109, Prediction:6, Target's Score:[0.033840157, 2.2907383, -3.479567, 4.5826197, -2.8035483, -2.3653224, 6.0517993, -5.550034, -0.14857045, 1.7124637]
Target sample: 115, Prediction:1, Target's Score:[2.983698, 7.92954, -4.1847415, 2.9864314, -4.8841624, -2.6412249, 1.6709535, -3.3547957, -0.21379209, 0.017192349]
Target sample: 121, Prediction:3, Target's Score:[2.842163, 2.201502, -4.4346585, 3.5966523, -3.52897, -2.1251264, 2.50565, -3.1288462, 0.15927999, 2.1925664]
Target sample: 127, Prediction:6, Target's Score:[0.6199028, 4.0069804, -3.6101208, 3.0300133, -5.359823, -2.8063178, 6.138192, -5.0511827, -0.54796934, 3.8908696]
Target sample: 133, Prediction:6, Target's Score:[1.5020498, 3.9338944, -2.8790655, 4.577491, -5.1579614, -2.8671381, 7.006178, -5.451188, -1.0289612, 0.66638243]
Current ATTACK acc on target samples: 39.130
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 11:35:44 Epoch 59, Val iteration 0, acc 90.000 (90.000)
2021-06-11 11:35:50 Epoch 59, Val iteration 19, acc 90.000 (89.650)
* Prec: 89.65000190734864
Per class accuracy =  [0.92159036 0.93211915 0.84434987 0.82986124 0.89382763 0.83142474
 0.93355186 0.88865604 0.9348603  0.95087469]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 3, 1, 1, 1, 6, 1, 6, 6, 1, 1, 6, 6, 1, 1, 3, 1, 1, 6, 6, 0, 1, 1, 8, 8, 3, 3, 3, 6, 3, 6, 8, 9, 3, 6, 6, 6, 3, 1, 6, 6, 1, 1, 1, 3, 3, 3, 4, 6, 6, 6, 0, 6, 6, 8, 6, 8, 8, 3, 8, 3, 8, 8, 6, 3, 4, 6, 6, 3, 3, 1, 1, 3, 1, 1, 1, 1, 1, 6, 6, 6, 3, 6, 9, 3, 9, 9, 9, 6, 3, 3, 3, 3, 6, 3, 1, 1, 1, 6, 6, 0, 6, 6, 1, 3, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 37.16814159292036
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  600
poison index =  1829
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 11:35:58, Val iteration 0, acc 96.200 (96.200)
2021-06-11 11:36:10, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 11:36:17, Epoch 0, Iteration 7, loss 0.476 (0.795), acc 86.538 (79.200)
2021-06-11 11:37:28, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-0.3856646, 1.7766607, -3.740414, -0.624269, 0.43717057, -0.90417355, 7.1773906, -3.2805512, 1.2265211, -1.6718378]
Target sample: 7, Prediction:6, Target's Score:[0.50409204, -0.8944803, -2.3334413, -1.1890193, -2.2466843, -1.4549062, 9.629527, -2.427581, 1.8890595, -1.4584763]
Target sample: 13, Prediction:6, Target's Score:[-2.5395222, 3.0276856, -3.4094326, -2.3172388, -2.4398303, -2.3007312, 9.666263, -2.6578474, 5.6040373, -2.6027946]
Target sample: 19, Prediction:6, Target's Score:[2.8835104, 0.85274345, -2.9993374, -2.5786495, -2.5174599, -1.9451499, 8.10314, -2.5492532, 2.6063335, -1.8355968]
Target sample: 25, Prediction:6, Target's Score:[4.6786065, 0.46272352, -3.4006217, -2.3483715, -0.6667412, -0.5852724, 5.882107, -2.2134953, 1.0364902, -2.8259935]
Target sample: 31, Prediction:6, Target's Score:[0.6974294, -0.016070807, -3.005456, -3.1063514, -2.1416292, -1.3585417, 6.2199755, -3.2204857, 4.592887, 1.3670297]
Target sample: 37, Prediction:6, Target's Score:[0.7612299, 1.4044, -3.281748, -2.1697803, -2.0337458, -1.2711449, 6.6184072, -3.075134, 4.446722, -1.3671672]
Target sample: 43, Prediction:6, Target's Score:[1.8069291, 0.18377241, -2.5400138, -1.2871416, -1.6398385, -2.6986232, 6.279074, -1.8735473, 4.362811, -2.5652583]
Target sample: 49, Prediction:6, Target's Score:[-0.2867907, 1.1988984, -3.6737564, -1.8197131, -1.5932221, 1.3729811, 6.129783, -3.4476075, 2.157632, -0.008945031]
Target sample: 55, Prediction:6, Target's Score:[1.6382396, -1.3566017, -2.5405054, -2.3206658, 1.1230674, -1.6431959, 6.8791275, -1.6726123, 2.9473817, -3.0371149]
Target sample: 61, Prediction:6, Target's Score:[-2.779066, 4.2924876, -5.041924, -3.0343876, -1.6330371, 0.7262547, 5.5327897, -2.9171424, 0.10446117, 4.770754]
Target sample: 67, Prediction:6, Target's Score:[-0.67907107, -0.48433772, -3.77292, 1.7226387, 0.20402847, -0.46590507, 5.452284, -2.2829986, 3.0784109, -2.7449708]
Target sample: 73, Prediction:6, Target's Score:[4.736693, 0.35173264, -3.0958347, -0.35426733, 0.11092037, -3.3262546, 4.964203, -2.7310467, 2.8052008, -3.4425533]
Target sample: 79, Prediction:9, Target's Score:[1.6859847, 3.8916883, -4.4508166, -3.830873, -2.6164665, -2.4259589, 5.181258, -3.908963, -1.0937252, 7.570982]
Target sample: 85, Prediction:6, Target's Score:[3.3873818, 0.1774607, -3.32607, -3.0842292, -1.9598258, -0.4884068, 6.2781186, -0.8705667, 3.37164, -3.4493484]
Target sample: 91, Prediction:6, Target's Score:[1.7494785, 2.2763395, -3.171764, -2.4270992, -2.8972192, -2.8601305, 7.033445, -1.3086417, 2.8241456, -1.192455]
Target sample: 97, Prediction:6, Target's Score:[0.6742352, 0.24929062, -2.920288, -2.2676098, -1.845142, -2.572356, 8.155109, -2.666638, 5.3545628, -2.131245]
Target sample: 103, Prediction:6, Target's Score:[-0.2568448, 3.0241992, -3.7789288, -3.1973689, -2.7334847, -2.847864, 7.058289, -2.7094157, 5.342107, 0.13118605]
Target sample: 109, Prediction:6, Target's Score:[1.2615196, 0.34152874, -3.485802, -2.6254616, -1.912493, -1.2815876, 7.0329175, -2.6367612, 4.8936334, -1.5547267]
Target sample: 115, Prediction:6, Target's Score:[-1.189685, 2.1865706, -3.7376497, -1.0628419, -1.9272757, -0.11296518, 6.3055058, -3.0223682, 2.0642617, 0.52437705]
Target sample: 121, Prediction:1, Target's Score:[0.5245899, 4.6903644, -2.3731325, 0.3635298, -0.64078104, -2.136086, 3.8636532, -3.5189357, 0.7750573, -1.5318034]
Target sample: 127, Prediction:6, Target's Score:[0.0068174945, 0.7783948, -3.4797385, -1.1067686, -1.5879203, -1.4232447, 10.04518, -2.8449008, 1.8408673, -2.2136965]
Target sample: 133, Prediction:6, Target's Score:[-1.3582293, -0.4861345, -2.490944, 1.7069494, -2.71138, -1.0258799, 8.06011, -3.423413, 2.436612, -0.683111]
Current ATTACK acc on target samples: 91.304
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 11:38:38 Epoch 59, Val iteration 0, acc 91.400 (91.400)
2021-06-11 11:38:51 Epoch 59, Val iteration 19, acc 92.600 (92.490)
* Prec: 92.49000205993653
Per class accuracy =  [0.94842398 0.91922778 0.89835591 0.86544179 0.95636966 0.89223237
 0.95013291 0.92349395 0.93574412 0.95515077]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 8, 8, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 0, 6, 6, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 91.15044247787611
--------
------SUMMARY------
TIME ELAPSED (mins): 21
TARGET INDEX: 16
ResNet50 95.65217391304348 95.57522123893806 95.46000137329102 89.9500015258789
DPN92 69.56521739130434 67.2566371681416 95.50000267028808 92.97000160217286
MobileNetV2 39.130434782608695 37.16814159292036 91.22000160217286 89.65000190734864
GoogLeNet 91.30434782608695 91.15044247787611 95.41000213623047 92.49000205993653
True False False False True
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 136 images of target 16
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=True, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=16, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/16/target-num-20
torch.Size([200, 1, 3, 32, 32]) torch.Size([23, 3, 32, 32])
Selected nearest neighbors: [1088, 1212, 1698, 600, 1829]
Selected base image indices: [1088, 1212, 1698, 600, 1829]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133]
# Targets: 23, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 11:39:29 Iteration 0 	 Training Loss: 7.019e-01 	 Loss in Target Net: 5.577e-01	  
tensor(-0.0014, device='cuda:0')
 2021-06-11 11:40:43 Iteration 50 	 Training Loss: 3.212e-01 	 Loss in Target Net: 3.744e-01	  
tensor(-0.0344, device='cuda:0')
 2021-06-11 11:41:53 Iteration 100 	 Training Loss: 2.676e-01 	 Loss in Target Net: 3.668e-01	  
tensor(-0.0607, device='cuda:0')
 2021-06-11 11:43:04 Iteration 150 	 Training Loss: 2.600e-01 	 Loss in Target Net: 3.660e-01	  
tensor(-0.0749, device='cuda:0')
 2021-06-11 11:44:13 Iteration 200 	 Training Loss: 2.454e-01 	 Loss in Target Net: 3.587e-01	  
tensor(-0.0774, device='cuda:0')
 2021-06-11 11:45:23 Iteration 250 	 Training Loss: 2.423e-01 	 Loss in Target Net: 3.455e-01	  
tensor(-0.0798, device='cuda:0')
 2021-06-11 11:46:33 Iteration 300 	 Training Loss: 2.416e-01 	 Loss in Target Net: 3.433e-01	  
tensor(-0.0806, device='cuda:0')
 2021-06-11 11:47:42 Iteration 350 	 Training Loss: 2.430e-01 	 Loss in Target Net: 3.286e-01	  
tensor(-0.0815, device='cuda:0')
 2021-06-11 11:48:56 Iteration 400 	 Training Loss: 2.364e-01 	 Loss in Target Net: 3.432e-01	  
tensor(-0.0809, device='cuda:0')
 2021-06-11 11:50:06 Iteration 450 	 Training Loss: 2.378e-01 	 Loss in Target Net: 3.753e-01	  
tensor(-0.0799, device='cuda:0')
 2021-06-11 11:51:14 Iteration 500 	 Training Loss: 2.348e-01 	 Loss in Target Net: 3.424e-01	  
tensor(-0.0798, device='cuda:0')
 2021-06-11 11:52:24 Iteration 550 	 Training Loss: 2.413e-01 	 Loss in Target Net: 3.179e-01	  
tensor(-0.0779, device='cuda:0')
 2021-06-11 11:53:35 Iteration 600 	 Training Loss: 2.367e-01 	 Loss in Target Net: 3.188e-01	  
tensor(-0.0773, device='cuda:0')
 2021-06-11 11:54:46 Iteration 650 	 Training Loss: 2.341e-01 	 Loss in Target Net: 3.201e-01	  
tensor(-0.0792, device='cuda:0')
 2021-06-11 11:55:56 Iteration 700 	 Training Loss: 2.350e-01 	 Loss in Target Net: 3.004e-01	  
tensor(-0.0785, device='cuda:0')
 2021-06-11 11:57:06 Iteration 750 	 Training Loss: 2.336e-01 	 Loss in Target Net: 3.093e-01	  
tensor(-0.0785, device='cuda:0')
 2021-06-11 11:58:19 Iteration 800 	 Training Loss: 2.354e-01 	 Loss in Target Net: 2.887e-01	  
tensor(-0.0774, device='cuda:0')
 2021-06-11 11:59:31 Iteration 850 	 Training Loss: 2.362e-01 	 Loss in Target Net: 2.895e-01	  
tensor(-0.0775, device='cuda:0')
 2021-06-11 12:00:42 Iteration 900 	 Training Loss: 2.376e-01 	 Loss in Target Net: 3.049e-01	  
tensor(-0.0779, device='cuda:0')
 2021-06-11 12:01:54 Iteration 950 	 Training Loss: 2.362e-01 	 Loss in Target Net: 3.012e-01	  
tensor(-0.0780, device='cuda:0')
 2021-06-11 12:03:04 Iteration 999 	 Training Loss: 2.424e-01 	 Loss in Target Net: 2.971e-01	  
tensor(-0.0756, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  600
poison index =  1829
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 12:03:09, Val iteration 0, acc 94.200 (94.200)
2021-06-11 12:03:19, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 12:03:24, Epoch 0, Iteration 7, loss 1.023 (0.668), acc 76.923 (87.000)
2021-06-11 12:04:25, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-3.7188437, -0.9232627, 2.0654614, -0.9741087, 0.9139602, -2.987726, 11.443164, -3.3886569, -0.3841199, -2.1075757]
Target sample: 7, Prediction:6, Target's Score:[-4.040898, -1.0376858, 1.9812633, 0.36049202, 0.6080313, -3.0467737, 11.210758, -3.4396617, -0.43703303, -2.226756]
Target sample: 13, Prediction:6, Target's Score:[-4.0416956, 1.1384698, 1.6003611, -0.6379423, -0.09395842, -2.9245944, 10.770692, -3.2028234, 0.11080684, -2.787122]
Target sample: 19, Prediction:6, Target's Score:[-4.2590065, 0.22397749, 1.2025901, -1.451152, 0.19115826, -3.210787, 10.750857, -3.3593855, -0.17811437, -0.002946183]
Target sample: 25, Prediction:6, Target's Score:[-4.917122, 4.0435305, 1.2742362, -1.6091032, -0.43271053, -3.457282, 9.950966, -3.4160259, -0.2851651, -1.2878474]
Target sample: 31, Prediction:6, Target's Score:[-4.3204317, 1.1587754, 0.71855134, -1.2389989, -0.061034527, -3.1894076, 10.374179, -3.271891, 1.2543914, -1.5226839]
Target sample: 37, Prediction:6, Target's Score:[-4.7331777, -1.0601127, 0.3751681, -1.1607842, 0.04127154, -3.3227525, 10.20125, -3.7203567, 4.488212, -1.2211043]
Target sample: 43, Prediction:6, Target's Score:[-5.144544, -1.9668429, 0.19688731, -1.5258328, -0.31473354, -3.845722, 9.460268, -4.152537, 8.80958, -1.681199]
Target sample: 49, Prediction:6, Target's Score:[-5.2956553, -0.7950262, 0.43780398, -1.438581, -0.29803053, -2.8723774, 9.582004, -4.1600966, 4.222731, 0.46919048]
Target sample: 55, Prediction:6, Target's Score:[-4.0733223, -1.8744167, 0.20297053, -0.31385633, 2.5516498, -2.8635242, 9.326865, -3.0586803, 2.1036925, -2.1269972]
Target sample: 61, Prediction:6, Target's Score:[-4.3890734, -0.91674954, 1.3339127, -0.9159631, 0.5230296, -3.1662145, 9.799024, -3.3521147, 2.291465, -1.3093368]
Target sample: 67, Prediction:6, Target's Score:[-5.5392413, -1.9760114, 0.15520777, 0.18787389, 1.8350699, -3.1926248, 8.750386, -3.1350987, 4.5838313, -1.8215914]
Target sample: 73, Prediction:6, Target's Score:[-4.7897377, -1.4574655, 1.9540573, -0.90387285, 1.1852542, -3.0818741, 10.778245, -3.8683171, 2.2147248, -2.1210957]
Target sample: 79, Prediction:6, Target's Score:[-5.003186, -1.2169164, 0.68169755, -0.7079622, 0.38159385, -3.1768303, 9.1622, -3.8070712, 2.5510037, 0.99868125]
Target sample: 85, Prediction:6, Target's Score:[-4.5820994, 4.0604157, 0.8591416, -2.0446122, -0.10574898, -3.7538087, 10.702654, -3.1346486, 0.37102, -2.4966297]
Target sample: 91, Prediction:6, Target's Score:[-5.0980754, 0.058235236, 0.85312235, -1.1998936, -0.3346894, -3.511327, 10.505638, -3.469248, 3.921397, -1.8359334]
Target sample: 97, Prediction:6, Target's Score:[-4.384782, -1.8476071, 0.46842876, -1.731996, -0.5010122, -3.4985507, 8.245394, -4.0104923, 7.748936, -0.6431991]
Target sample: 103, Prediction:6, Target's Score:[-5.9378753, -1.2523676, -0.4182026, -1.5431248, -0.7217942, -3.446135, 7.9571815, -4.453815, 7.5415883, 2.0704775]
Target sample: 109, Prediction:6, Target's Score:[-5.062326, -1.3671035, 1.2205449, -0.58745015, 0.3936285, -3.1276102, 11.098973, -3.9176579, 2.7102518, -1.457667]
Target sample: 115, Prediction:6, Target's Score:[-4.7331567, 3.088888, 0.48118696, -1.8122553, -0.6411432, -3.2759538, 10.232757, -3.1760812, -0.48604268, 0.19872461]
Target sample: 121, Prediction:6, Target's Score:[-4.513034, -0.043311924, 1.7718563, -1.1174425, 0.40145615, -2.9032493, 11.054469, -3.5293636, -0.28012425, -0.9273367]
Target sample: 127, Prediction:6, Target's Score:[-4.831051, -1.076266, 1.6028162, -1.2477173, 0.43140164, -3.2366538, 10.450113, -3.8491478, 0.12458719, 1.5147525]
Target sample: 133, Prediction:6, Target's Score:[-3.6701748, -0.67940646, 0.66045666, 0.58499455, 0.37369618, -2.7821262, 10.7139225, -2.3807123, -0.5068727, -2.3788292]
Current ATTACK acc on target samples: 100.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 12:05:24 Epoch 59, Val iteration 0, acc 90.000 (90.000)
2021-06-11 12:05:34 Epoch 59, Val iteration 19, acc 88.800 (90.070)
* Prec: 90.07000160217285
Per class accuracy =  [0.90253567 0.9299869  0.82145707 0.86031577 0.93678598 0.82962074
 0.94959233 0.87706513 0.95222595 0.9450934 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 100.0
--------
DPN92
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  600
poison index =  1829
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 12:05:46, Val iteration 0, acc 94.800 (94.800)
2021-06-11 12:06:07, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 12:06:21, Epoch 0, Iteration 7, loss 0.460 (0.294), acc 90.385 (92.800)
2021-06-11 12:09:00, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.0441804, 1.608023, -1.6271234, -0.98114896, -0.31913793, -0.32265422, 9.939999, -2.8984978, -2.4591165, -1.5792153]
Target sample: 7, Prediction:6, Target's Score:[-1.0133654, -0.79146194, -0.8215659, -0.585408, -0.11311621, -0.6251234, 12.160055, -2.965682, -1.9080648, -3.037115]
Target sample: 13, Prediction:6, Target's Score:[-0.35995564, -1.3284345, -0.5950015, -0.86816555, -0.16714968, -1.4312657, 11.811743, -2.8892412, -1.2518133, -2.6215236]
Target sample: 19, Prediction:6, Target's Score:[-0.3259536, -1.906098, -0.68438387, -1.3568007, 0.0039695306, -0.9844526, 13.484309, -3.3088844, -2.208391, -2.376896]
Target sample: 25, Prediction:6, Target's Score:[-0.51594687, 2.6583004, -1.7715399, -1.9299749, -0.6916039, -0.75562066, 10.657691, -2.6843274, -2.672778, -1.9219221]
Target sample: 31, Prediction:6, Target's Score:[-0.9899722, 1.1855656, -1.3767167, -1.5575726, -0.008807545, -0.5988978, 10.136292, -3.066151, -0.9366396, -2.4561243]
Target sample: 37, Prediction:6, Target's Score:[-0.9495864, 0.07287747, -2.7493923, -1.0949247, -0.47790596, -0.73073816, 8.369844, -2.8987489, 0.8363436, -0.029395359]
Target sample: 43, Prediction:6, Target's Score:[-0.8764161, -1.4669245, -1.2334781, -1.0818484, -0.31033242, -0.9849169, 10.694987, -2.830002, 1.1587877, -2.7427273]
Target sample: 49, Prediction:6, Target's Score:[-0.41391116, -0.60540766, -2.426024, -0.83019876, -0.8257017, -0.76759493, 9.4018, -3.090446, -0.38433498, 0.31276214]
Target sample: 55, Prediction:6, Target's Score:[-0.69785774, -2.167903, -0.9650233, 0.51280767, 1.170813, -1.6839898, 9.012479, -2.4440522, -0.35628328, -2.1117468]
Target sample: 61, Prediction:9, Target's Score:[-1.0291665, 1.9271362, -2.6943889, -0.39999193, 1.1918974, -1.5345396, 2.0499868, -2.8030255, -1.1771677, 4.839162]
Target sample: 67, Prediction:6, Target's Score:[-0.9983612, -2.5267816, -1.232996, 0.902842, 1.4203931, -1.8431034, 8.10713, -2.2316344, 0.48523796, -1.791368]
Target sample: 73, Prediction:6, Target's Score:[0.72553766, -1.9801531, -0.33412874, 0.52157456, 1.7268306, -2.1691768, 6.5840597, -2.002847, -0.63047975, -2.1760447]
Target sample: 79, Prediction:6, Target's Score:[-1.2203562, 1.4066525, -2.8047264, -1.7989103, 2.2125676, -1.2814792, 5.35566, -3.6131675, -2.638181, 4.791269]
Target sample: 85, Prediction:6, Target's Score:[-0.73864853, 4.552749, -2.4642792, -1.7500187, -0.2378828, -1.0697415, 7.7653813, -2.772775, -1.5663702, -1.3427868]
Target sample: 91, Prediction:6, Target's Score:[-0.5382936, 2.4226484, -2.4731967, -1.3217094, -0.4085941, -1.4808655, 8.126309, -2.2793748, 0.018704817, -1.7030932]
Target sample: 97, Prediction:6, Target's Score:[-0.13909066, -0.43590733, -1.7592059, -1.236201, -0.43087524, -1.143715, 9.118079, -2.5672882, 0.6396559, -1.7248276]
Target sample: 103, Prediction:6, Target's Score:[-0.36115056, 0.3739807, -3.4353895, -1.7905823, -1.3400942, -1.2583455, 5.261387, -2.6380289, 4.7365565, 0.8687858]
Target sample: 109, Prediction:6, Target's Score:[-1.1796528, 1.1726345, -2.1092474, -1.7658249, -0.5039396, -0.6004219, 7.221973, -2.8236058, 0.09945467, 0.84530383]
Target sample: 115, Prediction:1, Target's Score:[-0.8463078, 7.5823355, -3.4245758, -2.2392285, -1.4306879, -1.4013169, 4.0564847, -2.954221, -0.5989613, 1.6910474]
Target sample: 121, Prediction:6, Target's Score:[-0.62552094, 3.1467083, -2.4846132, -1.0890554, -0.5227846, -1.3969944, 6.307431, -2.9707358, -1.711325, 1.7024058]
Target sample: 127, Prediction:6, Target's Score:[-1.3380873, -0.6168604, -1.2600859, -1.3598859, 0.25288618, -0.4573623, 10.740462, -3.1297092, -2.0287812, -0.49731568]
Target sample: 133, Prediction:6, Target's Score:[-0.52897793, -1.0397353, -0.48000708, -0.4496066, -0.22471501, -0.8096286, 12.784041, -3.03422, -2.6279552, -3.2752986]
Current ATTACK acc on target samples: 91.304
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 12:11:35 Epoch 59, Val iteration 0, acc 93.000 (93.000)
2021-06-11 12:11:56 Epoch 59, Val iteration 19, acc 93.000 (92.730)
* Prec: 92.7300018310547
Per class accuracy =  [0.94656568 0.96285515 0.86780742 0.8508782  0.94498053 0.89300744
 0.94038516 0.94431559 0.97162548 0.95388308]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 6, 4, 4, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 1, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 92.92035398230088
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  600
poison index =  1829
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 12:12:00, Val iteration 0, acc 92.600 (92.600)
2021-06-11 12:12:06, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 12:12:08, Epoch 0, Iteration 7, loss 0.323 (0.362), acc 88.462 (89.200)
2021-06-11 12:12:36, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[1.3499953, 2.6647499, -1.9526936, 1.5092868, -2.6223273, -2.4439907, 6.302017, -4.6928067, -0.8334547, 0.9827551]
Target sample: 7, Prediction:6, Target's Score:[3.2298326, 2.648895, -1.0047022, 3.0266063, -4.876901, -3.0257473, 9.337566, -5.6706915, -0.48748147, -2.9591405]
Target sample: 13, Prediction:6, Target's Score:[0.55215114, 0.73376846, -0.857716, 2.004943, -3.667827, -3.0550382, 10.179849, -6.0931273, 0.5489038, -0.09931827]
Target sample: 19, Prediction:6, Target's Score:[2.9799707, -1.1033055, -1.827276, 3.1323686, -0.8673783, -3.0652578, 6.340336, -4.575491, -3.5379663, 2.7799757]
Target sample: 25, Prediction:1, Target's Score:[3.280198, 5.363595, -3.671434, 2.3364203, -3.0377498, -2.9164498, 5.1556396, -4.7359633, -1.0113721, -0.4763561]
Target sample: 31, Prediction:6, Target's Score:[-0.2167527, -1.0664319, -1.7421117, 4.4826612, -1.7307745, -3.2686498, 8.130735, -5.141274, 2.0217545, -1.2397637]
Target sample: 37, Prediction:6, Target's Score:[-1.6934887, -1.8837504, -3.1127918, 4.7766304, -1.6498902, -3.2308168, 7.3236523, -5.017889, 3.7446861, 1.0059175]
Target sample: 43, Prediction:6, Target's Score:[-1.8419496, -2.5452592, -0.31467384, 4.192188, -0.06565363, -3.0234635, 8.716918, -4.318835, 1.2546716, -1.834038]
Target sample: 49, Prediction:6, Target's Score:[0.31936514, 1.0901065, -1.1608764, 4.1654205, 0.6293799, -3.2370136, 5.8462296, -5.692571, 0.42719847, -2.1065967]
Target sample: 55, Prediction:3, Target's Score:[0.1264215, -4.108691, 1.8231525, 7.2853103, -0.8226548, -1.3004009, 6.480485, -5.3874207, -0.41718316, -3.4969616]
Target sample: 61, Prediction:6, Target's Score:[0.37774295, 1.4037869, -1.6515191, 1.334683, -2.7596, -2.9728827, 8.07489, -5.0573936, -3.9012566, 5.4267364]
Target sample: 67, Prediction:6, Target's Score:[0.21307717, -3.3752635, -0.038769312, 1.438242, 1.2447817, -4.3064814, 6.4702387, -2.7309253, 2.16737, -0.83404696]
Target sample: 73, Prediction:6, Target's Score:[2.0701334, -1.6111922, 2.5137024, 2.2711263, 0.68421185, -4.3052483, 4.3137746, -4.639898, 2.289302, -3.3431756]
Target sample: 79, Prediction:6, Target's Score:[0.6940527, 2.9022787, -3.5951529, 2.1117117, -1.8502439, -2.0042336, 6.3386726, -5.5489573, -2.7420876, 3.99819]
Target sample: 85, Prediction:6, Target's Score:[3.1379824, 3.6415179, -3.328726, 1.2608765, -0.88382107, -2.862526, 4.0012765, -4.2528744, 1.9137874, -2.3545895]
Target sample: 91, Prediction:1, Target's Score:[-0.09149791, 7.063246, -4.5427146, 2.416799, -3.702921, -3.040772, 5.8596416, -4.5424614, 0.6275912, 0.28265783]
Target sample: 97, Prediction:6, Target's Score:[-0.19512995, -4.0703373, 0.49532798, 3.3685248, -0.60635954, -3.6766233, 6.2616553, -4.248761, 1.6214652, 1.288808]
Target sample: 103, Prediction:6, Target's Score:[-2.7321188, -0.5370612, -3.715843, 2.6830747, -0.73534447, -2.388214, 7.679845, -5.4782257, 2.9502583, 2.5639775]
Target sample: 109, Prediction:6, Target's Score:[-0.44568223, -0.90840656, -0.6506689, 4.6165824, -2.2305632, -2.5039833, 9.416224, -5.6699796, -0.60046935, -0.7989419]
Target sample: 115, Prediction:6, Target's Score:[2.4534414, 4.9277186, -1.9877824, 2.7089207, -3.5622144, -3.1868536, 5.0063877, -3.4042811, -1.1397662, -1.525675]
Target sample: 121, Prediction:6, Target's Score:[2.1118946, -1.1413844, -2.759205, 3.954141, -2.0673869, -2.4780204, 5.530997, -2.8858192, 0.07273877, -0.13827348]
Target sample: 127, Prediction:6, Target's Score:[-0.004032865, 1.3810451, -1.9036407, 2.8977196, -4.1533117, -2.6140966, 9.300248, -5.203843, -0.7913909, 1.3303311]
Target sample: 133, Prediction:6, Target's Score:[0.6449564, 0.4143206, -0.5612095, 4.66698, -3.634253, -2.743606, 9.822254, -5.06365, -1.7825565, -1.554334]
Current ATTACK acc on target samples: 86.957
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 12:13:04 Epoch 59, Val iteration 0, acc 90.000 (90.000)
2021-06-11 12:13:10 Epoch 59, Val iteration 19, acc 90.400 (89.440)
* Prec: 89.44000205993652
Per class accuracy =  [0.92348177 0.93094439 0.84014491 0.82829509 0.89483415 0.82629815
 0.93218997 0.89204386 0.92644591 0.945958  ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 1, 6, 6, 6, 6, 0, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 3, 3, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 3, 6, 3, 4, 6, 6, 6, 0, 6, 6, 6, 6, 8, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 3, 6, 6, 6, 6, 1, 6, 6, 1, 6, 6, 6, 6, 6, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 0, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 85.84070796460178
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  600
poison index =  1829
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 12:13:18, Val iteration 0, acc 96.200 (96.200)
2021-06-11 12:13:30, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 12:13:37, Epoch 0, Iteration 7, loss 0.202 (0.680), acc 90.385 (83.000)
2021-06-11 12:14:48, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[0.5869206, 0.9403407, -2.3422334, -0.41841602, -0.27140874, -2.9946375, 11.315005, -2.8511825, -1.3187705, -2.569243]
Target sample: 7, Prediction:6, Target's Score:[0.46203604, -1.0982077, -0.46298158, 0.36683932, -1.828896, -3.7570145, 12.925337, -2.1000195, -1.1576734, -3.2743528]
Target sample: 13, Prediction:6, Target's Score:[0.009989649, 2.3354318, -2.1759987, -0.90376407, -2.6672218, -3.2692235, 12.538185, -2.7962668, 0.1983794, -3.1855595]
Target sample: 19, Prediction:6, Target's Score:[2.1833835, 1.7813902, -2.7060592, 0.02017803, -2.2207992, -3.5725756, 9.230671, -2.7313294, -0.023003634, -1.8727204]
Target sample: 25, Prediction:6, Target's Score:[2.3534079, 3.7034528, -3.6208503, -0.28582087, -0.6883936, -3.9249058, 6.6747594, -2.5429366, 0.67582077, -2.2459161]
Target sample: 31, Prediction:6, Target's Score:[-0.9347509, 4.190552, -2.8145669, -2.055039, -2.4218369, -2.8668032, 7.730327, -3.1949048, 1.2961869, 1.1697518]
Target sample: 37, Prediction:6, Target's Score:[0.084502846, 3.4528434, -3.0565772, -0.7189946, -1.5039451, -2.5376198, 8.002432, -3.6019168, -0.08150649, 0.05601001]
Target sample: 43, Prediction:6, Target's Score:[-0.48517817, 0.88329065, -2.325852, -0.1449637, -0.76029307, -3.1024926, 10.231197, -1.8576745, -0.4077102, -1.9571788]
Target sample: 49, Prediction:6, Target's Score:[-0.7074701, 2.8855097, -3.0463681, 0.19297068, -1.8669405, -1.5786477, 9.263735, -3.188701, -1.0950084, -0.7655323]
Target sample: 55, Prediction:6, Target's Score:[2.5300636, -1.8080523, -1.3365238, -1.5987452, 1.5331348, -3.320704, 9.599474, -1.5291529, -0.79172057, -3.1923308]
Target sample: 61, Prediction:6, Target's Score:[-1.7960005, 4.2745924, -3.6099029, -1.5231045, 0.50241107, -1.931882, 6.088295, -2.7361817, -1.8710465, 2.7153409]
Target sample: 67, Prediction:6, Target's Score:[-1.1236571, 0.16912508, -3.3036957, 0.58208996, 2.8933947, -2.77158, 6.5695496, -2.7546139, 2.6765842, -2.862143]
Target sample: 73, Prediction:6, Target's Score:[3.0355816, 1.6224575, -1.9981892, -0.6692279, 0.41087997, -4.3577213, 6.030114, -3.4517722, 2.5043993, -3.0292659]
Target sample: 79, Prediction:9, Target's Score:[0.882198, 5.1942425, -4.084826, -2.7216854, -3.1255803, -4.408207, 5.3020496, -3.747867, -1.0512629, 7.9164906]
Target sample: 85, Prediction:6, Target's Score:[3.1264682, 3.8798664, -2.745003, -2.0460324, -1.1077291, -3.3351107, 6.044564, -2.30369, 1.2505367, -2.6599743]
Target sample: 91, Prediction:6, Target's Score:[0.20502707, 4.424946, -2.816573, -1.1738582, -2.448808, -3.9415267, 8.032641, -1.8812585, 0.22112978, -0.52514714]
Target sample: 97, Prediction:6, Target's Score:[0.08858374, 0.21702081, -2.0289688, -0.6201591, -1.5574228, -3.1056302, 10.830373, -3.4170334, 1.4914095, -1.8273529]
Target sample: 103, Prediction:6, Target's Score:[-0.5715786, 3.908144, -3.2971184, -1.8874454, -2.9449153, -3.6663387, 9.365522, -2.3123517, 0.30236733, 1.2049948]
Target sample: 109, Prediction:6, Target's Score:[-0.40853247, 1.0947883, -2.7747085, -1.3200024, -1.1484076, -2.2193625, 9.249309, -3.6133065, 0.9374527, 0.29253224]
Target sample: 115, Prediction:6, Target's Score:[-1.6684349, 4.561924, -3.2738376, 0.0778955, -2.7937398, -2.5366488, 8.673378, -2.553174, -1.1867213, 0.7978452]
Target sample: 121, Prediction:1, Target's Score:[1.2964884, 7.473401, -2.9340408, 0.090884544, -1.5100533, -3.7924116, 5.1309576, -3.084039, -1.5556085, -1.0030578]
Target sample: 127, Prediction:6, Target's Score:[0.2219049, -0.65712327, -1.9319304, -0.5744327, -2.4348567, -2.9004548, 12.040066, -2.7050245, 0.15245451, -1.1337755]
Target sample: 133, Prediction:6, Target's Score:[-1.5599244, -0.5892723, -1.4420166, 1.922037, -1.8526343, -3.2609446, 11.46474, -1.7232376, -0.6171784, -2.27363]
Current ATTACK acc on target samples: 91.304
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 12:15:58 Epoch 59, Val iteration 0, acc 92.400 (92.400)
2021-06-11 12:16:11 Epoch 59, Val iteration 19, acc 95.000 (92.900)
* Prec: 92.9000015258789
Per class accuracy =  [0.95663677 0.94347462 0.87716832 0.86317268 0.94941841 0.89399833
 0.96172732 0.93759565 0.9497509  0.95892924]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 0, 6, 6, 6, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 92.03539823008849
--------
------SUMMARY------
TIME ELAPSED (mins): 23
TARGET INDEX: 16
ResNet50 100.0 100.0 95.46000137329102 90.07000160217285
DPN92 91.30434782608695 92.92035398230088 95.50000267028808 92.7300018310547
MobileNetV2 86.95652173913044 85.84070796460178 91.22000160217286 89.44000205993652
GoogLeNet 91.30434782608695 92.03539823008849 95.41000213623047 92.9000015258789
True False False False False
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 129 images of target 17
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=False, nearest=True, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=17, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/17/target-num-20
torch.Size([200, 1, 3, 32, 32]) torch.Size([22, 3, 32, 32])
Selected nearest neighbors: [1088, 1212, 600, 1698, 1829]
Selected base image indices: [1088, 1212, 600, 1698, 1829]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127]
# Targets: 22, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 12:16:47 Iteration 0 	 Training Loss: 7.471e-01 	 Loss in Target Net: 9.087e-01	  
tensor(2.9876e-05, device='cuda:0')
 2021-06-11 12:17:49 Iteration 50 	 Training Loss: 1.799e-01 	 Loss in Target Net: 5.990e-01	  
tensor(0.0005, device='cuda:0')
 2021-06-11 12:18:50 Iteration 100 	 Training Loss: 1.571e-01 	 Loss in Target Net: 6.345e-01	  
tensor(-0.0011, device='cuda:0')
 2021-06-11 12:19:52 Iteration 150 	 Training Loss: 1.439e-01 	 Loss in Target Net: 6.446e-01	  
tensor(-0.0035, device='cuda:0')
 2021-06-11 12:20:55 Iteration 200 	 Training Loss: 1.373e-01 	 Loss in Target Net: 6.495e-01	  
tensor(-0.0059, device='cuda:0')
 2021-06-11 12:21:58 Iteration 250 	 Training Loss: 1.270e-01 	 Loss in Target Net: 6.914e-01	  
tensor(-0.0088, device='cuda:0')
 2021-06-11 12:22:58 Iteration 300 	 Training Loss: 1.246e-01 	 Loss in Target Net: 6.922e-01	  
tensor(-0.0121, device='cuda:0')
 2021-06-11 12:24:01 Iteration 350 	 Training Loss: 1.277e-01 	 Loss in Target Net: 7.300e-01	  
tensor(-0.0162, device='cuda:0')
 2021-06-11 12:25:01 Iteration 400 	 Training Loss: 1.188e-01 	 Loss in Target Net: 6.740e-01	  
tensor(-0.0205, device='cuda:0')
 2021-06-11 12:26:04 Iteration 450 	 Training Loss: 1.132e-01 	 Loss in Target Net: 6.464e-01	  
tensor(-0.0239, device='cuda:0')
 2021-06-11 12:27:05 Iteration 500 	 Training Loss: 1.166e-01 	 Loss in Target Net: 6.681e-01	  
tensor(-0.0255, device='cuda:0')
 2021-06-11 12:28:07 Iteration 550 	 Training Loss: 1.173e-01 	 Loss in Target Net: 6.911e-01	  
tensor(-0.0284, device='cuda:0')
 2021-06-11 12:29:09 Iteration 600 	 Training Loss: 1.108e-01 	 Loss in Target Net: 5.793e-01	  
tensor(-0.0302, device='cuda:0')
 2021-06-11 12:30:13 Iteration 650 	 Training Loss: 1.069e-01 	 Loss in Target Net: 5.645e-01	  
tensor(-0.0315, device='cuda:0')
 2021-06-11 12:31:15 Iteration 700 	 Training Loss: 1.202e-01 	 Loss in Target Net: 6.153e-01	  
tensor(-0.0327, device='cuda:0')
 2021-06-11 12:32:16 Iteration 750 	 Training Loss: 1.150e-01 	 Loss in Target Net: 6.401e-01	  
tensor(-0.0347, device='cuda:0')
 2021-06-11 12:33:16 Iteration 800 	 Training Loss: 1.179e-01 	 Loss in Target Net: 6.295e-01	  
tensor(-0.0357, device='cuda:0')
 2021-06-11 12:34:18 Iteration 850 	 Training Loss: 1.186e-01 	 Loss in Target Net: 6.229e-01	  
tensor(-0.0369, device='cuda:0')
 2021-06-11 12:35:18 Iteration 900 	 Training Loss: 1.121e-01 	 Loss in Target Net: 6.769e-01	  
tensor(-0.0379, device='cuda:0')
 2021-06-11 12:36:19 Iteration 950 	 Training Loss: 1.115e-01 	 Loss in Target Net: 6.480e-01	  
tensor(-0.0376, device='cuda:0')
 2021-06-11 12:37:19 Iteration 999 	 Training Loss: 1.156e-01 	 Loss in Target Net: 6.257e-01	  
tensor(-0.0395, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  600
poison index =  1698
poison index =  1829
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 12:37:25, Val iteration 0, acc 94.200 (94.200)
2021-06-11 12:37:34, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 12:37:40, Epoch 0, Iteration 7, loss 0.692 (0.457), acc 88.462 (91.600)
2021-06-11 12:38:41, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.0201186, -0.19131796, 1.4568831, -1.4435465, 0.71738243, -1.2173843, 4.5357656, 1.2390535, -1.8858147, -2.0292785]
Target sample: 7, Prediction:6, Target's Score:[-2.5185997, 2.442005, -0.2617755, -0.6746428, 0.05486658, -1.1188476, 6.63201, -1.8456424, -1.1724471, -1.3190453]
Target sample: 13, Prediction:6, Target's Score:[-1.5801575, -0.9135039, 1.0350941, 0.026278652, 1.188101, -0.8732644, 6.0491424, -2.0119998, -1.7333426, -1.007743]
Target sample: 19, Prediction:6, Target's Score:[-2.4698722, 3.597283, 0.54584044, -1.1244742, 0.071831614, -1.8275613, 6.9213486, -1.8583765, -2.08859, -1.5454175]
Target sample: 25, Prediction:6, Target's Score:[-2.028016, -0.23374932, 1.0730196, -0.4650396, 1.2555882, -1.4485842, 6.933642, -1.634124, -1.5101659, -1.7506514]
Target sample: 31, Prediction:6, Target's Score:[-1.7888943, -0.6355904, 0.8834497, -0.46751547, 0.98711014, -1.3883561, 7.0686674, -1.6205537, -0.91785324, -1.923146]
Target sample: 37, Prediction:6, Target's Score:[-1.4388652, -0.85623443, 0.46599337, -0.43661273, 0.8814235, -1.3053232, 6.6150665, -1.551118, -0.5514046, -1.6309385]
Target sample: 43, Prediction:6, Target's Score:[-1.3077413, -0.5473352, 0.27462742, -0.48797715, 0.72115165, -1.1443715, 5.9293175, -1.2247103, -0.79607284, -1.2398285]
Target sample: 49, Prediction:6, Target's Score:[-1.9523239, 2.646396, 0.45329133, -0.31373605, -0.4830824, -1.4558251, 7.376796, -1.7906301, -2.0442617, -2.1999748]
Target sample: 55, Prediction:6, Target's Score:[-2.2675407, 2.167473, 0.7058439, -0.73448426, -0.2162121, -1.5239083, 8.521574, -1.5781628, -2.0675538, -2.7519166]
Target sample: 61, Prediction:6, Target's Score:[-1.282325, 0.16436122, 0.40395072, -1.2692863, 0.2643011, -1.8606684, 6.9810357, 0.63237023, -1.3923459, -2.4232]
Target sample: 67, Prediction:6, Target's Score:[-2.1447234, 0.7518039, 0.3430437, -0.61395997, 0.26307923, -1.6718884, 8.1006155, -1.6884153, -0.7514842, -2.3537807]
Target sample: 73, Prediction:6, Target's Score:[-1.2888645, 0.24207403, 0.6916406, -0.85933596, 0.4532393, -1.6526973, 7.0415244, -1.5642515, -1.3523632, -1.502968]
Target sample: 79, Prediction:6, Target's Score:[-2.278882, 4.120247, 0.3793212, -1.066759, -0.4391328, -1.8095013, 6.417129, -1.7050703, -1.8295798, -1.5730728]
Target sample: 85, Prediction:6, Target's Score:[-0.98732024, -1.4444276, 0.58676535, -0.8182266, 1.8420556, -1.4414712, 5.9613976, -1.436162, -0.905497, -1.1777169]
Target sample: 91, Prediction:6, Target's Score:[-1.5324292, -0.82189816, 0.44035053, -0.19496754, 0.879384, -1.2435877, 6.3063736, -1.734836, -0.4999623, -1.408694]
Target sample: 97, Prediction:6, Target's Score:[-1.7471678, 0.5392975, 0.21636811, -0.22456813, 0.44434303, -1.2974542, 5.9604497, -1.6052407, -0.5015083, -1.5981238]
Target sample: 103, Prediction:6, Target's Score:[-0.65135324, -1.231821, 0.19653994, -0.21208513, 0.8996788, -1.0068446, 4.4963846, -1.3201878, -0.35373905, -0.66435623]
Target sample: 109, Prediction:6, Target's Score:[-2.414822, 5.169016, 0.10388518, -0.40559727, -1.2948079, -1.3204312, 5.3852305, -1.7998167, -2.07493, -1.1384152]
Target sample: 115, Prediction:6, Target's Score:[-1.0630488, -0.36162284, 0.49037218, -0.3913489, 0.6445235, -1.1044983, 6.725927, -1.2262495, -1.6440797, -1.8677984]
Target sample: 121, Prediction:6, Target's Score:[-1.9121184, -0.012529566, 1.7397952, -1.1388015, 1.7579494, -1.0770361, 5.159951, -0.35944098, -1.9730854, -2.014541]
Target sample: 127, Prediction:6, Target's Score:[-1.5971026, -0.019491315, 0.13414009, -0.7057403, 0.61459386, -1.2488875, 5.068684, -1.5749303, -1.2015283, 0.70377785]
Current ATTACK acc on target samples: 100.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 12:39:40 Epoch 59, Val iteration 0, acc 90.800 (90.800)
2021-06-11 12:39:51 Epoch 59, Val iteration 19, acc 90.200 (90.080)
* Prec: 90.08000259399414
Per class accuracy =  [0.94788067 0.93731325 0.83889742 0.81683975 0.90743321 0.86173379
 0.97142029 0.91231139 0.91025689 0.90542279]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 100.0
--------
DPN92
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  600
poison index =  1698
poison index =  1829
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 12:40:02, Val iteration 0, acc 94.800 (94.800)
2021-06-11 12:40:23, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 12:40:37, Epoch 0, Iteration 7, loss 0.269 (0.418), acc 92.308 (90.800)
2021-06-11 12:43:16, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:7, Target's Score:[-0.32261008, -0.5106488, -2.6771245, -0.957987, -0.24662682, -2.0373108, 1.9606391, 3.3109066, 2.3290708, -0.49687263]
Target sample: 7, Prediction:8, Target's Score:[1.0424149, 0.96547234, -3.2538052, -2.220821, -2.570056, -3.054526, 4.8406487, -1.2067683, 4.92708, 0.96782035]
Target sample: 13, Prediction:6, Target's Score:[-0.60709983, 0.22187948, -2.3874276, -0.2112613, -0.78217524, -1.8283738, 6.0247207, -1.6937621, 2.4267004, -0.7761914]
Target sample: 19, Prediction:6, Target's Score:[0.61838156, 4.239906, -4.5126367, -0.6933418, -3.0504391, -2.4062016, 5.7916307, -1.6221355, 2.3411367, -0.22639757]
Target sample: 25, Prediction:6, Target's Score:[1.870592, 1.6488814, -3.8309774, -0.59680384, -2.8938184, -3.6458218, 6.965871, -1.3260765, 2.9311295, -0.68278575]
Target sample: 31, Prediction:6, Target's Score:[0.46775162, -0.51117784, -2.1803434, -0.7322764, -1.6564667, -2.6569893, 10.857987, -1.0746995, 0.551642, -2.6571317]
Target sample: 37, Prediction:6, Target's Score:[3.0058634, 1.5199466, -4.1338787, -1.7623619, -3.3858757, -3.5645115, 9.449487, -0.90513146, 1.5114003, -1.2493947]
Target sample: 43, Prediction:6, Target's Score:[2.694485, 1.2026845, -4.006639, -2.5305293, -3.7553556, -3.2872012, 8.276093, -1.6868509, 2.9258432, 0.68149817]
Target sample: 49, Prediction:6, Target's Score:[1.8011062, 7.8614264, -4.9460483, -2.4682796, -4.1017203, -3.250774, 7.897552, -2.0733912, 1.5505644, -1.6576254]
Target sample: 55, Prediction:6, Target's Score:[3.0873125, 0.8051974, -2.1348975, -1.2841747, -2.7281454, -2.842809, 11.252196, -1.4511812, 0.029149566, -4.208805]
Target sample: 61, Prediction:6, Target's Score:[3.3522403, 0.7019089, -3.7241096, -2.281365, -2.6852884, -3.3976128, 7.5079727, -0.7733407, 2.7707746, -1.0140721]
Target sample: 67, Prediction:6, Target's Score:[3.4192016, 0.076311804, -2.9130416, -2.1404576, -2.2003372, -3.240521, 10.496424, -1.3267272, 1.2833635, -2.9777815]
Target sample: 73, Prediction:6, Target's Score:[0.9721759, 3.1550462, -4.0347066, -1.8741405, -3.617474, -3.1708233, 7.154572, -1.6819538, 1.1034226, 2.4711087]
Target sample: 79, Prediction:1, Target's Score:[1.7909253, 4.9032536, -4.1255493, -0.47330007, -4.3837476, -3.8299313, 2.8471353, -0.24290481, 3.6079288, 0.41701242]
Target sample: 85, Prediction:8, Target's Score:[1.3521782, 1.113429, -3.6792042, -1.193499, -3.3642461, -3.1100283, 4.424265, -1.9562074, 7.7083745, -0.8137779]
Target sample: 91, Prediction:8, Target's Score:[-0.8214266, 1.0243484, -3.908481, -0.70574933, -3.1548364, -2.6606455, 5.2182355, -1.3490249, 5.6989093, 1.0839841]
Target sample: 97, Prediction:8, Target's Score:[1.210202, 4.195781, -4.9251533, -1.1492916, -4.219455, -3.5570896, 3.8330963, -1.45631, 5.0844393, 1.4791673]
Target sample: 103, Prediction:8, Target's Score:[1.1593074, 1.5104183, -4.9420667, -2.2883577, -3.7799163, -2.9803824, 2.3148475, -1.2969697, 5.832647, 4.923615]
Target sample: 109, Prediction:6, Target's Score:[1.0940442, 4.8254237, -4.5652657, -2.0677907, -3.6279452, -3.1147983, 4.9644365, -0.88990885, 0.59249455, 3.274386]
Target sample: 115, Prediction:6, Target's Score:[-0.51660526, 2.2423923, -3.4686842, -1.0496567, -2.0983748, -2.1032164, 4.6212125, -1.6693618, 4.034331, 0.43649387]
Target sample: 121, Prediction:9, Target's Score:[-1.225479, -0.16516447, -2.043957, 1.7178521, -2.6055613, -3.6821585, 1.9139093, 1.3820581, 2.0818415, 3.0131185]
Target sample: 127, Prediction:9, Target's Score:[-0.4844334, 0.8116328, -2.5767558, -0.35957408, -3.6774287, -3.4544208, 2.5756269, -0.575083, 2.332215, 5.835764]
Current ATTACK acc on target samples: 59.091
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 12:45:51 Epoch 59, Val iteration 0, acc 93.400 (93.400)
2021-06-11 12:46:12 Epoch 59, Val iteration 19, acc 92.000 (92.750)
* Prec: 92.75000114440918
Per class accuracy =  [0.93327055 0.94684426 0.87082682 0.85080615 0.95708432 0.90425856
 0.94473274 0.94305981 0.96371007 0.96179393]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 3, 3, 6, 6, 6, 6, 6, 8, 6, 6, 6, 8, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 6, 1, 1, 6, 6, 6, 6, 8, 8, 6, 6, 8, 6, 8, 8, 8, 6, 8, 6, 9, 9, 9, 9, 1, 1, 1, 1, 6, 6, 6, 6, 6, 7, 7, 6, 6, 6, 8, 8, 6, 8
ATTACK acc: 71.02803738317758
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  600
poison index =  1698
poison index =  1829
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 12:46:16, Val iteration 0, acc 92.600 (92.600)
2021-06-11 12:46:22, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 12:46:24, Epoch 0, Iteration 7, loss 0.368 (0.354), acc 88.462 (90.000)
2021-06-11 12:46:52, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[1.50039, 0.11652746, -1.8541154, 2.3804338, -0.6695929, -3.6250932, 3.0648282, 1.3571146, -4.811013, 2.8591259]
Target sample: 7, Prediction:9, Target's Score:[-0.4014047, 6.4805393, -4.341994, 0.015647948, -4.0915403, -4.134372, 4.69709, -2.7853081, -1.6106287, 6.5227323]
Target sample: 13, Prediction:6, Target's Score:[2.0662324, 2.22212, -2.6357892, 1.7304794, -2.2133052, -4.1547756, 5.344768, -0.8436745, -4.2848053, 3.113002]
Target sample: 19, Prediction:1, Target's Score:[-0.9198155, 11.826994, -2.8053863, -1.3991649, -3.5778859, -2.976065, 4.1833735, -2.4366841, -3.595561, 2.0572476]
Target sample: 25, Prediction:6, Target's Score:[2.2037892, 2.3127759, -0.2582226, -0.32368776, -0.13590282, -4.498771, 6.941174, -4.897589, -0.48465115, -0.5561836]
Target sample: 31, Prediction:1, Target's Score:[1.2504358, 7.163052, -1.5523285, -0.61999047, -1.4278845, -4.62353, 5.4875484, -4.090945, -3.7070718, 2.4732788]
Target sample: 37, Prediction:6, Target's Score:[-0.59110975, 0.12899622, -2.128414, 0.91145134, 1.1337999, -5.151122, 8.486585, -4.489011, -0.09786147, 2.1425848]
Target sample: 43, Prediction:6, Target's Score:[-1.7315049, 3.9672215, -5.2157907, 2.136511, -4.2691956, -2.5439875, 10.010491, -6.6787705, -0.51538336, 5.1925282]
Target sample: 49, Prediction:1, Target's Score:[0.87651795, 10.549492, -3.587783, 0.06798217, -4.9664383, -3.8334394, 8.996698, -6.268493, -1.9302981, 0.43457416]
Target sample: 55, Prediction:6, Target's Score:[1.9836146, -0.22288749, -2.1465604, 3.377859, -4.4820824, -2.0366752, 10.874363, -5.3460784, -4.053179, 2.3286362]
Target sample: 61, Prediction:6, Target's Score:[1.075418, 2.5344517, -0.37486705, 0.30391833, -2.9206278, -3.613012, 6.334481, -0.98021126, -2.0962968, -0.00049893744]
Target sample: 67, Prediction:6, Target's Score:[1.1451395, 1.6488634, -4.220714, 1.0033771, -2.049792, -4.167224, 9.507198, -3.733873, 1.5781683, -0.41680577]
Target sample: 73, Prediction:6, Target's Score:[4.473252, 5.483296, -2.7243433, -1.4303294, -3.2195637, -4.6596594, 8.506445, -4.3887296, -1.9572734, 0.20736292]
Target sample: 79, Prediction:6, Target's Score:[2.9256885, 5.3380446, -2.134914, 0.050800517, -5.086587, -3.5021496, 8.605866, -4.9846463, -3.304634, 2.380543]
Target sample: 85, Prediction:6, Target's Score:[1.3939624, 2.4937804, -3.1534157, 1.0101818, -4.060571, -2.855334, 7.85014, -5.554959, -2.3727338, 5.5471134]
Target sample: 91, Prediction:6, Target's Score:[-1.3231462, 1.5430613, -3.7354395, 1.989776, -1.3350307, -3.368362, 8.052689, -4.3815675, -3.8439662, 6.755267]
Target sample: 97, Prediction:6, Target's Score:[0.3605538, 1.3575134, -3.52301, 3.1023257, -2.052156, -3.188166, 6.8772717, -4.1913295, -4.1143084, 5.7189617]
Target sample: 103, Prediction:6, Target's Score:[-0.5210885, -0.8423105, -3.5164917, 2.6237273, -0.41739345, -3.4737833, 6.074422, -3.0700617, -1.3493398, 4.835197]
Target sample: 109, Prediction:1, Target's Score:[-0.27338576, 9.36202, -4.108728, -0.518837, -5.24852, -3.769211, 9.167637, -4.6394634, -4.402106, 4.7918267]
Target sample: 115, Prediction:6, Target's Score:[-1.19778, 1.5056098, -2.969478, 1.2814643, -0.8641129, -1.9745327, 10.719503, -4.1629195, -1.1796985, -0.8648195]
Target sample: 121, Prediction:6, Target's Score:[-2.6267, 0.46661612, -3.47307, 0.8605795, 3.232542, -4.2510014, 3.489314, 1.59395, -2.0771885, 3.1750963]
Target sample: 127, Prediction:9, Target's Score:[-1.7279665, 1.963978, -4.798718, 0.75596106, -3.3180933, -4.7523637, 4.8625464, -2.686482, -2.13287, 12.247888]
Current ATTACK acc on target samples: 72.727
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 12:47:19 Epoch 59, Val iteration 0, acc 90.600 (90.600)
2021-06-11 12:47:25 Epoch 59, Val iteration 19, acc 90.600 (89.470)
* Prec: 89.47000122070312
Per class accuracy =  [0.92660311 0.92882848 0.8433683  0.82864105 0.88759059 0.82509235
 0.93342898 0.89194441 0.93189666 0.94612184]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 9, 4, 6, 9, 6, 9, 9, 9, 9, 1, 6, 1, 6, 6, 1, 1, 1, 6, 1, 6, 6, 6, 6, 6, 1, 6, 1, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 9, 6, 6, 6, 6, 6, 6, 9, 9, 6, 1, 1, 6, 6, 6, 6, 6, 6, 3, 4, 6, 6, 9, 1, 1, 9, 9
ATTACK acc: 67.28971962616822
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  600
poison index =  1698
poison index =  1829
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 12:47:33, Val iteration 0, acc 96.200 (96.200)
2021-06-11 12:47:46, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 12:47:52, Epoch 0, Iteration 7, loss 0.410 (0.717), acc 90.385 (83.400)
2021-06-11 12:49:04, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-0.8134388, 1.4911339, -1.0914149, -0.8190953, 1.1018902, -3.2279117, 6.2173305, -0.022867972, -2.331339, -0.563846]
Target sample: 7, Prediction:6, Target's Score:[-1.3927343, -0.77757967, -1.5502751, -0.13369359, 2.3501503, -2.109444, 9.969879, -2.6625786, -1.4573997, -2.3143344]
Target sample: 13, Prediction:6, Target's Score:[-0.78675, -0.008428054, -1.6271664, -1.7006875, -1.0952673, -1.8689462, 13.026508, -2.012203, -1.6358025, -2.374688]
Target sample: 19, Prediction:6, Target's Score:[-0.5038626, 3.355743, -1.9350849, -0.82397, 0.9961893, -3.074014, 8.149939, -2.8983302, -2.3941624, -0.9331423]
Target sample: 25, Prediction:6, Target's Score:[-2.405089, 2.212465, -1.8601552, -1.6128194, -0.1943561, -2.4197469, 11.867418, -2.618368, -2.172234, -0.8761188]
Target sample: 31, Prediction:6, Target's Score:[-1.6156421, 0.6218886, -0.85776335, -1.3253673, -0.50828665, -2.4442627, 11.885905, -2.090344, -1.5720257, -2.1695523]
Target sample: 37, Prediction:6, Target's Score:[-0.31063527, -0.39698127, -1.5498415, -1.3416413, -1.8603966, -2.0344396, 12.664852, -2.4926946, -0.4007503, -2.351108]
Target sample: 43, Prediction:6, Target's Score:[-2.1480236, 1.0779614, -2.3712118, -0.6810297, -1.6490098, -1.7635199, 12.553159, -2.4731917, -1.2875907, -1.3311816]
Target sample: 49, Prediction:6, Target's Score:[-2.6677134, 1.4007028, -1.7682918, 2.0249667, -1.9111311, -1.5000746, 10.364732, -2.5549667, -1.847734, -1.5932018]
Target sample: 55, Prediction:6, Target's Score:[-2.689905, -0.42997947, -1.6559118, 2.5920684, -2.1070607, -1.9379845, 9.770925, -1.1058728, -0.52034855, -1.9653752]
Target sample: 61, Prediction:6, Target's Score:[-2.468893, -1.4114139, -0.13925447, 0.6733956, -2.024352, -1.7348751, 7.427598, 2.2528975, -0.5219371, -2.1132715]
Target sample: 67, Prediction:6, Target's Score:[-1.3177077, -0.9753658, -1.3097038, -1.0759156, 1.1564498, -2.1846757, 12.144627, -2.687208, -0.5069603, -3.3285372]
Target sample: 73, Prediction:6, Target's Score:[-0.53922737, -0.017097028, -1.734781, 1.208676, -0.6467102, -2.9419796, 9.16714, -1.2701561, -1.5190696, -1.7593113]
Target sample: 79, Prediction:6, Target's Score:[-2.8735616, 3.1419523, -2.1818721, -0.16638291, -1.3609945, -2.9270303, 10.194826, -2.0768862, -0.70867467, -1.0983698]
Target sample: 85, Prediction:6, Target's Score:[-0.80705094, -1.1851354, -2.5991995, 0.33936524, -1.30553, -1.4096122, 10.316138, -2.7704651, 0.15051706, -0.7874179]
Target sample: 91, Prediction:6, Target's Score:[-2.575598, 0.4905231, -2.3269398, 0.1377046, -2.4335046, -1.2145084, 10.891602, -1.7789444, -0.42034423, -0.8346288]
Target sample: 97, Prediction:6, Target's Score:[-0.30097246, 2.5936725, -2.638551, 0.7667057, -2.049294, -1.95375, 7.3991528, -3.0620446, 0.0042024236, -0.79701227]
Target sample: 103, Prediction:6, Target's Score:[0.44409728, 0.57735896, -2.265706, -0.12640032, -1.527386, -1.4928105, 8.350171, -2.3926163, -0.8198018, -0.7972553]
Target sample: 109, Prediction:1, Target's Score:[-2.4160883, 7.4491005, -2.7575388, 1.1640803, -2.5502446, -2.7365448, 6.6971726, -2.9786997, -2.9341, 1.0261965]
Target sample: 115, Prediction:6, Target's Score:[-2.9020839, 3.1265547, -2.3417728, 0.73864996, -1.762395, -0.27653325, 8.90953, -2.310162, -2.124413, -1.1150346]
Target sample: 121, Prediction:6, Target's Score:[-1.8657424, 1.3891656, -1.2095634, 1.1160245, 1.7552425, -1.9978174, 5.702092, -1.051166, -2.2015512, -1.6906843]
Target sample: 127, Prediction:6, Target's Score:[-1.0844716, -0.655483, -1.5353434, -0.74418306, 2.5181377, -2.7583883, 5.9677205, -2.616706, -1.9519321, 2.7928946]
Current ATTACK acc on target samples: 95.455
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 12:50:14 Epoch 59, Val iteration 0, acc 92.400 (92.400)
2021-06-11 12:50:27 Epoch 59, Val iteration 19, acc 90.600 (91.590)
* Prec: 91.59000091552734
Per class accuracy =  [0.95395669 0.96216206 0.85665966 0.79729062 0.93968263 0.89662759
 0.93318193 0.93633967 0.93797701 0.94531621]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 99.06542056074767
--------
------SUMMARY------
TIME ELAPSED (mins): 20
TARGET INDEX: 17
ResNet50 100.0 100.0 95.46000137329102 90.08000259399414
DPN92 59.09090909090909 71.02803738317758 95.50000267028808 92.75000114440918
MobileNetV2 72.72727272727273 67.28971962616822 91.22000160217286 89.47000122070312
GoogLeNet 95.45454545454545 99.06542056074767 95.41000213623047 91.59000091552734
True False False False True
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 129 images of target 17
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=True, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=17, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/17/target-num-20
torch.Size([200, 1, 3, 32, 32]) torch.Size([22, 3, 32, 32])
Selected nearest neighbors: [1088, 1212, 600, 1698, 1829]
Selected base image indices: [1088, 1212, 600, 1698, 1829]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127]
# Targets: 22, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 12:51:04 Iteration 0 	 Training Loss: 7.125e-01 	 Loss in Target Net: 5.251e-01	  
tensor(-0.0013, device='cuda:0')
 2021-06-11 12:52:14 Iteration 50 	 Training Loss: 3.182e-01 	 Loss in Target Net: 3.925e-01	  
tensor(-0.0223, device='cuda:0')
 2021-06-11 12:53:24 Iteration 100 	 Training Loss: 2.698e-01 	 Loss in Target Net: 3.884e-01	  
tensor(-0.0342, device='cuda:0')
 2021-06-11 12:54:32 Iteration 150 	 Training Loss: 2.467e-01 	 Loss in Target Net: 3.608e-01	  
tensor(-0.0410, device='cuda:0')
 2021-06-11 12:55:42 Iteration 200 	 Training Loss: 2.356e-01 	 Loss in Target Net: 3.857e-01	  
tensor(-0.0475, device='cuda:0')
 2021-06-11 12:56:54 Iteration 250 	 Training Loss: 2.349e-01 	 Loss in Target Net: 3.748e-01	  
tensor(-0.0511, device='cuda:0')
 2021-06-11 12:58:04 Iteration 300 	 Training Loss: 2.309e-01 	 Loss in Target Net: 3.579e-01	  
tensor(-0.0525, device='cuda:0')
 2021-06-11 12:59:14 Iteration 350 	 Training Loss: 2.307e-01 	 Loss in Target Net: 3.501e-01	  
tensor(-0.0540, device='cuda:0')
 2021-06-11 13:00:24 Iteration 400 	 Training Loss: 2.310e-01 	 Loss in Target Net: 3.478e-01	  
tensor(-0.0540, device='cuda:0')
 2021-06-11 13:01:34 Iteration 450 	 Training Loss: 2.309e-01 	 Loss in Target Net: 3.450e-01	  
tensor(-0.0539, device='cuda:0')
 2021-06-11 13:02:46 Iteration 500 	 Training Loss: 2.303e-01 	 Loss in Target Net: 3.620e-01	  
tensor(-0.0540, device='cuda:0')
 2021-06-11 13:03:57 Iteration 550 	 Training Loss: 2.297e-01 	 Loss in Target Net: 3.356e-01	  
tensor(-0.0529, device='cuda:0')
 2021-06-11 13:05:07 Iteration 600 	 Training Loss: 2.315e-01 	 Loss in Target Net: 3.587e-01	  
tensor(-0.0518, device='cuda:0')
 2021-06-11 13:06:18 Iteration 650 	 Training Loss: 2.331e-01 	 Loss in Target Net: 3.568e-01	  
tensor(-0.0499, device='cuda:0')
 2021-06-11 13:07:28 Iteration 700 	 Training Loss: 2.350e-01 	 Loss in Target Net: 3.610e-01	  
tensor(-0.0498, device='cuda:0')
 2021-06-11 13:08:38 Iteration 750 	 Training Loss: 2.323e-01 	 Loss in Target Net: 3.443e-01	  
tensor(-0.0503, device='cuda:0')
 2021-06-11 13:09:48 Iteration 800 	 Training Loss: 2.317e-01 	 Loss in Target Net: 3.516e-01	  
tensor(-0.0504, device='cuda:0')
 2021-06-11 13:10:59 Iteration 850 	 Training Loss: 2.343e-01 	 Loss in Target Net: 3.661e-01	  
tensor(-0.0499, device='cuda:0')
 2021-06-11 13:12:10 Iteration 900 	 Training Loss: 2.326e-01 	 Loss in Target Net: 3.649e-01	  
tensor(-0.0493, device='cuda:0')
 2021-06-11 13:13:21 Iteration 950 	 Training Loss: 2.321e-01 	 Loss in Target Net: 3.729e-01	  
tensor(-0.0500, device='cuda:0')
 2021-06-11 13:14:30 Iteration 999 	 Training Loss: 2.310e-01 	 Loss in Target Net: 3.672e-01	  
tensor(-0.0506, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  600
poison index =  1698
poison index =  1829
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 13:14:35, Val iteration 0, acc 94.200 (94.200)
2021-06-11 13:14:45, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 13:14:50, Epoch 0, Iteration 7, loss 0.537 (0.523), acc 86.538 (89.200)
2021-06-11 13:15:51, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.5859349, 5.716297, -1.9980187, -1.544722, -1.4127189, -3.0925379, 8.456072, -1.2160156, 1.0188842, -3.159101]
Target sample: 7, Prediction:6, Target's Score:[-3.1421485, 4.1113553, -2.184075, -1.0741059, -0.8804191, -2.9903743, 10.213225, -2.5815332, 0.596331, -1.8469262]
Target sample: 13, Prediction:6, Target's Score:[-3.2609656, 0.70716274, -1.6518152, -0.70168155, -0.07556635, -3.0339527, 10.013223, -2.851026, 0.37715492, 0.6946681]
Target sample: 19, Prediction:6, Target's Score:[-3.1110177, 3.9774647, -1.5210277, -2.112806, 1.4692641, -3.2131467, 8.453611, -2.0974789, -0.7113373, -0.96043795]
Target sample: 25, Prediction:6, Target's Score:[-2.5906887, 0.9510292, -1.2148154, -1.2357467, 1.6064792, -2.7697756, 8.199947, -1.8833925, -0.20829193, -0.6788527]
Target sample: 31, Prediction:6, Target's Score:[-2.425201, 1.7124741, -2.1808865, -1.6033635, 0.16561463, -3.518956, 10.820409, -2.4836829, 1.4662334, -1.7075557]
Target sample: 37, Prediction:6, Target's Score:[-1.206843, 1.9661732, -2.7910862, -1.8016558, -0.7993275, -3.5319078, 9.013669, -2.6136062, 3.014339, -1.0443866]
Target sample: 43, Prediction:6, Target's Score:[-2.8496785, 2.8593044, -2.8130352, -1.7889857, -0.088138565, -3.3211753, 9.599698, -2.7180727, 2.28655, -0.9625673]
Target sample: 49, Prediction:6, Target's Score:[-2.4474373, 8.612994, -2.5820808, -1.8114804, -1.5892903, -3.5434868, 9.323087, -2.3498147, 0.43917635, -3.862167]
Target sample: 55, Prediction:6, Target's Score:[-2.7100875, 5.61376, -2.2286372, -1.5801697, -0.95759386, -3.5459294, 10.916902, -2.777045, 0.6162636, -3.1098123]
Target sample: 61, Prediction:6, Target's Score:[-1.8005593, 3.3543978, -2.8349028, -1.8352968, -0.105482936, -3.5690804, 9.167673, -1.1676576, 2.0101438, -3.007704]
Target sample: 67, Prediction:6, Target's Score:[-2.791186, 5.5656004, -2.6175804, -1.7779118, -1.5966567, -3.8636842, 12.339212, -3.0004592, 1.6117083, -3.5971591]
Target sample: 73, Prediction:6, Target's Score:[-2.9302766, 0.8708863, -2.0580187, -1.6929134, -0.7820703, -3.7689927, 9.517831, -3.3867092, 1.2867281, 3.1426296]
Target sample: 79, Prediction:6, Target's Score:[-3.209937, 6.532683, -1.7636342, -1.8009764, -0.06320609, -3.3252168, 9.36725, -2.2410161, -0.053409487, -3.2589378]
Target sample: 85, Prediction:6, Target's Score:[-3.2485344, -0.5231265, -1.995518, -0.82039434, 1.4009756, -3.1460946, 9.987087, -2.6805162, 1.6511685, -0.4129857]
Target sample: 91, Prediction:6, Target's Score:[-3.1240141, 0.12481078, -1.8758869, -0.6726786, -0.1519287, -3.104879, 10.455203, -2.712117, 1.8421328, -0.550312]
Target sample: 97, Prediction:6, Target's Score:[-2.8878286, 2.7299373, -2.0446064, -0.3166409, -0.6593011, -2.7575579, 8.986249, -2.598022, 1.3344415, -1.596283]
Target sample: 103, Prediction:6, Target's Score:[-2.3443892, -0.28646258, -1.9173336, -1.0452842, -0.49965096, -3.1079888, 8.686442, -2.475964, 2.5233393, 0.6577149]
Target sample: 109, Prediction:1, Target's Score:[-2.3314521, 9.536676, -2.1358883, -1.6053691, -2.2144253, -3.1068726, 7.2462554, -1.8771901, 0.29948822, -3.677673]
Target sample: 115, Prediction:6, Target's Score:[-3.1785803, 3.9392264, -2.1529796, -1.2980549, -1.3503388, -3.2405744, 10.885177, -2.380092, 0.91771424, -1.8984473]
Target sample: 121, Prediction:6, Target's Score:[-3.1238248, 3.1227224, -1.0821449, -1.6521223, -0.7959945, -3.1401112, 9.04232, -1.3814888, 0.5260153, -1.3112842]
Target sample: 127, Prediction:6, Target's Score:[-3.08786, 0.31490052, -1.5604019, -1.1981095, -0.7823702, -3.0864673, 8.297185, -2.0750751, 1.2846656, 2.073086]
Current ATTACK acc on target samples: 95.455
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 13:16:50 Epoch 59, Val iteration 0, acc 92.200 (92.200)
2021-06-11 13:17:00 Epoch 59, Val iteration 19, acc 91.400 (90.950)
* Prec: 90.95000114440919
Per class accuracy =  [0.92492662 0.96078816 0.82709855 0.78771731 0.94745972 0.87733636
 0.95067877 0.92619019 0.94908793 0.94564762]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 95.32710280373831
--------
DPN92
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  600
poison index =  1698
poison index =  1829
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 13:17:12, Val iteration 0, acc 94.800 (94.800)
2021-06-11 13:17:33, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 13:17:47, Epoch 0, Iteration 7, loss 0.380 (0.409), acc 90.385 (90.000)
2021-06-11 13:20:26, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.08012, 2.1277125, -1.9225665, 0.4779571, 1.6990621, -1.3139757, 4.7352266, -1.1284633, 0.106612355, -2.4357128]
Target sample: 7, Prediction:6, Target's Score:[-1.7142069, 1.8361485, -1.3347181, -1.5704101, -1.7089314, -3.6370077, 7.361596, -3.1057045, 5.066406, -0.8825188]
Target sample: 13, Prediction:6, Target's Score:[-0.57265747, 1.0710322, -1.1600996, -1.2504766, 0.47041193, -2.9250512, 8.05583, -1.7993106, 0.31410572, -1.9643751]
Target sample: 19, Prediction:6, Target's Score:[-1.2541308, 3.9811704, -1.9156971, -1.6521933, -0.16239528, -2.6701446, 8.075458, -3.3404043, 0.47205374, -1.2490023]
Target sample: 25, Prediction:6, Target's Score:[-1.6275606, 3.253325, -1.7802459, 0.2726951, -1.5427828, -4.2406883, 8.9752245, -3.5764122, 0.34853616, 0.22938769]
Target sample: 31, Prediction:6, Target's Score:[-1.1996627, 0.027417373, -1.125027, -0.8978783, -1.7310379, -3.2666593, 11.403748, -0.5681079, 0.019307453, -2.3901343]
Target sample: 37, Prediction:6, Target's Score:[-0.31554213, 1.7503906, -2.3700912, -2.0374942, -2.28922, -3.8964903, 12.74364, -3.2380104, 1.9391423, -1.9752141]
Target sample: 43, Prediction:6, Target's Score:[-0.4434656, 2.103325, -2.3423533, -2.1625304, -2.2687757, -4.1066265, 12.688018, -3.7235637, 1.1324787, -0.5530302]
Target sample: 49, Prediction:6, Target's Score:[-0.73048013, 7.366248, -2.8769603, -2.1355367, -2.5257792, -3.346322, 10.185722, -4.011249, 0.2008579, -1.7640635]
Target sample: 55, Prediction:6, Target's Score:[0.35193667, 2.5842378, -1.6007226, -1.8032585, -1.7543752, -2.789925, 13.566644, -3.2864468, -1.1556972, -3.8216827]
Target sample: 61, Prediction:6, Target's Score:[-0.03965678, 0.8983153, -2.4458854, -1.9579321, -1.9491309, -4.1006556, 10.093245, -2.9807558, 3.1151462, -0.32480913]
Target sample: 67, Prediction:6, Target's Score:[1.2737715, 1.115988, -1.7084656, -2.9259796, -1.4841042, -3.3759863, 14.445339, -3.2453017, -0.40126202, -3.4174385]
Target sample: 73, Prediction:6, Target's Score:[-0.6455935, 4.195746, -2.298954, -1.9455665, -1.7033732, -3.1909037, 11.901818, -3.5873618, -1.3134009, -1.0983356]
Target sample: 79, Prediction:1, Target's Score:[-1.4994655, 7.1517363, -2.5044005, -0.77327967, -2.0544765, -3.0396502, 5.852262, -3.085163, 0.74010533, -0.44784227]
Target sample: 85, Prediction:6, Target's Score:[-1.1128945, 1.0986477, -2.0565162, -0.5819737, -0.90782374, -3.7394867, 8.681593, -3.056562, 3.30177, -1.3372895]
Target sample: 91, Prediction:6, Target's Score:[-3.1353621, 0.8735049, -1.9942278, 0.6606122, -1.178455, -3.9925451, 8.853454, -2.9471824, 3.1926339, -0.009920333]
Target sample: 97, Prediction:6, Target's Score:[-1.3011858, 3.6870275, -2.9941201, -0.19610918, -2.463101, -4.1375823, 6.183518, -2.6425915, 3.7071836, 0.49450707]
Target sample: 103, Prediction:6, Target's Score:[-1.4067683, 1.0994755, -2.3180444, -0.6419339, -1.0774244, -3.7437131, 7.085509, -2.8175588, 1.8867676, 2.2393558]
Target sample: 109, Prediction:6, Target's Score:[0.72961795, 3.6640546, -2.061009, -1.9462079, -0.8315379, -2.5204554, 9.799764, -2.42418, -1.9069425, -2.22021]
Target sample: 115, Prediction:6, Target's Score:[-1.2132776, 3.3620741, -1.6101266, -1.4126167, -1.2329516, -1.8344765, 9.957585, -2.7268276, -0.38380268, -2.6298928]
Target sample: 121, Prediction:9, Target's Score:[-2.2126114, 1.0318944, -1.918004, 0.9438362, 0.82248694, -3.8970873, 2.0848308, 0.35970145, 0.8571671, 2.2469575]
Target sample: 127, Prediction:6, Target's Score:[-1.1434054, 1.2336851, -1.3656714, -0.5980686, -2.2685719, -4.7095366, 5.3009605, -1.8141227, 2.6130676, 3.0769246]
Current ATTACK acc on target samples: 90.909
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 13:23:01 Epoch 59, Val iteration 0, acc 94.000 (94.000)
2021-06-11 13:23:22 Epoch 59, Val iteration 19, acc 92.600 (93.270)
* Prec: 93.27000122070312
Per class accuracy =  [0.964351   0.95955614 0.90359845 0.86491562 0.95737371 0.88784205
 0.93279612 0.93518786 0.96759569 0.95472965]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 4, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 9, 9, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 7, 6, 6, 6, 8, 6, 6, 6
ATTACK acc: 90.65420560747664
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  600
poison index =  1698
poison index =  1829
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 13:23:26, Val iteration 0, acc 92.600 (92.600)
2021-06-11 13:23:32, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 13:23:34, Epoch 0, Iteration 7, loss 0.182 (0.348), acc 92.308 (90.000)
2021-06-11 13:24:02, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:9, Target's Score:[1.0607126, -0.1446676, -1.1231561, 1.7242222, 0.3550937, -3.4938638, 2.940654, 1.707496, -5.9440455, 3.1745505]
Target sample: 7, Prediction:9, Target's Score:[-1.1726284, 4.3907747, -3.8520439, 0.4297949, -3.2498608, -3.9906802, 5.322826, -1.9295889, -2.628149, 7.0149183]
Target sample: 13, Prediction:6, Target's Score:[1.3511316, 0.9519073, -1.8155767, 1.8122677, -1.5150588, -4.0237412, 5.691314, -0.5744289, -4.805426, 3.22855]
Target sample: 19, Prediction:1, Target's Score:[-1.0563241, 10.217368, -1.9161114, -1.5102729, -2.272486, -3.1352506, 3.2568657, -1.2156568, -4.1982327, 2.2008646]
Target sample: 25, Prediction:6, Target's Score:[1.3178585, 0.7048515, 0.45249242, 0.45747733, 0.61776316, -3.9811623, 8.413308, -4.7516646, -2.337078, -0.5711165]
Target sample: 31, Prediction:6, Target's Score:[0.750679, 5.679992, -1.1033399, -0.09726696, -0.55616295, -4.3619113, 6.2682753, -3.8576484, -4.739399, 2.383294]
Target sample: 37, Prediction:6, Target's Score:[-0.92648935, -2.057098, -1.2350571, 1.8070998, 1.7468712, -4.6783123, 9.961942, -4.343531, -2.181361, 2.2430859]
Target sample: 43, Prediction:6, Target's Score:[-2.0547853, 1.1519266, -4.3217545, 2.7785196, -3.3086371, -2.243252, 12.003603, -6.301214, -1.2862997, 3.9616191]
Target sample: 49, Prediction:6, Target's Score:[0.16731936, 7.0009255, -2.6134326, 0.9476507, -3.6910174, -3.2696712, 11.142452, -5.594536, -2.8893418, -0.8131074]
Target sample: 55, Prediction:6, Target's Score:[1.0134956, -2.9487283, -0.43736684, 3.7878504, -3.6782954, -1.6239283, 12.873749, -4.8272514, -4.771436, 0.9031989]
Target sample: 61, Prediction:6, Target's Score:[0.3861005, 0.8213787, 0.26039195, 0.40186244, -2.317604, -3.1090848, 7.7888846, -0.7159596, -2.6331513, -0.6234509]
Target sample: 67, Prediction:6, Target's Score:[0.53492844, -0.39315003, -3.3232274, 1.9496942, -1.9859395, -3.3979409, 11.487999, -3.8305924, 0.37908885, -1.1093491]
Target sample: 73, Prediction:6, Target's Score:[3.75873, 3.303137, -1.9826713, -0.7507833, -2.3805225, -4.1486363, 9.906221, -4.473193, -2.514995, -0.39282653]
Target sample: 79, Prediction:6, Target's Score:[2.3990946, 3.1928241, -1.1724637, 0.25978655, -4.1553297, -2.9527707, 10.100462, -4.6685205, -3.175743, 0.49153277]
Target sample: 85, Prediction:6, Target's Score:[1.1165739, 0.4444165, -2.4371831, 1.6241757, -3.4267664, -2.5894952, 8.9092455, -5.200893, -2.7757592, 4.6445136]
Target sample: 91, Prediction:6, Target's Score:[-1.6918814, -0.03791818, -2.820697, 2.5779126, -0.5260866, -3.300525, 9.117851, -4.496885, -5.2195053, 6.738345]
Target sample: 97, Prediction:6, Target's Score:[-0.32975817, 0.12440601, -2.6097174, 3.1950495, -0.93661845, -3.340579, 7.9263554, -4.319363, -4.8595185, 5.4824367]
Target sample: 103, Prediction:6, Target's Score:[-1.1916271, -2.106435, -2.4440784, 3.5850368, 0.57170594, -3.4395032, 7.1003737, -3.37461, -2.6310723, 4.2409663]
Target sample: 109, Prediction:6, Target's Score:[-0.84960234, 6.1795645, -3.3370214, -0.25983304, -3.595288, -3.8094003, 9.951402, -3.558137, -5.100527, 4.767191]
Target sample: 115, Prediction:6, Target's Score:[-1.6180243, -0.8678621, -1.3250371, 1.4212495, -0.16432649, -1.6455787, 12.232374, -3.5537426, -2.032308, -2.139491]
Target sample: 121, Prediction:4, Target's Score:[-2.5140927, -0.57914436, -2.3417482, 0.7737129, 4.12358, -4.1140065, 2.933943, 2.0465145, -3.3619487, 3.338151]
Target sample: 127, Prediction:9, Target's Score:[-2.021347, 1.389609, -4.1423492, 1.6053294, -3.0279741, -4.599016, 4.772562, -3.074467, -3.4711561, 12.928851]
Current ATTACK acc on target samples: 77.273
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 13:24:29 Epoch 59, Val iteration 0, acc 89.400 (89.400)
2021-06-11 13:24:35 Epoch 59, Val iteration 19, acc 90.400 (89.560)
* Prec: 89.56000137329102
Per class accuracy =  [0.91824908 0.93117637 0.84689026 0.83250833 0.89849846 0.82236257
 0.93357004 0.89050398 0.93062595 0.94678133]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 9, 4, 6, 9, 6, 9, 9, 9, 9, 9, 6, 6, 6, 6, 6, 6, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 9, 6, 6, 6, 6, 6, 6, 9, 9, 6, 6, 1, 6, 6, 6, 6, 6, 6, 4, 4, 6, 6, 9, 6, 9, 9, 9
ATTACK acc: 78.50467289719626
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  600
poison index =  1698
poison index =  1829
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 13:24:43, Val iteration 0, acc 96.200 (96.200)
2021-06-11 13:24:55, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 13:25:02, Epoch 0, Iteration 7, loss 0.513 (0.695), acc 84.615 (81.000)
2021-06-11 13:26:13, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.3570735, 2.0136974, -3.2451842, 0.822392, 0.26229987, -4.488121, 7.5977297, 0.58849686, 0.8358474, -1.9845978]
Target sample: 7, Prediction:6, Target's Score:[-1.6065209, 0.5451074, -2.9526842, -1.3436712, 1.5340862, -2.0670583, 11.299477, -3.0208411, 1.1461136, -3.4916322]
Target sample: 13, Prediction:6, Target's Score:[-2.292204, 1.2130629, -4.27833, 3.355875, 0.47426915, -4.3023334, 12.68989, -2.234134, -1.2047834, -3.388827]
Target sample: 19, Prediction:6, Target's Score:[-1.2472034, 6.3186364, -5.354582, 0.64076734, -0.20082614, -4.6184745, 10.06005, -2.3427997, -1.897047, -1.3047274]
Target sample: 25, Prediction:6, Target's Score:[-2.3325999, 4.6812854, -3.7745664, -1.2681985, -1.942331, -3.5982308, 11.922033, -2.3448782, -0.0066342205, -1.2912586]
Target sample: 31, Prediction:6, Target's Score:[-2.6527226, 1.8815287, -4.159494, -1.174358, -1.0869029, -2.9378664, 12.315383, -2.1948764, 3.8008878, -3.7356644]
Target sample: 37, Prediction:6, Target's Score:[-2.6010547, 0.13881475, -4.851403, -0.35455197, -3.3566608, -3.1049926, 10.96635, -3.2865148, 10.189374, -3.663728]
Target sample: 43, Prediction:6, Target's Score:[-2.602295, 1.7531291, -5.0027165, 1.6366117, -2.860047, -3.7910693, 13.524044, -3.0423439, 3.2645333, -2.829276]
Target sample: 49, Prediction:6, Target's Score:[-2.4830117, 4.3768735, -4.321491, 1.9294552, -2.9531317, -2.9918618, 11.548894, -3.0418139, -0.14029686, -1.874382]
Target sample: 55, Prediction:6, Target's Score:[-4.021114, 1.1600789, -4.7486777, 4.765139, -4.2841744, -3.7193265, 10.562334, -1.6090524, 4.252685, -2.295902]
Target sample: 61, Prediction:6, Target's Score:[-4.054846, -1.0104259, -2.801274, 1.1369582, -1.5269965, -2.2069688, 10.504233, 0.21359776, 3.0561504, -3.256605]
Target sample: 67, Prediction:6, Target's Score:[-2.0134637, -1.5137722, -4.1711445, 1.4261014, 0.48936093, -2.455729, 13.606784, -3.104301, 1.8418016, -4.0666656]
Target sample: 73, Prediction:6, Target's Score:[-1.9098282, 1.8006643, -5.311731, 3.5840979, -0.6845393, -4.474664, 9.692579, -0.44762197, 0.24855621, -2.4473412]
Target sample: 79, Prediction:6, Target's Score:[-2.781973, 5.38042, -4.089491, 1.0992496, -2.812258, -4.3600097, 10.846854, -2.09976, 0.4223835, -1.5513144]
Target sample: 85, Prediction:6, Target's Score:[0.6923218, -0.12959474, -3.7429454, 0.5796068, -2.2999625, -2.9633176, 10.562736, -3.3818827, 4.4420624, -3.6902719]
Target sample: 91, Prediction:6, Target's Score:[-4.7940607, 1.0883089, -5.0465145, 2.5776846, -3.641155, -2.8665218, 10.877521, -3.2693765, 7.105345, -1.9560162]
Target sample: 97, Prediction:8, Target's Score:[-1.920409, 2.9700346, -5.398445, 1.2820867, -2.9828355, -3.1090891, 7.3818154, -4.320892, 8.325878, -2.1405504]
Target sample: 103, Prediction:6, Target's Score:[-0.8022566, -0.7301325, -4.5187635, 2.8887827, -2.1960018, -2.1668155, 8.050248, -3.5249565, 5.8658986, -2.7871811]
Target sample: 109, Prediction:1, Target's Score:[-2.673769, 8.891217, -5.1027174, 0.3902799, -2.6443205, -4.283936, 7.743548, -2.5472994, -0.7105217, 1.0009185]
Target sample: 115, Prediction:6, Target's Score:[-3.9236658, 3.4094508, -5.0667105, -1.0658993, -1.0163581, -1.1033452, 11.019108, -2.2860224, 1.076325, -0.98235124]
Target sample: 121, Prediction:6, Target's Score:[-3.2238858, 0.3693156, -1.5366216, 2.042283, 2.744857, -2.8326862, 5.73612, -0.027277777, -0.38367516, -2.840686]
Target sample: 127, Prediction:6, Target's Score:[-2.6436782, 1.3539608, -4.1524363, 0.2166471, 0.60410666, -4.202338, 6.7653174, -1.9593474, 3.209339, 0.86620027]
Current ATTACK acc on target samples: 90.909
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 13:27:24 Epoch 59, Val iteration 0, acc 93.200 (93.200)
2021-06-11 13:27:36 Epoch 59, Val iteration 19, acc 94.200 (92.770)
* Prec: 92.77000160217285
Per class accuracy =  [0.95374891 0.94658857 0.88070039 0.87355567 0.95714502 0.87982628
 0.94489937 0.95330138 0.94130647 0.94791016]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 8, 6, 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 4, 6, 6, 6, 6, 8, 6
ATTACK acc: 94.39252336448598
--------
------SUMMARY------
TIME ELAPSED (mins): 23
TARGET INDEX: 17
ResNet50 95.45454545454545 95.32710280373831 95.46000137329102 90.95000114440919
DPN92 90.9090909090909 90.65420560747664 95.50000267028808 93.27000122070312
MobileNetV2 77.27272727272727 78.50467289719626 91.22000160217286 89.56000137329102
GoogLeNet 90.9090909090909 94.39252336448598 95.41000213623047 92.77000160217285
True False False False False
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 106 images of target 19
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=False, nearest=True, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=19, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/19/target-num-20
torch.Size([200, 1, 3, 32, 32]) torch.Size([18, 3, 32, 32])
Selected nearest neighbors: [1088, 1212, 1698, 1829, 600]
Selected base image indices: [1088, 1212, 1698, 1829, 600]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103]
# Targets: 18, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 13:28:12 Iteration 0 	 Training Loss: 8.427e-01 	 Loss in Target Net: 1.071e+00	  
tensor(-0.0005, device='cuda:0')
 2021-06-11 13:29:15 Iteration 50 	 Training Loss: 2.343e-01 	 Loss in Target Net: 5.472e-01	  
tensor(-0.0016, device='cuda:0')
 2021-06-11 13:30:21 Iteration 100 	 Training Loss: 2.005e-01 	 Loss in Target Net: 5.473e-01	  
tensor(-0.0071, device='cuda:0')
 2021-06-11 13:31:25 Iteration 150 	 Training Loss: 1.880e-01 	 Loss in Target Net: 5.846e-01	  
tensor(-0.0171, device='cuda:0')
 2021-06-11 13:32:26 Iteration 200 	 Training Loss: 1.806e-01 	 Loss in Target Net: 5.795e-01	  
tensor(-0.0276, device='cuda:0')
 2021-06-11 13:33:30 Iteration 250 	 Training Loss: 1.676e-01 	 Loss in Target Net: 5.550e-01	  
tensor(-0.0395, device='cuda:0')
 2021-06-11 13:34:33 Iteration 300 	 Training Loss: 1.671e-01 	 Loss in Target Net: 6.346e-01	  
tensor(-0.0480, device='cuda:0')
 2021-06-11 13:35:36 Iteration 350 	 Training Loss: 1.632e-01 	 Loss in Target Net: 5.755e-01	  
tensor(-0.0560, device='cuda:0')
 2021-06-11 13:36:38 Iteration 400 	 Training Loss: 1.571e-01 	 Loss in Target Net: 5.508e-01	  
tensor(-0.0582, device='cuda:0')
 2021-06-11 13:37:42 Iteration 450 	 Training Loss: 1.602e-01 	 Loss in Target Net: 5.979e-01	  
tensor(-0.0628, device='cuda:0')
 2021-06-11 13:38:43 Iteration 500 	 Training Loss: 1.568e-01 	 Loss in Target Net: 5.758e-01	  
tensor(-0.0684, device='cuda:0')
 2021-06-11 13:39:44 Iteration 550 	 Training Loss: 1.601e-01 	 Loss in Target Net: 5.735e-01	  
tensor(-0.0725, device='cuda:0')
 2021-06-11 13:40:45 Iteration 600 	 Training Loss: 1.511e-01 	 Loss in Target Net: 5.602e-01	  
tensor(-0.0764, device='cuda:0')
 2021-06-11 13:41:47 Iteration 650 	 Training Loss: 1.575e-01 	 Loss in Target Net: 5.738e-01	  
tensor(-0.0796, device='cuda:0')
 2021-06-11 13:42:50 Iteration 700 	 Training Loss: 1.542e-01 	 Loss in Target Net: 6.055e-01	  
tensor(-0.0782, device='cuda:0')
 2021-06-11 13:43:50 Iteration 750 	 Training Loss: 1.527e-01 	 Loss in Target Net: 5.503e-01	  
tensor(-0.0806, device='cuda:0')
 2021-06-11 13:44:52 Iteration 800 	 Training Loss: 1.516e-01 	 Loss in Target Net: 5.770e-01	  
tensor(-0.0812, device='cuda:0')
 2021-06-11 13:45:53 Iteration 850 	 Training Loss: 1.458e-01 	 Loss in Target Net: 5.913e-01	  
tensor(-0.0804, device='cuda:0')
 2021-06-11 13:46:54 Iteration 900 	 Training Loss: 1.455e-01 	 Loss in Target Net: 5.476e-01	  
tensor(-0.0794, device='cuda:0')
 2021-06-11 13:47:54 Iteration 950 	 Training Loss: 1.479e-01 	 Loss in Target Net: 5.680e-01	  
tensor(-0.0825, device='cuda:0')
 2021-06-11 13:48:53 Iteration 999 	 Training Loss: 1.498e-01 	 Loss in Target Net: 5.717e-01	  
tensor(-0.0812, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  1829
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 13:48:59, Val iteration 0, acc 94.200 (94.200)
2021-06-11 13:49:08, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 13:49:14, Epoch 0, Iteration 7, loss 0.536 (0.948), acc 84.615 (84.600)
2021-06-11 13:50:14, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[2.0239816, 3.1905303, -2.3422897, -0.95925486, -1.9707705, -2.7380672, 5.6955633, -2.0527759, 2.369136, -3.024889]
Target sample: 7, Prediction:6, Target's Score:[2.5086057, 2.3531623, -2.4750648, -0.4160502, -1.673136, -2.3225589, 6.2675257, -2.5526512, 1.3713828, -2.862725]
Target sample: 13, Prediction:6, Target's Score:[0.027180832, 5.6685886, -1.9066743, -1.8253964, -2.919228, -3.430185, 8.991645, -2.462774, -1.4951259, -0.41007066]
Target sample: 19, Prediction:0, Target's Score:[5.4273095, 1.6536634, -1.4548329, -1.9155444, -2.1998768, -3.2702868, 3.2152975, -2.64473, 3.193266, -1.7999717]
Target sample: 25, Prediction:8, Target's Score:[4.5560656, -0.26987496, -2.2377145, -2.2814274, -3.0453718, -3.4630878, 1.2622075, -3.008125, 11.613068, -2.9283876]
Target sample: 31, Prediction:8, Target's Score:[5.007732, -0.3586717, -1.3744981, -2.434573, -2.2909424, -3.622865, 3.0832577, -2.5474017, 7.244634, -2.516722]
Target sample: 37, Prediction:0, Target's Score:[5.114075, 0.030482939, -0.9752957, -2.048579, -0.9876081, -3.8402212, 3.165269, -2.7793686, -1.4898103, 4.0374146]
Target sample: 43, Prediction:6, Target's Score:[1.4654808, 2.0401864, -1.9593619, -1.3959454, -1.8774608, -3.2339609, 8.514023, -2.9080966, -1.8375927, 1.417687]
Target sample: 49, Prediction:1, Target's Score:[-0.59346133, 8.319805, -3.0277295, -1.5183613, -2.7217777, -3.5493128, 6.4050536, -2.0462153, -0.8918024, -0.13973853]
Target sample: 55, Prediction:6, Target's Score:[-1.5859381, 6.97462, -2.8034737, -1.0078533, -2.9316177, -3.1417003, 10.077948, -2.7304156, -0.5931989, -2.0202773]
Target sample: 61, Prediction:6, Target's Score:[1.3052969, 3.379962, -1.6297888, -1.4847121, -1.7574576, -3.4001844, 7.889288, -2.892888, -0.40904582, -0.7822223]
Target sample: 67, Prediction:6, Target's Score:[4.5828557, 0.9585746, -1.0768757, -2.062359, -1.0050992, -3.5277429, 4.928585, -2.0772398, 0.4854445, -1.0088683]
Target sample: 73, Prediction:8, Target's Score:[5.9074497, -0.19894181, -1.9570948, -2.563208, -2.4151201, -3.6017087, 1.1570933, -2.3852775, 8.623044, -2.37103]
Target sample: 79, Prediction:8, Target's Score:[5.3696647, 1.059925, -1.9515489, -1.9043496, -2.6019952, -3.2069435, 2.146726, -2.8304543, 6.2854137, -2.1616585]
Target sample: 85, Prediction:6, Target's Score:[3.5796828, 0.77788424, -2.2158067, -1.0026224, -2.2322354, -3.043134, 7.2779164, -1.9091052, 0.50395197, -1.5297468]
Target sample: 91, Prediction:6, Target's Score:[-1.1940885, 5.686329, -2.7845547, -0.5836425, -3.1216424, -2.8298883, 10.549198, -2.4530103, -1.804789, -1.2237166]
Target sample: 97, Prediction:6, Target's Score:[2.2555609, 4.70701, -2.7943485, -1.2299517, -1.9783276, -3.1795313, 5.191005, -1.8362564, -0.1622683, -0.75618565]
Target sample: 103, Prediction:6, Target's Score:[2.7790384, 1.620654, -2.1808155, -0.57362026, -1.2590696, -2.5260117, 6.1932993, -2.5729585, 1.2866923, -2.5742633]
Current ATTACK acc on target samples: 61.111
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 13:51:13 Epoch 59, Val iteration 0, acc 89.800 (89.800)
2021-06-11 13:51:24 Epoch 59, Val iteration 19, acc 89.400 (89.740)
* Prec: 89.74000205993653
Per class accuracy =  [0.9459011  0.93969235 0.83438166 0.71572274 0.91357138 0.87846368
 0.94783821 0.93525979 0.9257972  0.94110623]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 8, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 1, 0, 0, 8, 8, 8, 8, 8, 8, 8, 0, 8, 0, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 0, 8, 0, 0, 8, 8, 8, 8, 8, 8, 8, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 0, 6, 6, 6, 6
ATTACK acc: 63.63636363636363
--------
DPN92
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  1829
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 13:51:35, Val iteration 0, acc 94.800 (94.800)
2021-06-11 13:51:56, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 13:52:10, Epoch 0, Iteration 7, loss 0.098 (0.420), acc 96.154 (91.400)
2021-06-11 13:54:49, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-3.4260802, 5.842935, -1.765611, -3.400157, -0.435146, -2.25586, 6.647466, -1.1931702, 2.1530385, -1.671956]
Target sample: 7, Prediction:1, Target's Score:[-2.5228815, 7.2605257, -2.4320307, -3.3402092, -2.0424588, -2.6375718, 4.734552, -0.25296223, 2.191585, -0.45077625]
Target sample: 13, Prediction:1, Target's Score:[-0.674754, 6.124768, -1.9622743, -3.0932298, -0.95354635, -3.1117845, 5.5390153, -1.8980292, -0.38797927, 0.8921869]
Target sample: 19, Prediction:1, Target's Score:[0.59943223, 5.469062, -2.661989, -3.4464018, -1.7036374, -3.4060383, 5.286319, -0.8512725, 2.6513205, -1.4905686]
Target sample: 25, Prediction:8, Target's Score:[-0.62485385, 0.6542247, -2.9573681, -3.7422662, -0.51880515, -2.712096, 3.5834231, -0.3007562, 8.489305, -1.505262]
Target sample: 31, Prediction:6, Target's Score:[-0.48280397, 3.1314182, -3.1779974, -4.042045, -0.83249927, -3.1404905, 6.552906, -0.65493387, 5.4821763, -2.4592056]
Target sample: 37, Prediction:1, Target's Score:[-1.0612862, 7.475916, -3.6120846, -2.478863, -2.299986, -3.4349701, 2.0349562, -1.6700003, 1.7338701, 3.8604665]
Target sample: 43, Prediction:6, Target's Score:[-1.9442842, 2.1455054, -2.4321795, -2.9863434, -0.28896442, -2.1960163, 8.145086, -1.493433, 2.986976, -1.5699136]
Target sample: 49, Prediction:1, Target's Score:[-2.9542627, 8.179537, -2.5332804, -4.652626, -1.7007536, -3.2990153, 7.618412, -1.3816329, 1.1508365, 0.13925305]
Target sample: 55, Prediction:6, Target's Score:[-2.6101887, 3.869854, -1.851208, -3.4713047, -1.0744926, -2.2313423, 10.32249, -1.7650994, 1.1639948, -1.9131031]
Target sample: 61, Prediction:6, Target's Score:[1.8957142, 0.082787484, -0.7174439, -3.2078502, 0.30149975, -3.0646627, 8.164829, -1.3466512, -0.038866557, -1.7427515]
Target sample: 67, Prediction:6, Target's Score:[1.8837428, 1.4750801, -0.6803513, -3.6154718, -0.11249602, -3.5196908, 4.970221, -0.4225768, 2.7056751, -2.3416235]
Target sample: 73, Prediction:6, Target's Score:[0.8036308, 1.7120795, -2.2323785, -3.9366229, -0.40945575, -3.453404, 6.259331, -0.48684266, 4.856411, -2.760055]
Target sample: 79, Prediction:8, Target's Score:[-0.9188988, 3.7803938, -2.8825412, -3.849027, -1.137708, -2.8348207, 3.1881323, -0.24185096, 7.3425736, -2.0549717]
Target sample: 85, Prediction:6, Target's Score:[-0.81330526, 4.122901, -2.2256544, -4.3287983, -1.1539136, -2.6103709, 5.6531873, -0.55196714, 4.9344926, -2.6402473]
Target sample: 91, Prediction:1, Target's Score:[-2.2214444, 9.653654, -3.1367729, -3.2651098, -1.9849899, -2.4159603, 4.280665, -1.6501634, 0.1526176, 1.1909745]
Target sample: 97, Prediction:6, Target's Score:[-3.5682545, 4.9416075, -0.011734018, -2.7295551, -1.0518473, -1.9632838, 5.7854695, -0.8127053, 1.2484503, -1.3634117]
Target sample: 103, Prediction:1, Target's Score:[-2.431137, 4.872345, -1.5991772, -3.064312, -2.0115254, -2.7158651, 2.7098658, -0.116924174, 3.1635177, 1.6515068]
Current ATTACK acc on target samples: 50.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 13:57:24 Epoch 59, Val iteration 0, acc 93.200 (93.200)
2021-06-11 13:57:45 Epoch 59, Val iteration 19, acc 92.600 (93.180)
* Prec: 93.18000183105468
Per class accuracy =  [0.94202054 0.96879533 0.88682238 0.8666079  0.94890234 0.89015308
 0.93311675 0.9476854  0.97706439 0.95324454]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 1, 1, 1, 1, 1, 1, 1, 9, 6, 1, 1, 1, 1, 1, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 1, 6, 1, 1, 1, 6, 1, 6, 6, 6, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 8, 1, 8, 8, 1, 6, 6, 8, 8, 8, 8, 6, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 6, 6, 1, 6, 1, 1, 1
ATTACK acc: 34.09090909090909
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  1829
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 13:57:48, Val iteration 0, acc 92.600 (92.600)
2021-06-11 13:57:54, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 13:57:56, Epoch 0, Iteration 7, loss 0.365 (0.310), acc 90.385 (90.200)
2021-06-11 13:58:24, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:8, Target's Score:[0.12043929, 2.411341, -0.70387095, 1.8034933, -4.4293346, -2.8225548, 2.9716861, -6.3274803, 8.785952, -1.261929]
Target sample: 7, Prediction:8, Target's Score:[-0.4284019, 1.8143898, -1.334436, 2.9654818, -5.247885, -1.3916897, 4.4549375, -6.289134, 7.1388354, -1.1438099]
Target sample: 13, Prediction:6, Target's Score:[-0.5375024, 2.0100226, -2.5001483, 3.651757, -2.1420748, -2.792243, 6.8140163, -5.548291, 1.843617, -0.27395165]
Target sample: 19, Prediction:0, Target's Score:[7.4100337, 1.6926638, -3.1199427, 0.29336178, -0.29756647, -3.7148468, -1.5133959, -2.353273, 2.9628923, -0.92226684]
Target sample: 25, Prediction:8, Target's Score:[4.767547, 1.7084409, -2.7057338, 2.8440993, -2.1037402, -3.7340984, -1.9868252, -2.6538923, 5.161814, -0.86511093]
Target sample: 31, Prediction:8, Target's Score:[1.2438166, 4.6586347, -4.1712184, 2.6957161, -4.4367657, -3.9167922, 2.4269798, -3.3151913, 4.767768, 0.5564136]
Target sample: 37, Prediction:6, Target's Score:[0.7824347, 1.6812674, -4.0212774, 3.2312694, -1.8115926, -3.1863403, 4.8923874, -4.1249514, -0.59261984, 3.706512]
Target sample: 43, Prediction:6, Target's Score:[-0.09721577, -0.4719537, -2.500439, 4.6925282, -3.4911413, -0.98509014, 10.127789, -5.7089086, -1.6189637, 0.5407393]
Target sample: 49, Prediction:1, Target's Score:[1.0609258, 8.090946, -2.2540443, -1.5094004, -5.538216, -2.5515738, 2.450015, -4.939443, 3.946923, 1.8026822]
Target sample: 55, Prediction:1, Target's Score:[-1.6287658, 6.89684, -2.7333472, 2.8357258, -5.61771, -0.50424725, 5.2367153, -6.3186107, 2.1936631, 0.24497187]
Target sample: 61, Prediction:6, Target's Score:[0.2698934, 2.110225, -3.4673007, 5.5306892, -2.1181374, -1.0732988, 8.66663, -4.591764, -1.8427889, -2.996857]
Target sample: 67, Prediction:4, Target's Score:[2.8894224, 1.1567776, -4.7976627, 2.9047108, 5.088484, -0.9709141, -0.57898676, -0.65774214, -1.8093002, -2.7108204]
Target sample: 73, Prediction:1, Target's Score:[2.7074432, 4.8682065, -3.6734478, 2.5395217, -3.2700343, -3.256012, 2.3423505, -3.7050312, 2.3380535, -0.40422502]
Target sample: 79, Prediction:3, Target's Score:[0.7804544, 3.6439233, -4.5175953, 4.943425, -2.761622, -2.199384, 1.7852024, -2.4047842, -1.4268861, 2.6991303]
Target sample: 85, Prediction:6, Target's Score:[4.828474, -0.33958334, -2.3915803, 2.1378775, -3.955357, -3.9379535, 9.331313, -4.9596114, 3.776011, -4.0389686]
Target sample: 91, Prediction:6, Target's Score:[1.6943866, 3.3236344, -1.3030547, 2.8935688, -3.4896111, -0.59007335, 6.1745014, -5.715964, -1.7677721, -0.73221]
Target sample: 97, Prediction:8, Target's Score:[-1.4651365, 1.2103844, -1.513433, 1.734635, -2.9367678, -2.3157082, 3.93505, -6.334428, 8.739068, -0.5101686]
Target sample: 103, Prediction:8, Target's Score:[0.73761916, 3.5844915, -3.16781, 3.9219525, -3.2438748, -1.124055, 1.2226201, -4.1537757, 4.0098968, -1.2778736]
Current ATTACK acc on target samples: 33.333
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 13:58:52 Epoch 59, Val iteration 0, acc 89.800 (89.800)
2021-06-11 13:58:58 Epoch 59, Val iteration 19, acc 89.600 (89.470)
* Prec: 89.47000160217286
Per class accuracy =  [0.9205414  0.93528152 0.84908902 0.82668921 0.88360138 0.82408173
 0.93251019 0.89150473 0.93372825 0.9462004 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 8, 6, 6, 6, 1, 1, 1, 3, 0, 6, 6, 0, 0, 0, 0, 8, 3, 3, 8, 8, 1, 3, 3, 8, 0, 6, 6, 6, 6, 3, 6, 6, 6, 6, 0, 1, 1, 1, 1, 1, 6, 1, 6, 6, 1, 1, 6, 3, 6, 1, 1, 0, 0, 0, 3, 0, 8, 1, 1, 3, 6, 6, 1, 6, 3, 6, 6, 6, 6, 6, 6, 0, 1, 6, 1, 1, 6, 1, 8, 8, 6, 8, 6, 6, 1, 1
ATTACK acc: 36.36363636363637
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  1829
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 13:59:06, Val iteration 0, acc 96.200 (96.200)
2021-06-11 13:59:18, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 13:59:24, Epoch 0, Iteration 7, loss 0.733 (0.786), acc 76.923 (78.600)
2021-06-11 14:00:35, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:8, Target's Score:[-4.705043, 5.870237, -1.7765882, -2.1542764, -2.8908842, -2.7741826, 4.0624933, -4.756772, 11.439988, -2.3918667]
Target sample: 7, Prediction:6, Target's Score:[-2.943853, 3.8063304, -1.1413647, 0.056423146, -2.73873, -1.1609592, 5.358007, -3.591994, 3.615368, -1.3078219]
Target sample: 13, Prediction:6, Target's Score:[0.8527371, 3.3630414, -2.2373614, -0.49614224, -3.2296302, -2.5604866, 5.049369, -3.3992572, 2.5265682, 0.08600037]
Target sample: 19, Prediction:0, Target's Score:[6.7781024, 1.1190635, 0.15858127, -1.089352, -3.5850778, -3.9453473, 4.377159, -2.8385878, 2.1251976, -3.148387]
Target sample: 25, Prediction:8, Target's Score:[2.2498043, 1.4942695, -1.4566364, -0.29960242, -3.6750982, -3.3824193, 3.709244, -1.8949846, 5.7149553, -2.514483]
Target sample: 31, Prediction:8, Target's Score:[3.9110415, 1.5990388, -2.2072172, -0.73793274, -3.7166069, -3.661262, 4.7054586, -3.3526118, 6.0513954, -2.653852]
Target sample: 37, Prediction:9, Target's Score:[2.7643423, 0.7957836, -2.2509804, 0.33979917, -2.7282531, -2.8170075, 2.3723786, -3.95113, 2.4595234, 2.9818547]
Target sample: 43, Prediction:8, Target's Score:[2.6800625, -0.4324458, -1.8599211, -1.0226705, -1.9519236, -1.0546148, 4.6140094, -4.207519, 5.567049, -2.3973858]
Target sample: 49, Prediction:8, Target's Score:[-1.2247555, 3.1595495, 0.81551397, -1.4955549, -3.318553, -3.526377, 4.2875304, -3.626543, 7.73147, -2.870922]
Target sample: 55, Prediction:6, Target's Score:[-3.6551497, 5.7394214, -2.172399, -0.40654495, -3.229752, -2.3831048, 6.498228, -4.024045, 5.105168, -1.5291953]
Target sample: 61, Prediction:6, Target's Score:[1.1767026, 0.9858102, -2.1645644, 0.07544051, -2.2205892, -2.3042126, 7.2019334, -3.5332148, 2.9119673, -2.186849]
Target sample: 67, Prediction:0, Target's Score:[5.116715, -0.11398313, -0.53740615, 1.2805617, -2.9076216, -3.287713, 2.569236, -3.151066, 2.079674, -1.0842212]
Target sample: 73, Prediction:0, Target's Score:[5.914314, 1.4060514, -0.64172, 0.0675057, -3.7220616, -3.8816988, 2.4814303, -2.8541677, 2.695067, -1.5040386]
Target sample: 79, Prediction:8, Target's Score:[2.8865354, 2.3923173, -1.3094827, -0.88426095, -4.16867, -3.4032314, 4.1019793, -2.05449, 4.552394, -2.1655788]
Target sample: 85, Prediction:0, Target's Score:[8.681671, 1.091249, -1.5747151, -0.9986889, -3.013219, -3.9130137, 4.7429433, -3.2577236, 0.80977887, -2.6113992]
Target sample: 91, Prediction:1, Target's Score:[-0.02884984, 3.1494226, 0.539546, 1.3565434, -2.5727015, -1.7462437, 1.9575182, -4.108311, -0.30552298, 1.741016]
Target sample: 97, Prediction:1, Target's Score:[-4.027931, 9.277118, -1.8954471, -0.44253552, -2.2973528, -3.4492524, 2.7567835, -3.9709466, 5.1404166, -1.127631]
Target sample: 103, Prediction:8, Target's Score:[-1.673127, 2.1826067, -0.09514562, 0.54923797, -1.5178784, -1.3575234, 2.9723577, -4.1251416, 5.3348813, -2.31933]
Current ATTACK acc on target samples: 22.222
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 14:01:45 Epoch 59, Val iteration 0, acc 92.800 (92.800)
2021-06-11 14:01:58 Epoch 59, Val iteration 19, acc 92.200 (92.270)
* Prec: 92.27000160217285
Per class accuracy =  [0.95699418 0.94933472 0.88114254 0.81508391 0.94809794 0.89391285
 0.94684996 0.94764272 0.94777421 0.93777486]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 8, 1, 6, 6, 1, 6, 1, 8, 0, 6, 1, 1, 6, 0, 0, 0, 8, 8, 8, 8, 8, 8, 8, 8, 1, 6, 0, 0, 0, 6, 0, 6, 0, 1, 1, 8, 8, 8, 8, 8, 8, 8, 1, 8, 8, 6, 6, 6, 6, 6, 0, 8, 0, 0, 0, 6, 6, 8, 0, 0, 8, 0, 8, 8, 6, 0, 0, 0, 0, 0, 0, 6, 6, 6, 1, 1, 8, 1, 8, 8, 8, 8, 8, 6, 1, 1
ATTACK acc: 22.727272727272727
--------
------SUMMARY------
TIME ELAPSED (mins): 20
TARGET INDEX: 19
ResNet50 61.111111111111114 63.63636363636363 95.46000137329102 89.74000205993653
DPN92 50.0 34.09090909090909 95.50000267028808 93.18000183105468
MobileNetV2 33.333333333333336 36.36363636363637 91.22000160217286 89.47000160217286
GoogLeNet 22.22222222222222 22.727272727272727 95.41000213623047 92.27000160217285
True False False False True
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for SENet18..
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for ResNeXt29_2x64d..
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
==> Resuming from checkpoint for DPN92..
==> Resuming from checkpoint for MobileNetV2..
==> Resuming from checkpoint for GoogLeNet..
No specific indices are determined, so try to include whatever we find
In total, we found 106 images of target 19
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', feat_reg_flag=False, gpu='0', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=True, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=19, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/19/target-num-20
torch.Size([200, 1, 3, 32, 32]) torch.Size([18, 3, 32, 32])
Selected nearest neighbors: [1088, 1212, 1698, 1829, 600]
Selected base image indices: [1088, 1212, 1698, 1829, 600]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103]
# Targets: 18, # Poisons: 5
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /sdb/sunandini/conda_env/dlcv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 14:02:35 Iteration 0 	 Training Loss: 7.998e-01 	 Loss in Target Net: 6.174e-01	  
tensor(-0.0011, device='cuda:0')
 2021-06-11 14:03:44 Iteration 50 	 Training Loss: 3.957e-01 	 Loss in Target Net: 4.432e-01	  
tensor(-0.0298, device='cuda:0')
 2021-06-11 14:04:52 Iteration 100 	 Training Loss: 3.495e-01 	 Loss in Target Net: 3.792e-01	  
tensor(-0.0566, device='cuda:0')
 2021-06-11 14:06:02 Iteration 150 	 Training Loss: 3.342e-01 	 Loss in Target Net: 3.372e-01	  
tensor(-0.0656, device='cuda:0')
 2021-06-11 14:07:10 Iteration 200 	 Training Loss: 3.270e-01 	 Loss in Target Net: 3.469e-01	  
tensor(-0.0677, device='cuda:0')
 2021-06-11 14:08:19 Iteration 250 	 Training Loss: 3.224e-01 	 Loss in Target Net: 3.554e-01	  
tensor(-0.0699, device='cuda:0')
 2021-06-11 14:09:29 Iteration 300 	 Training Loss: 3.233e-01 	 Loss in Target Net: 3.480e-01	  
tensor(-0.0681, device='cuda:0')
 2021-06-11 14:10:38 Iteration 350 	 Training Loss: 3.237e-01 	 Loss in Target Net: 3.416e-01	  
tensor(-0.0650, device='cuda:0')
 2021-06-11 14:11:47 Iteration 400 	 Training Loss: 3.252e-01 	 Loss in Target Net: 3.394e-01	  
tensor(-0.0656, device='cuda:0')
 2021-06-11 14:12:57 Iteration 450 	 Training Loss: 3.244e-01 	 Loss in Target Net: 3.387e-01	  
tensor(-0.0647, device='cuda:0')
 2021-06-11 14:14:07 Iteration 500 	 Training Loss: 3.229e-01 	 Loss in Target Net: 3.402e-01	  
tensor(-0.0653, device='cuda:0')
 2021-06-11 14:15:17 Iteration 550 	 Training Loss: 3.221e-01 	 Loss in Target Net: 3.154e-01	  
tensor(-0.0651, device='cuda:0')
 2021-06-11 14:16:27 Iteration 600 	 Training Loss: 3.211e-01 	 Loss in Target Net: 3.403e-01	  
tensor(-0.0638, device='cuda:0')
 2021-06-11 14:17:38 Iteration 650 	 Training Loss: 3.191e-01 	 Loss in Target Net: 3.293e-01	  
tensor(-0.0629, device='cuda:0')
 2021-06-11 14:18:46 Iteration 700 	 Training Loss: 3.222e-01 	 Loss in Target Net: 3.567e-01	  
tensor(-0.0637, device='cuda:0')
 2021-06-11 14:19:56 Iteration 750 	 Training Loss: 3.206e-01 	 Loss in Target Net: 3.609e-01	  
tensor(-0.0616, device='cuda:0')
 2021-06-11 14:21:05 Iteration 800 	 Training Loss: 3.208e-01 	 Loss in Target Net: 3.591e-01	  
tensor(-0.0624, device='cuda:0')
 2021-06-11 14:22:14 Iteration 850 	 Training Loss: 3.194e-01 	 Loss in Target Net: 3.519e-01	  
tensor(-0.0617, device='cuda:0')
 2021-06-11 14:23:25 Iteration 900 	 Training Loss: 3.194e-01 	 Loss in Target Net: 3.502e-01	  
tensor(-0.0621, device='cuda:0')
 2021-06-11 14:24:34 Iteration 950 	 Training Loss: 3.197e-01 	 Loss in Target Net: 3.495e-01	  
tensor(-0.0597, device='cuda:0')
 2021-06-11 14:25:43 Iteration 999 	 Training Loss: 3.218e-01 	 Loss in Target Net: 3.251e-01	  
tensor(-0.0611, device='cuda:0')
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  1829
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 14:25:49, Val iteration 0, acc 94.200 (94.200)
2021-06-11 14:25:58, Val iteration 19, acc 96.600 (95.460)
* Prec: 95.46000137329102
-----------------------------
2021-06-11 14:26:04, Epoch 0, Iteration 7, loss 0.244 (0.471), acc 94.231 (89.800)
2021-06-11 14:27:04, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.9051085, 3.110344, -3.4249854, -1.1935881, -0.9567039, 0.73825246, 9.360805, -2.9637692, -0.205493, -2.299672]
Target sample: 7, Prediction:6, Target's Score:[-3.0920074, 5.876223, -2.5542014, -1.7580644, -1.2050372, -2.5461576, 11.597795, -2.423275, -0.14727236, -3.4582016]
Target sample: 13, Prediction:6, Target's Score:[-1.9982138, 6.0206223, -1.670163, -2.6939588, -1.1112485, -3.384968, 9.935025, -2.5749123, -0.7607023, -1.5066649]
Target sample: 19, Prediction:6, Target's Score:[-0.760583, 3.9422066, -2.0541337, -0.14445852, -0.6016569, -2.082985, 5.799945, -3.0680687, 1.8176914, -2.663749]
Target sample: 25, Prediction:8, Target's Score:[-1.2783295, 1.9317819, -2.5859385, -2.2440338, -0.40971854, -3.1153598, 5.268416, -2.908306, 7.641366, -2.098182]
Target sample: 31, Prediction:6, Target's Score:[-2.651172, 7.6925416, -2.1531856, -2.4751587, -1.4182851, -3.2198336, 8.551052, -2.0000312, 1.3094853, -3.3917198]
Target sample: 37, Prediction:6, Target's Score:[-3.3617396, 4.9667706, -1.8627802, -0.4914278, -1.1716865, -2.600765, 6.701147, -3.2666047, -2.7944033, 4.058916]
Target sample: 43, Prediction:6, Target's Score:[-1.157349, 4.652352, -1.9355555, -1.7024481, -0.34349415, -2.8798473, 9.397661, -3.1396694, -1.3646212, -1.2908919]
Target sample: 49, Prediction:6, Target's Score:[-4.7553663, 9.0449095, -2.5965343, -2.8406203, -1.2400559, -3.6423736, 11.544948, -2.704278, -0.4233062, -2.093766]
Target sample: 55, Prediction:6, Target's Score:[-4.7604628, 7.887694, -2.5006196, -2.160879, -1.1452959, -3.3372135, 12.609393, -2.7450354, -0.34388793, -3.1932259]
Target sample: 61, Prediction:6, Target's Score:[-2.7213, 6.3910155, -1.542257, -2.2138283, -0.3972528, -3.4546213, 9.997462, -3.0355134, -0.88155717, -1.8899412]
Target sample: 67, Prediction:6, Target's Score:[-2.825444, 5.923591, -1.2285001, -1.6120037, 0.56713474, -2.6638842, 8.3545, -2.6245291, -1.8601857, -1.8245848]
Target sample: 73, Prediction:6, Target's Score:[0.37904882, 4.8682275, -2.5260618, -2.989913, -0.9761096, -3.4140494, 6.966546, -2.1720896, 4.0025444, -3.9095662]
Target sample: 79, Prediction:6, Target's Score:[0.123778306, 5.0254316, -2.1135023, -2.1441002, -1.0395035, -2.8829803, 6.678652, -2.5895653, 2.2544518, -3.0993116]
Target sample: 85, Prediction:1, Target's Score:[-1.5292312, 9.033168, -1.7806377, -2.8567529, -1.3197639, -3.2685843, 8.641444, -2.357824, -1.8835007, -2.4351559]
Target sample: 91, Prediction:6, Target's Score:[-3.1818864, 6.683415, -1.5601281, -0.69129044, -1.0933831, -2.8543115, 10.538643, -3.4409146, -2.891511, -1.2537546]
Target sample: 97, Prediction:6, Target's Score:[-2.609647, 3.526435, -3.9422953, -1.691866, -0.82312894, -0.25895888, 10.529065, -3.0607448, -0.3258128, -1.0652263]
Target sample: 103, Prediction:6, Target's Score:[-3.2185833, 3.877263, -2.327027, -1.1302843, -0.11696276, -1.3633349, 9.968745, -2.8735433, 0.12150667, -2.6898305]
Current ATTACK acc on target samples: 88.889
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 14:28:03 Epoch 59, Val iteration 0, acc 92.200 (92.200)
2021-06-11 14:28:14 Epoch 59, Val iteration 19, acc 92.800 (90.950)
* Prec: 90.95000190734864
Per class accuracy =  [0.94450166 0.95602623 0.83715809 0.82215799 0.91634789 0.85367083
 0.96257159 0.91182581 0.9488047  0.94567668]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 6, 6, 8, 8, 8, 6, 6, 1, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 1, 8, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 81.81818181818181
--------
DPN92
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  1829
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 14:28:25, Val iteration 0, acc 94.800 (94.800)
2021-06-11 14:28:46, Val iteration 19, acc 95.200 (95.500)
* Prec: 95.50000267028808
-----------------------------
2021-06-11 14:29:00, Epoch 0, Iteration 7, loss 0.499 (0.472), acc 88.462 (89.200)
2021-06-11 14:31:39, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.9334283, 5.1295695, -3.0785952, -1.9911184, -0.3995908, -3.3104033, 9.143327, -3.7481098, 0.42440012, 0.052485123]
Target sample: 7, Prediction:6, Target's Score:[-1.5016396, 5.0715485, -2.8075376, -2.2749224, -1.4803519, -3.443122, 10.371367, -3.6884172, -1.0652785, 1.1105595]
Target sample: 13, Prediction:6, Target's Score:[-0.96532977, 4.45142, -2.4305305, -1.2743616, -1.3937396, -4.2166147, 8.151585, -3.6127942, -2.2410622, 3.8215098]
Target sample: 19, Prediction:6, Target's Score:[0.5047716, 5.53006, -2.8671553, -1.4928398, -2.3172455, -4.3169227, 9.675047, -3.2016976, -1.1011221, -0.08006388]
Target sample: 25, Prediction:6, Target's Score:[1.9550794, 2.9052622, -2.908819, -2.403988, -1.8751081, -4.239227, 8.227263, -2.7984984, 1.6310614, -0.19067474]
Target sample: 31, Prediction:6, Target's Score:[1.2836173, 3.9235523, -3.424439, -2.5185678, -1.825901, -4.6199317, 10.991012, -3.6361213, -0.05887917, 0.21399997]
Target sample: 37, Prediction:6, Target's Score:[-0.19174433, 4.6011596, -3.5233462, -1.6350622, -2.047821, -4.4490614, 7.099174, -3.8077798, -1.4202315, 5.695786]
Target sample: 43, Prediction:6, Target's Score:[-1.3077022, 1.370132, -2.1232085, -1.5534884, -0.21624921, -3.6998596, 13.791296, -4.2576456, -1.9323466, 0.2010423]
Target sample: 49, Prediction:6, Target's Score:[-1.4853426, 7.253193, -3.9295788, -3.0243623, -1.5745897, -4.129616, 9.785559, -4.2844267, -0.59060115, 2.314301]
Target sample: 55, Prediction:6, Target's Score:[-1.5131468, 3.2679975, -2.603198, -2.488713, -0.84656256, -3.638616, 12.951957, -4.444291, -1.1270666, 0.73258513]
Target sample: 61, Prediction:6, Target's Score:[-0.31394726, 0.8782952, -2.024327, -1.6881564, -0.48506802, -3.9899416, 13.31085, -4.146133, -2.305556, 1.0402331]
Target sample: 67, Prediction:6, Target's Score:[1.687278, 3.0514925, -2.1451101, -1.3136834, -1.5496786, -4.4197803, 9.728781, -3.296209, -1.6056066, 0.17718014]
Target sample: 73, Prediction:6, Target's Score:[2.1592069, 4.496062, -2.844745, -1.9361466, -1.8532192, -4.557654, 9.8663025, -3.285239, -0.67003375, -1.0330362]
Target sample: 79, Prediction:1, Target's Score:[1.0616864, 7.876993, -3.8143892, -1.4916319, -2.3376145, -4.342608, 5.7740216, -2.658425, 0.7365026, -0.46030518]
Target sample: 85, Prediction:6, Target's Score:[2.3333802, 2.6689138, -2.499052, -2.2794707, -2.0716605, -3.726683, 10.461012, -2.9600983, -0.56157887, -1.048008]
Target sample: 91, Prediction:6, Target's Score:[-1.7001323, 7.4657106, -3.3640285, -1.3948594, -2.1279678, -3.7127912, 8.662266, -3.8220603, -1.8049095, 2.136251]
Target sample: 97, Prediction:6, Target's Score:[-1.5703332, 6.1499157, -3.3393466, -1.8692527, -0.9854165, -3.4879696, 7.9713917, -3.564791, -0.3956021, 1.3920994]
Target sample: 103, Prediction:6, Target's Score:[-1.1054939, 4.080646, -2.6127193, -2.5728178, -1.5638146, -2.9549506, 7.0973077, -3.2373035, -0.05471846, 3.193495]
Current ATTACK acc on target samples: 94.444
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 14:34:14 Epoch 59, Val iteration 0, acc 93.000 (93.000)
2021-06-11 14:34:35 Epoch 59, Val iteration 19, acc 92.600 (93.050)
* Prec: 93.05000114440918
Per class accuracy =  [0.93869242 0.96910672 0.92430602 0.8731599  0.95304242 0.87148464
 0.92682613 0.92904259 0.96675995 0.95476145]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1
ATTACK acc: 90.9090909090909
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  1829
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 14:34:39, Val iteration 0, acc 92.600 (92.600)
2021-06-11 14:34:45, Val iteration 19, acc 91.600 (91.220)
* Prec: 91.22000160217286
-----------------------------
2021-06-11 14:34:47, Epoch 0, Iteration 7, loss 0.825 (0.349), acc 78.846 (89.400)
2021-06-11 14:35:15, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:8, Target's Score:[-0.11901741, 0.7359306, 0.071085945, 2.057165, -4.0309963, -2.289737, 5.7746105, -6.267608, 6.3749166, -2.105089]
Target sample: 7, Prediction:6, Target's Score:[-0.30384967, -0.85063446, -1.2253865, 2.9563944, -4.91333, -1.1663678, 9.08963, -6.1687007, 4.6958537, -1.9349004]
Target sample: 13, Prediction:6, Target's Score:[-1.171292, 0.7599259, -1.9313306, 3.7960632, -2.3029103, -2.433572, 10.585657, -5.690519, -0.7069465, -0.6988457]
Target sample: 19, Prediction:0, Target's Score:[4.1349936, 0.9625401, -2.191828, 1.4207476, -2.083297, -2.4099169, 3.3289042, -3.6756825, 0.5408381, 0.16204476]
Target sample: 25, Prediction:3, Target's Score:[1.9899086, -0.2515627, -2.177128, 4.203188, -1.5175627, -2.2923534, 2.0600665, -2.535458, 0.74165636, -0.041354693]
Target sample: 31, Prediction:6, Target's Score:[-0.08294101, 3.8825715, -2.9479353, 2.6726286, -3.6622179, -3.3506682, 4.809505, -4.062422, 1.3525116, 1.6005979]
Target sample: 37, Prediction:6, Target's Score:[-0.5342569, 0.426794, -2.8335605, 3.252299, -2.1326766, -3.0186207, 7.332681, -4.639909, -1.2919179, 3.6640353]
Target sample: 43, Prediction:6, Target's Score:[-1.7013862, -3.4727607, -0.09137124, 5.1729574, -2.1662366, -0.27294672, 13.200533, -5.7500553, -3.0251265, -1.730784]
Target sample: 49, Prediction:1, Target's Score:[0.3228932, 5.7922254, -0.82831967, -1.0916115, -4.7540355, -2.310769, 5.2012124, -5.300813, 2.504024, 0.68262976]
Target sample: 55, Prediction:6, Target's Score:[-1.620005, 4.048947, -1.9371471, 3.2205405, -5.500449, -0.21512863, 8.784795, -6.7114825, -0.10469982, 0.2705287]
Target sample: 61, Prediction:6, Target's Score:[-0.5219582, -0.71704596, -1.6077117, 5.632276, -1.4102063, -1.0692394, 11.562308, -5.0391626, -3.0894659, -3.5416]
Target sample: 67, Prediction:4, Target's Score:[1.0919315, -0.13053073, -3.6221445, 3.3531084, 4.631058, -1.727525, 2.421423, -1.3226054, -2.289663, -2.1339147]
Target sample: 73, Prediction:6, Target's Score:[0.7654434, 1.3431222, -2.6836672, 3.3237524, -2.3134038, -2.4834783, 6.2179055, -3.7208817, -0.24716718, -0.016713677]
Target sample: 79, Prediction:6, Target's Score:[0.23402081, 0.5962936, -3.0904152, 4.8629646, -1.6400373, -2.1067119, 4.9477744, -2.8501613, -2.342302, 1.6037937]
Target sample: 85, Prediction:6, Target's Score:[2.3505285, -2.4017599, -1.5956352, 2.458646, -3.0073712, -2.9882686, 12.664356, -4.914968, 1.6632344, -4.06481]
Target sample: 91, Prediction:6, Target's Score:[0.24253847, -0.9161039, 0.004696414, 3.1330764, -2.5983405, 0.7007034, 9.98326, -5.703932, -3.2382998, -1.4391437]
Target sample: 97, Prediction:6, Target's Score:[-1.9577602, -0.3943395, -1.1115264, 2.0282822, -2.3783164, -1.8464346, 6.639806, -6.2159777, 6.4586163, -1.0212932]
Target sample: 103, Prediction:6, Target's Score:[0.06329323, 0.53143966, -2.7412536, 4.19014, -3.3107896, -1.4547815, 4.5110126, -4.3699865, 2.8535044, -0.08041219]
Current ATTACK acc on target samples: 72.222
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 14:35:42 Epoch 59, Val iteration 0, acc 90.400 (90.400)
2021-06-11 14:35:48 Epoch 59, Val iteration 19, acc 89.800 (89.440)
* Prec: 89.44000244140625
Per class accuracy =  [0.91719981 0.92859994 0.84786396 0.83173638 0.89408121 0.81701623
 0.93664364 0.8878899  0.92881927 0.95195599]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 8, 6, 6, 6, 6, 6, 6, 3, 6, 6, 6, 6, 6, 6, 3, 3, 3, 3, 6, 6, 6, 6, 6, 1, 0, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 9, 1, 6, 6, 6, 6, 6, 6, 6, 6, 3, 6, 1, 6, 6, 0, 0, 6, 3, 8, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 79.54545454545455
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  1088
poison index =  1212
poison index =  1698
poison index =  1829
poison index =  600
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 14:35:56, Val iteration 0, acc 96.200 (96.200)
2021-06-11 14:36:08, Val iteration 19, acc 94.400 (95.410)
* Prec: 95.41000213623047
-----------------------------
2021-06-11 14:36:15, Epoch 0, Iteration 7, loss 0.519 (0.624), acc 86.538 (82.400)
2021-06-11 14:37:26, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-3.2298677, 4.357745, 0.043162413, -2.6893337, -0.4628775, -2.2004066, 7.0641093, -3.7295878, 3.4838207, -2.5477018]
Target sample: 7, Prediction:6, Target's Score:[-1.9450142, 4.060934, -0.55363595, -2.3030608, -0.6231647, -1.8582995, 7.9510617, -3.164065, 0.20385478, -1.6984315]
Target sample: 13, Prediction:6, Target's Score:[-1.3747116, 5.6345453, -2.0703998, -2.193855, -1.8335778, -3.236325, 8.479562, -2.7441351, 0.30571508, -0.9025645]
Target sample: 19, Prediction:6, Target's Score:[3.953799, 2.0134351, 2.3860512, -0.9597178, -2.2875922, -3.3257732, 4.041204, -3.189255, 0.029745683, -2.5950255]
Target sample: 25, Prediction:6, Target's Score:[-0.71955574, 2.0928268, 0.30543044, -2.0929244, -0.59496474, -2.3062584, 5.1828623, -1.9210434, 1.755446, -1.6352327]
Target sample: 31, Prediction:6, Target's Score:[2.2215407, 2.8453264, -0.9138014, -1.7254406, -1.4000323, -3.363692, 5.848566, -2.8082592, 1.0200797, -1.6614866]
Target sample: 37, Prediction:9, Target's Score:[1.5238124, 1.2290611, -1.999911, -2.7699172, -1.6164954, -1.8360624, 4.558336, -3.8301594, 0.16298719, 4.649342]
Target sample: 43, Prediction:6, Target's Score:[0.53413475, 0.41817993, -0.7701224, -1.7161765, -0.94953454, -0.83640033, 6.9352403, -3.4666154, 1.6260464, -1.6985574]
Target sample: 49, Prediction:6, Target's Score:[-2.461435, 2.2594023, 1.4856584, -1.9690081, 0.097166665, -3.1661859, 9.188855, -3.6049047, 0.98504615, -2.743677]
Target sample: 55, Prediction:6, Target's Score:[-3.8182788, 6.7417355, -2.174188, -2.1161883, -1.3683306, -2.8023615, 9.647471, -3.5726838, 0.6689534, -1.1298779]
Target sample: 61, Prediction:6, Target's Score:[-0.55328244, 1.9367819, -1.8335623, -1.1434448, -0.5739088, -2.1655507, 8.640213, -3.3808017, 1.0028685, -1.8600104]
Target sample: 67, Prediction:6, Target's Score:[1.4056259, 1.6321396, -0.540978, -0.6535136, -1.7473161, -2.1931593, 5.6098514, -3.0001688, 0.18051381, -0.62887657]
Target sample: 73, Prediction:6, Target's Score:[0.93224734, 2.211052, 0.0025672996, -1.3328288, -1.6933832, -2.9936357, 5.4554486, -2.8340776, 1.2764968, -0.9632317]
Target sample: 79, Prediction:6, Target's Score:[-0.70885926, 3.439111, 0.2678105, -1.5213153, -1.6094121, -2.25766, 5.080007, -2.078341, 0.5961959, -1.1449064]
Target sample: 85, Prediction:0, Target's Score:[5.827124, 1.0158786, -0.4957701, -1.5213169, -1.5106295, -3.5543313, 5.666848, -2.9289742, 0.25618762, -2.6861343]
Target sample: 91, Prediction:6, Target's Score:[0.93406135, 3.114671, -1.0809118, 0.2493714, -1.0946956, -1.3900893, 3.6087265, -3.8948758, -0.37827832, 0.0031831414]
Target sample: 97, Prediction:1, Target's Score:[-3.261402, 6.9115653, -0.07606041, -1.9276464, -1.0583633, -2.509496, 5.186969, -3.5661454, 1.7265157, -1.3495944]
Target sample: 103, Prediction:6, Target's Score:[-2.3283815, 2.200575, 0.50211424, -2.4031165, 1.4980704, -0.008502513, 5.6029634, -3.500327, 0.6926331, -2.1746843]
Current ATTACK acc on target samples: 83.333
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 14:38:36 Epoch 59, Val iteration 0, acc 92.800 (92.800)
2021-06-11 14:38:49 Epoch 59, Val iteration 19, acc 93.400 (93.140)
* Prec: 93.1400016784668
Per class accuracy =  [0.96818746 0.94955654 0.88357273 0.89222475 0.94303171 0.88220014
 0.95883127 0.94299489 0.94104673 0.95241633]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 2, 6, 6, 6, 1, 6, 6, 1, 6, 6, 8, 8, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 1, 6, 6, 1, 6, 6, 6, 6, 6, 6, 1, 6
ATTACK acc: 87.5
--------
------SUMMARY------
TIME ELAPSED (mins): 23
TARGET INDEX: 19
ResNet50 88.88888888888889 81.81818181818181 95.46000137329102 90.95000190734864
DPN92 94.44444444444444 90.9090909090909 95.50000267028808 93.05000114440918
MobileNetV2 72.22222222222223 79.54545454545455 91.22000160217286 89.44000244140625
GoogLeNet 83.33333333333333 87.5 95.41000213623047 93.1400016784668
Original Code
bash launch/attack-end2end-12.sh 0 mean 1 1 20 False False False False ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '1', '1', '20', 'False', 'False', 'False', 'False']
Multi layer Code
bash launch/attack-end2end-12.sh 0 mean 1 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '1', '1', '20', 'False', 'False', 'False', 'True']
Original Code
bash launch/attack-end2end-12.sh 0 mean 5 1 20 False False False False ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '5', '1', '20', 'False', 'False', 'False', 'False']
Multi layer Code
bash launch/attack-end2end-12.sh 0 mean 5 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '5', '1', '20', 'False', 'False', 'False', 'True']
Original Code
bash launch/attack-end2end-12.sh 0 mean 6 1 20 False False False False ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '6', '1', '20', 'False', 'False', 'False', 'False']
Multi layer Code
bash launch/attack-end2end-12.sh 0 mean 6 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '6', '1', '20', 'False', 'False', 'False', 'True']
Original Code
bash launch/attack-end2end-12.sh 0 mean 7 1 20 False False False False ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '7', '1', '20', 'False', 'False', 'False', 'False']
Multi layer Code
bash launch/attack-end2end-12.sh 0 mean 7 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '7', '1', '20', 'False', 'False', 'False', 'True']
Original Code
bash launch/attack-end2end-12.sh 0 mean 8 1 20 False False False False ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '8', '1', '20', 'False', 'False', 'False', 'False']
Multi layer Code
bash launch/attack-end2end-12.sh 0 mean 8 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '8', '1', '20', 'False', 'False', 'False', 'True']
Original Code
bash launch/attack-end2end-12.sh 0 mean 9 1 20 False False False False ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '9', '1', '20', 'False', 'False', 'False', 'False']
Multi layer Code
bash launch/attack-end2end-12.sh 0 mean 9 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '9', '1', '20', 'False', 'False', 'False', 'True']
Original Code
bash launch/attack-end2end-12.sh 0 mean 10 1 20 False False False False ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '10', '1', '20', 'False', 'False', 'False', 'False']
Multi layer Code
bash launch/attack-end2end-12.sh 0 mean 10 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '10', '1', '20', 'False', 'False', 'False', 'True']
Original Code
bash launch/attack-end2end-12.sh 0 mean 11 1 20 False False False False ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '11', '1', '20', 'False', 'False', 'False', 'False']
Multi layer Code
bash launch/attack-end2end-12.sh 0 mean 11 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '11', '1', '20', 'False', 'False', 'False', 'True']
Original Code
bash launch/attack-end2end-12.sh 0 mean 12 1 20 False False False False ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '12', '1', '20', 'False', 'False', 'False', 'False']
Multi layer Code
bash launch/attack-end2end-12.sh 0 mean 12 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '12', '1', '20', 'False', 'False', 'False', 'True']
Original Code
bash launch/attack-end2end-12.sh 0 mean 14 1 20 False False False False ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '14', '1', '20', 'False', 'False', 'False', 'False']
Multi layer Code
bash launch/attack-end2end-12.sh 0 mean 14 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '14', '1', '20', 'False', 'False', 'False', 'True']
Original Code
bash launch/attack-end2end-12.sh 0 mean 15 1 20 False False False False ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '15', '1', '20', 'False', 'False', 'False', 'False']
Multi layer Code
bash launch/attack-end2end-12.sh 0 mean 15 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '15', '1', '20', 'False', 'False', 'False', 'True']
Original Code
bash launch/attack-end2end-12.sh 0 mean 16 1 20 False False False False ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '16', '1', '20', 'False', 'False', 'False', 'False']
Multi layer Code
bash launch/attack-end2end-12.sh 0 mean 16 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '16', '1', '20', 'False', 'False', 'False', 'True']
Original Code
bash launch/attack-end2end-12.sh 0 mean 17 1 20 False False False False ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '17', '1', '20', 'False', 'False', 'False', 'False']
Multi layer Code
bash launch/attack-end2end-12.sh 0 mean 17 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '17', '1', '20', 'False', 'False', 'False', 'True']
Original Code
bash launch/attack-end2end-12.sh 0 mean 19 1 20 False False False False ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '19', '1', '20', 'False', 'False', 'False', 'False']
Multi layer Code
bash launch/attack-end2end-12.sh 0 mean 19 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '0', 'mean', '19', '1', '20', 'False', 'False', 'False', 'True']
