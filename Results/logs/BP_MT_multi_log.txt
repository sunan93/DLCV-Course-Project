True False False False True
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.300-droplayer0.000.t7
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
No specific indices are determined, so try to include whatever we find
In total, we found 118 images of target 1
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', eval_poisons_root='', feat_reg_flag=False, gpu='1', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=1, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/1/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115]
# Targets: 20, # Poisons: 5
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 19:21:31 Iteration 0 	 Training Loss: 8.936e-01 	 Loss in Target Net: 1.146e+00	  
 2021-06-11 19:22:01 Iteration 50 	 Training Loss: 3.751e-01 	 Loss in Target Net: 4.316e-01	  
 2021-06-11 19:22:34 Iteration 100 	 Training Loss: 3.471e-01 	 Loss in Target Net: 4.384e-01	  
 2021-06-11 19:23:11 Iteration 150 	 Training Loss: 3.371e-01 	 Loss in Target Net: 4.353e-01	  
 2021-06-11 19:23:46 Iteration 200 	 Training Loss: 3.278e-01 	 Loss in Target Net: 4.313e-01	  
 2021-06-11 19:24:20 Iteration 250 	 Training Loss: 3.255e-01 	 Loss in Target Net: 4.335e-01	  
 2021-06-11 19:24:57 Iteration 300 	 Training Loss: 3.182e-01 	 Loss in Target Net: 4.424e-01	  
 2021-06-11 19:25:34 Iteration 350 	 Training Loss: 3.206e-01 	 Loss in Target Net: 4.500e-01	  
 2021-06-11 19:26:07 Iteration 400 	 Training Loss: 3.188e-01 	 Loss in Target Net: 4.243e-01	  
 2021-06-11 19:26:41 Iteration 450 	 Training Loss: 3.200e-01 	 Loss in Target Net: 4.565e-01	  
 2021-06-11 19:27:18 Iteration 500 	 Training Loss: 3.155e-01 	 Loss in Target Net: 4.385e-01	  
 2021-06-11 19:27:55 Iteration 550 	 Training Loss: 3.177e-01 	 Loss in Target Net: 4.373e-01	  
 2021-06-11 19:28:33 Iteration 600 	 Training Loss: 3.157e-01 	 Loss in Target Net: 4.615e-01	  
 2021-06-11 19:29:10 Iteration 650 	 Training Loss: 3.113e-01 	 Loss in Target Net: 4.658e-01	  
 2021-06-11 19:29:47 Iteration 700 	 Training Loss: 3.143e-01 	 Loss in Target Net: 4.499e-01	  
 2021-06-11 19:30:23 Iteration 750 	 Training Loss: 3.127e-01 	 Loss in Target Net: 4.463e-01	  
 2021-06-11 19:30:59 Iteration 800 	 Training Loss: 3.149e-01 	 Loss in Target Net: 4.519e-01	  
 2021-06-11 19:31:33 Iteration 850 	 Training Loss: 3.165e-01 	 Loss in Target Net: 4.465e-01	  
 2021-06-11 19:32:08 Iteration 900 	 Training Loss: 3.120e-01 	 Loss in Target Net: 4.129e-01	  
 2021-06-11 19:32:43 Iteration 950 	 Training Loss: 3.156e-01 	 Loss in Target Net: 4.330e-01	  
 2021-06-11 19:33:17 Iteration 999 	 Training Loss: 3.131e-01 	 Loss in Target Net: 4.369e-01	  
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 19:33:21, Val iteration 0, acc 94.200 (94.200)
2021-06-11 19:33:27, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-11 19:33:29, Epoch 0, Iteration 7, loss 0.558 (0.483), acc 78.846 (88.800)
2021-06-11 19:33:57, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:0, Target's Score:[5.7129316, -2.3344638, -2.2593637, -3.4766097, -1.7015228, -3.9782796, 4.8842335, -1.6366913, 3.0287113, 1.7799937]
Target sample: 7, Prediction:6, Target's Score:[0.7481496, 0.2988061, -1.727284, -3.0736415, -1.1433281, -2.4720747, 5.824999, -2.0182266, -0.34013718, 3.916216]
Target sample: 13, Prediction:1, Target's Score:[-4.805168, 11.550516, -0.35678837, -1.8971229, -2.8300207, -1.7568314, 6.1496334, -4.180064, -4.487642, 2.5349896]
Target sample: 19, Prediction:1, Target's Score:[-4.6112013, 9.885714, -0.533002, -1.5948973, -2.4754503, -1.7292199, 6.644545, -3.7860324, -3.4064503, 1.5461065]
Target sample: 25, Prediction:1, Target's Score:[-3.8139684, 7.0383377, -1.0739255, -1.1421723, -1.8397001, -1.3924227, 6.462842, -3.6637254, -1.7188439, 1.1173128]
Target sample: 31, Prediction:1, Target's Score:[-4.592866, 12.73839, -2.1120195, -1.06004, -3.5214603, -0.9946282, 5.3442616, -3.5249007, -3.7837682, 1.4174308]
Target sample: 37, Prediction:1, Target's Score:[-3.8666909, 12.74381, -1.662422, -1.886192, -3.250146, -2.222904, 6.2595506, -3.5557392, -3.763581, 1.1197448]
Target sample: 43, Prediction:6, Target's Score:[4.248924, -0.28872567, -3.1283038, -0.6465513, -1.4770619, -2.6238022, 5.170013, -0.69712347, -0.53586066, 0.0074583683]
Target sample: 49, Prediction:6, Target's Score:[2.5990124, 0.9414408, -2.9852884, -0.54027015, -1.7464002, -2.4150603, 7.1740108, -1.619957, 0.057399716, -1.4125155]
Target sample: 55, Prediction:0, Target's Score:[10.349547, -1.9572167, -1.9337289, -3.8897145, -2.2325573, -4.012391, 5.370724, -0.8725889, 0.85165554, -1.6473113]
Target sample: 61, Prediction:6, Target's Score:[-0.3831034, 5.4809766, -0.7162666, -1.4801929, -1.8285278, -1.1244189, 5.9866505, -3.0841296, -3.2763145, 0.4203495]
Target sample: 67, Prediction:1, Target's Score:[-4.3348546, 9.156594, -1.3349375, -1.2025139, -2.2904522, -1.6748589, 7.5709033, -3.9811542, -3.646141, 1.7027117]
Target sample: 73, Prediction:1, Target's Score:[-3.6739724, 8.697836, -1.7163507, -1.8661475, -2.0673094, -1.185079, 6.6102624, -3.4888957, -2.0541315, 0.7069296]
Target sample: 79, Prediction:1, Target's Score:[-4.0708895, 8.448203, -1.1083527, -1.1439346, -1.9423263, -0.77001476, 5.457605, -3.6075268, -2.7771904, 1.4603364]
Target sample: 85, Prediction:1, Target's Score:[-4.0245156, 8.014157, 0.5391917, -1.7149633, -2.2424672, -1.5252835, 6.6168146, -3.8642876, -3.2665951, 1.4315456]
Target sample: 91, Prediction:1, Target's Score:[-3.9755147, 7.8578715, -0.82951134, -1.20207, -1.9102461, -1.7235205, 6.790781, -3.6589653, -3.8190663, 2.438669]
Target sample: 97, Prediction:6, Target's Score:[1.4254324, 2.118776, -0.066597044, -2.005733, -0.42022282, -2.1171975, 4.6298184, -2.972104, -3.312137, 2.713483]
Target sample: 103, Prediction:6, Target's Score:[2.4935915, 0.89610314, -2.9713113, -2.5299134, -2.191755, -1.0927793, 5.2268476, -0.062056847, 1.2036403, -0.950437]
Target sample: 109, Prediction:6, Target's Score:[4.081757, -0.54560566, -2.6115348, -3.4780772, -2.135998, -3.8245306, 5.863384, -1.9057984, 4.005567, 0.58207566]
Target sample: 115, Prediction:0, Target's Score:[7.6572433, -2.9679067, -1.6882082, -4.4479547, -2.228332, -4.402854, 5.4021707, -1.2532928, 3.0084577, 0.94110185]
Current ATTACK acc on target samples: 35.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 19:34:25 Epoch 59, Val iteration 0, acc 90.800 (90.800)
2021-06-11 19:34:31 Epoch 59, Val iteration 19, acc 90.000 (90.860)
* Prec: 90.86000175476075
Per class accuracy =  [0.93942432 0.9136797  0.85383146 0.82801497 0.87426147 0.88228429
 0.96689644 0.92119092 0.94786305 0.95858973]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 0, 0, 0, 0, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 0, 0, 0, 6, 6, 0, 6, 6, 0, 0, 0, 0, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 0, 6, 0, 6, 6, 0, 0, 0, 6, 6, 0, 0, 6
ATTACK acc: 25.510204081632654
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 19:34:38, Val iteration 0, acc 94.800 (94.800)
2021-06-11 19:34:49, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-11 19:34:57, Epoch 0, Iteration 7, loss 0.258 (0.437), acc 94.231 (89.400)
2021-06-11 19:36:23, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[1.0890228, 0.12131934, -2.5220344, -1.060717, -2.0263906, -3.7080407, 8.487081, -1.9159056, 2.64138, -0.76562506]
Target sample: 7, Prediction:6, Target's Score:[-1.2865026, -1.3294168, -1.3492556, -0.7034466, 0.0921162, -3.1458743, 11.619778, -1.279112, -0.26805836, -2.0667984]
Target sample: 13, Prediction:1, Target's Score:[-1.993878, 7.8402224, -2.5970693, -2.0765357, -1.1105223, -2.4653783, 5.0773897, -1.6226709, 1.0873165, -1.7200036]
Target sample: 19, Prediction:1, Target's Score:[-1.8688117, 7.0594096, -2.5608072, -0.78321314, -1.8715761, -3.3287592, 3.828648, -1.4228227, 2.864308, -1.5165502]
Target sample: 25, Prediction:1, Target's Score:[-1.4752918, 6.434594, -3.2139874, -1.1640681, -1.7255933, -2.7903345, 4.763025, -1.9030473, 2.7945368, -1.3297462]
Target sample: 31, Prediction:1, Target's Score:[-0.5773787, 10.549158, -3.5196884, -1.4770874, -2.223104, -2.0478678, 1.4273481, -2.6565235, 1.0766104, -0.0864072]
Target sample: 37, Prediction:1, Target's Score:[0.64881986, 5.8375745, -2.7267044, -1.1032413, -1.2803223, -2.3598042, 5.6215806, -2.1693382, -0.040603533, -2.0365486]
Target sample: 43, Prediction:6, Target's Score:[0.24536638, -1.0132679, -2.656623, -0.4228056, -0.9219023, -3.3729897, 9.3731575, -0.9351355, 2.0640297, -2.0417113]
Target sample: 49, Prediction:6, Target's Score:[-1.2136046, -0.4419437, -1.9322091, -0.73795724, -1.286912, -3.2900007, 11.771253, -2.5567691, 1.4952734, -1.4950265]
Target sample: 55, Prediction:6, Target's Score:[0.23521425, -1.3024287, -1.805763, -1.20866, -0.26947513, -4.007303, 12.441099, -1.9803568, 1.3272349, -3.084973]
Target sample: 61, Prediction:6, Target's Score:[-1.7597857, 2.2519946, -1.3126421, -0.61355335, 0.18299179, -2.5352745, 9.297919, -2.2722087, -0.4235149, -2.5075152]
Target sample: 67, Prediction:6, Target's Score:[-1.5983772, 4.776692, -2.262732, -1.0221027, -0.92969984, -2.4103608, 7.159534, -2.3371265, 0.17919418, -1.1987576]
Target sample: 73, Prediction:6, Target's Score:[-0.37430814, 1.1735461, -2.5454497, -1.1885415, -0.38280678, -3.4444556, 7.022756, -0.46337086, 2.890544, -2.3571355]
Target sample: 79, Prediction:1, Target's Score:[-1.3852469, 9.001823, -3.4889722, -1.8778656, -1.7196184, -2.1447067, 2.611009, -2.386856, 2.639329, -0.80010635]
Target sample: 85, Prediction:1, Target's Score:[0.01531252, 7.597586, -2.9226477, -1.3282601, -2.7108486, -1.9123989, 4.8392243, -2.870992, 0.5723923, -0.8526153]
Target sample: 91, Prediction:1, Target's Score:[-1.207596, 8.974032, -2.5639858, -2.5601075, -1.6529541, -2.481455, 3.8235617, -1.9875997, 0.9978004, -0.89094263]
Target sample: 97, Prediction:1, Target's Score:[-0.008715197, 8.967458, -3.8642025, -2.0889754, -0.82902604, -2.206426, -0.15905626, -0.48885334, 1.7490695, -0.6028529]
Target sample: 103, Prediction:6, Target's Score:[-0.22887738, -1.1974419, -2.0231574, -0.9786894, -0.57325774, -3.2802322, 11.279328, -1.0575047, 0.8144438, -2.4414418]
Target sample: 109, Prediction:6, Target's Score:[0.8799503, 0.7603702, -2.6820226, -1.6954306, -1.5971776, -3.9821846, 8.632373, -2.0876806, 4.184317, -2.0541654]
Target sample: 115, Prediction:6, Target's Score:[0.24394758, -0.36570317, -2.4911938, -1.3509489, -1.1955492, -3.596789, 9.219008, -1.4700469, 2.7024105, -1.361287]
Current ATTACK acc on target samples: 55.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 19:37:47 Epoch 59, Val iteration 0, acc 93.800 (93.800)
2021-06-11 19:37:58 Epoch 59, Val iteration 19, acc 93.600 (93.270)
* Prec: 93.27000122070312
Per class accuracy =  [0.93762348 0.95858346 0.87759766 0.89446011 0.9428615  0.88219283
 0.95608527 0.94852052 0.96751631 0.96187614]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 1, 6, 1, 6, 6, 6, 6, 6, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 55.10204081632653
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 19:38:02, Val iteration 0, acc 92.600 (92.600)
2021-06-11 19:38:05, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-11 19:38:06, Epoch 0, Iteration 7, loss 0.691 (0.366), acc 82.692 (90.800)
2021-06-11 19:38:22, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:9, Target's Score:[-1.0615479, 0.7352678, -3.0523705, 4.6640053, -1.0412502, -3.0446944, 2.8785431, -3.946188, -3.5137308, 7.567571]
Target sample: 7, Prediction:1, Target's Score:[-1.1211394, 5.25906, -3.3777246, -1.4259326, -2.54299, -2.332153, 3.6616096, -0.021561658, -2.9088287, 4.966311]
Target sample: 13, Prediction:1, Target's Score:[-3.6202736, 11.860216, -1.4195491, -2.7347763, -2.5149667, 0.11646111, 2.776738, -2.3025744, -1.8363096, -0.038726524]
Target sample: 19, Prediction:1, Target's Score:[-3.384915, 10.663399, -3.3489728, -0.11866723, 1.0597101, -1.4287874, 1.7108474, -2.1714294, -2.6664503, -0.019677246]
Target sample: 25, Prediction:1, Target's Score:[-2.5894613, 10.901984, -3.5334425, -1.2380036, -1.3866526, -0.6356307, 1.4014419, -3.2167766, -0.8175274, 1.3627255]
Target sample: 31, Prediction:1, Target's Score:[-3.522845, 10.541295, -3.9007845, -1.4844576, -1.4291903, -0.7519097, 5.2481346, -1.8829633, -2.3242192, -0.25156507]
Target sample: 37, Prediction:1, Target's Score:[-1.7728842, 10.399652, -3.1512141, -1.1878055, -3.128221, -2.2814715, 7.1214314, -3.9997628, -3.58948, 1.8025379]
Target sample: 43, Prediction:6, Target's Score:[-1.7123592, 1.9403436, -4.095926, 0.8599346, 1.1909671, -4.04094, 7.2939744, -2.3470278, -0.46151775, 1.5486131]
Target sample: 49, Prediction:6, Target's Score:[-2.6096363, 5.0766125, -3.2963572, 0.025066912, -1.7009112, -2.5706942, 9.098111, -4.3900547, -2.2572043, 2.822693]
Target sample: 55, Prediction:6, Target's Score:[-0.70168436, 4.4672203, -4.2681804, -0.008724675, -1.2904174, -4.1450276, 8.953072, -4.862946, 3.1358202, -1.0895511]
Target sample: 61, Prediction:1, Target's Score:[0.33200282, 8.446196, -2.7568855, -0.8046494, -2.5559502, -2.3378103, 3.3359013, -2.4493225, -2.8320253, 1.7962409]
Target sample: 67, Prediction:1, Target's Score:[-2.4179263, 10.3218, -3.8791127, -0.540587, -3.5082607, -1.1144613, 4.930497, -4.474534, -0.5067327, 1.4091198]
Target sample: 73, Prediction:1, Target's Score:[-2.7558389, 6.636671, -3.9811063, 1.2171003, -0.24083802, -2.1575828, 5.082728, -3.8005214, 0.55750173, -0.3581004]
Target sample: 79, Prediction:1, Target's Score:[-2.2940247, 10.056255, -2.8054743, 0.81773573, -1.0219063, -1.5090446, 0.84976965, -2.9431553, -2.1256201, 1.2308484]
Target sample: 85, Prediction:1, Target's Score:[-2.3030066, 12.2176895, -3.0759263, -0.42122728, -4.677429, -0.7326006, 4.1107583, -5.020861, -3.058999, 3.2039435]
Target sample: 91, Prediction:1, Target's Score:[-2.5661068, 8.339342, -2.5219975, -1.97843, -2.480207, -1.3617451, 7.5535703, -2.8476632, -2.329499, 0.39956447]
Target sample: 97, Prediction:6, Target's Score:[-0.2501178, 4.898695, -2.959285, -1.6688213, -1.3406632, -2.7103474, 5.0818396, -0.08859248, -3.479109, 2.6490612]
Target sample: 103, Prediction:6, Target's Score:[-0.122875996, -0.72672963, -1.7097702, 0.24156572, 1.4803132, -3.752019, 7.413069, -1.5698053, -4.028707, 2.9194613]
Target sample: 109, Prediction:6, Target's Score:[-3.0765934, 4.800271, -5.6525526, 2.4970279, -2.5416372, -2.845417, 7.3138256, -3.3748055, -1.7910949, 4.8609214]
Target sample: 115, Prediction:9, Target's Score:[-2.4499693, -2.4606721, -3.6334279, 0.7669357, 0.36893547, -4.451504, 5.907764, -1.3013071, -0.48525903, 7.8852897]
Current ATTACK acc on target samples: 30.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 19:38:37 Epoch 59, Val iteration 0, acc 89.200 (89.200)
2021-06-11 19:38:40 Epoch 59, Val iteration 19, acc 90.800 (89.380)
* Prec: 89.38000183105468
Per class accuracy =  [0.92716443 0.92310286 0.84792578 0.82160481 0.88849944 0.8233518
 0.937768   0.88482389 0.93044315 0.94879659]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 9, 9, 9, 9, 9, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 9, 6, 6, 9, 9, 9, 9, 9, 9, 9, 9
ATTACK acc: 28.571428571428573
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 19:38:45, Val iteration 0, acc 96.200 (96.200)
2021-06-11 19:38:51, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-11 19:38:54, Epoch 0, Iteration 7, loss 0.385 (0.516), acc 90.385 (86.600)
2021-06-11 19:39:27, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:9, Target's Score:[3.9183917, -1.9675863, -2.8813813, -3.3516335, -2.6160367, -4.19063, 2.2255602, -1.8374053, -0.5556529, 11.396406]
Target sample: 7, Prediction:6, Target's Score:[1.168261, 3.1618176, -2.3024433, -2.720835, -3.297122, -3.1589677, 6.0314465, 0.9093001, -1.6312958, 1.9512888]
Target sample: 13, Prediction:1, Target's Score:[-2.7909825, 8.467123, -2.3658397, -2.669987, -2.3229458, -2.8963785, 3.3084972, -0.91881245, -2.3204978, 4.627734]
Target sample: 19, Prediction:1, Target's Score:[-3.1802492, 12.0208, -1.8382016, -2.1276324, -2.3265975, -4.294838, 2.6523554, -0.58850574, -2.0287967, 1.8374687]
Target sample: 25, Prediction:1, Target's Score:[-2.050116, 13.464507, -3.419513, -1.8580201, -2.81226, -3.403343, 1.2833108, -2.25914, -1.6720443, 2.8515236]
Target sample: 31, Prediction:1, Target's Score:[-2.2976375, 10.634129, -2.746968, -0.6809716, -3.123086, -3.7296917, -0.35753614, -2.1930153, -2.110341, 6.731235]
Target sample: 37, Prediction:1, Target's Score:[-2.1739028, 9.855434, -1.5791632, -2.315439, -3.0985742, -3.076298, 3.4588957, -0.15156394, -2.0137942, 1.2015179]
Target sample: 43, Prediction:6, Target's Score:[-0.20081511, -0.6903942, -2.2088008, -0.7856943, -3.1035225, -3.4206116, 7.059843, -0.537258, 5.4115024, -1.4184011]
Target sample: 49, Prediction:6, Target's Score:[-1.5874877, 3.86096, -2.5972342, -1.2400572, -2.1756911, -4.1184444, 6.7823186, -1.4011308, 1.6587496, 0.9123746]
Target sample: 55, Prediction:6, Target's Score:[0.5004556, -0.76073295, -1.7353684, -0.9016337, -2.462816, -3.263499, 9.780677, -0.67184067, 1.3298028, -1.7251531]
Target sample: 61, Prediction:1, Target's Score:[-2.4064052, 5.5896225, -0.59975815, -1.8572586, -1.833607, -2.7318325, 5.0603213, -0.38409838, -1.5766236, 0.82941616]
Target sample: 67, Prediction:1, Target's Score:[-1.4677323, 7.872454, -1.2504684, -0.6601593, -2.8921525, -3.3256404, 3.8353581, -1.5615399, -2.0690494, 1.622249]
Target sample: 73, Prediction:1, Target's Score:[-1.5061114, 9.348905, -2.8909767, -0.29465014, -3.015363, -3.2209816, 1.5178273, -1.2405386, -1.6004794, 3.011376]
Target sample: 79, Prediction:1, Target's Score:[-2.1864524, 12.267164, -3.8214695, -1.0875762, -3.6375952, -2.8438356, 0.5519555, -1.8248444, -1.5856535, 4.2885637]
Target sample: 85, Prediction:1, Target's Score:[-1.527858, 10.452083, -2.4486413, -1.7142138, -2.4584503, -2.2407482, 0.808338, -2.775923, -2.3959947, 4.42393]
Target sample: 91, Prediction:1, Target's Score:[-0.46643576, 6.259297, -2.9237473, -2.5448434, -1.608833, -3.914309, 3.8234496, -0.081307426, -1.325748, 2.892117]
Target sample: 97, Prediction:1, Target's Score:[-1.1088297, 10.097656, -3.7893662, -3.2599373, -2.8924968, -2.939923, 2.0421968, 1.1165184, -0.7039414, 1.5552944]
Target sample: 103, Prediction:6, Target's Score:[4.258565, -1.3896669, -2.5139797, -1.6414113, -3.7722735, 0.3466739, 4.8366504, 0.25612634, 0.80456436, -1.073909]
Target sample: 109, Prediction:9, Target's Score:[0.89396715, 1.8951342, -3.631744, -2.2037468, -2.9999063, -4.5980787, 0.6400569, -1.857528, 2.2249808, 9.761058]
Target sample: 115, Prediction:9, Target's Score:[1.6632457, -0.9291915, -2.8487897, -1.6166996, -2.0833864, -5.3408976, 1.3724905, -0.12817496, 1.4340177, 8.609131]
Current ATTACK acc on target samples: 25.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 19:39:59 Epoch 59, Val iteration 0, acc 93.800 (93.800)
2021-06-11 19:40:05 Epoch 59, Val iteration 19, acc 93.200 (92.710)
* Prec: 92.71000175476074
Per class accuracy =  [0.96121461 0.91609469 0.89120666 0.84620392 0.94328925 0.89238359
 0.96855371 0.93850642 0.94684121 0.96435272]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 0, 9, 9, 8, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 8, 8, 8, 9, 9, 9, 9, 9, 0, 9, 0, 0
ATTACK acc: 21.428571428571427
--------
------SUMMARY PRE DEFENSE------
TIME ELAPSED (mins): 11
TARGET INDEX: 1
ResNet50 35.0 25.510204081632654 95.46000137329102 90.86000175476075
DPN92 55.0 55.10204081632653 95.50000267028808 93.27000122070312
MobileNetV2 30.0 28.571428571428573 91.22000160217286 89.38000183105468
GoogLeNet 25.0 21.428571428571427 95.41000213623047 92.71000175476074
DEFENSE EVALUATION
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
ResNet50
[74, 80, 84, 86, 89] 5
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 19:40:10, Val iteration 0, acc 94.200 (94.200)
2021-06-11 19:40:16, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-11 19:40:17, Epoch 0, Iteration 7, loss 0.041 (0.359), acc 100.000 (94.800)
2021-06-11 19:40:45, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:0, Target's Score:[6.8623157, 1.4465033, -3.377344, -2.2192302, -2.8086338, -1.7575696, -2.3231936, -0.8507327, 2.9475577, 2.4113095]
Target sample: 7, Prediction:1, Target's Score:[2.1402466, 7.2387443, -3.8688815, -3.011174, -2.598685, 1.1612871, -1.6027217, -0.37321654, -1.3897871, 2.7386796]
Target sample: 13, Prediction:1, Target's Score:[-2.7947204, 20.293423, -4.0287895, -3.1164966, -3.4867074, -1.7126366, -2.9894066, -2.864244, -3.1019566, 4.4401608]
Target sample: 19, Prediction:1, Target's Score:[-1.9291888, 18.702673, -3.376731, -1.4095869, -3.4344835, -2.0725951, -2.6729882, -2.7131648, -1.9895662, 1.4637271]
Target sample: 25, Prediction:1, Target's Score:[-1.7362868, 15.99713, -3.5351355, -1.8671185, -2.7997086, -1.8494235, -2.6468842, -2.661681, -1.1056364, 2.7103534]
Target sample: 31, Prediction:1, Target's Score:[-2.13306, 21.740246, -4.116797, -2.370025, -4.3557644, -2.366008, -2.9243166, -3.0020895, -2.090725, 2.2233198]
Target sample: 37, Prediction:1, Target's Score:[-0.009820701, 19.578564, -3.9265966, -2.9543471, -4.3186345, -1.9648446, -2.0928369, -2.3529248, -1.3264701, -0.105295375]
Target sample: 43, Prediction:0, Target's Score:[4.6765323, 2.1642208, -4.49382, -0.91008276, -2.6462314, -0.37126958, -3.0084858, 0.027929936, 1.0367573, 3.862246]
Target sample: 49, Prediction:1, Target's Score:[1.2246323, 10.742107, -4.065797, 0.1758233, -3.1855865, -0.65364116, -1.5092525, -2.2842407, 0.015114376, -0.06211678]
Target sample: 55, Prediction:0, Target's Score:[9.284697, 3.0520945, -3.2775302, -2.5452285, -3.5095026, -0.9696668, -1.3516674, -1.3413237, 2.8250341, -1.816296]
Target sample: 61, Prediction:1, Target's Score:[2.8463175, 9.335469, -3.1463885, -1.4722795, -3.0956264, 0.60838616, -1.5323318, -1.8605229, -2.4885876, 1.2521917]
Target sample: 67, Prediction:1, Target's Score:[-1.0571144, 17.309696, -3.5168896, -1.9416813, -3.9656558, -1.4896921, -2.2714195, -2.5450814, -2.2503748, 2.253362]
Target sample: 73, Prediction:1, Target's Score:[0.43386588, 16.431993, -4.19502, -2.7362819, -3.4382749, -0.842315, -2.589485, -2.2699845, -0.4724412, 0.1559626]
Target sample: 79, Prediction:1, Target's Score:[-2.5538359, 16.429766, -3.3107076, -0.82352376, -2.8986945, -2.3365915, -3.216059, -2.7891355, -2.9059472, 4.9970527]
Target sample: 85, Prediction:1, Target's Score:[-2.1161287, 15.648675, -2.704081, -0.9207656, -3.4347432, -2.0370076, -3.1531847, -3.2594674, -3.213077, 5.788336]
Target sample: 91, Prediction:1, Target's Score:[-2.3552008, 13.780033, -3.5409539, -0.7517387, -2.9930515, -0.73590106, -2.8576849, -2.3066332, -3.798444, 6.1271486]
Target sample: 97, Prediction:1, Target's Score:[3.7088976, 9.500821, -4.8760333, -1.9098917, -3.15287, 1.9698461, -3.4668026, -1.3066171, -2.7162454, 2.7406528]
Target sample: 103, Prediction:5, Target's Score:[4.2005634, 2.9427173, -5.0492296, -2.3248312, -3.11457, 4.432788, -0.7390763, 0.7446321, 0.28642505, -0.9907535]
Target sample: 109, Prediction:1, Target's Score:[5.397668, 6.540508, -3.0787916, -2.566092, -3.36359, -2.0058627, -1.3149467, -2.034475, 4.472573, -1.7236123]
Target sample: 115, Prediction:0, Target's Score:[6.4315443, 0.27865237, -3.333852, -2.5094018, -2.5908988, -1.1027001, -1.6841723, -0.72075415, 0.77043587, 4.867009]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 19:41:12 Epoch 59, Val iteration 0, acc 92.200 (92.200)
2021-06-11 19:41:18 Epoch 59, Val iteration 19, acc 91.800 (92.440)
* Prec: 92.4400016784668
Per class accuracy =  [0.94886703 0.96348831 0.87964373 0.88775094 0.94614708 0.8410641
 0.94943049 0.93355529 0.94100832 0.95005288]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 0, 0, 9, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 5, 5, 0, 0, 0, 1, 1, 9, 9, 9, 0, 0, 9, 0, 1
ATTACK acc: 0.0
DPN92
[74, 80, 84, 86, 89] 27
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 19:41:22, Val iteration 0, acc 94.800 (94.800)
2021-06-11 19:41:33, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-11 19:41:36, Epoch 0, Iteration 7, loss 0.321 (0.380), acc 92.308 (91.400)
2021-06-11 19:43:02, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[1.3379977, 6.153661, -3.473563, -2.1470935, -3.2076726, -2.364081, 2.2638476, -2.8469002, 3.044065, 1.5180533]
Target sample: 7, Prediction:1, Target's Score:[0.24444377, 8.694346, -3.1727545, -2.3559716, -2.7082589, -1.8117399, 1.9157773, -2.4686048, 1.0800756, 0.8308227]
Target sample: 13, Prediction:1, Target's Score:[-0.7029543, 14.606302, -2.824414, -2.701944, -3.2704732, -1.3027232, 0.3072031, -3.6441524, -0.6598413, 0.45044956]
Target sample: 19, Prediction:1, Target's Score:[-0.1539146, 13.320373, -2.7789686, -2.0858233, -3.3519044, -1.5266218, 0.10905318, -3.0946798, -0.41898128, 0.23636132]
Target sample: 25, Prediction:1, Target's Score:[-0.4766931, 13.058496, -2.9629462, -2.0537503, -3.3288057, -1.2456601, 0.52202684, -3.8390887, 0.03717536, 0.544644]
Target sample: 31, Prediction:1, Target's Score:[0.07015131, 13.968634, -3.025062, -2.0829687, -3.4223592, -0.9324068, -0.5849309, -4.099035, -1.3143429, 1.6761603]
Target sample: 37, Prediction:1, Target's Score:[0.30175608, 13.914673, -3.0272927, -2.1203518, -3.4743357, -1.0818529, 0.124579936, -3.983264, -1.1242479, 0.72760516]
Target sample: 43, Prediction:1, Target's Score:[-0.91895956, 5.8907146, -3.776406, -2.0998523, -1.5584668, -1.8156936, 2.1105123, -1.5452857, 4.3505716, -0.35662314]
Target sample: 49, Prediction:1, Target's Score:[-0.92761403, 5.8765326, -4.05086, -2.2998931, -2.571658, -2.5157576, 4.8183517, -2.7303114, 5.025755, -0.28405634]
Target sample: 55, Prediction:8, Target's Score:[2.1520178, 4.474749, -3.4628108, -3.054962, -2.6457973, -3.5423007, 4.0395885, -2.1916442, 6.695557, -2.1151354]
Target sample: 61, Prediction:1, Target's Score:[-0.636022, 12.05555, -2.6966515, -2.0792198, -3.007739, -0.59712934, 1.2098234, -3.640413, -0.43491134, 0.062871136]
Target sample: 67, Prediction:1, Target's Score:[-0.7132853, 13.47264, -2.975835, -2.1136634, -3.2275817, -1.1462697, 0.32874715, -4.115677, -0.7795755, 1.5234225]
Target sample: 73, Prediction:1, Target's Score:[-0.18627067, 11.568407, -2.967649, -2.481609, -2.7159235, -1.4813064, 0.5300245, -3.2677202, 1.3450273, -0.087140635]
Target sample: 79, Prediction:1, Target's Score:[-0.47828963, 13.3572855, -2.8475342, -2.2296865, -3.097498, -0.9650374, 0.032331433, -4.0272737, -0.4867389, 0.99273205]
Target sample: 85, Prediction:1, Target's Score:[0.11775746, 13.929624, -2.9269454, -1.9193885, -3.565789, -0.78355235, -0.2647082, -4.327028, -1.2868679, 1.2868965]
Target sample: 91, Prediction:1, Target's Score:[-0.6957942, 13.807096, -2.572287, -2.572774, -3.2306, -0.8842235, 0.45831153, -4.15032, -0.9032424, 0.99813807]
Target sample: 97, Prediction:1, Target's Score:[-0.24631979, 12.023005, -2.9845364, -2.402043, -2.4978168, -1.4089555, -0.14760512, -2.467168, -0.17710598, 0.54447854]
Target sample: 103, Prediction:8, Target's Score:[2.0527089, 3.1975982, -3.5917866, -2.6504915, -1.7959359, -2.5851636, 1.4584031, 0.24043074, 4.114576, -0.1562663]
Target sample: 109, Prediction:1, Target's Score:[0.84806037, 7.2274485, -2.80226, -3.0952973, -2.6341386, -2.297021, 1.6798291, -2.6725273, 5.395234, -1.374354]
Target sample: 115, Prediction:8, Target's Score:[0.5956798, 4.377048, -3.4727237, -2.7615774, -2.4034867, -2.4892874, 3.242764, -1.8718891, 5.196326, -0.11130039]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 19:44:25 Epoch 59, Val iteration 0, acc 93.000 (93.000)
2021-06-11 19:44:37 Epoch 59, Val iteration 19, acc 92.800 (93.040)
* Prec: 93.0400016784668
Per class accuracy =  [0.92778776 0.97771246 0.90393813 0.89588591 0.92210717 0.8700101
 0.95332472 0.9356474  0.9679542  0.94937163]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 8, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 8, 8, 1, 8, 1, 8, 8, 1
ATTACK acc: 6.122448979591836
MobileNetV2
[74, 80, 84, 86] 47
Using Adam for retraining
2000
poison index =  89
499
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 19:44:40, Val iteration 0, acc 92.600 (92.600)
2021-06-11 19:44:43, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-11 19:44:44, Epoch 0, Iteration 7, loss 0.492 (0.309), acc 84.615 (89.800)
2021-06-11 19:44:59, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6]
Target sample: 1, Prediction:9, Target's Score:[0.068635575, 2.5944345, -2.8755417, 4.1284785, -0.60927457, -3.6188846, -0.78128666, -2.9903836, -3.2450817, 7.9733424]
Target sample: 7, Prediction:1, Target's Score:[0.2715124, 7.770263, -3.8037808, -2.0142648, -3.2353592, -2.9195487, 0.3217431, 0.72857887, -2.876249, 6.3059826]
Target sample: 13, Prediction:1, Target's Score:[-2.8094578, 15.429803, -2.2611854, -3.3807418, -3.0867882, 0.08984663, -1.5070078, -0.8330986, -1.6132616, 0.7276522]
Target sample: 19, Prediction:1, Target's Score:[-2.10293, 14.731034, -3.7514534, -1.374387, -0.039478812, -1.6137102, -3.0869975, -0.39674, -2.6296756, 1.0884864]
Target sample: 25, Prediction:1, Target's Score:[-1.2407982, 14.599237, -3.8932183, -2.2195275, -1.6208141, -0.7903537, -3.5434995, -1.7960808, -0.9230193, 2.1392283]
Target sample: 31, Prediction:1, Target's Score:[-2.4664142, 14.1624365, -4.685549, -2.4862452, -1.8245962, -0.78538644, 0.341794, -0.046974994, -2.2999437, 0.7996725]
Target sample: 37, Prediction:1, Target's Score:[-0.468943, 14.115287, -3.839907, -2.0786557, -3.678752, -2.6776028, 2.6178644, -3.0840466, -2.9630976, 2.7381716]
Target sample: 43, Prediction:1, Target's Score:[-0.43829545, 4.3237457, -4.514812, -0.26330847, 1.7924535, -4.9326854, 3.607872, -1.0549825, -0.84243536, 2.9419305]
Target sample: 49, Prediction:1, Target's Score:[-1.6593726, 6.478235, -3.3563619, -1.0775356, -1.0234871, -3.259876, 6.26255, -2.9763167, -2.1655176, 3.3921309]
Target sample: 55, Prediction:1, Target's Score:[0.59489626, 7.075745, -4.629658, -1.1347485, -1.0082954, -4.8325486, 5.297658, -3.9661386, 3.2477164, -0.04954199]
Target sample: 61, Prediction:1, Target's Score:[1.7552804, 11.264551, -3.2912621, -1.4966495, -3.2009456, -2.5564308, -0.70035267, -1.3859243, -2.0971582, 2.2710001]
Target sample: 67, Prediction:1, Target's Score:[-1.4089413, 13.373309, -4.4435935, -1.1924036, -3.8159003, -1.1691717, 0.9426757, -3.5999281, -0.37584102, 2.3181705]
Target sample: 73, Prediction:1, Target's Score:[-0.87975115, 9.920553, -4.5471725, -0.14724645, 0.06420219, -2.503201, 0.11847629, -2.5451236, 0.39791512, 0.72127414]
Target sample: 79, Prediction:1, Target's Score:[-0.56693256, 12.46668, -2.2881725, -0.3362835, -0.362576, -2.353592, -3.968646, -1.383165, -2.3187551, 1.8439816]
Target sample: 85, Prediction:1, Target's Score:[-1.1222588, 15.183399, -3.2872248, -0.9144651, -5.319711, -0.7301288, -0.9039872, -3.645685, -3.070994, 4.5263705]
Target sample: 91, Prediction:1, Target's Score:[-1.3635194, 11.764589, -2.936826, -2.7169054, -3.3613534, -1.9122747, 3.3387065, -2.1290865, -1.7491137, 1.684373]
Target sample: 97, Prediction:1, Target's Score:[1.1414161, 7.688271, -3.3942347, -2.8921447, -0.95312446, -3.3660147, 0.3637625, 1.5667506, -3.0576463, 3.4204516]
Target sample: 103, Prediction:6, Target's Score:[1.6206261, 1.8746772, -1.5291017, -1.1055386, 1.5110372, -4.4822745, 3.992858, -0.87050635, -4.372928, 3.9268672]
Target sample: 109, Prediction:1, Target's Score:[-1.9732152, 6.618049, -5.9152007, 1.7521703, -1.7943877, -3.8329167, 4.015758, -1.5545284, -2.7977428, 6.147783]
Target sample: 115, Prediction:9, Target's Score:[-1.383982, -1.2786409, -3.08664, 0.05275075, 0.95410573, -5.215267, 3.0705144, -0.2228406, -0.73605156, 8.414568]
Current ATTACK acc on target samples: 5.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 19:45:14 Epoch 59, Val iteration 0, acc 89.600 (89.600)
2021-06-11 19:45:17 Epoch 59, Val iteration 19, acc 90.800 (89.540)
* Prec: 89.5400016784668
Per class accuracy =  [0.92180115 0.92468253 0.84737928 0.82942419 0.88845464 0.82929311
 0.93354135 0.890551   0.93612616 0.9488309 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 9, 9, 9, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 6, 6, 6, 6, 1, 6, 9, 1, 1, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 6, 9, 4, 9, 9, 9, 9, 9, 9, 9, 9, 9
ATTACK acc: 9.183673469387756
GoogLeNet
[74, 80, 84, 86, 89] 22
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 19:45:20, Val iteration 0, acc 96.200 (96.200)
2021-06-11 19:45:27, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-11 19:45:28, Epoch 0, Iteration 7, loss 0.502 (0.546), acc 88.462 (87.800)
2021-06-11 19:46:00, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:9, Target's Score:[5.6239185, 0.19386965, -3.9778178, -1.2240595, -2.438544, -3.810848, -3.2370439, -2.5394406, 2.707474, 8.868438]
Target sample: 7, Prediction:1, Target's Score:[1.7618393, 9.555282, -4.1216393, -0.85221386, -3.454821, -3.4499362, -1.2802806, -0.32315287, -0.9498305, 3.2129056]
Target sample: 13, Prediction:1, Target's Score:[-1.9124216, 15.770063, -3.978508, -2.050423, -2.843442, -3.7230446, -2.7922082, -3.4620523, -2.2215502, 7.295496]
Target sample: 19, Prediction:1, Target's Score:[-1.6594596, 19.338835, -4.358506, -1.2463304, -3.7546751, -4.9792695, -3.146408, -2.6477113, -1.7885936, 4.318265]
Target sample: 25, Prediction:1, Target's Score:[-0.93964577, 17.726603, -4.52714, 0.08020787, -3.9617367, -4.75477, -3.7297428, -3.5092628, -1.0102042, 4.7075257]
Target sample: 31, Prediction:1, Target's Score:[-1.8936619, 15.970011, -4.376282, -0.19152983, -3.9844387, -3.9518316, -3.5730548, -3.2278636, -1.6223861, 6.930057]
Target sample: 37, Prediction:1, Target's Score:[0.30975318, 16.701746, -3.8193178, -1.3477921, -3.5670402, -4.180498, -2.1112697, -2.4151068, -1.9871396, 2.4902227]
Target sample: 43, Prediction:8, Target's Score:[2.2835464, 1.8309511, -3.687892, -1.2713547, -3.5323162, -3.6903024, 0.6648176, -0.9273176, 8.465923, -0.038342394]
Target sample: 49, Prediction:1, Target's Score:[0.49451846, 9.16436, -3.9415498, -0.73104316, -2.253475, -4.4703307, -0.8042003, -2.9992766, 3.5220015, 2.0981643]
Target sample: 55, Prediction:0, Target's Score:[4.8832192, 4.6268005, -3.2212784, -1.0044092, -2.0497959, -4.20332, 0.41224787, -2.1702418, 3.7944255, -0.9633643]
Target sample: 61, Prediction:1, Target's Score:[0.43758947, 11.810503, -2.5376925, -2.197654, -1.2824662, -3.542995, -1.2372999, -2.1340024, -1.5854473, 2.3439312]
Target sample: 67, Prediction:1, Target's Score:[1.5512428, 13.331047, -3.4835067, -0.7479629, -2.9505863, -4.276756, -2.792047, -2.7960155, -1.9431072, 4.1971197]
Target sample: 73, Prediction:1, Target's Score:[0.4370743, 14.805784, -4.7486906, -1.0707293, -3.4822443, -3.9986181, -3.5248892, -2.4146285, -0.6528104, 4.7360363]
Target sample: 79, Prediction:1, Target's Score:[-2.1610122, 16.926136, -5.4150634, 1.050723, -4.839608, -3.4094796, -3.8209803, -2.8831189, -1.8821751, 6.5173264]
Target sample: 85, Prediction:1, Target's Score:[-0.050040837, 16.95189, -4.5151772, -1.0500317, -3.479751, -3.2920182, -3.3461869, -3.8907144, -2.471867, 5.22747]
Target sample: 91, Prediction:1, Target's Score:[1.0732008, 13.335352, -3.3573048, -2.1817179, -1.76792, -4.4166827, -2.9320436, -2.2797484, -1.4233929, 4.033987]
Target sample: 97, Prediction:1, Target's Score:[1.1346734, 15.447703, -4.9524994, -2.4143243, -3.2784464, -4.092344, -2.7878277, -1.2918346, -0.7096912, 3.031256]
Target sample: 103, Prediction:0, Target's Score:[7.050837, 0.48620653, -4.421436, -1.3712155, -3.7130504, 0.84211105, -1.6871444, -0.30318397, 3.7602077, -0.49790195]
Target sample: 109, Prediction:9, Target's Score:[3.336196, 4.9240866, -4.5706506, -1.3458164, -2.1636755, -4.2470503, -3.3034337, -2.11019, 3.7119217, 5.883055]
Target sample: 115, Prediction:9, Target's Score:[4.884664, 3.4987335, -4.090866, -0.94445354, -1.8292055, -4.5939307, -3.2497983, -1.9531066, 2.923689, 5.48859]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 19:46:32 Epoch 59, Val iteration 0, acc 93.400 (93.400)
2021-06-11 19:46:39 Epoch 59, Val iteration 19, acc 93.800 (92.890)
* Prec: 92.89000129699707
Per class accuracy =  [0.95054851 0.95238844 0.88260117 0.82986293 0.94999118 0.92421638
 0.95684964 0.93346526 0.95760292 0.95380134]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 9, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 8, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 8, 1, 1, 9, 9, 9, 9, 0, 1, 1, 1
ATTACK acc: 0.0
------SUMMARY POST DEFENSE------
TIME ELAPSED (mins): 11
TARGET INDEX: 1
ResNet50 0.0 0.0 95.46000137329102 92.4400016784668 100.0
DPN92 0.0 6.122448979591836 95.50000267028808 93.0400016784668 100.0
MobileNetV2 5.0 9.183673469387756 91.22000160217286 89.5400016784668 80.0
GoogLeNet 0.0 0.0 95.41000213623047 92.89000129699707 100.0
True False False False True
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.300-droplayer0.000.t7
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
No specific indices are determined, so try to include whatever we find
In total, we found 84 images of target 5
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', eval_poisons_root='', feat_reg_flag=False, gpu='1', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=5, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/5/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79]
# Targets: 14, # Poisons: 5
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 19:46:56 Iteration 0 	 Training Loss: 9.121e-01 	 Loss in Target Net: 1.157e+00	  
 2021-06-11 19:47:28 Iteration 50 	 Training Loss: 4.044e-01 	 Loss in Target Net: 3.102e-01	  
 2021-06-11 19:48:01 Iteration 100 	 Training Loss: 3.730e-01 	 Loss in Target Net: 2.543e-01	  
 2021-06-11 19:48:34 Iteration 150 	 Training Loss: 3.580e-01 	 Loss in Target Net: 2.488e-01	  
 2021-06-11 19:49:09 Iteration 200 	 Training Loss: 3.548e-01 	 Loss in Target Net: 2.454e-01	  
 2021-06-11 19:49:42 Iteration 250 	 Training Loss: 3.508e-01 	 Loss in Target Net: 2.491e-01	  
 2021-06-11 19:50:15 Iteration 300 	 Training Loss: 3.473e-01 	 Loss in Target Net: 2.419e-01	  
 2021-06-11 19:50:48 Iteration 350 	 Training Loss: 3.482e-01 	 Loss in Target Net: 2.496e-01	  
 2021-06-11 19:51:23 Iteration 400 	 Training Loss: 3.446e-01 	 Loss in Target Net: 2.465e-01	  
 2021-06-11 19:51:56 Iteration 450 	 Training Loss: 3.444e-01 	 Loss in Target Net: 2.489e-01	  
 2021-06-11 19:52:32 Iteration 500 	 Training Loss: 3.492e-01 	 Loss in Target Net: 2.387e-01	  
 2021-06-11 19:53:08 Iteration 550 	 Training Loss: 3.432e-01 	 Loss in Target Net: 2.491e-01	  
 2021-06-11 19:53:45 Iteration 600 	 Training Loss: 3.446e-01 	 Loss in Target Net: 2.369e-01	  
 2021-06-11 19:54:21 Iteration 650 	 Training Loss: 3.408e-01 	 Loss in Target Net: 2.394e-01	  
 2021-06-11 19:54:59 Iteration 700 	 Training Loss: 3.428e-01 	 Loss in Target Net: 2.400e-01	  
 2021-06-11 19:55:36 Iteration 750 	 Training Loss: 3.455e-01 	 Loss in Target Net: 2.379e-01	  
 2021-06-11 19:56:11 Iteration 800 	 Training Loss: 3.476e-01 	 Loss in Target Net: 2.415e-01	  
 2021-06-11 19:56:47 Iteration 850 	 Training Loss: 3.433e-01 	 Loss in Target Net: 2.362e-01	  
 2021-06-11 19:57:22 Iteration 900 	 Training Loss: 3.429e-01 	 Loss in Target Net: 2.348e-01	  
 2021-06-11 19:57:56 Iteration 950 	 Training Loss: 3.440e-01 	 Loss in Target Net: 2.378e-01	  
 2021-06-11 19:58:31 Iteration 999 	 Training Loss: 3.440e-01 	 Loss in Target Net: 2.438e-01	  
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 19:58:34, Val iteration 0, acc 94.200 (94.200)
2021-06-11 19:58:40, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-11 19:58:42, Epoch 0, Iteration 7, loss 0.181 (0.237), acc 92.308 (94.600)
2021-06-11 19:59:10, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.983285, 1.9627271, -0.11838134, -0.15953386, -2.1382284, -2.5118854, 6.2317777, -2.663277, 1.1926225, 0.98248243]
Target sample: 7, Prediction:6, Target's Score:[0.5818017, -0.37296107, -0.5208307, -0.24278188, -1.5023268, -1.8615779, 3.0565271, -1.9610329, 2.095188, 0.58490753]
Target sample: 13, Prediction:6, Target's Score:[-0.8607472, 1.0343835, 2.1581817, -0.24837634, -1.6909302, -2.2571023, 4.6954083, -1.9957443, -2.3292007, 1.323755]
Target sample: 19, Prediction:6, Target's Score:[-1.9329194, -0.6069028, 0.28423408, 0.019640094, -1.8125525, -2.2239435, 7.379077, -2.4373364, 1.663195, -0.49243987]
Target sample: 25, Prediction:6, Target's Score:[-2.0622976, -0.06131091, 0.30710787, -0.0561459, -1.9618047, -2.4167824, 7.738323, -2.1686428, 1.0788176, -0.5642846]
Target sample: 31, Prediction:6, Target's Score:[-2.4206975, 2.2302709, 1.2447132, -0.075435646, -1.5663382, -2.3692787, 6.0892386, -2.120245, -2.0826473, 0.88040227]
Target sample: 37, Prediction:6, Target's Score:[-2.2927756, 4.393638, 1.7310916, -0.9356583, -1.8921654, -2.406935, 4.3979063, -2.3055577, -1.4126431, 0.50278205]
Target sample: 43, Prediction:6, Target's Score:[-2.4211235, 2.4535818, 0.022017268, -1.1452872, -1.8086013, -2.320795, 4.2988963, -2.2144675, 3.6055465, -0.6613288]
Target sample: 49, Prediction:6, Target's Score:[-2.6188326, 0.25123152, 1.0917406, -0.39925364, -2.0237963, -2.5789762, 6.131566, -2.6134994, 2.9965093, -0.41959053]
Target sample: 55, Prediction:6, Target's Score:[-1.784996, 4.3321824, 0.76999146, -0.7621851, -1.7817981, -2.3875103, 4.65431, -2.321785, -2.0016081, 1.0733913]
Target sample: 61, Prediction:1, Target's Score:[-0.34003207, 4.3180113, -0.8937406, -1.4949557, -0.74053997, -2.1785886, 2.4034758, -1.9119627, 0.85795957, -0.20302732]
Target sample: 67, Prediction:6, Target's Score:[-1.9866962, 1.8658464, 1.254331, 0.31596118, -1.7804084, -2.484351, 6.388186, -2.236512, -1.9288299, 0.40767795]
Target sample: 73, Prediction:6, Target's Score:[-2.6561878, 2.407956, 0.11351811, -0.266979, -1.7933866, -2.4704978, 5.7539, -2.5958571, 0.47664735, 0.8354587]
Target sample: 79, Prediction:6, Target's Score:[-2.7312367, 2.3342142, 0.20488542, 0.08993283, -2.0203676, -2.4604862, 5.9182935, -2.5927174, 0.5276185, 0.5289359]
Current ATTACK acc on target samples: 92.857
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 19:59:38 Epoch 59, Val iteration 0, acc 89.200 (89.200)
2021-06-11 19:59:44 Epoch 59, Val iteration 19, acc 91.000 (90.450)
* Prec: 90.45000114440919
Per class accuracy =  [0.92785926 0.93756461 0.84517412 0.78222403 0.95006456 0.86942115
 0.95076432 0.92739808 0.93148633 0.92351874]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 1, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 8, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 87.14285714285714
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 19:59:51, Val iteration 0, acc 94.800 (94.800)
2021-06-11 20:00:02, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-11 20:00:10, Epoch 0, Iteration 7, loss 0.612 (0.350), acc 86.538 (92.400)
2021-06-11 20:01:36, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.9714148, 5.3793845, -3.5999012, -3.6844156, -2.557131, -2.9784067, 4.460701, -0.6864442, 5.262316, 0.7753994]
Target sample: 7, Prediction:8, Target's Score:[-0.010642705, 0.1514578, -3.4397683, -4.026225, -1.9312392, -3.682745, 5.1620865, -0.08165729, 5.712663, 2.5054376]
Target sample: 13, Prediction:6, Target's Score:[-2.2424107, 1.0739195, -0.36694306, -2.3080738, -1.3772994, -1.6798124, 6.77391, 0.7677666, -2.5709648, 2.289314]
Target sample: 19, Prediction:6, Target's Score:[-2.2728796, 2.1207314, -2.7756507, -2.5670297, -2.2388778, -1.4337654, 8.927405, -0.13538775, 1.6021092, -0.8508729]
Target sample: 25, Prediction:6, Target's Score:[-1.8046813, 0.39182347, -2.278692, -1.051365, -1.96597, -2.1292431, 9.229251, -0.04342691, 1.3138572, -1.2943968]
Target sample: 31, Prediction:6, Target's Score:[-2.7515864, 5.975187, -1.0702323, -3.015977, -2.055881, -1.2758678, 6.1374497, -0.36922222, -1.743707, 0.615393]
Target sample: 37, Prediction:1, Target's Score:[-1.2353477, 5.450283, -2.666071, -3.2076685, -2.4670618, -2.148693, 4.5251718, -0.10939279, 2.4818785, -0.19640502]
Target sample: 43, Prediction:6, Target's Score:[-0.8673213, 1.8184519, -2.9040403, -3.5836864, -1.9780403, -3.1692965, 7.8874283, -0.08468438, 4.420265, -1.1539239]
Target sample: 49, Prediction:8, Target's Score:[-1.4002874, 2.693278, -2.760382, -3.6089911, -2.1979535, -2.6034522, 4.7473755, 0.17390442, 6.733168, -1.4022305]
Target sample: 55, Prediction:9, Target's Score:[-1.8408263, 3.897889, -1.8882176, -3.5587337, -1.9430127, -1.2742933, 4.1693463, -1.1682839, -2.3129876, 6.3730145]
Target sample: 61, Prediction:8, Target's Score:[0.9386412, 3.5820844, -2.6710482, -2.359234, -2.8449981, -3.4595253, 4.4210505, -0.14595878, 5.5666113, -2.637209]
Target sample: 67, Prediction:6, Target's Score:[-1.9985081, 4.0251446, -2.1309843, -2.516926, -1.7556891, -2.2683966, 6.902033, -0.8894432, -0.23440568, 1.2748753]
Target sample: 73, Prediction:6, Target's Score:[-0.940328, 4.9797225, -3.6021018, -3.7772818, -2.882102, -2.6192732, 6.0165396, -0.9298295, 2.8871312, 1.323571]
Target sample: 79, Prediction:6, Target's Score:[-2.016192, 4.739077, -3.5124605, -3.4618814, -2.644438, -2.8327117, 5.5898843, -0.48433864, 3.590965, 1.4394556]
Current ATTACK acc on target samples: 57.143
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 20:02:59 Epoch 59, Val iteration 0, acc 92.600 (92.600)
2021-06-11 20:03:11 Epoch 59, Val iteration 19, acc 92.800 (93.150)
* Prec: 93.1500015258789
Per class accuracy =  [0.95797213 0.94927724 0.89330119 0.81556236 0.93317699 0.9312112
 0.95966633 0.959017   0.96874922 0.95148489]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 8, 8, 8, 6, 1, 1, 9, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 8, 8, 8, 8, 6, 1, 1, 1, 9, 6, 6, 9, 1, 8, 8, 9, 6, 6, 6, 1, 1, 1, 1, 6, 6, 6, 6, 8, 8, 8, 8, 8, 8, 8
ATTACK acc: 45.714285714285715
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 20:03:14, Val iteration 0, acc 92.600 (92.600)
2021-06-11 20:03:17, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-11 20:03:18, Epoch 0, Iteration 7, loss 0.454 (0.368), acc 86.538 (88.800)
2021-06-11 20:03:33, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-2.6061096, 6.997697, -3.0213501, 1.5873548, -3.4794617, -1.8894219, 2.3788617, -3.5166821, 1.2904396, 2.5382657]
Target sample: 7, Prediction:3, Target's Score:[-2.7952702, 0.82676864, -1.8906972, 3.7037992, -1.3818306, -3.3638613, 0.376616, 1.6516474, 0.31429696, 2.8439841]
Target sample: 13, Prediction:1, Target's Score:[-2.6577024, 6.7356524, -2.832865, 0.9068377, -3.8273551, -2.8901565, 4.091943, -0.94737715, -1.0249498, 2.7018676]
Target sample: 19, Prediction:1, Target's Score:[-3.4190674, 8.823914, -4.7231684, 0.9790579, -7.417855, -1.1224047, 7.021785, -5.047477, 4.037953, 1.1654366]
Target sample: 25, Prediction:6, Target's Score:[-2.4033644, 5.113388, -3.475865, 0.17703083, -5.39602, -1.2646852, 7.07402, -4.2113633, 2.030173, 2.6071944]
Target sample: 31, Prediction:1, Target's Score:[-1.659742, 13.351994, -1.7566961, -2.1335394, -4.234806, -1.861875, 4.2382483, -4.764007, -3.1414647, 2.2880337]
Target sample: 37, Prediction:1, Target's Score:[-1.3791288, 11.476442, -0.36160436, -0.41003355, -6.5715156, 0.020585738, -2.948955, -0.64678186, 0.009519711, 1.1528659]
Target sample: 43, Prediction:1, Target's Score:[-1.8641907, 5.5959187, -1.4406694, 0.136821, -5.131298, -1.6595573, 2.412469, -3.3424487, 3.8308952, 1.7425895]
Target sample: 49, Prediction:1, Target's Score:[-2.875322, 4.9035573, -2.5954187, 1.9684048, -6.0049796, 1.8908321, 0.63887346, -5.543101, 4.4479284, 3.495457]
Target sample: 55, Prediction:1, Target's Score:[-2.4522285, 11.068223, -3.9652102, -0.68999016, -6.70055, 0.10162679, 3.4408052, -3.9780793, -1.7676247, 5.230116]
Target sample: 61, Prediction:1, Target's Score:[0.7289185, 9.589353, -2.1387262, 2.0188158, -5.20201, -3.5886962, 1.1234035, -5.146995, 3.8902023, -0.94659007]
Target sample: 67, Prediction:1, Target's Score:[-0.2890451, 12.098994, -2.4737356, -1.6584913, -5.0701466, -3.212747, 3.0867574, -3.2845428, -0.99482924, 2.0984683]
Target sample: 73, Prediction:1, Target's Score:[-0.5188554, 9.895047, -3.040094, -0.17454028, -6.1131887, -1.9970348, 1.2979512, -3.8455071, 3.2965093, 1.5014528]
Target sample: 79, Prediction:1, Target's Score:[-1.8446034, 8.541022, -0.23138028, 0.6603255, -4.076334, -2.1658921, -1.1102744, -1.995735, 0.64423716, 1.9000143]
Current ATTACK acc on target samples: 7.143
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 20:03:49 Epoch 59, Val iteration 0, acc 89.000 (89.000)
2021-06-11 20:03:52 Epoch 59, Val iteration 19, acc 90.600 (89.300)
* Prec: 89.30000114440918
Per class accuracy =  [0.92235174 0.92093948 0.84552275 0.82443585 0.88760941 0.82156546
 0.93422167 0.89309953 0.92776259 0.94773367]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 9, 8, 3, 1, 1, 1, 1, 6, 6, 1, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 9, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 9, 1, 1, 8, 1, 8
ATTACK acc: 18.571428571428573
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 20:03:56, Val iteration 0, acc 96.200 (96.200)
2021-06-11 20:04:03, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-11 20:04:06, Epoch 0, Iteration 7, loss 0.451 (0.596), acc 84.615 (84.000)
2021-06-11 20:04:38, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-3.7535179, 11.411644, -2.9565377, -0.75855017, -3.3253055, -4.4990067, 2.921016, -2.603715, 0.81261516, 2.808947]
Target sample: 7, Prediction:9, Target's Score:[-1.9551002, 6.4511137, -2.3358297, -1.7363008, -3.5468524, -3.6745307, 0.7963678, -3.1956706, 2.3822372, 6.8940926]
Target sample: 13, Prediction:1, Target's Score:[-2.6127813, 9.464357, -2.0941763, -1.5923997, -3.5815215, -4.111721, 3.6140323, -2.1981487, -1.4887863, 4.6653214]
Target sample: 19, Prediction:1, Target's Score:[-3.573165, 7.9262877, -3.9207995, -1.9739119, -3.5427327, -4.207268, 6.5963993, -2.4738762, 1.6659051, 3.5601416]
Target sample: 25, Prediction:1, Target's Score:[-3.5025342, 8.913639, -4.113646, -2.7772133, -3.4912343, -4.2365932, 4.7344394, -2.5717824, 3.029781, 4.079861]
Target sample: 31, Prediction:1, Target's Score:[-3.5756009, 11.058052, -3.8831818, -1.9304312, -3.0749037, -3.8515854, 3.601134, -3.1293178, -1.534475, 6.3932924]
Target sample: 37, Prediction:1, Target's Score:[-2.8521593, 12.961096, -3.9564958, -1.6948962, -3.4171107, -3.9160979, 2.2645624, -2.8215725, 0.48452854, 3.008389]
Target sample: 43, Prediction:1, Target's Score:[-3.9814959, 11.9498, -3.4797714, -3.0751033, -3.9083514, -4.3471045, 4.767393, -1.8702445, 0.9565313, 3.0455344]
Target sample: 49, Prediction:1, Target's Score:[-2.6035824, 10.166684, -3.5059345, -3.1371536, -3.4564955, -3.9305992, 1.8896371, -3.2181559, 4.079889, 3.783351]
Target sample: 55, Prediction:1, Target's Score:[-3.8297234, 13.254846, -2.9420273, -3.2901056, -4.0397196, -3.456357, 3.429901, -2.1774185, -0.85130537, 3.9615257]
Target sample: 61, Prediction:1, Target's Score:[0.5245465, 9.889696, -3.295872, -2.5828588, -2.5940044, -3.6888306, 1.066914, -2.753686, 2.4417255, 1.0469226]
Target sample: 67, Prediction:1, Target's Score:[-3.02611, 11.90041, -3.5390759, -2.7055635, -4.142776, -3.7892962, 2.6361496, -1.8695405, -1.3030294, 5.9085064]
Target sample: 73, Prediction:1, Target's Score:[-3.029724, 11.713285, -3.670679, -2.5413282, -3.7341287, -3.9148498, 3.2397223, -2.7924495, 0.3736319, 4.421109]
Target sample: 79, Prediction:1, Target's Score:[-3.6429164, 12.127642, -2.8502557, -1.4173149, -3.867565, -4.1019754, 2.660305, -3.0224667, 0.3915279, 3.7858603]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 20:05:11 Epoch 59, Val iteration 0, acc 93.800 (93.800)
2021-06-11 20:05:17 Epoch 59, Val iteration 19, acc 93.800 (92.970)
* Prec: 92.97000274658203
Per class accuracy =  [0.95232694 0.94760206 0.87339074 0.8574552  0.95567009 0.89769547
 0.95318228 0.94893468 0.95497497 0.95510631]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 9, 9, 9, 6, 1, 1, 6, 6, 1, 6, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 9, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 5.714285714285714
--------
------SUMMARY PRE DEFENSE------
TIME ELAPSED (mins): 11
TARGET INDEX: 5
ResNet50 92.85714285714286 87.14285714285714 95.46000137329102 90.45000114440919
DPN92 57.142857142857146 45.714285714285715 95.50000267028808 93.1500015258789
MobileNetV2 7.142857142857143 18.571428571428573 91.22000160217286 89.30000114440918
GoogLeNet 0.0 5.714285714285714 95.41000213623047 92.97000274658203
DEFENSE EVALUATION
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
ResNet50
[74, 80, 84, 89] 4
Using Adam for retraining
2000
poison index =  86
499
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 20:05:22, Val iteration 0, acc 94.200 (94.200)
2021-06-11 20:05:27, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-11 20:05:28, Epoch 0, Iteration 7, loss 0.355 (0.735), acc 92.308 (91.400)
2021-06-11 20:05:57, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6]
Target sample: 1, Prediction:1, Target's Score:[-2.995912, 10.462878, -3.1716707, -0.32862583, -3.4732175, -2.7940722, 2.810594, -3.5763693, 1.8634101, 1.3184423]
Target sample: 7, Prediction:1, Target's Score:[-1.0440404, 9.786199, -2.8011434, -1.0907063, -3.5992463, -2.5760424, 1.4882067, -3.0388975, -0.7089483, 3.7301378]
Target sample: 13, Prediction:1, Target's Score:[-2.0279624, 10.5148535, -1.4540985, -1.2630092, -3.1412308, -2.29264, 1.3597589, -3.305557, -3.3486955, 5.151727]
Target sample: 19, Prediction:1, Target's Score:[-1.6408719, 7.998022, -3.4132085, -0.16410598, -3.416538, -2.3398588, 3.0072803, -3.4340656, 0.41470218, 3.144172]
Target sample: 25, Prediction:1, Target's Score:[-1.8059248, 5.6184936, -3.0193002, 0.41064367, -3.3805628, -2.156418, 2.2056324, -3.189048, 1.4655629, 4.043383]
Target sample: 31, Prediction:1, Target's Score:[-3.121853, 13.554021, -1.9785627, -1.848968, -2.9515297, -2.463834, 2.4976094, -3.44019, -2.4649596, 2.3461719]
Target sample: 37, Prediction:1, Target's Score:[-3.2552211, 14.323816, -2.3395865, -1.8817897, -3.3463264, -2.7763865, 2.3876364, -3.28977, -1.045665, 1.3222862]
Target sample: 43, Prediction:1, Target's Score:[-3.293144, 10.536475, -3.1894603, -2.1202064, -3.4742346, -3.1265233, 4.4625654, -3.1300206, 4.877478, -1.4799775]
Target sample: 49, Prediction:1, Target's Score:[-2.0421944, 8.406603, -2.8574967, -2.31988, -3.0417368, -2.3445158, 2.063959, -3.354985, 4.6714807, 0.93348396]
Target sample: 55, Prediction:1, Target's Score:[-3.2974415, 12.803105, -2.6687565, -2.6579375, -3.1060474, -1.2776064, 2.029857, -3.567194, -2.9578109, 4.894294]
Target sample: 61, Prediction:1, Target's Score:[3.2629266, 8.24785, -3.1371503, -2.4659493, -3.3523326, -2.8911052, 1.8990191, -2.42828, 0.5031132, 0.38749593]
Target sample: 67, Prediction:1, Target's Score:[-1.7605853, 9.628091, -1.2086734, -0.092743516, -3.1232824, -2.6408625, 1.4901505, -3.5555606, -3.3540008, 4.8058615]
Target sample: 73, Prediction:1, Target's Score:[-1.917541, 12.356828, -2.4495862, -1.3392586, -3.4204636, -3.0900812, 1.5705323, -3.5487008, -1.4204742, 3.4036164]
Target sample: 79, Prediction:1, Target's Score:[-2.864195, 10.636041, -2.8968828, -0.16188756, -3.4531329, -2.8239677, 3.0541975, -3.5459535, 1.5420916, 0.60888386]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 20:06:24 Epoch 59, Val iteration 0, acc 92.400 (92.400)
2021-06-11 20:06:30 Epoch 59, Val iteration 19, acc 92.800 (91.910)
* Prec: 91.91000137329101
Per class accuracy =  [0.94073589 0.94719305 0.87162527 0.84895543 0.9349294  0.87766393
 0.93998244 0.93439527 0.96059372 0.93796596]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 1.4285714285714286
DPN92
[74, 80, 84, 86, 89] 27
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 20:06:33, Val iteration 0, acc 94.800 (94.800)
2021-06-11 20:06:45, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-11 20:06:48, Epoch 0, Iteration 7, loss 0.346 (0.381), acc 88.462 (91.000)
2021-06-11 20:08:14, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-0.9612052, 13.517209, -1.2370338, -2.2727523, -4.0456343, -3.9789538, -1.92054, -2.4749305, 2.3075206, 1.6702027]
Target sample: 7, Prediction:8, Target's Score:[1.290549, 5.5944233, -2.3330414, -4.035124, -3.6387358, -4.5386353, -2.2086327, -1.7614443, 6.786591, 5.5295234]
Target sample: 13, Prediction:1, Target's Score:[-1.240526, 10.448887, -1.4786838, -1.9878999, -2.6717079, -2.621548, -2.1490564, -1.3070999, -0.6708875, 4.1936703]
Target sample: 19, Prediction:1, Target's Score:[-0.16177434, 8.323123, -2.4920366, -3.2526057, -3.6419022, -3.9110508, -1.3282123, -2.963442, 5.734547, 4.3476057]
Target sample: 25, Prediction:9, Target's Score:[0.03453187, 3.409538, -2.5939565, -3.115209, -3.2109926, -4.006522, -0.9456728, -2.6014132, 6.546456, 7.1570582]
Target sample: 31, Prediction:1, Target's Score:[-1.1571794, 12.661358, -1.6694791, -2.498429, -3.0628338, -2.5696704, -2.1127825, -1.769538, -0.6073188, 3.3554165]
Target sample: 37, Prediction:1, Target's Score:[-0.24977525, 13.345264, -1.7013326, -2.9856546, -3.3320332, -3.8689663, -2.1236262, -2.047589, 1.5290555, 2.040767]
Target sample: 43, Prediction:1, Target's Score:[-0.72934747, 12.625339, -1.0345347, -3.564196, -3.763101, -4.455602, -1.6522567, -2.1899705, 4.124187, 1.2816969]
Target sample: 49, Prediction:1, Target's Score:[-0.822867, 11.794157, -1.3077303, -3.029914, -3.2979043, -4.2082524, -1.7930486, -1.9542898, 4.348768, 0.90394306]
Target sample: 55, Prediction:1, Target's Score:[-1.4156227, 9.105713, -2.504531, -2.4617522, -3.2157834, -2.5834439, -2.0869415, -2.2494543, -0.30058035, 8.300159]
Target sample: 61, Prediction:1, Target's Score:[1.829545, 10.177475, -2.3009999, -2.304224, -3.5897248, -3.413158, -1.5973922, -0.9627756, 2.3460207, 0.3545627]
Target sample: 67, Prediction:1, Target's Score:[-0.31201804, 12.006874, -2.493715, -2.604743, -3.4727268, -3.1222448, -2.280532, -2.5120485, -0.03190559, 5.4219913]
Target sample: 73, Prediction:1, Target's Score:[0.8740327, 12.837817, -2.19534, -3.3084962, -3.8894906, -4.075599, -2.3023045, -2.8589597, 2.7769742, 2.7997255]
Target sample: 79, Prediction:1, Target's Score:[-0.44700554, 13.638437, -1.5594329, -2.2324193, -3.9992092, -3.8589454, -2.0054693, -2.1256986, 1.5520841, 1.6368665]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 20:09:38 Epoch 59, Val iteration 0, acc 92.800 (92.800)
2021-06-11 20:09:50 Epoch 59, Val iteration 19, acc 94.200 (92.920)
* Prec: 92.92000198364258
Per class accuracy =  [0.95292229 0.97944073 0.89588662 0.92373902 0.93479256 0.83997191
 0.94525613 0.92211204 0.96414299 0.93733223]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 9, 9, 9, 1, 1, 8, 8, 8, 8, 9, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 9, 1, 9, 1, 9, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8
ATTACK acc: 0.0
MobileNetV2
[80, 86, 89] 47
Using Adam for retraining
2000
poison index =  74
poison index =  84
498
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 20:09:52, Val iteration 0, acc 92.600 (92.600)
2021-06-11 20:09:55, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-11 20:09:56, Epoch 0, Iteration 7, loss 0.603 (0.327), acc 80.769 (91.000)
2021-06-11 20:10:11, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.9702206, 9.103125, -2.687952, 1.6849113, -4.1543384, -3.0031672, -0.86656266, -3.7463145, 2.8521588, 3.244524]
Target sample: 7, Prediction:9, Target's Score:[-1.5372825, 2.1843758, -1.1975412, 3.1982772, -1.6633351, -3.9000418, -2.2828462, 1.7843614, 0.3544506, 3.5200424]
Target sample: 13, Prediction:1, Target's Score:[-2.2097828, 8.350581, -2.5880873, 0.41395408, -4.3446703, -3.0303364, 1.0104167, -0.23758921, -0.7201874, 3.7902436]
Target sample: 19, Prediction:1, Target's Score:[-3.055503, 11.338091, -4.746168, 0.62488836, -7.68803, -1.8781874, 3.808123, -4.758071, 4.3890715, 2.4604268]
Target sample: 25, Prediction:1, Target's Score:[-1.7912055, 7.260613, -3.431874, -0.29641247, -5.8655677, -1.7810582, 3.876444, -4.2404056, 2.7402158, 3.9564195]
Target sample: 31, Prediction:1, Target's Score:[-0.7474104, 16.078812, -2.1610494, -2.563583, -4.9951024, -2.1977122, 0.1891911, -4.2904177, -2.5877075, 3.785302]
Target sample: 37, Prediction:1, Target's Score:[-1.3329916, 12.699269, -1.1174045, -0.13594083, -6.2132125, 0.09491436, -4.912965, -0.54843235, 0.24578819, 1.7285962]
Target sample: 43, Prediction:1, Target's Score:[-1.3950065, 7.1640573, -1.0949047, 0.24343188, -5.1800656, -2.4215384, -1.1342229, -2.898359, 4.7381997, 2.42406]
Target sample: 49, Prediction:1, Target's Score:[-2.4268544, 7.472809, -2.5410082, 1.6530745, -6.476214, 1.1599473, -1.6443082, -5.6589313, 4.6856356, 4.291949]
Target sample: 55, Prediction:1, Target's Score:[-2.394069, 12.909026, -4.33067, -1.2817361, -7.09855, 0.04237727, 1.2841154, -3.7536623, -1.6243382, 6.7532787]
Target sample: 61, Prediction:1, Target's Score:[1.0875558, 10.407528, -2.1397412, 1.7425139, -4.7932205, -4.2090535, -0.9858455, -5.160701, 5.031656, -0.50392073]
Target sample: 67, Prediction:1, Target's Score:[-0.29359046, 14.168757, -2.6699038, -1.9332733, -5.5757422, -3.362499, 0.45366672, -2.7461271, -0.72795665, 3.1694372]
Target sample: 73, Prediction:1, Target's Score:[0.36987692, 12.447773, -3.0650375, -0.8140445, -6.3346224, -2.7301278, -2.3884192, -3.9121103, 4.6364675, 2.2898579]
Target sample: 79, Prediction:1, Target's Score:[-1.229901, 10.292869, 0.017027453, 0.67819464, -4.084854, -2.9202466, -3.5167615, -2.3366215, 1.4700658, 2.1210222]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 20:10:27 Epoch 59, Val iteration 0, acc 89.200 (89.200)
2021-06-11 20:10:30 Epoch 59, Val iteration 19, acc 90.800 (89.490)
* Prec: 89.4900016784668
Per class accuracy =  [0.9221076  0.92395424 0.84661302 0.83212839 0.88802288 0.82087897
 0.93720938 0.89204932 0.93466214 0.94684873]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 9, 8, 3, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 6, 1, 8, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 9, 1, 1, 8, 1, 8
ATTACK acc: 4.285714285714286
GoogLeNet
[74, 80, 84, 86, 89] 22
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 20:10:33, Val iteration 0, acc 96.200 (96.200)
2021-06-11 20:10:39, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-11 20:10:40, Epoch 0, Iteration 7, loss 0.619 (0.549), acc 82.692 (85.200)
2021-06-11 20:11:13, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-2.415753, 15.308132, -3.7812073, -1.0449466, -3.958203, -4.310659, -2.6385288, -2.6069767, 1.4875915, 4.0614743]
Target sample: 7, Prediction:1, Target's Score:[1.3539507, 6.8383403, -2.2752795, -1.8437711, -3.7550716, -3.6316285, -3.1851754, -3.394341, 5.8906937, 4.1148005]
Target sample: 13, Prediction:1, Target's Score:[-0.76500976, 14.283469, -3.282847, -1.0857166, -3.1280487, -4.0365515, -1.8471407, -1.5457903, -1.3764356, 2.8699992]
Target sample: 19, Prediction:1, Target's Score:[-2.5979877, 12.061137, -4.49241, -1.796553, -3.2565491, -3.7639453, 0.12637398, -2.7325592, 2.686197, 3.8591506]
Target sample: 25, Prediction:1, Target's Score:[-3.1256883, 11.44916, -4.5491595, -2.110718, -4.1446967, -3.882558, -0.8817128, -2.7418408, 6.2277026, 3.8625596]
Target sample: 31, Prediction:1, Target's Score:[-2.183603, 18.57877, -3.3058136, -1.5647123, -3.5593817, -4.2357183, -2.3901129, -2.9149683, -1.6556412, 3.3309076]
Target sample: 37, Prediction:1, Target's Score:[-1.0855142, 16.970848, -3.9345884, -2.2033885, -4.08879, -3.872582, -2.8940167, -2.7590423, 0.63629246, 3.3309436]
Target sample: 43, Prediction:1, Target's Score:[-2.2761405, 16.183361, -3.549227, -2.7602634, -3.838666, -4.2143474, -2.4219341, -2.130372, 1.6599926, 3.446255]
Target sample: 49, Prediction:1, Target's Score:[-1.6277416, 13.366769, -3.6315, -2.802446, -3.6160793, -3.182043, -3.2397127, -3.656575, 5.1839523, 3.3137195]
Target sample: 55, Prediction:1, Target's Score:[-2.7842617, 20.179256, -4.0802555, -3.2817495, -4.283783, -3.5556386, -2.1047163, -2.5865643, -0.85657275, 3.4539483]
Target sample: 61, Prediction:1, Target's Score:[1.1251318, 12.798493, -3.3533328, -2.4777703, -3.0966249, -3.8704553, -2.4184818, -2.8103786, 3.07467, 1.1102242]
Target sample: 67, Prediction:1, Target's Score:[-0.41369286, 18.176464, -3.9339106, -2.9596791, -4.03172, -4.128285, -2.6594024, -2.5405688, -1.0890787, 3.6835437]
Target sample: 73, Prediction:1, Target's Score:[-1.0438619, 16.041843, -4.0721865, -1.4697851, -4.0511794, -4.2148557, -2.7177248, -3.0814433, 0.32132766, 4.3948097]
Target sample: 79, Prediction:1, Target's Score:[-2.7066128, 16.299963, -3.8617442, -1.2118682, -4.2088223, -4.407068, -2.5378027, -2.877903, 1.5596106, 4.0564327]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 20:11:45 Epoch 59, Val iteration 0, acc 93.600 (93.600)
2021-06-11 20:11:52 Epoch 59, Val iteration 19, acc 94.400 (93.220)
* Prec: 93.22000122070312
Per class accuracy =  [0.95481277 0.96292842 0.8793866  0.84899041 0.95853114 0.90538981
 0.96159192 0.93936371 0.94796997 0.96230204]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 8, 8, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
------SUMMARY POST DEFENSE------
TIME ELAPSED (mins): 11
TARGET INDEX: 5
ResNet50 0.0 1.4285714285714286 95.46000137329102 91.91000137329101 80.0
DPN92 0.0 0.0 95.50000267028808 92.92000198364258 100.0
MobileNetV2 0.0 4.285714285714286 91.22000160217286 89.4900016784668 60.0
GoogLeNet 0.0 0.0 95.41000213623047 93.22000122070312 100.0
True False False False True
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.300-droplayer0.000.t7
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
No specific indices are determined, so try to include whatever we find
In total, we found 96 images of target 6
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', eval_poisons_root='', feat_reg_flag=False, gpu='1', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=6, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/6/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
# Targets: 16, # Poisons: 5
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 20:12:10 Iteration 0 	 Training Loss: 8.499e-01 	 Loss in Target Net: 1.055e+00	  
 2021-06-11 20:12:43 Iteration 50 	 Training Loss: 3.894e-01 	 Loss in Target Net: 3.633e-01	  
 2021-06-11 20:13:20 Iteration 100 	 Training Loss: 3.595e-01 	 Loss in Target Net: 3.223e-01	  
 2021-06-11 20:13:57 Iteration 150 	 Training Loss: 3.530e-01 	 Loss in Target Net: 3.096e-01	  
 2021-06-11 20:14:33 Iteration 200 	 Training Loss: 3.500e-01 	 Loss in Target Net: 3.106e-01	  
 2021-06-11 20:15:08 Iteration 250 	 Training Loss: 3.416e-01 	 Loss in Target Net: 2.962e-01	  
 2021-06-11 20:15:45 Iteration 300 	 Training Loss: 3.413e-01 	 Loss in Target Net: 3.090e-01	  
 2021-06-11 20:16:21 Iteration 350 	 Training Loss: 3.458e-01 	 Loss in Target Net: 2.954e-01	  
 2021-06-11 20:16:58 Iteration 400 	 Training Loss: 3.428e-01 	 Loss in Target Net: 3.007e-01	  
 2021-06-11 20:17:32 Iteration 450 	 Training Loss: 3.438e-01 	 Loss in Target Net: 3.028e-01	  
 2021-06-11 20:18:08 Iteration 500 	 Training Loss: 3.452e-01 	 Loss in Target Net: 3.276e-01	  
 2021-06-11 20:18:43 Iteration 550 	 Training Loss: 3.407e-01 	 Loss in Target Net: 2.965e-01	  
 2021-06-11 20:19:17 Iteration 600 	 Training Loss: 3.416e-01 	 Loss in Target Net: 3.137e-01	  
 2021-06-11 20:19:53 Iteration 650 	 Training Loss: 3.404e-01 	 Loss in Target Net: 3.054e-01	  
 2021-06-11 20:20:29 Iteration 700 	 Training Loss: 3.378e-01 	 Loss in Target Net: 3.203e-01	  
 2021-06-11 20:21:02 Iteration 750 	 Training Loss: 3.445e-01 	 Loss in Target Net: 3.128e-01	  
 2021-06-11 20:21:36 Iteration 800 	 Training Loss: 3.361e-01 	 Loss in Target Net: 3.139e-01	  
 2021-06-11 20:22:10 Iteration 850 	 Training Loss: 3.400e-01 	 Loss in Target Net: 2.972e-01	  
 2021-06-11 20:22:46 Iteration 900 	 Training Loss: 3.399e-01 	 Loss in Target Net: 3.052e-01	  
 2021-06-11 20:23:19 Iteration 950 	 Training Loss: 3.401e-01 	 Loss in Target Net: 3.005e-01	  
 2021-06-11 20:23:52 Iteration 999 	 Training Loss: 3.370e-01 	 Loss in Target Net: 3.000e-01	  
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 20:23:56, Val iteration 0, acc 94.200 (94.200)
2021-06-11 20:24:01, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-11 20:24:04, Epoch 0, Iteration 7, loss 1.001 (0.756), acc 84.615 (86.600)
2021-06-11 20:24:35, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.6803064, 6.1791205, -0.3666055, -1.8303921, -1.1978934, -2.1558533, 7.0544815, -1.8783684, -1.3619947, -1.7018408]
Target sample: 7, Prediction:1, Target's Score:[-4.3322206, 8.713206, 0.03328467, -2.9730139, -1.5262978, -2.9441304, 7.762668, -3.105609, -3.298408, 1.6917791]
Target sample: 13, Prediction:9, Target's Score:[-2.8711371, 2.029714, -0.52735096, -2.1184528, -1.8033619, -1.8357886, 4.779819, -2.763781, -2.884337, 7.9594765]
Target sample: 19, Prediction:6, Target's Score:[-3.1489837, 6.1357794, -0.56048685, -1.669194, -1.290281, -2.0945628, 6.583275, -2.0484781, -1.7233101, -0.14536949]
Target sample: 25, Prediction:1, Target's Score:[-4.1432543, 10.756522, -0.4103907, -2.7080774, -2.015321, -2.7838027, 6.282715, -2.613022, -2.1690714, -0.20079245]
Target sample: 31, Prediction:6, Target's Score:[-3.4338272, 6.798833, -0.016106904, -2.144839, -1.207593, -2.5082338, 7.873717, -2.2460158, -2.3219006, -0.7362592]
Target sample: 37, Prediction:1, Target's Score:[-4.4245834, 12.293337, -0.45828536, -3.048107, -2.2117424, -3.2998154, 6.8212643, -2.8480678, -2.2945852, -0.5378295]
Target sample: 43, Prediction:1, Target's Score:[-2.8246338, 6.666211, -0.17012843, -1.2208896, -1.0877135, -1.9657319, 6.3649793, -2.5152943, -1.5363178, -1.6844528]
Target sample: 49, Prediction:1, Target's Score:[-3.315097, 9.602948, -0.9735989, -2.1351264, -1.6537768, -2.737856, 6.4865994, -2.6831107, -1.1698229, -1.4027456]
Target sample: 55, Prediction:6, Target's Score:[-3.8384204, 5.9628882, 0.44841462, -1.7536523, -0.95671934, -2.6646278, 9.314353, -3.1720202, -2.646273, -0.6096648]
Target sample: 61, Prediction:1, Target's Score:[-4.157539, 10.770269, -0.51479954, -2.7407079, -1.9592574, -2.836937, 6.9259334, -2.3748264, -2.6400912, -0.46624377]
Target sample: 67, Prediction:6, Target's Score:[-3.3363433, 6.5311775, 0.21649818, -1.6467626, -1.0599939, -2.0755355, 7.2903957, -2.395394, -2.132221, -1.3422761]
Target sample: 73, Prediction:1, Target's Score:[-3.8850803, 9.099506, -0.51880693, -2.3711176, -1.9168812, -2.573724, 6.2511077, -2.2553668, -1.6594396, -0.16323355]
Target sample: 79, Prediction:6, Target's Score:[-4.0883183, 5.1991367, -0.123772174, -2.762563, -1.8522097, -2.6692948, 6.260285, -2.715421, -2.8810508, 5.6161885]
Target sample: 85, Prediction:6, Target's Score:[-3.1940122, 3.7239668, -0.24680226, -1.2038269, -0.8772239, -2.0363038, 7.922027, -2.8347304, -2.4522586, 1.2666942]
Target sample: 91, Prediction:1, Target's Score:[-3.1195135, 8.93833, -0.87854177, -2.2337582, -1.7153851, -2.5949793, 6.114323, -2.4571886, -0.88274556, -1.1492589]
Current ATTACK acc on target samples: 43.750
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 20:25:06 Epoch 59, Val iteration 0, acc 91.400 (91.400)
2021-06-11 20:25:11 Epoch 59, Val iteration 19, acc 92.200 (90.430)
* Prec: 90.43000144958496
Per class accuracy =  [0.90833914 0.94258835 0.82701735 0.80491813 0.89374468 0.9167524
 0.94288209 0.93631554 0.9456706  0.93182577]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 1, 6, 6, 6, 6, 9, 9, 9, 6, 9, 1, 6, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 6, 6, 1, 6, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 6, 6, 1, 6, 1, 6, 6, 6, 6, 6, 6, 1, 6, 1, 6, 1, 6, 6
ATTACK acc: 41.25
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 20:25:18, Val iteration 0, acc 94.800 (94.800)
2021-06-11 20:25:30, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-11 20:25:37, Epoch 0, Iteration 7, loss 0.260 (0.328), acc 88.462 (90.800)
2021-06-11 20:27:03, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-3.1869326, 3.810897, -2.8560705, -1.7927842, -2.0383685, -1.703943, 9.16545, -2.168963, 3.0320148, -1.9160036]
Target sample: 7, Prediction:6, Target's Score:[-4.354449, 4.3646235, -2.1777308, -2.1378248, -1.5268792, -2.4862244, 10.067329, -3.3488626, 0.2539708, 1.6956965]
Target sample: 13, Prediction:6, Target's Score:[-3.879996, 4.7925024, -2.329503, -2.103321, -2.4406905, -2.3403866, 8.624456, -3.359815, -0.34716597, 3.7223241]
Target sample: 19, Prediction:6, Target's Score:[-3.2664304, 0.39837343, -1.7658975, -0.67541456, -1.1646261, -2.0452788, 10.6386595, -2.4456286, 1.9340237, -1.322844]
Target sample: 25, Prediction:6, Target's Score:[-3.0292406, 5.0837684, -2.5706038, -1.7401321, -1.9094287, -1.5824559, 8.517812, -2.4918015, 1.0035095, -0.92835486]
Target sample: 31, Prediction:6, Target's Score:[-3.2807078, 0.6093108, -2.1164453, -1.6154133, -0.040187187, -2.3350334, 10.334406, -2.2539644, 1.7533294, -0.77942294]
Target sample: 37, Prediction:1, Target's Score:[-2.6316729, 7.667997, -2.6454837, -1.7912394, -2.0746348, -1.65704, 6.1206155, -2.3849201, 0.41771024, -0.64943296]
Target sample: 43, Prediction:6, Target's Score:[-3.5779169, 4.3823633, -2.596357, -0.9766674, -0.82587296, -1.42992, 9.302991, -3.278343, -0.25410044, -0.40090773]
Target sample: 49, Prediction:6, Target's Score:[-3.4219933, 6.487291, -2.660434, -1.8808029, -0.9803452, -1.9256693, 8.600066, -3.150497, 0.7257577, -1.4187441]
Target sample: 55, Prediction:6, Target's Score:[-4.2213407, 5.3768106, -2.5511818, -2.1847773, -1.6270294, -1.5222064, 11.480389, -3.3178911, -8.631498e-06, -1.0438207]
Target sample: 61, Prediction:6, Target's Score:[-3.6332662, 5.222928, -2.7065845, -1.9914297, -1.4015405, -1.9995475, 9.235806, -2.7417006, 1.4704281, -1.0995657]
Target sample: 67, Prediction:6, Target's Score:[-4.108824, -0.07360923, -1.9962815, -1.4229465, -0.41915095, -2.1328616, 13.27749, -3.0852046, 1.6625192, -1.400129]
Target sample: 73, Prediction:6, Target's Score:[-2.4718792, 2.289123, -2.6375842, -1.5017345, -1.5111154, -1.9925191, 9.220963, -2.283063, 2.1842709, -0.9863982]
Target sample: 79, Prediction:6, Target's Score:[-2.7181015, 5.948891, -2.9047797, -1.5694929, -2.42924, -1.9721413, 6.223986, -3.0383184, -0.25259072, 3.0573328]
Target sample: 85, Prediction:6, Target's Score:[-4.238871, 2.591354, -2.227041, -0.9958961, -1.7524968, -2.5163302, 10.681471, -3.472453, 1.0771152, 1.1805091]
Target sample: 91, Prediction:6, Target's Score:[-2.7454596, 5.959871, -2.753284, -2.2082984, -2.6397827, -1.6177418, 8.122302, -2.062187, 1.844646, -1.5311776]
Current ATTACK acc on target samples: 93.750
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 20:28:26 Epoch 59, Val iteration 0, acc 91.800 (91.800)
2021-06-11 20:28:37 Epoch 59, Val iteration 19, acc 93.400 (92.790)
* Prec: 92.79000129699708
Per class accuracy =  [0.94636568 0.9660421  0.89390687 0.83753701 0.95253619 0.88202536
 0.95374557 0.93745493 0.96333971 0.94766697]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 87.5
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 20:28:40, Val iteration 0, acc 92.600 (92.600)
2021-06-11 20:28:43, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-11 20:28:44, Epoch 0, Iteration 7, loss 0.455 (0.343), acc 88.462 (89.600)
2021-06-11 20:29:00, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.4112799, 10.926363, -5.3859806, 0.38493204, -3.898418, -3.1432083, 6.4977036, -5.0212917, 2.4356725, -1.0175862]
Target sample: 7, Prediction:1, Target's Score:[-0.79629153, 7.6126394, -2.9913163, -1.1085633, -0.49432975, -2.5102365, 6.32668, -4.6728134, -3.9295356, 2.9481437]
Target sample: 13, Prediction:9, Target's Score:[-3.3177285, 6.1698127, -3.0844083, 2.006265, -2.7699907, -2.7148485, 7.151569, -6.007862, -4.4212985, 7.3804936]
Target sample: 19, Prediction:6, Target's Score:[-4.2515426, 7.7361913, -2.9329796, 3.4540772, -2.0243955, -3.067001, 7.884469, -4.81379, -0.96887547, -0.6213337]
Target sample: 25, Prediction:6, Target's Score:[-3.6061594, 7.7631545, -4.2686477, 0.94748074, -2.8792639, -2.8653843, 10.248975, -3.5290506, -1.9283341, 0.4717309]
Target sample: 31, Prediction:1, Target's Score:[-3.2348492, 7.9783435, -4.709213, 0.8013812, 2.932654, -1.8422768, 6.5095043, -4.380783, -4.599875, 0.9652538]
Target sample: 37, Prediction:1, Target's Score:[-2.5310602, 9.367997, -4.2101164, 0.64223653, 0.8590623, -2.564516, 5.5699153, -5.1867795, -4.4975634, 2.9842744]
Target sample: 43, Prediction:6, Target's Score:[-1.9661654, 2.4386559, -0.72555095, 3.41216, -2.8176146, -3.1464794, 10.928962, -6.095022, 0.28917378, -2.0150445]
Target sample: 49, Prediction:6, Target's Score:[-3.307576, 4.006475, -3.6915836, 3.4123592, 2.3162549, -3.5862403, 9.512708, -5.482347, -0.35886756, -2.4834015]
Target sample: 55, Prediction:6, Target's Score:[-4.502951, 6.491298, -4.276214, 1.5074975, -0.96961635, -2.8529265, 16.323067, -6.155719, -2.0751708, -3.1316867]
Target sample: 61, Prediction:1, Target's Score:[-4.081021, 8.614696, -5.198695, 2.0108657, 1.3909675, -1.262945, 4.8405166, -4.3608375, -2.7097957, 1.173768]
Target sample: 67, Prediction:1, Target's Score:[-3.8285315, 5.9234734, -2.748474, 2.4681299, 5.5775323, -2.042571, 5.657691, -5.698963, -4.3510737, -0.49016327]
Target sample: 73, Prediction:1, Target's Score:[-2.5992048, 8.973562, -4.0315003, 0.81306666, 0.996937, -3.1777105, 7.164554, -4.7975864, -3.327015, 0.38917318]
Target sample: 79, Prediction:1, Target's Score:[-1.7382503, 9.935332, -4.838453, -1.5643516, -5.4418287, -1.2328609, 6.7143264, -6.055622, -1.0539256, 5.6550126]
Target sample: 85, Prediction:9, Target's Score:[-3.9058073, 0.61044216, -0.35220355, 0.48130822, -1.4075552, -3.5832806, 5.085771, -2.2344432, -1.1128753, 6.7656355]
Target sample: 91, Prediction:1, Target's Score:[1.502274, 11.685558, -4.469898, -1.604671, -4.3838215, -4.1958814, 4.220715, -4.474486, 2.9683323, -0.88808084]
Current ATTACK acc on target samples: 31.250
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 20:29:15 Epoch 59, Val iteration 0, acc 89.800 (89.800)
2021-06-11 20:29:18 Epoch 59, Val iteration 19, acc 90.400 (89.640)
* Prec: 89.6400016784668
Per class accuracy =  [0.92778634 0.9274701  0.85232619 0.83038121 0.88777749 0.8197748
 0.94102761 0.89304164 0.93387851 0.94605036]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 1, 1, 6, 6, 1, 6, 6, 6, 9, 6, 6, 6, 6, 1, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 6, 6, 1, 6, 1, 6, 1, 1, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 1, 1, 1, 1, 4, 4, 4, 6, 4, 1, 1, 1, 1, 1, 6, 6, 1, 6, 6, 6, 9, 9, 6, 1, 9, 1, 1, 1, 1, 1, 1, 6, 1
ATTACK acc: 43.75
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 20:29:22, Val iteration 0, acc 96.200 (96.200)
2021-06-11 20:29:29, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-11 20:29:32, Epoch 0, Iteration 7, loss 0.829 (0.797), acc 75.000 (78.200)
2021-06-11 20:30:04, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-3.6237895, 11.477767, -1.9465282, -2.5120893, -3.7882738, -2.599651, 9.373152, -3.096795, -1.2398261, -2.01252]
Target sample: 7, Prediction:1, Target's Score:[-4.1086597, 12.712446, -2.7484596, -2.5061533, -2.299949, -3.920037, 7.4794836, -3.5213869, -2.2290187, 1.1867784]
Target sample: 13, Prediction:9, Target's Score:[-4.8412886, 7.73029, -3.231076, -2.1204808, -3.9722698, -3.38579, 6.376176, -3.7639425, -0.4721912, 7.735819]
Target sample: 19, Prediction:1, Target's Score:[-4.569979, 8.818821, -2.8526719, 0.37430543, -3.3309698, -3.1559038, 8.809985, -3.3900325, -0.47961998, -0.20199239]
Target sample: 25, Prediction:1, Target's Score:[-4.7031126, 13.340292, -3.0515604, -2.392591, -4.36917, -3.872847, 11.028434, -3.886627, -2.00217, -0.046221606]
Target sample: 31, Prediction:6, Target's Score:[-4.5483313, 9.158289, -2.57039, -2.557405, -2.7673123, -3.1329486, 11.947948, -3.3772247, -1.0973146, -1.0283971]
Target sample: 37, Prediction:1, Target's Score:[-4.6577764, 13.474075, -2.9627557, -1.0446469, -1.0031962, -4.2864947, 6.2621307, -4.217919, -1.4444616, -0.07887625]
Target sample: 43, Prediction:1, Target's Score:[-3.3928463, 10.493916, -2.631158, -2.7044888, -2.0775652, -1.3920351, 8.716024, -3.167916, -2.1144402, -1.7015514]
Target sample: 49, Prediction:1, Target's Score:[-3.9937146, 12.62458, -3.6194031, -3.23888, -2.0781295, -3.406263, 10.577133, -3.91673, -1.0547469, -1.8584614]
Target sample: 55, Prediction:6, Target's Score:[-4.5302353, 11.542225, -2.4323995, -2.4352348, -3.782938, -3.4937708, 11.623454, -3.8081353, -1.3632474, -1.284522]
Target sample: 61, Prediction:6, Target's Score:[-4.812123, 9.020806, -2.575897, -1.8082893, -3.2831643, -3.3105142, 10.415024, -3.464976, -0.5699638, 0.41975594]
Target sample: 67, Prediction:1, Target's Score:[-4.201881, 10.833132, -2.1060255, -2.342787, -3.8765595, -3.3530805, 10.692739, -3.4209259, -1.1869568, -1.0044225]
Target sample: 73, Prediction:1, Target's Score:[-4.458249, 13.433151, -3.0635927, -2.3737085, -3.0036454, -3.7927563, 8.175648, -3.6470876, -1.2490766, 0.022864468]
Target sample: 79, Prediction:1, Target's Score:[-4.8467345, 8.291758, -2.7329443, -0.97788614, -3.4563124, -4.4487853, 6.614073, -3.7584794, -0.6461659, 6.0110183]
Target sample: 85, Prediction:1, Target's Score:[-4.456657, 7.9599595, -1.6580998, -0.7576094, -3.2513263, -3.5668595, 6.978622, -3.6719494, -1.9324327, 4.3975577]
Target sample: 91, Prediction:1, Target's Score:[-3.238908, 14.119737, -2.4194498, -3.6328583, -3.2824929, -3.3041406, 7.6496162, -3.2221608, -1.3746669, -1.2504845]
Current ATTACK acc on target samples: 18.750
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 20:30:35 Epoch 59, Val iteration 0, acc 92.800 (92.800)
2021-06-11 20:30:42 Epoch 59, Val iteration 19, acc 92.200 (92.800)
* Prec: 92.80000228881836
Per class accuracy =  [0.95284337 0.94790183 0.83055587 0.86646857 0.96174024 0.89965344
 0.95706584 0.93950822 0.96397909 0.9584954 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 6, 6, 1, 9, 1, 9, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 1, 6, 1, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 16.25
--------
------SUMMARY PRE DEFENSE------
TIME ELAPSED (mins): 11
TARGET INDEX: 6
ResNet50 43.75 41.25 95.46000137329102 90.43000144958496
DPN92 93.75 87.5 95.50000267028808 92.79000129699708
MobileNetV2 31.25 43.75 91.22000160217286 89.6400016784668
GoogLeNet 18.75 16.25 95.41000213623047 92.80000228881836
DEFENSE EVALUATION
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
ResNet50
[74, 80, 84, 86, 89] 5
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 20:30:47, Val iteration 0, acc 94.200 (94.200)
2021-06-11 20:30:52, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-11 20:30:53, Epoch 0, Iteration 7, loss 0.271 (0.298), acc 92.308 (93.800)
2021-06-11 20:31:24, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[3.0374331, 15.285439, -2.3576086, -2.6381645, -5.4782166, -4.2849207, -1.0324166, -3.1710937, 2.8409646, -1.8126886]
Target sample: 7, Prediction:1, Target's Score:[-0.22562519, 13.456261, -0.83249354, -2.3738523, -4.8268003, -4.4262853, 0.12233136, -3.1882546, -2.0699303, 4.7772217]
Target sample: 13, Prediction:1, Target's Score:[0.30782464, 11.366851, -1.4679652, -1.2292774, -4.7724557, -3.6845562, -1.7426338, -2.9335487, -2.284385, 6.8241334]
Target sample: 19, Prediction:1, Target's Score:[1.2504805, 13.744772, -2.7586138, -1.4494871, -5.1422744, -3.7059712, -1.6495512, -3.2613442, 1.2011603, 2.1528852]
Target sample: 25, Prediction:1, Target's Score:[1.667016, 16.567543, -2.15381, -2.0225503, -5.7154255, -4.309887, -1.9893558, -3.6463306, 1.8621379, 0.15794182]
Target sample: 31, Prediction:1, Target's Score:[1.8149472, 15.245904, -2.3243248, -2.0052238, -5.202133, -3.9474306, -1.8140213, -3.2702582, 0.99041826, 0.90038085]
Target sample: 37, Prediction:1, Target's Score:[2.4124098, 19.146425, -1.9503452, -2.7682736, -6.070968, -5.1169825, -2.3913572, -3.603038, 0.99417526, -0.18298614]
Target sample: 43, Prediction:1, Target's Score:[3.0990114, 11.840657, -1.1121753, -1.782006, -4.2881675, -3.725478, -0.37146434, -2.9698539, 1.4812515, -1.7906799]
Target sample: 49, Prediction:1, Target's Score:[3.2120357, 17.657438, -3.0763128, -2.4625254, -6.095212, -4.913186, -1.5629854, -3.9222784, 3.4286447, -1.8292533]
Target sample: 55, Prediction:1, Target's Score:[2.2242084, 15.269555, -2.5235271, -2.2612991, -5.678717, -4.4318256, 0.20723197, -3.536145, 1.5381386, -0.41274014]
Target sample: 61, Prediction:1, Target's Score:[1.4633727, 16.255215, -2.4673162, -1.4228708, -5.5861883, -4.001807, -1.5042495, -3.6851268, 1.1699356, 0.17913869]
Target sample: 67, Prediction:1, Target's Score:[1.7617984, 12.149813, -1.4053522, -0.90986556, -4.2494836, -3.3123834, -1.0180244, -3.5369492, 1.902679, -1.0351573]
Target sample: 73, Prediction:1, Target's Score:[1.3187417, 15.972223, -2.1629682, -1.5160155, -5.7200127, -3.963597, -1.7368636, -3.5051832, 1.3119602, 0.4052004]
Target sample: 79, Prediction:1, Target's Score:[-0.20009501, 13.418289, -2.0649433, -1.2072706, -5.282408, -3.9874954, -1.814274, -3.0515943, -0.6780465, 5.269663]
Target sample: 85, Prediction:1, Target's Score:[0.18693545, 12.443588, -2.5478518, -1.4666054, -4.554664, -3.7989264, 0.1766558, -3.0270295, 0.57594776, 2.3678384]
Target sample: 91, Prediction:1, Target's Score:[3.0584788, 17.234894, -2.7904103, -2.9742506, -5.8675084, -4.6893563, -1.6392531, -3.652898, 3.0179975, -1.2799785]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 20:31:55 Epoch 59, Val iteration 0, acc 92.400 (92.400)
2021-06-11 20:32:00 Epoch 59, Val iteration 19, acc 93.600 (92.260)
* Prec: 92.26000099182129
Per class accuracy =  [0.9492959  0.96167014 0.89208394 0.82787397 0.93474886 0.89132881
 0.95400683 0.93013029 0.94255512 0.94125628]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
DPN92
[74, 84, 86, 89] 26
Using Adam for retraining
2000
poison index =  80
499
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 20:32:04, Val iteration 0, acc 94.800 (94.800)
2021-06-11 20:32:15, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-11 20:32:18, Epoch 0, Iteration 7, loss 0.392 (0.373), acc 84.615 (90.800)
2021-06-11 20:33:44, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6]
Target sample: 1, Prediction:1, Target's Score:[-2.17895, 14.298416, -2.8161218, -2.0066044, -2.6776505, -2.7579663, -0.41416734, -2.6209369, 3.0654452, -1.1360267]
Target sample: 7, Prediction:1, Target's Score:[-3.0636454, 11.834393, -2.250867, -2.3791955, -2.9149394, -2.567556, 1.5423434, -2.94007, -0.52213186, 4.023215]
Target sample: 13, Prediction:1, Target's Score:[-3.3438408, 10.816097, -1.8360376, -2.0967643, -3.6021795, -2.4496803, 2.5172858, -3.1267111, -1.7704263, 5.6415205]
Target sample: 19, Prediction:1, Target's Score:[-2.4320748, 12.212525, -2.9781976, -1.6701577, -2.6721642, -2.6260207, 0.87963754, -2.329436, 1.6802201, 0.6559411]
Target sample: 25, Prediction:1, Target's Score:[-2.4627995, 15.943135, -3.1928916, -2.2905152, -3.1080048, -3.0061274, -0.1958458, -2.726632, 1.4063518, 0.47831097]
Target sample: 31, Prediction:1, Target's Score:[-1.599957, 12.855154, -2.5777845, -2.3346164, -1.6885118, -3.2917714, 0.29730895, -1.8746723, 1.1594707, -0.21799053]
Target sample: 37, Prediction:1, Target's Score:[-2.329883, 16.08202, -3.293042, -2.1399274, -2.669915, -3.3614328, -0.30728903, -2.6796372, 1.7081441, -0.18103024]
Target sample: 43, Prediction:1, Target's Score:[-2.1822727, 13.381263, -3.5721896, -1.6108954, -1.6599116, -2.522778, 0.89854586, -3.4739604, 0.5997431, 0.89892465]
Target sample: 49, Prediction:1, Target's Score:[-1.9899683, 15.18457, -2.9733686, -2.3008938, -2.1047766, -3.0119333, -0.45930457, -3.163021, 1.8929708, -0.29238304]
Target sample: 55, Prediction:1, Target's Score:[-2.9000432, 14.367982, -3.1179225, -3.1058838, -2.5524108, -2.8841703, 3.2479546, -2.7928762, 0.8965746, -0.33089912]
Target sample: 61, Prediction:1, Target's Score:[-2.6442406, 16.128302, -3.2744296, -2.2358658, -2.7599127, -3.2309344, -0.030985085, -2.7832797, 1.8539014, -0.18541759]
Target sample: 67, Prediction:1, Target's Score:[-2.0884361, 13.360582, -3.3623161, -2.3819835, -1.8148233, -2.767906, 0.8696154, -2.3800015, 2.2811337, -0.97040194]
Target sample: 73, Prediction:1, Target's Score:[-1.5834404, 13.788025, -2.5442464, -1.9141581, -2.8607879, -3.1532025, -0.047747675, -2.4772937, 1.4608928, 0.103324205]
Target sample: 79, Prediction:1, Target's Score:[-2.4948256, 14.022668, -2.9125388, -1.5538347, -3.3355658, -3.3253179, -0.011042808, -2.9385147, 0.34055385, 3.0052361]
Target sample: 85, Prediction:1, Target's Score:[-3.1606681, 12.223289, -3.087167, -1.4572644, -2.5008533, -3.0891004, 1.11386, -3.2075133, 0.15031719, 3.7438326]
Target sample: 91, Prediction:1, Target's Score:[-1.8812628, 15.138146, -2.7512224, -2.690016, -2.6068463, -2.7901614, -0.548267, -2.6374846, 2.200007, -0.66008556]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 20:35:08 Epoch 59, Val iteration 0, acc 93.800 (93.800)
2021-06-11 20:35:20 Epoch 59, Val iteration 19, acc 92.400 (93.210)
* Prec: 93.21000213623047
Per class accuracy =  [0.95078635 0.96457515 0.93100454 0.83553289 0.94926001 0.88015108
 0.93786652 0.94959625 0.96277358 0.95963049]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
MobileNetV2
[80, 84, 86] 46
Using Adam for retraining
2000
poison index =  74
poison index =  89
498
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 20:35:22, Val iteration 0, acc 92.600 (92.600)
2021-06-11 20:35:26, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-11 20:35:26, Epoch 0, Iteration 7, loss 0.294 (0.300), acc 84.615 (90.800)
2021-06-11 20:35:41, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6]
Target sample: 1, Prediction:1, Target's Score:[-0.9990344, 11.863108, -5.855186, 0.3573398, -5.0474415, -2.7381227, 4.5359116, -4.6939573, 2.4117608, 0.71078086]
Target sample: 7, Prediction:1, Target's Score:[-0.42593607, 9.419152, -3.516293, -1.0287466, -2.0124998, -2.3708065, 4.2455387, -4.5177464, -3.5136693, 4.318803]
Target sample: 13, Prediction:9, Target's Score:[-2.6531055, 7.040128, -3.4127429, 1.8698924, -4.1123796, -2.3445067, 4.964659, -5.8543506, -4.073089, 9.205443]
Target sample: 19, Prediction:1, Target's Score:[-3.5463467, 9.1112, -3.2759752, 3.1041343, -3.3198116, -2.8657281, 5.4933996, -4.0943947, -1.0596461, 1.0450625]
Target sample: 25, Prediction:1, Target's Score:[-2.8517184, 8.959587, -4.6211543, 0.85878485, -4.2320642, -2.5574703, 7.233217, -3.0353541, -2.3663847, 3.177962]
Target sample: 31, Prediction:1, Target's Score:[-2.5392203, 9.977166, -5.1816278, 0.51265514, 1.2546277, -1.7617764, 3.0626192, -3.3554494, -3.8957534, 2.5776453]
Target sample: 37, Prediction:1, Target's Score:[-1.9280075, 10.615671, -4.5337167, 0.46239275, -0.9262871, -2.39095, 3.2842488, -4.687642, -3.9702091, 4.7345734]
Target sample: 43, Prediction:6, Target's Score:[-0.6484176, 2.872855, -1.4476742, 3.301951, -3.3320005, -3.4326766, 8.274611, -5.558443, 1.2717566, -0.80932194]
Target sample: 49, Prediction:6, Target's Score:[-2.400926, 4.866282, -4.430357, 3.029424, 1.1412562, -3.3736715, 7.859348, -4.9453945, -0.18117623, -1.0234013]
Target sample: 55, Prediction:6, Target's Score:[-3.45522, 8.021835, -5.0097394, 1.6535473, -2.508399, -2.530532, 13.807268, -6.170815, -2.0677555, -1.1398454]
Target sample: 61, Prediction:1, Target's Score:[-3.4361565, 9.3284645, -5.156186, 1.9466271, 0.3990369, -0.8218487, 2.8122675, -4.407079, -2.9085405, 2.8733892]
Target sample: 67, Prediction:1, Target's Score:[-3.3947258, 6.4325686, -2.8618007, 2.4413762, 4.868332, -1.5488083, 4.3410716, -5.693547, -4.930292, 1.0715468]
Target sample: 73, Prediction:1, Target's Score:[-2.0535226, 9.954407, -4.2143717, 0.3032811, -0.050031804, -2.751487, 5.028587, -4.3971105, -3.1491313, 1.9446738]
Target sample: 79, Prediction:1, Target's Score:[-1.314803, 10.434815, -5.1592197, -1.506748, -6.0222797, -1.2384877, 4.2554336, -5.532227, -0.736142, 7.398923]
Target sample: 85, Prediction:9, Target's Score:[-2.6909912, 0.56350726, 0.24155077, -0.37432665, -2.077633, -3.6990821, 2.384688, -2.448934, -0.047725108, 8.670347]
Target sample: 91, Prediction:1, Target's Score:[2.0950296, 11.81464, -4.6712184, -1.5542517, -4.857145, -3.9540026, 2.1649132, -3.7124288, 2.5935907, 0.5780621]
Current ATTACK acc on target samples: 18.750
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 20:35:57 Epoch 59, Val iteration 0, acc 89.400 (89.400)
2021-06-11 20:36:00 Epoch 59, Val iteration 19, acc 89.800 (89.460)
* Prec: 89.46000175476074
Per class accuracy =  [0.92144507 0.92842071 0.83859045 0.8349891  0.89043075 0.82406195
 0.93792365 0.88807213 0.93079765 0.94776472]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 1, 1, 9, 1, 1, 6, 9, 9, 9, 9, 9, 9, 6, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 6, 1, 6, 1, 1, 1, 1, 6, 6, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 4, 4, 1, 1, 4, 1, 1, 1, 1, 1, 6, 6, 1, 1, 1, 9, 9, 9, 9, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 17.5
GoogLeNet
[74, 80, 84, 86, 89] 22
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 20:36:03, Val iteration 0, acc 96.200 (96.200)
2021-06-11 20:36:10, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-11 20:36:11, Epoch 0, Iteration 7, loss 0.978 (0.946), acc 69.231 (78.600)
2021-06-11 20:36:43, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-3.757231, 15.238904, -1.6992978, -0.31799433, -3.0415137, -3.7297475, -0.19185095, -3.0615082, 0.5672681, 0.0055329558]
Target sample: 7, Prediction:1, Target's Score:[-3.7280052, 15.967858, -1.7427294, -2.2481594, -2.2088072, -5.0871677, -0.5355466, -3.0511205, -2.5405922, 5.202895]
Target sample: 13, Prediction:1, Target's Score:[-4.482875, 13.1772, -2.4201405, -2.6704504, -4.9397054, -4.145569, -0.6362625, -3.774416, -0.7934044, 10.725277]
Target sample: 19, Prediction:1, Target's Score:[-4.0857534, 13.291315, -2.6046388, 1.717836, -4.4023986, -4.3671064, -0.067986, -2.91268, 0.100173555, 3.3361702]
Target sample: 25, Prediction:1, Target's Score:[-4.179972, 19.59301, -2.4066916, -1.64622, -5.251663, -5.0233293, 0.5444161, -3.181275, -1.8202617, 3.3970604]
Target sample: 31, Prediction:1, Target's Score:[-4.4342976, 15.522922, -2.0545528, -2.613993, -3.5875576, -4.261405, 2.3277674, -2.9425538, 0.46270844, 1.595573]
Target sample: 37, Prediction:1, Target's Score:[-4.285001, 18.303267, -2.1092627, -1.0278276, -1.0883353, -5.3274426, -1.595976, -4.0305953, -0.8708138, 2.0471382]
Target sample: 43, Prediction:1, Target's Score:[-1.7859793, 11.488116, -3.069165, -2.5815697, -1.6651807, -0.20481329, 1.9309735, -2.2464342, -1.3452754, -0.5137696]
Target sample: 49, Prediction:1, Target's Score:[-3.6267445, 12.135779, -1.7766759, -2.4688659, -0.65268785, -4.0822606, 1.2858682, -4.025994, 3.4388914, -0.22808304]
Target sample: 55, Prediction:1, Target's Score:[-4.319223, 17.117632, -2.521362, -2.207166, -4.498177, -4.515775, 4.099272, -3.691074, -0.022131478, 0.56584334]
Target sample: 61, Prediction:1, Target's Score:[-4.0347686, 15.179734, -2.6356082, -0.554707, -3.4432352, -5.154761, 0.9006826, -3.3681712, -0.8107235, 3.9356048]
Target sample: 67, Prediction:1, Target's Score:[-3.1932008, 16.860191, -2.3301365, -1.1946526, -3.0984802, -4.7651024, 0.40322858, -3.2987878, -1.04221, 1.6736223]
Target sample: 73, Prediction:1, Target's Score:[-3.9301403, 17.594893, -1.6215016, -0.47620383, -3.2522223, -5.2170696, -0.71758485, -3.2703621, -1.3429939, 2.2534523]
Target sample: 79, Prediction:1, Target's Score:[-3.6328099, 11.739085, -1.6723226, -0.4105309, -3.817032, -5.8263144, -0.30901957, -4.220871, -2.114708, 10.296383]
Target sample: 85, Prediction:1, Target's Score:[-4.2435684, 10.125565, -0.46628115, -0.19456972, -2.9318326, -5.0812445, 0.380678, -3.9898875, -2.0843425, 8.519883]
Target sample: 91, Prediction:1, Target's Score:[-2.2989578, 16.171104, -1.9068977, -2.29196, -1.8591061, -3.874179, -2.1611264, -2.8437986, 0.81320584, 0.2699357]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 20:37:15 Epoch 59, Val iteration 0, acc 92.400 (92.400)
2021-06-11 20:37:22 Epoch 59, Val iteration 19, acc 92.000 (92.360)
* Prec: 92.36000137329101
Per class accuracy =  [0.93383269 0.95237891 0.82286772 0.85027703 0.95308251 0.89851196
 0.9587084  0.94595801 0.95554225 0.96127588]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
------SUMMARY POST DEFENSE------
TIME ELAPSED (mins): 11
TARGET INDEX: 6
ResNet50 0.0 0.0 95.46000137329102 92.26000099182129 100.0
DPN92 0.0 0.0 95.50000267028808 93.21000213623047 80.0
MobileNetV2 18.75 17.5 91.22000160217286 89.46000175476074 60.0
GoogLeNet 0.0 0.0 95.41000213623047 92.36000137329101 100.0
True False False False True
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.300-droplayer0.000.t7
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
No specific indices are determined, so try to include whatever we find
In total, we found 129 images of target 7
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', eval_poisons_root='', feat_reg_flag=False, gpu='1', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=7, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/7/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127]
# Targets: 22, # Poisons: 5
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 20:37:41 Iteration 0 	 Training Loss: 8.857e-01 	 Loss in Target Net: 1.081e+00	  
 2021-06-11 20:38:18 Iteration 50 	 Training Loss: 3.900e-01 	 Loss in Target Net: 3.497e-01	  
 2021-06-11 20:38:54 Iteration 100 	 Training Loss: 3.571e-01 	 Loss in Target Net: 3.275e-01	  
 2021-06-11 20:39:31 Iteration 150 	 Training Loss: 3.530e-01 	 Loss in Target Net: 3.316e-01	  
 2021-06-11 20:40:07 Iteration 200 	 Training Loss: 3.486e-01 	 Loss in Target Net: 3.412e-01	  
 2021-06-11 20:40:43 Iteration 250 	 Training Loss: 3.434e-01 	 Loss in Target Net: 3.417e-01	  
 2021-06-11 20:41:17 Iteration 300 	 Training Loss: 3.410e-01 	 Loss in Target Net: 3.363e-01	  
 2021-06-11 20:41:52 Iteration 350 	 Training Loss: 3.404e-01 	 Loss in Target Net: 3.276e-01	  
 2021-06-11 20:42:28 Iteration 400 	 Training Loss: 3.390e-01 	 Loss in Target Net: 3.104e-01	  
 2021-06-11 20:43:03 Iteration 450 	 Training Loss: 3.377e-01 	 Loss in Target Net: 3.125e-01	  
 2021-06-11 20:43:36 Iteration 500 	 Training Loss: 3.379e-01 	 Loss in Target Net: 3.139e-01	  
 2021-06-11 20:44:12 Iteration 550 	 Training Loss: 3.377e-01 	 Loss in Target Net: 3.149e-01	  
 2021-06-11 20:44:47 Iteration 600 	 Training Loss: 3.385e-01 	 Loss in Target Net: 3.200e-01	  
 2021-06-11 20:45:21 Iteration 650 	 Training Loss: 3.381e-01 	 Loss in Target Net: 3.045e-01	  
 2021-06-11 20:45:54 Iteration 700 	 Training Loss: 3.382e-01 	 Loss in Target Net: 3.241e-01	  
 2021-06-11 20:46:30 Iteration 750 	 Training Loss: 3.373e-01 	 Loss in Target Net: 3.311e-01	  
 2021-06-11 20:47:05 Iteration 800 	 Training Loss: 3.390e-01 	 Loss in Target Net: 3.240e-01	  
 2021-06-11 20:47:41 Iteration 850 	 Training Loss: 3.350e-01 	 Loss in Target Net: 3.183e-01	  
 2021-06-11 20:48:16 Iteration 900 	 Training Loss: 3.363e-01 	 Loss in Target Net: 2.952e-01	  
 2021-06-11 20:48:53 Iteration 950 	 Training Loss: 3.357e-01 	 Loss in Target Net: 3.191e-01	  
 2021-06-11 20:49:28 Iteration 999 	 Training Loss: 3.325e-01 	 Loss in Target Net: 3.024e-01	  
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 20:49:31, Val iteration 0, acc 94.200 (94.200)
2021-06-11 20:49:37, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-11 20:49:39, Epoch 0, Iteration 7, loss 0.348 (0.533), acc 92.308 (89.800)
2021-06-11 20:50:07, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.6465062, 2.4326208, -3.4357347, -2.3190823, -1.0699145, -3.8549793, 6.724839, -2.2267714, 6.2518983, -0.74438125]
Target sample: 7, Prediction:6, Target's Score:[-3.280866, 7.0942645, -1.993316, -2.324715, -2.934255, -3.5234137, 9.711332, -2.0563633, 0.11866395, -0.66162944]
Target sample: 13, Prediction:6, Target's Score:[-3.1782064, 5.8038554, -0.9378213, -1.6965704, -2.2102017, -3.2395387, 9.550653, -2.6499255, -1.1233569, -0.16543342]
Target sample: 19, Prediction:1, Target's Score:[-3.5095196, 11.59458, -1.5567366, -2.531559, -2.9646606, -3.0902288, 6.102404, -1.8979138, -1.6909186, -0.39234778]
Target sample: 25, Prediction:6, Target's Score:[-2.5141425, 7.261181, -3.015313, -2.1347158, -3.1163166, -3.565241, 7.286466, -2.1908617, 3.6132724, -1.5191859]
Target sample: 31, Prediction:6, Target's Score:[-2.3281682, 3.7925417, -3.3368165, -2.2854111, -2.8395784, -4.2397785, 8.506385, -3.087723, 8.404362, -2.453081]
Target sample: 37, Prediction:6, Target's Score:[-2.6637006, 5.951767, -2.7815692, -2.2809348, -2.8804114, -4.0467005, 7.637816, -2.929833, 6.41222, -2.3086638]
Target sample: 43, Prediction:1, Target's Score:[-3.0861282, 10.837633, -2.3976274, -2.5675557, -3.3772316, -3.8669083, 7.606885, -2.699829, 1.5022556, -1.8537767]
Target sample: 49, Prediction:1, Target's Score:[-2.8423376, 11.015655, -1.0591266, -2.8055837, -2.7358088, -3.489354, 7.185133, -2.0752122, -1.2526788, -1.8525856]
Target sample: 55, Prediction:1, Target's Score:[-2.9306667, 10.22855, -1.5217202, -2.4508822, -3.045895, -3.7160082, 8.276507, -2.5902221, -1.5359545, -0.5945575]
Target sample: 61, Prediction:6, Target's Score:[-2.761078, 7.5432425, -1.9946867, -1.6383046, -2.5731525, -3.6072073, 8.480523, -2.6311126, 1.6678602, -2.3596303]
Target sample: 67, Prediction:6, Target's Score:[-3.0208044, 7.0464816, -2.876202, -1.8762007, -2.6606488, -3.6287484, 8.709662, -2.6989417, 3.537104, -2.4033594]
Target sample: 73, Prediction:1, Target's Score:[-3.2362795, 9.479023, -1.3758073, -2.3022065, -3.0087519, -3.2032793, 7.7144446, -2.5356624, -1.4618431, 0.036463283]
Target sample: 79, Prediction:1, Target's Score:[-3.4770043, 12.935847, -1.0290824, -2.7461283, -3.0170534, -3.2328618, 6.004677, -2.2530856, -2.239196, -0.8892845]
Target sample: 85, Prediction:1, Target's Score:[-2.8872871, 12.353229, -1.3758268, -2.4143171, -3.1019783, -3.0890112, 5.5185914, -2.4053776, -0.95153207, -1.5947816]
Target sample: 91, Prediction:1, Target's Score:[-3.53925, 11.038862, -1.8158975, -2.6980636, -3.0675268, -2.5482912, 5.3530045, -2.4019947, -0.24925636, -0.016668042]
Target sample: 97, Prediction:6, Target's Score:[-2.0689552, 4.9437637, -2.7244768, -2.2684634, -2.77906, -3.8734827, 7.938536, -2.4904435, 5.1746354, -1.7283353]
Target sample: 103, Prediction:1, Target's Score:[-2.7498271, 9.22003, -3.2199302, -2.0331776, -3.3351057, -3.293846, 6.2044005, -2.610585, 2.408512, -0.50866926]
Target sample: 109, Prediction:1, Target's Score:[-3.2584672, 12.837292, -1.9564198, -2.8837776, -3.3844166, -3.5988228, 6.799116, -2.1629448, -1.1059457, -1.21013]
Target sample: 115, Prediction:6, Target's Score:[-2.6153378, 6.5667663, -0.73969334, -2.1999335, -2.116825, -3.2208056, 8.014744, -2.1793725, -1.4248471, 0.041029036]
Target sample: 121, Prediction:1, Target's Score:[-2.9970846, 6.170001, -2.359399, -2.0566597, -2.6163447, -3.6153576, 6.1545033, -2.5596762, 0.57866687, 3.3934605]
Target sample: 127, Prediction:6, Target's Score:[-3.456053, 4.2203517, -3.1065812, -2.1533341, -2.415803, -3.2721817, 8.403659, -2.7346168, 5.740307, -1.0990579]
Current ATTACK acc on target samples: 50.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 20:50:35 Epoch 59, Val iteration 0, acc 89.000 (89.000)
2021-06-11 20:50:41 Epoch 59, Val iteration 19, acc 91.600 (90.010)
* Prec: 90.01000061035157
Per class accuracy =  [0.92485887 0.94020557 0.80207027 0.81251658 0.92457606 0.87396518
 0.96063917 0.86304155 0.96983036 0.92941281]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 6, 8, 8, 6, 6, 8, 8, 8, 8, 8, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 8, 8, 6, 6, 6, 8, 6, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 8, 6, 6, 8, 6, 6, 6
ATTACK acc: 33.64485981308411
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 20:50:48, Val iteration 0, acc 94.800 (94.800)
2021-06-11 20:51:00, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-11 20:51:07, Epoch 0, Iteration 7, loss 0.784 (0.546), acc 82.692 (88.600)
2021-06-11 20:52:33, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:8, Target's Score:[-3.4436214, 3.3590286, -3.1077905, -1.0474036, -1.3622004, -3.7977324, 4.872057, -2.8686087, 6.321007, 1.2517258]
Target sample: 7, Prediction:1, Target's Score:[-3.9581606, 5.8722486, -2.2751985, -0.7149058, -0.048316058, -3.491328, 5.112654, -4.210538, 1.2923431, 2.6155431]
Target sample: 13, Prediction:6, Target's Score:[-3.383268, 3.9809344, -0.82898444, -2.0588672, -0.9293656, -2.1894038, 7.35428, -4.158655, 1.7408577, 0.681539]
Target sample: 19, Prediction:1, Target's Score:[-1.148692, 13.719168, -3.630312, -2.138332, -3.235594, -5.310117, 5.6881394, -4.3191466, 0.45353758, 0.29737142]
Target sample: 25, Prediction:1, Target's Score:[-1.4451907, 14.514118, -3.6053596, -1.62884, -3.0962965, -5.3311243, 3.8852677, -4.074107, 1.24117, -0.07524945]
Target sample: 31, Prediction:1, Target's Score:[-1.5116929, 10.964635, -3.2793143, -1.0926522, -2.631034, -5.1297626, 5.28309, -3.714843, 2.58961, -1.1646154]
Target sample: 37, Prediction:1, Target's Score:[-1.0161419, 9.289364, -2.4452636, -2.258204, -1.2151195, -4.835876, 5.681267, -3.972784, 1.5615506, -0.5187161]
Target sample: 43, Prediction:1, Target's Score:[-1.6287737, 13.652631, -3.1050363, -2.3383307, -2.7551742, -4.86703, 4.194908, -4.3289905, 1.4321523, 0.1061503]
Target sample: 49, Prediction:1, Target's Score:[-1.606794, 13.940051, -2.811129, -1.7956429, -2.0213032, -5.777467, 5.1172886, -4.59663, 0.52063525, -0.5850641]
Target sample: 55, Prediction:6, Target's Score:[-1.2746459, 6.863064, -1.4913038, -2.2358909, -0.48028117, -4.2757416, 10.471718, -4.229367, -0.6713965, -2.4171524]
Target sample: 61, Prediction:1, Target's Score:[-2.9735239, 11.462799, -2.632857, -1.2542078, -2.6750135, -4.4446025, 4.0407734, -3.8226225, 2.296657, 0.3258652]
Target sample: 67, Prediction:1, Target's Score:[-3.1350982, 8.71146, -3.145821, -2.0749533, -2.087704, -2.741502, 4.173818, -4.285264, 1.8443822, 3.0161965]
Target sample: 73, Prediction:1, Target's Score:[-2.1839023, 11.218009, -1.7696043, -2.8754706, -2.3328793, -4.112203, 5.6342993, -4.4142776, 1.3624674, -0.20383252]
Target sample: 79, Prediction:1, Target's Score:[-2.238679, 13.834866, -2.7574878, -2.601391, -2.1112578, -5.100606, 5.280654, -4.813343, 0.599373, 0.27876097]
Target sample: 85, Prediction:1, Target's Score:[-1.7749504, 12.307793, -2.9072943, -1.3703161, -2.5823312, -4.5260377, 3.7261875, -4.31977, 1.4384173, 0.34313688]
Target sample: 91, Prediction:1, Target's Score:[-0.35786754, 12.926634, -3.2955606, -2.6108043, -3.6289947, -4.647693, 3.8728044, -3.7255433, 1.113487, 0.69580156]
Target sample: 97, Prediction:1, Target's Score:[-0.3209453, 8.68705, -2.8155146, -1.8181139, -2.3413653, -4.895251, 5.8175154, -3.3983068, 3.1910083, -1.8431079]
Target sample: 103, Prediction:1, Target's Score:[-1.3574926, 13.090374, -3.4730763, -2.0459027, -3.2338228, -5.0961075, 4.5972614, -4.0774293, 1.6975982, 0.24614018]
Target sample: 109, Prediction:1, Target's Score:[-1.4503797, 15.257519, -3.2544236, -2.2671185, -3.6250398, -5.226958, 2.975947, -4.4600554, 1.4836851, 0.95247656]
Target sample: 115, Prediction:6, Target's Score:[-1.7815666, 5.8307047, -1.0289481, -2.2100923, -0.4066998, -4.2119126, 10.307387, -4.091377, -1.3195835, -0.8641956]
Target sample: 121, Prediction:9, Target's Score:[-4.296258, 5.425588, -2.609012, 1.960195, -1.4360685, -4.4763155, 1.3736194, -2.6856613, 0.54149705, 6.4044147]
Target sample: 127, Prediction:8, Target's Score:[-3.9042294, 3.0308316, -2.2750182, -0.50139064, -0.6706327, -2.8845167, 3.3823452, -3.3137562, 4.5642066, 2.7517388]
Current ATTACK acc on target samples: 13.636
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 20:53:57 Epoch 59, Val iteration 0, acc 93.000 (93.000)
2021-06-11 20:54:09 Epoch 59, Val iteration 19, acc 92.600 (93.220)
* Prec: 93.22000122070312
Per class accuracy =  [0.948259   0.97494792 0.89168772 0.87534319 0.96227847 0.86563288
 0.95428402 0.9402473  0.97504027 0.9361397 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 6, 1, 8, 8, 8, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 6, 6, 1, 6, 6, 6, 1, 6, 6, 6, 8, 1, 8
ATTACK acc: 13.08411214953271
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 20:54:12, Val iteration 0, acc 92.600 (92.600)
2021-06-11 20:54:15, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-11 20:54:16, Epoch 0, Iteration 7, loss 0.371 (0.342), acc 92.308 (90.200)
2021-06-11 20:54:31, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:9, Target's Score:[-2.4376707, 2.882162, -2.5756772, 4.7149954, -1.8462688, -2.062254, -0.591701, -3.9011362, 0.62307113, 5.643763]
Target sample: 7, Prediction:1, Target's Score:[-1.7249504, 5.4323583, 0.6598741, 3.680223, -3.895595, -1.8121896, -0.79360795, -3.723327, -1.203596, 3.8551154]
Target sample: 13, Prediction:6, Target's Score:[-1.3581014, 0.5671411, -2.2956638, 5.2166452, -3.6777802, -1.9277741, 6.76187, -5.698066, -0.7144242, 3.5582824]
Target sample: 19, Prediction:1, Target's Score:[-0.9947169, 11.614431, -4.8159375, 3.1650662, -4.623038, -0.92896336, 2.8707101, -5.1645346, -4.183424, 3.5829823]
Target sample: 25, Prediction:1, Target's Score:[-0.6463536, 12.087954, -3.1827307, 0.871441, -3.5164819, -2.577487, 2.3276157, -5.7385674, -0.026244361, 0.9279077]
Target sample: 31, Prediction:1, Target's Score:[2.5431755, 15.60425, -2.927165, 1.9389476, -5.1733747, -3.1335669, -2.2298803, -5.8421607, -1.7864635, 1.5810175]
Target sample: 37, Prediction:1, Target's Score:[-1.1713647, 12.875082, -4.576817, 3.7736278, -2.9662006, -1.300096, -0.25254673, -6.0496755, -0.3716175, 0.6029071]
Target sample: 43, Prediction:1, Target's Score:[-0.6851777, 13.1668005, -5.303397, 1.0039597, -0.7713908, 0.33483112, 0.6130617, -5.5661254, -2.6191595, 0.3826658]
Target sample: 49, Prediction:1, Target's Score:[0.031082839, 13.223483, -3.6879976, 0.29069957, -2.390929, -1.1345788, 1.9354621, -5.1192675, -4.239865, 1.6298909]
Target sample: 55, Prediction:1, Target's Score:[-1.2067964, 12.405758, -4.879171, 3.7194223, -5.125782, -1.9049021, 1.250721, -5.703421, -3.3239932, 5.352266]
Target sample: 61, Prediction:1, Target's Score:[-2.2104144, 6.919517, -2.6731062, 1.7444983, -5.022447, -2.2837787, 4.0975375, -5.608103, 1.9998115, 3.5327723]
Target sample: 67, Prediction:1, Target's Score:[-2.4244359, 8.996656, -3.8531039, 1.609621, -5.0866847, -0.8441941, 3.771441, -6.314976, 1.4028572, 3.258597]
Target sample: 73, Prediction:1, Target's Score:[0.18384527, 11.748888, -3.0774338, 4.7030807, -4.462464, -1.0075994, 0.16643497, -7.355679, -3.8636947, 3.5421343]
Target sample: 79, Prediction:1, Target's Score:[0.36193222, 16.62799, -3.2722788, -1.0654025, -5.046332, -1.9640614, -0.1495492, -5.048388, -1.2370209, 1.3248042]
Target sample: 85, Prediction:1, Target's Score:[0.05886662, 12.790831, -4.026529, 2.2897224, -5.600061, -1.1189313, 2.0576706, -6.238135, 0.7471054, -0.4392401]
Target sample: 91, Prediction:1, Target's Score:[0.5755873, 14.42345, -3.0856805, -0.2699511, -5.7393365, -2.6009362, -0.2570362, -5.3123713, 1.0803592, 1.7085901]
Target sample: 97, Prediction:1, Target's Score:[0.10052477, 14.829924, -4.3491044, -0.44004613, -4.1817164, -2.9996939, 1.0766928, -5.530576, 2.3253398, -0.29886007]
Target sample: 103, Prediction:1, Target's Score:[-0.6408515, 13.932141, -4.647157, 1.2094661, -4.7027965, -2.0063026, -0.9835878, -4.629289, -3.303157, 6.34925]
Target sample: 109, Prediction:1, Target's Score:[-0.10817151, 10.033091, -5.447857, 3.704082, -4.2144084, -2.004453, 2.2968652, -4.746543, -4.2579536, 5.2819257]
Target sample: 115, Prediction:1, Target's Score:[-0.89949274, 8.25957, -2.878688, 3.4291277, -3.5253813, -3.3130057, 0.51966536, -4.6220603, 0.5061222, 3.0243433]
Target sample: 121, Prediction:9, Target's Score:[-3.5885127, -0.46345857, -2.46049, 3.6287603, -1.1620619, -2.375705, 1.5955749, -3.1596322, -0.19346152, 8.630081]
Target sample: 127, Prediction:1, Target's Score:[-0.24165091, 8.578285, -2.8525898, 3.9889293, -5.555355, -0.52478725, -0.74774426, -5.9506874, -2.2892168, 6.141047]
Current ATTACK acc on target samples: 4.545
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 20:54:45 Epoch 59, Val iteration 0, acc 89.000 (89.000)
2021-06-11 20:54:48 Epoch 59, Val iteration 19, acc 90.200 (89.570)
* Prec: 89.57000122070312
Per class accuracy =  [0.92990792 0.92881584 0.83662625 0.82792592 0.89297664 0.82956959
 0.93772455 0.89135289 0.93180916 0.94604568]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 9, 3, 9, 9, 3, 3, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 9, 9, 9, 9, 3, 3, 9, 3, 3
ATTACK acc: 0.9345794392523364
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 20:54:53, Val iteration 0, acc 96.200 (96.200)
2021-06-11 20:54:59, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-11 20:55:02, Epoch 0, Iteration 7, loss 0.704 (0.824), acc 80.769 (79.400)
2021-06-11 20:55:35, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:8, Target's Score:[-2.1880355, 4.358829, -3.3872597, -2.390926, -1.5087417, -4.260147, 4.6466875, -3.3765278, 8.965582, -0.7348133]
Target sample: 7, Prediction:6, Target's Score:[-1.6804885, 4.065659, -2.1781912, -2.6150558, -1.3359973, -3.0432117, 6.5010576, -2.353513, 1.183041, 1.546368]
Target sample: 13, Prediction:6, Target's Score:[-2.2913463, 6.5490775, -2.4803007, -1.142437, -2.163092, -4.043625, 8.867624, -2.7134163, -0.1905932, -0.3132626]
Target sample: 19, Prediction:1, Target's Score:[-0.6275357, 12.758867, -3.1877537, 1.1640905, -3.2596343, -4.6492996, 2.7697842, -3.0080407, -2.3583794, 0.4870492]
Target sample: 25, Prediction:1, Target's Score:[-1.0298343, 14.914585, -3.6296687, -2.1624122, -3.6523426, -4.805696, 0.95753056, -2.546703, 1.0434127, 1.0156829]
Target sample: 31, Prediction:1, Target's Score:[2.2161925, 10.102614, -2.8842003, -1.5803372, -3.241346, -4.907406, 3.5638285, -2.7196631, -1.081082, 0.6253852]
Target sample: 37, Prediction:1, Target's Score:[-0.13030554, 11.00708, -2.752095, -1.4928012, -2.932359, -5.1907234, 0.66270417, -4.0320997, 4.620308, 0.37326607]
Target sample: 43, Prediction:1, Target's Score:[-3.129831, 14.1361265, -3.4675481, 1.0019344, -3.6332963, -4.5773525, 1.7289424, -3.3299575, -1.2983185, 2.6713858]
Target sample: 49, Prediction:1, Target's Score:[-1.6374823, 14.73651, -2.6415653, -1.6198012, -1.5244358, -4.4700913, 0.9013495, -2.8714924, -1.794626, 1.0215049]
Target sample: 55, Prediction:1, Target's Score:[2.1618266, 6.7103043, -3.0054922, -0.9587018, -2.1221313, -4.712261, 4.9313307, -3.0836682, 0.13259499, 0.032612715]
Target sample: 61, Prediction:6, Target's Score:[-2.1752338, 5.0928655, -3.1489139, 0.031193702, -1.7702134, -4.0184116, 5.7376833, -2.0254128, 3.5443912, -1.1798021]
Target sample: 67, Prediction:1, Target's Score:[-2.9759505, 7.854826, -3.436067, -0.32839602, -0.11283623, -3.5313482, 3.6342595, -3.6446025, 3.5856414, -0.94576466]
Target sample: 73, Prediction:1, Target's Score:[-2.244899, 10.289847, -3.2729287, 0.43429634, -2.5193303, -4.7671432, 4.26922, -3.1449947, -1.6329995, 2.6875477]
Target sample: 79, Prediction:1, Target's Score:[-2.1310768, 13.624595, -2.6792512, -1.9644928, -2.513291, -4.1541915, 1.8247316, -3.0386202, -1.6519059, 2.7824736]
Target sample: 85, Prediction:1, Target's Score:[-1.9993205, 15.462459, -3.8248487, -1.9795117, -4.109378, -3.0256288, 2.2553883, -3.2278461, -2.088241, 2.6408865]
Target sample: 91, Prediction:1, Target's Score:[0.0763865, 14.180196, -3.2654877, -1.5360587, -4.4857683, -3.9594984, 1.9484727, -3.407436, -1.6639428, 2.214321]
Target sample: 97, Prediction:1, Target's Score:[2.9108806, 8.595655, -2.8198657, -2.358058, -3.2842708, -4.604621, 4.5423665, -3.1218781, -0.6167088, 0.8553599]
Target sample: 103, Prediction:1, Target's Score:[-0.8936414, 12.907117, -3.8123753, -0.5887509, -3.7222064, -3.9862583, 0.7113684, -3.4678614, -1.2789911, 4.238271]
Target sample: 109, Prediction:1, Target's Score:[-1.8623912, 15.779759, -3.4587078, 0.43004093, -4.2099957, -4.429593, 0.6618958, -3.470681, -1.8017118, 2.4667711]
Target sample: 115, Prediction:6, Target's Score:[-0.6231329, 5.436528, -3.43548, -0.72234696, -2.5768423, -4.937567, 6.590703, -2.5232954, 1.0141556, 1.8756407]
Target sample: 121, Prediction:1, Target's Score:[-2.242351, 8.836957, -3.0129259, -0.73759836, -2.359043, -3.7923722, 3.0567482, -2.353102, -0.6342136, 3.330499]
Target sample: 127, Prediction:1, Target's Score:[-2.4109068, 7.0890107, -3.811162, -0.230809, -0.061919015, -3.0328894, 3.4392061, -3.897468, 3.2754478, -0.26208678]
Current ATTACK acc on target samples: 18.182
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 20:56:07 Epoch 59, Val iteration 0, acc 92.400 (92.400)
2021-06-11 20:56:14 Epoch 59, Val iteration 19, acc 92.800 (92.260)
* Prec: 92.26000175476074
Per class accuracy =  [0.95934965 0.9327946  0.84279087 0.86481468 0.94503809 0.89460571
 0.95485807 0.92993083 0.9441433  0.95417281]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 8, 1, 1, 6, 9, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 8, 8, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 9, 6, 6, 6, 1, 8, 6, 8, 1, 8, 6
ATTACK acc: 10.280373831775702
--------
------SUMMARY PRE DEFENSE------
TIME ELAPSED (mins): 11
TARGET INDEX: 7
ResNet50 50.0 33.64485981308411 95.46000137329102 90.01000061035157
DPN92 13.636363636363637 13.08411214953271 95.50000267028808 93.22000122070312
MobileNetV2 4.545454545454546 0.9345794392523364 91.22000160217286 89.57000122070312
GoogLeNet 18.181818181818183 10.280373831775702 95.41000213623047 92.26000175476074
DEFENSE EVALUATION
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
ResNet50
[74, 80, 84, 86, 89] 5
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 20:56:19, Val iteration 0, acc 94.200 (94.200)
2021-06-11 20:56:24, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-11 20:56:25, Epoch 0, Iteration 7, loss 0.105 (0.238), acc 96.154 (95.400)
2021-06-11 20:56:53, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-1.711337, 7.192184, -3.1589434, -1.9678397, -2.650457, -4.13053, -1.4915756, -2.980876, 6.463458, 4.916701]
Target sample: 7, Prediction:9, Target's Score:[-2.861729, 5.9981637, -2.636617, -1.097761, -2.3893793, -3.7949922, -1.1608944, -2.9013064, 4.428548, 6.910429]
Target sample: 13, Prediction:1, Target's Score:[-2.5502946, 10.911841, -2.5077703, -2.1763313, -3.3734305, -3.604752, 2.4162586, -3.4132016, 2.716495, 2.1487477]
Target sample: 19, Prediction:1, Target's Score:[-2.5963001, 21.609428, -3.0029242, -2.9556723, -5.7748246, -4.789718, -1.5499212, -4.3267365, 0.6392969, 3.5511155]
Target sample: 25, Prediction:1, Target's Score:[-0.71596557, 16.372345, -1.6799772, -2.5145338, -3.95696, -4.3720193, -1.7226504, -3.987086, 2.6660268, 0.5834141]
Target sample: 31, Prediction:1, Target's Score:[-1.6005341, 18.421299, -3.6861212, -3.150786, -5.1680703, -4.8299804, -1.4248811, -4.461052, 4.996523, 1.6231207]
Target sample: 37, Prediction:1, Target's Score:[-1.902434, 20.419624, -2.1436532, -3.2085059, -5.5858483, -4.697508, -2.0956013, -4.788504, 3.7490864, 1.0474352]
Target sample: 43, Prediction:1, Target's Score:[-1.8264878, 24.02767, -3.4946756, -3.8741944, -6.22839, -4.877789, -1.9602242, -4.758307, 0.84483206, 2.9961715]
Target sample: 49, Prediction:1, Target's Score:[-0.15506862, 21.292103, -2.9916685, -3.9100585, -5.57871, -4.746588, -1.8135269, -4.3736663, 1.3426882, 1.6995375]
Target sample: 55, Prediction:1, Target's Score:[-0.93896645, 15.696466, -3.2663713, -2.6179786, -4.1078715, -4.0962105, 0.075125165, -3.8500502, 2.6875107, 1.0190709]
Target sample: 61, Prediction:1, Target's Score:[-1.4114839, 14.431919, -3.1327162, -2.4983642, -4.023219, -4.2135844, -0.80731744, -3.7738993, 5.615054, 0.402536]
Target sample: 67, Prediction:1, Target's Score:[-2.1792579, 14.7934675, -4.149982, -2.7290242, -3.9956386, -3.905754, -1.0353082, -3.9092684, 5.6235247, 2.1018384]
Target sample: 73, Prediction:1, Target's Score:[-1.7178919, 15.501942, -3.0146213, -2.2701766, -4.3560066, -3.6609323, -0.2635997, -3.6888583, 2.1558437, 1.9142358]
Target sample: 79, Prediction:1, Target's Score:[-1.952123, 20.208904, -3.0980186, -3.1167867, -5.275506, -4.3211803, -1.4155903, -4.086375, 0.9625827, 2.8281653]
Target sample: 85, Prediction:1, Target's Score:[-1.5970927, 19.858706, -2.5160625, -3.1619468, -4.710898, -4.681965, -2.070061, -4.2699084, 1.9721805, 1.934068]
Target sample: 91, Prediction:1, Target's Score:[-2.2516973, 21.901289, -3.5773873, -3.9629447, -5.683939, -3.9099243, -2.30492, -4.5336256, 0.68405694, 4.460417]
Target sample: 97, Prediction:1, Target's Score:[-1.403555, 20.516994, -4.078428, -3.533476, -5.430413, -4.445277, -1.633507, -4.404277, 2.4432786, 2.7088315]
Target sample: 103, Prediction:1, Target's Score:[-2.0674312, 18.635134, -2.6134195, -2.9897902, -4.7705393, -4.0571117, -2.0551653, -4.0794253, 0.45834014, 4.2770944]
Target sample: 109, Prediction:1, Target's Score:[-1.7688115, 21.449463, -3.2734466, -3.725684, -5.447441, -4.7485447, -1.4037857, -4.192927, 1.003733, 2.8779647]
Target sample: 115, Prediction:1, Target's Score:[-1.6720276, 12.1911745, -1.363476, -2.3588169, -3.3923895, -3.826056, -0.2732993, -3.0600805, 2.2629106, 2.026679]
Target sample: 121, Prediction:9, Target's Score:[-3.4873044, 6.8713093, -1.6393224, -0.54343325, -2.6428401, -4.3274407, -2.079327, -2.8576453, 2.9561007, 8.297683]
Target sample: 127, Prediction:8, Target's Score:[-3.2612445, 5.1382647, -2.9390237, -0.45287895, -2.329167, -4.5066557, -0.49865258, -3.891749, 8.637352, 4.647226]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 20:57:21 Epoch 59, Val iteration 0, acc 93.600 (93.600)
2021-06-11 20:57:27 Epoch 59, Val iteration 19, acc 92.600 (92.650)
* Prec: 92.65000114440917
Per class accuracy =  [0.95256246 0.96490225 0.87974323 0.85795583 0.91717173 0.89555774
 0.94780285 0.93742266 0.94696454 0.96140516]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 9, 8, 8, 9, 8, 8, 8, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 8, 1, 8, 1, 8, 8, 9, 8, 8
ATTACK acc: 0.0
DPN92
[74, 80, 84, 86, 89] 27
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 20:57:31, Val iteration 0, acc 94.800 (94.800)
2021-06-11 20:57:43, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-11 20:57:45, Epoch 0, Iteration 7, loss 0.669 (0.356), acc 86.538 (92.200)
2021-06-11 20:59:11, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:8, Target's Score:[0.10409835, 3.7028875, -3.0752068, -2.5995016, -2.9861066, -3.9518166, -0.1589459, -1.8455306, 11.966021, -0.6745567]
Target sample: 7, Prediction:1, Target's Score:[-1.6485245, 10.098351, -1.9617044, -3.2401967, -3.0681381, -2.6730225, -0.75099725, -1.9874616, 2.219897, 3.4404953]
Target sample: 13, Prediction:1, Target's Score:[-1.0798088, 10.616424, -0.6425922, -3.7553399, -2.8124037, -1.9245929, 0.40859324, -3.1647959, 0.64828724, 2.1478221]
Target sample: 19, Prediction:1, Target's Score:[-0.017680934, 18.277367, -3.3116274, -3.9949636, -4.326515, -2.4420223, -1.9958018, -3.4130042, 0.25198644, 1.5587366]
Target sample: 25, Prediction:1, Target's Score:[0.5261766, 19.128529, -3.385719, -4.0874314, -3.9561925, -3.1389046, -2.2339528, -3.628082, 0.678854, 0.69216]
Target sample: 31, Prediction:1, Target's Score:[-0.0070999134, 18.780605, -3.5060792, -4.1445727, -3.7461553, -3.2334545, -2.168793, -3.4785872, 1.0085237, 1.0888036]
Target sample: 37, Prediction:1, Target's Score:[-0.037308045, 17.348452, -3.0235813, -4.2511325, -3.520116, -3.0411913, -2.0752301, -3.628094, 1.6461228, 1.1512331]
Target sample: 43, Prediction:1, Target's Score:[-0.0771911, 19.958565, -3.4802816, -4.5997543, -4.386182, -2.7913375, -2.2839506, -3.7443414, 0.7097227, 1.3212569]
Target sample: 49, Prediction:1, Target's Score:[0.28764215, 18.529057, -2.8961623, -4.559967, -4.0670104, -3.0237308, -1.4964721, -3.2827308, 0.5357487, 0.56893283]
Target sample: 55, Prediction:1, Target's Score:[0.21550451, 14.837737, -2.9009414, -3.7505229, -3.3725414, -2.9472566, -0.1879109, -3.1919477, 0.34608716, 1.4570438]
Target sample: 61, Prediction:1, Target's Score:[-0.8727608, 14.386558, -3.1689746, -3.6600857, -3.3389933, -2.488468, -1.1114904, -2.6726048, 3.2091618, 0.23123102]
Target sample: 67, Prediction:1, Target's Score:[-0.9539633, 13.73561, -3.0431504, -3.571614, -3.4166303, -2.436556, -1.265817, -3.3410127, 3.041116, 1.7460936]
Target sample: 73, Prediction:1, Target's Score:[-0.29961535, 16.133507, -2.0557966, -4.4251127, -3.7629757, -2.1116517, -1.3892908, -3.3357832, 1.3011796, 0.48221365]
Target sample: 79, Prediction:1, Target's Score:[-0.58875763, 19.405924, -3.3494318, -4.6599565, -3.9776552, -2.8485038, -1.6560534, -3.536337, 0.46815413, 1.3425424]
Target sample: 85, Prediction:1, Target's Score:[0.082727045, 18.317783, -3.2318459, -4.2069697, -3.930508, -2.4265056, -2.2197115, -3.681811, 0.5407065, 1.3351846]
Target sample: 91, Prediction:1, Target's Score:[0.25567394, 19.114275, -3.6176898, -4.4072485, -4.2957373, -2.5229573, -2.4566917, -3.667501, 0.17630945, 2.027985]
Target sample: 97, Prediction:1, Target's Score:[0.18346463, 18.389812, -3.7510622, -3.9139714, -4.009214, -3.1804197, -1.9827224, -3.4062545, 1.6159462, 0.6385553]
Target sample: 103, Prediction:1, Target's Score:[0.3765314, 19.286585, -3.635407, -4.362796, -4.29202, -2.7302642, -2.3851547, -3.7467315, 0.5203385, 1.5791554]
Target sample: 109, Prediction:1, Target's Score:[0.11418676, 19.086876, -3.2732131, -4.4868245, -4.58962, -2.7070131, -2.3608627, -3.592747, 0.45627433, 1.96037]
Target sample: 115, Prediction:1, Target's Score:[-0.64424986, 12.368895, -2.785109, -3.9332259, -3.190279, -3.0647426, -0.6176961, -3.3085053, 0.42692947, 5.21815]
Target sample: 121, Prediction:1, Target's Score:[-1.5858098, 4.628722, -2.6589386, -0.97285, -2.587, -3.4361558, -0.96984315, -0.3937938, 3.8823988, 4.498908]
Target sample: 127, Prediction:8, Target's Score:[-0.8190459, 7.1503015, -2.743423, -3.1859639, -3.2194126, -3.323285, -0.67393076, -2.3727963, 8.249048, 1.4233258]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 21:00:35 Epoch 59, Val iteration 0, acc 93.000 (93.000)
2021-06-11 21:00:46 Epoch 59, Val iteration 19, acc 92.000 (93.420)
* Prec: 93.42000198364258
Per class accuracy =  [0.93729606 0.95863743 0.92956606 0.80970063 0.95905425 0.894811
 0.96121254 0.97049366 0.96990101 0.95140392]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 8, 8, 8, 8, 1, 8
ATTACK acc: 0.0
MobileNetV2
[74, 80, 89] 46
Using Adam for retraining
2000
poison index =  84
poison index =  86
498
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 21:00:49, Val iteration 0, acc 92.600 (92.600)
2021-06-11 21:00:52, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-11 21:00:53, Epoch 0, Iteration 7, loss 0.204 (0.291), acc 92.308 (90.200)
2021-06-11 21:01:07, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6]
Target sample: 1, Prediction:9, Target's Score:[-1.8535352, 5.2429323, -3.6493378, 4.0907154, -2.7887688, -2.96495, -1.5597143, -4.2856193, 2.1492252, 6.1446176]
Target sample: 7, Prediction:1, Target's Score:[-0.92987615, 6.5716, 0.14976631, 3.9965897, -4.1471567, -2.2376282, -1.6993725, -4.26338, -1.1880327, 4.2983656]
Target sample: 13, Prediction:6, Target's Score:[-1.0520408, 1.3287797, -2.6293666, 5.3352604, -4.0483003, -2.3771727, 6.3843794, -6.231513, 0.3252457, 3.4577332]
Target sample: 19, Prediction:1, Target's Score:[-0.34915552, 15.395994, -6.0488634, 2.3680828, -5.613403, -1.6176078, 0.56568307, -5.3176713, -3.0943277, 4.332729]
Target sample: 25, Prediction:1, Target's Score:[0.05052246, 15.63178, -4.5001216, -0.24241142, -4.40129, -3.383194, 0.09501433, -6.2078996, 1.6848974, 1.877133]
Target sample: 31, Prediction:1, Target's Score:[3.1863744, 19.328701, -4.6293163, 1.179105, -6.4650435, -3.46529, -4.2698607, -6.116644, -0.72368836, 2.6190577]
Target sample: 37, Prediction:1, Target's Score:[-0.115882725, 16.861393, -5.722049, 2.4072967, -4.2956557, -1.8020407, -3.1037061, -6.466636, 1.330172, 1.5491498]
Target sample: 43, Prediction:1, Target's Score:[0.11689094, 17.601088, -6.4001775, 0.040292308, -1.9358674, -0.09711186, -2.7580917, -5.8651743, -1.3632655, 1.3533072]
Target sample: 49, Prediction:1, Target's Score:[0.12702994, 16.52738, -4.2156754, -0.71049416, -3.217771, -1.4652332, -0.48759976, -4.888609, -3.4618223, 2.4638765]
Target sample: 55, Prediction:1, Target's Score:[-0.6893948, 15.563157, -5.8976164, 2.8275268, -5.6617856, -2.5435593, -0.7150216, -6.1946793, -2.6762471, 6.6829286]
Target sample: 61, Prediction:1, Target's Score:[-1.3642411, 10.480783, -3.9753954, 1.0876924, -6.0073495, -3.0535104, 1.6777405, -5.9784513, 3.2666485, 4.4249005]
Target sample: 67, Prediction:1, Target's Score:[-2.0236037, 11.424643, -5.082368, 1.1748081, -5.8842587, -1.6478038, 1.5639508, -6.6447444, 3.5005386, 4.18771]
Target sample: 73, Prediction:1, Target's Score:[0.72782815, 13.6441765, -3.970022, 4.334863, -5.1242933, -1.3117493, -1.2861568, -7.6923857, -3.1719117, 4.4965086]
Target sample: 79, Prediction:1, Target's Score:[0.645725, 20.013062, -4.372519, -1.7686163, -5.874116, -2.3378396, -2.5900614, -5.106607, -0.4554116, 2.4514992]
Target sample: 85, Prediction:1, Target's Score:[0.9920866, 15.522123, -4.824451, 1.7660346, -6.4068766, -1.7307016, -0.52761877, -6.7398534, 2.241483, 0.2615076]
Target sample: 91, Prediction:1, Target's Score:[1.3466978, 17.842905, -4.1248336, -0.6256873, -6.617625, -3.3375776, -3.0411747, -5.80779, 2.4347396, 2.5116863]
Target sample: 97, Prediction:1, Target's Score:[0.6480863, 19.297106, -5.8178086, -0.93753725, -5.6835504, -3.679924, -2.1824877, -6.023172, 4.0529656, 0.9386684]
Target sample: 103, Prediction:1, Target's Score:[-0.06374151, 17.119942, -5.4512043, -0.04181166, -5.5973287, -2.2432268, -3.148774, -4.891189, -2.4238985, 7.431313]
Target sample: 109, Prediction:1, Target's Score:[0.5943462, 13.260026, -6.2972527, 2.8396754, -4.7424474, -2.6168828, 0.6314765, -5.0294642, -3.7386646, 5.7567897]
Target sample: 115, Prediction:1, Target's Score:[-0.69572765, 10.226338, -3.7435195, 2.9746718, -3.7330015, -3.7829273, -0.7803703, -5.045578, 1.3316077, 3.8307645]
Target sample: 121, Prediction:9, Target's Score:[-2.9570425, 0.39380682, -3.0793886, 3.1315913, -1.9012041, -3.1448047, 0.9401405, -3.0704882, -0.21810511, 10.482332]
Target sample: 127, Prediction:1, Target's Score:[0.6817165, 9.958378, -3.4564207, 3.7402816, -5.8859863, -1.283342, -1.9763395, -6.2181034, -2.0051851, 7.057435]
Current ATTACK acc on target samples: 4.545
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 21:01:22 Epoch 59, Val iteration 0, acc 89.200 (89.200)
2021-06-11 21:01:25 Epoch 59, Val iteration 19, acc 90.400 (89.470)
* Prec: 89.47000160217286
Per class accuracy =  [0.9260983  0.93277902 0.846701   0.82271899 0.88842685 0.81810606
 0.93685295 0.89281454 0.92959373 0.94788866]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 9, 3, 9, 9, 3, 3, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 9, 9, 9, 3, 9, 3, 3
ATTACK acc: 0.0
GoogLeNet
[74, 80, 86, 89] 21
Using Adam for retraining
2000
poison index =  84
499
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 21:01:27, Val iteration 0, acc 96.200 (96.200)
2021-06-11 21:01:34, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-11 21:01:35, Epoch 0, Iteration 7, loss 0.639 (0.721), acc 82.692 (80.000)
2021-06-11 21:02:07, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6]
Target sample: 1, Prediction:8, Target's Score:[-0.43831062, 6.120479, -3.843517, -2.69395, -1.8546954, -4.2997026, 0.93087935, -3.7200594, 9.682389, 0.25354692]
Target sample: 7, Prediction:1, Target's Score:[-2.1957016, 7.050476, -2.9658642, -1.7600275, -1.9138123, -3.6835477, 2.0699496, -2.5064912, 3.5222538, 2.4976392]
Target sample: 13, Prediction:1, Target's Score:[-1.8172234, 10.051763, -3.4436955, -1.5148243, -3.0339215, -4.185111, 6.017349, -2.3198583, 0.9334652, -0.57939005]
Target sample: 19, Prediction:1, Target's Score:[-1.8587191, 16.656382, -3.6977339, 1.169951, -4.358583, -5.199168, 0.24053809, -2.7130687, -0.8172225, 0.7244395]
Target sample: 25, Prediction:1, Target's Score:[-1.4501367, 20.703295, -5.040758, -3.0622783, -4.21166, -5.0986276, -1.1601334, -3.3506196, 2.1877272, 0.6514224]
Target sample: 31, Prediction:1, Target's Score:[-0.013902363, 15.498184, -3.3207507, -1.5244437, -3.3754377, -5.0382323, 0.08388051, -3.3126361, 0.51379156, 0.6278982]
Target sample: 37, Prediction:1, Target's Score:[-1.237931, 15.281763, -3.4786658, -1.8238345, -3.5829847, -5.263129, -0.70211226, -4.1942945, 5.1432247, 0.023980482]
Target sample: 43, Prediction:1, Target's Score:[-2.9477186, 19.99317, -3.7512097, -0.89871943, -4.2401867, -5.365804, -0.5549224, -3.624116, -0.33528554, 1.8880987]
Target sample: 49, Prediction:1, Target's Score:[-2.073513, 17.380247, -3.5952654, -1.4564501, -2.8156383, -4.4273057, -0.21658382, -2.2786481, -0.811362, 0.4341937]
Target sample: 55, Prediction:1, Target's Score:[1.2152066, 10.178424, -4.716372, -0.7534117, -3.058817, -4.9341035, 1.8894387, -2.1884677, 1.5289284, 0.9557966]
Target sample: 61, Prediction:1, Target's Score:[-1.4474839, 7.3658586, -3.7001197, -0.18677719, -2.456873, -4.307917, 2.3164287, -2.0703192, 5.883022, -1.2694544]
Target sample: 67, Prediction:1, Target's Score:[-3.0937417, 8.085767, -2.6761866, 0.050734922, -1.0795242, -4.183307, 1.3957745, -3.5643382, 6.08134, -0.88203114]
Target sample: 73, Prediction:1, Target's Score:[-1.82397, 13.675927, -3.6281412, 0.093171045, -3.0446782, -4.4179235, 0.9139707, -2.6021352, -0.9606408, 1.92082]
Target sample: 79, Prediction:1, Target's Score:[-2.3680327, 17.329954, -4.01089, -2.2422717, -2.8564546, -4.2841787, -0.30039543, -2.9410667, -0.17856835, 1.989973]
Target sample: 85, Prediction:1, Target's Score:[-2.4781566, 19.881636, -3.3877518, -1.983704, -4.1197, -4.2443047, -1.2695456, -3.636874, -0.57405984, 1.9692113]
Target sample: 91, Prediction:1, Target's Score:[-0.0063673826, 16.760382, -3.6039498, -1.4907991, -4.5069156, -4.001262, -1.6517063, -3.501326, 0.0040778033, 2.1464365]
Target sample: 97, Prediction:1, Target's Score:[1.6456467, 15.825265, -4.2404947, -2.30822, -4.228579, -4.9442086, -0.45833215, -3.386259, 0.6213727, 1.6173388]
Target sample: 103, Prediction:1, Target's Score:[-1.3483628, 16.869833, -4.0405464, -2.4263468, -3.9921963, -4.6044073, -0.68860376, -3.3027682, 1.0646785, 2.6175768]
Target sample: 109, Prediction:1, Target's Score:[-3.354731, 18.053766, -3.207215, 0.58524656, -4.9426937, -5.381244, -1.1441455, -2.9228153, -0.3658651, 2.8376648]
Target sample: 115, Prediction:1, Target's Score:[-2.1526155, 8.757937, -3.8566504, -0.98950523, -3.5169146, -4.3776526, 3.2526605, -1.9200152, 2.5146942, 2.405323]
Target sample: 121, Prediction:1, Target's Score:[-2.793798, 8.5649185, -3.808823, 0.50124264, -2.46887, -4.510105, -0.30206037, -2.380157, 3.026975, 4.302988]
Target sample: 127, Prediction:1, Target's Score:[-2.0764387, 8.14006, -4.058652, -0.96494186, -1.3667246, -3.4358132, 0.13433704, -3.4506137, 5.6453524, 1.560469]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 21:02:39 Epoch 59, Val iteration 0, acc 92.800 (92.800)
2021-06-11 21:02:46 Epoch 59, Val iteration 19, acc 93.800 (93.110)
* Prec: 93.11000175476075
Per class accuracy =  [0.94961631 0.9597191  0.89660031 0.85954452 0.9419802  0.89379877
 0.96251308 0.92794513 0.96109972 0.95666688]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 8, 8, 1, 8, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 8, 8, 8, 1, 8, 8, 8, 8, 8, 6
ATTACK acc: 0.9345794392523364
------SUMMARY POST DEFENSE------
TIME ELAPSED (mins): 11
TARGET INDEX: 7
ResNet50 0.0 0.0 95.46000137329102 92.65000114440917 100.0
DPN92 0.0 0.0 95.50000267028808 93.42000198364258 100.0
MobileNetV2 4.545454545454546 0.0 91.22000160217286 89.47000160217286 60.0
GoogLeNet 0.0 0.9345794392523364 95.41000213623047 93.11000175476075 80.0
True False False False True
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.300-droplayer0.000.t7
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
No specific indices are determined, so try to include whatever we find
In total, we found 170 images of target 8
All target indices used in crafting poisons: [1, 6, 11, 16, 21, 26, 31, 36, 41, 46, 51, 56, 61, 66, 71, 76, 81, 86, 91, 96, 101, 106, 111, 116, 121, 126, 131, 136, 141, 146, 151, 156, 161, 166]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', eval_poisons_root='', feat_reg_flag=False, gpu='1', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=8, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/8/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 6, 11, 16, 21, 26, 31, 36, 41, 46, 51, 56, 61, 66, 71, 76, 81, 86, 91, 96, 101, 106, 111, 116, 121, 126, 131, 136, 141, 146, 151, 156, 161, 166]
# Targets: 34, # Poisons: 5
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 21:03:07 Iteration 0 	 Training Loss: 8.794e-01 	 Loss in Target Net: 1.066e+00	  
 2021-06-11 21:03:55 Iteration 50 	 Training Loss: 3.713e-01 	 Loss in Target Net: 2.534e-01	  
 2021-06-11 21:04:41 Iteration 100 	 Training Loss: 3.393e-01 	 Loss in Target Net: 2.538e-01	  
 2021-06-11 21:05:26 Iteration 150 	 Training Loss: 3.353e-01 	 Loss in Target Net: 2.500e-01	  
 2021-06-11 21:06:18 Iteration 200 	 Training Loss: 3.284e-01 	 Loss in Target Net: 2.458e-01	  
 2021-06-11 21:07:08 Iteration 250 	 Training Loss: 3.245e-01 	 Loss in Target Net: 2.474e-01	  
 2021-06-11 21:07:54 Iteration 300 	 Training Loss: 3.211e-01 	 Loss in Target Net: 2.350e-01	  
 2021-06-11 21:08:47 Iteration 350 	 Training Loss: 3.195e-01 	 Loss in Target Net: 2.319e-01	  
 2021-06-11 21:09:47 Iteration 400 	 Training Loss: 3.194e-01 	 Loss in Target Net: 2.317e-01	  
 2021-06-11 21:10:45 Iteration 450 	 Training Loss: 3.232e-01 	 Loss in Target Net: 2.271e-01	  
 2021-06-11 21:11:39 Iteration 500 	 Training Loss: 3.168e-01 	 Loss in Target Net: 2.240e-01	  
 2021-06-11 21:12:35 Iteration 550 	 Training Loss: 3.190e-01 	 Loss in Target Net: 2.294e-01	  
 2021-06-11 21:13:33 Iteration 600 	 Training Loss: 3.202e-01 	 Loss in Target Net: 2.217e-01	  
 2021-06-11 21:14:30 Iteration 650 	 Training Loss: 3.215e-01 	 Loss in Target Net: 2.236e-01	  
 2021-06-11 21:15:36 Iteration 700 	 Training Loss: 3.171e-01 	 Loss in Target Net: 2.205e-01	  
 2021-06-11 21:16:43 Iteration 750 	 Training Loss: 3.194e-01 	 Loss in Target Net: 2.213e-01	  
 2021-06-11 21:17:46 Iteration 800 	 Training Loss: 3.181e-01 	 Loss in Target Net: 2.263e-01	  
 2021-06-11 21:18:48 Iteration 850 	 Training Loss: 3.204e-01 	 Loss in Target Net: 2.214e-01	  
 2021-06-11 21:19:43 Iteration 900 	 Training Loss: 3.167e-01 	 Loss in Target Net: 2.216e-01	  
 2021-06-11 21:20:35 Iteration 950 	 Training Loss: 3.200e-01 	 Loss in Target Net: 2.244e-01	  
 2021-06-11 21:21:42 Iteration 999 	 Training Loss: 3.184e-01 	 Loss in Target Net: 2.134e-01	  
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 21:21:45, Val iteration 0, acc 94.200 (94.200)
2021-06-11 21:21:51, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-11 21:21:54, Epoch 0, Iteration 7, loss 0.462 (0.532), acc 88.462 (87.600)
2021-06-11 21:22:22, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-3.0546823, 7.572647, -1.9970139, -1.2107377, -2.7808952, -2.6011891, 8.885413, -2.638722, 0.992597, -3.2119815]
Target sample: 6, Prediction:6, Target's Score:[-3.7480106, 2.8586073, -1.1176881, -0.97431666, -2.223819, -2.6134267, 10.246945, -3.0018015, 0.885396, -0.31875744]
Target sample: 11, Prediction:6, Target's Score:[-3.9812534, 4.011601, -0.94805086, -1.3480529, -2.1881502, -2.7591379, 10.554191, -3.0594683, 0.60957664, -0.9034222]
Target sample: 16, Prediction:6, Target's Score:[-2.5155873, 0.5066474, -0.0063496633, -0.9356431, -1.8739586, -2.4254894, 10.024158, -2.6348376, 2.0872061, -2.2175465]
Target sample: 21, Prediction:1, Target's Score:[-3.622824, 10.212653, -1.7272754, -1.841973, -2.7059975, -3.110933, 9.32637, -3.0761094, 1.1688124, -4.698193]
Target sample: 26, Prediction:1, Target's Score:[-3.2490516, 9.295796, -1.918297, -1.6949275, -2.4469776, -2.798843, 8.419765, -2.8978362, -0.11000274, -2.6654634]
Target sample: 31, Prediction:1, Target's Score:[-3.572026, 12.130695, -2.1751277, -2.2230873, -2.937811, -3.3445106, 8.564146, -2.919282, 0.4764393, -4.0966396]
Target sample: 36, Prediction:1, Target's Score:[-3.7069383, 9.43913, -1.9396263, -1.8119379, -2.6751077, -3.0555675, 9.034771, -3.0471911, -0.2133442, -2.090068]
Target sample: 41, Prediction:6, Target's Score:[-3.3484142, 6.395003, -1.7236484, -1.3887861, -2.579888, -2.605642, 8.735796, -3.0105436, 0.31332758, -0.8286757]
Target sample: 46, Prediction:6, Target's Score:[-2.3377492, 1.8370386, -1.162011, -1.5449103, -1.9226123, -2.4882863, 8.870854, -2.9140034, 3.6605055, -2.0140316]
Target sample: 51, Prediction:6, Target's Score:[-2.72082, 4.71433, -1.6252359, -1.5558611, -2.6609206, -2.4622443, 8.48231, -3.297159, 4.3320403, -3.2477546]
Target sample: 56, Prediction:6, Target's Score:[-2.7990847, 5.832947, -1.9069412, -1.7313992, -3.0588255, -2.5870166, 8.293226, -3.4640942, 4.761806, -3.392809]
Target sample: 61, Prediction:1, Target's Score:[-3.1056159, 8.626336, -2.2742398, -1.7261152, -3.2710304, -2.738965, 8.136026, -2.8244722, 3.3195696, -4.211047]
Target sample: 66, Prediction:1, Target's Score:[-3.1798193, 11.282412, -2.5944695, -1.9364833, -3.024474, -3.1125393, 8.144194, -2.7920082, 0.9177746, -3.7927685]
Target sample: 71, Prediction:1, Target's Score:[-3.0168667, 11.738691, -2.5033362, -2.0621762, -2.9718082, -3.2138097, 8.058945, -2.6751618, 1.4212765, -4.8736553]
Target sample: 76, Prediction:1, Target's Score:[-3.6671991, 12.987856, -2.4613457, -2.2330797, -3.1107209, -3.4352448, 8.521446, -3.066459, 0.8970604, -4.5406218]
Target sample: 81, Prediction:6, Target's Score:[-3.4919167, 8.137437, -1.4354575, -1.5382283, -2.2104218, -2.9549725, 9.871985, -3.1424098, 0.048058942, -3.3340652]
Target sample: 86, Prediction:6, Target's Score:[-3.2760384, 5.4877443, -1.1005803, -1.163794, -1.9186177, -2.6681168, 9.830962, -2.8081715, 0.27794912, -2.6874921]
Target sample: 91, Prediction:6, Target's Score:[-3.1544187, 8.371044, -2.0247865, -1.5665464, -2.982344, -2.840431, 8.724201, -2.815183, 2.1955743, -3.9663262]
Target sample: 96, Prediction:1, Target's Score:[-3.563336, 10.8410425, -2.3521588, -1.8610036, -2.9412415, -3.1773195, 8.472452, -2.7493072, 0.8000015, -3.5499284]
Target sample: 101, Prediction:1, Target's Score:[-2.9814467, 9.581907, -1.9098711, -1.8619632, -2.3431263, -3.07625, 8.755142, -2.9227474, 1.1496866, -4.466808]
Target sample: 106, Prediction:6, Target's Score:[-3.7403505, 8.743875, -2.024963, -1.746514, -2.827084, -3.0132601, 9.725424, -3.1949866, 1.0363129, -3.015762]
Target sample: 111, Prediction:1, Target's Score:[-3.1116168, 13.7501135, -3.014522, -2.4000473, -3.3584113, -3.4774485, 7.8090844, -2.861482, 1.8128319, -5.269844]
Target sample: 116, Prediction:1, Target's Score:[-3.5618525, 15.020265, -3.108759, -2.6096992, -3.7098746, -3.6851234, 7.8121524, -2.9558268, 2.0319076, -5.3678718]
Target sample: 121, Prediction:1, Target's Score:[-3.1722443, 14.562549, -3.3626332, -2.3966038, -3.800794, -3.3356123, 6.639749, -2.9827642, 0.9702828, -3.250025]
Target sample: 126, Prediction:6, Target's Score:[-3.2392082, 7.632649, -2.1223981, -1.5873661, -2.82799, -2.7322433, 8.559047, -3.3219604, 1.8519472, -2.2693896]
Target sample: 131, Prediction:6, Target's Score:[-2.0192907, 1.9556988, -1.2227082, -1.3203931, -1.420564, -2.3238435, 8.7823715, -3.0753264, 3.6454504, -3.017913]
Target sample: 136, Prediction:6, Target's Score:[-2.949429, 3.0727966, -2.0335112, -1.8698826, -3.3795404, -2.4981737, 7.432378, -3.5606465, 6.8001547, -1.0644041]
Target sample: 141, Prediction:6, Target's Score:[-3.1961765, 3.0471427, -1.6557956, -1.2108725, -2.529948, -2.472307, 8.468209, -2.8041039, 0.9555775, 1.3760008]
Target sample: 146, Prediction:1, Target's Score:[-3.844283, 9.408144, -2.1799605, -1.7685883, -2.9475565, -2.8884337, 8.740835, -3.059708, -0.4716015, -1.0534478]
Target sample: 151, Prediction:1, Target's Score:[-3.769463, 11.081341, -2.3602557, -1.8455925, -3.0247984, -2.9641948, 8.2622385, -3.0260832, 0.061992213, -2.5003064]
Target sample: 156, Prediction:6, Target's Score:[-4.0081716, 6.501428, -1.1163187, -1.2858356, -2.2366252, -2.694735, 9.660455, -3.221071, -1.2745373, -0.36186984]
Target sample: 161, Prediction:6, Target's Score:[-3.5967638, -0.32420698, 0.114779346, -1.0835243, -1.2144643, -2.7145457, 10.944334, -3.1822283, -0.9593726, 2.0222416]
Target sample: 166, Prediction:6, Target's Score:[-3.685395, 6.264092, -1.674709, -1.432055, -2.6186378, -2.8302917, 9.990065, -2.8763673, 0.0365472, -1.2004247]
Current ATTACK acc on target samples: 55.882
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 21:22:49 Epoch 59, Val iteration 0, acc 86.400 (86.400)
2021-06-11 21:22:55 Epoch 59, Val iteration 19, acc 87.600 (88.020)
* Prec: 88.02000160217285
Per class accuracy =  [0.84850289 0.92914657 0.74208033 0.77203244 0.96439593 0.83167014
 0.96774158 0.88080036 0.93060046 0.93616931]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 6, 1, 1, 6, 1, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 1, 6, 6, 1, 6, 6, 1, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6
ATTACK acc: 58.088235294117645
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 21:23:02, Val iteration 0, acc 94.800 (94.800)
2021-06-11 21:23:14, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-11 21:23:21, Epoch 0, Iteration 7, loss 0.088 (0.481), acc 98.077 (89.200)
2021-06-11 21:24:47, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.848973, 3.9275818, -2.071525, 0.66820496, -0.35788202, -3.6686733, 4.931576, -1.7567269, -0.09771056, 1.6833844]
Target sample: 6, Prediction:1, Target's Score:[-3.294032, 4.6324987, -3.1052835, -0.5956891, 0.05744705, -3.7293723, 4.149348, -1.2402065, 2.4216797, 1.1121092]
Target sample: 11, Prediction:6, Target's Score:[-2.3806076, 5.443668, -3.5427363, -1.097335, -0.9561571, -3.6358678, 5.931536, -1.4589902, -0.09392029, 2.2275767]
Target sample: 16, Prediction:6, Target's Score:[-1.9633149, 1.8923354, -1.9745862, -1.0045007, -0.5642696, -3.8982718, 9.981372, -2.3413792, -0.87028724, 1.1703082]
Target sample: 21, Prediction:1, Target's Score:[-0.38941616, 10.969268, -3.1087873, -2.1501346, -1.1889948, -3.315818, 2.6041906, -1.1174351, -1.4530222, -0.34995368]
Target sample: 26, Prediction:1, Target's Score:[-0.6075515, 10.267838, -3.0116584, -1.5518833, -1.0224593, -3.4412682, 1.465596, -1.4565917, -1.7210164, 1.54634]
Target sample: 31, Prediction:1, Target's Score:[-1.1197436, 13.074749, -3.7620165, -2.07282, -1.6688167, -3.7126489, 1.5214717, -0.90445065, -0.3865779, -0.4237502]
Target sample: 36, Prediction:1, Target's Score:[-0.25421274, 12.605183, -3.8112152, -2.0459926, -1.8960804, -3.9065056, 1.8195552, -0.71621525, -1.1853664, -0.064542115]
Target sample: 41, Prediction:1, Target's Score:[-0.8357522, 11.4302435, -3.7908063, -1.5727938, -1.9046516, -3.7812881, 2.0772789, -0.86419547, -0.86795914, 0.6246839]
Target sample: 46, Prediction:1, Target's Score:[-0.7452894, 9.432565, -4.162977, -1.9296509, -1.0625188, -4.0421686, 2.1321068, -0.34539536, 0.7379837, 0.46082184]
Target sample: 51, Prediction:1, Target's Score:[-1.7748808, 11.392699, -3.990969, -1.8980756, -0.8235377, -3.7793689, 0.98144376, 0.21586141, 1.249423, -1.0583335]
Target sample: 56, Prediction:1, Target's Score:[-0.76051176, 10.909029, -4.1779346, -2.2715924, -0.8472488, -3.9559932, 1.0850097, 0.15463476, 1.3123602, -0.948883]
Target sample: 61, Prediction:1, Target's Score:[-1.4816697, 12.062897, -3.476216, -2.1530828, -1.1400639, -3.5279362, 0.80201375, -0.7408099, 1.4700514, -1.3074005]
Target sample: 66, Prediction:1, Target's Score:[-1.5778915, 13.32603, -3.8570316, -1.8831555, -1.4167619, -3.875604, 1.9066927, -0.6723957, 0.19770601, -1.570901]
Target sample: 71, Prediction:1, Target's Score:[-1.0778967, 10.952109, -3.281338, -2.1777782, -0.462599, -3.930611, 3.471045, -0.73997474, -0.1638224, -2.0503504]
Target sample: 76, Prediction:1, Target's Score:[-1.146591, 11.943803, -3.5142097, -1.6543691, -0.8501707, -3.9563794, 2.9073281, -0.9020926, -0.7966545, -1.4580617]
Target sample: 81, Prediction:1, Target's Score:[0.32289365, 9.401302, -2.0633552, -1.8920937, -0.23035291, -3.9845054, 4.043655, -1.7575576, -2.6291268, -0.694218]
Target sample: 86, Prediction:6, Target's Score:[-0.86417013, 5.266054, -2.197241, -1.0103686, 0.05591776, -3.9748251, 6.7195463, -0.9814019, -1.277783, -1.271071]
Target sample: 91, Prediction:1, Target's Score:[-1.0229815, 8.907018, -3.2104373, -1.1321145, -0.9049561, -3.829694, 3.5146065, -0.3826885, -0.109931245, -1.3354119]
Target sample: 96, Prediction:1, Target's Score:[-1.4356185, 9.99884, -3.3254933, -0.999971, -0.618053, -3.6361034, 3.6388636, -1.0811634, -1.2099303, -0.8076081]
Target sample: 101, Prediction:1, Target's Score:[-1.0231495, 8.571572, -3.0476382, -1.3294203, -1.1249595, -3.479153, 4.3109426, -0.7467221, -1.3470949, -0.2864471]
Target sample: 106, Prediction:6, Target's Score:[-0.544182, 6.0590496, -2.5542867, -1.52793, -1.1612502, -4.2812524, 8.002469, -1.8587905, -2.4604502, 0.82375723]
Target sample: 111, Prediction:1, Target's Score:[-0.68512285, 11.307375, -2.560846, -1.9424356, -0.42597404, -3.9021337, 2.628282, -1.1996465, -1.5128808, -1.1669551]
Target sample: 116, Prediction:1, Target's Score:[-1.6592314, 10.267053, -2.5520215, -1.6024026, 0.3828625, -3.5610542, 2.3774526, -1.0579767, -0.8967442, -1.1914654]
Target sample: 121, Prediction:1, Target's Score:[-1.2207708, 13.198827, -3.7711072, -1.8977735, -0.9136603, -3.5669312, 1.1502178, -1.6524242, -0.89224625, 0.1078667]
Target sample: 126, Prediction:1, Target's Score:[-2.7670963, 7.7489443, -3.6787324, -0.97668105, 0.04950914, -3.5292118, 1.4944147, -1.5921601, 1.9024297, 1.781234]
Target sample: 131, Prediction:1, Target's Score:[-2.4585075, 6.856902, -3.18795, -0.92123663, 0.18426675, -3.8039596, 2.0925567, -0.1427953, 2.3162465, -0.4938312]
Target sample: 136, Prediction:1, Target's Score:[-1.5538343, 9.451418, -4.117285, -1.1874179, -1.7939091, -3.847433, 3.2455473, -1.3209984, 0.19677879, 1.4142251]
Target sample: 141, Prediction:1, Target's Score:[-1.1540567, 7.1067867, -4.6791286, -2.2247136, -0.99424464, -4.3297424, 1.303411, -1.2115247, 3.562115, 3.0506952]
Target sample: 146, Prediction:1, Target's Score:[-1.0189476, 11.799091, -3.8998473, -1.7827854, -2.0078242, -4.039074, 3.353076, -1.5418516, -1.0671631, 0.74651885]
Target sample: 151, Prediction:1, Target's Score:[-0.9992784, 11.163432, -3.6161082, -1.9111704, -1.2756463, -4.098904, 2.981124, -1.6643867, -0.94357336, 0.87726253]
Target sample: 156, Prediction:1, Target's Score:[-0.93164885, 9.118661, -2.2506647, -1.6644262, -0.7735308, -3.6632776, 4.213509, -1.5411183, -1.439217, -0.58178985]
Target sample: 161, Prediction:6, Target's Score:[-1.0967163, 3.9821439, -1.7337949, -1.2713071, -0.2665105, -3.845486, 8.428914, -1.6193544, -2.0415738, -0.091631584]
Target sample: 166, Prediction:9, Target's Score:[-2.7466083, 2.6396124, -3.7045987, -0.9071934, -0.9637659, -3.7469084, 5.359694, -2.1655638, 0.307185, 6.341318]
Current ATTACK acc on target samples: 17.647
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 21:26:11 Epoch 59, Val iteration 0, acc 92.200 (92.200)
2021-06-11 21:26:23 Epoch 59, Val iteration 19, acc 93.400 (92.930)
* Prec: 92.93000183105468
Per class accuracy =  [0.94430619 0.94916193 0.90466362 0.8523263  0.95137702 0.89265059
 0.94833824 0.93155633 0.95711637 0.96655302]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 6, 6, 6, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 6, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 1, 6, 6, 8, 6
ATTACK acc: 16.176470588235293
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 21:26:26, Val iteration 0, acc 92.600 (92.600)
2021-06-11 21:26:30, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-11 21:26:31, Epoch 0, Iteration 7, loss 0.385 (0.390), acc 94.231 (89.600)
2021-06-11 21:26:46, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.8207161, 4.5839477, -0.55635285, 2.772443, -4.287232, -1.5084684, 7.511465, -6.328749, -1.272672, 2.062522]
Target sample: 6, Prediction:1, Target's Score:[-0.4539043, 8.668108, -0.90805876, 0.14026266, -3.7090266, -3.8388767, 0.45562991, -4.98988, -2.8092349, 7.698552]
Target sample: 11, Prediction:1, Target's Score:[-2.0670254, 11.784405, -3.0772426, 2.709243, -5.140021, -1.8548653, 0.5932759, -4.8091125, -3.808545, 5.927515]
Target sample: 16, Prediction:1, Target's Score:[2.2589865, 7.5818205, 1.9413121, 2.4182036, -4.050069, -3.4314985, 3.8266647, -6.355248, -4.120173, 0.13353236]
Target sample: 21, Prediction:1, Target's Score:[-0.36453018, 8.885875, 1.8527209, 2.3647366, -2.733904, -4.5703273, 5.545383, -4.9422913, -1.9366188, -3.904007]
Target sample: 26, Prediction:1, Target's Score:[0.19829637, 15.547958, -2.7384598, -0.12568656, -5.9591956, -3.5476446, 4.7920537, -5.3135214, -3.1359391, 0.49759907]
Target sample: 31, Prediction:1, Target's Score:[-0.60105485, 20.207235, -4.2464767, -1.159792, -6.3065233, -2.5934863, 1.0391005, -5.364632, -0.6707215, -0.019578025]
Target sample: 36, Prediction:1, Target's Score:[-1.580104, 17.76978, -4.7068353, -1.223676, -5.7907734, -3.0469635, 4.37146, -5.1437774, -0.36812776, -0.04350379]
Target sample: 41, Prediction:1, Target's Score:[-2.0314832, 16.426321, -5.2608976, 0.46725953, -5.1001177, -1.8949716, 2.480994, -5.5735598, -0.5789544, 1.3149347]
Target sample: 46, Prediction:1, Target's Score:[-1.3905725, 11.844805, -4.8939567, 1.3134791, -0.75234014, -3.3534384, 0.9962883, -3.8749151, 0.38785982, -0.03141193]
Target sample: 51, Prediction:1, Target's Score:[-2.655834, 13.651456, -5.692346, 0.5653496, -3.1698039, -1.0023187, 1.9999375, -5.294261, 3.018429, -1.1838151]
Target sample: 56, Prediction:1, Target's Score:[-2.145343, 13.2501335, -5.4215884, 1.4396861, -2.4526174, -2.2506354, 2.8649151, -4.74651, 0.93810946, -1.2405739]
Target sample: 61, Prediction:1, Target's Score:[-0.86165637, 13.495661, -5.955798, 2.461145, -1.1791356, -2.3044019, 1.3296385, -5.9625106, -0.33530128, -0.4224796]
Target sample: 66, Prediction:1, Target's Score:[-1.3934367, 15.696289, -5.6058836, 0.8614931, -5.226745, -2.7218692, 3.5772662, -5.778384, 0.4013111, 0.41534978]
Target sample: 71, Prediction:1, Target's Score:[0.84981287, 10.458644, -2.7165859, 1.2546122, 2.6793962, -4.790104, -0.646987, -4.1064644, 0.7418672, -3.4391096]
Target sample: 76, Prediction:1, Target's Score:[-0.20166111, 17.197657, -4.202127, 0.70053256, -5.0503836, -2.7730544, 3.518187, -7.0027757, -2.8743253, 0.9458463]
Target sample: 81, Prediction:1, Target's Score:[2.2237246, 15.895754, -3.0186179, 1.0005672, -5.4675603, -3.5628605, 0.66385305, -6.849436, -1.6644753, 1.0353386]
Target sample: 86, Prediction:1, Target's Score:[0.75816274, 10.8663025, -2.1657748, -0.68260324, -3.7509553, -3.492646, 3.3148155, -4.287667, -0.23044452, -0.14617676]
Target sample: 91, Prediction:1, Target's Score:[0.0593239, 14.052645, -4.2402563, -0.37326756, -6.380981, -1.4470961, 3.512576, -6.1356897, 1.2594357, -0.105284765]
Target sample: 96, Prediction:1, Target's Score:[-1.5522205, 16.288368, -5.6278973, -0.7725332, -5.490753, -0.74070054, 2.533759, -5.301144, -1.7226442, 2.6332211]
Target sample: 101, Prediction:1, Target's Score:[1.2707556, 14.503168, -2.9512925, -0.9081334, -6.075233, -2.8310316, 2.8932543, -5.572243, -0.065784015, -0.056559123]
Target sample: 106, Prediction:1, Target's Score:[-1.0242304, 13.518528, -3.0058649, -1.2704718, -6.1713157, -3.4907854, 7.213612, -5.254142, -0.4349641, 0.08871828]
Target sample: 111, Prediction:1, Target's Score:[0.19623366, 14.587957, -2.5109293, -0.45430496, -5.4805555, -3.9805834, 4.797022, -5.558188, -0.8275812, -0.56886876]
Target sample: 116, Prediction:1, Target's Score:[-0.28196877, 17.393175, -3.1457222, -0.6567867, -4.9920516, -4.2827053, 3.4803956, -5.777057, -0.8386393, -0.6505001]
Target sample: 121, Prediction:1, Target's Score:[0.961964, 16.174099, -3.8099177, -1.1385183, -4.4289865, -3.8668592, 0.6489611, -4.3867683, 1.1148409, -1.0252448]
Target sample: 126, Prediction:1, Target's Score:[-0.008436553, 12.718023, -4.2377076, 0.41250765, -3.0566163, -3.8077483, 3.733317, -5.161055, 2.179111, -2.5696433]
Target sample: 131, Prediction:1, Target's Score:[-0.2252217, 11.900128, -3.8994968, -1.6920992, 3.0006928, -3.551847, -1.5183709, -2.2621524, -0.31674033, -1.1273669]
Target sample: 136, Prediction:1, Target's Score:[-1.266241, 12.748708, -4.9110384, 0.18879205, -4.613142, -2.1777215, 3.688034, -5.229896, 0.96088034, 0.8080405]
Target sample: 141, Prediction:1, Target's Score:[0.3393842, 8.781936, -3.5088239, 2.6184201, -2.9164004, -3.1094887, 1.177491, -5.223318, -2.8528836, 4.9323397]
Target sample: 146, Prediction:1, Target's Score:[-1.5959922, 16.402967, -4.00402, -0.029417634, -4.6931443, -3.168787, 1.4077854, -4.5510693, -1.4748887, 1.9783118]
Target sample: 151, Prediction:1, Target's Score:[-0.11910274, 14.775279, -3.6793952, -1.435582, -5.2800446, -3.3952165, 4.860756, -5.727433, -1.7684754, 1.9794836]
Target sample: 156, Prediction:1, Target's Score:[0.6981537, 10.74788, -2.349899, 0.902135, -6.177832, -3.3814735, 4.8102956, -6.056409, -4.3915176, 5.4096956]
Target sample: 161, Prediction:6, Target's Score:[0.50733733, 2.910824, 1.3138186, 2.9421875, 1.174047, -3.9845026, 4.6352534, -4.3636684, -3.057423, -1.8904971]
Target sample: 166, Prediction:9, Target's Score:[-3.0340044, 6.5822554, -4.0647483, 1.378022, -4.63012, -2.1031425, 5.919802, -5.8898664, -2.885228, 8.925502]
Current ATTACK acc on target samples: 5.882
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 21:27:01 Epoch 59, Val iteration 0, acc 89.200 (89.200)
2021-06-11 21:27:04 Epoch 59, Val iteration 19, acc 90.600 (89.560)
* Prec: 89.56000061035157
Per class accuracy =  [0.92271117 0.92369494 0.84000504 0.83130943 0.89382199 0.83032756
 0.93855599 0.89086038 0.93284827 0.94699464]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 9, 1, 1, 9, 1, 1, 1, 1, 3, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 6, 1, 1, 9, 9, 9
ATTACK acc: 2.2058823529411766
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 21:27:09, Val iteration 0, acc 96.200 (96.200)
2021-06-11 21:27:15, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-11 21:27:18, Epoch 0, Iteration 7, loss 0.401 (0.596), acc 86.538 (82.600)
2021-06-11 21:27:51, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-3.2106373, 6.24651, -1.9827609, -0.7821841, -2.6854398, -2.0191314, 4.8477664, -1.7186667, 1.3511167, 0.023726854]
Target sample: 6, Prediction:1, Target's Score:[-3.2034132, 6.2363467, -1.187953, -1.889444, -0.6454814, -2.4578927, 2.3078413, -2.7846713, 1.9452302, 1.7532731]
Target sample: 11, Prediction:1, Target's Score:[-2.3782997, 5.20149, -1.0897762, -3.555775, -1.4566153, -1.2654219, 4.40103, -2.785132, 1.260761, 1.7450882]
Target sample: 16, Prediction:6, Target's Score:[-2.8166087, 5.0398893, -3.3595273, -2.2085774, -1.276261, -1.592678, 7.0101247, -1.7947886, 0.28021044, 0.78612846]
Target sample: 21, Prediction:1, Target's Score:[-2.7938752, 11.086566, -2.3777397, -2.5671096, -2.8273854, -1.679217, 4.523603, -2.9458313, -0.92176497, 0.56037605]
Target sample: 26, Prediction:1, Target's Score:[-2.5269563, 13.000332, -2.7157779, -3.3560946, -3.409541, -1.9280664, 2.959073, -2.697261, -0.6324405, 1.3680216]
Target sample: 31, Prediction:1, Target's Score:[-3.0082114, 15.490596, -2.9796531, -2.6455512, -3.6985316, -2.693398, 2.056093, -2.8402066, -0.5728516, 0.94924164]
Target sample: 36, Prediction:1, Target's Score:[-2.8153386, 13.004378, -3.2860134, -2.3073657, -3.570945, -2.8612947, 1.9545574, -3.0942082, -0.197257, 3.2379787]
Target sample: 41, Prediction:1, Target's Score:[-3.3941348, 11.100778, -3.159889, -1.6954529, -3.2350903, -3.0363283, 2.5189378, -3.4331927, 1.7921195, 2.626455]
Target sample: 46, Prediction:1, Target's Score:[-2.276241, 8.318029, -3.426668, -1.9289439, -2.694853, -3.3123684, 2.4672427, -2.5715017, 5.2296886, 0.29213116]
Target sample: 51, Prediction:1, Target's Score:[-2.931081, 7.38633, -3.6726806, -2.2775407, -2.5500474, -3.0395885, 3.559773, -2.9695334, 6.945771, -0.34305713]
Target sample: 56, Prediction:1, Target's Score:[-2.1099522, 8.337571, -3.334666, -1.5057281, -2.8704631, -3.3391118, 2.2200766, -2.7204547, 4.7016835, 0.7102078]
Target sample: 61, Prediction:1, Target's Score:[-1.9832145, 9.904984, -3.5299053, -1.5114676, -2.300034, -2.940809, 2.2404218, -3.0357542, 2.6033614, 0.62477326]
Target sample: 66, Prediction:1, Target's Score:[-2.513615, 11.24051, -3.6253603, 0.4227191, -3.3368578, -3.1406653, 2.2120917, -2.6142018, 0.50560296, 0.9151511]
Target sample: 71, Prediction:1, Target's Score:[-1.7720343, 9.48853, -3.3796718, -1.300898, -2.17997, -3.0935035, 4.0055065, -2.7657866, 2.2682412, -1.2009048]
Target sample: 76, Prediction:1, Target's Score:[-0.8668639, 9.985627, -3.4440968, -1.1073067, -2.0087848, -2.401057, 3.4896574, -2.838447, -1.0585003, 0.3027968]
Target sample: 81, Prediction:1, Target's Score:[0.14496678, 7.441987, -2.8996527, -1.5261939, -1.1746567, -3.0208542, 4.68686, -2.3826768, -0.77465165, -0.43909225]
Target sample: 86, Prediction:6, Target's Score:[-1.4906722, 3.554126, -1.5255992, -1.722554, -0.74302506, -2.295247, 6.388686, -1.902748, 1.9151471, -2.1100917]
Target sample: 91, Prediction:1, Target's Score:[-1.9475764, 7.3550286, -1.7406355, -2.1677725, -2.0825794, -1.7444053, 2.8450181, -2.533602, 3.3819928, -1.2897338]
Target sample: 96, Prediction:1, Target's Score:[-2.5494907, 7.638363, -2.5665977, -1.3949755, -1.4372119, -1.7465502, 3.4608443, -2.1099617, 2.0358372, -1.262352]
Target sample: 101, Prediction:1, Target's Score:[-1.6918869, 7.758279, -2.074863, -3.0224543, -0.20582163, -1.9322469, 2.4512815, -2.6188612, 0.64676154, 0.7536883]
Target sample: 106, Prediction:1, Target's Score:[-3.0767853, 7.9658856, -2.265495, -2.3934968, -2.8683956, -2.1472163, 6.923216, -2.9187574, -0.16391726, 1.0103532]
Target sample: 111, Prediction:1, Target's Score:[-1.8406466, 11.872628, -3.092563, -2.192065, -2.4240956, -2.696181, 4.5287986, -3.1415994, -1.1182953, 0.16155192]
Target sample: 116, Prediction:1, Target's Score:[-2.665902, 9.884088, -2.9073863, -1.8375262, -2.6799126, -2.5697622, 5.556747, -2.7963977, 1.2119493, -1.1309988]
Target sample: 121, Prediction:1, Target's Score:[-0.8274941, 8.478135, -3.5175567, -1.8536991, -2.586363, -3.1348424, 2.4975076, -3.4782765, 1.176016, 3.3230288]
Target sample: 126, Prediction:1, Target's Score:[-2.2563126, 8.663831, -2.8102276, -2.0452883, -2.6153815, -3.1846302, 1.7186583, -3.2278075, 3.9672956, 1.8849118]
Target sample: 131, Prediction:8, Target's Score:[-2.7382133, 4.9402328, -2.2986293, -2.4624817, -2.2456183, -2.248832, 3.8180919, -2.9502158, 5.2953067, 0.9920856]
Target sample: 136, Prediction:1, Target's Score:[-2.5838068, 6.7000785, -2.9386003, -1.0194994, -2.597257, -2.8870637, 2.3088257, -3.050158, 4.50016, 1.6639048]
Target sample: 141, Prediction:1, Target's Score:[-2.391938, 8.64209, -3.0914984, -1.271772, -2.6593647, -3.0963125, 2.037762, -2.4693007, 2.6754782, 1.7012819]
Target sample: 146, Prediction:1, Target's Score:[-1.8306206, 6.7384405, -2.474285, -0.66822, -2.9055977, -2.5605443, 4.116367, -2.6956244, -0.5655158, 2.9097645]
Target sample: 151, Prediction:1, Target's Score:[-2.407068, 10.2955265, -2.8082998, -1.798113, -2.6059613, -2.0247524, 3.3836436, -2.9214973, -0.4735859, 1.415576]
Target sample: 156, Prediction:1, Target's Score:[-2.1694686, 10.603477, -2.3748956, -1.8714241, -3.2462633, -2.4526718, 4.088205, -2.483794, -1.1984112, 1.1613245]
Target sample: 161, Prediction:1, Target's Score:[-2.50085, 4.9311175, 0.3163674, -0.68816674, -1.1123765, -1.9627807, 4.649816, -2.5418582, -0.29612935, -0.7360877]
Target sample: 166, Prediction:6, Target's Score:[-3.207269, 4.984422, -2.7186615, -1.355996, -0.73807716, -1.7876121, 6.2563057, -2.6245723, -0.1691397, 1.424177]
Current ATTACK acc on target samples: 8.824
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 21:28:23 Epoch 59, Val iteration 0, acc 92.400 (92.400)
2021-06-11 21:28:30 Epoch 59, Val iteration 19, acc 93.200 (92.860)
* Prec: 92.86000175476075
Per class accuracy =  [0.94165361 0.9366505  0.90075596 0.83577588 0.95877955 0.89286407
 0.96363969 0.94582402 0.94808438 0.95736725]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 6, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 1, 8, 1, 8, 1, 1, 1, 1, 1, 1, 8, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 1, 1, 1, 1, 1
ATTACK acc: 11.764705882352942
--------
------SUMMARY PRE DEFENSE------
TIME ELAPSED (mins): 18
TARGET INDEX: 8
ResNet50 55.88235294117647 58.088235294117645 95.46000137329102 88.02000160217285
DPN92 17.647058823529413 16.176470588235293 95.50000267028808 92.93000183105468
MobileNetV2 5.882352941176471 2.2058823529411766 91.22000160217286 89.56000061035157
GoogLeNet 8.823529411764707 11.764705882352942 95.41000213623047 92.86000175476075
DEFENSE EVALUATION
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
ResNet50
[74, 80, 84, 86, 89] 5
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 21:28:35, Val iteration 0, acc 94.200 (94.200)
2021-06-11 21:28:40, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-11 21:28:41, Epoch 0, Iteration 7, loss 0.072 (0.146), acc 98.077 (96.600)
2021-06-11 21:29:09, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-2.8277645, 11.400017, -3.8951473, -2.6467721, -1.521069, -1.4810823, -0.16296129, -2.4039588, 0.16320388, 3.8033123]
Target sample: 6, Prediction:1, Target's Score:[-3.5953722, 12.354929, -4.015703, -2.7199538, 1.2440258, -1.8791237, -1.2021772, -2.3498652, -0.52663726, 3.164346]
Target sample: 11, Prediction:1, Target's Score:[-3.5133936, 14.916156, -3.7171657, -3.0082185, -1.9207252, -2.6863396, -1.1496571, -3.06102, -0.61327666, 5.238606]
Target sample: 16, Prediction:1, Target's Score:[-2.8193502, 7.3412576, -2.030777, -2.3239155, -0.07614045, -2.4033542, 1.9893062, -2.5083337, 0.58567065, 2.6300738]
Target sample: 21, Prediction:1, Target's Score:[-3.9806714, 23.79246, -4.771604, -4.230946, -3.8647196, -3.0900261, -1.8316687, -3.4421365, -1.87142, 3.9299214]
Target sample: 26, Prediction:1, Target's Score:[-4.187029, 25.551712, -4.894886, -4.35972, -4.3872194, -3.4899316, -2.2649322, -3.5584974, -2.5686285, 4.8321695]
Target sample: 31, Prediction:1, Target's Score:[-4.602579, 29.058744, -5.358675, -5.107453, -4.8540635, -4.169784, -2.5935445, -3.6602535, -2.9626267, 4.997105]
Target sample: 36, Prediction:1, Target's Score:[-4.669657, 29.706404, -5.473382, -5.3798337, -5.1564045, -4.554594, -2.7878306, -3.7716827, -3.1878335, 6.0432277]
Target sample: 41, Prediction:1, Target's Score:[-4.109422, 26.21512, -4.9869037, -4.508708, -4.6955686, -3.7888799, -2.5891902, -3.6527865, -2.50177, 5.3048573]
Target sample: 46, Prediction:1, Target's Score:[-2.2853594, 18.155449, -4.012986, -3.4724407, -2.5702932, -2.6614363, -1.9192692, -2.6806982, -0.8084298, 2.7583778]
Target sample: 51, Prediction:1, Target's Score:[-2.7312512, 20.143858, -4.2311134, -3.8741472, -2.902996, -2.8145037, -2.0897467, -2.716944, -0.8451679, 2.608898]
Target sample: 56, Prediction:1, Target's Score:[-2.6920977, 21.505161, -4.537292, -3.9773204, -3.3617935, -3.0696056, -1.8671066, -2.8442085, -0.6624321, 2.0739055]
Target sample: 61, Prediction:1, Target's Score:[-3.668554, 25.438177, -4.7311387, -4.5741205, -4.1980996, -3.5498238, -2.3668845, -3.0503154, -1.8407663, 3.1903515]
Target sample: 66, Prediction:1, Target's Score:[-3.7675197, 25.486397, -4.708572, -4.4622345, -4.2921524, -3.7173793, -2.1180646, -3.2557173, -2.0698383, 3.5597997]
Target sample: 71, Prediction:1, Target's Score:[-3.848227, 25.00042, -4.7691135, -4.276266, -3.7817519, -3.3477423, -1.7124624, -3.271632, -1.8423756, 2.5025253]
Target sample: 76, Prediction:1, Target's Score:[-4.5305176, 26.77306, -5.202104, -5.0092583, -3.4826357, -3.8980281, -2.167804, -3.4343386, -2.639458, 4.30338]
Target sample: 81, Prediction:1, Target's Score:[-3.521194, 20.892569, -4.3176746, -4.080005, -1.8541757, -3.1032965, -1.5466001, -2.888239, -2.0392144, 3.045875]
Target sample: 86, Prediction:1, Target's Score:[-2.4342585, 12.254322, -3.190471, -3.2733595, -0.3572198, -2.2828627, -0.20980364, -1.549955, 0.26370057, 1.1971376]
Target sample: 91, Prediction:1, Target's Score:[-2.6683626, 18.1761, -4.2900968, -3.5402973, -2.7568398, -2.5911167, -1.1872455, -2.6935859, 0.15473042, 1.9142525]
Target sample: 96, Prediction:1, Target's Score:[-3.5389166, 21.365183, -4.716786, -3.4817905, -3.310128, -2.824993, -1.9567052, -3.2780507, -1.5054723, 3.83951]
Target sample: 101, Prediction:1, Target's Score:[-3.2323093, 20.804325, -3.59531, -3.6741939, -2.3661947, -3.4258213, -1.5303547, -3.010429, -1.6356653, 2.2534847]
Target sample: 106, Prediction:1, Target's Score:[-3.9224591, 20.303041, -4.3277287, -4.116967, -3.3202493, -3.3816392, -0.255354, -3.4053879, -1.5866866, 4.6135416]
Target sample: 111, Prediction:1, Target's Score:[-4.097074, 28.086454, -5.3822227, -4.8329906, -4.914954, -4.0004888, -2.0903897, -3.8193521, -2.0837193, 3.863524]
Target sample: 116, Prediction:1, Target's Score:[-4.8369894, 31.716742, -6.101767, -5.5556006, -5.482639, -4.4875746, -2.465238, -4.096543, -2.3441985, 4.46385]
Target sample: 121, Prediction:1, Target's Score:[-4.6265507, 30.898075, -6.0292864, -5.277287, -5.385582, -4.212523, -2.97545, -3.9749568, -2.8563805, 5.230129]
Target sample: 126, Prediction:1, Target's Score:[-3.810173, 25.284554, -5.1601605, -4.5195875, -3.818093, -3.5335128, -2.479278, -3.3322, -1.8424288, 3.8715096]
Target sample: 131, Prediction:1, Target's Score:[-3.3020997, 22.294876, -4.4598923, -3.881392, -3.1193116, -3.1176133, -2.178782, -2.9594786, -1.5819695, 2.8935723]
Target sample: 136, Prediction:1, Target's Score:[-2.6254263, 20.67839, -4.1764927, -3.7849796, -3.441236, -2.9495418, -1.806121, -2.963692, -0.88221896, 2.5040226]
Target sample: 141, Prediction:1, Target's Score:[-2.0383677, 17.166164, -3.9598455, -3.5593772, -2.4900725, -2.7388701, -1.8909919, -2.8887777, 0.16795625, 2.7298827]
Target sample: 146, Prediction:1, Target's Score:[-3.812906, 24.689585, -4.7006063, -4.4581747, -4.347523, -3.7328827, -2.1290898, -3.481253, -2.5190914, 5.147139]
Target sample: 151, Prediction:1, Target's Score:[-3.7550297, 24.173092, -4.7065315, -4.4922056, -3.654546, -3.6485944, -2.1920362, -3.3242881, -2.227974, 4.4716077]
Target sample: 156, Prediction:1, Target's Score:[-3.9009433, 22.574108, -4.1748867, -4.1086235, -3.4004745, -3.476172, -1.8943628, -3.284837, -2.3224459, 4.604294]
Target sample: 161, Prediction:1, Target's Score:[-3.8624926, 12.055901, -2.0860076, -2.5052178, -1.5970032, -2.6776137, -0.34000617, -3.2913458, -1.4291061, 6.206066]
Target sample: 166, Prediction:1, Target's Score:[-3.3449104, 11.831601, -3.7506194, -2.3291693, -1.0136172, -2.0998292, 0.030095985, -2.9311635, -0.09373822, 4.150071]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 21:29:37 Epoch 59, Val iteration 0, acc 90.600 (90.600)
2021-06-11 21:29:43 Epoch 59, Val iteration 19, acc 92.600 (91.130)
* Prec: 91.13000106811523
Per class accuracy =  [0.91178453 0.96153872 0.84736428 0.88218296 0.93049414 0.84780468
 0.93737015 0.90770328 0.96123402 0.92835582]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
DPN92
[74, 80, 84, 86, 89] 27
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 21:29:47, Val iteration 0, acc 94.800 (94.800)
2021-06-11 21:29:58, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-11 21:30:01, Epoch 0, Iteration 7, loss 0.168 (0.493), acc 92.308 (89.800)
2021-06-11 21:31:27, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-1.431954, 12.428669, -3.9415257, -1.3254179, -1.3903433, -2.1014047, -0.8730596, -3.0267467, 0.64053315, 1.4971116]
Target sample: 6, Prediction:1, Target's Score:[-2.3484943, 11.334418, -4.312828, -2.239947, 0.24898218, -2.201239, -0.32166973, -3.0059526, 2.863653, 0.4812179]
Target sample: 11, Prediction:1, Target's Score:[-1.7261517, 12.203106, -4.3033037, -2.0054033, -0.7068575, -2.3351943, -0.13875827, -2.8169143, 1.5162665, 0.8051238]
Target sample: 16, Prediction:1, Target's Score:[-1.6361344, 10.314843, -3.947249, -2.4653971, -0.40621987, -2.8025105, 1.4833232, -2.9991252, 2.570439, 0.37201086]
Target sample: 21, Prediction:1, Target's Score:[0.16295537, 15.842255, -4.480695, -3.131144, -0.7100758, -2.2949007, -1.5131887, -2.4711177, -1.127435, 0.30480674]
Target sample: 26, Prediction:1, Target's Score:[-0.012920073, 15.694421, -4.6381683, -2.7550647, -1.0648074, -2.5097082, -1.5903662, -2.4611244, -1.3438052, 1.2519892]
Target sample: 31, Prediction:1, Target's Score:[-0.52457315, 18.029926, -5.1170015, -2.7295485, -2.2087402, -2.3350635, -1.4906695, -3.31329, 0.08006799, 0.2385589]
Target sample: 36, Prediction:1, Target's Score:[0.15772884, 17.182846, -4.822571, -2.614993, -2.1247444, -2.6208446, -1.4566172, -2.8410065, -0.690592, 0.43445158]
Target sample: 41, Prediction:1, Target's Score:[-0.47116262, 16.945381, -4.8215866, -2.171669, -2.4223251, -2.4069123, -1.4737693, -3.0918047, -0.06628248, 0.57036847]
Target sample: 46, Prediction:1, Target's Score:[-0.5022965, 13.551517, -4.645675, -2.6943324, -1.0247715, -2.5326977, -0.84740347, -2.9198792, 2.357673, -0.22592664]
Target sample: 51, Prediction:1, Target's Score:[-1.2765743, 15.002724, -4.674965, -2.138333, -1.5674541, -2.3525405, -0.73022246, -2.8338294, 1.8350748, -0.71548843]
Target sample: 56, Prediction:1, Target's Score:[-0.32169294, 15.100174, -4.730371, -2.5767665, -2.0343993, -2.4646237, -0.8934197, -2.9322941, 2.0423627, -0.6502713]
Target sample: 61, Prediction:1, Target's Score:[-0.9135274, 15.875023, -4.7352505, -2.5004995, -2.180301, -2.4169698, -0.7513777, -3.4576695, 2.5043383, -0.8582739]
Target sample: 66, Prediction:1, Target's Score:[-0.81249434, 17.889608, -5.1574297, -2.384137, -2.425005, -2.7582018, -0.67768115, -3.281232, 0.48548725, -0.25108415]
Target sample: 71, Prediction:1, Target's Score:[-0.58033353, 16.351282, -4.8435206, -2.8279457, -0.9157598, -2.9261956, -0.27922586, -3.1934614, 0.22610366, -0.40893236]
Target sample: 76, Prediction:1, Target's Score:[-0.5848978, 17.229221, -4.9580297, -2.4078562, -1.6463972, -2.6543546, -1.0268391, -3.113407, -0.083405994, -0.13986927]
Target sample: 81, Prediction:1, Target's Score:[0.42563677, 15.598154, -4.424086, -2.8519173, -0.52402616, -2.9881387, -0.6510869, -2.9726968, -1.3212876, 0.29337987]
Target sample: 86, Prediction:1, Target's Score:[-0.4322338, 12.783272, -4.203646, -2.6719372, 0.20001245, -3.1565986, 0.6961831, -2.1323898, -0.10389181, -0.4453645]
Target sample: 91, Prediction:1, Target's Score:[-0.38704336, 14.345609, -4.568331, -2.04678, -1.530033, -2.3973782, -0.56916445, -2.5031855, 0.6186344, -0.42710242]
Target sample: 96, Prediction:1, Target's Score:[-0.26082098, 14.994684, -4.5888186, -2.0164223, -0.95431733, -2.587057, -1.2033149, -2.6027787, -1.0359908, 0.80390894]
Target sample: 101, Prediction:1, Target's Score:[-0.66467845, 13.474627, -4.2321415, -2.30138, -0.71975774, -2.3019114, -0.85300267, -2.51477, 0.35918543, 0.27713212]
Target sample: 106, Prediction:1, Target's Score:[0.28975433, 14.986175, -4.6579823, -2.5430517, -1.3275099, -3.1183143, 0.11103877, -3.1564736, -0.99356705, 0.984194]
Target sample: 111, Prediction:1, Target's Score:[0.19253469, 16.992756, -4.730037, -3.1417303, -0.7602248, -2.8999364, -1.0290921, -2.837578, -1.2881651, 0.12695582]
Target sample: 116, Prediction:1, Target's Score:[-0.8051462, 16.169853, -4.581258, -2.819571, -0.1844868, -2.8536773, -0.55598265, -3.0621114, -0.6947907, -0.0030826144]
Target sample: 121, Prediction:1, Target's Score:[-0.22090665, 17.749214, -4.920885, -2.5942836, -1.7165259, -2.5104988, -1.7390155, -3.3890257, -1.0241479, 0.98203653]
Target sample: 126, Prediction:1, Target's Score:[-1.0159262, 14.693365, -4.8191414, -2.3060875, -1.2703408, -2.2345843, -1.1724166, -3.4069738, 1.5205106, 0.55575293]
Target sample: 131, Prediction:1, Target's Score:[-1.5474178, 12.639344, -4.196561, -2.2990758, -0.8155688, -2.4625368, -0.37905088, -2.9229133, 2.9840336, -0.49889457]
Target sample: 136, Prediction:1, Target's Score:[-0.9747141, 15.561347, -4.8695097, -1.9605172, -2.4497406, -2.583256, -0.6941563, -3.4630504, 1.2687454, 0.71668124]
Target sample: 141, Prediction:1, Target's Score:[-0.81018394, 12.723608, -4.841802, -2.7546659, -2.177818, -2.9286315, -0.9811211, -3.7747638, 4.5547156, 1.5013278]
Target sample: 146, Prediction:1, Target's Score:[-0.28913963, 17.2039, -4.9489126, -2.391947, -2.318088, -2.6724272, -1.2273296, -3.5135643, -0.21281958, 0.970056]
Target sample: 151, Prediction:1, Target's Score:[-0.5486669, 16.670399, -4.8075366, -2.5278733, -1.8545976, -2.889387, -1.1099931, -3.5157042, -0.1949557, 1.3619068]
Target sample: 156, Prediction:1, Target's Score:[-0.55999833, 15.831808, -4.285442, -2.4259245, -1.6349555, -2.3683887, -1.1770978, -2.9533923, -0.050873093, 0.18120994]
Target sample: 161, Prediction:1, Target's Score:[-0.54062873, 12.908061, -3.765528, -2.6328545, 0.0014508518, -2.667297, -0.2401455, -2.378723, -0.5971268, 0.4249806]
Target sample: 166, Prediction:1, Target's Score:[-2.0538354, 11.229228, -4.8620553, -1.2751238, -1.642577, -2.3279254, -1.3086683, -3.9305677, 0.68638086, 5.996484]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 21:32:51 Epoch 59, Val iteration 0, acc 93.400 (93.400)
2021-06-11 21:33:03 Epoch 59, Val iteration 19, acc 93.000 (93.110)
* Prec: 93.11000213623046
Per class accuracy =  [0.95539371 0.97612001 0.90329645 0.83396161 0.95039198 0.88761091
 0.95322509 0.94518746 0.95888011 0.95064098]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
MobileNetV2
[74, 80, 84, 86, 89] 48
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 21:33:06, Val iteration 0, acc 92.600 (92.600)
2021-06-11 21:33:09, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-11 21:33:10, Epoch 0, Iteration 7, loss 0.294 (0.328), acc 86.538 (89.600)
2021-06-11 21:33:25, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-1.31221, 7.8461123, -1.2420621, 2.5807633, -4.6259694, -2.310726, 0.60055065, -4.44468, -0.1655432, 3.6504343]
Target sample: 6, Prediction:1, Target's Score:[0.7655387, 11.71795, -2.23569, 0.420879, -4.342136, -4.091279, -4.8787627, -4.061773, -1.8478638, 9.22801]
Target sample: 11, Prediction:1, Target's Score:[-0.8967751, 14.157967, -4.3093405, 2.1257143, -6.1920958, -1.9288107, -5.314679, -3.0067189, -2.4255478, 8.504577]
Target sample: 16, Prediction:1, Target's Score:[3.9794898, 11.0359955, 0.28695968, 1.7993913, -5.150793, -3.8081744, -2.263157, -5.043835, -2.669681, 2.4524486]
Target sample: 21, Prediction:1, Target's Score:[1.7376027, 14.391886, 0.3543498, 0.8932133, -4.972614, -5.0297318, -1.9530299, -3.614206, 0.271905, -1.4134824]
Target sample: 26, Prediction:1, Target's Score:[2.1671057, 19.842772, -3.9030974, -0.6284248, -6.902157, -3.7894568, -3.3686461, -3.8990245, -2.0606914, 3.288945]
Target sample: 31, Prediction:1, Target's Score:[1.3767915, 25.451462, -4.7363496, -2.2248948, -6.9112706, -3.221525, -6.9371305, -4.308734, 0.0650332, 2.3277957]
Target sample: 36, Prediction:1, Target's Score:[0.380027, 23.983433, -5.01021, -2.5287852, -7.010543, -3.985107, -4.425494, -4.2859507, 0.7282356, 2.9870684]
Target sample: 41, Prediction:1, Target's Score:[-0.2122485, 21.996498, -5.7171326, -0.57180184, -6.041591, -2.185977, -5.8168263, -4.4686437, -0.30578825, 4.1576934]
Target sample: 46, Prediction:1, Target's Score:[0.8125158, 17.385675, -5.4633603, -0.1337818, -2.4149532, -3.4403956, -6.220464, -2.79233, 0.82279015, 2.1938794]
Target sample: 51, Prediction:1, Target's Score:[-0.10706129, 19.975363, -5.5001707, -0.74705714, -4.6994643, -2.1226163, -6.2705, -4.4181786, 3.0971334, 1.566808]
Target sample: 56, Prediction:1, Target's Score:[0.4090798, 19.02882, -5.3260217, 0.25379014, -3.1275966, -3.1073933, -5.948221, -3.3968308, 0.5760703, 1.4375051]
Target sample: 61, Prediction:1, Target's Score:[2.393223, 18.708954, -5.751348, 1.0903388, -3.1035275, -2.8709614, -7.1354637, -4.9561644, 0.5135961, 1.9085193]
Target sample: 66, Prediction:1, Target's Score:[0.47931606, 22.040257, -6.254272, -0.3044623, -6.9205894, -3.5969963, -4.847791, -4.9051523, 1.470605, 3.6519516]
Target sample: 71, Prediction:1, Target's Score:[2.5918417, 16.199703, -3.6150827, -0.33577436, -0.9683273, -4.8096633, -6.034603, -3.534351, 1.4301234, -0.19336727]
Target sample: 76, Prediction:1, Target's Score:[1.6131096, 22.841825, -5.3611403, -0.44633472, -6.429744, -3.5922315, -5.088105, -5.643773, -1.2229884, 4.171777]
Target sample: 81, Prediction:1, Target's Score:[4.474205, 19.466003, -4.0689707, 0.22392954, -6.5458446, -4.21651, -6.13003, -5.9382825, -0.4820665, 3.980067]
Target sample: 86, Prediction:1, Target's Score:[2.5716224, 15.130996, -3.315314, -1.2134669, -4.760423, -4.450753, -3.6475728, -3.0679529, 1.4668375, 1.9073336]
Target sample: 91, Prediction:1, Target's Score:[0.9192191, 18.46762, -4.9801164, -1.1372774, -6.9626017, -2.2591357, -2.8958025, -5.545663, 2.6319087, 2.4777772]
Target sample: 96, Prediction:1, Target's Score:[-0.43657225, 20.704075, -6.389671, -1.6740425, -6.4805403, -1.8697972, -3.4544256, -4.397103, -0.2879272, 5.069247]
Target sample: 101, Prediction:1, Target's Score:[2.5374715, 18.474363, -3.8893626, -1.2032796, -6.7338195, -3.52101, -3.8924766, -4.555944, 1.1980138, 2.2608876]
Target sample: 106, Prediction:1, Target's Score:[0.55706805, 19.480621, -4.5313597, -1.9274876, -7.330721, -4.239384, -1.5982736, -3.9134295, 1.1794015, 3.0368624]
Target sample: 111, Prediction:1, Target's Score:[2.2195926, 19.693865, -3.5062892, -1.5388718, -6.5352006, -4.851384, -3.2907944, -4.4454255, 0.8834911, 2.0849888]
Target sample: 116, Prediction:1, Target's Score:[1.6060402, 22.85864, -4.1378565, -1.9640028, -6.393405, -4.789048, -4.318271, -4.9989142, 0.43955165, 2.5007546]
Target sample: 121, Prediction:1, Target's Score:[2.125367, 21.00133, -4.8851027, -1.9604394, -5.8229423, -4.380514, -5.3053637, -3.5323386, 1.5666082, 1.9463646]
Target sample: 126, Prediction:1, Target's Score:[2.2368844, 17.368519, -4.6752443, -0.6486853, -4.443517, -4.709756, -3.9200628, -4.2292547, 3.704498, -0.00053752586]
Target sample: 131, Prediction:1, Target's Score:[1.2196465, 16.120811, -4.785172, -2.592133, 1.1316801, -3.656617, -6.2635183, -1.5122926, -0.109697595, 1.1896412]
Target sample: 136, Prediction:1, Target's Score:[0.83390003, 17.656225, -5.5340276, -0.30795115, -5.58954, -3.0558698, -3.9758039, -4.341404, 1.1153446, 3.9081857]
Target sample: 141, Prediction:1, Target's Score:[1.7608527, 11.054184, -4.3481703, 2.3999867, -3.5764737, -2.6047487, -4.9611745, -3.7992449, -2.1878872, 6.93893]
Target sample: 146, Prediction:1, Target's Score:[0.4274394, 21.513525, -5.009761, -0.9540383, -5.796556, -3.6696227, -6.041384, -3.3994176, -1.037952, 4.8085027]
Target sample: 151, Prediction:1, Target's Score:[1.5069364, 20.734524, -4.8592186, -2.6383984, -6.287859, -4.088327, -3.8600247, -4.3340316, -0.14876729, 4.7267995]
Target sample: 156, Prediction:1, Target's Score:[3.0930505, 13.967082, -2.8819692, 0.16566037, -6.772181, -4.017768, -2.49749, -4.6812, -3.4073117, 7.7390146]
Target sample: 161, Prediction:1, Target's Score:[2.3197083, 6.327939, -0.23316255, 2.7116125, 0.053179674, -3.764705, -1.506765, -3.755245, -1.9349023, 0.3494815]
Target sample: 166, Prediction:9, Target's Score:[-2.1195734, 10.523538, -5.457292, 1.1886377, -4.8207526, -2.797967, -0.43599454, -4.6363826, -2.8761098, 12.156093]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 21:33:40 Epoch 59, Val iteration 0, acc 89.000 (89.000)
2021-06-11 21:33:43 Epoch 59, Val iteration 19, acc 90.200 (89.630)
* Prec: 89.63000144958497
Per class accuracy =  [0.93004606 0.93317003 0.8481585  0.83057696 0.89184521 0.82489844
 0.93044634 0.89221004 0.92961185 0.94579343]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 9, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 1
ATTACK acc: 0.0
GoogLeNet
[74, 80, 84, 86, 89] 22
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 21:33:46, Val iteration 0, acc 96.200 (96.200)
2021-06-11 21:33:53, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-11 21:33:54, Epoch 0, Iteration 7, loss 0.740 (0.909), acc 75.000 (80.800)
2021-06-11 21:34:27, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-3.6031482, 12.572141, -1.6385161, 1.8325086, -2.6774275, -4.4593296, -1.6139972, -2.6467595, 1.0419211, 1.282479]
Target sample: 6, Prediction:1, Target's Score:[-2.0184195, 11.489362, -0.39353558, 0.68806994, -0.90507907, -5.141083, -2.4146228, -3.8635483, 1.3348142, 1.3168697]
Target sample: 11, Prediction:1, Target's Score:[-1.5291896, 11.526588, 0.82884264, -0.14807771, -1.5645567, -5.009733, -1.629441, -3.9346871, -0.9580949, 2.505134]
Target sample: 16, Prediction:1, Target's Score:[-1.6311742, 12.102832, -3.270544, -0.45903906, -2.1708431, -4.832217, 0.3145543, -2.5069544, 0.5363669, 1.996044]
Target sample: 21, Prediction:1, Target's Score:[-3.4885843, 22.023106, -3.3668828, -0.5373675, -3.774523, -5.606444, -2.6670732, -3.5279346, -1.6999654, 2.7288015]
Target sample: 26, Prediction:1, Target's Score:[-3.244222, 22.16656, -3.8749702, -0.43430403, -4.5521145, -5.0125604, -3.107248, -3.4626768, -1.3854035, 2.988214]
Target sample: 31, Prediction:1, Target's Score:[-3.6054518, 22.887499, -3.940758, -0.16124801, -4.1630716, -5.384084, -3.5850205, -3.7917635, -1.513056, 3.3446398]
Target sample: 36, Prediction:1, Target's Score:[-3.805433, 19.772482, -3.5368679, 0.54282075, -3.7124226, -5.4705386, -3.822415, -3.809631, -0.26320285, 4.2005234]
Target sample: 41, Prediction:1, Target's Score:[-4.2118363, 17.495714, -3.4092743, 0.64836127, -4.0369263, -5.1105824, -3.2022843, -4.1167064, 2.7167842, 3.3282135]
Target sample: 46, Prediction:1, Target's Score:[-2.985522, 14.241257, -3.3307176, 1.1218762, -3.6206195, -5.2005477, -3.2234666, -3.2551079, 5.2007203, 1.1594175]
Target sample: 51, Prediction:1, Target's Score:[-3.7757273, 13.604745, -3.5394669, 0.38874236, -3.241534, -5.22522, -2.6447854, -3.8265674, 8.255729, 0.11448152]
Target sample: 56, Prediction:1, Target's Score:[-1.8748509, 14.469587, -3.0919852, 0.578999, -3.6717486, -5.342587, -3.3131554, -3.7093847, 5.0769496, 0.9808546]
Target sample: 61, Prediction:1, Target's Score:[-3.2901483, 18.588505, -3.6693757, 0.4999986, -3.1977386, -5.148647, -2.9595273, -3.6742449, 1.3561133, 1.5868385]
Target sample: 66, Prediction:1, Target's Score:[-3.4824502, 20.216883, -4.1228495, 1.1837854, -3.9191163, -5.1637926, -3.127427, -3.647772, -0.6482999, 2.8007748]
Target sample: 71, Prediction:1, Target's Score:[-1.3669451, 15.96254, -3.7701113, 0.5513501, -2.6607475, -5.0593257, -2.4757047, -4.0733614, 2.611752, 0.37086758]
Target sample: 76, Prediction:1, Target's Score:[-2.2882328, 22.115084, -4.5794578, -0.78290474, -3.2918737, -5.3778653, -3.0367758, -3.6218507, -1.5692708, 2.5160725]
Target sample: 81, Prediction:1, Target's Score:[-1.3003331, 18.90135, -3.803106, -1.0473485, -1.4366086, -5.5381355, -2.5829222, -3.7775288, -0.90413815, 1.5710868]
Target sample: 86, Prediction:1, Target's Score:[-1.8197113, 8.366224, -1.0706825, 0.31272075, -0.93916, -5.277038, -1.881016, -3.1984193, 6.569449, -0.95680285]
Target sample: 91, Prediction:1, Target's Score:[-1.6475719, 13.035741, -2.269996, 0.060733393, -2.8979688, -4.7557454, -2.8801856, -3.9925413, 5.6343126, -0.1844341]
Target sample: 96, Prediction:1, Target's Score:[-2.7510633, 13.554077, -3.0667634, 1.5666149, -1.8619776, -4.731794, -1.7603629, -3.4423866, 1.7047158, 0.87925655]
Target sample: 101, Prediction:1, Target's Score:[-2.0760865, 15.522631, -2.6530204, -1.0728039, -1.5646212, -5.085937, -2.7889202, -2.9347117, 1.2621238, 1.4801077]
Target sample: 106, Prediction:1, Target's Score:[-3.0321894, 17.24162, -3.1406384, 0.60432947, -3.7200534, -5.0508037, -2.1500583, -3.645489, 0.5511947, 2.4271736]
Target sample: 111, Prediction:1, Target's Score:[-1.3359727, 19.881395, -3.2756853, -0.93068767, -2.1538472, -5.7127504, -2.9448988, -4.2118416, -1.2895528, 2.0573637]
Target sample: 116, Prediction:1, Target's Score:[-2.2823884, 17.062716, -3.1581397, 0.09160866, -2.2283099, -5.287151, -2.6715252, -3.822256, 1.4907836, 0.8914842]
Target sample: 121, Prediction:1, Target's Score:[-1.1822608, 16.551214, -3.778596, -0.38953426, -2.7681868, -5.0309806, -2.821142, -3.9773257, -0.03843444, 3.5197487]
Target sample: 126, Prediction:1, Target's Score:[-2.784819, 13.848522, -2.84021, 0.10903312, -2.6738756, -5.3401074, -3.0864697, -3.9014363, 5.4517274, 1.3208741]
Target sample: 131, Prediction:1, Target's Score:[-2.7278287, 9.174253, -2.312244, 0.8040329, -2.1705081, -4.9903355, -2.332808, -3.9269521, 7.7903085, 0.8010585]
Target sample: 136, Prediction:1, Target's Score:[-0.72973794, 10.423881, -3.4462242, 0.90217966, -2.953726, -5.1369967, -2.890261, -3.6426542, 6.1942697, 1.3896911]
Target sample: 141, Prediction:1, Target's Score:[-2.061601, 13.070422, -3.5925481, 1.1431465, -3.374563, -4.7266335, -2.2062473, -3.6448972, 3.6452098, 1.8424811]
Target sample: 146, Prediction:1, Target's Score:[-0.7427276, 14.396881, -2.905098, 1.2207491, -3.3555822, -5.046417, -2.4225404, -3.7485096, 0.12633713, 2.5628507]
Target sample: 151, Prediction:1, Target's Score:[-2.530607, 18.248749, -3.175548, 0.40361848, -3.1055975, -5.0720134, -2.9788682, -3.6667633, -0.9200432, 2.8794549]
Target sample: 156, Prediction:1, Target's Score:[-3.2547739, 20.510096, -2.8237286, 0.1431237, -4.0662756, -5.5227532, -3.277056, -3.3457003, -1.279215, 3.0040765]
Target sample: 161, Prediction:1, Target's Score:[-3.9036438, 13.574955, -0.73200727, -0.80294085, -0.5673093, -5.36199, -1.0335023, -2.636356, 0.8167213, 0.7343001]
Target sample: 166, Prediction:1, Target's Score:[-3.302078, 9.442791, -2.3249972, 1.9246608, -0.7898677, -4.413148, 0.28269878, -3.5462523, -0.5541751, 3.367923]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 21:34:59 Epoch 59, Val iteration 0, acc 94.000 (94.000)
2021-06-11 21:35:05 Epoch 59, Val iteration 19, acc 93.800 (92.350)
* Prec: 92.35000114440918
Per class accuracy =  [0.95549227 0.96228774 0.88191848 0.7938804  0.95738095 0.90156141
 0.95858878 0.92043573 0.95929482 0.9438015 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
------SUMMARY POST DEFENSE------
TIME ELAPSED (mins): 18
TARGET INDEX: 8
ResNet50 0.0 0.0 95.46000137329102 91.13000106811523 100.0
DPN92 0.0 0.0 95.50000267028808 93.11000213623046 100.0
MobileNetV2 0.0 0.0 91.22000160217286 89.63000144958497 100.0
GoogLeNet 0.0 0.0 95.41000213623047 92.35000114440918 100.0
True False False False True
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.300-droplayer0.000.t7
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
No specific indices are determined, so try to include whatever we find
In total, we found 104 images of target 9
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', eval_poisons_root='', feat_reg_flag=False, gpu='1', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=9, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/9/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103]
# Targets: 18, # Poisons: 5
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 21:35:24 Iteration 0 	 Training Loss: 8.519e-01 	 Loss in Target Net: 1.082e+00	  
 2021-06-11 21:35:59 Iteration 50 	 Training Loss: 3.655e-01 	 Loss in Target Net: 4.401e-01	  
 2021-06-11 21:36:33 Iteration 100 	 Training Loss: 3.381e-01 	 Loss in Target Net: 4.414e-01	  
 2021-06-11 21:37:08 Iteration 150 	 Training Loss: 3.332e-01 	 Loss in Target Net: 4.284e-01	  
 2021-06-11 21:37:40 Iteration 200 	 Training Loss: 3.288e-01 	 Loss in Target Net: 4.238e-01	  
 2021-06-11 21:38:12 Iteration 250 	 Training Loss: 3.244e-01 	 Loss in Target Net: 4.447e-01	  
 2021-06-11 21:38:45 Iteration 300 	 Training Loss: 3.174e-01 	 Loss in Target Net: 4.423e-01	  
 2021-06-11 21:39:17 Iteration 350 	 Training Loss: 3.212e-01 	 Loss in Target Net: 4.545e-01	  
 2021-06-11 21:39:49 Iteration 400 	 Training Loss: 3.148e-01 	 Loss in Target Net: 4.539e-01	  
 2021-06-11 21:40:22 Iteration 450 	 Training Loss: 3.144e-01 	 Loss in Target Net: 4.413e-01	  
 2021-06-11 21:40:55 Iteration 500 	 Training Loss: 3.146e-01 	 Loss in Target Net: 4.422e-01	  
 2021-06-11 21:41:27 Iteration 550 	 Training Loss: 3.143e-01 	 Loss in Target Net: 4.479e-01	  
 2021-06-11 21:41:59 Iteration 600 	 Training Loss: 3.140e-01 	 Loss in Target Net: 4.876e-01	  
 2021-06-11 21:42:32 Iteration 650 	 Training Loss: 3.185e-01 	 Loss in Target Net: 4.416e-01	  
 2021-06-11 21:43:05 Iteration 700 	 Training Loss: 3.148e-01 	 Loss in Target Net: 4.564e-01	  
 2021-06-11 21:43:38 Iteration 750 	 Training Loss: 3.163e-01 	 Loss in Target Net: 4.478e-01	  
 2021-06-11 21:44:10 Iteration 800 	 Training Loss: 3.166e-01 	 Loss in Target Net: 4.387e-01	  
 2021-06-11 21:44:41 Iteration 850 	 Training Loss: 3.176e-01 	 Loss in Target Net: 4.435e-01	  
 2021-06-11 21:45:14 Iteration 900 	 Training Loss: 3.148e-01 	 Loss in Target Net: 4.607e-01	  
 2021-06-11 21:45:47 Iteration 950 	 Training Loss: 3.148e-01 	 Loss in Target Net: 4.689e-01	  
 2021-06-11 21:46:20 Iteration 999 	 Training Loss: 3.138e-01 	 Loss in Target Net: 4.621e-01	  
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 21:46:23, Val iteration 0, acc 94.200 (94.200)
2021-06-11 21:46:29, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-11 21:46:31, Epoch 0, Iteration 7, loss 0.324 (0.280), acc 90.385 (93.400)
2021-06-11 21:47:00, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.564658, 5.386168, -1.9134166, -0.42315024, -1.9247153, -0.73447484, 6.3973503, -2.7541192, 0.19363959, -1.2681282]
Target sample: 7, Prediction:6, Target's Score:[-2.7285378, 1.5128996, -1.3905871, 0.18332474, 0.29622367, -1.5214255, 9.886222, -1.3499238, -0.8636041, -3.6244195]
Target sample: 13, Prediction:6, Target's Score:[-3.1588907, 6.0579023, -1.5023099, -2.0473351, -1.840798, -2.279349, 11.3590355, -1.9630558, -0.6320916, -3.5351887]
Target sample: 19, Prediction:1, Target's Score:[-3.3386965, 12.628867, -0.7899141, -2.0860546, -2.6076937, -3.3649628, 6.900597, -3.3097522, -1.2780979, -2.2359688]
Target sample: 25, Prediction:3, Target's Score:[-2.4546633, 0.76125443, 0.44662565, 4.2948503, -1.1775998, 0.061332025, 3.4997451, -2.0755527, -2.0621753, -0.9266913]
Target sample: 31, Prediction:1, Target's Score:[-3.7541611, 15.31022, -1.2086616, -3.0725932, -3.835269, -3.3618762, 6.391397, -2.8476057, -1.3798422, -1.6932622]
Target sample: 37, Prediction:1, Target's Score:[-2.4033763, 9.050912, -1.1127397, -0.31679338, -2.1031673, -1.8798172, 6.044709, -3.630716, -1.7035042, -1.4667966]
Target sample: 43, Prediction:6, Target's Score:[-3.3431509, 8.017368, -1.6960539, -2.0840967, -2.2188044, -1.5714105, 8.528419, -2.290258, 0.18091586, -3.1027715]
Target sample: 49, Prediction:6, Target's Score:[-2.7398403, 5.097668, -2.3014557, 0.06083563, -1.6239774, -1.8700373, 7.748546, -3.1515844, 2.023373, -2.8417418]
Target sample: 55, Prediction:6, Target's Score:[-2.481883, 2.9213934, -1.5571299, -0.5328418, -0.38144216, -1.0054305, 7.933339, -2.67968, 0.058672845, -1.9003512]
Target sample: 61, Prediction:6, Target's Score:[-2.6668658, 4.422641, -1.0402751, -0.72453, -0.40950444, -1.6597941, 7.8449893, -2.9432278, -1.4188405, -0.9704977]
Target sample: 67, Prediction:6, Target's Score:[-3.4914937, 8.607323, -1.7498766, -1.4657612, -2.0082517, -2.5659444, 9.336595, -3.0140471, -1.4499787, -1.6673529]
Target sample: 73, Prediction:1, Target's Score:[-2.3498812, 11.009332, -2.5624974, -1.9134785, -3.2449458, -2.5912583, 7.272725, -2.8392987, -1.050677, -1.2202568]
Target sample: 79, Prediction:1, Target's Score:[-2.4646726, 12.482763, -2.132856, -1.9934465, -3.2146068, -2.9275746, 5.1161065, -3.1002262, -0.67767614, -0.6074529]
Target sample: 85, Prediction:1, Target's Score:[-3.5966175, 8.620301, -1.1103773, -1.2087072, -2.1371255, -2.4807415, 7.6088777, -3.5915425, -1.5335289, -0.058407944]
Target sample: 91, Prediction:1, Target's Score:[-3.3219378, 8.142469, -0.7312174, 0.7023501, -2.3147154, -2.2681122, 6.3199415, -3.283066, -1.3953977, -1.3820449]
Target sample: 97, Prediction:6, Target's Score:[-1.8131174, 2.3770678, -1.9194155, -0.59418416, -0.23198524, -1.0423236, 7.8010435, -2.706356, 1.4503989, -2.975022]
Target sample: 103, Prediction:6, Target's Score:[-2.195761, 1.9767544, -1.1888151, -0.52766854, 0.35456732, -1.4643614, 8.641685, -2.7491086, 0.60729015, -3.0989296]
Current ATTACK acc on target samples: 55.556
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 21:47:28 Epoch 59, Val iteration 0, acc 91.800 (91.800)
2021-06-11 21:47:33 Epoch 59, Val iteration 19, acc 93.200 (92.860)
* Prec: 92.86000137329101
Per class accuracy =  [0.93414248 0.95616799 0.89714444 0.85378513 0.947435   0.88035744
 0.95810762 0.9407017  0.96075805 0.95678198]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 48.83720930232558
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 21:47:40, Val iteration 0, acc 94.800 (94.800)
2021-06-11 21:47:52, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-11 21:48:00, Epoch 0, Iteration 7, loss 0.761 (0.595), acc 80.769 (88.000)
2021-06-11 21:49:26, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.8029665, 7.0888815, -4.2974095, -2.3066034, -1.539874, -1.6911083, 3.8503985, -2.0880785, 4.031438, -0.8481708]
Target sample: 7, Prediction:6, Target's Score:[-2.5603018, 1.9266531, -3.7944155, -2.12472, -0.2793509, -3.3869722, 7.732209, -1.3695447, 5.9143863, -1.7538855]
Target sample: 13, Prediction:6, Target's Score:[-2.919567, 1.7378113, -4.1013536, -2.7876496, -0.7821584, -3.0731292, 10.082172, -2.056169, 5.8104944, -1.5966009]
Target sample: 19, Prediction:1, Target's Score:[-2.0899816, 10.652971, -2.8910441, -1.1128099, -2.1088555, -2.0630689, 3.6627731, -3.6185682, 1.4150923, -1.39063]
Target sample: 25, Prediction:3, Target's Score:[-4.2741523, -1.7463101, 0.24405077, 3.9345083, -2.1767938, -1.4041237, 3.3888888, 3.2263815, -0.23678139, -0.5783489]
Target sample: 31, Prediction:1, Target's Score:[-2.478665, 11.418513, -3.8168929, -2.0611572, -2.5603642, -2.2491689, 5.105742, -3.1230142, 1.9090244, -1.6749442]
Target sample: 37, Prediction:6, Target's Score:[-2.1521256, 5.8102093, -1.1313529, -0.48565406, -1.2183114, -1.7329047, 6.80921, -3.1814191, 1.1347601, -3.5111163]
Target sample: 43, Prediction:6, Target's Score:[-2.755599, 4.457476, -3.3190446, -2.4989223, -0.9401836, -1.9987781, 7.8308606, -2.3220773, 6.0419607, -4.1624794]
Target sample: 49, Prediction:6, Target's Score:[-1.8568134, 0.80204934, -3.531959, -1.6815201, -0.52918726, -3.9316802, 9.4344, -1.228749, 4.8838954, -2.0655515]
Target sample: 55, Prediction:6, Target's Score:[-2.1552134, -0.6603118, -2.006897, -0.7641404, -1.1590247, -3.6135943, 6.4755626, 1.1322114, 4.3654375, -1.3284653]
Target sample: 61, Prediction:6, Target's Score:[-2.3032694, 6.3943667, -3.6705518, -1.4659609, -1.3138689, -2.8864622, 6.9652357, -2.5095081, 2.8587303, -1.680417]
Target sample: 67, Prediction:6, Target's Score:[-3.04974, 3.618489, -2.5448797, -0.8680305, -0.72231394, -2.8597665, 11.721035, -3.1624901, 1.0737144, -2.859586]
Target sample: 73, Prediction:6, Target's Score:[-1.8749789, 0.9079839, -3.1983297, -1.7546648, -1.0571142, -3.565018, 10.420788, -1.670446, 3.830386, -1.7460217]
Target sample: 79, Prediction:6, Target's Score:[-2.5498981, 6.4157987, -3.7881525, -1.7917558, -2.0896318, -3.092793, 7.723618, -2.4600763, 3.2556014, -1.2358936]
Target sample: 85, Prediction:6, Target's Score:[-3.6302903, 3.434114, -1.6796464, 0.0982531, 0.014862478, -3.0729117, 11.401505, -3.7572393, 0.32219714, -2.764933]
Target sample: 91, Prediction:1, Target's Score:[-2.3335102, 7.2651153, -4.2375135, -1.4584149, -1.042096, -1.6663082, 4.706872, -2.6340604, 2.7888885, -0.97576785]
Target sample: 97, Prediction:6, Target's Score:[-1.8671979, -0.44183826, -3.030819, -1.9331498, -0.30437857, -3.6800086, 8.419371, -0.6158126, 5.041704, -1.3045311]
Target sample: 103, Prediction:6, Target's Score:[-2.0757046, 1.6482208, -3.5814362, -2.188919, -0.3535109, -3.514997, 7.156862, -1.4723672, 6.87703, -2.201067]
Current ATTACK acc on target samples: 72.222
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 21:50:49 Epoch 59, Val iteration 0, acc 92.600 (92.600)
2021-06-11 21:51:01 Epoch 59, Val iteration 19, acc 93.800 (93.450)
* Prec: 93.45000076293945
Per class accuracy =  [0.96481323 0.96490234 0.89728632 0.87510291 0.94641293 0.88165482
 0.95057309 0.94027995 0.96571513 0.96301509]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 6, 8, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 6, 6, 6, 1, 1, 1, 6, 1, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 1, 1, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 8, 6, 6, 6, 6, 6, 6, 8, 8, 8
ATTACK acc: 68.6046511627907
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 21:51:04, Val iteration 0, acc 92.600 (92.600)
2021-06-11 21:51:07, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-11 21:51:08, Epoch 0, Iteration 7, loss 0.222 (0.329), acc 94.231 (90.800)
2021-06-11 21:51:23, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-0.6171364, 12.614771, -4.1257005, 0.78460205, -3.7787511, -3.1634603, 2.8089657, -3.7430255, -1.7603742, 1.471362]
Target sample: 7, Prediction:1, Target's Score:[2.4800982, 6.3908486, -0.43341064, 5.580597, -2.0091434, -2.5991411, -0.2610993, -4.740019, -4.050769, 0.09611528]
Target sample: 13, Prediction:1, Target's Score:[-0.2771859, 10.781884, -2.4359612, 0.8788004, -3.555794, -4.008199, 5.76682, -4.287318, -0.11963335, -2.300178]
Target sample: 19, Prediction:1, Target's Score:[0.7659521, 12.025411, -3.0946364, 1.2475606, -3.122356, -3.4359305, 0.9621115, -3.0666885, 0.9569807, -2.7647853]
Target sample: 25, Prediction:9, Target's Score:[-2.226049, -0.4315285, 0.4757806, 3.8003697, -4.2946744, -2.3106174, 2.9592211, -0.86522084, -1.1194432, 4.426063]
Target sample: 31, Prediction:1, Target's Score:[0.7438712, 12.0048, -4.8077774, 0.25642183, -3.221411, -3.2678015, 1.6495489, -4.053698, -1.5554498, 2.7186103]
Target sample: 37, Prediction:1, Target's Score:[0.7897484, 12.608494, -4.4018116, 2.230163, -4.0940557, -3.4992173, 4.890331, -5.8290486, -2.250296, 0.02759015]
Target sample: 43, Prediction:1, Target's Score:[1.0157185, 11.102655, -3.3267865, 0.37498814, -4.759041, -3.8769534, 5.7609167, -4.3036184, 1.160343, -2.7258928]
Target sample: 49, Prediction:1, Target's Score:[-0.19427094, 11.603465, -4.2728133, 4.971519, -4.721271, -3.4696333, 4.667685, -6.526437, 0.6884073, -2.2576158]
Target sample: 55, Prediction:3, Target's Score:[0.15907708, 3.706856, -0.3077951, 5.659721, -1.8753489, -3.264058, 5.4316134, -5.620916, -2.3365846, -1.1410588]
Target sample: 61, Prediction:9, Target's Score:[2.0101418, 3.2379847, -2.2624934, 4.138396, -2.6100342, -3.5948236, 1.9764677, -5.254129, -2.0144658, 4.808072]
Target sample: 67, Prediction:6, Target's Score:[-0.17323717, 8.1364155, -3.9337094, 2.3802876, -4.5020556, -2.3901467, 8.678693, -5.5756063, -3.4184768, 1.2056286]
Target sample: 73, Prediction:1, Target's Score:[0.3548276, 7.636689, -6.667219, 3.0383422, -3.983101, -3.8669703, 4.9578366, -4.8373914, -0.8613117, 4.6845036]
Target sample: 79, Prediction:1, Target's Score:[2.3759494, 8.673271, -5.973882, 3.0671787, -5.130991, -3.791766, 4.7660646, -4.458438, 0.9046185, -0.0060407575]
Target sample: 85, Prediction:3, Target's Score:[-0.13972062, 6.156147, -0.06671907, 6.6056314, -3.9003232, -2.3040888, 5.0440087, -4.8432665, -4.674274, -1.4336065]
Target sample: 91, Prediction:1, Target's Score:[-0.074015215, 13.224759, -4.843934, 2.6082697, -3.8227944, -2.756297, 3.866862, -5.466108, -5.2313075, 3.0318701]
Target sample: 97, Prediction:3, Target's Score:[0.17499405, 4.534562, 0.4037571, 6.525839, 0.09890953, -4.0694413, -0.02828446, -3.58761, -1.407076, -2.1872213]
Target sample: 103, Prediction:3, Target's Score:[-0.6098166, 2.480346, 1.6735369, 8.408846, 0.79882824, -3.462823, 2.7952232, -6.359786, -4.2306666, -1.0195808]
Current ATTACK acc on target samples: 5.556
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 21:51:38 Epoch 59, Val iteration 0, acc 89.200 (89.200)
2021-06-11 21:51:42 Epoch 59, Val iteration 19, acc 90.400 (89.580)
* Prec: 89.5800006866455
Per class accuracy =  [0.92499453 0.92526209 0.842597   0.82790783 0.89240943 0.82645667
 0.94191166 0.89152723 0.93393314 0.94717016]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 3, 3, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 6, 6, 3, 1, 1, 1, 1, 1, 6, 1, 9, 3, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 3, 1, 3
ATTACK acc: 13.953488372093023
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 21:51:46, Val iteration 0, acc 96.200 (96.200)
2021-06-11 21:51:53, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-11 21:51:56, Epoch 0, Iteration 7, loss 0.699 (0.897), acc 78.846 (77.200)
2021-06-11 21:52:28, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[1.7576332, 4.297312, -4.1474566, 1.9309407, 0.006623969, -2.7620785, 2.384244, -2.1040094, -0.6987888, -0.705763]
Target sample: 7, Prediction:1, Target's Score:[-2.5934148, 3.7290287, -2.6955116, 2.3379333, 0.6220158, -2.889006, 3.3190565, -2.8705776, 2.5322943, -1.5514112]
Target sample: 13, Prediction:1, Target's Score:[-2.8183737, 5.551242, -3.5807757, 1.2819487, -3.141969, -0.97131777, 4.0894127, -2.3768072, 2.0021994, -0.07114494]
Target sample: 19, Prediction:6, Target's Score:[-3.7828414, 5.407419, -5.103276, 5.306491, -2.0910742, -3.2117598, 7.8724117, -2.1893754, -0.19690661, -2.081932]
Target sample: 25, Prediction:3, Target's Score:[-4.4134727, 0.9619199, 1.3387905, 2.9625788, -1.9119492, 0.11022975, 0.41791221, 1.9149636, -1.3507622, -0.07053357]
Target sample: 31, Prediction:1, Target's Score:[-1.8346683, 10.843731, -5.0549097, -0.1806212, -1.2818795, -1.2039727, 2.5862198, -2.691016, -0.93473196, -0.2693922]
Target sample: 37, Prediction:1, Target's Score:[-0.67683095, 6.967019, -3.7764463, 5.1305485, -2.1993554, -1.4697118, 5.2017164, -3.9960155, -2.9853847, -2.2396145]
Target sample: 43, Prediction:6, Target's Score:[-3.6849592, 5.092878, -3.566728, 0.7741742, -3.3641753, -0.55991083, 7.0932326, -1.4231697, 0.7916554, -1.1977196]
Target sample: 49, Prediction:8, Target's Score:[0.34495845, 0.059144273, -4.0621333, 0.22477892, -1.1669143, -1.7154363, 3.2647839, -2.382217, 7.158193, -1.7906263]
Target sample: 55, Prediction:8, Target's Score:[-1.5871658, 0.4676318, -5.022821, 1.03753, -0.4049228, -2.4564445, 2.8685563, -1.4511291, 7.502093, -1.0250797]
Target sample: 61, Prediction:1, Target's Score:[-1.6194587, 7.446107, -4.8686795, 2.4443207, -1.7551137, -2.894221, 1.995294, -1.6806513, 0.23210944, 0.6671385]
Target sample: 67, Prediction:6, Target's Score:[-2.400635, 5.0295067, -3.9844449, 0.6832576, -2.1650774, 0.100753136, 9.16949, -2.105353, -2.0910482, -2.2852304]
Target sample: 73, Prediction:1, Target's Score:[-0.69109637, 6.840655, -4.840737, -0.4607534, -2.3425088, -0.642211, 5.063789, -1.9361666, 0.40718067, -1.435183]
Target sample: 79, Prediction:1, Target's Score:[0.98821914, 8.28936, -5.7619576, -0.22085375, -2.423851, -1.7056978, 4.9739966, -2.7487855, -0.47218937, -0.9558626]
Target sample: 85, Prediction:1, Target's Score:[-3.085537, 6.2090425, -3.4877076, 3.1174445, -1.9295001, -1.4987084, 5.799225, -2.8068726, -2.174639, -0.17835855]
Target sample: 91, Prediction:1, Target's Score:[-2.326645, 7.486167, -4.121396, 1.3079997, -1.4623542, -2.73174, 4.5161524, -2.6938407, 0.52680063, -0.5436086]
Target sample: 97, Prediction:8, Target's Score:[0.9206713, -0.13930349, -3.6750286, 2.1256046, 1.5473408, -2.6385431, 3.1311224, -2.5586953, 3.6553469, -2.439969]
Target sample: 103, Prediction:8, Target's Score:[-2.1580255, 1.0410248, -3.4419668, 2.9404294, -0.48178852, -2.2131155, 4.0107074, -3.0491645, 5.0133424, -1.7289758]
Current ATTACK acc on target samples: 16.667
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 21:53:00 Epoch 59, Val iteration 0, acc 91.800 (91.800)
2021-06-11 21:53:07 Epoch 59, Val iteration 19, acc 92.800 (92.760)
* Prec: 92.76000137329102
Per class accuracy =  [0.95433266 0.95523866 0.86732127 0.8640263  0.94503658 0.87387816
 0.97228262 0.94384961 0.94837374 0.94841391]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 8, 1, 8, 8, 6, 8, 8, 6, 6, 1, 1, 1, 1, 6, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 6, 6, 6, 6, 1, 6, 6, 8, 6, 8, 8, 6, 8, 8, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 1, 6, 6, 6, 6, 6, 3, 6, 6, 6, 1, 8, 8, 8, 1, 6
ATTACK acc: 34.883720930232556
--------
------SUMMARY PRE DEFENSE------
TIME ELAPSED (mins): 11
TARGET INDEX: 9
ResNet50 55.55555555555556 48.83720930232558 95.46000137329102 92.86000137329101
DPN92 72.22222222222223 68.6046511627907 95.50000267028808 93.45000076293945
MobileNetV2 5.555555555555555 13.953488372093023 91.22000160217286 89.5800006866455
GoogLeNet 16.666666666666668 34.883720930232556 95.41000213623047 92.76000137329102
DEFENSE EVALUATION
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
ResNet50
[74, 80, 86, 89] 4
Using Adam for retraining
2000
poison index =  84
499
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 21:53:11, Val iteration 0, acc 94.200 (94.200)
2021-06-11 21:53:17, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-11 21:53:18, Epoch 0, Iteration 7, loss 0.390 (0.831), acc 88.462 (85.200)
2021-06-11 21:53:46, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6]
Target sample: 1, Prediction:1, Target's Score:[0.47078323, 8.69043, -2.5798018, -1.1931925, -3.5795746, -1.7332704, 2.0832894, -1.426807, -2.0936775, 1.3334895]
Target sample: 7, Prediction:6, Target's Score:[-0.87674326, 5.092306, -1.155273, -0.23050982, -2.300499, -1.9563626, 5.5110865, -0.6844424, -1.6317645, -1.7239125]
Target sample: 13, Prediction:1, Target's Score:[-0.37551045, 12.7759905, -2.3336368, -2.91759, -3.910031, -3.0058725, 4.415973, -0.39515597, -1.2094791, -3.042396]
Target sample: 19, Prediction:1, Target's Score:[-0.45461684, 12.697388, -2.2312546, -1.3303083, -3.78978, -2.723923, 4.0643616, -1.9128143, -1.4677563, -2.8745365]
Target sample: 25, Prediction:6, Target's Score:[-2.02429, -1.4537724, 0.15537746, 3.482108, -1.081214, -1.2520075, 6.2911496, -1.1820174, -1.7379946, -1.1579527]
Target sample: 31, Prediction:1, Target's Score:[-0.12209369, 12.549403, -0.92115164, -3.5889153, -3.597163, -3.068005, 4.533644, 0.17629723, -2.0640328, -3.9186597]
Target sample: 37, Prediction:6, Target's Score:[-1.1472324, 2.2873964, -1.3497986, 3.7871902, -2.0521598, -0.3943859, 6.227765, -2.668115, -2.1335795, -2.521712]
Target sample: 43, Prediction:1, Target's Score:[-1.4937242, 9.790275, -1.2649388, -1.8638123, -3.2270846, -2.0735314, 5.6529846, -0.92873436, -1.676843, -2.8825486]
Target sample: 49, Prediction:1, Target's Score:[-0.5091578, 6.7137747, -2.4789364, -1.2947993, -2.6374712, -2.4151988, 3.9887125, -0.67215365, 0.9033334, -1.571439]
Target sample: 55, Prediction:6, Target's Score:[-1.0162306, 3.846595, -1.2959476, -1.5522654, -1.9885417, -2.3358817, 5.677952, -1.3938872, -1.8013749, 1.9319683]
Target sample: 61, Prediction:1, Target's Score:[-0.8479596, 9.469203, -2.2151663, -1.3413486, -3.1565547, -2.1173818, 3.6318436, -1.8921576, -2.417234, 0.88771254]
Target sample: 67, Prediction:1, Target's Score:[-1.8564237, 6.8389764, -0.8501131, -1.2689538, -2.1234465, -2.3028958, 6.2789354, -1.8403381, -1.7778182, -1.0313641]
Target sample: 73, Prediction:6, Target's Score:[-0.14030436, 5.3666067, -1.3932384, -1.6091179, -2.0375807, -2.294614, 6.133519, -1.2906064, -1.2110014, -1.4387681]
Target sample: 79, Prediction:1, Target's Score:[0.5788906, 8.066571, -1.2631718, -2.252458, -2.8412979, -2.4047182, 4.618895, -0.8496923, -0.9604573, -2.6580067]
Target sample: 85, Prediction:1, Target's Score:[-1.3745325, 7.2958755, -0.14948948, -0.9487265, -2.5028317, -2.2124548, 5.8082786, -2.166906, -2.4120464, -1.299902]
Target sample: 91, Prediction:1, Target's Score:[-1.4199973, 9.216798, -1.1909653, 0.57304835, -3.3605008, -1.5596421, 4.2192254, -2.5253236, -3.3544846, -0.6268783]
Target sample: 97, Prediction:1, Target's Score:[0.29722667, 5.072532, -1.2137723, -1.3538444, -2.171724, -2.034836, 4.6198683, -0.86489785, -1.2070612, -1.0941089]
Target sample: 103, Prediction:6, Target's Score:[-0.256375, 4.2006474, -0.95076114, -1.4970521, -1.836196, -2.1508918, 5.637573, -1.076635, -0.4825606, -1.5110077]
Current ATTACK acc on target samples: 33.333
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 21:54:14 Epoch 59, Val iteration 0, acc 90.800 (90.800)
2021-06-11 21:54:20 Epoch 59, Val iteration 19, acc 91.800 (90.790)
* Prec: 90.79000244140624
Per class accuracy =  [0.90327485 0.96389951 0.82073958 0.81366174 0.93529614 0.89348294
 0.93548735 0.91598109 0.95116428 0.94628512]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 1, 6, 1, 1, 1, 1, 1, 1, 6, 6, 1, 6, 6, 1, 9, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 6, 1, 6, 1, 1, 1, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 6, 1, 1
ATTACK acc: 25.58139534883721
DPN92
[74, 80, 86, 89] 26
Using Adam for retraining
2000
poison index =  84
499
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 21:54:23, Val iteration 0, acc 94.800 (94.800)
2021-06-11 21:54:35, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-11 21:54:38, Epoch 0, Iteration 7, loss 0.392 (0.548), acc 88.462 (88.400)
2021-06-11 21:56:03, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6]
Target sample: 1, Prediction:1, Target's Score:[-0.4689971, 13.750196, -3.8335118, -2.6528194, -2.123212, -2.677446, -1.3939738, -2.2716432, 1.0621591, 0.87301254]
Target sample: 7, Prediction:1, Target's Score:[-2.411169, 11.572295, -3.6114285, -2.236562, -1.6275121, -4.145846, 0.7011158, -1.6715918, 5.213718, -1.5465802]
Target sample: 13, Prediction:1, Target's Score:[-1.8512368, 13.2517605, -4.268459, -3.0900443, -2.4861639, -4.0492277, 0.64939564, -1.4932653, 4.6821632, -1.0970205]
Target sample: 19, Prediction:1, Target's Score:[-1.7261215, 16.575306, -3.8909674, -2.2421746, -2.6829147, -4.2548857, -1.0471165, -2.4222662, 0.9825172, 0.9740369]
Target sample: 25, Prediction:3, Target's Score:[-2.8071578, -0.52761513, -0.8624427, 4.6950126, -1.1537044, 0.82257783, -0.21523154, 4.1005487, -1.2644306, -2.6469684]
Target sample: 31, Prediction:1, Target's Score:[-1.1285865, 16.186394, -4.399301, -2.4510345, -2.5507538, -4.055673, -0.85603386, -2.3319874, 0.59016263, 1.2564887]
Target sample: 37, Prediction:1, Target's Score:[-1.4228532, 13.555073, -3.014426, -2.0233772, -2.0591831, -3.4476278, -0.34049335, -2.3565931, 0.8179004, 0.51934624]
Target sample: 43, Prediction:1, Target's Score:[-1.7920667, 13.165499, -3.628171, -3.5095582, -1.8992693, -3.4213765, 1.0905162, -2.008361, 3.6067855, -1.370238]
Target sample: 49, Prediction:1, Target's Score:[-1.1783949, 10.59242, -3.9143035, -1.4904892, -2.2947643, -4.2667694, 0.65869576, -0.56656456, 4.2859592, -1.5904001]
Target sample: 55, Prediction:1, Target's Score:[0.101470254, 6.6878767, -2.4980137, -1.6544569, -2.5607107, -3.3132203, 0.041499384, -0.0795501, 4.860076, -1.3492202]
Target sample: 61, Prediction:1, Target's Score:[-1.2066089, 14.762031, -4.427025, -1.5613562, -2.692656, -4.244227, -0.37914184, -2.1630242, 1.8233497, 0.36024258]
Target sample: 67, Prediction:1, Target's Score:[-1.0973535, 13.745609, -4.0650196, -2.0039203, -2.600157, -4.448599, 1.1172197, -1.8106146, 0.8789447, 0.53312474]
Target sample: 73, Prediction:8, Target's Score:[0.31684893, 4.7820807, -3.590745, -1.0352534, -2.0131145, -4.689252, 4.388517, -0.87951356, 4.866636, -1.8880291]
Target sample: 79, Prediction:1, Target's Score:[-1.3026354, 13.263694, -4.016389, -2.147109, -2.5903563, -4.102498, 0.93083125, -1.8669302, 1.8174474, 0.257725]
Target sample: 85, Prediction:1, Target's Score:[-0.76059324, 14.703235, -3.5563488, -1.8870307, -2.7340617, -4.7813125, 0.27525702, -2.6425571, 0.51220655, 1.14554]
Target sample: 91, Prediction:1, Target's Score:[-1.1071188, 14.451731, -4.4092345, -1.9629227, -2.6921704, -3.1687284, -0.6570756, -2.1405556, 1.3118532, 0.63820356]
Target sample: 97, Prediction:1, Target's Score:[0.39301217, 7.4573817, -3.1981564, -2.3354123, -1.7888783, -4.0990024, 0.17758366, -0.05666607, 5.310728, -1.6141297]
Target sample: 103, Prediction:1, Target's Score:[-1.5200846, 10.94304, -3.0486286, -2.8415205, -1.5128367, -4.4977922, 0.4940036, -1.8734618, 6.464894, -2.370822]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 21:57:27 Epoch 59, Val iteration 0, acc 92.200 (92.200)
2021-06-11 21:57:39 Epoch 59, Val iteration 19, acc 93.200 (93.460)
* Prec: 93.46000137329102
Per class accuracy =  [0.94398791 0.97652866 0.8852584  0.85505958 0.96429528 0.89657485
 0.95900017 0.95603777 0.97208011 0.93776279]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
MobileNetV2
[80, 86, 89] 46
Using Adam for retraining
2000
poison index =  74
poison index =  84
498
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 21:57:41, Val iteration 0, acc 92.600 (92.600)
2021-06-11 21:57:45, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-11 21:57:45, Epoch 0, Iteration 7, loss 0.400 (0.288), acc 92.308 (90.800)
2021-06-11 21:58:00, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6]
Target sample: 1, Prediction:1, Target's Score:[-0.35849664, 14.218348, -4.5219216, 0.003821686, -3.9698682, -3.075591, 0.21969493, -3.1921701, -1.473636, 2.8758967]
Target sample: 7, Prediction:1, Target's Score:[2.753733, 7.716568, -1.2851701, 4.9956727, -2.7891464, -2.2182653, -1.5476058, -4.5100927, -3.932987, 1.4480367]
Target sample: 13, Prediction:1, Target's Score:[0.47851393, 13.864083, -3.178088, -0.30966935, -4.338652, -4.3234806, 1.8218265, -3.8528295, 0.9331426, -0.46817532]
Target sample: 19, Prediction:1, Target's Score:[1.3886198, 12.997955, -3.1324375, 0.19563654, -3.242956, -3.3820593, -1.348135, -2.6508152, 1.4282322, -1.6742641]
Target sample: 25, Prediction:9, Target's Score:[-2.4909697, 0.77064556, -0.9218847, 3.6039774, -4.9498525, -1.8189858, 1.195113, -0.26273292, -0.14701775, 5.579865]
Target sample: 31, Prediction:1, Target's Score:[0.68680537, 13.355151, -5.1373687, -0.35927844, -3.3450556, -3.428022, -0.2819097, -3.9153945, -0.80691725, 3.9276931]
Target sample: 37, Prediction:1, Target's Score:[1.3991383, 14.277282, -5.0625143, 1.2983752, -4.447098, -3.7790873, 2.384204, -5.352269, -1.7319312, 1.7236354]
Target sample: 43, Prediction:1, Target's Score:[1.646336, 13.380647, -3.7753632, -0.8555534, -5.2369227, -4.102467, 2.3692636, -3.5374303, 1.6840879, -1.0029676]
Target sample: 49, Prediction:1, Target's Score:[0.11355528, 14.617348, -5.045116, 3.9567373, -5.3394933, -3.709297, 1.364054, -6.169711, 1.3497906, -0.41214728]
Target sample: 55, Prediction:1, Target's Score:[0.084362864, 6.1168923, -1.4411001, 4.845721, -2.6948278, -3.168529, 3.046057, -5.216497, -2.0581334, 1.1132411]
Target sample: 61, Prediction:9, Target's Score:[2.3270762, 4.7316055, -3.4023848, 3.4766498, -3.217631, -3.6127155, -0.3325562, -4.7266674, -1.3031454, 6.7153163]
Target sample: 67, Prediction:1, Target's Score:[0.06855121, 10.136101, -4.5752826, 0.92711055, -4.931641, -2.7176065, 6.6345806, -5.3145065, -2.8212688, 3.2746792]
Target sample: 73, Prediction:1, Target's Score:[-0.24392125, 9.928261, -7.4126005, 1.9842186, -4.8406363, -4.2598724, 3.5397408, -4.792564, -0.30098176, 7.169587]
Target sample: 79, Prediction:1, Target's Score:[2.722725, 10.099106, -5.902524, 1.7404128, -5.66557, -4.3302164, 2.9978666, -4.4515986, 2.097261, 1.309656]
Target sample: 85, Prediction:1, Target's Score:[0.929801, 9.019436, -1.2800064, 5.0483975, -4.9788537, -2.2183118, 1.9516587, -4.5657735, -3.4606102, 0.19094212]
Target sample: 91, Prediction:1, Target's Score:[0.3234059, 14.866165, -5.3239007, 1.5006893, -4.110346, -2.8951638, 1.2575569, -4.998923, -5.0015225, 5.235696]
Target sample: 97, Prediction:3, Target's Score:[-0.116392046, 5.940115, -0.492405, 6.320297, -1.1377919, -3.6919565, -1.8123714, -3.2022443, -1.2008932, 0.009334628]
Target sample: 103, Prediction:3, Target's Score:[-0.4639586, 4.408162, 0.40099293, 7.7577624, -0.06276126, -3.309683, 1.2300761, -6.0615377, -3.6682396, 0.45473164]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 21:58:15 Epoch 59, Val iteration 0, acc 89.800 (89.800)
2021-06-11 21:58:19 Epoch 59, Val iteration 19, acc 89.600 (89.560)
* Prec: 89.56000175476075
Per class accuracy =  [0.92222176 0.93310227 0.8455224  0.83205029 0.89043894 0.82180986
 0.93913476 0.89012391 0.9317411  0.94597567]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 9, 1, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 9, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1
ATTACK acc: 2.3255813953488373
GoogLeNet
[74, 80, 86, 89] 21
Using Adam for retraining
2000
poison index =  84
499
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 21:58:22, Val iteration 0, acc 96.200 (96.200)
2021-06-11 21:58:28, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-11 21:58:29, Epoch 0, Iteration 7, loss 0.663 (0.595), acc 76.923 (85.400)
2021-06-11 21:59:02, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6]
Target sample: 1, Prediction:1, Target's Score:[1.195661, 7.2611723, -3.1552536, 0.5523079, -1.0556911, -3.4537754, -2.064387, -2.3533916, 1.0841801, 2.0221364]
Target sample: 7, Prediction:1, Target's Score:[-2.162412, 6.466199, -2.1594157, 0.845305, 0.101650625, -4.7478266, 0.32048947, -2.2900288, 3.5958743, 0.058069237]
Target sample: 13, Prediction:1, Target's Score:[-1.3820966, 10.65719, -3.5506542, -0.5200634, -3.289437, -3.8785248, -0.42809656, -2.207244, 3.7802196, 0.84657526]
Target sample: 19, Prediction:1, Target's Score:[-2.6013885, 11.171554, -5.045437, 3.2022653, -2.572692, -4.778332, 2.8119576, -2.4704077, 0.4341261, -0.114743344]
Target sample: 25, Prediction:3, Target's Score:[-2.8537114, 2.117203, -3.5044749, 2.7673123, -0.6470321, -0.12945454, 0.7508933, 0.4928434, -1.7078106, 2.7519617]
Target sample: 31, Prediction:1, Target's Score:[0.003174203, 14.412601, -4.3323293, -1.339533, -1.4004258, -4.226541, -0.83500534, -2.5928257, -0.2854409, 0.6312119]
Target sample: 37, Prediction:1, Target's Score:[0.211778, 12.300762, -4.1971216, 2.6311786, -2.5805268, -4.407731, 1.7056748, -3.2138357, -1.8534805, -0.55235004]
Target sample: 43, Prediction:1, Target's Score:[-3.117128, 12.102015, -3.623825, -0.05871332, -3.5812044, -3.7132096, 0.82071686, -1.7021248, 2.2256017, 0.6760895]
Target sample: 49, Prediction:8, Target's Score:[0.8225561, 3.7199721, -3.6223643, -1.5205382, -2.8303576, -4.036175, -0.20213722, -1.8740875, 8.340629, 1.2189085]
Target sample: 55, Prediction:8, Target's Score:[-0.022215946, 2.7891023, -3.886202, -0.0068874992, -1.4430581, -4.309779, -0.21696392, -2.224956, 7.4755025, 1.8665425]
Target sample: 61, Prediction:1, Target's Score:[-1.2187108, 10.951289, -4.33757, -0.27575722, -2.125229, -4.2448378, -1.4151782, -1.676725, 1.9336964, 2.4419584]
Target sample: 67, Prediction:1, Target's Score:[-2.1748562, 9.38642, -4.548914, 0.626595, -2.8150532, -4.0499988, 5.2751284, -1.5093863, -0.31755748, 0.15690017]
Target sample: 73, Prediction:1, Target's Score:[3.197805, 8.27126, -4.830468, -1.2555908, -2.7954178, -4.9391766, 2.2106397, -0.44878528, 0.63788867, -0.009591214]
Target sample: 79, Prediction:1, Target's Score:[3.271793, 11.49119, -5.3783197, -1.5839578, -3.3410954, -5.1733894, 1.4396709, -1.3285052, 0.019235771, 0.6246313]
Target sample: 85, Prediction:1, Target's Score:[-2.5031617, 11.068132, -3.8609347, 2.6617947, -2.3532743, -3.9250016, 1.4680399, -2.7266488, -0.90165406, 1.1095481]
Target sample: 91, Prediction:1, Target's Score:[-3.1799264, 12.231118, -3.5716763, 1.1159803, -2.7894547, -4.027196, -0.8770121, -3.011797, 2.3079634, 1.8358362]
Target sample: 97, Prediction:8, Target's Score:[1.4515471, 3.1727965, -2.4661224, 1.6397651, -0.35349202, -4.3193936, -0.019616233, -2.3169177, 3.7887168, -0.5519388]
Target sample: 103, Prediction:8, Target's Score:[-1.3632733, 4.280877, -2.288752, 1.2867233, -0.7268359, -4.077476, 0.24838732, -2.6362948, 5.157327, 0.14078999]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 21:59:34 Epoch 59, Val iteration 0, acc 93.400 (93.400)
2021-06-11 21:59:41 Epoch 59, Val iteration 19, acc 93.400 (93.100)
* Prec: 93.10000038146973
Per class accuracy =  [0.95864579 0.96973123 0.86653195 0.83064462 0.96246722 0.92038203
 0.96609709 0.93681275 0.95732527 0.94231979]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 1, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 8, 8, 8, 1, 8
ATTACK acc: 0.0
------SUMMARY POST DEFENSE------
TIME ELAPSED (mins): 11
TARGET INDEX: 9
ResNet50 33.333333333333336 25.58139534883721 95.46000137329102 90.79000244140624 80.0
DPN92 0.0 0.0 95.50000267028808 93.46000137329102 80.0
MobileNetV2 0.0 2.3255813953488373 91.22000160217286 89.56000175476075 60.0
GoogLeNet 0.0 0.0 95.41000213623047 93.10000038146973 80.0
True False False False True
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.300-droplayer0.000.t7
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
No specific indices are determined, so try to include whatever we find
In total, we found 142 images of target 10
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133, 139]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', eval_poisons_root='', feat_reg_flag=False, gpu='1', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=10, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/10/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133, 139]
# Targets: 24, # Poisons: 5
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 22:00:00 Iteration 0 	 Training Loss: 9.462e-01 	 Loss in Target Net: 1.076e+00	  
 2021-06-11 22:00:34 Iteration 50 	 Training Loss: 4.333e-01 	 Loss in Target Net: 3.890e-01	  
 2021-06-11 22:01:08 Iteration 100 	 Training Loss: 4.041e-01 	 Loss in Target Net: 3.663e-01	  
 2021-06-11 22:01:44 Iteration 150 	 Training Loss: 3.913e-01 	 Loss in Target Net: 3.449e-01	  
 2021-06-11 22:02:18 Iteration 200 	 Training Loss: 3.794e-01 	 Loss in Target Net: 3.505e-01	  
 2021-06-11 22:02:52 Iteration 250 	 Training Loss: 3.774e-01 	 Loss in Target Net: 3.589e-01	  
 2021-06-11 22:03:24 Iteration 300 	 Training Loss: 3.811e-01 	 Loss in Target Net: 3.571e-01	  
 2021-06-11 22:03:58 Iteration 350 	 Training Loss: 3.790e-01 	 Loss in Target Net: 3.487e-01	  
 2021-06-11 22:04:32 Iteration 400 	 Training Loss: 3.753e-01 	 Loss in Target Net: 3.484e-01	  
 2021-06-11 22:05:07 Iteration 450 	 Training Loss: 3.770e-01 	 Loss in Target Net: 3.448e-01	  
 2021-06-11 22:05:45 Iteration 500 	 Training Loss: 3.727e-01 	 Loss in Target Net: 3.457e-01	  
 2021-06-11 22:06:22 Iteration 550 	 Training Loss: 3.766e-01 	 Loss in Target Net: 3.459e-01	  
 2021-06-11 22:06:57 Iteration 600 	 Training Loss: 3.728e-01 	 Loss in Target Net: 3.522e-01	  
 2021-06-11 22:07:33 Iteration 650 	 Training Loss: 3.714e-01 	 Loss in Target Net: 3.479e-01	  
 2021-06-11 22:08:07 Iteration 700 	 Training Loss: 3.752e-01 	 Loss in Target Net: 3.519e-01	  
 2021-06-11 22:08:42 Iteration 750 	 Training Loss: 3.713e-01 	 Loss in Target Net: 3.523e-01	  
 2021-06-11 22:09:17 Iteration 800 	 Training Loss: 3.681e-01 	 Loss in Target Net: 3.652e-01	  
 2021-06-11 22:09:53 Iteration 850 	 Training Loss: 3.718e-01 	 Loss in Target Net: 3.480e-01	  
 2021-06-11 22:10:28 Iteration 900 	 Training Loss: 3.707e-01 	 Loss in Target Net: 3.539e-01	  
 2021-06-11 22:11:03 Iteration 950 	 Training Loss: 3.740e-01 	 Loss in Target Net: 3.694e-01	  
 2021-06-11 22:11:37 Iteration 999 	 Training Loss: 3.722e-01 	 Loss in Target Net: 3.491e-01	  
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 22:11:41, Val iteration 0, acc 94.200 (94.200)
2021-06-11 22:11:46, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-11 22:11:49, Epoch 0, Iteration 7, loss 0.259 (0.400), acc 92.308 (93.400)
2021-06-11 22:12:17, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.8074412, 0.98983014, -1.8141994, -0.23747265, -2.0454733, 1.4552772, 4.946051, -2.258633, 1.193907, -0.23252504]
Target sample: 7, Prediction:6, Target's Score:[-1.5025471, 1.4230229, -1.2686123, -1.0405066, -2.363968, -0.62836516, 6.5313196, -2.0676584, 2.9173362, -1.7898346]
Target sample: 13, Prediction:6, Target's Score:[-1.7233912, 0.6468279, -1.2497635, -0.60238767, -1.9897969, -1.0288914, 7.6661415, -2.4201567, 1.1621397, -0.23574059]
Target sample: 19, Prediction:6, Target's Score:[-2.1331542, -0.068803556, -0.16291766, -0.37878826, -1.7930793, -0.3885965, 8.669148, -2.233783, -0.61560607, -0.6689276]
Target sample: 25, Prediction:1, Target's Score:[-2.1883636, 5.7502894, -0.8407682, -0.57154846, -2.4554849, -0.5875802, 4.7137, -2.3244045, -0.53969, -0.71015084]
Target sample: 31, Prediction:6, Target's Score:[-2.491481, 3.4910398, 0.0034231886, 0.6309936, -1.1808995, -0.010683442, 4.0688367, -2.476259, -0.8686151, -0.9728606]
Target sample: 37, Prediction:9, Target's Score:[-1.5808038, 1.9972667, -1.9717013, -0.32270887, -1.3813884, 0.00565924, 2.6214225, -2.2779958, -0.25341886, 3.3558905]
Target sample: 43, Prediction:6, Target's Score:[-1.9346625, 2.50515, -0.44834337, 0.08300881, -1.7250369, -1.2208513, 5.0025167, -1.9106967, -0.019111652, -0.13995908]
Target sample: 49, Prediction:6, Target's Score:[-2.1858928, 2.7140524, -0.8283714, 0.051805176, -1.8869032, -0.46877295, 4.610458, -1.8689333, 0.5217714, -0.46950597]
Target sample: 55, Prediction:1, Target's Score:[-2.6368647, 5.8367357, 0.9038482, 0.12585352, -3.0520477, -1.2283207, 4.443893, -0.66178006, -1.4044547, -2.064302]
Target sample: 61, Prediction:6, Target's Score:[-2.3934777, 0.40874028, -0.49287072, 0.6969178, -1.396698, -0.65328115, 5.7662625, -2.2001464, -1.1252836, 1.5844425]
Target sample: 67, Prediction:6, Target's Score:[-2.1093993, 1.1664275, -1.2848454, 0.0135548245, -1.5085737, 1.4114285, 3.6408236, -1.7426664, -0.515544, 1.1062193]
Target sample: 73, Prediction:1, Target's Score:[-1.8414614, 7.2654414, -1.9659638, -0.47407383, -2.5739615, -0.898411, 2.2364316, -2.1475577, 2.474023, -1.8509713]
Target sample: 79, Prediction:6, Target's Score:[-1.6430719, 2.6632214, -0.55765194, -0.38965872, -1.9811306, -0.41640773, 5.1480823, -2.0602977, 1.6027664, -2.1820657]
Target sample: 85, Prediction:6, Target's Score:[-2.143294, 0.22500876, 0.48371667, 0.10112075, -1.4318377, -0.6513138, 6.166248, -2.1344435, -0.16676842, -0.2651165]
Target sample: 91, Prediction:6, Target's Score:[-2.1013606, 3.4481704, 0.6244448, -0.92530084, -2.003636, -1.2779586, 6.2978077, -2.036928, -0.65481484, -1.1388162]
Target sample: 97, Prediction:6, Target's Score:[-2.5222259, 2.6350603, -1.1479108, 0.6670748, -1.7937001, 1.44909, 4.0014477, -2.527905, -1.0567733, 0.4993769]
Target sample: 103, Prediction:6, Target's Score:[-0.5237506, 0.07027949, -0.15794837, -0.819429, -1.5858057, -1.0730726, 4.524845, -2.0835989, 1.8907436, -0.08626157]
Target sample: 109, Prediction:6, Target's Score:[-1.7423266, 3.0021524, 0.096720956, -0.23929232, -1.5549378, -1.1170832, 4.959609, -2.291414, 0.0143119795, -0.9292826]
Target sample: 115, Prediction:6, Target's Score:[-1.8786678, 2.4813616, -1.4315495, -0.042138733, -1.6771107, 0.91168386, 3.451413, -2.5632968, -0.07375524, 1.0176977]
Target sample: 121, Prediction:6, Target's Score:[-2.248992, 3.342206, -0.24462618, 0.24397576, -1.9098461, -0.95736593, 5.118817, -2.1735659, -0.27268854, -0.68267274]
Target sample: 127, Prediction:6, Target's Score:[-2.6283693, 3.8797293, -0.91285026, 0.68446195, -1.8228453, -0.737302, 5.104755, -2.4010763, -0.86965734, -0.070508875]
Target sample: 133, Prediction:5, Target's Score:[-2.8477857, 0.4499411, -2.3427565, -0.6215728, -1.0518308, 3.9547062, 2.8823783, -1.9687603, 0.54745305, 1.1924316]
Target sample: 139, Prediction:6, Target's Score:[-2.0057065, -0.24012938, -1.9077227, -0.09367009, -1.888439, 0.68332255, 6.433019, -2.2775934, 1.3234069, 0.17419164]
Current ATTACK acc on target samples: 79.167
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 22:12:44 Epoch 59, Val iteration 0, acc 89.400 (89.400)
2021-06-11 22:12:50 Epoch 59, Val iteration 19, acc 91.200 (90.330)
* Prec: 90.33000144958496
Per class accuracy =  [0.88740807 0.95867873 0.81489596 0.84587947 0.88475911 0.87388318
 0.95910714 0.90952451 0.95129168 0.94657626]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 6, 1, 1, 1, 9, 1, 1, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 8, 8, 6, 6, 1, 1, 6, 6, 1, 1, 6, 1, 9, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 74.57627118644068
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 22:12:57, Val iteration 0, acc 94.800 (94.800)
2021-06-11 22:13:09, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-11 22:13:16, Epoch 0, Iteration 7, loss 0.496 (0.355), acc 90.385 (91.600)
2021-06-11 22:14:42, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.5614451, 8.307573, -2.9262385, -2.7660272, -4.409607, -2.4826407, 5.5880284, -2.0431345, -0.05188117, 2.661751]
Target sample: 7, Prediction:6, Target's Score:[-0.64224595, 4.69882, -3.1795146, -1.997961, -3.7096484, -3.9136384, 9.027469, -1.9162383, 0.90746915, 1.0261855]
Target sample: 13, Prediction:6, Target's Score:[-0.10212817, 1.2139747, -3.4280696, -1.7046465, -1.5548514, -3.263692, 8.56469, -1.296257, 2.4250865, -0.5814376]
Target sample: 19, Prediction:6, Target's Score:[-1.631206, 3.7800264, -2.0870001, -1.9455485, -1.675323, -2.666537, 7.243681, -1.8953564, 1.5066124, -0.36455652]
Target sample: 25, Prediction:1, Target's Score:[-1.3319927, 9.324055, -3.042835, -1.5632743, -3.507316, -3.1769135, 5.2269526, -1.8405422, 0.1358267, 0.109851055]
Target sample: 31, Prediction:1, Target's Score:[-1.2134447, 8.990155, -2.4682424, -1.0864661, -2.9519565, -3.363812, 4.142671, -2.573851, 0.5971887, 0.2393978]
Target sample: 37, Prediction:1, Target's Score:[-0.9360011, 8.815881, -4.1494546, -2.02761, -3.486484, -3.5898082, 4.0001535, -3.5402853, 2.1656663, 3.0442564]
Target sample: 43, Prediction:1, Target's Score:[-1.0604742, 8.434912, -2.9150388, -1.801505, -3.1693654, -4.2746787, 3.9732637, -3.5859208, 2.3379633, 2.3546226]
Target sample: 49, Prediction:1, Target's Score:[-0.5017176, 8.221634, -2.4578211, -1.952838, -3.510406, -4.0900717, 4.5421677, -2.903208, 2.331321, 0.6208907]
Target sample: 55, Prediction:1, Target's Score:[-1.5525936, 7.8408327, -1.90267, 1.0163468, -4.16235, -2.8835692, 4.35661, -1.8706493, 0.8172684, -1.3220754]
Target sample: 61, Prediction:6, Target's Score:[0.1673956, 3.446058, -3.345768, 2.0777414, -3.395581, -1.8772593, 5.734327, -0.68655103, 0.2356877, -2.0599651]
Target sample: 67, Prediction:1, Target's Score:[-0.6379119, 4.2586226, -2.3462965, -1.3416307, -2.0787663, -2.4960194, 3.295716, -2.3725815, 1.1804452, 2.775588]
Target sample: 73, Prediction:1, Target's Score:[-1.6049395, 8.731458, -3.1681898, -1.5064652, -4.353118, -3.2310274, 4.6096373, -2.641451, 1.8048083, 1.6693354]
Target sample: 79, Prediction:1, Target's Score:[-1.9124967, 8.272117, -3.033404, -2.2654157, -3.6082144, -2.6425061, 6.76688, -2.0686617, 1.5780233, -0.75311655]
Target sample: 85, Prediction:6, Target's Score:[-3.212166, 2.8630521, -1.7800436, 0.035514843, 0.9650778, -2.1763806, 4.037174, -1.5003971, 0.8642731, 0.15836589]
Target sample: 91, Prediction:6, Target's Score:[-1.5367647, 6.359462, -2.646367, -1.168209, -2.1477664, -2.7801995, 6.540583, 0.0015770155, -0.63782215, -1.6493812]
Target sample: 97, Prediction:1, Target's Score:[-1.3717971, 8.193303, -3.4811258, -0.5572159, -3.2203896, -3.0591552, 4.948888, -2.78504, 1.4333209, 0.20382595]
Target sample: 103, Prediction:6, Target's Score:[-0.8885234, 4.449473, -3.06789, -0.88596183, -2.8585045, -3.3822281, 7.245336, -2.413302, 2.9890532, -0.9101]
Target sample: 109, Prediction:1, Target's Score:[-1.4438033, 8.269963, -2.8628182, -1.9173964, -2.9210443, -4.0241537, 6.7256837, -2.964352, 1.7803264, -0.3190843]
Target sample: 115, Prediction:6, Target's Score:[-1.2907149, 6.2010493, -2.86027, -1.4730995, -2.6704736, -3.4599679, 6.6765013, -2.9146261, 1.6536883, 0.42533407]
Target sample: 121, Prediction:1, Target's Score:[-1.4513943, 5.9926534, -2.1019251, 1.2863362, -3.1015863, -3.3449717, 5.842053, -2.4458618, 1.0600641, -1.429282]
Target sample: 127, Prediction:6, Target's Score:[-1.4390621, 2.9201498, -3.0049574, 1.5044632, -3.0284474, -2.1962872, 8.308914, -1.451502, 0.41543126, -1.7452073]
Target sample: 133, Prediction:8, Target's Score:[-1.866215, 3.7904403, -3.551579, -2.8293834, -2.0696542, -3.0889404, 4.2865252, -1.7565978, 5.58954, 1.7667451]
Target sample: 139, Prediction:6, Target's Score:[-0.091610484, 5.3779693, -3.3203485, -2.650428, -4.0325475, -3.7022529, 7.9180326, -2.3016412, 1.0581393, 2.0637457]
Current ATTACK acc on target samples: 41.667
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 22:16:07 Epoch 59, Val iteration 0, acc 91.000 (91.000)
2021-06-11 22:16:18 Epoch 59, Val iteration 19, acc 92.200 (92.330)
* Prec: 92.33000183105469
Per class accuracy =  [0.92538978 0.95772308 0.91045609 0.8283284  0.89843214 0.90451095
 0.95596658 0.93705971 0.97506314 0.94458277]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 1, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 1, 6, 6, 1, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6
ATTACK acc: 55.932203389830505
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 22:16:22, Val iteration 0, acc 92.600 (92.600)
2021-06-11 22:16:25, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-11 22:16:26, Epoch 0, Iteration 7, loss 0.342 (0.362), acc 86.538 (88.200)
2021-06-11 22:16:40, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:9, Target's Score:[-1.2133489, 1.8523936, -3.4411864, 1.1905968, -4.060303, -2.2891877, 3.3637824, -2.3719516, 2.1664355, 5.0680876]
Target sample: 7, Prediction:6, Target's Score:[-2.2825625, -0.7741753, -3.4929483, 4.0112224, -4.2288003, -1.4751031, 5.87503, -3.4965892, 1.6532514, 4.4630837]
Target sample: 13, Prediction:3, Target's Score:[-1.7989383, -2.9637082, -1.5672954, 4.8795295, -1.9790816, -2.3673239, 2.4309788, -1.6247609, 3.5905285, 1.6283518]
Target sample: 19, Prediction:3, Target's Score:[-3.206162, -0.32371348, -1.415017, 4.6069593, 1.4035528, -2.038231, 4.1936536, 0.71167433, -3.4231215, -0.22312927]
Target sample: 25, Prediction:6, Target's Score:[-1.0752046, 3.5335212, -1.4893508, 2.4618895, -0.40927356, -3.6290457, 5.86912, -0.5620625, -4.7912884, 0.41056725]
Target sample: 31, Prediction:6, Target's Score:[-0.83212805, -0.3337667, 0.07876222, 2.7320704, 2.3857555, -3.6052177, 2.937658, 0.013587356, -3.9407692, 0.8494448]
Target sample: 37, Prediction:9, Target's Score:[0.83320075, -0.31982425, -3.5654242, 4.71372, -2.3404763, -2.9714978, -0.7556376, -1.6661227, -0.75320977, 7.0863934]
Target sample: 43, Prediction:3, Target's Score:[-1.158287, -2.5905097, -1.5714389, 5.578347, -1.8243315, -3.5571332, 2.9094808, -3.3694353, 1.0270982, 4.8113356]
Target sample: 49, Prediction:9, Target's Score:[-1.438769, 2.546708, -1.0633814, 2.5745752, -4.070439, -2.730057, 2.6727188, -4.325787, 1.3376148, 4.7795854]
Target sample: 55, Prediction:1, Target's Score:[-1.5321301, 4.003847, -0.17230564, 2.0997617, -4.480741, -2.2760227, 1.6383127, -0.1609956, -2.2133648, 3.4059615]
Target sample: 61, Prediction:3, Target's Score:[-2.6425211, 1.6154914, -3.2107122, 6.2957554, -1.5473933, -1.2572765, 5.8269916, -5.3953543, -2.778841, 3.399185]
Target sample: 67, Prediction:9, Target's Score:[-0.10277183, 1.9806787, -1.5480138, 2.8207223, -1.6893156, -1.4015716, -0.6822538, 0.97508466, -3.4674885, 3.3739567]
Target sample: 73, Prediction:3, Target's Score:[-3.487566, 2.213623, 0.05506012, 5.4104114, -2.3127382, -3.969053, -1.0892038, -2.5791254, 4.9801707, 1.0652677]
Target sample: 79, Prediction:3, Target's Score:[-3.6957588, -0.054100037, -0.68256557, 5.2434297, -1.3079398, -3.0101628, 2.5373847, -1.7311299, 1.3072333, 1.6641572]
Target sample: 85, Prediction:6, Target's Score:[-3.9375074, -2.964044, 0.57090974, 6.0592155, 0.62413424, -0.9042113, 9.170695, -3.41874, -4.136925, -0.7844712]
Target sample: 91, Prediction:3, Target's Score:[-1.6214807, 2.3553374, -2.9354928, 6.535775, -0.18089238, -0.96951425, 4.6854672, -0.9199849, -5.662194, -0.9884]
Target sample: 97, Prediction:1, Target's Score:[-0.74403465, 4.6360507, -3.6519086, 3.088559, -1.6562233, -1.5594962, 2.8515406, -2.1550398, -4.895327, 4.3869543]
Target sample: 103, Prediction:6, Target's Score:[-0.9388137, -0.06986955, -3.2562916, 2.8775477, 0.34362227, -4.408606, 4.160648, -1.4899136, -0.2526921, 3.3211682]
Target sample: 109, Prediction:6, Target's Score:[-0.77292824, -2.2984533, -0.7609831, 2.4088526, -1.1102481, -4.8759723, 4.795337, -2.909378, 3.9143147, 1.8761324]
Target sample: 115, Prediction:9, Target's Score:[-3.075222, 1.9418589, -2.1099007, 1.349247, -3.3445487, -0.8182973, 3.0081508, -3.1788678, 2.0890095, 4.420746]
Target sample: 121, Prediction:3, Target's Score:[-3.7601728, -0.40105352, -2.4378698, 7.0549984, -3.1019702, -2.4097378, 5.1269817, -2.4134333, 0.6793825, 1.9607517]
Target sample: 127, Prediction:6, Target's Score:[-2.8388562, 3.5224576, -2.9229832, 5.172821, -0.80934525, -2.7758539, 6.829887, -4.1346927, -2.602986, 0.8634512]
Target sample: 133, Prediction:3, Target's Score:[-1.7385998, 0.6148987, -1.6773659, 6.526559, -3.760986, -2.2429407, 4.019393, -2.8904557, -1.9526792, 3.376061]
Target sample: 139, Prediction:6, Target's Score:[-2.7837493, -0.48187032, -3.0923653, 4.249636, -2.680579, -1.9511526, 4.5250983, -3.4726362, 3.0812242, 2.86405]
Current ATTACK acc on target samples: 33.333
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 22:16:55 Epoch 59, Val iteration 0, acc 90.000 (90.000)
2021-06-11 22:16:58 Epoch 59, Val iteration 19, acc 89.600 (89.580)
* Prec: 89.58000221252442
Per class accuracy =  [0.92627565 0.93102102 0.83473157 0.83331354 0.89370835 0.82977467
 0.94089399 0.8920151  0.9256072  0.94566319]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 3, 3, 8, 6, 3, 6, 3, 3, 6, 3, 3, 3, 3, 3, 3, 6, 6, 3, 6, 1, 1, 1, 1, 6, 3, 6, 3, 9, 9, 9, 9, 9, 3, 9, 9, 9, 9, 3, 9, 9, 6, 6, 1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 9, 9, 3, 9, 9, 9, 3, 3, 3, 3, 3, 3, 3, 3, 4, 6, 3, 6, 4, 3, 3, 3, 6, 3, 6, 6, 6, 6, 3, 6, 6, 6, 6, 6, 6, 6, 6, 3, 3, 6, 3, 6, 6, 3, 1, 1, 3, 6, 6, 6, 3, 6, 3, 1, 9, 3, 6, 9, 3, 3, 8, 6, 3, 8, 3
ATTACK acc: 29.661016949152543
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 22:17:02, Val iteration 0, acc 96.200 (96.200)
2021-06-11 22:17:09, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-11 22:17:12, Epoch 0, Iteration 7, loss 0.198 (0.545), acc 94.231 (85.600)
2021-06-11 22:17:44, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.8656412, 0.9519959, -1.8727548, -1.2073445, -2.1930277, 2.8896844, 2.968523, -1.976849, 0.9196404, 1.4737067]
Target sample: 7, Prediction:6, Target's Score:[-3.2442355, 3.5771658, -2.0070798, -0.9414941, -2.8787572, -1.4325467, 3.8402617, -2.663742, 2.5291457, 3.3011527]
Target sample: 13, Prediction:6, Target's Score:[-2.5489452, 2.656232, -1.4137855, 0.029456114, -1.828238, -2.1833746, 4.002652, -2.5839567, 1.9921771, 1.9458644]
Target sample: 19, Prediction:6, Target's Score:[-3.1978178, 0.4760408, -1.4640442, 2.567631, -2.2625697, -3.1424048, 5.135582, -2.1944373, 3.1917424, 0.94187254]
Target sample: 25, Prediction:6, Target's Score:[-3.0485387, 4.8636303, -2.0986478, 0.18657002, -2.5233464, -2.28814, 4.975045, -2.3891463, 1.0006797, 1.4044367]
Target sample: 31, Prediction:1, Target's Score:[-3.194095, 4.069116, -0.6959142, 0.2723283, -0.326545, -3.1696138, 3.315855, -2.1318862, 0.24527323, 1.6950339]
Target sample: 37, Prediction:1, Target's Score:[-0.9918901, 6.0166078, -0.84851974, 0.020193016, -2.7303543, -1.9611635, -0.7190991, -2.405503, -0.45593563, 4.1844172]
Target sample: 43, Prediction:1, Target's Score:[-1.8893831, 5.5901675, -2.003554, 1.8593068, -3.3381846, -2.4432983, 1.3835133, -2.5997014, -0.06740317, 3.6145341]
Target sample: 49, Prediction:1, Target's Score:[-3.630665, 5.919786, -0.31366816, 2.8053253, -2.2593162, -3.930395, -0.29970157, -2.614324, 1.1889352, 3.2404704]
Target sample: 55, Prediction:1, Target's Score:[-2.757525, 7.5953903, -0.4936185, 2.2385356, -2.6065583, -3.1850798, 1.6649145, -2.5377336, -1.1675005, 1.3655235]
Target sample: 61, Prediction:6, Target's Score:[-2.6143034, 1.9748431, -3.4694343, 4.545992, -3.005969, 0.13818803, 5.1397805, -3.506763, -0.11045158, 0.9895893]
Target sample: 67, Prediction:8, Target's Score:[-2.8111868, 1.6969482, -1.1303948, 0.67146635, -2.3432746, -0.30818045, 1.4620916, -1.2578881, 2.4763317, 1.6087258]
Target sample: 73, Prediction:8, Target's Score:[-5.157632, 7.373056, -0.5910628, -0.53450704, -2.6095722, -3.7092857, -0.6895567, -2.1134207, 7.384342, 0.7453707]
Target sample: 79, Prediction:1, Target's Score:[-3.4814622, 4.7369957, 0.1663955, -0.85686755, -2.9279544, -2.4816675, 3.0919957, -1.6403378, 4.1077104, -0.63935715]
Target sample: 85, Prediction:3, Target's Score:[-3.3709793, -0.3152555, -1.8657634, 5.8460784, 0.7514297, -1.3934433, 2.078451, -2.3245702, 0.5782987, 0.07054234]
Target sample: 91, Prediction:6, Target's Score:[-2.916193, 3.4843678, -2.790616, -0.8489206, -1.4927589, -1.879558, 5.9136424, -2.1801162, 0.64929384, 2.130982]
Target sample: 97, Prediction:1, Target's Score:[-2.5148933, 7.2747483, -2.1209705, -1.1780784, -2.902737, -1.7738492, 2.7970932, -2.7561922, -0.43363723, 3.719256]
Target sample: 103, Prediction:1, Target's Score:[-1.152184, 4.1926575, -2.2350738, 0.17896995, -3.575533, -2.1938236, 1.8104755, -2.8791015, 2.130078, 3.8177094]
Target sample: 109, Prediction:1, Target's Score:[-1.1903261, 6.8465905, -1.7304574, -0.19533513, -2.3606632, -3.0076597, 0.6607678, -2.9168625, 1.5053169, 2.4943519]
Target sample: 115, Prediction:1, Target's Score:[-1.7304038, 4.986954, 1.3874413, -1.6696825, -2.7896094, -2.9463568, -0.18690442, -1.8888203, 0.4668746, 4.47606]
Target sample: 121, Prediction:1, Target's Score:[-2.914138, 3.3433099, -0.92651594, 2.3881376, -1.8550485, -2.8349247, 2.2662075, -2.735405, 2.3967557, 0.9473429]
Target sample: 127, Prediction:1, Target's Score:[-2.975351, 4.8772583, -2.6002657, 1.5472078, -2.7157345, -1.4607654, 3.2911403, -3.1504045, 0.8354924, 2.4446287]
Target sample: 133, Prediction:6, Target's Score:[-2.3886635, 2.6807745, -2.1733568, -0.53583014, -3.0201542, -0.18229267, 3.0816631, -0.37283185, 1.5898097, 1.4047487]
Target sample: 139, Prediction:8, Target's Score:[-3.8066316, 1.5263278, -1.6174848, 1.6289536, -3.0019948, -1.9592791, 3.9144764, -3.031753, 5.5527573, 0.8579225]
Current ATTACK acc on target samples: 33.333
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 22:18:16 Epoch 59, Val iteration 0, acc 92.800 (92.800)
2021-06-11 22:18:23 Epoch 59, Val iteration 19, acc 94.800 (93.500)
* Prec: 93.5000015258789
Per class accuracy =  [0.94505794 0.95373941 0.89070889 0.89555131 0.94232409 0.87891326
 0.96997964 0.94429433 0.96393095 0.96586711]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 6, 6, 8, 6, 8, 8, 8, 6, 6, 8, 6, 8, 6, 6, 6, 6, 6, 8, 1, 1, 1, 1, 1, 6, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 8, 8, 3, 1, 1, 1, 6, 3, 6, 6, 3, 8, 8, 6, 3, 1, 1, 1, 1, 1, 8, 1, 8, 1, 6, 6, 6, 6, 6, 6, 6, 8, 6, 8, 6, 6, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 9, 1, 1, 1, 1, 1, 6, 8, 1, 1, 3, 1, 3, 3, 8, 1, 6, 9, 6, 6, 8, 6, 6, 6, 6
ATTACK acc: 30.508474576271187
--------
------SUMMARY PRE DEFENSE------
TIME ELAPSED (mins): 11
TARGET INDEX: 10
ResNet50 79.16666666666667 74.57627118644068 95.46000137329102 90.33000144958496
DPN92 41.666666666666664 55.932203389830505 95.50000267028808 92.33000183105469
MobileNetV2 33.333333333333336 29.661016949152543 91.22000160217286 89.58000221252442
GoogLeNet 33.333333333333336 30.508474576271187 95.41000213623047 93.5000015258789
DEFENSE EVALUATION
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
ResNet50
[74, 80, 84, 86, 89] 5
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 22:18:28, Val iteration 0, acc 94.200 (94.200)
2021-06-11 22:18:33, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-11 22:18:34, Epoch 0, Iteration 7, loss 0.068 (0.266), acc 98.077 (94.600)
2021-06-11 22:19:02, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[0.14587042, 7.316459, -3.8736856, 2.4086614, -4.754902, -1.9731661, -2.533926, -1.9673419, 4.546474, 1.3388642]
Target sample: 7, Prediction:1, Target's Score:[-0.30500504, 10.338846, -4.8155646, -0.08208177, -3.6435392, -4.1466427, -1.0456263, -1.181514, 4.9204726, 0.62466383]
Target sample: 13, Prediction:9, Target's Score:[-0.2752179, 5.8012977, -4.1733894, 0.47366542, -3.8264534, -4.5185037, -2.4955645, -0.80259264, 3.6269612, 6.851277]
Target sample: 19, Prediction:1, Target's Score:[1.8758638, 5.225901, -2.4747238, 2.7404, -4.8542185, -4.004622, -2.0578616, 1.3446662, 2.8909924, -0.14580905]
Target sample: 25, Prediction:1, Target's Score:[-0.4801131, 13.452585, -3.6070042, 2.067694, -5.2422466, -3.308718, -2.3426583, -2.1231985, 0.88929844, 1.4147849]
Target sample: 31, Prediction:1, Target's Score:[-1.3848624, 15.637625, -3.0987723, 1.2007174, -5.047149, -4.083165, -2.627125, -2.687987, 0.8503695, 2.0172915]
Target sample: 37, Prediction:9, Target's Score:[0.105823785, 6.5116234, -3.1261497, 2.450819, -5.7548666, -4.4893947, -4.662891, -1.888952, 0.25682983, 11.35697]
Target sample: 43, Prediction:1, Target's Score:[-0.272512, 13.78478, -3.158201, 0.34497422, -5.4746666, -5.4607325, -3.4435854, -2.341359, 2.0793107, 4.7223477]
Target sample: 49, Prediction:1, Target's Score:[-0.88386863, 14.684827, -3.4173224, 0.25206068, -5.285348, -4.8644996, -2.940621, -2.1490536, 2.8829467, 2.4783337]
Target sample: 55, Prediction:1, Target's Score:[-0.484263, 18.058397, -2.526023, 0.7565822, -6.389214, -5.1143627, -2.8278189, -1.2504883, 0.36593688, 0.24832901]
Target sample: 61, Prediction:1, Target's Score:[-0.075578906, 10.184147, -3.5138898, 2.5357752, -4.7516837, -3.362754, -1.776156, -1.7377355, 1.0492107, 2.1132734]
Target sample: 67, Prediction:1, Target's Score:[-0.35354653, 10.175605, -3.4345515, 2.7324042, -5.318385, -2.9721072, -3.492508, -2.0692065, 1.2562468, 4.1925077]
Target sample: 73, Prediction:1, Target's Score:[-1.8815428, 16.493155, -4.361538, 0.1624031, -5.375195, -5.161338, -2.3715262, -2.8492665, 5.026653, 1.1655419]
Target sample: 79, Prediction:1, Target's Score:[-0.6902489, 11.542705, -3.9279003, 0.58575207, -4.160656, -4.3432207, -1.3302811, -2.376956, 6.409511, -1.0115322]
Target sample: 85, Prediction:1, Target's Score:[-1.1301981, 7.3684645, -3.2950635, 3.6965249, -4.720392, -3.9789083, -2.8001325, -0.51122683, 3.447129, 2.5954823]
Target sample: 91, Prediction:1, Target's Score:[-0.26397848, 12.027265, -2.3223839, 1.0120057, -3.6851637, -3.4967258, -1.4801614, -1.7064062, 1.0783596, -0.549141]
Target sample: 97, Prediction:1, Target's Score:[-1.7110769, 7.4162693, -1.8030193, 5.7760444, -5.93787, -2.5133753, -3.944091, -1.916142, -1.2395347, 6.6449537]
Target sample: 103, Prediction:1, Target's Score:[1.0336478, 10.744657, -3.0741327, 1.9098998, -5.70434, -4.591088, -3.6332352, -2.279958, 2.7453709, 3.5697653]
Target sample: 109, Prediction:1, Target's Score:[-1.2504455, 17.418028, -3.2460198, -0.11141155, -4.894819, -5.116483, -3.0231278, -3.272885, 1.7075777, 2.619768]
Target sample: 115, Prediction:1, Target's Score:[-0.47950736, 13.051101, -2.75923, 0.53224796, -5.2042456, -4.7399144, -3.7452357, -2.5324538, 2.2022498, 4.4395123]
Target sample: 121, Prediction:1, Target's Score:[-0.53178114, 14.5930395, -2.9606802, 1.8264242, -5.6387444, -4.884629, -2.9129066, -2.3805683, 1.7334025, 1.9342976]
Target sample: 127, Prediction:1, Target's Score:[-1.3659524, 13.838841, -3.5862937, 3.9618256, -5.942471, -3.942523, -3.1433547, -3.0477371, 0.41495433, 3.662294]
Target sample: 133, Prediction:1, Target's Score:[0.36700478, 5.3742146, -3.408895, 1.1824503, -3.7745478, -1.1158056, -3.2494788, -0.5322909, 3.6246738, 2.1032648]
Target sample: 139, Prediction:1, Target's Score:[0.6252398, 6.828699, -4.334549, 2.8151321, -5.4655895, -3.0414205, -2.3584185, -1.8827331, 5.9855285, 1.5195665]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 22:19:30 Epoch 59, Val iteration 0, acc 92.600 (92.600)
2021-06-11 22:19:36 Epoch 59, Val iteration 19, acc 92.400 (92.250)
* Prec: 92.2500015258789
Per class accuracy =  [0.94439879 0.954052   0.88599276 0.85852966 0.93045757 0.8543497
 0.92722489 0.95607115 0.9564877  0.95782838]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 8, 8, 1, 1, 1, 8, 8, 8, 8, 8, 1, 1, 1, 1, 8, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 9, 9, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 8, 8, 1
ATTACK acc: 0.0
DPN92
[74, 80, 84, 86, 89] 28
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 22:19:39, Val iteration 0, acc 94.800 (94.800)
2021-06-11 22:19:51, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-11 22:19:54, Epoch 0, Iteration 7, loss 0.557 (0.542), acc 94.231 (89.600)
2021-06-11 22:21:20, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[0.6927976, 13.011154, -4.521522, -2.860298, -2.9882698, -2.4388995, -1.1578832, -3.7523913, 0.24914074, 4.6538787]
Target sample: 7, Prediction:1, Target's Score:[-0.19637041, 7.717353, -3.8986278, -1.7832023, -1.854937, -3.6870544, -0.54203576, -2.7393286, 4.7186704, 2.9779222]
Target sample: 13, Prediction:1, Target's Score:[-0.07509862, 5.5230374, -3.6473596, -2.5758076, 0.17268088, -3.3651958, 0.064812474, -2.2068608, 4.8905587, 1.8959236]
Target sample: 19, Prediction:1, Target's Score:[-1.0095447, 12.714001, -4.100166, -3.0597801, -0.95376253, -2.7431877, -0.8355189, -3.3780315, 2.085034, 2.0812445]
Target sample: 25, Prediction:1, Target's Score:[-0.8981179, 17.664463, -4.90648, -3.0265443, -2.507201, -3.4838812, -1.0556637, -3.7890105, 0.9835845, 1.9711294]
Target sample: 31, Prediction:1, Target's Score:[-1.0844518, 17.376202, -4.7846036, -2.8263638, -2.2298753, -3.2359095, -1.4369376, -3.789718, 1.0660211, 1.9153824]
Target sample: 37, Prediction:1, Target's Score:[-0.6552567, 17.174442, -5.464371, -3.5763474, -2.6440508, -3.4250677, -1.956854, -4.6027293, 0.27104628, 5.919248]
Target sample: 43, Prediction:1, Target's Score:[-1.4102308, 15.222559, -4.458457, -2.8660707, -2.416842, -3.8176033, -1.4492214, -3.966369, 1.5066414, 4.601785]
Target sample: 49, Prediction:1, Target's Score:[-0.6417088, 15.546969, -4.321729, -2.8587043, -2.580674, -2.518587, -1.6236469, -4.035374, 0.78038645, 3.1959903]
Target sample: 55, Prediction:1, Target's Score:[-0.72321934, 15.212113, -3.9349897, -1.7980884, -2.5323746, -2.7802458, -1.1258987, -3.7763777, 1.1986859, 1.1707319]
Target sample: 61, Prediction:1, Target's Score:[1.1412629, 7.5632806, -4.08905, 2.4242945, -3.0061314, -1.1985704, -1.1436057, -2.4092834, -0.8491133, 2.3241417]
Target sample: 67, Prediction:1, Target's Score:[0.97621936, 5.2057242, -3.7401578, -0.38773143, -1.5337636, -1.9643797, -2.222682, -0.541477, 0.4098741, 4.4505353]
Target sample: 73, Prediction:1, Target's Score:[-0.98059624, 9.671628, -3.296322, -1.241814, -2.6565578, -2.8084867, -1.1624095, -3.1634705, 4.364784, 2.0475235]
Target sample: 79, Prediction:1, Target's Score:[-1.4101998, 13.363358, -4.0208836, -2.7234519, -1.8485583, -2.7814236, -0.27160797, -3.212999, 2.8014665, 0.89696443]
Target sample: 85, Prediction:1, Target's Score:[-3.3554494, 4.7405057, -3.3318, 2.2411551, 1.9938176, -0.78075284, -1.0279208, -2.3919513, 0.48551488, 2.1079426]
Target sample: 91, Prediction:1, Target's Score:[-1.5247716, 14.56707, -4.426967, -2.4988532, -0.3868469, -2.7069836, -0.86225545, -2.9769084, 0.5507445, 1.1274267]
Target sample: 97, Prediction:1, Target's Score:[-1.0773587, 17.139318, -5.00769, -1.6461297, -2.6377406, -3.1054418, -1.5701225, -4.543691, 0.86388427, 2.5982468]
Target sample: 103, Prediction:1, Target's Score:[-1.4578131, 13.388094, -4.5546627, -2.456543, -2.348725, -3.4599376, -0.43470633, -3.707641, 3.1667535, 2.720547]
Target sample: 109, Prediction:1, Target's Score:[-1.0048654, 16.095295, -4.9073896, -2.5763109, -2.6109307, -3.453295, -1.060146, -4.3219852, 1.4477077, 3.3416734]
Target sample: 115, Prediction:1, Target's Score:[-0.12335761, 12.833901, -4.050549, -2.8141751, -2.0969005, -2.797138, -1.8011285, -3.8074994, 0.97061765, 4.5717587]
Target sample: 121, Prediction:1, Target's Score:[-1.9128522, 11.727585, -3.6694548, 0.8746512, -1.8605442, -2.5128014, -0.79204303, -3.4778626, 1.4302912, 1.0198505]
Target sample: 127, Prediction:1, Target's Score:[-1.5269573, 11.41388, -4.45065, -0.503338, -2.1611643, -2.8837755, -0.30231094, -3.3707378, 1.7382189, 2.83926]
Target sample: 133, Prediction:1, Target's Score:[-1.679759, 9.588692, -4.2123613, -2.2528753, -1.3478997, -3.0858202, -0.70011634, -1.8632815, 3.9367182, 2.352622]
Target sample: 139, Prediction:1, Target's Score:[1.8408192, 9.617513, -4.138853, -2.5408595, -3.0119355, -2.9276628, 0.83435893, -3.511126, 3.2445824, 1.3966]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 22:22:44 Epoch 59, Val iteration 0, acc 91.800 (91.800)
2021-06-11 22:22:55 Epoch 59, Val iteration 19, acc 92.000 (92.880)
* Prec: 92.88000106811523
Per class accuracy =  [0.95852305 0.94968757 0.92184483 0.85974964 0.94177848 0.88319045
 0.95114397 0.9096     0.95701236 0.95324554]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 8, 8, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 1, 1, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
MobileNetV2
[74, 84, 86, 89] 46
Using Adam for retraining
2000
poison index =  80
499
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 22:22:59, Val iteration 0, acc 92.600 (92.600)
2021-06-11 22:23:02, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-11 22:23:02, Epoch 0, Iteration 7, loss 0.275 (0.310), acc 88.462 (90.400)
2021-06-11 22:23:17, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6]
Target sample: 1, Prediction:9, Target's Score:[-0.68750745, 3.2108657, -4.156695, 1.7153667, -4.5111012, -2.5765991, 0.6358698, -2.2285283, 2.936559, 6.2076106]
Target sample: 7, Prediction:9, Target's Score:[-2.1161382, 0.5135171, -4.170735, 4.3057446, -4.684738, -1.4940585, 2.2096567, -2.683432, 2.8288949, 5.794958]
Target sample: 13, Prediction:3, Target's Score:[-1.2037143, -1.2507097, -2.4529839, 4.9340186, -2.104182, -2.5744815, -1.1105682, -1.1465689, 4.21367, 3.1635113]
Target sample: 19, Prediction:3, Target's Score:[-3.1699402, 2.01598, -2.5383947, 5.0791483, 0.85192466, -1.9380109, 0.19658299, 1.7625138, -2.7845526, 1.1003917]
Target sample: 25, Prediction:1, Target's Score:[-0.662353, 5.71331, -2.2971575, 3.2785733, -0.65840757, -3.5653534, 1.5154117, 0.2024267, -4.347565, 1.4513047]
Target sample: 31, Prediction:3, Target's Score:[-0.27052125, 2.3397784, -0.54808366, 3.2623615, 1.5884868, -3.7778246, -1.2396886, 0.501078, -3.293453, 1.9962006]
Target sample: 37, Prediction:9, Target's Score:[1.4720489, 1.5140934, -4.475551, 4.5581665, -2.647754, -3.116704, -3.8622723, -1.4156387, -0.5280405, 9.05973]
Target sample: 43, Prediction:9, Target's Score:[-0.7272112, -0.84346586, -2.442664, 6.230123, -2.4455593, -3.6286178, -1.0966293, -2.9204612, 1.8130748, 6.569258]
Target sample: 49, Prediction:9, Target's Score:[-1.2721684, 4.0418296, -1.6039137, 3.2281318, -4.7073665, -2.7923253, -0.19526957, -4.124656, 1.3139615, 6.7110686]
Target sample: 55, Prediction:1, Target's Score:[-1.0836002, 6.38393, -0.5952035, 2.7960584, -5.146873, -2.5007322, -1.2605985, -0.10828916, -2.4722571, 4.6326547]
Target sample: 61, Prediction:3, Target's Score:[-2.5741313, 3.6399298, -3.8084884, 6.8463116, -2.242522, -1.1612533, 2.8980649, -5.6150346, -2.6390724, 5.291192]
Target sample: 67, Prediction:9, Target's Score:[0.3359786, 3.867781, -2.4632304, 3.4870439, -2.6687925, -1.3077406, -3.5660565, 1.2889675, -3.1364558, 4.7150955]
Target sample: 73, Prediction:1, Target's Score:[-2.1270146, 5.5264225, -0.63257146, 5.497613, -2.9309583, -4.0367103, -4.0768943, -2.9847856, 4.3358693, 2.0610356]
Target sample: 79, Prediction:3, Target's Score:[-3.2321563, 2.6692595, -1.6580641, 6.095597, -1.6672857, -2.7544322, -1.7228451, -1.8885795, 1.811501, 2.916003]
Target sample: 85, Prediction:3, Target's Score:[-4.0551386, -1.7842411, -0.58768725, 7.4345474, -0.21658863, -0.052001342, 5.931325, -2.8941557, -3.8325732, 0.5584694]
Target sample: 91, Prediction:3, Target's Score:[-1.5804926, 5.090345, -4.063429, 7.4209523, -0.60666764, -0.6648687, 1.1090052, -0.63352305, -5.5354786, 0.10275966]
Target sample: 97, Prediction:1, Target's Score:[0.091520876, 7.25464, -4.036016, 3.3202631, -2.481113, -1.633468, -1.3423295, -1.339978, -4.792353, 5.5923805]
Target sample: 103, Prediction:9, Target's Score:[-0.2100141, 2.5509691, -4.323769, 3.140697, -0.9335538, -4.5572634, 0.52145845, -1.6606528, 0.8136024, 5.2158227]
Target sample: 109, Prediction:8, Target's Score:[0.17105696, -0.8527533, -0.8305901, 2.752794, -1.7656927, -5.4500237, 0.67478555, -2.4383326, 4.797291, 3.4354217]
Target sample: 115, Prediction:9, Target's Score:[-2.861682, 3.548495, -2.9486344, 2.0599236, -3.722479, -0.848487, -0.02415467, -3.1423616, 2.2717862, 6.249954]
Target sample: 121, Prediction:3, Target's Score:[-3.2072892, 2.2770858, -3.3834872, 7.0759745, -3.529603, -2.578477, 1.9485165, -2.5124264, 0.9674155, 3.5622487]
Target sample: 127, Prediction:3, Target's Score:[-2.594051, 6.254811, -4.1570034, 6.3326354, -1.9662807, -2.6616914, 3.0810719, -4.3135266, -2.0993004, 2.7693849]
Target sample: 133, Prediction:3, Target's Score:[-1.103074, 2.6728182, -2.4786787, 7.0526047, -4.2742653, -2.3569233, 0.022988014, -2.1953266, -1.5578074, 4.794685]
Target sample: 139, Prediction:3, Target's Score:[-2.0720572, 0.9926988, -3.73912, 4.6117535, -2.9430566, -2.3604386, 1.7746489, -3.5920248, 3.9489312, 3.9042885]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 22:23:31 Epoch 59, Val iteration 0, acc 89.200 (89.200)
2021-06-11 22:23:34 Epoch 59, Val iteration 19, acc 90.200 (89.490)
* Prec: 89.49000129699706
Per class accuracy =  [0.92303352 0.93166573 0.84524888 0.82568144 0.88748812 0.82099804
 0.93899839 0.89199367 0.93377804 0.94634775]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 3, 3, 8, 3, 9, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1, 1, 1, 1, 1, 3, 9, 9, 9, 9, 9, 9, 9, 3, 9, 9, 9, 9, 9, 9, 9, 9, 9, 1, 3, 1, 3, 3, 3, 3, 1, 3, 3, 9, 9, 3, 9, 1, 1, 1, 3, 1, 3, 3, 3, 3, 9, 4, 3, 3, 3, 4, 3, 3, 3, 1, 1, 1, 1, 3, 1, 1, 1, 3, 9, 1, 3, 1, 6, 6, 3, 3, 1, 3, 3, 6, 3, 1, 1, 3, 3, 1, 3, 3, 3, 3, 1, 1, 3, 3, 9, 9, 3, 8, 8, 3, 8, 3
ATTACK acc: 2.542372881355932
GoogLeNet
[80, 84, 86, 89] 22
Using Adam for retraining
2000
poison index =  74
499
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 22:23:37, Val iteration 0, acc 96.200 (96.200)
2021-06-11 22:23:44, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-11 22:23:45, Epoch 0, Iteration 7, loss 0.544 (0.962), acc 84.615 (78.400)
2021-06-11 22:24:17, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6]
Target sample: 1, Prediction:8, Target's Score:[-2.2438505, 3.505155, -1.8644378, -0.6644268, -3.3638556, 0.5231613, 1.3367449, -2.2603495, 4.943409, 0.1703665]
Target sample: 7, Prediction:1, Target's Score:[-4.201454, 7.2985034, -1.9991506, -1.2953665, -4.0602474, -3.321881, 3.7071931, -3.5151076, 6.974921, 0.5017199]
Target sample: 13, Prediction:1, Target's Score:[-2.4444067, 5.087753, -1.549071, 0.18380894, -2.2492201, -4.119848, 3.3780584, -2.4034717, 2.9334593, 1.2488629]
Target sample: 19, Prediction:6, Target's Score:[-2.174901, 0.20261118, -1.8370341, 3.4256191, -2.531568, -4.3697762, 4.515038, -1.6736674, 3.4710398, 1.0505183]
Target sample: 25, Prediction:9, Target's Score:[-2.8063126, 4.319267, -2.6477213, 1.1059308, -3.7108586, -3.5624673, 3.7926462, -2.676618, 1.0775838, 5.178756]
Target sample: 31, Prediction:9, Target's Score:[-1.5780823, 1.5587682, -0.85608906, 1.4728627, 0.7222433, -3.5845938, 2.446244, -3.2532573, 0.17183825, 2.95523]
Target sample: 37, Prediction:1, Target's Score:[1.0037274, 5.3093896, -1.2165911, 1.0128381, -3.8089776, -2.519052, -0.5490296, -3.0973544, 0.019110413, 3.8921592]
Target sample: 43, Prediction:1, Target's Score:[-1.3245113, 5.433711, -0.9688034, 1.9416792, -4.0386057, -3.0279324, 1.420405, -3.429536, 0.88532287, 3.164122]
Target sample: 49, Prediction:1, Target's Score:[-3.2264125, 6.496183, 1.0964682, 2.3892472, -3.3205435, -3.5281167, 0.3799661, -3.4169228, 0.48851904, 2.7028959]
Target sample: 55, Prediction:1, Target's Score:[-3.2683384, 7.477137, 1.3478799, 2.7896752, -4.065236, -3.4023073, 1.8775358, -1.4991399, -2.0355003, 0.81978786]
Target sample: 61, Prediction:6, Target's Score:[-1.9149926, 2.7935925, -2.5454695, 4.4800005, -4.2051916, -0.2887187, 4.5197396, -3.8471286, 1.9024965, -0.832382]
Target sample: 67, Prediction:8, Target's Score:[-3.6999388, 0.9711217, 1.0137112, 1.4253397, -2.4947958, -1.2211648, 1.3943316, -2.8694022, 3.6769757, 1.8887786]
Target sample: 73, Prediction:1, Target's Score:[-6.3756685, 10.397153, 0.49672565, 0.75122684, -3.8635316, -4.023942, 0.68959916, -1.8820662, 5.3776402, -1.4814535]
Target sample: 79, Prediction:1, Target's Score:[-5.5613365, 9.546593, 0.37715527, -0.02976333, -4.9640565, -3.2458498, 3.3389902, -1.5657705, 4.317042, -2.1352403]
Target sample: 85, Prediction:3, Target's Score:[-4.575392, 0.2622293, -2.963021, 6.7855926, 1.5142697, -1.7197409, 1.7176706, -2.8571782, 2.1597385, -0.24500969]
Target sample: 91, Prediction:1, Target's Score:[-2.5598037, 4.5520988, -3.9328966, 2.4495528, -1.225152, -3.2387516, 3.267057, -1.8696029, 2.368608, 0.24865547]
Target sample: 97, Prediction:1, Target's Score:[-1.4288385, 7.2070527, -0.7177701, 0.14784767, -3.8224385, -3.7132554, 1.2583727, -3.3752513, 1.0706358, 3.4306002]
Target sample: 103, Prediction:8, Target's Score:[-0.968259, 4.8244853, -0.96650594, 0.4896415, -4.7987695, -3.2394807, 0.89992666, -3.338127, 5.418136, 1.7524815]
Target sample: 109, Prediction:1, Target's Score:[-1.0783086, 8.016688, -1.0272357, 1.1473395, -4.118945, -4.1309357, 1.1410398, -2.8869245, 2.3531485, 0.63520116]
Target sample: 115, Prediction:1, Target's Score:[-0.46041468, 5.017697, 1.2255323, -1.1047964, -4.7007737, -3.472691, -0.1797958, -1.4245007, 3.0126498, 2.1490796]
Target sample: 121, Prediction:1, Target's Score:[-3.6395342, 5.1898694, -1.077412, 4.110342, -2.7150536, -3.914395, 0.67586786, -1.1040546, 2.3834763, 0.16194639]
Target sample: 127, Prediction:1, Target's Score:[-3.0187433, 6.9572015, -2.078298, 2.2515194, -4.114838, -2.764733, 2.2500472, -3.313732, 2.194409, 1.7036276]
Target sample: 133, Prediction:8, Target's Score:[-2.8634965, 2.9280095, -1.9215337, -1.6548581, -3.530489, -0.6973978, 1.612522, -1.002887, 6.706697, 0.512061]
Target sample: 139, Prediction:8, Target's Score:[-3.7908938, 4.947881, -1.3382963, 1.6231959, -3.0995023, -3.2637672, 3.6802034, -3.4669602, 6.4625363, -1.6691499]
Current ATTACK acc on target samples: 8.333
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 22:24:49 Epoch 59, Val iteration 0, acc 93.400 (93.400)
2021-06-11 22:24:56 Epoch 59, Val iteration 19, acc 94.400 (92.730)
* Prec: 92.73000144958496
Per class accuracy =  [0.92843938 0.93118482 0.88863487 0.86874984 0.94937997 0.91220641
 0.9588131  0.9235218  0.95069159 0.95815284]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 1, 8, 1, 1, 1, 1, 8, 1, 1, 8, 8, 8, 6, 8, 8, 8, 6, 8, 9, 1, 1, 9, 1, 8, 1, 1, 1, 9, 1, 1, 1, 1, 1, 8, 9, 8, 1, 1, 1, 1, 8, 8, 3, 6, 1, 1, 6, 3, 1, 6, 1, 6, 8, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 6, 8, 6, 8, 6, 8, 1, 3, 8, 9, 8, 1, 1, 8, 1, 1, 1, 8, 1, 1, 1, 8, 8, 8, 8, 1, 1, 8, 1, 1, 8, 8, 1, 1, 1, 1, 3, 8, 8, 1, 8, 8, 8, 8, 8, 8, 8, 1, 1
ATTACK acc: 7.627118644067797
------SUMMARY POST DEFENSE------
TIME ELAPSED (mins): 11
TARGET INDEX: 10
ResNet50 0.0 0.0 95.46000137329102 92.2500015258789 100.0
DPN92 0.0 0.0 95.50000267028808 92.88000106811523 100.0
MobileNetV2 0.0 2.542372881355932 91.22000160217286 89.49000129699706 80.0
GoogLeNet 8.333333333333334 7.627118644067797 95.41000213623047 92.73000144958496 80.0
True False False False True
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.300-droplayer0.000.t7
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
No specific indices are determined, so try to include whatever we find
In total, we found 92 images of target 11
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', eval_poisons_root='', feat_reg_flag=False, gpu='1', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=11, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/11/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
# Targets: 16, # Poisons: 5
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 22:25:14 Iteration 0 	 Training Loss: 8.552e-01 	 Loss in Target Net: 1.011e+00	  
 2021-06-11 22:25:52 Iteration 50 	 Training Loss: 3.793e-01 	 Loss in Target Net: 2.602e-01	  
 2021-06-11 22:26:31 Iteration 100 	 Training Loss: 3.509e-01 	 Loss in Target Net: 2.406e-01	  
 2021-06-11 22:27:09 Iteration 150 	 Training Loss: 3.423e-01 	 Loss in Target Net: 2.404e-01	  
 2021-06-11 22:27:49 Iteration 200 	 Training Loss: 3.377e-01 	 Loss in Target Net: 2.471e-01	  
 2021-06-11 22:28:28 Iteration 250 	 Training Loss: 3.327e-01 	 Loss in Target Net: 2.465e-01	  
 2021-06-11 22:29:06 Iteration 300 	 Training Loss: 3.328e-01 	 Loss in Target Net: 2.569e-01	  
 2021-06-11 22:29:41 Iteration 350 	 Training Loss: 3.352e-01 	 Loss in Target Net: 2.483e-01	  
 2021-06-11 22:30:16 Iteration 400 	 Training Loss: 3.303e-01 	 Loss in Target Net: 2.504e-01	  
 2021-06-11 22:30:52 Iteration 450 	 Training Loss: 3.307e-01 	 Loss in Target Net: 2.414e-01	  
 2021-06-11 22:31:29 Iteration 500 	 Training Loss: 3.294e-01 	 Loss in Target Net: 2.500e-01	  
 2021-06-11 22:32:07 Iteration 550 	 Training Loss: 3.302e-01 	 Loss in Target Net: 2.486e-01	  
 2021-06-11 22:32:43 Iteration 600 	 Training Loss: 3.308e-01 	 Loss in Target Net: 2.463e-01	  
 2021-06-11 22:33:21 Iteration 650 	 Training Loss: 3.280e-01 	 Loss in Target Net: 2.460e-01	  
 2021-06-11 22:33:58 Iteration 700 	 Training Loss: 3.300e-01 	 Loss in Target Net: 2.485e-01	  
 2021-06-11 22:34:37 Iteration 750 	 Training Loss: 3.322e-01 	 Loss in Target Net: 2.413e-01	  
 2021-06-11 22:35:14 Iteration 800 	 Training Loss: 3.297e-01 	 Loss in Target Net: 2.430e-01	  
 2021-06-11 22:35:49 Iteration 850 	 Training Loss: 3.285e-01 	 Loss in Target Net: 2.431e-01	  
 2021-06-11 22:36:30 Iteration 900 	 Training Loss: 3.290e-01 	 Loss in Target Net: 2.430e-01	  
 2021-06-11 22:37:07 Iteration 950 	 Training Loss: 3.289e-01 	 Loss in Target Net: 2.456e-01	  
 2021-06-11 22:37:44 Iteration 999 	 Training Loss: 3.261e-01 	 Loss in Target Net: 2.438e-01	  
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 22:37:47, Val iteration 0, acc 94.200 (94.200)
2021-06-11 22:37:52, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-11 22:37:55, Epoch 0, Iteration 7, loss 0.881 (0.681), acc 86.538 (86.800)
2021-06-11 22:38:23, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-4.048022, 7.6268544, -0.32584417, -0.36706996, -1.2635034, -2.7537904, 8.495714, -2.4480915, -1.4528325, -3.2811387]
Target sample: 7, Prediction:6, Target's Score:[-5.1571918, 5.532516, -0.098702304, 0.29202735, -0.6411635, -2.4363744, 10.182372, -3.590128, -2.5151365, -1.3521909]
Target sample: 13, Prediction:6, Target's Score:[-5.9405847, 5.7542667, -0.49279606, -0.643344, -0.91550505, -2.9299104, 9.418595, -4.3467727, -2.417251, 2.7083702]
Target sample: 19, Prediction:1, Target's Score:[-4.7180023, 8.906471, -1.0753056, 0.060105912, -1.3567338, -2.264376, 8.310589, -2.8330176, -2.0769694, -2.7898657]
Target sample: 25, Prediction:1, Target's Score:[-5.983254, 10.346193, -0.52048945, -0.6653388, -0.95025647, -3.3304777, 10.0847645, -3.6637945, -2.4946125, -2.6294627]
Target sample: 31, Prediction:6, Target's Score:[-5.7367177, 7.52982, 0.13324593, -0.09975692, -1.3805327, -2.8851457, 9.192142, -3.497463, -3.0808713, -0.00033430755]
Target sample: 37, Prediction:6, Target's Score:[-4.1793065, 5.2807684, -0.54274374, -0.21964955, -1.1346399, -2.4593704, 7.5258293, -3.0681028, -1.788691, 0.7473196]
Target sample: 43, Prediction:1, Target's Score:[-3.8385186, 9.56171, -1.1745487, -0.5448267, -2.0657065, -2.1903627, 6.0708647, -2.586966, -2.1548843, -0.96417093]
Target sample: 49, Prediction:6, Target's Score:[-5.5902576, 9.86234, 0.061648916, -0.28416556, -1.6094174, -3.1098552, 9.918157, -3.1703362, -2.6603374, -3.2286494]
Target sample: 55, Prediction:6, Target's Score:[-5.4038057, 6.1726494, -0.0427718, 0.10848678, -0.6445429, -3.0611184, 11.363604, -3.3652654, -1.599652, -3.2745798]
Target sample: 61, Prediction:6, Target's Score:[-5.1422343, 7.191063, -0.06023284, -0.53645915, -0.6970537, -3.0617177, 11.140188, -3.0427494, -1.7748033, -3.7714884]
Target sample: 67, Prediction:6, Target's Score:[-5.6711674, 9.34745, -0.24673851, -0.48239303, -1.2163062, -3.42281, 10.097432, -3.4570656, -2.4092283, -2.3377612]
Target sample: 73, Prediction:6, Target's Score:[-5.3331842, 7.950655, -0.44446003, -0.70359015, -1.175718, -3.2193782, 10.537686, -3.1322572, -1.6287822, -2.6217124]
Target sample: 79, Prediction:1, Target's Score:[-3.9504528, 8.357029, -0.64433247, -0.61158925, -1.5142559, -2.8301027, 7.942354, -2.543003, -2.1984298, -1.8457297]
Target sample: 85, Prediction:6, Target's Score:[-4.1967783, 6.4906287, -0.028456027, 0.07455372, -1.0422047, -2.6697123, 9.076805, -2.4359915, -1.254018, -3.8134217]
Target sample: 91, Prediction:6, Target's Score:[-4.9168606, 7.824098, -0.816014, 0.15001133, -1.6397876, -2.0286043, 8.685635, -3.1455076, -2.8077946, -1.1329477]
Current ATTACK acc on target samples: 75.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 22:38:50 Epoch 59, Val iteration 0, acc 89.800 (89.800)
2021-06-11 22:38:56 Epoch 59, Val iteration 19, acc 90.600 (89.630)
* Prec: 89.63000106811523
Per class accuracy =  [0.94345256 0.9275057  0.79234007 0.82084259 0.89140414 0.84522298
 0.96446357 0.91695794 0.93260915 0.92383099]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 6, 1, 1, 1, 6, 6, 6, 6, 1, 6, 6, 6, 6
ATTACK acc: 68.42105263157895
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 22:39:03, Val iteration 0, acc 94.800 (94.800)
2021-06-11 22:39:15, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-11 22:39:22, Epoch 0, Iteration 7, loss 0.305 (0.344), acc 88.462 (91.000)
2021-06-11 22:40:48, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-0.9002049, 8.010499, -3.4351897, -2.2650466, -1.9748168, -0.8217597, 5.3631344, -3.210653, 2.3440154, -2.8074107]
Target sample: 7, Prediction:1, Target's Score:[-0.9879511, 7.379063, -3.5472643, -2.6468997, -1.7528092, -0.23781806, 7.3090134, -3.7144036, 0.40854973, -1.9055835]
Target sample: 13, Prediction:1, Target's Score:[-0.66494393, 13.221722, -2.993298, -3.6855996, -2.9481525, -1.3375336, 4.1409917, -4.6941686, -0.5587052, -0.10075529]
Target sample: 19, Prediction:6, Target's Score:[-1.461679, 7.655014, -2.9968638, -2.4610078, -2.5734878, -0.92410755, 7.752644, -3.7335951, 1.3098934, -2.2701905]
Target sample: 25, Prediction:1, Target's Score:[-1.203227, 12.376879, -3.0474114, -3.2632568, -3.0235806, -1.1448106, 5.2681546, -4.600834, -0.6917372, -0.2953023]
Target sample: 31, Prediction:6, Target's Score:[-0.9723003, 7.0848856, -2.6357079, -2.7763827, -1.3890942, -1.2073218, 9.267644, -4.0756216, 0.026420128, -3.0223324]
Target sample: 37, Prediction:1, Target's Score:[-0.34085044, 12.417856, -3.723043, -3.4873712, -2.3332903, -1.2925137, 3.8753645, -4.2549, 0.41725785, -0.9103713]
Target sample: 43, Prediction:1, Target's Score:[-1.397867, 6.985263, -3.9529083, -2.1581504, -1.3466711, -1.3469806, 6.134276, -3.5256975, 2.7431545, -1.8388422]
Target sample: 49, Prediction:1, Target's Score:[-1.0731122, 10.401105, -2.9774344, -3.6140661, -2.498501, -0.8853923, 7.4039555, -4.2520432, -0.26360077, -1.886407]
Target sample: 55, Prediction:1, Target's Score:[-1.8529506, 9.919714, -3.1870697, -2.9557555, -2.0712085, -1.195829, 7.3602986, -4.3964596, -0.2661104, -1.0180041]
Target sample: 61, Prediction:6, Target's Score:[-2.1564758, 6.3008437, -3.3268428, -1.8236712, -1.4183451, -0.84408987, 9.69902, -4.026292, 1.1352304, -3.2413998]
Target sample: 67, Prediction:6, Target's Score:[-2.0478444, 8.139576, -2.8241205, -2.5850654, -2.1322422, -1.0034056, 8.456234, -3.9868126, -0.22568119, -1.4824983]
Target sample: 73, Prediction:1, Target's Score:[-0.570621, 9.222998, -3.6921508, -2.3215995, -2.2220619, -1.3070589, 5.955282, -4.131513, 0.4120722, -1.0253727]
Target sample: 79, Prediction:6, Target's Score:[-1.3378268, 6.12362, -3.443904, -2.1434908, -1.3188736, -1.1018609, 7.569706, -3.385623, 2.1240726, -2.8049426]
Target sample: 85, Prediction:1, Target's Score:[-0.8673184, 8.626369, -3.4986775, -2.3677247, -1.6206548, -0.97914463, 4.983454, -3.4252477, 2.2906902, -2.8325787]
Target sample: 91, Prediction:1, Target's Score:[-0.74389327, 9.353906, -3.6056159, -3.1959264, -2.210885, 0.4853977, 5.71729, -4.0767355, 0.101197645, -1.4870226]
Current ATTACK acc on target samples: 31.250
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 22:42:12 Epoch 59, Val iteration 0, acc 93.400 (93.400)
2021-06-11 22:42:24 Epoch 59, Val iteration 19, acc 91.800 (92.800)
* Prec: 92.80000114440918
Per class accuracy =  [0.95015254 0.95647063 0.91445371 0.84598905 0.94799082 0.87954777
 0.95186255 0.91550182 0.9776801  0.9393138 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 6, 1, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 6, 1, 6, 6, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 1, 6, 1, 6, 1, 1, 1, 1, 1, 1, 6, 1, 1, 6, 1, 1, 1, 6, 1, 1, 1, 1, 1, 6, 1
ATTACK acc: 27.63157894736842
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 22:42:27, Val iteration 0, acc 92.600 (92.600)
2021-06-11 22:42:30, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-11 22:42:31, Epoch 0, Iteration 7, loss 0.456 (0.356), acc 90.385 (90.000)
2021-06-11 22:42:46, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-2.28372, 10.947158, -1.7796905, -1.4150491, -2.766129, -1.4525114, 4.5445576, -3.2561636, -2.8286717, 0.7093257]
Target sample: 7, Prediction:1, Target's Score:[-0.37262684, 9.654962, -0.997676, 1.164663, -3.7947361, -3.0942373, 7.232672, -6.716112, -3.1593223, 0.49767703]
Target sample: 13, Prediction:1, Target's Score:[-1.493176, 10.790552, -2.8165054, -1.9255015, -5.0576634, -1.5300981, 8.086794, -7.2403584, -3.011578, 4.6076]
Target sample: 19, Prediction:1, Target's Score:[-3.1117568, 13.553314, -6.6734037, 2.91757, -5.131392, -2.4790568, 4.5243516, -3.54954, 0.4643735, -0.07414222]
Target sample: 25, Prediction:1, Target's Score:[-3.1297503, 7.204577, -0.90145856, 2.474723, -2.30927, -4.103768, 6.910733, -5.466104, -2.3976846, 2.1244218]
Target sample: 31, Prediction:6, Target's Score:[-1.5868387, 11.351552, -3.6885748, 1.0816544, -6.7799315, -2.2442396, 11.842712, -7.8119583, -4.475229, 2.726449]
Target sample: 37, Prediction:1, Target's Score:[0.043605156, 13.985948, -3.4139285, -1.4358044, -0.26619047, -2.8056352, -0.409551, -4.110777, -3.9693077, 2.880918]
Target sample: 43, Prediction:1, Target's Score:[0.2552661, 14.6222105, -3.529223, 0.70947206, 1.9366742, -4.392093, -2.2376158, -4.225211, -3.4622688, 0.8701132]
Target sample: 49, Prediction:1, Target's Score:[-2.1566432, 10.99335, -0.45423892, 0.29583877, -5.7112913, -2.8667016, 10.88182, -6.4976425, -1.7676989, -2.3013256]
Target sample: 55, Prediction:6, Target's Score:[-1.5732028, 9.276605, -2.7639823, -0.48426643, -4.677967, -3.2568743, 9.529341, -4.094857, -3.4909382, 1.906418]
Target sample: 61, Prediction:6, Target's Score:[-2.458022, 8.02999, -2.7727582, 1.6401529, -1.9014087, -2.6988347, 8.469721, -5.1685414, -1.717037, -1.0472734]
Target sample: 67, Prediction:6, Target's Score:[-2.2512186, 9.034795, -2.4183989, 0.2258175, -4.047305, -3.5558763, 11.254342, -4.759452, -2.154646, -0.95214826]
Target sample: 73, Prediction:1, Target's Score:[-0.4681303, 12.601432, -3.5516381, 0.21914256, -4.593593, -2.7494142, 7.3244915, -5.048064, -3.3189535, 0.010792809]
Target sample: 79, Prediction:1, Target's Score:[-2.0034149, 9.468264, -1.8507107, 1.2453053, 0.64265746, -2.9075303, 4.2077117, -5.197751, -4.4764557, 1.3280061]
Target sample: 85, Prediction:1, Target's Score:[0.91427624, 13.386897, -0.5137835, 0.9959328, -3.293778, -3.740908, -1.08266, -2.667561, -5.118671, 1.6235466]
Target sample: 91, Prediction:1, Target's Score:[-1.6652361, 10.580781, -2.952868, -0.5835098, -4.4809647, -1.5608222, 7.2186027, -5.724402, -3.8008034, 3.3551857]
Current ATTACK acc on target samples: 25.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 22:43:02 Epoch 59, Val iteration 0, acc 90.000 (90.000)
2021-06-11 22:43:05 Epoch 59, Val iteration 19, acc 89.800 (89.480)
* Prec: 89.4800018310547
Per class accuracy =  [0.9244743  0.92254485 0.84934547 0.83357753 0.89073172 0.81806388
 0.93695745 0.88774206 0.93219235 0.94807269]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 6, 6, 6, 1, 6, 6, 6, 1, 6, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 18.42105263157895
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 22:43:09, Val iteration 0, acc 96.200 (96.200)
2021-06-11 22:43:16, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-11 22:43:19, Epoch 0, Iteration 7, loss 0.724 (0.751), acc 78.846 (79.800)
2021-06-11 22:43:51, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-3.884212, 9.78052, -3.6569796, -2.402203, -2.8636549, -3.3024437, 9.010694, -3.1334527, 1.5112162, -0.9967415]
Target sample: 7, Prediction:1, Target's Score:[-3.637266, 10.850565, -4.016198, -2.5603206, -3.559208, -2.781327, 9.159699, -3.050719, -2.0450914, 1.7094792]
Target sample: 13, Prediction:6, Target's Score:[-3.898735, 8.889973, -3.145418, -1.6908456, -2.9284534, -2.4976337, 10.938363, -3.2763147, -0.89102864, -1.4430741]
Target sample: 19, Prediction:6, Target's Score:[-4.1325107, 7.7335577, -3.1074607, -2.8131297, -2.669544, -0.975312, 10.273404, -3.2350867, 0.6980335, -1.7160524]
Target sample: 25, Prediction:1, Target's Score:[-3.701509, 10.932094, -4.020525, -1.2326443, -3.221598, -2.5232568, 9.146084, -3.4068997, -1.3431714, -0.5688248]
Target sample: 31, Prediction:6, Target's Score:[-4.0084105, 8.8111925, -2.710797, -2.5624914, -3.144592, -2.4557548, 10.878572, -3.179176, -0.9287493, -0.63959354]
Target sample: 37, Prediction:1, Target's Score:[-3.4969532, 11.605458, -3.8896883, -2.7334702, -2.5033746, -3.8501644, 9.014368, -3.119219, -1.2138678, 0.25498086]
Target sample: 43, Prediction:1, Target's Score:[-3.4873729, 11.540783, -3.9924457, -2.829435, -2.7128575, -3.40188, 7.64583, -3.2111087, -0.585681, 1.1021296]
Target sample: 49, Prediction:1, Target's Score:[-4.4965615, 11.980542, -2.95376, -2.3752384, -3.2453082, -3.2596512, 9.2249365, -3.1981845, -0.79890305, -0.81225854]
Target sample: 55, Prediction:6, Target's Score:[-3.603744, 6.8195024, -3.1471272, -2.460074, -3.3494096, -2.3241131, 13.584457, -3.042754, -0.7336057, -1.6820246]
Target sample: 61, Prediction:6, Target's Score:[-4.8909197, 6.0698066, -3.7737215, -3.078119, -2.2222383, -1.8885483, 14.071468, -3.2254562, 2.6724987, -3.673867]
Target sample: 67, Prediction:6, Target's Score:[-3.7460344, 9.942246, -2.6729481, -2.1935363, -3.8966634, -2.8024065, 10.555997, -3.5232997, -1.5073322, -0.087572284]
Target sample: 73, Prediction:1, Target's Score:[-3.0703554, 10.402196, -3.3922768, -1.9621923, -2.3428788, -3.1058495, 8.379732, -2.843488, -1.3009788, -0.70556957]
Target sample: 79, Prediction:1, Target's Score:[-3.542978, 11.443827, -3.6995006, -2.2021143, -2.3744147, -4.2092795, 8.608165, -2.793437, -1.1879826, 0.022747211]
Target sample: 85, Prediction:1, Target's Score:[-3.6194153, 9.3418865, -2.5655868, -1.8750821, -1.6840959, -3.4635823, 6.6388807, -2.6493409, 0.6603485, -0.72767466]
Target sample: 91, Prediction:6, Target's Score:[-4.556555, 9.282229, -3.8699913, -3.2873597, -3.5976102, -2.435361, 12.838093, -3.6898415, -1.84872, 1.2386856]
Current ATTACK acc on target samples: 43.750
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 22:44:23 Epoch 59, Val iteration 0, acc 93.200 (93.200)
2021-06-11 22:44:30 Epoch 59, Val iteration 19, acc 93.200 (92.700)
* Prec: 92.70000114440919
Per class accuracy =  [0.94735583 0.95191382 0.85138536 0.84291462 0.95856282 0.91161105
 0.96725867 0.9321796  0.96578636 0.94020814]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 1, 6, 1, 1, 6, 1, 6, 6, 1, 1, 1, 6, 1, 6, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 1
ATTACK acc: 51.31578947368421
--------
------SUMMARY PRE DEFENSE------
TIME ELAPSED (mins): 12
TARGET INDEX: 11
ResNet50 75.0 68.42105263157895 95.46000137329102 89.63000106811523
DPN92 31.25 27.63157894736842 95.50000267028808 92.80000114440918
MobileNetV2 25.0 18.42105263157895 91.22000160217286 89.4800018310547
GoogLeNet 43.75 51.31578947368421 95.41000213623047 92.70000114440919
DEFENSE EVALUATION
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
ResNet50
[74, 80, 84, 86, 89] 5
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 22:44:35, Val iteration 0, acc 94.200 (94.200)
2021-06-11 22:44:40, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-11 22:44:41, Epoch 0, Iteration 7, loss 0.270 (0.298), acc 92.308 (93.800)
2021-06-11 22:45:09, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[3.1334348, 19.196545, -2.9586945, -2.084603, -6.926721, -5.354777, -2.8615518, -4.282557, 3.4760377, -0.844481]
Target sample: 7, Prediction:1, Target's Score:[1.8209548, 17.693932, -3.3095756, -1.9562535, -6.347575, -4.302526, -3.013701, -4.055305, -0.83808434, 4.775631]
Target sample: 13, Prediction:1, Target's Score:[0.57423383, 14.563784, -1.9300091, -1.5162158, -5.8323903, -4.304728, -2.7179742, -3.5855248, -2.9223654, 8.11805]
Target sample: 19, Prediction:1, Target's Score:[2.2743804, 15.295249, -3.6437838, -0.52128, -5.7458115, -3.771993, -2.2588017, -3.6784482, 0.4139056, 2.0475807]
Target sample: 25, Prediction:1, Target's Score:[1.7908227, 18.389189, -1.2843326, -1.8016468, -6.383396, -5.400929, -2.5858421, -4.2369757, -1.2187071, 3.2239392]
Target sample: 31, Prediction:1, Target's Score:[1.3542434, 18.266798, -2.1775074, -0.9226936, -6.5933447, -4.863058, -2.570902, -4.3282385, -1.3358189, 3.6565533]
Target sample: 37, Prediction:1, Target's Score:[2.3137033, 18.380156, -2.8300924, -2.3312786, -6.319531, -4.966009, -3.1794908, -4.1466794, 0.4306778, 3.1249917]
Target sample: 43, Prediction:1, Target's Score:[3.3104587, 17.84971, -2.6362603, -2.5788658, -6.2200375, -4.7672443, -3.1957757, -4.0844088, 0.53161055, 2.2680764]
Target sample: 49, Prediction:1, Target's Score:[2.505573, 19.450731, -2.5737846, -2.388742, -6.6322575, -5.1653385, -2.511893, -3.8857944, 0.58510524, 1.0926845]
Target sample: 55, Prediction:1, Target's Score:[0.4615131, 14.8080635, -2.9700167, -1.3670676, -5.6449547, -4.3891673, -2.3684845, -2.9092176, -0.6975712, 5.4885573]
Target sample: 61, Prediction:1, Target's Score:[1.7270308, 15.241104, -3.4334526, -1.1683059, -5.44083, -3.8676603, -0.88618696, -3.4925747, 1.4040585, 0.30102152]
Target sample: 67, Prediction:1, Target's Score:[1.4704453, 16.340466, -2.6009893, -1.6393154, -5.929961, -4.738758, -2.304195, -3.368176, -0.24435338, 3.4474664]
Target sample: 73, Prediction:1, Target's Score:[2.6619787, 18.987005, -3.2380888, -1.1781182, -6.6783957, -4.9049187, -2.4221075, -4.2260156, 0.69297665, 0.79120225]
Target sample: 79, Prediction:1, Target's Score:[2.5341828, 21.258, -3.4061975, -2.3836348, -7.0480857, -5.596563, -3.2430258, -4.393718, 0.6790646, 2.11879]
Target sample: 85, Prediction:1, Target's Score:[3.3588338, 18.019983, -2.6507304, -1.6023874, -6.7826805, -5.3008275, -2.9145048, -4.2393737, 3.913361, -1.3204677]
Target sample: 91, Prediction:1, Target's Score:[2.883425, 18.729586, -3.0343466, -2.2315705, -6.5424767, -4.530619, -2.942055, -4.1469145, -0.59498674, 2.8877065]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 22:45:37 Epoch 59, Val iteration 0, acc 93.400 (93.400)
2021-06-11 22:45:43 Epoch 59, Val iteration 19, acc 93.400 (92.170)
* Prec: 92.17000122070313
Per class accuracy =  [0.95435993 0.96032077 0.88558796 0.84229351 0.92862056 0.88424414
 0.95563851 0.90443069 0.94918276 0.94916764]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
DPN92
[74, 80, 84, 86, 89] 27
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 22:45:46, Val iteration 0, acc 94.800 (94.800)
2021-06-11 22:45:58, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-11 22:46:01, Epoch 0, Iteration 7, loss 0.310 (0.393), acc 92.308 (90.000)
2021-06-11 22:47:27, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-0.6684382, 18.42554, -3.7373433, -1.2762524, -4.51786, -4.1430655, -2.0652642, -4.10486, 3.0516605, -0.3564438]
Target sample: 7, Prediction:1, Target's Score:[-0.7703275, 17.46721, -3.9365902, -0.82486564, -4.3119383, -3.8809552, -1.8203675, -4.503649, 1.4051355, 1.8179702]
Target sample: 13, Prediction:1, Target's Score:[-1.1231555, 18.517864, -3.7049232, -1.0539854, -4.543446, -4.441506, -1.7669246, -4.656707, 1.5919911, 1.8203775]
Target sample: 19, Prediction:1, Target's Score:[-1.4340822, 15.154352, -2.92341, -1.0711701, -4.0101724, -3.8851376, -1.2511733, -3.6012728, 3.1615407, 0.39335045]
Target sample: 25, Prediction:1, Target's Score:[-1.891532, 19.027449, -3.5623293, -0.17530513, -4.509607, -4.5899553, -1.9563249, -4.6998224, 1.3461959, 1.6827148]
Target sample: 31, Prediction:1, Target's Score:[-0.28855252, 17.372656, -2.9975898, -0.67010844, -4.177955, -4.24588, -2.0167272, -4.4280477, 1.1453851, 0.93179494]
Target sample: 37, Prediction:1, Target's Score:[-0.42628834, 19.532743, -3.8751194, -1.5680935, -4.3934774, -4.0430927, -2.5476444, -4.6157517, 1.7767031, 0.8101199]
Target sample: 43, Prediction:1, Target's Score:[-0.33115, 17.63915, -4.009098, -1.0423144, -4.0907273, -4.0362964, -2.2296276, -4.3757114, 2.193415, 0.8870229]
Target sample: 49, Prediction:1, Target's Score:[-0.69978064, 19.01987, -3.3972328, -1.3385109, -4.608146, -4.0101957, -1.720828, -4.503174, 1.8494236, 0.05928882]
Target sample: 55, Prediction:1, Target's Score:[-1.3450464, 17.04433, -3.5274203, -1.28291, -3.9806657, -4.0926347, -1.5606304, -4.4043107, 1.3250405, 2.4440084]
Target sample: 61, Prediction:1, Target's Score:[-1.7566719, 17.062462, -4.062623, -0.118825056, -3.8487272, -4.0366178, -1.2821336, -4.286191, 2.3758588, 0.55668646]
Target sample: 67, Prediction:1, Target's Score:[-1.8598996, 17.452116, -3.5892599, -0.7422333, -4.184127, -4.306821, -1.140269, -4.1678586, 2.0094476, 1.1450012]
Target sample: 73, Prediction:1, Target's Score:[-0.53975916, 18.546503, -3.9230943, -0.94570065, -4.4520893, -4.348351, -1.9537048, -4.567766, 1.8597143, 0.9585411]
Target sample: 79, Prediction:1, Target's Score:[-0.56806695, 18.048492, -3.8665814, -1.0151125, -4.4427505, -4.3106375, -1.9026911, -4.2690167, 2.312839, 0.6313887]
Target sample: 85, Prediction:1, Target's Score:[-1.0232676, 18.241116, -3.7861638, -1.0507979, -4.295925, -4.1105366, -2.0159016, -4.1660275, 3.0131104, -0.20463617]
Target sample: 91, Prediction:1, Target's Score:[-0.82609046, 18.699547, -3.7918112, -1.0967226, -4.566315, -3.0883913, -2.468627, -4.762676, 1.7494497, 0.82087916]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 22:48:51 Epoch 59, Val iteration 0, acc 93.600 (93.600)
2021-06-11 22:49:02 Epoch 59, Val iteration 19, acc 93.200 (93.360)
* Prec: 93.36000175476075
Per class accuracy =  [0.95397337 0.97312657 0.90478188 0.84821291 0.94766038 0.89774399
 0.95165931 0.9420808  0.97249044 0.94900541]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
MobileNetV2
[80, 86, 89] 45
Using Adam for retraining
2000
poison index =  74
poison index =  84
498
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 22:49:05, Val iteration 0, acc 92.600 (92.600)
2021-06-11 22:49:08, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-11 22:49:09, Epoch 0, Iteration 7, loss 0.299 (0.304), acc 82.692 (90.400)
2021-06-11 22:49:24, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.5601456, 11.720923, -1.4025071, -1.4511346, -3.1652844, -1.8786647, 3.2147732, -3.56498, -2.8230665, 1.4450097]
Target sample: 7, Prediction:1, Target's Score:[0.08759953, 10.696941, -1.3903688, 0.9587544, -4.309987, -3.1387146, 5.7823358, -6.3740807, -3.0004935, 1.2550102]
Target sample: 13, Prediction:1, Target's Score:[-0.68735147, 12.867316, -3.081681, -2.311364, -5.8280196, -1.6500951, 4.964182, -7.093007, -2.4540982, 5.8627872]
Target sample: 19, Prediction:1, Target's Score:[-2.3535464, 15.330681, -6.855857, 2.5896823, -5.775032, -2.622403, 2.712729, -3.6735823, 0.30641788, 0.95658284]
Target sample: 25, Prediction:1, Target's Score:[-2.1140285, 8.841522, -1.582904, 2.0215573, -2.8373322, -4.4189515, 4.514225, -5.0529833, -1.6008693, 2.7705257]
Target sample: 31, Prediction:1, Target's Score:[-0.947109, 13.188918, -4.2228365, 1.0573373, -7.411634, -2.3073263, 9.522149, -7.793314, -4.3195176, 3.851826]
Target sample: 37, Prediction:1, Target's Score:[0.4715516, 14.633053, -3.1681042, -1.3511996, -0.89307386, -2.9382176, -1.9291952, -4.268414, -3.7586715, 3.8612645]
Target sample: 43, Prediction:1, Target's Score:[0.6964499, 15.3807535, -2.9886286, 0.35228997, 1.9124061, -4.490413, -3.5724816, -4.4297166, -3.654494, 1.5255214]
Target sample: 49, Prediction:1, Target's Score:[-1.3170131, 12.7488785, -0.9244509, 0.0739689, -6.5013304, -2.8010595, 8.091477, -5.985989, -1.3421118, -1.5025542]
Target sample: 55, Prediction:1, Target's Score:[-0.90736324, 11.388184, -3.1816025, -0.72198147, -5.304222, -3.3825874, 6.779446, -4.0779796, -3.1716478, 3.1071393]
Target sample: 61, Prediction:1, Target's Score:[-1.9851913, 9.714168, -3.3881829, 1.688797, -2.3905034, -2.695315, 5.966167, -4.9856653, -1.0436844, -0.3604796]
Target sample: 67, Prediction:1, Target's Score:[-1.2213482, 12.023994, -3.243391, -0.3822534, -5.082748, -3.9154549, 8.636763, -5.098478, -1.4353778, 0.2531463]
Target sample: 73, Prediction:1, Target's Score:[0.35724133, 15.203945, -4.1297607, -0.015777126, -5.9450593, -2.790056, 4.4720483, -4.94075, -2.8046973, 1.2072272]
Target sample: 79, Prediction:1, Target's Score:[-1.5400438, 11.084345, -1.7859161, 1.1403545, -0.16633779, -3.2142873, 2.4924967, -5.3816566, -4.4611087, 2.456185]
Target sample: 85, Prediction:1, Target's Score:[1.3478713, 14.276733, -0.75889695, 1.1145363, -3.6603816, -4.0644326, -2.0475407, -3.1322293, -5.113744, 2.712069]
Target sample: 91, Prediction:1, Target's Score:[-1.2202165, 12.079636, -3.420863, -0.9008462, -4.9465785, -1.7116158, 4.987966, -5.347588, -3.7208743, 4.7469263]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 22:49:39 Epoch 59, Val iteration 0, acc 90.000 (90.000)
2021-06-11 22:49:42 Epoch 59, Val iteration 19, acc 90.000 (89.490)
* Prec: 89.49000053405761
Per class accuracy =  [0.92410855 0.92735042 0.83851343 0.83303239 0.88888737 0.82374354
 0.93929198 0.8899693  0.93309383 0.94768575]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 5.2631578947368425
GoogLeNet
[74, 80, 84, 86, 89] 22
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 22:49:45, Val iteration 0, acc 96.200 (96.200)
2021-06-11 22:49:52, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-11 22:49:53, Epoch 0, Iteration 7, loss 0.977 (0.946), acc 69.231 (78.600)
2021-06-11 22:50:25, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-3.4482923, 18.868223, -2.8782032, -1.0639616, -4.136281, -5.030242, -1.7017862, -3.0609388, -0.15137234, 2.6244504]
Target sample: 7, Prediction:1, Target's Score:[-4.088695, 19.382723, -3.1047463, 0.0773896, -4.8517528, -3.8002536, -1.3980961, -3.7500906, -2.6733015, 4.23171]
Target sample: 13, Prediction:1, Target's Score:[-3.9455276, 17.941559, -2.0772283, -0.6299467, -4.8165135, -4.6065016, 2.4286551, -3.351634, -1.6798667, 0.75214124]
Target sample: 19, Prediction:1, Target's Score:[-3.8057613, 13.328496, -1.3805813, -2.6996114, -4.2426295, -0.98013437, 0.23519835, -2.778948, 0.4441925, 1.9053953]
Target sample: 25, Prediction:1, Target's Score:[-3.2133107, 17.234003, -2.4755356, 1.886351, -4.3870044, -4.566523, -0.056726005, -3.519924, -2.459801, 1.5711818]
Target sample: 31, Prediction:1, Target's Score:[-4.0619807, 17.754047, -1.678949, -0.11036497, -4.029854, -4.833016, -0.5087004, -3.3796368, -1.7616527, 2.634073]
Target sample: 37, Prediction:1, Target's Score:[-3.863628, 20.829721, -3.2406795, -1.4115663, -4.1377244, -5.487055, -1.7322476, -3.7132869, -1.0583216, 3.8366144]
Target sample: 43, Prediction:1, Target's Score:[-3.1527953, 18.791897, -3.099013, -2.1053548, -3.1661978, -4.950898, -1.6221542, -3.7696624, -0.476087, 3.5730643]
Target sample: 49, Prediction:1, Target's Score:[-4.715555, 19.703083, -1.9445407, -0.44737577, -3.4655447, -5.892199, 0.07103339, -3.5442243, -1.250088, 1.5024235]
Target sample: 55, Prediction:1, Target's Score:[-3.422191, 12.406355, -1.4087669, -1.9174557, -3.9601429, -4.007711, 3.6328151, -3.4303293, -1.3881876, 3.5155408]
Target sample: 61, Prediction:1, Target's Score:[-4.5817647, 12.601454, -1.5827326, -2.3165867, -2.6677568, -3.0885332, 3.3128028, -3.7283154, 2.6187074, -0.565413]
Target sample: 67, Prediction:1, Target's Score:[-4.503727, 18.717453, -0.6224761, -1.1547728, -5.43529, -4.585009, 0.6364177, -3.1806798, -2.0026104, 2.159091]
Target sample: 73, Prediction:1, Target's Score:[-3.597086, 15.687075, -0.58413446, -0.30725408, -3.161452, -4.7902412, -0.32051173, -3.0650787, -1.9703059, 2.1321187]
Target sample: 79, Prediction:1, Target's Score:[-3.720397, 17.69628, -1.648204, -0.7024144, -2.7526677, -5.958347, -1.3326159, -2.8318462, -1.797378, 3.0701697]
Target sample: 85, Prediction:1, Target's Score:[-3.7855306, 18.774282, -2.093912, 0.1833986, -3.379041, -5.213644, -2.0654066, -3.323818, -1.1971748, 2.1227782]
Target sample: 91, Prediction:1, Target's Score:[-3.979221, 18.787298, -3.1599655, -1.9407961, -4.3540993, -3.7573402, 0.90405434, -4.166326, -2.5232828, 4.2139535]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 22:50:58 Epoch 59, Val iteration 0, acc 92.200 (92.200)
2021-06-11 22:51:04 Epoch 59, Val iteration 19, acc 92.600 (92.360)
* Prec: 92.3600009918213
Per class accuracy =  [0.93551607 0.95118843 0.82361327 0.84525868 0.95221218 0.897425
 0.96196873 0.94518264 0.95554225 0.96454608]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
------SUMMARY POST DEFENSE------
TIME ELAPSED (mins): 12
TARGET INDEX: 11
ResNet50 0.0 0.0 95.46000137329102 92.17000122070313 100.0
DPN92 0.0 0.0 95.50000267028808 93.36000175476075 100.0
MobileNetV2 0.0 5.2631578947368425 91.22000160217286 89.49000053405761 60.0
GoogLeNet 0.0 0.0 95.41000213623047 92.3600009918213 100.0
True False False False True
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.300-droplayer0.000.t7
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
No specific indices are determined, so try to include whatever we find
In total, we found 119 images of target 12
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', eval_poisons_root='', feat_reg_flag=False, gpu='1', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=12, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/12/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115]
# Targets: 20, # Poisons: 5
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 22:51:23 Iteration 0 	 Training Loss: 8.592e-01 	 Loss in Target Net: 1.121e+00	  
 2021-06-11 22:52:03 Iteration 50 	 Training Loss: 3.615e-01 	 Loss in Target Net: 3.304e-01	  
 2021-06-11 22:52:37 Iteration 100 	 Training Loss: 3.246e-01 	 Loss in Target Net: 3.433e-01	  
 2021-06-11 22:53:11 Iteration 150 	 Training Loss: 3.192e-01 	 Loss in Target Net: 3.573e-01	  
 2021-06-11 22:53:45 Iteration 200 	 Training Loss: 3.110e-01 	 Loss in Target Net: 3.523e-01	  
 2021-06-11 22:54:18 Iteration 250 	 Training Loss: 3.115e-01 	 Loss in Target Net: 3.586e-01	  
 2021-06-11 22:54:52 Iteration 300 	 Training Loss: 3.046e-01 	 Loss in Target Net: 3.495e-01	  
 2021-06-11 22:55:25 Iteration 350 	 Training Loss: 3.060e-01 	 Loss in Target Net: 3.561e-01	  
 2021-06-11 22:55:58 Iteration 400 	 Training Loss: 3.047e-01 	 Loss in Target Net: 3.654e-01	  
 2021-06-11 22:56:31 Iteration 450 	 Training Loss: 3.075e-01 	 Loss in Target Net: 3.773e-01	  
 2021-06-11 22:57:04 Iteration 500 	 Training Loss: 3.039e-01 	 Loss in Target Net: 3.880e-01	  
 2021-06-11 22:57:36 Iteration 550 	 Training Loss: 3.054e-01 	 Loss in Target Net: 3.709e-01	  
 2021-06-11 22:58:10 Iteration 600 	 Training Loss: 3.044e-01 	 Loss in Target Net: 3.724e-01	  
 2021-06-11 22:58:43 Iteration 650 	 Training Loss: 3.045e-01 	 Loss in Target Net: 3.865e-01	  
 2021-06-11 22:59:18 Iteration 700 	 Training Loss: 3.060e-01 	 Loss in Target Net: 3.818e-01	  
 2021-06-11 22:59:52 Iteration 750 	 Training Loss: 2.996e-01 	 Loss in Target Net: 3.713e-01	  
 2021-06-11 23:00:25 Iteration 800 	 Training Loss: 3.040e-01 	 Loss in Target Net: 3.818e-01	  
 2021-06-11 23:00:58 Iteration 850 	 Training Loss: 3.073e-01 	 Loss in Target Net: 3.913e-01	  
 2021-06-11 23:01:32 Iteration 900 	 Training Loss: 3.016e-01 	 Loss in Target Net: 3.827e-01	  
 2021-06-11 23:02:05 Iteration 950 	 Training Loss: 3.067e-01 	 Loss in Target Net: 3.845e-01	  
 2021-06-11 23:02:39 Iteration 999 	 Training Loss: 3.043e-01 	 Loss in Target Net: 3.640e-01	  
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:02:42, Val iteration 0, acc 94.200 (94.200)
2021-06-11 23:02:48, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-11 23:02:50, Epoch 0, Iteration 7, loss 0.648 (0.514), acc 78.846 (88.600)
2021-06-11 23:03:21, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-2.8714936, 13.089358, -1.7141725, -2.3182962, -2.9955812, -3.4213705, 5.266874, -2.6369674, -1.8762323, -0.5690143]
Target sample: 7, Prediction:6, Target's Score:[-0.018664092, 4.214603, -2.1511197, -1.2254313, -2.7928221, -3.2016678, 5.5203104, -2.5552576, 2.7319417, -0.46554425]
Target sample: 13, Prediction:6, Target's Score:[-0.26724315, 4.723883, -3.0472832, -0.7659824, -2.6725962, -3.1516724, 5.2924013, -2.2303398, 1.8018836, 0.3705005]
Target sample: 19, Prediction:6, Target's Score:[1.5776383, 2.5818741, -0.5168167, -1.4649446, -2.1017404, -3.0249975, 4.63457, -1.800407, -0.81136954, 0.9624833]
Target sample: 25, Prediction:1, Target's Score:[-2.375546, 10.647522, -0.9926939, -2.3970046, -2.748992, -3.1540627, 5.19274, -2.364995, -2.0394933, 0.20118551]
Target sample: 31, Prediction:1, Target's Score:[-1.6108258, 7.096072, -1.6256297, -0.9961113, -2.4109094, -2.7764382, 5.78883, -1.9631993, -1.5976186, 0.11686713]
Target sample: 37, Prediction:1, Target's Score:[-2.4251242, 12.067584, -2.179186, -1.7575148, -2.7649977, -2.6697848, 4.165333, -1.7807096, -1.5830618, -1.1208972]
Target sample: 43, Prediction:1, Target's Score:[-1.6390216, 7.7830567, -2.0309143, -0.6191187, -2.4199908, -2.4646437, 4.706144, -1.7789139, -0.29091385, -1.2378037]
Target sample: 49, Prediction:1, Target's Score:[-2.3508322, 9.398162, -1.5826236, -1.6991508, -2.1801746, -2.572077, 4.6431713, -1.8910272, -1.9638463, 0.17438644]
Target sample: 55, Prediction:6, Target's Score:[-2.325265, 4.510147, -0.7619115, -1.3639455, -1.463074, -2.7174444, 5.000212, -2.4350903, -2.1171293, 3.6883142]
Target sample: 61, Prediction:6, Target's Score:[-1.8414226, 5.8496685, -1.9516146, -1.037577, -2.5277786, -2.9630728, 6.0701203, -2.549929, -0.76816845, 1.7574044]
Target sample: 67, Prediction:1, Target's Score:[-1.3377186, 11.167763, -2.1680005, -1.1808474, -3.4064867, -2.8140996, 4.4520082, -2.3116972, -0.8788661, -1.5492243]
Target sample: 73, Prediction:1, Target's Score:[-1.806588, 9.856266, -2.5315561, -0.9955448, -2.746013, -2.5539954, 3.8044734, -1.1879451, -1.6749532, -0.19502468]
Target sample: 79, Prediction:1, Target's Score:[-2.1776366, 10.7619095, -1.8058233, -1.5418911, -2.6547632, -2.798443, 4.123419, -2.023, -2.441593, 0.5149185]
Target sample: 85, Prediction:1, Target's Score:[-2.5327306, 6.539072, -1.5390923, -1.2009541, -1.8896067, -2.5770454, 4.766642, -1.8943124, -1.7514654, 2.0832622]
Target sample: 91, Prediction:1, Target's Score:[-2.4699142, 6.0151515, -1.0837468, -0.61970806, -1.7294173, -2.759384, 5.2928767, -1.9819864, -1.9500234, 1.3016114]
Target sample: 97, Prediction:1, Target's Score:[-2.2025602, 11.318133, -1.7989058, -1.6949474, -2.6679604, -2.6595254, 4.4457145, -1.9612511, -1.662565, -1.1540203]
Target sample: 103, Prediction:1, Target's Score:[-2.3828917, 11.671786, -1.4566664, -1.7452866, -2.8066726, -2.7956996, 5.0123854, -2.1778336, -2.088115, -1.2694986]
Target sample: 109, Prediction:1, Target's Score:[-2.7452896, 10.285906, -1.9336455, -1.9333639, -2.393191, -2.8572643, 5.2975435, -2.021161, -1.6676056, -0.0488509]
Target sample: 115, Prediction:6, Target's Score:[-1.5388452, 1.6259915, -1.0986321, -2.1584313, -1.3803126, -4.204237, 7.458056, -3.3114834, -0.26895604, 4.950462]
Current ATTACK acc on target samples: 30.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 23:03:52 Epoch 59, Val iteration 0, acc 90.200 (90.200)
2021-06-11 23:03:58 Epoch 59, Val iteration 19, acc 91.200 (90.810)
* Prec: 90.81000137329102
Per class accuracy =  [0.9406876  0.95071702 0.84041976 0.83153564 0.91431878 0.84981908
 0.96460746 0.90850414 0.9510905  0.93162899]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 6, 1, 6, 6, 6, 1, 8, 8, 1, 1, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 1
ATTACK acc: 16.161616161616163
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:04:05, Val iteration 0, acc 94.800 (94.800)
2021-06-11 23:04:17, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-11 23:04:24, Epoch 0, Iteration 7, loss 0.286 (0.436), acc 92.308 (89.600)
2021-06-11 23:05:50, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.0436494, 12.334195, -4.028029, -2.092864, -1.9340945, -3.6552138, 1.267861, -4.3674855, 1.1863458, 2.8610375]
Target sample: 7, Prediction:1, Target's Score:[-0.88752353, 5.927816, -2.8168726, -2.416201, -1.5179241, -5.0814786, 5.232348, -4.599221, 2.7528505, 3.887254]
Target sample: 13, Prediction:8, Target's Score:[0.64603436, 5.391944, -3.5517447, -2.5647848, -3.4093301, -5.73476, -0.40524167, -4.003401, 9.524863, 4.667296]
Target sample: 19, Prediction:9, Target's Score:[-1.1486061, 1.3552339, -1.9212959, -2.470496, -1.1581794, -4.20408, 4.6515913, -3.4863243, 0.52615786, 8.296939]
Target sample: 25, Prediction:1, Target's Score:[-1.3834656, 10.430903, -3.859715, -2.0742178, -1.7586534, -3.7197385, 1.4024938, -4.3924522, 1.9758785, 3.8967032]
Target sample: 31, Prediction:1, Target's Score:[-0.1170219, 10.644812, -3.9330368, -2.274917, -3.351103, -3.559981, 4.364233, -4.0554314, 0.75588745, 2.0614192]
Target sample: 37, Prediction:1, Target's Score:[-0.9118912, 15.893322, -4.6065083, -2.7839448, -3.5642207, -3.5519133, 0.08319684, -4.1851535, 2.3336964, 1.9017149]
Target sample: 43, Prediction:1, Target's Score:[-0.31437397, 12.662601, -4.873651, -3.221284, -3.452264, -4.52419, 0.17072475, -4.44299, 3.101813, 5.4717364]
Target sample: 49, Prediction:1, Target's Score:[-0.7998818, 10.789693, -3.8881245, -3.5511982, -3.295585, -2.0683968, 3.189002, -3.7621846, -0.28130245, 4.2185307]
Target sample: 55, Prediction:9, Target's Score:[-1.485442, 4.489763, -2.0010402, -1.5870001, -2.161135, -2.5038898, 0.9600963, -3.3355372, -0.2524334, 8.31903]
Target sample: 61, Prediction:9, Target's Score:[-0.23544744, 6.1202583, -4.311753, -2.729032, -3.4338198, -3.5961473, 0.43427485, -3.8523505, 1.5161444, 10.614598]
Target sample: 67, Prediction:8, Target's Score:[-1.4693656, 6.47781, -4.9024963, -1.3627621, -3.1079292, -5.1270933, -0.42703983, -3.8528514, 8.676854, 5.652337]
Target sample: 73, Prediction:9, Target's Score:[1.0439974, 7.106505, -4.048938, -2.5163314, -3.011856, -3.3308682, 0.8771703, -3.4148598, 0.17909455, 7.6043696]
Target sample: 79, Prediction:1, Target's Score:[-0.601298, 13.056127, -5.068091, -1.9430714, -3.6304607, -3.00277, 2.004883, -3.9025178, 0.49930894, 3.1622574]
Target sample: 85, Prediction:1, Target's Score:[0.91972136, 11.192787, -3.9289403, -3.1169736, -3.4096212, -2.2033854, 1.8333437, -4.007324, 0.098017134, 3.1661673]
Target sample: 91, Prediction:1, Target's Score:[-0.09494053, 11.480444, -4.464206, -2.1793969, -3.4922042, -3.7679722, 2.1186304, -4.689863, 1.1729174, 4.4788156]
Target sample: 97, Prediction:1, Target's Score:[-0.46391633, 13.516653, -4.412693, -2.599699, -2.3899276, -3.3400643, 1.2354993, -4.026648, 2.0530372, 0.97102153]
Target sample: 103, Prediction:1, Target's Score:[0.17721368, 13.627277, -3.9981241, -2.7570605, -2.0279772, -3.1503818, 0.23986278, -4.3029566, 0.21406415, 2.5398903]
Target sample: 109, Prediction:1, Target's Score:[-1.2976243, 12.935723, -4.698399, -1.8614875, -2.4323895, -3.1950662, 1.193026, -4.567726, 0.8349093, 3.6501381]
Target sample: 115, Prediction:9, Target's Score:[-0.362771, 2.732512, -3.3042283, -2.7168639, -3.052668, -4.40632, 0.99330515, -3.7408664, 1.0902722, 13.294202]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 23:07:13 Epoch 59, Val iteration 0, acc 92.200 (92.200)
2021-06-11 23:07:25 Epoch 59, Val iteration 19, acc 93.200 (92.920)
* Prec: 92.92000160217285
Per class accuracy =  [0.93968347 0.96389896 0.89812123 0.88033228 0.95483147 0.87588464
 0.9419256  0.9111074  0.97611926 0.95004903]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 9, 9, 9, 8, 9, 8, 8, 8, 8, 1, 1, 9, 1, 6, 9, 6, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 9, 9, 9, 9, 9, 9, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 9, 1, 9, 9, 9, 1
ATTACK acc: 2.0202020202020203
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:07:28, Val iteration 0, acc 92.600 (92.600)
2021-06-11 23:07:31, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-11 23:07:32, Epoch 0, Iteration 7, loss 0.586 (0.366), acc 82.692 (91.000)
2021-06-11 23:07:47, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.2763885, 10.646706, -5.2330694, 3.9484465, -8.09734, -0.39277297, 4.141332, -7.790023, -1.0847011, 5.38614]
Target sample: 7, Prediction:6, Target's Score:[-0.48217723, 4.4399867, -5.557239, 1.3102841, -6.214356, -3.0661457, 8.751724, -6.6681924, 7.3184614, 0.34987104]
Target sample: 13, Prediction:1, Target's Score:[-2.2599056, 11.084806, -4.4451146, 1.1616708, -6.90396, -1.8855201, 4.6152134, -6.825352, 4.940077, 0.7635244]
Target sample: 19, Prediction:6, Target's Score:[-1.3837215, 4.2536774, -4.6369996, 4.180854, -5.4114137, -2.1395056, 7.781903, -6.31503, -0.74423915, 4.6048894]
Target sample: 25, Prediction:1, Target's Score:[-0.548591, 9.354596, -2.7481587, -1.8129627, -4.4745393, -1.9337908, 6.4083514, -5.188819, -2.4093611, 3.529522]
Target sample: 31, Prediction:1, Target's Score:[0.86823875, 10.131487, -5.271023, -0.2757026, -3.541466, -2.782296, 6.0504584, -4.236077, -0.5329072, -0.21965514]
Target sample: 37, Prediction:1, Target's Score:[-1.1231765, 18.845213, -4.0304976, 0.16047052, -7.6391616, -0.7193844, -0.78011876, -6.232984, 0.5753801, 1.2564812]
Target sample: 43, Prediction:1, Target's Score:[0.8466373, 8.085967, -4.1841993, 0.7968774, -3.9419568, -3.677556, -1.4157836, -3.4416776, 3.9051752, 3.2440352]
Target sample: 49, Prediction:1, Target's Score:[-2.4673634, 10.11049, -3.9365861, 0.51446724, -5.864824, -0.40409398, 4.607219, -5.2732954, -1.7925669, 4.726109]
Target sample: 55, Prediction:6, Target's Score:[-2.0396154, 7.4314704, -4.5333624, 1.4931588, -7.3152, -1.2452722, 7.6951714, -5.6829715, -2.0961647, 6.470857]
Target sample: 61, Prediction:1, Target's Score:[-0.2405636, 10.317815, -4.3181677, -0.4735029, -7.315528, -1.8215051, 7.1549487, -6.8774395, 3.698066, 0.08891533]
Target sample: 67, Prediction:1, Target's Score:[-0.5456251, 6.907518, -3.685724, -0.35137555, -6.4171953, -2.3629436, 1.5057435, -5.8545284, 6.3036847, 4.705261]
Target sample: 73, Prediction:1, Target's Score:[-3.9332685, 7.1058145, -4.1306667, 1.97282, -3.0851152, -1.4207257, 6.895261, -5.583274, 0.38881826, 2.0212617]
Target sample: 79, Prediction:1, Target's Score:[0.10070322, 11.4169235, -4.3899293, 0.18094206, -4.8829236, 0.073723525, -0.26309, -2.9557564, -3.3646774, 4.305378]
Target sample: 85, Prediction:1, Target's Score:[0.7877893, 10.430004, -4.009983, -1.1074357, -6.1566014, -1.6432229, 5.2354245, -4.142272, -1.734156, 2.5213857]
Target sample: 91, Prediction:1, Target's Score:[-0.65334404, 11.979155, -3.554496, -0.4575009, -5.19326, -0.99649423, 3.9975204, -5.5370917, -1.7374569, 2.3846061]
Target sample: 97, Prediction:1, Target's Score:[-1.8297645, 12.47139, -4.146963, 0.08662811, -5.586995, -0.91528624, 2.1270037, -4.771649, 1.31673, 1.4853013]
Target sample: 103, Prediction:1, Target's Score:[2.163888, 11.200306, -2.06024, 0.22063258, -3.454838, -0.6550624, -1.7244046, -5.5634556, -0.5495634, 0.68523765]
Target sample: 109, Prediction:1, Target's Score:[-2.1513848, 12.744842, -3.330532, 0.9051142, -7.325185, 1.0636817, 2.51409, -6.3604107, -1.944594, 4.129304]
Target sample: 115, Prediction:9, Target's Score:[-0.23971555, 6.071349, -5.524958, 0.43976155, -6.7348123, -1.3869112, 5.9560404, -6.1238465, -0.10859013, 7.8069143]
Current ATTACK acc on target samples: 15.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 23:08:03 Epoch 59, Val iteration 0, acc 89.000 (89.000)
2021-06-11 23:08:06 Epoch 59, Val iteration 19, acc 90.400 (89.400)
* Prec: 89.40000076293946
Per class accuracy =  [0.92601664 0.92087671 0.84217322 0.82832457 0.89214999 0.82413932
 0.93615975 0.89142005 0.93268859 0.9407932 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 8, 1, 8, 8, 1, 1, 1, 1, 1, 1, 6, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 9, 8, 1, 1, 1, 1, 1, 1, 1, 9, 1, 6, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1
ATTACK acc: 7.070707070707071
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:08:10, Val iteration 0, acc 96.200 (96.200)
2021-06-11 23:08:17, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-11 23:08:20, Epoch 0, Iteration 7, loss 0.420 (0.552), acc 88.462 (85.600)
2021-06-11 23:08:52, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-2.6544094, 15.9271555, -3.460139, -1.6674122, -3.967067, -3.4232845, -0.058492452, -2.4756618, -1.0125084, 2.91168]
Target sample: 7, Prediction:1, Target's Score:[1.7508827, 5.6005106, -2.2277355, -2.165955, -3.3911011, -3.2153704, 3.6413836, -2.2373147, 1.1864711, 1.1525236]
Target sample: 13, Prediction:1, Target's Score:[-1.6399086, 6.766751, -2.748957, -1.719578, -3.1894805, -3.0731971, 4.724347, -2.9128518, 3.1828938, 0.69407266]
Target sample: 19, Prediction:6, Target's Score:[-1.4247607, 4.890157, -2.0387337, -2.5328379, -3.6224613, -2.484939, 7.003747, -1.8411111, -1.4616166, 3.6009042]
Target sample: 25, Prediction:1, Target's Score:[-2.2864804, 10.987829, -1.525884, -2.2935345, -3.455326, -2.9052894, 2.251967, -2.3367438, -0.68017274, 2.3438087]
Target sample: 31, Prediction:1, Target's Score:[-1.8725412, 7.194149, -2.7509122, -1.6669515, -3.7124004, -2.684429, 5.975325, -2.1323397, -1.082176, 2.8207996]
Target sample: 37, Prediction:1, Target's Score:[-2.3739579, 15.818508, -2.9203036, -3.1765196, -3.953401, -3.7649744, 0.5386866, -1.9016939, -0.3270306, 2.179053]
Target sample: 43, Prediction:1, Target's Score:[-1.9153281, 10.0774555, -2.580027, -2.598431, -3.5446162, -3.3948002, 2.1793365, -1.9251629, 1.390803, 2.4066112]
Target sample: 49, Prediction:1, Target's Score:[-2.007825, 8.821094, -0.75616395, -1.1807811, -3.5614338, -3.4097142, 4.0093813, -2.2116785, -1.3679123, 1.7546567]
Target sample: 55, Prediction:1, Target's Score:[-2.816374, 8.377919, -0.730359, -2.820131, -3.81129, -2.8265626, 3.9893026, -1.8330219, -1.907239, 4.475959]
Target sample: 61, Prediction:1, Target's Score:[-3.0343676, 13.216499, -3.0862257, -2.0347807, -4.1098824, -3.7305267, 2.1673732, -2.4517589, -0.69958645, 3.8759916]
Target sample: 67, Prediction:1, Target's Score:[-1.6622919, 12.01907, -3.0759277, -0.7581261, -3.8840888, -3.7118487, 1.3428944, -3.1954038, 1.716601, 1.3126743]
Target sample: 73, Prediction:1, Target's Score:[-0.5092398, 5.5399556, -1.2561195, -0.95643014, -2.9327714, -2.8016262, 3.8557003, -1.0135239, -1.688489, 1.8397216]
Target sample: 79, Prediction:1, Target's Score:[-1.7033893, 11.279474, -2.9167392, -2.623023, -3.8924437, -2.6794202, 2.795425, -1.02293, -2.0079641, 2.876445]
Target sample: 85, Prediction:1, Target's Score:[-1.0817658, 11.615359, -3.3598664, -1.2551076, -3.6026871, -2.9631288, -0.057270378, -1.8937258, -1.0144895, 3.7133586]
Target sample: 91, Prediction:1, Target's Score:[-2.1231382, 9.795856, -2.0207365, -0.3297798, -3.40124, -2.7952797, 1.9159802, -2.102171, -1.424115, 2.5779762]
Target sample: 97, Prediction:1, Target's Score:[-2.5658212, 14.916771, -3.2853365, -1.2637293, -3.3916101, -3.2629972, -0.6472747, -2.30266, -0.7899938, 2.7023761]
Target sample: 103, Prediction:1, Target's Score:[-1.1774276, 13.077462, -1.9894705, -1.6805129, -3.9622328, -2.8546174, 1.0791026, -2.203493, -1.319914, 1.1368501]
Target sample: 109, Prediction:1, Target's Score:[-2.4149551, 11.509039, -1.9390709, -0.44029325, -3.7734873, -3.6110835, 1.2561342, -2.4935648, -1.5611663, 3.5739021]
Target sample: 115, Prediction:9, Target's Score:[-0.5920559, 4.964714, -3.4046447, -2.2761123, -3.424628, -3.9741988, 2.9957504, -2.6535466, -1.4889693, 9.965615]
Current ATTACK acc on target samples: 5.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 23:09:24 Epoch 59, Val iteration 0, acc 91.200 (91.200)
2021-06-11 23:09:30 Epoch 59, Val iteration 19, acc 92.800 (93.140)
* Prec: 93.14000244140625
Per class accuracy =  [0.95956498 0.96403575 0.88294131 0.86509955 0.95400206 0.90208728
 0.96400977 0.93612471 0.95243746 0.93238454]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 9, 9, 1, 1, 8, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1
ATTACK acc: 1.0101010101010102
--------
------SUMMARY PRE DEFENSE------
TIME ELAPSED (mins): 11
TARGET INDEX: 12
ResNet50 30.0 16.161616161616163 95.46000137329102 90.81000137329102
DPN92 0.0 2.0202020202020203 95.50000267028808 92.92000160217285
MobileNetV2 15.0 7.070707070707071 91.22000160217286 89.40000076293946
GoogLeNet 5.0 1.0101010101010102 95.41000213623047 93.14000244140625
DEFENSE EVALUATION
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
ResNet50
[74, 80, 84, 86, 89] 7
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:09:35, Val iteration 0, acc 94.200 (94.200)
2021-06-11 23:09:40, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-11 23:09:41, Epoch 0, Iteration 7, loss 0.041 (0.359), acc 100.000 (94.800)
2021-06-11 23:10:13, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-2.4249504, 15.919843, -2.9901166, -1.5656507, -4.0828342, -2.1807494, -1.9299141, -3.1001909, -1.5478065, 4.250818]
Target sample: 7, Prediction:8, Target's Score:[0.5472211, 1.8055241, -2.8121386, -0.13483538, -2.7402406, -2.117477, 0.17904301, -2.3482852, 6.864218, 0.9620995]
Target sample: 13, Prediction:8, Target's Score:[-0.390462, 3.0296788, -2.733448, 0.77686334, -2.8253868, -2.2870862, 0.6446136, -2.8063445, 6.3997416, 0.4061239]
Target sample: 19, Prediction:9, Target's Score:[0.14021976, 3.7808406, -2.2313552, -1.325062, -2.7769105, -2.3922698, -2.0650823, -1.4351906, -0.43365416, 8.994446]
Target sample: 25, Prediction:1, Target's Score:[-1.3297592, 16.536522, -3.309062, -2.6566758, -4.2685504, -2.0659876, -1.9643346, -2.439583, -0.41200525, 2.2316473]
Target sample: 31, Prediction:1, Target's Score:[-1.7882346, 16.410332, -3.2598238, -1.6569293, -4.473615, -2.0854013, -1.8242692, -2.1882594, -1.2691331, 2.4677048]
Target sample: 37, Prediction:1, Target's Score:[-2.7844424, 20.351183, -3.8396447, -2.2625828, -4.8524656, -2.6273506, -2.1848662, -2.4354746, -1.2963866, 2.3162422]
Target sample: 43, Prediction:1, Target's Score:[-2.1894062, 14.982212, -3.4171734, -1.359316, -4.193356, -2.1362145, -2.0264373, -2.188033, -0.8148058, 3.6600308]
Target sample: 49, Prediction:1, Target's Score:[-2.8677206, 14.10365, -3.0837414, -1.0031983, -4.5973043, -2.4868348, -2.6640549, -2.2290363, -2.777173, 7.97346]
Target sample: 55, Prediction:9, Target's Score:[-1.6659715, 4.8663945, -2.3780966, -1.1170464, -3.3173335, -2.0824096, -2.8216581, -1.7452353, -2.4525611, 13.030631]
Target sample: 61, Prediction:1, Target's Score:[-1.2949096, 6.7353344, -3.278418, -0.37250194, -3.4647093, -1.1702412, -0.70465446, -2.6858437, 0.45354822, 6.0517306]
Target sample: 67, Prediction:1, Target's Score:[-0.86810285, 10.743282, -2.7855442, 1.5116801, -4.2140017, -1.8867891, -1.7631167, -2.2497108, 0.60479176, 1.1755251]
Target sample: 73, Prediction:1, Target's Score:[-1.7016013, 13.4225855, -3.410994, -0.75702804, -4.0278654, -1.6604095, -1.845796, -1.6807307, -1.1646084, 3.1296446]
Target sample: 79, Prediction:1, Target's Score:[-1.4346654, 16.073238, -3.197247, -2.0323129, -4.164514, -1.5705245, -1.9291362, -2.2015238, -1.5126951, 2.2917192]
Target sample: 85, Prediction:1, Target's Score:[-2.581801, 15.584512, -3.4763334, -1.4468681, -4.6357613, -1.8906387, -2.351639, -2.46521, -1.7553303, 5.3753123]
Target sample: 91, Prediction:1, Target's Score:[-3.2479098, 17.55095, -3.3580902, 0.032485902, -5.3226066, -3.100906, -2.9176815, -2.9015114, -2.4705544, 6.1442437]
Target sample: 97, Prediction:1, Target's Score:[-2.7799056, 20.651974, -3.8384573, -2.6024506, -4.936937, -2.580237, -2.4714272, -2.6434808, -1.7419786, 3.3440084]
Target sample: 103, Prediction:1, Target's Score:[-2.5001366, 20.376652, -4.049842, -1.7003162, -5.3569546, -2.4949338, -2.627748, -3.0031621, -1.8897935, 3.6482105]
Target sample: 109, Prediction:1, Target's Score:[-2.0704808, 13.407923, -3.1328106, -1.135781, -3.931093, -1.787165, -2.250098, -2.4062328, -1.7998306, 5.4186573]
Target sample: 115, Prediction:9, Target's Score:[-1.7617613, 1.391738, -2.8336084, -0.2518619, -1.5728089, -2.7058783, -1.3804672, -2.3211367, 1.025472, 10.69219]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 23:10:43 Epoch 59, Val iteration 0, acc 92.600 (92.600)
2021-06-11 23:10:49 Epoch 59, Val iteration 19, acc 93.600 (91.850)
* Prec: 91.85000076293946
Per class accuracy =  [0.93495227 0.94706636 0.86358066 0.80433017 0.94118092 0.88934998
 0.96103466 0.9327739  0.95167111 0.96133844]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 9, 9, 9, 9, 8, 8, 8, 8, 8, 8, 8, 8, 9, 0, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 9, 9, 9, 1
ATTACK acc: 0.0
DPN92
[74, 80, 84, 86, 89] 27
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:10:52, Val iteration 0, acc 94.800 (94.800)
2021-06-11 23:11:04, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-11 23:11:06, Epoch 0, Iteration 7, loss 0.321 (0.380), acc 92.308 (91.400)
2021-06-11 23:12:32, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-0.4512177, 15.930898, -3.618893, -2.5795884, -4.210334, -1.342734, 0.034737814, -4.6557736, -1.0854425, 2.277167]
Target sample: 7, Prediction:1, Target's Score:[1.4646806, 9.045592, -3.246102, -2.8076704, -2.9561362, -2.2247975, 0.42827058, -3.6360235, 3.7242062, 0.52131265]
Target sample: 13, Prediction:1, Target's Score:[-0.28744683, 8.684892, -2.9769897, -2.8602507, -2.9881346, -1.9303244, 0.74345106, -3.0466409, 4.543112, 0.41843793]
Target sample: 19, Prediction:9, Target's Score:[-0.05355168, 5.8441677, -2.7587767, -1.3971578, -3.343334, -2.9759004, -0.63010323, -3.5667129, -0.43333077, 9.631593]
Target sample: 25, Prediction:1, Target's Score:[-0.43330553, 14.100667, -3.159595, -3.1732688, -3.4879587, -1.244541, -0.24858795, -4.053406, 0.21747357, 1.7587898]
Target sample: 31, Prediction:1, Target's Score:[0.029894963, 14.420103, -3.6332479, -2.2736235, -4.096569, -0.9990822, 0.44360578, -3.8046432, -0.24202417, 0.45438513]
Target sample: 37, Prediction:1, Target's Score:[-0.5476217, 16.129507, -3.2864416, -2.8851457, -4.157471, -1.0608726, -0.06250729, -4.2070727, -0.57744634, 0.9525248]
Target sample: 43, Prediction:1, Target's Score:[-0.40501857, 14.669703, -3.4432733, -3.2687535, -3.8135495, -1.5473313, -0.40534875, -4.1805053, 0.06511477, 2.6143386]
Target sample: 49, Prediction:1, Target's Score:[-0.79037994, 13.7803, -3.2307184, -2.415966, -3.9370365, -1.0347899, -0.044027917, -3.5534213, -1.454283, 2.9520955]
Target sample: 55, Prediction:9, Target's Score:[-1.0619149, 7.0955925, -2.468921, -0.65327233, -3.3202274, -1.7681246, -0.91035086, -3.9275448, -2.243777, 9.540057]
Target sample: 61, Prediction:1, Target's Score:[-0.12105223, 9.156725, -3.493312, -2.1270826, -3.6966727, -1.9213929, -0.3495871, -3.8979106, -0.06569572, 6.8223295]
Target sample: 67, Prediction:9, Target's Score:[0.571205, 5.716633, -3.1658235, -1.2924042, -3.2745564, -2.2976499, -1.231704, -3.568537, 2.361511, 6.5035]
Target sample: 73, Prediction:1, Target's Score:[1.0089489, 8.791825, -3.4676208, -1.0151321, -2.4544241, -1.5258452, -1.7351247, -3.2789717, -1.5273645, 5.46016]
Target sample: 79, Prediction:1, Target's Score:[-0.2758294, 15.1495905, -3.7703493, -2.2303212, -4.076477, -0.6982441, -0.6377375, -4.324519, -1.8158225, 2.9668176]
Target sample: 85, Prediction:1, Target's Score:[0.050916724, 14.358764, -3.351066, -2.6861787, -4.1198754, -0.7264575, -0.63388073, -4.09391, -0.7462361, 2.2296531]
Target sample: 91, Prediction:1, Target's Score:[0.03390205, 15.505385, -3.630709, -2.38345, -4.0771766, -1.1586376, -0.6230414, -4.6658006, -1.2495899, 2.5507905]
Target sample: 97, Prediction:1, Target's Score:[-0.21698005, 15.433572, -3.3111787, -2.9641006, -3.814096, -1.2282382, -0.09142912, -4.1035533, -0.3081983, 0.8897774]
Target sample: 103, Prediction:1, Target's Score:[0.48678967, 15.406263, -3.3351753, -2.5319312, -3.8475416, -0.8132398, -0.79531276, -4.431343, -1.5335133, 1.682117]
Target sample: 109, Prediction:1, Target's Score:[-0.82571703, 15.944956, -3.577701, -2.553845, -4.218992, -0.9493551, 0.048070636, -4.3292594, -1.0235891, 1.775631]
Target sample: 115, Prediction:9, Target's Score:[0.5739466, 3.4124188, -3.4548557, -2.1903207, -3.352015, -3.1599677, -1.9930872, -3.5985968, 0.7570336, 13.358661]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 23:13:56 Epoch 59, Val iteration 0, acc 92.800 (92.800)
2021-06-11 23:14:07 Epoch 59, Val iteration 19, acc 93.200 (93.050)
* Prec: 93.05000152587891
Per class accuracy =  [0.92537555 0.97970222 0.90520248 0.89586375 0.92056256 0.87484061
 0.94964285 0.93875642 0.96574182 0.95043546]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 9, 9, 8, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1
ATTACK acc: 0.0
MobileNetV2
[74, 80, 84, 86, 89] 47
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:14:10, Val iteration 0, acc 92.600 (92.600)
2021-06-11 23:14:13, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-11 23:14:14, Epoch 0, Iteration 7, loss 0.521 (0.307), acc 86.538 (90.600)
2021-06-11 23:14:29, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-0.10360837, 15.771336, -5.7939386, 3.4956439, -8.93449, -0.9992593, -0.31071693, -8.034085, -0.9329445, 6.5715823]
Target sample: 7, Prediction:1, Target's Score:[1.440927, 8.717485, -6.2636123, 0.47130424, -7.4814267, -4.753185, 4.7218294, -6.50319, 7.543325, 2.7271004]
Target sample: 13, Prediction:1, Target's Score:[-0.687824, 15.253393, -5.174687, 0.40755332, -7.767929, -3.5843143, 0.054935694, -6.795788, 6.3461494, 2.57631]
Target sample: 19, Prediction:9, Target's Score:[-0.33818898, 6.962149, -5.0735846, 3.270526, -6.5150967, -2.9670405, 4.084095, -5.863469, -0.37993485, 7.466719]
Target sample: 25, Prediction:1, Target's Score:[0.9794626, 14.114756, -3.5095134, -3.086844, -5.470006, -2.83, -0.25622094, -4.531728, -1.947241, 7.1483827]
Target sample: 31, Prediction:1, Target's Score:[2.5467625, 16.88771, -6.1515923, -1.4324548, -5.3701324, -3.8957677, -1.0662708, -4.07039, 0.3042055, 2.890018]
Target sample: 37, Prediction:1, Target's Score:[0.3311883, 23.847404, -4.690604, -0.9502268, -8.243462, -1.226476, -6.059645, -6.3427896, 0.76684207, 3.309969]
Target sample: 43, Prediction:1, Target's Score:[2.808833, 11.070606, -4.576809, -0.020144671, -4.3392406, -4.1948466, -5.572543, -2.9330506, 3.493549, 4.8500466]
Target sample: 49, Prediction:1, Target's Score:[-0.6856765, 14.347988, -4.301939, -1.59188, -6.1228456, -1.2838107, -1.5010746, -4.1898723, -2.3909087, 8.379298]
Target sample: 55, Prediction:1, Target's Score:[-1.0262184, 10.989609, -5.364983, 0.26202232, -8.264303, -1.9483756, 2.338601, -5.120679, -1.2345564, 10.022995]
Target sample: 61, Prediction:1, Target's Score:[1.7447251, 14.834552, -5.5582924, -0.7656282, -8.300077, -3.4322996, 2.0428913, -6.748082, 4.4914727, 2.336646]
Target sample: 67, Prediction:1, Target's Score:[0.57380253, 10.40258, -4.407598, -1.1941642, -7.159058, -3.2240005, -2.745728, -5.6980166, 7.1124573, 6.928882]
Target sample: 73, Prediction:1, Target's Score:[-2.3716502, 11.307034, -5.06796, 1.1436034, -4.701202, -2.5130694, 2.0348687, -5.200733, 1.6318218, 4.347189]
Target sample: 79, Prediction:1, Target's Score:[1.5459269, 13.058409, -4.8431087, -0.97047853, -4.8670893, -0.065201014, -4.6168375, -1.9287444, -3.563035, 6.8692327]
Target sample: 85, Prediction:1, Target's Score:[2.3219466, 15.598331, -5.1206355, -2.3596106, -6.678204, -2.7448661, -1.5431674, -3.6046507, -1.2288516, 5.9905615]
Target sample: 91, Prediction:1, Target's Score:[0.8928771, 17.455822, -4.66989, -1.5724847, -5.7477007, -1.7090863, -2.943436, -5.1082954, -1.2275808, 5.289091]
Target sample: 97, Prediction:1, Target's Score:[-0.21392597, 16.800676, -4.5631423, -1.225318, -5.9776564, -2.1443648, -3.123728, -3.9468017, 1.4343953, 3.5604026]
Target sample: 103, Prediction:1, Target's Score:[3.6304648, 14.139308, -2.538797, -0.90524805, -3.7778103, -0.556884, -5.580878, -4.6407237, -1.080528, 1.9136355]
Target sample: 109, Prediction:1, Target's Score:[-0.4449728, 16.59935, -3.7847097, -0.41198504, -7.7420654, 0.31889546, -2.176313, -6.074344, -1.6467149, 6.01003]
Target sample: 115, Prediction:9, Target's Score:[0.87334776, 10.593733, -6.277142, -0.78891814, -7.8054156, -2.2685492, 0.6237477, -5.9335694, 0.9645645, 10.661344]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 23:14:44 Epoch 59, Val iteration 0, acc 90.000 (90.000)
2021-06-11 23:14:47 Epoch 59, Val iteration 19, acc 89.800 (89.570)
* Prec: 89.5700008392334
Per class accuracy =  [0.92036868 0.93468704 0.84910427 0.83375264 0.89279484 0.82340387
 0.93264849 0.88713109 0.93254866 0.94734022]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 9, 1, 8, 8, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 8, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1, 1, 1, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 1.0101010101010102
GoogLeNet
[74, 80, 84, 86, 89] 22
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:14:50, Val iteration 0, acc 96.200 (96.200)
2021-06-11 23:14:56, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-11 23:14:57, Epoch 0, Iteration 7, loss 0.502 (0.546), acc 88.462 (87.800)
2021-06-11 23:15:30, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-1.6635698, 19.712652, -5.1046567, -0.8522512, -4.6222715, -3.9685645, -3.3789952, -3.798814, -0.9560056, 4.6994114]
Target sample: 7, Prediction:1, Target's Score:[3.0775611, 6.526801, -4.0016165, -1.9459499, -3.899705, -3.8585887, -2.1919112, -2.8904114, 4.891613, 4.3897376]
Target sample: 13, Prediction:1, Target's Score:[-0.05811121, 9.805604, -4.4170856, -1.6298194, -3.508158, -3.9421353, -1.8113686, -3.6862304, 7.3929224, 1.911732]
Target sample: 19, Prediction:1, Target's Score:[-0.5768405, 8.892014, -4.1076407, -0.18962634, -4.533287, -2.8895538, -0.84883624, -2.591329, 0.67186785, 6.257577]
Target sample: 25, Prediction:1, Target's Score:[-0.5648872, 15.833965, -3.5444465, -2.056873, -3.95569, -3.8590803, -2.8109121, -3.375235, -0.3597101, 4.757794]
Target sample: 31, Prediction:1, Target's Score:[-1.4810363, 13.600419, -4.7345877, -1.2135888, -3.650252, -3.269122, -0.96593505, -3.693788, 0.41406238, 5.059486]
Target sample: 37, Prediction:1, Target's Score:[-0.41853663, 17.52654, -4.1042676, -2.2095132, -3.972912, -4.6815515, -2.9969814, -3.1636024, 0.24066152, 3.843481]
Target sample: 43, Prediction:1, Target's Score:[-0.14890493, 12.610962, -3.8952377, -1.9031081, -4.0837064, -4.3336277, -2.819774, -2.747293, 3.762592, 3.6299424]
Target sample: 49, Prediction:1, Target's Score:[-0.5558668, 12.904135, -2.6642785, 0.296473, -3.3783896, -3.77628, -1.980761, -3.0228546, -1.4619262, 3.710444]
Target sample: 55, Prediction:1, Target's Score:[-1.4690844, 10.798628, -2.1427832, -1.8117988, -3.5334933, -3.7449572, -1.0596889, -3.184264, -1.7474145, 7.977489]
Target sample: 61, Prediction:1, Target's Score:[-1.2423385, 15.927117, -4.8661876, -1.4053977, -4.4454274, -4.4354453, -2.128601, -3.0013669, 0.6968973, 4.9662323]
Target sample: 67, Prediction:1, Target's Score:[1.0048628, 11.99554, -4.2452006, 0.29356048, -4.4427586, -4.2006474, -2.9699898, -3.6205063, 2.6222057, 3.6453853]
Target sample: 73, Prediction:1, Target's Score:[0.8803681, 7.532525, -3.0935395, 1.0696291, -2.892933, -3.5666296, -2.0051792, -2.0454304, -0.33970034, 4.54686]
Target sample: 79, Prediction:1, Target's Score:[-0.7067309, 15.637854, -4.6528835, -0.50612354, -3.9322782, -3.428667, -2.6013281, -2.6027253, -1.9367579, 4.8000846]
Target sample: 85, Prediction:1, Target's Score:[-0.99682754, 14.403515, -4.7769904, 0.42315397, -4.1981387, -3.0940013, -3.445389, -3.397805, -0.3567909, 5.514331]
Target sample: 91, Prediction:1, Target's Score:[-0.3034683, 12.536718, -3.4869654, 0.5377946, -3.191932, -3.923049, -3.330665, -3.559597, -0.38854754, 5.190691]
Target sample: 97, Prediction:1, Target's Score:[-1.0907815, 18.26925, -4.461715, -0.8573683, -4.3327317, -3.835549, -3.619309, -3.3436365, -1.3512888, 4.6929255]
Target sample: 103, Prediction:1, Target's Score:[1.7234324, 14.80007, -3.2808278, -1.0746735, -3.674828, -3.0575268, -3.4622386, -3.4949918, -1.478726, 3.0722933]
Target sample: 109, Prediction:1, Target's Score:[-1.005627, 13.171302, -3.8684847, 0.12831834, -3.6922839, -3.6855338, -3.0166893, -3.5753706, -1.0969293, 6.7218447]
Target sample: 115, Prediction:9, Target's Score:[-0.30787656, 8.174302, -4.871268, -1.8444886, -3.7034888, -4.127841, -2.593955, -3.4425783, 1.2235557, 11.609958]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 23:16:01 Epoch 59, Val iteration 0, acc 93.400 (93.400)
2021-06-11 23:16:08 Epoch 59, Val iteration 19, acc 93.600 (92.970)
* Prec: 92.97000122070312
Per class accuracy =  [0.94728764 0.95036331 0.88586856 0.82385446 0.9509391  0.92707925
 0.96023287 0.93747959 0.95669383 0.95876921]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 9, 8, 1, 8, 1, 8, 1, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 1
ATTACK acc: 0.0
------SUMMARY POST DEFENSE------
TIME ELAPSED (mins): 11
TARGET INDEX: 12
ResNet50 0.0 0.0 95.46000137329102 91.85000076293946 100.0
DPN92 0.0 0.0 95.50000267028808 93.05000152587891 100.0
MobileNetV2 0.0 1.0101010101010102 91.22000160217286 89.5700008392334 100.0
GoogLeNet 0.0 0.0 95.41000213623047 92.97000122070312 100.0
True False False False True
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.300-droplayer0.000.t7
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
No specific indices are determined, so try to include whatever we find
In total, we found 142 images of target 14
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133, 139]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', eval_poisons_root='', feat_reg_flag=False, gpu='1', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=14, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/14/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133, 139]
# Targets: 24, # Poisons: 5
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 23:16:27 Iteration 0 	 Training Loss: 9.603e-01 	 Loss in Target Net: 1.078e+00	  
 2021-06-11 23:16:58 Iteration 50 	 Training Loss: 4.292e-01 	 Loss in Target Net: 4.118e-01	  
 2021-06-11 23:17:31 Iteration 100 	 Training Loss: 4.010e-01 	 Loss in Target Net: 3.931e-01	  
 2021-06-11 23:18:05 Iteration 150 	 Training Loss: 3.849e-01 	 Loss in Target Net: 3.850e-01	  
 2021-06-11 23:18:38 Iteration 200 	 Training Loss: 3.801e-01 	 Loss in Target Net: 3.839e-01	  
 2021-06-11 23:19:11 Iteration 250 	 Training Loss: 3.775e-01 	 Loss in Target Net: 3.920e-01	  
 2021-06-11 23:19:45 Iteration 300 	 Training Loss: 3.738e-01 	 Loss in Target Net: 3.682e-01	  
 2021-06-11 23:20:19 Iteration 350 	 Training Loss: 3.717e-01 	 Loss in Target Net: 3.797e-01	  
 2021-06-11 23:20:52 Iteration 400 	 Training Loss: 3.713e-01 	 Loss in Target Net: 3.879e-01	  
 2021-06-11 23:21:25 Iteration 450 	 Training Loss: 3.712e-01 	 Loss in Target Net: 3.882e-01	  
 2021-06-11 23:21:58 Iteration 500 	 Training Loss: 3.696e-01 	 Loss in Target Net: 3.995e-01	  
 2021-06-11 23:22:30 Iteration 550 	 Training Loss: 3.689e-01 	 Loss in Target Net: 3.852e-01	  
 2021-06-11 23:23:04 Iteration 600 	 Training Loss: 3.693e-01 	 Loss in Target Net: 3.748e-01	  
 2021-06-11 23:23:37 Iteration 650 	 Training Loss: 3.678e-01 	 Loss in Target Net: 3.959e-01	  
 2021-06-11 23:24:11 Iteration 700 	 Training Loss: 3.702e-01 	 Loss in Target Net: 3.880e-01	  
 2021-06-11 23:24:43 Iteration 750 	 Training Loss: 3.669e-01 	 Loss in Target Net: 4.209e-01	  
 2021-06-11 23:25:16 Iteration 800 	 Training Loss: 3.646e-01 	 Loss in Target Net: 3.908e-01	  
 2021-06-11 23:25:49 Iteration 850 	 Training Loss: 3.648e-01 	 Loss in Target Net: 3.851e-01	  
 2021-06-11 23:26:24 Iteration 900 	 Training Loss: 3.716e-01 	 Loss in Target Net: 4.016e-01	  
 2021-06-11 23:26:58 Iteration 950 	 Training Loss: 3.687e-01 	 Loss in Target Net: 3.893e-01	  
 2021-06-11 23:27:30 Iteration 999 	 Training Loss: 3.671e-01 	 Loss in Target Net: 3.916e-01	  
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:27:33, Val iteration 0, acc 94.200 (94.200)
2021-06-11 23:27:39, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-11 23:27:42, Epoch 0, Iteration 7, loss 0.634 (0.577), acc 86.538 (91.000)
2021-06-11 23:28:14, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.3398104, 4.6750884, -2.1334, -1.3388705, -1.8024732, -1.842681, 6.148054, -1.6046543, 0.16124481, 0.28490105]
Target sample: 7, Prediction:6, Target's Score:[-2.1803257, 3.4897718, -2.206174, -1.1710727, -2.0937696, -1.9916458, 7.1961555, -1.383229, 0.69115794, -0.12498323]
Target sample: 13, Prediction:6, Target's Score:[-1.6833967, 1.1541893, -1.610109, -0.833746, -1.6076075, -1.9804751, 6.971426, -1.6297407, 0.9602148, 0.4686539]
Target sample: 19, Prediction:6, Target's Score:[-2.1513295, 1.3025557, -2.8982859, 0.16975291, -2.3536093, -1.1175295, 5.6289234, -2.4563062, 4.2224874, -0.16213071]
Target sample: 25, Prediction:1, Target's Score:[-2.6847634, 8.782654, -2.1408672, -2.048382, -2.3996017, -2.4234688, 6.2932553, -1.429821, -0.34584212, -1.3770813]
Target sample: 31, Prediction:1, Target's Score:[-3.2443602, 11.02138, -2.330961, -2.8812044, -2.4849107, -2.719967, 6.6576824, -1.5288923, -1.4310156, -0.80723506]
Target sample: 37, Prediction:6, Target's Score:[-2.1370566, 4.3340287, -2.0096347, 0.034447677, -2.4017909, -1.1320151, 8.514639, -1.9952534, -0.9499627, -2.0009367]
Target sample: 43, Prediction:6, Target's Score:[-1.5794971, 1.0992851, -1.4777153, 0.08703605, -1.6494422, -0.90581816, 8.079996, -1.8599819, -0.3165777, -1.2486279]
Target sample: 49, Prediction:6, Target's Score:[-1.9933453, 1.8779534, -2.0343518, -0.19052751, -2.075204, -1.3303987, 7.685078, -2.1113985, 1.5739529, -1.1803439]
Target sample: 55, Prediction:6, Target's Score:[-0.87991345, 2.4681408, -1.864278, -1.4214988, -2.1386154, -1.5817052, 7.5680265, -0.45426074, -0.904224, -0.54927516]
Target sample: 61, Prediction:6, Target's Score:[-2.3042371, 5.3981194, -1.6027668, -1.2797893, -1.4150901, -1.85187, 7.6790905, -1.6014215, -1.5612743, -1.2195542]
Target sample: 67, Prediction:6, Target's Score:[-2.4599903, 4.843131, -1.7669916, -1.1906115, -1.7567198, -1.9981182, 6.843937, -2.0933883, -2.1087842, 1.9287479]
Target sample: 73, Prediction:6, Target's Score:[-2.1095815, 5.4372873, -1.950094, -1.5518279, -1.3556334, -2.1638818, 6.685497, -1.2961739, -0.7041617, -0.76610327]
Target sample: 79, Prediction:6, Target's Score:[-2.442256, 6.62801, -2.1502228, -1.3677342, -2.1591773, -1.9865774, 6.6658244, -1.2551265, -0.017937291, -1.693607]
Target sample: 85, Prediction:1, Target's Score:[-2.0827625, 7.090569, -2.552382, -1.6816717, -2.2551312, -2.058217, 5.760164, -1.3821548, 0.14416023, -0.77026725]
Target sample: 91, Prediction:1, Target's Score:[-2.586738, 8.248092, -2.187877, -1.898424, -2.6994712, -2.1193173, 7.8393, -1.7355889, -1.5166602, -1.0752892]
Target sample: 97, Prediction:6, Target's Score:[-2.489736, 5.189671, -1.726275, -1.573888, -2.462361, -1.9052033, 9.608134, -1.9215428, -1.4875735, -0.9388978]
Target sample: 103, Prediction:6, Target's Score:[-2.8362563, 1.7772601, -1.8446127, 1.9288644, -2.313096, -0.4306606, 8.71953, -3.2054052, 0.0115598105, -1.5629755]
Target sample: 109, Prediction:6, Target's Score:[-2.6606338, 2.480028, -1.9883801, -0.20243926, -2.454142, -1.1112406, 11.400575, -2.9124377, 0.0073957257, -2.2475986]
Target sample: 115, Prediction:6, Target's Score:[-3.2442825, 2.553541, -2.196393, 3.1465466, -2.0036561, -0.61197627, 7.8906045, -3.0960162, -1.3550909, -0.85332704]
Target sample: 121, Prediction:6, Target's Score:[-3.0084689, 4.6228595, -2.0941186, 0.5499768, -1.9535562, -1.4033208, 7.1611466, -2.4363701, -0.11935626, -1.0961258]
Target sample: 127, Prediction:6, Target's Score:[-2.5520792, 6.175869, -1.9363704, -1.855901, -2.2884703, -2.2554765, 8.429685, -1.6365373, -1.9787956, 0.1761739]
Target sample: 133, Prediction:6, Target's Score:[-2.2566898, 5.727809, -1.7097992, -1.1910894, -1.3600373, -1.8314842, 6.0999126, -1.310694, -1.663771, -0.2941454]
Target sample: 139, Prediction:6, Target's Score:[-1.3733695, 1.2919761, -1.7924708, -1.4232677, -2.1977563, -2.3893127, 6.5092006, -1.3464087, 0.6098191, 2.3323336]
Current ATTACK acc on target samples: 83.333
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 23:28:45 Epoch 59, Val iteration 0, acc 91.800 (91.800)
2021-06-11 23:28:50 Epoch 59, Val iteration 19, acc 91.600 (91.310)
* Prec: 91.31000175476075
Per class accuracy =  [0.93299189 0.91726801 0.84405301 0.84148309 0.92859189 0.88046263
 0.95725415 0.91830259 0.94972789 0.96142881]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 1, 1, 1, 6, 1, 1, 1, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 1, 1, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 83.89830508474576
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:28:58, Val iteration 0, acc 94.800 (94.800)
2021-06-11 23:29:09, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-11 23:29:17, Epoch 0, Iteration 7, loss 0.626 (0.355), acc 88.462 (91.800)
2021-06-11 23:30:43, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:8, Target's Score:[-1.4853404, 2.9846592, -4.006328, 1.0334204, -2.1108017, -4.2660227, 3.8917313, -3.1913753, 6.528476, 0.8874741]
Target sample: 7, Prediction:8, Target's Score:[-1.6514202, 3.4625397, -3.339464, 0.42770335, -3.0378218, -4.5519457, 6.241533, -3.4633985, 6.8070993, -0.61909103]
Target sample: 13, Prediction:8, Target's Score:[-1.6443249, 4.0823035, -3.7840588, 0.51334983, -3.3848376, -4.4830027, 5.450562, -3.208488, 6.7766767, -0.04651562]
Target sample: 19, Prediction:1, Target's Score:[-1.69477, 7.1059413, -3.590794, 0.74904144, -4.1316833, -4.457813, 4.4219, -3.1801074, 5.1821685, -0.10208405]
Target sample: 25, Prediction:1, Target's Score:[-2.2182643, 6.566648, -2.829962, 1.9314047, -2.91095, -4.430673, 3.573829, -3.6206677, 4.64094, -0.39432976]
Target sample: 31, Prediction:1, Target's Score:[-2.697912, 6.61814, -3.3592541, 1.4359286, -3.0641303, -3.785001, 5.312049, -3.2079725, 3.289514, -0.2526751]
Target sample: 37, Prediction:6, Target's Score:[-2.6677332, 2.1053843, -2.4272525, 4.756892, -2.1588953, -2.9196842, 6.170193, -2.4148731, 1.4196104, -1.6198266]
Target sample: 43, Prediction:6, Target's Score:[-1.8363564, 1.0657047, -2.185375, 0.867676, -2.3103268, -2.9080224, 5.616252, -2.248632, 4.960265, -0.78373355]
Target sample: 49, Prediction:8, Target's Score:[-2.999241, 1.3265284, -2.670074, 2.8915436, -2.9147675, -3.7900202, 5.5548816, -2.4407725, 6.396246, -1.103984]
Target sample: 55, Prediction:8, Target's Score:[0.480186, 0.72485495, -2.4321103, -0.5824559, -3.3648095, -3.7610998, 2.4548068, -2.105733, 8.714066, 0.15257293]
Target sample: 61, Prediction:3, Target's Score:[-2.3188655, 5.132354, -1.4828216, 5.491802, -1.4048783, -2.879471, 1.4686384, -3.5336914, -0.122654304, -0.062422976]
Target sample: 67, Prediction:1, Target's Score:[-1.0924679, 9.665244, -0.8607954, 1.9932772, -3.1214836, -3.60477, 2.4384677, -4.1133065, -0.027811479, -0.9329708]
Target sample: 73, Prediction:8, Target's Score:[-2.0844824, 4.4580026, -2.9805315, 1.9847645, -2.7942045, -4.362589, 4.7562904, -3.5901904, 4.886857, 0.0075864736]
Target sample: 79, Prediction:8, Target's Score:[-2.1255941, 5.0545735, -3.605527, -0.37286517, -4.1553464, -3.7640343, 5.678375, -3.6986208, 6.9145637, 0.37130344]
Target sample: 85, Prediction:8, Target's Score:[-1.6523875, 4.4263887, -3.7550657, 0.19166629, -3.6345992, -4.8120174, 5.4900327, -3.6558049, 6.5501976, 1.1408216]
Target sample: 91, Prediction:1, Target's Score:[-2.2498162, 7.2086606, -2.856403, 4.044589, -3.1153855, -3.1486683, 4.515051, -3.217061, 0.7607861, -1.6262234]
Target sample: 97, Prediction:6, Target's Score:[-3.312641, 3.8094966, -3.428449, 2.306051, -2.817507, -3.3469691, 8.391918, -3.0201044, 2.4817846, -0.8040295]
Target sample: 103, Prediction:6, Target's Score:[-1.6810677, 0.81092966, -0.9104923, 3.05128, -2.2235925, -3.785695, 7.9151525, -3.6394687, 2.5626044, -1.8548788]
Target sample: 109, Prediction:6, Target's Score:[-2.8473694, 0.15021807, -2.53757, 0.014755018, -2.047859, -2.7335117, 12.955171, -4.098511, 3.4243991, -2.0367033]
Target sample: 115, Prediction:3, Target's Score:[-1.8483658, -0.8266123, -0.8212969, 7.119339, 1.356266, -1.2851357, 1.8538884, -2.767718, -0.46868628, -2.0702877]
Target sample: 121, Prediction:6, Target's Score:[-2.9560373, 4.085618, -3.2500396, 2.955005, -2.500473, -3.3179278, 4.972332, -2.8649082, 3.1022632, 0.032896705]
Target sample: 127, Prediction:1, Target's Score:[-2.3869627, 6.0537667, -2.6307654, 2.755524, -3.13344, -3.726341, 5.102854, -3.4712768, 2.3805528, -0.65452147]
Target sample: 133, Prediction:1, Target's Score:[-1.8151437, 4.503289, -3.0050557, 2.1378906, -2.7941444, -3.6903658, 4.428304, -3.2665386, 3.8331304, -0.06568891]
Target sample: 139, Prediction:8, Target's Score:[-0.5610223, 3.3715763, -3.3818605, -0.11229132, -3.325401, -4.507939, 5.623602, -3.397332, 5.864375, 0.6849376]
Current ATTACK acc on target samples: 25.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 23:32:07 Epoch 59, Val iteration 0, acc 91.000 (91.000)
2021-06-11 23:32:19 Epoch 59, Val iteration 19, acc 91.800 (92.460)
* Prec: 92.46000213623047
Per class accuracy =  [0.92997513 0.97330631 0.9013587  0.84196648 0.93645477 0.8886308
 0.9477824  0.94520554 0.95594069 0.93069815]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 8, 6, 8, 8, 8, 6, 6, 1, 8, 8, 1, 1, 1, 1, 8, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 8, 9, 6, 8, 6, 6, 8, 6, 8, 6, 6, 8, 8, 8, 8, 8, 9, 9, 3, 1, 1, 1, 1, 1, 1, 6, 6, 6, 8, 1, 8, 6, 8, 8, 6, 1, 1, 6, 8, 6, 6, 6, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 6, 3, 3, 3, 1, 1, 1, 1, 1, 6, 6, 6, 1, 8, 8, 8, 8, 8, 8, 8, 8
ATTACK acc: 35.59322033898305
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:32:22, Val iteration 0, acc 92.600 (92.600)
2021-06-11 23:32:25, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-11 23:32:27, Epoch 0, Iteration 7, loss 0.292 (0.338), acc 86.538 (88.200)
2021-06-11 23:32:42, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:9, Target's Score:[-0.38844568, 3.6812222, -4.154938, 4.8249335, -1.2677779, -3.3672674, -0.24711552, -2.5078394, -2.5353775, 6.344104]
Target sample: 7, Prediction:9, Target's Score:[0.67127174, 3.1152937, -1.4605194, 2.347738, 0.2756273, -4.1058183, -1.1044747, -2.237439, -3.5995824, 6.497689]
Target sample: 13, Prediction:9, Target's Score:[0.19561811, 2.075489, -3.1362069, 4.103653, -0.18692249, -2.8418703, 0.4609537, -0.99366355, -5.455674, 6.161939]
Target sample: 19, Prediction:9, Target's Score:[-0.06852515, 3.1084638, -3.951644, 1.671998, 0.7062284, -4.2874136, 2.0187905, -1.448565, -3.8006432, 6.441179]
Target sample: 25, Prediction:1, Target's Score:[0.29111692, 4.6040106, -4.3312774, 3.9871988, 0.2314112, -1.3574314, 2.4208508, -2.5535944, -5.667168, 2.752633]
Target sample: 31, Prediction:1, Target's Score:[-1.9462421, 11.475756, -4.945717, 2.7981954, -2.4386399, -2.0766778, 2.3373747, -3.0174313, -4.9787455, 3.2498407]
Target sample: 37, Prediction:9, Target's Score:[-0.59428877, 5.875948, -3.958497, 1.9461007, -2.8666768, -0.6731435, 1.7086841, -3.2654076, -5.583658, 7.8177505]
Target sample: 43, Prediction:1, Target's Score:[-0.18270575, 4.2401204, -1.5314275, 2.7398002, 0.12233167, -1.5196058, -2.3920958, 3.743929, -2.641314, -2.2073116]
Target sample: 49, Prediction:3, Target's Score:[-4.3218575, 4.509967, -5.6702495, 6.349782, -4.031219, 0.55606884, 1.2834738, -2.7972188, 4.41545, 0.036459483]
Target sample: 55, Prediction:1, Target's Score:[2.3305163, 5.8318887, -4.6828303, -0.40574753, -2.5374386, -1.5106345, 0.0905406, 0.13262594, -0.3275641, 1.3849887]
Target sample: 61, Prediction:1, Target's Score:[-0.7724324, 4.4919047, 0.83995354, 1.7982067, 2.0569603, -2.2814662, -1.4688879, 0.96056426, -2.7338564, -2.5000982]
Target sample: 67, Prediction:1, Target's Score:[0.6544525, 8.510078, -2.902855, 0.49966794, -0.43713313, -3.8619976, -0.9718306, -1.0516238, -4.2378507, 4.226524]
Target sample: 73, Prediction:9, Target's Score:[1.9484248, 3.7742982, -2.5587952, 2.1733778, 2.0100389, -4.3846292, 1.2919625, -2.5691721, -5.086744, 3.8183017]
Target sample: 79, Prediction:1, Target's Score:[0.5965776, 6.1610875, -4.3938665, 1.5158892, -0.64041704, -4.1831822, 2.8023999, -2.700606, -2.872302, 4.0910726]
Target sample: 85, Prediction:9, Target's Score:[-2.3280644, 1.629679, -3.9745884, 3.5862782, 0.22526458, -3.8526435, 5.733149, -3.1777217, -4.3431177, 6.893567]
Target sample: 91, Prediction:1, Target's Score:[2.3703854, 11.918733, -2.3780785, 4.035351, -3.0591276, -2.8468134, -0.94626755, -5.25497, -4.085612, 0.68970346]
Target sample: 97, Prediction:6, Target's Score:[-2.3953102, 4.9934926, -5.568407, 4.01962, -0.6846648, -0.6481605, 7.6095185, -4.2389903, -4.209179, 1.5203439]
Target sample: 103, Prediction:1, Target's Score:[-2.9528327, 7.044447, -3.901498, 6.2609367, -2.809601, -0.69178045, 1.8037012, -3.8016045, -1.3712679, 0.8086605]
Target sample: 109, Prediction:6, Target's Score:[-3.4106333, 6.5557055, -5.359242, 5.0951614, -5.892093, 3.5773022, 7.0761356, -6.951553, -0.6975184, 0.38589934]
Target sample: 115, Prediction:1, Target's Score:[1.0204873, 6.716394, -2.0813215, 2.2226214, -2.2560132, -1.0070952, 1.9981599, -3.06297, -4.0004044, 0.8228941]
Target sample: 121, Prediction:1, Target's Score:[0.45131183, 4.6752825, -3.516473, 1.6884977, 2.0679848, -0.02882453, -1.0255641, 0.13524966, -1.7525383, -2.341214]
Target sample: 127, Prediction:1, Target's Score:[-0.37191722, 7.347975, -5.715695, 3.483144, -2.8824496, -1.0952041, 3.4294748, -3.7834866, -4.6788244, 4.649039]
Target sample: 133, Prediction:1, Target's Score:[-1.2615714, 4.977687, -2.2754705, 3.8025353, 1.4699904, -3.3970296, 0.058295522, -0.65031844, -6.303393, 4.047008]
Target sample: 139, Prediction:9, Target's Score:[2.630578, 1.8771905, -1.8778639, 2.250514, 0.79940915, -4.4454784, -0.7433247, -1.1525923, -3.3789098, 4.3951445]
Current ATTACK acc on target samples: 8.333
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 23:32:58 Epoch 59, Val iteration 0, acc 90.000 (90.000)
2021-06-11 23:33:01 Epoch 59, Val iteration 19, acc 90.200 (89.540)
* Prec: 89.5400016784668
Per class accuracy =  [0.92463    0.9298334  0.84349473 0.83315672 0.89078349 0.82266891
 0.9379303  0.89093715 0.92899694 0.94656291]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 9, 1, 9, 9, 9, 9, 1, 3, 9, 9, 9, 1, 9, 1, 9, 3, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 3, 1, 1, 1, 1, 3, 3, 3, 1, 1, 1, 1, 3, 3, 3, 3, 9, 1, 1, 9, 1, 1, 9, 1, 1, 9, 1, 9, 9, 1, 3, 9, 9, 1, 9, 3, 1, 6, 1, 1, 1, 1, 1, 1, 1, 6, 3, 1, 6, 1, 1, 1, 1, 6, 6, 1, 1, 1, 3, 1, 1, 3, 6, 6, 1, 3, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 3, 9, 9, 3, 9, 9, 1
ATTACK acc: 5.932203389830509
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:33:06, Val iteration 0, acc 96.200 (96.200)
2021-06-11 23:33:13, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-11 23:33:16, Epoch 0, Iteration 7, loss 0.202 (0.536), acc 96.154 (86.200)
2021-06-11 23:33:49, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[2.4325237, 5.2966, -3.0174158, -2.3061619, -3.5239725, -1.9910091, 1.8141016, -2.7336118, 3.1734307, 1.0533185]
Target sample: 7, Prediction:1, Target's Score:[-0.1948018, 5.0210986, -2.4599257, -2.459987, -3.600519, -1.423388, 4.5132527, -2.7765384, 4.0184927, -0.457802]
Target sample: 13, Prediction:6, Target's Score:[2.5541792, 1.8455287, -2.0176725, 0.19068313, -2.869599, -1.644717, 3.62307, -3.0936835, 1.488998, 0.091906585]
Target sample: 19, Prediction:1, Target's Score:[1.6767706, 4.4563785, -2.185318, -0.32831618, -3.0079455, -2.4583347, 1.7641165, -2.3021944, 2.0033865, 0.5551978]
Target sample: 25, Prediction:8, Target's Score:[3.0633414, 0.46529925, 0.047863565, -2.737478, -1.6248361, -1.2493521, 2.470858, -3.4039814, 5.00669, -1.8391068]
Target sample: 31, Prediction:6, Target's Score:[-0.8290994, 3.1280296, 1.4892557, -1.7162298, -1.4861991, -1.4502453, 4.606362, -2.5312397, 0.86041033, -1.9105133]
Target sample: 37, Prediction:6, Target's Score:[1.7691263, 0.642545, -1.1746244, 0.70425576, -2.2377264, -0.83843374, 4.094146, -3.7104187, 2.8359292, -1.9163536]
Target sample: 43, Prediction:6, Target's Score:[-0.30619466, 0.76486546, -0.2225672, 0.98196185, 0.5011899, -2.8537428, 4.984406, -2.1855419, 1.5610039, -3.0801237]
Target sample: 49, Prediction:8, Target's Score:[-3.7703116, 1.3708613, -0.14308903, 0.73088306, -2.3573437, -1.0235898, 3.6469233, -2.5970716, 7.582773, -3.2655811]
Target sample: 55, Prediction:8, Target's Score:[-0.1264537, 2.8011143, -2.0323632, -1.5934316, -1.7789503, -0.23667142, 2.3224924, -2.4075677, 4.933404, -1.6960145]
Target sample: 61, Prediction:1, Target's Score:[-2.141152, 5.4168954, -2.398797, 0.4844595, -1.0651381, -1.9887096, 4.593856, -2.644091, 1.5488583, -1.6545871]
Target sample: 67, Prediction:1, Target's Score:[-0.63058835, 3.3287046, 2.5507627, -0.08464409, -1.7667807, -3.4419076, 0.72304815, -2.5593746, 2.591426, -0.54777914]
Target sample: 73, Prediction:8, Target's Score:[2.5534608, 2.9234035, -1.3288447, -2.1929753, -2.2340403, -2.7905908, 2.4090016, -2.6204884, 4.243165, -0.7812533]
Target sample: 79, Prediction:1, Target's Score:[-0.60268915, 5.076069, -2.2187498, -1.5179969, -3.236663, -1.6013793, 3.3013816, -2.8112872, 0.42743206, 3.3511505]
Target sample: 85, Prediction:1, Target's Score:[0.3036728, 3.103369, -2.7239037, -2.0715904, -2.659947, -0.9295911, 2.6527908, -3.1735506, 2.9867642, 2.6867416]
Target sample: 91, Prediction:3, Target's Score:[0.15277636, 1.8515401, 0.99851555, 5.0052423, -1.3717871, -2.712739, 1.6513556, -3.6420026, -0.25210738, -1.5204333]
Target sample: 97, Prediction:6, Target's Score:[-0.65708447, 2.5162501, -2.3847675, -0.69813925, -1.5541894, -0.7294835, 9.201299, -2.66232, -0.27255154, -2.607671]
Target sample: 103, Prediction:6, Target's Score:[-2.5784895, 3.6256995, -1.0296397, 1.8648757, 0.77891415, -3.6169283, 4.505345, -3.3763645, 2.291038, -2.3224103]
Target sample: 109, Prediction:6, Target's Score:[-3.1658142, 0.77288014, -1.6212313, -1.1584502, -2.4958682, -0.36399525, 11.130542, -2.9860146, 4.06318, -4.0371766]
Target sample: 115, Prediction:3, Target's Score:[-0.19446045, -0.34822172, -2.5005758, 5.987555, -0.4928137, -1.4346151, 2.406763, -3.5796726, 2.9627209, -2.6529324]
Target sample: 121, Prediction:8, Target's Score:[0.9593071, 0.58184344, -1.860459, 0.7517394, -2.0904424, -0.66186535, 2.7649589, -2.712782, 3.8630762, -1.4243412]
Target sample: 127, Prediction:6, Target's Score:[0.08351827, 4.6036987, -2.707845, -0.9650367, -3.5679438, -2.0097322, 5.3281164, -1.7760082, 2.0322566, -0.8464149]
Target sample: 133, Prediction:1, Target's Score:[-0.68271035, 3.807706, -2.5573492, 2.1389647, -2.4206343, -2.096681, 3.2015417, -1.8172647, 1.0569786, -0.47028902]
Target sample: 139, Prediction:0, Target's Score:[6.2149377, 0.4837125, -1.9070741, -3.4062448, -2.872724, -2.114426, 1.8102915, -3.0758793, 1.477224, 3.5914545]
Current ATTACK acc on target samples: 33.333
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 23:34:21 Epoch 59, Val iteration 0, acc 92.400 (92.400)
2021-06-11 23:34:28 Epoch 59, Val iteration 19, acc 93.800 (93.570)
* Prec: 93.57000198364258
Per class accuracy =  [0.94865178 0.95908429 0.90314769 0.8838006  0.94150883 0.89819237
 0.97447076 0.93316618 0.95657517 0.95555475]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 0, 1, 6, 6, 0, 6, 1, 6, 0, 0, 1, 1, 9, 8, 0, 6, 6, 6, 1, 1, 1, 1, 1, 1, 6, 1, 6, 6, 6, 6, 3, 6, 6, 1, 8, 6, 6, 8, 6, 1, 8, 1, 6, 6, 8, 6, 6, 8, 6, 1, 1, 1, 8, 8, 8, 8, 8, 1, 1, 1, 1, 8, 0, 6, 6, 1, 8, 6, 6, 6, 6, 6, 3, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 8, 1, 0, 8, 0
ATTACK acc: 50.847457627118644
--------
------SUMMARY PRE DEFENSE------
TIME ELAPSED (mins): 11
TARGET INDEX: 14
ResNet50 83.33333333333333 83.89830508474576 95.46000137329102 91.31000175476075
DPN92 25.0 35.59322033898305 95.50000267028808 92.46000213623047
MobileNetV2 8.333333333333334 5.932203389830509 91.22000160217286 89.5400016784668
GoogLeNet 33.333333333333336 50.847457627118644 95.41000213623047 93.57000198364258
DEFENSE EVALUATION
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
ResNet50
[74, 80, 84, 86, 89] 5
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:34:33, Val iteration 0, acc 94.200 (94.200)
2021-06-11 23:34:38, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-11 23:34:40, Epoch 0, Iteration 7, loss 0.068 (0.266), acc 98.077 (94.600)
2021-06-11 23:35:11, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:9, Target's Score:[-0.34157252, 3.6251907, -2.9291677, -1.1282475, 0.4771177, -3.9342206, -2.3001933, -0.5901385, 3.3988867, 4.204433]
Target sample: 7, Prediction:9, Target's Score:[-0.8101529, 3.877469, -2.6426065, 0.5388377, -1.9921908, -4.4980803, -2.8048356, 0.16098256, 3.1311162, 5.5335608]
Target sample: 13, Prediction:9, Target's Score:[0.05762586, -0.4625968, -1.5585781, -0.37583888, -0.20431152, -4.5909424, -2.770672, -0.037112873, 4.5669937, 5.8019066]
Target sample: 19, Prediction:8, Target's Score:[-0.28689367, 1.8720374, -2.8574057, 0.8791955, -1.8637413, -4.4406343, -2.5509558, -1.1887126, 8.89536, 2.0687282]
Target sample: 25, Prediction:1, Target's Score:[-0.012296282, 6.4602575, -2.6296477, 0.5931094, -2.3512373, -4.5934367, -2.3432176, -0.63320833, 2.7044086, 3.366827]
Target sample: 31, Prediction:1, Target's Score:[-1.3401482, 9.983011, -1.7983608, -0.0025404505, -2.3984694, -4.218153, -2.5541914, -1.6153617, -0.073589034, 4.6546493]
Target sample: 37, Prediction:1, Target's Score:[1.2172022, 7.432466, -3.126606, 2.0414205, -3.2779455, -3.302139, -2.121647, -1.5611767, 2.5767133, 0.6692611]
Target sample: 43, Prediction:1, Target's Score:[-0.45596617, 6.498718, -2.954578, 1.2892145, -1.7725002, -3.3545163, -1.6094697, -0.14995535, 2.5094948, 0.5103692]
Target sample: 49, Prediction:1, Target's Score:[-1.2888612, 7.7023773, -3.7433944, 1.8186918, -3.6769986, -4.4425426, -2.0207078, -1.567331, 5.434376, 2.3803966]
Target sample: 55, Prediction:1, Target's Score:[0.47974962, 9.486207, -3.0128012, 0.6417514, -3.1023872, -3.800568, -1.7256451, -0.86776066, 1.5302793, 0.9291617]
Target sample: 61, Prediction:1, Target's Score:[0.34518778, 6.207024, -0.49507263, 0.004247345, 0.06058374, -3.6405225, -2.4370337, -1.8430378, 0.8605794, 1.4884864]
Target sample: 67, Prediction:9, Target's Score:[-0.009996913, 4.5178494, 0.93828595, -0.08862835, -1.4420002, -4.104606, -2.9557445, -1.8378073, -1.0000149, 6.5405416]
Target sample: 73, Prediction:9, Target's Score:[0.31651318, 4.296083, -1.6360953, -0.09233317, -0.3822175, -3.7990012, -3.1688118, -0.4648467, 0.9849137, 4.4531097]
Target sample: 79, Prediction:1, Target's Score:[-0.43589592, 8.66662, -3.1345348, 0.6038208, -2.8805692, -4.0825577, -2.4152446, -0.70130163, 2.312866, 2.6209235]
Target sample: 85, Prediction:9, Target's Score:[-0.9141159, 7.052966, -2.7853634, 0.5324341, -2.950023, -4.003358, -3.1100736, -1.3488771, 0.27896157, 7.8349686]
Target sample: 91, Prediction:1, Target's Score:[0.3493715, 7.165311, -0.44152027, 2.2780225, -2.8318167, -3.2141578, -2.4028838, -2.1693099, 0.82617795, 0.975255]
Target sample: 97, Prediction:1, Target's Score:[0.62635267, 6.3043437, -2.876617, 1.2966704, -2.3085852, -3.040896, -1.6072043, -0.6527421, 1.4370092, 1.3056524]
Target sample: 103, Prediction:1, Target's Score:[-0.43224868, 5.874586, -2.8905785, 2.1853647, -2.294833, -4.1156707, -2.3674521, -2.0379782, 5.6856017, 0.9820889]
Target sample: 109, Prediction:1, Target's Score:[-0.3250677, 8.627807, -4.423747, 1.5365608, -2.784962, -3.6858757, 0.19719726, -1.8947134, 3.3516123, 0.0037968755]
Target sample: 115, Prediction:3, Target's Score:[0.014760673, 2.8885078, -2.700377, 4.822178, -3.0842566, -2.7545478, -1.2734008, -0.72753644, 3.3212602, 0.015380599]
Target sample: 121, Prediction:1, Target's Score:[0.75647146, 8.165235, -3.0984313, -0.19556816, -0.93251777, -3.5637321, -1.7062584, -1.1771979, 1.8022048, 0.4968542]
Target sample: 127, Prediction:9, Target's Score:[-0.34591252, 4.816365, -0.6191819, 1.2352072, -2.5499918, -3.6827426, -2.8507116, -0.78137356, -1.824075, 7.129626]
Target sample: 133, Prediction:1, Target's Score:[-0.25187653, 6.7496047, -1.6464183, 0.27843237, -0.6516661, -3.2356129, -2.4681098, -1.6955059, 0.659585, 2.7919643]
Target sample: 139, Prediction:9, Target's Score:[-0.048984066, 1.3651681, -2.3332179, -0.12680721, -1.2824306, -4.4985046, -2.848646, 0.19059262, 3.1400783, 6.8891287]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 23:35:42 Epoch 59, Val iteration 0, acc 92.400 (92.400)
2021-06-11 23:35:48 Epoch 59, Val iteration 19, acc 93.000 (92.530)
* Prec: 92.53000144958496
Per class accuracy =  [0.94790246 0.94381791 0.88432261 0.8673581  0.94620399 0.84853053
 0.9377156  0.95987162 0.95410035 0.96220489]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 9, 1, 8, 1, 9, 9, 8, 8, 8, 8, 8, 8, 8, 9, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 9, 9, 9, 1, 1, 1, 1, 1, 9, 9, 9, 9, 9, 1, 9, 9, 1, 1, 8, 8, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 3, 3, 3, 4, 1, 9, 9, 9, 9, 9, 1, 9, 9, 9, 1, 8, 8, 1, 8, 8, 8
ATTACK acc: 0.0
DPN92
[74, 80, 84, 89] 26
Using Adam for retraining
2000
poison index =  86
499
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:35:52, Val iteration 0, acc 94.800 (94.800)
2021-06-11 23:36:03, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-11 23:36:06, Epoch 0, Iteration 7, loss 0.199 (0.436), acc 96.154 (90.600)
2021-06-11 23:37:32, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6]
Target sample: 1, Prediction:8, Target's Score:[2.0549471, 4.6207943, -2.8494117, 0.0035122111, -2.9425006, -5.9656873, -1.3411032, -2.4527507, 8.664992, 0.8522064]
Target sample: 7, Prediction:8, Target's Score:[-0.3980939, 6.9762464, -2.3861818, -0.8250662, -3.7483063, -6.163303, 0.52740645, -3.7213984, 10.537681, -0.18936142]
Target sample: 13, Prediction:8, Target's Score:[-0.8961182, 6.333821, -2.08464, -0.6566714, -3.724344, -6.129229, 0.67242193, -3.503199, 11.13179, -0.5651872]
Target sample: 19, Prediction:1, Target's Score:[-0.86934716, 10.822622, -3.0001264, -1.0129062, -4.7346644, -5.644774, 0.5402331, -3.7038796, 7.789456, 0.4564521]
Target sample: 25, Prediction:1, Target's Score:[-0.9513751, 8.590665, -2.3304265, 1.1014655, -2.7615886, -5.351558, -0.6701813, -4.0516367, 7.8081317, -0.74717844]
Target sample: 31, Prediction:1, Target's Score:[-1.3967724, 9.768078, -3.1273658, 0.1358422, -3.409855, -5.076774, 0.05017851, -3.4616303, 7.783145, -0.6202231]
Target sample: 37, Prediction:3, Target's Score:[-2.670529, 5.255579, -1.5800029, 5.3489904, -1.4293678, -3.369999, 0.06831744, -3.1333594, 4.2732677, -2.1675882]
Target sample: 43, Prediction:1, Target's Score:[-1.4102235, 5.038347, -3.2150874, 0.27365094, -2.3650804, -1.7790757, 1.8574083, -2.1883678, 3.337781, 0.9967176]
Target sample: 49, Prediction:8, Target's Score:[-3.0149581, 2.4351628, -2.1992338, 3.6804237, -3.0186307, -3.2372956, 2.076565, -2.4971187, 8.319384, -1.9811401]
Target sample: 55, Prediction:8, Target's Score:[0.5733369, 2.0271735, -2.482895, -0.84932494, -3.1125076, -3.2551165, -0.57390267, -2.191348, 8.809409, 1.6189151]
Target sample: 61, Prediction:1, Target's Score:[-2.519244, 6.9679456, -0.962719, 4.3557286, -1.9910512, -3.2815905, -2.0235913, -4.4617023, 3.407061, 1.1116585]
Target sample: 67, Prediction:1, Target's Score:[-0.18492647, 12.921928, -1.810503, 1.1767398, -4.138132, -4.2625904, -1.6354308, -5.0282784, 2.8931835, 0.7618838]
Target sample: 73, Prediction:8, Target's Score:[-0.4207353, 7.5312457, -2.258585, -0.16669908, -3.7955687, -6.0427303, 0.34980682, -3.944379, 9.15392, 0.21670231]
Target sample: 79, Prediction:8, Target's Score:[-0.9506171, 8.035319, -2.3962555, -0.81529087, -4.7429495, -6.02318, 0.9395095, -4.3533263, 10.438368, 0.4923676]
Target sample: 85, Prediction:8, Target's Score:[-0.1958989, 8.450319, -2.521801, -1.406237, -4.522786, -6.667674, 0.19498304, -4.2482533, 10.505088, 1.0448031]
Target sample: 91, Prediction:1, Target's Score:[-1.9137299, 10.452635, -2.6051478, 2.8813367, -3.1372812, -3.8007085, 0.027404455, -3.713533, 3.2285302, -0.7628583]
Target sample: 97, Prediction:1, Target's Score:[-2.4136024, 7.255101, -3.7851536, 2.4748077, -2.7193952, -3.0526915, 1.8424736, -3.1108763, 4.3757486, -0.26879102]
Target sample: 103, Prediction:3, Target's Score:[-1.7997323, 2.732263, 0.70128334, 5.177855, -1.9117111, -3.7256935, 0.9987886, -4.0718064, 4.091833, -1.6112347]
Target sample: 109, Prediction:6, Target's Score:[-1.7580837, 1.514052, -1.873776, -1.1457152, -2.5559852, -2.1069489, 9.982472, -3.1859865, 4.333933, -2.6388576]
Target sample: 115, Prediction:3, Target's Score:[-2.8058622, -0.31127888, -0.17923541, 7.9253383, 2.041904, -1.5571712, -2.8222132, -2.1638403, 2.6201227, -2.116859]
Target sample: 121, Prediction:8, Target's Score:[0.4277992, 6.177526, -2.4577868, -0.4335227, -3.9979198, -3.154664, 1.3522661, -4.286557, 6.3661294, 0.60222197]
Target sample: 127, Prediction:1, Target's Score:[-0.9481086, 10.972671, -2.3823736, 0.96923774, -4.2118526, -4.8693566, 0.03721082, -3.9134653, 4.8046274, 0.19292328]
Target sample: 133, Prediction:1, Target's Score:[2.4266527, 6.183001, -2.9872665, 1.130334, -3.1646655, -5.0963464, -1.4682032, -2.1858613, 5.28279, 0.5664569]
Target sample: 139, Prediction:8, Target's Score:[0.94579726, 6.5865927, -2.7988875, -1.2657287, -4.1910005, -6.1274085, 0.4199657, -3.4528148, 9.182044, 1.2920234]
Current ATTACK acc on target samples: 4.167
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 23:38:56 Epoch 59, Val iteration 0, acc 94.000 (94.000)
2021-06-11 23:39:08 Epoch 59, Val iteration 19, acc 93.400 (93.130)
* Prec: 93.13000259399413
Per class accuracy =  [0.95309815 0.96066528 0.91608039 0.86921186 0.93357399 0.88860876
 0.95387646 0.9394236  0.95932856 0.93919507]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 1, 1, 1, 1, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 8, 8, 1, 1, 8, 8, 8, 8, 8, 8, 8, 9, 8, 9, 8, 9, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 8, 1, 8, 1, 8, 8, 8, 1, 1, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 6, 8, 8, 6, 6, 6, 8, 8, 8, 1, 3, 8, 8, 8, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 8, 8, 8, 8, 8, 8, 8, 8
ATTACK acc: 3.389830508474576
MobileNetV2
[80, 86, 89] 45
Using Adam for retraining
2000
poison index =  74
poison index =  84
498
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:39:11, Val iteration 0, acc 92.600 (92.600)
2021-06-11 23:39:14, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-11 23:39:15, Epoch 0, Iteration 7, loss 0.209 (0.304), acc 92.308 (89.800)
2021-06-11 23:39:30, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6]
Target sample: 1, Prediction:9, Target's Score:[-0.1555794, 4.9311304, -4.380885, 4.797155, -1.4819872, -3.8412888, -2.6013472, -2.2302313, -2.2091827, 7.8800564]
Target sample: 7, Prediction:9, Target's Score:[0.8570875, 4.1435165, -1.9463062, 2.662454, -0.47173706, -4.4457917, -2.8676224, -2.3632526, -3.7972074, 8.933185]
Target sample: 13, Prediction:9, Target's Score:[0.42925325, 3.3965323, -3.5482943, 4.0029387, -0.73574924, -3.151795, -1.0111123, -1.2194461, -5.3473825, 7.873102]
Target sample: 19, Prediction:9, Target's Score:[0.3339059, 5.046436, -4.3792157, 1.2180959, -0.7246647, -4.747686, 0.10607915, -1.5208491, -3.52569, 8.888864]
Target sample: 25, Prediction:1, Target's Score:[0.045286436, 5.476153, -4.5751033, 4.5677, -0.25906447, -2.0549972, 0.83289355, -2.248729, -5.7781596, 4.6899314]
Target sample: 31, Prediction:1, Target's Score:[-1.6679885, 12.705563, -4.700783, 2.942903, -3.810069, -2.5657036, 0.3148225, -2.5598466, -5.2989945, 5.4515367]
Target sample: 37, Prediction:9, Target's Score:[-0.06279789, 7.5904365, -4.135202, 1.6551856, -3.1829355, -1.1604825, -1.0660957, -3.2459333, -5.3097634, 9.664847]
Target sample: 43, Prediction:1, Target's Score:[-0.20948283, 5.269768, -1.8917257, 3.4532807, 0.19735427, -1.6691439, -4.072366, 4.0813217, -3.1346622, -1.3818129]
Target sample: 49, Prediction:3, Target's Score:[-3.943246, 5.299082, -5.625715, 7.139888, -4.937539, 0.06710548, -0.89369464, -2.5540912, 4.724906, 1.3574938]
Target sample: 55, Prediction:1, Target's Score:[2.5866585, 7.0995197, -5.068512, -0.12242156, -3.3643384, -1.6818912, -1.8136642, 0.19078802, -0.536065, 3.281663]
Target sample: 61, Prediction:1, Target's Score:[-0.6850979, 5.3163395, 1.1102926, 2.1957614, 2.2896218, -2.6031408, -3.5419526, 1.4212344, -3.24404, -1.6231921]
Target sample: 67, Prediction:1, Target's Score:[0.9729542, 9.757036, -2.858341, 0.9607675, -1.4641241, -4.3530273, -3.1218781, -1.2216538, -4.3778014, 6.460298]
Target sample: 73, Prediction:9, Target's Score:[2.4898553, 4.4960513, -2.6479735, 2.3167844, 0.80666745, -4.9729095, -0.627677, -2.611481, -4.4430704, 5.897244]
Target sample: 79, Prediction:1, Target's Score:[0.57152593, 8.143742, -4.7328634, 1.5160334, -2.2790687, -4.4270062, 0.79949135, -3.0169046, -2.752749, 6.8565044]
Target sample: 85, Prediction:9, Target's Score:[-1.948831, 3.8550193, -4.747881, 3.3132148, -1.2872797, -4.208433, 3.3296332, -3.173159, -3.8617017, 9.437996]
Target sample: 91, Prediction:1, Target's Score:[2.6099439, 12.755412, -2.2774878, 4.543944, -3.7798352, -3.1503325, -2.7523706, -5.2124996, -4.4307604, 2.4554472]
Target sample: 97, Prediction:1, Target's Score:[-2.3736258, 7.2610707, -6.2514896, 4.0746617, -1.1629653, -1.2233456, 5.174183, -4.397326, -4.068195, 3.7269068]
Target sample: 103, Prediction:1, Target's Score:[-2.7357616, 8.527189, -3.9357262, 6.2835836, -3.258756, -1.403691, -0.20479798, -3.4743712, -0.7563828, 1.6681634]
Target sample: 109, Prediction:1, Target's Score:[-3.496951, 7.6327963, -5.8139935, 5.2674255, -6.71723, 2.894026, 6.1531076, -7.206463, 0.79868805, 1.1913434]
Target sample: 115, Prediction:1, Target's Score:[0.9585297, 7.732342, -1.9934344, 2.2794783, -2.3265972, -1.5269254, 0.35227564, -2.4815805, -4.220179, 1.8785019]
Target sample: 121, Prediction:1, Target's Score:[0.51991034, 5.292897, -3.403645, 1.7781012, 1.9184566, -0.67407906, -2.3097615, 1.009074, -2.4859571, -1.029392]
Target sample: 127, Prediction:1, Target's Score:[-0.4774581, 8.897974, -6.166847, 3.6663563, -3.4728918, -1.3801049, 1.2643678, -3.7442865, -4.559848, 6.711012]
Target sample: 133, Prediction:1, Target's Score:[-1.1320103, 6.5277433, -2.5823255, 3.7700806, 0.7572249, -3.9311872, -2.4449115, -0.04524436, -5.9274054, 5.8163834]
Target sample: 139, Prediction:9, Target's Score:[2.7480078, 3.169134, -1.9652629, 2.2489817, 0.006640094, -4.5871115, -2.416847, -1.1688331, -3.4200704, 5.992135]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 23:39:46 Epoch 59, Val iteration 0, acc 89.000 (89.000)
2021-06-11 23:39:49 Epoch 59, Val iteration 19, acc 90.400 (89.460)
* Prec: 89.46000022888184
Per class accuracy =  [0.92472405 0.92690077 0.84617172 0.83276939 0.88931001 0.82268345
 0.93459178 0.89120186 0.92851315 0.94307304]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 9, 1, 9, 9, 9, 9, 1, 9, 9, 9, 9, 1, 9, 9, 9, 1, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 3, 1, 9, 1, 1, 3, 3, 3, 1, 1, 1, 1, 9, 9, 3, 9, 9, 1, 1, 9, 1, 1, 9, 1, 1, 9, 1, 9, 9, 1, 9, 9, 9, 1, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 9, 1, 1, 3, 6, 6, 1, 3, 1, 1, 9, 1, 1, 1, 1, 1, 1, 9, 9, 9, 9, 9, 9, 9, 9, 1
ATTACK acc: 2.542372881355932
GoogLeNet
[74, 80, 86, 89] 22
Using Adam for retraining
2000
poison index =  84
499
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:39:52, Val iteration 0, acc 96.200 (96.200)
2021-06-11 23:39:59, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-11 23:40:00, Epoch 0, Iteration 7, loss 0.541 (0.963), acc 84.615 (78.000)
2021-06-11 23:40:33, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6]
Target sample: 1, Prediction:1, Target's Score:[3.5175622, 6.035366, -3.8127193, -0.552628, -4.5724397, -4.311699, -1.5858413, -2.4469113, 3.4176848, 4.3631253]
Target sample: 7, Prediction:1, Target's Score:[-1.1546309, 7.911003, -3.449977, -0.91703427, -4.6703086, -3.8281095, 1.2619728, -0.7801366, 4.3424335, 1.3475683]
Target sample: 13, Prediction:1, Target's Score:[1.117389, 5.140178, -3.8769672, 2.9425547, -3.8976603, -3.4184902, 0.21101828, -1.5877033, 2.263688, 1.1576089]
Target sample: 19, Prediction:1, Target's Score:[0.8954097, 8.057992, -4.1374373, 1.2453494, -3.804369, -4.2419395, -0.90042734, -1.9873306, 1.8932565, 3.029382]
Target sample: 25, Prediction:8, Target's Score:[2.3184137, 3.5891037, -1.5812042, 0.18206593, -2.8434355, -4.2269473, 0.08312551, -2.784688, 4.911007, 0.4106422]
Target sample: 31, Prediction:1, Target's Score:[-1.3708949, 10.919183, -2.6681283, 0.20906052, -3.5615091, -3.84529, 1.0887395, -1.9570547, -0.02959514, 1.2495337]
Target sample: 37, Prediction:1, Target's Score:[1.4974563, 6.7066374, -3.5027533, 1.6697631, -3.4138412, -1.9885826, 0.17942543, -3.6317143, 0.10764462, 2.4135468]
Target sample: 43, Prediction:1, Target's Score:[-3.6808615, 6.439947, -3.7364428, 1.4849379, -1.9108409, -2.0586722, 3.1267319, 0.51743, 0.5277684, -0.6513355]
Target sample: 49, Prediction:1, Target's Score:[-4.7042036, 10.55432, -1.9860799, 0.9118689, -2.8765662, -3.2395165, 3.5597372, -2.4541624, 1.2405136, -0.95016193]
Target sample: 55, Prediction:1, Target's Score:[-1.8506399, 9.11193, -2.1345782, -0.041175343, -2.9460127, -2.3889658, -0.8673152, -1.9375732, 2.503339, 0.6050985]
Target sample: 61, Prediction:1, Target's Score:[-3.5302734, 9.614653, -2.7970688, 2.9898224, -2.8464391, -3.387649, 0.31515482, -0.99176884, -0.14208603, 0.8246318]
Target sample: 67, Prediction:1, Target's Score:[-0.83661693, 7.5808506, -2.2150056, 0.2637858, -3.5992594, -4.132996, -1.45637, -0.78395474, 3.1442664, 2.0921552]
Target sample: 73, Prediction:8, Target's Score:[3.2019086, 2.9289217, -3.6971939, -0.57726455, -1.7051249, -4.9411016, 1.4448448, -1.5328003, 4.1160054, 0.8146453]
Target sample: 79, Prediction:1, Target's Score:[-1.2067536, 9.584547, -3.4186141, 0.039003335, -4.219107, -4.4495926, 1.4588683, -2.6071553, 1.2449316, 3.623433]
Target sample: 85, Prediction:1, Target's Score:[-0.6762444, 6.7424927, -3.605049, -0.3844042, -4.1913414, -4.298697, -0.37354496, -2.5546465, 5.2470574, 4.1651373]
Target sample: 91, Prediction:1, Target's Score:[-0.022545096, 6.1454754, -3.4317436, 4.6491423, -2.2864685, -2.7853026, 0.46289295, -2.5557373, -1.3612655, 1.2268485]
Target sample: 97, Prediction:1, Target's Score:[0.10575975, 6.244934, -5.5235577, -0.43634626, -1.6025714, -2.1321628, 5.411948, -1.4666353, -0.02669758, -0.53840506]
Target sample: 103, Prediction:1, Target's Score:[-3.4089153, 8.924633, -3.0411394, 3.8927884, -0.87412375, -4.1294947, 3.1941848, -2.7669878, -0.8366716, -0.9152529]
Target sample: 109, Prediction:1, Target's Score:[-3.7444305, 8.003613, -1.6763569, 0.16954926, -3.0633197, -1.3141207, 7.604805, -3.8540897, 0.48073548, -2.5644474]
Target sample: 115, Prediction:3, Target's Score:[-2.013668, 1.8247842, -4.252842, 8.94729, -0.28396952, -0.3146432, 0.20686878, -3.0284648, -0.6435964, -0.3867192]
Target sample: 121, Prediction:1, Target's Score:[-1.3545656, 3.6101577, -4.003202, 1.4766412, -3.039659, -1.7497934, 2.5411267, -0.6894158, 0.52093405, 2.7451375]
Target sample: 127, Prediction:6, Target's Score:[1.4410954, 3.4788792, -4.635824, 0.22970173, -3.7815745, -4.34922, 4.0386057, -0.020542447, 0.5718031, 3.0777326]
Target sample: 133, Prediction:1, Target's Score:[0.7314612, 4.3746243, -2.8054025, 2.9545007, -3.2497048, -4.183485, -0.7096802, -0.41010225, 1.0530984, 2.295237]
Target sample: 139, Prediction:0, Target's Score:[4.4675355, 4.0513315, -3.4667556, -0.34267756, -3.853561, -4.1648583, -1.0298578, -2.430131, 3.342531, 3.4741132]
Current ATTACK acc on target samples: 4.167
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 23:41:05 Epoch 59, Val iteration 0, acc 92.800 (92.800)
2021-06-11 23:41:11 Epoch 59, Val iteration 19, acc 94.800 (92.920)
* Prec: 92.92000198364258
Per class accuracy =  [0.93686292 0.94015381 0.89104148 0.87210148 0.9551303  0.88938198
 0.96128635 0.93783998 0.95480048 0.95260386]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 8, 1, 8, 1, 1, 1, 1, 1, 8, 0, 1, 1, 1, 9, 8, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 9, 9, 9, 1, 1, 1, 1, 1, 1, 9, 0, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 9, 9, 6, 6, 1, 1, 1, 1, 1, 1, 1, 6, 3, 1, 6, 6, 9, 3, 6, 6, 9, 6, 6, 6, 0, 1, 1, 1, 1, 1, 1, 8, 1, 0, 1, 1
ATTACK acc: 9.322033898305085
------SUMMARY POST DEFENSE------
TIME ELAPSED (mins): 11
TARGET INDEX: 14
ResNet50 0.0 0.0 95.46000137329102 92.53000144958496 100.0
DPN92 4.166666666666667 3.389830508474576 95.50000267028808 93.13000259399413 80.0
MobileNetV2 0.0 2.542372881355932 91.22000160217286 89.46000022888184 60.0
GoogLeNet 4.166666666666667 9.322033898305085 95.41000213623047 92.92000198364258 80.0
True False False False True
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.300-droplayer0.000.t7
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
No specific indices are determined, so try to include whatever we find
In total, we found 92 images of target 15
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', eval_poisons_root='', feat_reg_flag=False, gpu='1', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=15, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/15/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91]
# Targets: 16, # Poisons: 5
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-11 23:41:29 Iteration 0 	 Training Loss: 8.987e-01 	 Loss in Target Net: 1.045e+00	  
 2021-06-11 23:42:04 Iteration 50 	 Training Loss: 4.108e-01 	 Loss in Target Net: 3.359e-01	  
 2021-06-11 23:42:36 Iteration 100 	 Training Loss: 3.776e-01 	 Loss in Target Net: 3.187e-01	  
 2021-06-11 23:43:10 Iteration 150 	 Training Loss: 3.710e-01 	 Loss in Target Net: 3.113e-01	  
 2021-06-11 23:43:43 Iteration 200 	 Training Loss: 3.638e-01 	 Loss in Target Net: 3.120e-01	  
 2021-06-11 23:44:16 Iteration 250 	 Training Loss: 3.616e-01 	 Loss in Target Net: 3.164e-01	  
 2021-06-11 23:44:50 Iteration 300 	 Training Loss: 3.612e-01 	 Loss in Target Net: 3.154e-01	  
 2021-06-11 23:45:22 Iteration 350 	 Training Loss: 3.581e-01 	 Loss in Target Net: 3.103e-01	  
 2021-06-11 23:45:55 Iteration 400 	 Training Loss: 3.572e-01 	 Loss in Target Net: 3.083e-01	  
 2021-06-11 23:46:29 Iteration 450 	 Training Loss: 3.598e-01 	 Loss in Target Net: 3.100e-01	  
 2021-06-11 23:47:02 Iteration 500 	 Training Loss: 3.574e-01 	 Loss in Target Net: 3.008e-01	  
 2021-06-11 23:47:35 Iteration 550 	 Training Loss: 3.632e-01 	 Loss in Target Net: 3.005e-01	  
 2021-06-11 23:48:08 Iteration 600 	 Training Loss: 3.572e-01 	 Loss in Target Net: 2.888e-01	  
 2021-06-11 23:48:41 Iteration 650 	 Training Loss: 3.546e-01 	 Loss in Target Net: 3.009e-01	  
 2021-06-11 23:49:15 Iteration 700 	 Training Loss: 3.560e-01 	 Loss in Target Net: 2.957e-01	  
 2021-06-11 23:49:48 Iteration 750 	 Training Loss: 3.546e-01 	 Loss in Target Net: 2.876e-01	  
 2021-06-11 23:50:22 Iteration 800 	 Training Loss: 3.531e-01 	 Loss in Target Net: 3.037e-01	  
 2021-06-11 23:50:55 Iteration 850 	 Training Loss: 3.540e-01 	 Loss in Target Net: 2.971e-01	  
 2021-06-11 23:51:29 Iteration 900 	 Training Loss: 3.523e-01 	 Loss in Target Net: 2.940e-01	  
 2021-06-11 23:52:03 Iteration 950 	 Training Loss: 3.547e-01 	 Loss in Target Net: 3.137e-01	  
 2021-06-11 23:52:37 Iteration 999 	 Training Loss: 3.520e-01 	 Loss in Target Net: 2.884e-01	  
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:52:40, Val iteration 0, acc 94.200 (94.200)
2021-06-11 23:52:46, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-11 23:52:49, Epoch 0, Iteration 7, loss 0.940 (0.694), acc 84.615 (86.400)
2021-06-11 23:53:20, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-3.4814513, 2.9912434, -2.0391889, -1.5724719, -2.117207, -3.0711684, 11.249275, -1.724778, 1.9321587, -1.7675847]
Target sample: 7, Prediction:6, Target's Score:[-3.481644, 2.8966966, -1.8920707, -1.6445429, -1.8899869, -3.1687174, 10.749701, -1.4602317, 0.4317474, -0.17064747]
Target sample: 13, Prediction:6, Target's Score:[-3.8142197, 5.46636, -1.4478122, -2.2028997, -1.9124173, -3.1640053, 10.842203, -1.480302, -2.1694257, 0.229399]
Target sample: 19, Prediction:6, Target's Score:[-3.4237819, 3.6195316, -1.8585708, -1.4257495, -2.0758781, -3.0596673, 10.506457, -1.3207594, -0.9297661, 0.31300598]
Target sample: 25, Prediction:6, Target's Score:[-3.2211494, -0.4127849, -1.6977586, -1.1338116, -1.9327818, -3.144069, 10.572782, -0.99921197, 0.36185282, 1.9518408]
Target sample: 31, Prediction:6, Target's Score:[-2.282035, 2.0204997, -2.2042897, -0.7567725, -2.7882063, -2.6280227, 8.193493, -0.35484058, -2.1478658, 3.2085764]
Target sample: 37, Prediction:6, Target's Score:[-3.650583, 0.3702548, -1.4903357, -1.2265722, -1.7956505, -3.2822733, 11.615143, -1.5132524, 0.54226875, 0.8097444]
Target sample: 43, Prediction:6, Target's Score:[-4.1506624, 4.7738314, -1.7389259, -1.7531438, -1.5818278, -3.144585, 11.705555, -1.9193711, -0.30456936, -1.4976193]
Target sample: 49, Prediction:6, Target's Score:[-3.4661517, 1.4113646, -1.7131227, -1.1953338, -1.8575339, -3.2447495, 11.347747, -1.5499549, 0.82864225, -0.17867024]
Target sample: 55, Prediction:6, Target's Score:[-2.1811726, 0.61412036, -1.3681936, 1.3209755, -2.288016, -2.137038, 11.204252, -1.7288154, -2.021984, -1.0704376]
Target sample: 61, Prediction:6, Target's Score:[-3.4934928, 1.4366258, -1.9912618, -1.0972074, -2.1248574, -3.0893776, 10.550343, -0.92689526, -0.4787869, 1.5602323]
Target sample: 67, Prediction:6, Target's Score:[-3.3755887, 1.8685366, -2.5469315, -0.93306845, -2.843357, -3.1734326, 9.057426, -1.0697612, -1.537411, 4.8370013]
Target sample: 73, Prediction:6, Target's Score:[-3.48311, 1.7292308, -1.8027573, -0.5394737, -2.2327347, -3.0334303, 10.4048815, -1.2845864, -1.2071224, 1.7796932]
Target sample: 79, Prediction:6, Target's Score:[-4.1705728, 3.2519617, -1.8892713, -1.863866, -2.09045, -3.6625054, 11.629165, -1.3139715, -1.7437707, 2.2222772]
Target sample: 85, Prediction:6, Target's Score:[-3.7100031, 2.8607674, -1.9183161, -1.2434387, -2.0666518, -2.9065459, 11.556817, -1.7253159, 1.1287471, -1.5764705]
Target sample: 91, Prediction:6, Target's Score:[-3.2464948, 1.7501593, -1.6569422, -1.3369304, -1.5822393, -3.0040436, 11.165519, -1.3652592, 0.44150513, -0.7841306]
Current ATTACK acc on target samples: 100.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 23:53:50 Epoch 59, Val iteration 0, acc 89.000 (89.000)
2021-06-11 23:53:56 Epoch 59, Val iteration 19, acc 89.800 (88.430)
* Prec: 88.43000106811523
Per class accuracy =  [0.91782937 0.9078584  0.81753309 0.7860929  0.85856834 0.81533404
 0.96738922 0.91179689 0.93615628 0.92615747]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 100.0
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:54:03, Val iteration 0, acc 94.800 (94.800)
2021-06-11 23:54:14, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-11 23:54:22, Epoch 0, Iteration 7, loss 0.293 (0.334), acc 88.462 (91.000)
2021-06-11 23:55:47, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-0.8388875, 3.963888, -2.4156935, -1.7648568, -2.4634526, -0.8512908, 11.041904, -3.8009992, 0.5885938, -3.131173]
Target sample: 7, Prediction:6, Target's Score:[-0.82371795, 4.694525, -2.9772274, -1.1055955, -2.2164354, -1.4122822, 8.959963, -3.7978024, 0.6166035, -1.6104978]
Target sample: 13, Prediction:1, Target's Score:[-1.1753762, 10.01504, -3.7460763, -2.4889588, -3.1362453, -1.984508, 7.0323353, -4.628069, 0.059248526, 0.45759305]
Target sample: 19, Prediction:6, Target's Score:[-2.099789, 6.090459, -2.3042421, -0.27612615, -2.5356026, -2.0882368, 7.1617136, -3.5896513, 1.1124301, -1.1357868]
Target sample: 25, Prediction:6, Target's Score:[-1.332244, 1.7549837, -2.5375304, 1.0848384, -2.7948434, -2.8974257, 6.1063113, -2.0783098, 3.1707628, -0.16881087]
Target sample: 31, Prediction:6, Target's Score:[-0.9152546, 3.0593083, -2.1609223, -0.32280755, -2.565488, -1.4758878, 8.672401, -2.0412543, 0.7966192, -2.7346947]
Target sample: 37, Prediction:1, Target's Score:[-1.8062053, 8.343629, -3.4519506, -1.3921434, -3.049417, -1.3106111, 5.84203, -3.5793357, 1.2803293, -0.51517427]
Target sample: 43, Prediction:6, Target's Score:[-1.2491826, 8.2066145, -3.5681713, -2.0906818, -2.5102377, -1.8474398, 8.804845, -4.080659, 1.0135095, -2.2839732]
Target sample: 49, Prediction:6, Target's Score:[-1.2683971, 1.7316831, -2.8370395, 0.21511358, -0.23140043, -1.5514024, 8.617968, -3.3998592, 1.4877746, -2.4845462]
Target sample: 55, Prediction:6, Target's Score:[-1.1196357, 4.729777, -2.7207737, 0.6876329, -2.6346822, -1.2347468, 6.334932, -3.2557774, -0.47085702, 0.006663624]
Target sample: 61, Prediction:6, Target's Score:[-1.6414644, 6.644757, -2.559094, -0.44746578, -2.4029124, -1.6223861, 7.2900767, -3.3100255, 1.2312214, -2.830337]
Target sample: 67, Prediction:1, Target's Score:[-1.7930127, 7.075488, -3.449609, -0.04304502, -2.9977665, -2.0629206, 4.0536017, -3.6629825, 2.7485156, 0.48351756]
Target sample: 73, Prediction:1, Target's Score:[-1.4997267, 5.032457, -3.1610012, -0.58702445, -3.1554873, -2.2332919, 4.3687487, -2.4627886, 2.3002703, 1.7080611]
Target sample: 79, Prediction:1, Target's Score:[-1.8658333, 11.013407, -3.7543764, -2.315612, -3.701591, -1.4963171, 7.0032406, -4.887389, -1.2797899, 1.7115443]
Target sample: 85, Prediction:6, Target's Score:[-0.78012496, 4.2896166, -2.584944, -1.7796701, -2.3575819, -0.7151613, 11.537743, -4.0088468, 0.30516854, -3.5616086]
Target sample: 91, Prediction:6, Target's Score:[-1.1252072, 2.2176058, -2.0213063, -0.41283053, -1.612, -1.6102597, 10.92559, -3.6811655, 0.7235408, -3.1157067]
Current ATTACK acc on target samples: 68.750
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 23:57:11 Epoch 59, Val iteration 0, acc 93.200 (93.200)
2021-06-11 23:57:23 Epoch 59, Val iteration 19, acc 93.200 (93.020)
* Prec: 93.02000160217285
Per class accuracy =  [0.94040258 0.95043448 0.90801613 0.86028512 0.95404951 0.8985794
 0.94610687 0.93457899 0.96669043 0.94415872]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 1, 1, 6, 1, 1, 1, 6, 1, 1, 1, 6, 1, 1, 1, 8, 6, 1, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 6, 1, 1, 6, 1, 6, 6, 6, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 52.63157894736842
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:57:26, Val iteration 0, acc 92.600 (92.600)
2021-06-11 23:57:29, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-11 23:57:30, Epoch 0, Iteration 7, loss 0.487 (0.375), acc 90.385 (90.600)
2021-06-11 23:57:44, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.01258, 8.31565, -2.9941182, -1.0268873, -5.388383, -1.505841, 9.151319, -4.579266, 0.8357155, -0.5017458]
Target sample: 7, Prediction:1, Target's Score:[-2.2881763, 10.699184, -3.4422555, 0.44639808, -3.670661, -1.8500668, 3.5982418, -4.717602, 0.43309695, 1.146616]
Target sample: 13, Prediction:1, Target's Score:[-2.1456532, 10.901244, -4.061341, 1.6588999, -4.16165, 0.6390045, 2.9832623, -4.2610097, -2.7347465, 1.5415658]
Target sample: 19, Prediction:1, Target's Score:[-3.722121, 9.234875, -4.6562576, 0.398957, -4.467335, 0.69220036, 5.5544825, -5.224126, 1.1810626, 1.3884901]
Target sample: 25, Prediction:1, Target's Score:[-2.5683498, 6.4042335, -2.9205875, 1.3044106, -5.6395164, -1.4549524, 2.3868957, -3.5769851, 4.4779797, 1.9388344]
Target sample: 31, Prediction:1, Target's Score:[-1.4682997, 11.14793, -1.9013937, 2.4889545, -4.3292503, -0.25717118, -2.7691727, 0.9644601, -1.8286879, -1.6403718]
Target sample: 37, Prediction:1, Target's Score:[-2.3825984, 10.771133, -3.8490372, 2.722913, -4.4185486, -0.7428562, 3.5030408, -5.08805, -0.0055870414, -0.14880566]
Target sample: 43, Prediction:1, Target's Score:[-3.7604897, 13.33996, -3.1047027, -0.35220093, -4.6751537, 0.0871185, 3.830286, -4.7332773, -0.049227744, -0.18640575]
Target sample: 49, Prediction:1, Target's Score:[-2.542379, 10.009767, -4.615354, 1.5598954, -1.3398029, -2.2490234, 3.494343, -3.4024782, -0.6751544, 0.1317643]
Target sample: 55, Prediction:1, Target's Score:[2.722705, 7.493159, -5.0102882, 5.997001, -2.7278786, -0.6233931, -1.8462293, -3.3967628, -2.609036, 0.31880546]
Target sample: 61, Prediction:1, Target's Score:[-2.7397814, 13.740092, -2.7071776, -0.50860715, -6.06214, -0.8854814, 2.5992277, -3.0664716, -1.2681098, 1.296826]
Target sample: 67, Prediction:1, Target's Score:[-2.5027812, 11.47801, -5.2027006, 0.19673415, -3.485032, -1.9918083, 2.116982, -1.636963, -1.3759134, 2.7914674]
Target sample: 73, Prediction:1, Target's Score:[-3.125031, 12.159789, -3.9704132, 0.8000409, -4.1440196, -0.5631252, -0.55992764, -0.9259966, -0.22593403, 0.96658653]
Target sample: 79, Prediction:1, Target's Score:[-2.550101, 7.263584, -3.3814974, 4.351581, -3.737975, -1.2426159, 5.204045, -5.325879, -3.3045702, 3.086034]
Target sample: 85, Prediction:6, Target's Score:[-2.1147177, 7.885798, -3.1470044, -0.49529648, -5.1721015, -1.6801484, 9.578017, -5.3795505, 1.5584807, -0.7353966]
Target sample: 91, Prediction:1, Target's Score:[-2.590253, 10.998629, -3.560371, 0.3850165, -4.8317885, -2.20054, 7.399217, -5.4977503, 0.0023748726, 0.25285596]
Current ATTACK acc on target samples: 12.500
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 23:57:59 Epoch 59, Val iteration 0, acc 90.000 (90.000)
2021-06-11 23:58:02 Epoch 59, Val iteration 19, acc 90.600 (89.540)
* Prec: 89.54000053405761
Per class accuracy =  [0.92506199 0.9194972  0.84967391 0.83113365 0.88839227 0.82736803
 0.93835596 0.88992141 0.93476916 0.94494958]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 6, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1
ATTACK acc: 9.210526315789474
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:58:06, Val iteration 0, acc 96.200 (96.200)
2021-06-11 23:58:13, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-11 23:58:16, Epoch 0, Iteration 7, loss 0.707 (0.746), acc 78.846 (80.200)
2021-06-11 23:58:48, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.7555227, 6.7335777, -2.8609731, -2.1435556, -3.57355, -2.4480422, 7.9046483, -2.8814027, 3.9653876, -1.8734277]
Target sample: 7, Prediction:6, Target's Score:[-3.6729832, 7.323281, -3.1762815, -3.0630414, -3.4627662, -0.6079831, 9.060045, -3.188533, 1.4046127, -0.544096]
Target sample: 13, Prediction:1, Target's Score:[-0.0073494744, 5.833902, -2.4938893, -2.861366, -2.41767, -0.18194972, 5.17875, -2.1919727, -1.3231027, 0.52441376]
Target sample: 19, Prediction:1, Target's Score:[-0.96884656, 5.4172707, -1.3398286, -1.0246443, -2.1898468, -2.3426409, 5.1777163, -0.8782169, -1.5666919, -0.23007387]
Target sample: 25, Prediction:6, Target's Score:[1.0185196, 0.84621435, -1.2515286, -1.1626033, -1.9730887, -3.6367893, 5.4767904, -1.1418538, 3.349818, -1.4635199]
Target sample: 31, Prediction:6, Target's Score:[0.63969046, 3.1533215, -1.3919892, 1.3055781, -2.260707, -1.9999706, 3.736689, -2.1470282, 0.5921141, -1.5795454]
Target sample: 37, Prediction:8, Target's Score:[-0.47809497, 2.0474918, -3.9633977, 0.5446385, -0.24716888, -3.6830142, 3.2209713, -1.1798531, 6.1168804, -2.3214867]
Target sample: 43, Prediction:1, Target's Score:[-3.240761, 5.940784, -2.4159303, -1.335226, -0.7823252, -1.5833087, 4.4613934, -3.191307, 3.2536633, -1.0437628]
Target sample: 49, Prediction:8, Target's Score:[-0.027617885, 3.0003402, -3.4314132, 0.51083744, -2.5490222, -3.513303, 2.713015, -1.1078439, 5.2898316, -0.82530975]
Target sample: 55, Prediction:6, Target's Score:[3.49569, 2.4435475, -3.6970792, -0.009231968, -1.7712097, -2.6992173, 4.0664144, 0.2386368, -0.64715093, -1.3661662]
Target sample: 61, Prediction:6, Target's Score:[-1.2958195, 3.5364587, -1.038053, -1.3398527, -2.843444, -2.3030362, 9.021685, -2.5188105, -0.63267964, -0.5276612]
Target sample: 67, Prediction:1, Target's Score:[-1.0000123, 5.637009, -4.1211557, -0.6395484, -2.1325953, -3.7507503, 4.1713157, -1.644538, 0.7599847, 2.7942383]
Target sample: 73, Prediction:1, Target's Score:[-2.3850312, 4.3247504, -1.9437073, 2.452181, -1.5619324, -2.0478399, 2.277037, -2.4659786, -0.5491006, 1.9555221]
Target sample: 79, Prediction:1, Target's Score:[-3.399888, 9.436638, -3.834762, -0.87786263, -1.8728428, -1.0442337, 4.523115, -3.3284829, -0.944819, 1.4081051]
Target sample: 85, Prediction:6, Target's Score:[-2.058592, 6.984339, -3.0006104, -1.8169781, -2.9327893, -2.420561, 8.942116, -3.2135003, 1.6305895, -2.0502548]
Target sample: 91, Prediction:6, Target's Score:[-3.9403234, 7.4566436, -3.20268, -2.3927264, -3.3360126, -1.9902023, 8.710171, -3.0028903, 3.272109, -1.5027974]
Current ATTACK acc on target samples: 50.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-11 23:59:21 Epoch 59, Val iteration 0, acc 92.600 (92.600)
2021-06-11 23:59:27 Epoch 59, Val iteration 19, acc 94.200 (92.920)
* Prec: 92.92000198364258
Per class accuracy =  [0.94729134 0.94875223 0.85887139 0.88275479 0.95917874 0.8909862
 0.96551165 0.92422897 0.96107097 0.95177978]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 1, 1, 6, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 6, 1, 1, 1, 6, 6, 6, 6, 8, 8, 6, 6, 0, 0, 8, 6, 1, 8, 8, 8, 1, 8, 1, 8, 8, 8, 8, 1, 1, 1, 1, 6, 6, 1, 1, 6, 6, 6, 1, 1, 1, 1, 6, 6, 6, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 1, 1, 1, 6, 6, 6
ATTACK acc: 36.8421052631579
--------
------SUMMARY PRE DEFENSE------
TIME ELAPSED (mins): 11
TARGET INDEX: 15
ResNet50 100.0 100.0 95.46000137329102 88.43000106811523
DPN92 68.75 52.63157894736842 95.50000267028808 93.02000160217285
MobileNetV2 12.5 9.210526315789474 91.22000160217286 89.54000053405761
GoogLeNet 50.0 36.8421052631579 95.41000213623047 92.92000198364258
DEFENSE EVALUATION
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
ResNet50
[74, 80, 84, 86, 89] 6
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-11 23:59:32, Val iteration 0, acc 94.200 (94.200)
2021-06-11 23:59:38, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-11 23:59:39, Epoch 0, Iteration 7, loss 0.271 (0.298), acc 92.308 (93.800)
2021-06-12 00:00:10, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[2.6926787, 12.5717535, -4.055049, -0.9858563, -5.9742184, -3.4455352, -0.18842475, -3.6394503, 6.3393116, -2.9485095]
Target sample: 7, Prediction:1, Target's Score:[3.0441868, 13.966592, -3.5964973, -2.19997, -5.6308894, -3.9189427, -0.50725096, -3.1525354, 3.4049103, -1.0340732]
Target sample: 13, Prediction:1, Target's Score:[2.6493914, 14.079479, -2.1345367, -1.8376647, -5.42525, -2.9003873, -1.6055851, -3.106239, 0.36421087, 0.32834965]
Target sample: 19, Prediction:1, Target's Score:[1.5168253, 16.167269, -2.9321837, -1.8056978, -6.0348945, -4.397564, -2.602063, -3.6248558, 2.1623666, 1.9926094]
Target sample: 25, Prediction:1, Target's Score:[0.17993888, 8.396824, -3.2298977, -1.1334286, -4.816212, -3.9829834, -1.0050269, -2.2159321, 7.9741387, 0.15880576]
Target sample: 31, Prediction:1, Target's Score:[2.972117, 11.750615, -2.1545746, -1.1841661, -5.321171, -3.6375923, -3.0296967, -2.5556517, -1.2496209, 4.826167]
Target sample: 37, Prediction:1, Target's Score:[1.1634188, 11.108521, -2.0711672, -0.14682123, -4.2323794, -3.6131172, -2.5393507, -2.9854925, 1.4031346, 2.297559]
Target sample: 43, Prediction:1, Target's Score:[1.7448668, 16.097202, -3.253952, -1.1516187, -5.9684844, -4.3421373, -1.3026161, -3.9048736, 3.9938478, -1.4975915]
Target sample: 49, Prediction:1, Target's Score:[1.4096295, 13.168223, -2.2813754, -1.6885971, -5.3141756, -4.6038914, -1.3018286, -2.8763316, 4.3248315, -0.46519703]
Target sample: 55, Prediction:1, Target's Score:[4.876679, 10.478105, -2.4598634, 0.87283516, -5.5531645, -3.4487612, -2.421441, -1.928585, -1.2035555, 1.225274]
Target sample: 61, Prediction:1, Target's Score:[0.78273034, 14.64257, -2.8754382, -0.79686815, -5.5821915, -3.4120474, -2.4512897, -3.7374678, 1.7935375, 2.0521097]
Target sample: 67, Prediction:1, Target's Score:[-0.12216477, 15.057631, -3.0348656, -1.1474174, -5.6669135, -4.275407, -3.0896358, -3.4535, 0.6308871, 5.535872]
Target sample: 73, Prediction:1, Target's Score:[0.5207661, 12.658088, -2.0546095, -0.7128709, -5.0724883, -3.8730886, -2.8338244, -3.0672135, -0.44753233, 5.278844]
Target sample: 79, Prediction:1, Target's Score:[1.0227007, 11.461338, -2.5177965, -0.7287338, -4.833373, -3.0638156, -1.4071889, -3.098169, -1.0728301, 4.6041436]
Target sample: 85, Prediction:1, Target's Score:[2.7811139, 12.154785, -4.029058, -0.20600626, -5.8851566, -3.0995393, 0.16139692, -3.7799659, 5.3485785, -3.076552]
Target sample: 91, Prediction:1, Target's Score:[3.235189, 12.461811, -3.338403, -1.2096468, -5.3790092, -3.6876345, -0.17729706, -3.0747972, 3.6305223, -2.099103]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 00:00:40 Epoch 59, Val iteration 0, acc 92.400 (92.400)
2021-06-12 00:00:46 Epoch 59, Val iteration 19, acc 93.600 (92.260)
* Prec: 92.26000099182129
Per class accuracy =  [0.9492959  0.96167014 0.89208394 0.82787397 0.93474886 0.89132881
 0.95400683 0.93013029 0.94255512 0.94125628]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
DPN92
[74, 80, 84, 86, 89] 27
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 00:00:50, Val iteration 0, acc 94.800 (94.800)
2021-06-12 00:01:01, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-12 00:01:04, Epoch 0, Iteration 7, loss 0.312 (0.393), acc 92.308 (90.000)
2021-06-12 00:02:30, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-0.64163834, 15.672483, -3.39741, -1.3139217, -4.395571, -3.6318357, 0.14418994, -4.5563045, 2.723039, -0.038311705]
Target sample: 7, Prediction:1, Target's Score:[-0.5258276, 16.11234, -4.1419077, -1.2199633, -4.06149, -3.3168063, -0.359832, -4.8020554, 2.1367362, 0.76142734]
Target sample: 13, Prediction:1, Target's Score:[-0.6689597, 18.899786, -4.5162783, -1.2475404, -5.013047, -4.106078, -0.12502572, -5.304586, 1.7699786, 0.98590195]
Target sample: 19, Prediction:1, Target's Score:[-1.0312788, 17.374643, -3.7282214, -0.66596204, -5.2904, -4.233684, -0.039505515, -5.0359674, 2.7514007, 0.55730456]
Target sample: 25, Prediction:1, Target's Score:[-0.54973656, 14.757476, -4.070633, 0.37681073, -5.337595, -4.4188247, 0.33527488, -4.038329, 3.0171573, 0.5279313]
Target sample: 31, Prediction:1, Target's Score:[0.19471224, 15.094516, -4.132011, -0.37623587, -4.8345084, -3.1922739, -0.4088243, -3.4896767, 1.8425597, -0.14002696]
Target sample: 37, Prediction:1, Target's Score:[0.25713193, 14.130949, -3.9499917, -0.7926417, -3.68689, -2.773966, -0.8317139, -3.8594525, 1.4506807, 0.58327943]
Target sample: 43, Prediction:1, Target's Score:[-0.3903984, 15.49736, -3.3749874, -1.0595801, -4.075972, -3.3888154, -0.101013556, -4.119862, 2.1644826, -0.5995438]
Target sample: 49, Prediction:1, Target's Score:[-0.69565123, 11.309316, -3.500738, 1.0494634, -2.6279998, -3.3146844, 0.039861307, -4.0236197, 2.6661909, -0.41240886]
Target sample: 55, Prediction:1, Target's Score:[-0.17745146, 14.30479, -4.660328, 1.3591373, -4.9898376, -3.6362739, -0.56997806, -4.1414127, 0.95650154, 2.1713192]
Target sample: 61, Prediction:1, Target's Score:[-0.60678864, 17.793613, -3.8255258, -0.15964976, -5.2308083, -4.0777326, -0.40572608, -4.9586496, 2.1592488, -0.023403611]
Target sample: 67, Prediction:1, Target's Score:[-0.42607284, 16.435862, -4.277604, -0.75969374, -4.5547557, -3.4030023, -0.841346, -4.821, 1.6109875, 1.6594453]
Target sample: 73, Prediction:1, Target's Score:[-0.30904254, 14.41316, -4.162829, -0.88950837, -4.448638, -3.6816502, -0.473251, -4.195208, 1.6147527, 2.704358]
Target sample: 79, Prediction:1, Target's Score:[-1.529708, 18.163363, -4.6235404, -1.0665865, -4.746258, -3.5360062, -0.04839187, -5.3007035, 1.1975632, 2.163187]
Target sample: 85, Prediction:1, Target's Score:[-0.5633617, 16.896084, -3.7879343, -1.479253, -4.556328, -3.6474464, -0.031483095, -4.7143755, 2.4168591, 0.059406985]
Target sample: 91, Prediction:1, Target's Score:[-0.9063185, 15.365701, -3.7702692, -0.53336203, -4.329317, -3.7696605, 0.43182924, -4.621938, 2.8180392, -0.10858989]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 00:03:54 Epoch 59, Val iteration 0, acc 93.200 (93.200)
2021-06-12 00:04:06 Epoch 59, Val iteration 19, acc 93.200 (93.300)
* Prec: 93.30000114440918
Per class accuracy =  [0.95694712 0.96935053 0.90160955 0.84948214 0.94216214 0.89976605
 0.947305   0.94529604 0.97451948 0.94814334]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
MobileNetV2
[74, 84, 86, 89] 47
Using Adam for retraining
2000
poison index =  80
499
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 00:04:08, Val iteration 0, acc 92.600 (92.600)
2021-06-12 00:04:11, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-12 00:04:12, Epoch 0, Iteration 7, loss 0.266 (0.302), acc 92.308 (91.400)
2021-06-12 00:04:26, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6]
Target sample: 1, Prediction:1, Target's Score:[-1.1805109, 10.473859, -3.4274368, -0.8644353, -6.1646276, -1.6320362, 5.474117, -4.404735, 0.9186326, 1.2479019]
Target sample: 7, Prediction:1, Target's Score:[-1.3777912, 12.099523, -3.7338388, 0.44780898, -4.654154, -1.959047, -0.10070005, -4.42835, 1.1503545, 3.0501473]
Target sample: 13, Prediction:1, Target's Score:[-0.8085163, 13.698878, -4.764696, 1.4233981, -4.801968, 0.123778865, -1.4143335, -4.1582365, -2.8492138, 4.1065974]
Target sample: 19, Prediction:1, Target's Score:[-3.0008276, 11.026153, -5.054206, 0.080397025, -5.294052, 0.7443602, 2.2724862, -4.789853, 1.3516876, 3.1990943]
Target sample: 25, Prediction:1, Target's Score:[-2.1252313, 7.3892093, -2.9299116, 1.5240405, -6.021465, -1.3661327, -0.68809575, -2.8531802, 3.9226007, 3.6121738]
Target sample: 31, Prediction:1, Target's Score:[-0.49611568, 13.845199, -2.1496482, 2.0428393, -5.3051524, -0.6923959, -6.2372694, 1.8392001, -2.0465095, -0.2260182]
Target sample: 37, Prediction:1, Target's Score:[-0.20184804, 13.619893, -4.3302746, 1.9112701, -5.3014665, -1.4860165, -0.57684314, -4.9736714, 0.10555245, 1.7543299]
Target sample: 43, Prediction:1, Target's Score:[-2.912366, 15.370766, -3.262121, -0.19298764, -5.821473, 0.14793976, -0.35847774, -4.20435, 0.6016847, 1.1476898]
Target sample: 49, Prediction:1, Target's Score:[-1.8346437, 11.496188, -4.8956246, 1.9372575, -2.0339892, -2.269257, 0.31612876, -3.2955098, -0.12426199, 1.2479177]
Target sample: 55, Prediction:1, Target's Score:[3.6188798, 8.764632, -5.112715, 5.7865863, -2.9913228, -0.90138125, -4.24244, -3.0326655, -2.7960691, 1.4508631]
Target sample: 61, Prediction:1, Target's Score:[-1.4823531, 16.368471, -2.681527, -0.6582226, -6.746051, -1.531802, -1.8719146, -2.6607344, -1.5211825, 3.337252]
Target sample: 67, Prediction:1, Target's Score:[-1.4866353, 13.652609, -5.0669036, 0.2072369, -4.1480803, -1.6972393, -2.813775, -0.8416457, -2.1358442, 4.8905244]
Target sample: 73, Prediction:1, Target's Score:[-1.9953902, 14.024388, -3.560711, 1.4041613, -5.1217585, -0.6772433, -4.8081098, -0.9700885, -0.78127813, 3.056896]
Target sample: 79, Prediction:1, Target's Score:[-1.2579339, 9.2091, -3.6362672, 3.9986684, -4.5577774, -1.1424354, 0.6887932, -4.2198734, -3.2653656, 4.751326]
Target sample: 85, Prediction:1, Target's Score:[-1.414171, 9.990468, -3.8592114, -0.09542413, -6.1104774, -1.7537582, 5.7124295, -5.164682, 2.2724805, 0.87037534]
Target sample: 91, Prediction:1, Target's Score:[-1.5894536, 12.710591, -4.0510874, 0.69815826, -5.6388884, -2.1421754, 2.9519827, -5.0114627, 0.6876402, 1.8897866]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 00:04:41 Epoch 59, Val iteration 0, acc 90.000 (90.000)
2021-06-12 00:04:44 Epoch 59, Val iteration 19, acc 90.200 (89.610)
* Prec: 89.6100009918213
Per class accuracy =  [0.91994703 0.93014631 0.84668936 0.83401949 0.88958819 0.82423448
 0.9349018  0.89347889 0.93632299 0.94806233]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
GoogLeNet
[74, 80, 84, 86, 89] 22
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 00:04:47, Val iteration 0, acc 96.200 (96.200)
2021-06-12 00:04:54, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-12 00:04:55, Epoch 0, Iteration 7, loss 0.977 (0.946), acc 69.231 (78.600)
2021-06-12 00:05:27, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-3.5154252, 12.781772, -1.6804152, -2.1524675, -4.502542, -4.1583247, 0.7595061, -3.486146, 5.8465962, 0.108592875]
Target sample: 7, Prediction:1, Target's Score:[-4.767851, 12.370166, -2.0039768, -3.0413787, -4.146793, -1.9928677, 1.8353621, -3.6991475, 4.3299756, 1.1230332]
Target sample: 13, Prediction:1, Target's Score:[-1.0088537, 10.009259, -1.2905416, -4.522625, -3.0303702, -0.043427393, -0.10702478, -2.378878, -0.7806661, 3.1838942]
Target sample: 19, Prediction:1, Target's Score:[-2.428165, 9.592561, 0.8697101, -2.0499544, -2.6059892, -3.9205852, -0.14400204, -1.049756, 0.48750478, 1.2725717]
Target sample: 25, Prediction:8, Target's Score:[1.1836301, 3.2022538, 0.8441713, -1.667826, -1.7365221, -5.581118, -0.27355984, -1.7671335, 6.4804907, -0.6919026]
Target sample: 31, Prediction:1, Target's Score:[-1.1540523, 8.462409, -1.7661977, -1.0460924, -3.9164488, -3.3313916, -0.3163264, -2.820211, 6.3010354, -0.4246099]
Target sample: 37, Prediction:8, Target's Score:[-3.4532807, 8.386713, -2.2111213, -0.7823435, -1.8628942, -5.3185935, -1.1087705, -2.9896832, 10.8994, -1.5905669]
Target sample: 43, Prediction:1, Target's Score:[-4.4456477, 11.842053, -1.2073979, -2.4962847, -0.95501584, -3.026115, -1.2406102, -3.5148973, 4.6536884, 0.39586854]
Target sample: 49, Prediction:1, Target's Score:[-1.9223232, 9.003836, -1.6026411, -1.4655721, -3.9080513, -4.3263083, -1.1339282, -1.8283514, 8.262327, -1.0919957]
Target sample: 55, Prediction:1, Target's Score:[3.086297, 7.2343235, -2.8423796, -0.0029498935, -3.3919673, -4.081115, 0.250504, -1.2812065, 1.1836306, -0.16256706]
Target sample: 61, Prediction:1, Target's Score:[-2.0544114, 11.986232, -0.7934361, -1.9642545, -3.8433466, -4.2161684, 1.5837821, -3.1449633, -0.09920494, 2.570413]
Target sample: 67, Prediction:1, Target's Score:[-1.3431972, 13.087231, -1.9279153, -2.300814, -2.9807186, -5.0265937, -2.7011337, -2.3298142, 1.0107765, 4.539397]
Target sample: 73, Prediction:1, Target's Score:[-3.5181592, 8.532773, -0.67518425, -1.4226, -1.944905, -1.9112784, -1.7472646, -3.352773, 3.0511017, 3.0053842]
Target sample: 79, Prediction:1, Target's Score:[-4.0862823, 16.250713, -2.5871089, -2.3025532, -3.266675, -3.8374522, -0.28820434, -3.8060317, -0.20388775, 4.1553025]
Target sample: 85, Prediction:1, Target's Score:[-3.4747722, 12.994679, -1.728293, -1.5721803, -3.8677764, -4.007428, 1.6584625, -3.7751706, 3.9413784, -0.16580366]
Target sample: 91, Prediction:1, Target's Score:[-4.791639, 12.832351, -2.171658, -2.8876808, -4.1959443, -3.425401, 2.6353438, -3.4459832, 5.365449, 0.08414663]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 00:05:59 Epoch 59, Val iteration 0, acc 92.200 (92.200)
2021-06-12 00:06:06 Epoch 59, Val iteration 19, acc 92.400 (92.350)
* Prec: 92.35000190734863
Per class accuracy =  [0.93680212 0.95356939 0.82609282 0.84746613 0.95176401 0.89771644
 0.96000199 0.9412686  0.95554225 0.96229628]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 8, 8, 8, 8, 8, 1, 1, 8, 1, 1, 8, 8, 8, 1, 1, 1, 1, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
------SUMMARY POST DEFENSE------
TIME ELAPSED (mins): 11
TARGET INDEX: 15
ResNet50 0.0 0.0 95.46000137329102 92.26000099182129 100.0
DPN92 0.0 0.0 95.50000267028808 93.30000114440918 100.0
MobileNetV2 0.0 0.0 91.22000160217286 89.6100009918213 80.0
GoogLeNet 0.0 0.0 95.41000213623047 92.35000190734863 100.0
True False False False True
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.300-droplayer0.000.t7
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
No specific indices are determined, so try to include whatever we find
In total, we found 136 images of target 16
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', eval_poisons_root='', feat_reg_flag=False, gpu='1', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=16, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/16/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127, 133]
# Targets: 23, # Poisons: 5
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-12 00:06:24 Iteration 0 	 Training Loss: 8.822e-01 	 Loss in Target Net: 9.952e-01	  
 2021-06-12 00:07:02 Iteration 50 	 Training Loss: 4.043e-01 	 Loss in Target Net: 4.724e-01	  
 2021-06-12 00:07:41 Iteration 100 	 Training Loss: 3.787e-01 	 Loss in Target Net: 4.297e-01	  
 2021-06-12 00:08:18 Iteration 150 	 Training Loss: 3.681e-01 	 Loss in Target Net: 3.801e-01	  
 2021-06-12 00:08:54 Iteration 200 	 Training Loss: 3.635e-01 	 Loss in Target Net: 4.100e-01	  
 2021-06-12 00:09:29 Iteration 250 	 Training Loss: 3.622e-01 	 Loss in Target Net: 3.968e-01	  
 2021-06-12 00:10:04 Iteration 300 	 Training Loss: 3.587e-01 	 Loss in Target Net: 3.765e-01	  
 2021-06-12 00:10:40 Iteration 350 	 Training Loss: 3.596e-01 	 Loss in Target Net: 3.854e-01	  
 2021-06-12 00:11:15 Iteration 400 	 Training Loss: 3.559e-01 	 Loss in Target Net: 3.957e-01	  
 2021-06-12 00:11:50 Iteration 450 	 Training Loss: 3.565e-01 	 Loss in Target Net: 3.753e-01	  
 2021-06-12 00:12:25 Iteration 500 	 Training Loss: 3.549e-01 	 Loss in Target Net: 3.913e-01	  
 2021-06-12 00:13:00 Iteration 550 	 Training Loss: 3.527e-01 	 Loss in Target Net: 3.802e-01	  
 2021-06-12 00:13:35 Iteration 600 	 Training Loss: 3.528e-01 	 Loss in Target Net: 3.900e-01	  
 2021-06-12 00:14:11 Iteration 650 	 Training Loss: 3.553e-01 	 Loss in Target Net: 3.697e-01	  
 2021-06-12 00:14:47 Iteration 700 	 Training Loss: 3.549e-01 	 Loss in Target Net: 3.865e-01	  
 2021-06-12 00:15:23 Iteration 750 	 Training Loss: 3.487e-01 	 Loss in Target Net: 3.831e-01	  
 2021-06-12 00:16:01 Iteration 800 	 Training Loss: 3.535e-01 	 Loss in Target Net: 3.742e-01	  
 2021-06-12 00:16:37 Iteration 850 	 Training Loss: 3.572e-01 	 Loss in Target Net: 3.718e-01	  
 2021-06-12 00:17:13 Iteration 900 	 Training Loss: 3.555e-01 	 Loss in Target Net: 3.793e-01	  
 2021-06-12 00:17:49 Iteration 950 	 Training Loss: 3.498e-01 	 Loss in Target Net: 3.755e-01	  
 2021-06-12 00:18:23 Iteration 999 	 Training Loss: 3.515e-01 	 Loss in Target Net: 3.787e-01	  
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 00:18:26, Val iteration 0, acc 94.200 (94.200)
2021-06-12 00:18:32, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-12 00:18:34, Epoch 0, Iteration 7, loss 0.608 (0.807), acc 80.769 (86.800)
2021-06-12 00:19:03, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-2.0092716, 0.40162688, -1.2519636, -1.1467284, -1.6012255, -1.1043748, 12.402113, 0.08882514, -3.325153, -1.9643005]
Target sample: 7, Prediction:6, Target's Score:[-0.6776469, -0.7186373, -0.47403353, -1.4978211, -0.6681096, -1.4896204, 11.120845, 0.17300509, -3.1782484, -2.1364653]
Target sample: 13, Prediction:6, Target's Score:[-1.7553408, 1.6709172, -1.0748719, -1.0686289, -1.8144666, -1.6667674, 10.385051, 0.50544614, -1.5844358, -3.174948]
Target sample: 19, Prediction:6, Target's Score:[-1.3735125, -0.32940114, -1.2241468, -1.642383, -1.8457943, -1.7082803, 11.877987, 1.0731212, -3.5630817, -0.7807169]
Target sample: 25, Prediction:6, Target's Score:[-2.9253807, 3.3692555, -1.7833964, -1.1394485, -2.2550128, -1.2324076, 10.720848, 0.2891883, -3.0060556, -1.5973858]
Target sample: 31, Prediction:6, Target's Score:[-2.8216088, 3.7387385, -1.7475462, -2.1651373, -1.9621351, -1.3908646, 10.181294, 0.3383269, -2.0631447, -1.6854564]
Target sample: 37, Prediction:6, Target's Score:[-2.8907375, 3.0973141, -2.061597, -1.27789, -2.058068, -1.0832545, 10.173659, -0.8474394, -1.1730214, -1.4656922]
Target sample: 43, Prediction:6, Target's Score:[-2.4187806, 1.394114, -2.0184803, -1.7179732, -1.3700484, -1.6450481, 11.109796, 0.9458519, -0.8498655, -2.9753513]
Target sample: 49, Prediction:6, Target's Score:[-3.2236524, 2.5211985, -1.9870408, -1.6498443, -1.6632364, -0.67333245, 9.724366, -0.4885207, -2.5510092, 0.39782646]
Target sample: 55, Prediction:6, Target's Score:[-2.0171578, -0.38308373, -1.7450614, -1.8620439, 0.8216455, -1.1939096, 10.904345, 1.3120185, -2.3725557, -3.0197797]
Target sample: 61, Prediction:6, Target's Score:[-2.6402955, 3.248262, -2.1535969, -1.8222243, -1.5938131, -1.4055235, 10.521384, -0.62589955, -3.465622, 0.37216896]
Target sample: 67, Prediction:6, Target's Score:[-2.9000368, -0.31360078, -2.5746338, -1.4105327, 4.4893436, -0.98522586, 8.770813, 0.04333765, -2.3755212, -2.3752892]
Target sample: 73, Prediction:6, Target's Score:[-2.0713768, 1.2168813, -0.58734596, -0.7991858, -0.63247806, -1.2341073, 8.89615, -0.23114896, -0.7110688, -3.483857]
Target sample: 79, Prediction:6, Target's Score:[-1.6012832, 0.8041649, -1.5595537, -1.7636309, -1.1487899, -1.5861574, 9.75628, -0.46375775, -3.880505, 1.8509643]
Target sample: 85, Prediction:6, Target's Score:[-2.077144, 5.2016106, -2.0385206, -2.2045355, -2.1783226, -1.9594072, 10.029105, 0.18885106, -2.5582473, -1.974809]
Target sample: 91, Prediction:6, Target's Score:[-3.1358724, 5.467919, -2.2869012, -1.9098927, -2.6352553, -1.8171678, 9.544851, 0.33003587, -2.4504368, -0.6973847]
Target sample: 97, Prediction:6, Target's Score:[-1.3646839, 1.4671186, -1.4316294, -1.7314328, -2.391571, -1.806277, 8.868118, -0.72309357, -2.4938, 1.9920541]
Target sample: 103, Prediction:6, Target's Score:[-3.6707752, 3.3134391, -2.4472628, -1.753539, -2.5680847, -1.3926679, 8.094229, -1.5160227, -2.2946746, 4.600789]
Target sample: 109, Prediction:6, Target's Score:[-2.9085643, 1.2174734, -1.8026047, -1.3873501, -1.3874056, -1.0961587, 11.14147, -0.41077462, -2.945054, 0.022953816]
Target sample: 115, Prediction:6, Target's Score:[-3.1689675, 6.5038447, -2.7451835, -2.4350142, -2.9343743, -1.8646408, 9.013727, 0.99079335, -3.5487819, 0.59720033]
Target sample: 121, Prediction:6, Target's Score:[-3.0983317, 2.0858762, -1.5672672, -0.6894982, -2.1095607, -0.5859501, 10.645856, -0.5284253, -3.307045, -0.4194524]
Target sample: 127, Prediction:6, Target's Score:[-2.68032, 0.038928393, -1.6381544, -1.9889929, -1.0699658, -1.0317566, 12.248859, -0.012395835, -3.9162052, 0.536138]
Target sample: 133, Prediction:6, Target's Score:[-0.5231067, -0.48440573, -0.50538236, -1.4320875, -1.1728379, -1.6745961, 11.409881, 0.7568333, -2.9907837, -2.9169834]
Current ATTACK acc on target samples: 100.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 00:19:30 Epoch 59, Val iteration 0, acc 89.600 (89.600)
2021-06-12 00:19:36 Epoch 59, Val iteration 19, acc 90.600 (90.060)
* Prec: 90.06000099182128
Per class accuracy =  [0.94587409 0.92459394 0.80189821 0.75090711 0.90614454 0.90153551
 0.972379   0.91194316 0.93021955 0.96097943]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 100.0
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 00:19:43, Val iteration 0, acc 94.800 (94.800)
2021-06-12 00:19:55, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-12 00:20:02, Epoch 0, Iteration 7, loss 0.119 (0.422), acc 96.154 (89.800)
2021-06-12 00:21:28, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[0.15282013, 7.873023, -2.8983843, -3.771087, -1.958967, -1.1969784, 7.8171864, -3.899464, -0.70323896, -0.83272684]
Target sample: 7, Prediction:6, Target's Score:[0.20382899, 3.4719095, -1.5900726, -2.9521348, -1.0033957, -1.0720336, 11.071259, -3.7199247, -0.42417473, -3.4731317]
Target sample: 13, Prediction:6, Target's Score:[1.2917738, 2.448329, -1.4118409, -3.0139606, -1.0939244, -2.0196295, 11.059712, -3.596437, -0.07212982, -3.0952663]
Target sample: 19, Prediction:6, Target's Score:[3.7915542, 2.0683787, -1.8958048, -3.7594619, -1.5185791, -2.6687262, 11.468691, -4.083071, -1.2417998, -1.5779942]
Target sample: 25, Prediction:6, Target's Score:[2.3171172, 6.122722, -2.4264846, -4.0110793, -1.6511147, -2.201657, 9.808212, -3.8249278, -1.5156571, -1.9937191]
Target sample: 31, Prediction:6, Target's Score:[0.56515235, 5.608005, -2.360822, -2.9552715, -1.6267074, -1.3743075, 7.9638424, -3.590786, 0.7500447, -2.4546127]
Target sample: 37, Prediction:1, Target's Score:[-0.5112093, 5.2034726, -3.5110123, -1.7864847, -2.0489593, -1.3689227, 4.60182, -3.3801696, 3.8456721, -0.59474725]
Target sample: 43, Prediction:8, Target's Score:[0.2590919, 0.7980384, -2.3151786, -1.9610835, -0.9684871, -2.2038672, 5.475536, -2.7179296, 6.4974604, -2.476777]
Target sample: 49, Prediction:6, Target's Score:[0.32352045, 3.5490742, -2.615431, -2.3910327, -1.7822429, -1.0307378, 7.7466183, -3.7608345, 2.1289375, -1.6980174]
Target sample: 55, Prediction:6, Target's Score:[1.0312718, -0.8217918, -2.558748, -1.3414243, 2.4290826, -3.056492, 6.527582, -1.8571036, 2.0161726, -1.9847687]
Target sample: 61, Prediction:1, Target's Score:[-0.21250565, 5.9823046, -2.8872013, -2.2157035, 0.8295631, -3.3815875, 1.8092803, -3.6635764, 1.0512545, 3.171846]
Target sample: 67, Prediction:6, Target's Score:[0.67213404, -0.4841652, -2.5736217, -1.261191, 0.6138181, -2.2947369, 6.0024033, -2.4567215, 3.4256938, -1.2803459]
Target sample: 73, Prediction:6, Target's Score:[4.782091, -0.6126972, -0.9569096, -2.4550254, 1.4593412, -4.0951247, 6.790872, -3.037285, 1.1031481, -2.5126696]
Target sample: 79, Prediction:6, Target's Score:[0.6316147, 4.597128, -2.8108377, -3.109034, 0.89513046, -3.644226, 5.665265, -4.597569, -1.0909514, 4.0088067]
Target sample: 85, Prediction:1, Target's Score:[0.96546435, 8.585811, -3.1760852, -3.6633835, -1.1142553, -2.4492447, 5.411762, -3.8116734, 0.57699573, -0.75239927]
Target sample: 91, Prediction:1, Target's Score:[0.8638046, 6.4204903, -3.4049358, -2.7896008, -1.7253498, -2.434467, 5.4364233, -2.9349413, 2.4379568, -1.3593006]
Target sample: 97, Prediction:6, Target's Score:[2.5460007, 3.9136431, -3.1168797, -2.8422348, -1.9723569, -2.709044, 6.5768743, -3.4601367, 2.6524038, -1.0879817]
Target sample: 103, Prediction:8, Target's Score:[-0.91254276, 4.9494905, -3.4389272, -1.6135535, -2.4932816, -1.897691, 1.9971005, -3.324642, 6.994899, 0.19125721]
Target sample: 109, Prediction:1, Target's Score:[-0.6957674, 7.311841, -3.0748184, -2.5376103, -2.214451, -1.6306471, 3.4793992, -3.2965348, 3.1086118, 0.039897904]
Target sample: 115, Prediction:1, Target's Score:[-0.37312612, 10.553927, -3.3811362, -3.5235677, -2.6028202, -1.6993039, 3.9703524, -3.578994, 0.5801223, 0.640632]
Target sample: 121, Prediction:1, Target's Score:[1.4430547, 6.9747987, -3.2679892, -3.0614517, -1.9827418, -2.2310286, 5.4013386, -3.4193401, -0.69545066, 1.381037]
Target sample: 127, Prediction:6, Target's Score:[0.75130045, 4.168571, -2.2849095, -3.8359418, -1.8257934, -0.89086354, 9.595687, -3.7724736, -1.0943568, -0.28513896]
Target sample: 133, Prediction:6, Target's Score:[0.92102015, 2.022102, -1.0063192, -2.8653214, -1.207216, -1.0631031, 13.354812, -3.9089139, -1.6335609, -4.0636177]
Current ATTACK acc on target samples: 56.522
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 00:22:52 Epoch 59, Val iteration 0, acc 93.000 (93.000)
2021-06-12 00:23:04 Epoch 59, Val iteration 19, acc 92.600 (93.280)
* Prec: 93.28000106811524
Per class accuracy =  [0.94787995 0.97236954 0.87964226 0.86939593 0.95727337 0.88330607
 0.95082025 0.94411168 0.96976415 0.95365661]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 6, 6, 6, 6, 1, 8, 8, 6, 8, 6, 6, 6, 1, 6, 6, 1, 6, 6, 6, 6, 1, 1, 1, 6, 1, 6, 4, 0, 6, 4, 6, 6, 6, 6, 6, 8, 8, 6, 4, 4, 6, 6, 6, 1, 1, 6, 6, 6, 1, 1, 1, 1, 6, 1, 6, 6, 6, 1, 1, 6, 8, 6, 1, 8, 6, 6, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 62.83185840707964
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 00:23:07, Val iteration 0, acc 92.600 (92.600)
2021-06-12 00:23:10, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-12 00:23:11, Epoch 0, Iteration 7, loss 0.183 (0.328), acc 90.385 (89.800)
2021-06-12 00:23:27, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[2.5552242, 5.177224, -3.6151607, 1.3695351, -2.6442974, -2.3341773, 1.2268056, -3.7829638, 0.2310759, 2.1672204]
Target sample: 7, Prediction:6, Target's Score:[3.6610124, 4.8235426, -2.0474195, 3.7111373, -5.448329, -3.0707326, 5.1446514, -5.286443, 0.45419624, -1.5923711]
Target sample: 13, Prediction:6, Target's Score:[1.1170257, 3.369949, -2.610043, 2.3532596, -4.3341317, -2.9548368, 5.8760223, -5.6503158, 1.86454, 1.330062]
Target sample: 19, Prediction:0, Target's Score:[4.9832377, 0.79665685, -3.3600929, 3.5412412, -1.4126122, -3.0396392, 1.2268748, -4.0092525, -2.2166762, 3.846326]
Target sample: 25, Prediction:1, Target's Score:[4.3699937, 7.047489, -4.709307, 3.1093473, -3.2035155, -2.5939372, -0.01919803, -4.0629272, -0.1442018, 0.5738493]
Target sample: 31, Prediction:3, Target's Score:[0.8239575, 1.7422054, -2.6301003, 5.7349277, -3.1342201, -3.5982022, 2.714767, -4.720434, 3.7997859, -0.36933085]
Target sample: 37, Prediction:3, Target's Score:[-0.29709885, 0.5626175, -4.078311, 5.2201962, -2.1741614, -3.645468, 1.5765406, -4.214231, 5.1088657, 2.3157961]
Target sample: 43, Prediction:3, Target's Score:[0.05067522, -0.4427817, -0.89737123, 5.1219416, -1.6439459, -3.1732833, 1.5367408, -3.129353, 4.053989, -1.1413591]
Target sample: 49, Prediction:3, Target's Score:[2.1980045, 4.323648, -2.295425, 4.707956, -0.74989927, -3.1872199, 0.16540012, -5.3148365, 2.1380885, -1.6067451]
Target sample: 55, Prediction:3, Target's Score:[1.7071803, -1.7504295, 0.32963505, 7.9259033, -1.9857278, -1.8222648, 1.9945819, -4.9538293, 1.7018613, -2.8197422]
Target sample: 61, Prediction:9, Target's Score:[1.4288654, 3.4723954, -3.239232, 1.7499585, -3.500772, -2.9269907, 3.4583595, -4.4312677, -2.9156165, 7.256587]
Target sample: 67, Prediction:8, Target's Score:[1.5701032, -1.7530077, -1.4596475, 1.2504469, 0.14757934, -4.5685472, 1.9218061, -1.2829396, 4.36855, 0.12712581]
Target sample: 73, Prediction:8, Target's Score:[3.0528066, 1.0688616, 0.92498076, 2.8898416, 0.2752764, -4.6573086, -1.1723173, -3.9191625, 5.0947604, -3.2417533]
Target sample: 79, Prediction:9, Target's Score:[1.3619628, 5.1020703, -5.239866, 2.7944722, -2.4403644, -1.5014441, 1.2755013, -4.8373766, -1.9717565, 5.8440404]
Target sample: 85, Prediction:1, Target's Score:[4.255971, 5.6920614, -4.5398264, 1.7189423, -1.2754697, -2.5874212, -0.2657312, -3.0751872, 2.1131597, -1.698876]
Target sample: 91, Prediction:1, Target's Score:[0.73467654, 9.773989, -5.666453, 3.2898726, -3.86967, -2.947666, 0.6436449, -3.3720229, 0.7109574, 1.1263256]
Target sample: 97, Prediction:3, Target's Score:[0.72669655, -1.6836603, -0.62364084, 4.2827787, -1.8584836, -3.8953478, 0.3874121, -3.252701, 3.7616863, 2.498763]
Target sample: 103, Prediction:9, Target's Score:[-1.660667, 2.5310223, -4.985081, 3.3926806, -1.645539, -2.0275857, 2.2082655, -4.880046, 3.2464583, 4.2011323]
Target sample: 109, Prediction:3, Target's Score:[1.0452125, 2.6036506, -2.8804061, 5.448212, -3.374868, -2.3180292, 2.9016542, -4.7827806, 1.0820895, 0.63269305]
Target sample: 115, Prediction:1, Target's Score:[3.8748136, 7.1455226, -2.8440392, 2.813508, -4.5837665, -3.0556219, -0.6092795, -2.1741133, 0.50392354, -0.6977687]
Target sample: 121, Prediction:3, Target's Score:[3.2674146, 2.6164749, -4.734535, 4.168342, -3.6037936, -2.2254004, 0.54157746, -2.1658297, 0.4539329, 2.0141437]
Target sample: 127, Prediction:6, Target's Score:[0.7961367, 3.859373, -3.5035558, 3.6521883, -5.3738947, -2.5091612, 4.8968406, -4.5004086, -0.16810632, 3.2128937]
Target sample: 133, Prediction:3, Target's Score:[1.4162937, 3.3950176, -2.6055045, 5.590787, -5.237469, -2.591043, 5.4736543, -4.801321, -0.34288862, 0.06606513]
Current ATTACK acc on target samples: 13.043
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 00:23:42 Epoch 59, Val iteration 0, acc 89.600 (89.600)
2021-06-12 00:23:45 Epoch 59, Val iteration 19, acc 90.600 (89.630)
* Prec: 89.63000106811523
Per class accuracy =  [0.92792518 0.92842989 0.84103772 0.82948437 0.89331597 0.83106944
 0.93427694 0.89434201 0.92621069 0.9506333 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 3, 1, 1, 1, 3, 1, 3, 6, 1, 1, 1, 6, 1, 1, 3, 1, 3, 6, 3, 3, 1, 3, 8, 8, 3, 3, 3, 1, 3, 3, 8, 9, 1, 9, 3, 3, 3, 1, 3, 3, 1, 1, 1, 3, 3, 3, 4, 3, 1, 0, 0, 9, 3, 8, 8, 8, 8, 3, 8, 3, 8, 8, 8, 3, 4, 3, 3, 3, 3, 1, 3, 3, 1, 1, 1, 1, 1, 8, 1, 3, 3, 9, 4, 3, 9, 3, 9, 8, 3, 3, 3, 3, 1, 3, 1, 1, 1, 3, 3, 0, 8, 6, 1, 3, 3, 3, 6, 6, 6, 3, 0, 6, 6
ATTACK acc: 7.964601769911504
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 00:23:49, Val iteration 0, acc 96.200 (96.200)
2021-06-12 00:23:56, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-12 00:23:59, Epoch 0, Iteration 7, loss 0.808 (0.873), acc 78.846 (77.200)
2021-06-12 00:24:31, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[0.42082033, 1.7549055, -2.7491078, 1.3124938, -0.7897514, -3.0595539, 8.850007, -3.2792232, -0.45649955, -1.9663898]
Target sample: 7, Prediction:6, Target's Score:[0.2365018, -0.37099493, -1.4691713, 0.39698154, -2.1096134, -2.6279202, 10.732863, -2.8915477, 0.64876956, -2.5100436]
Target sample: 13, Prediction:6, Target's Score:[-2.295273, 3.2928689, -2.893511, -0.69146526, -3.1164665, -3.2922807, 11.7445965, -4.139472, 4.471765, -3.0811572]
Target sample: 19, Prediction:6, Target's Score:[-0.18245031, 1.4476138, -2.6328957, 0.3024737, -3.313874, -2.1262538, 10.321154, -3.7670348, 2.4289358, -2.4538283]
Target sample: 25, Prediction:6, Target's Score:[2.1971302, 1.4590105, -2.2953634, -0.68964857, -2.5995176, -2.7400582, 7.4718103, -3.669801, 3.096824, -2.2049031]
Target sample: 31, Prediction:6, Target's Score:[0.18775292, 2.0794847, -2.8877354, -0.8822454, -3.4079268, -2.2074907, 6.198872, -4.5965495, 4.7907453, 0.7287082]
Target sample: 37, Prediction:6, Target's Score:[-0.4322718, 4.0165195, -3.7321708, -1.3344402, -3.0438063, -3.0060887, 6.450576, -4.388041, 4.383734, 1.0893682]
Target sample: 43, Prediction:6, Target's Score:[-0.42992255, 3.0925539, -2.1094036, -1.2072233, -2.170187, -3.5418515, 8.170116, -3.4664483, 3.9817517, -2.3161378]
Target sample: 49, Prediction:6, Target's Score:[-0.2119797, 1.7301432, -3.6873152, -0.8543488, -2.7531736, -1.2397462, 7.818996, -4.4060717, 2.82913, 0.787474]
Target sample: 55, Prediction:6, Target's Score:[2.818703, -0.47103456, -2.1307108, -0.88509315, 0.79854906, -3.2069676, 8.36449, -2.1158466, 0.3796713, -3.5154586]
Target sample: 61, Prediction:9, Target's Score:[-0.30407175, 1.6256567, -2.0585198, -2.5819411, -1.3520374, -2.1369767, 4.685596, -5.1980577, -1.8441899, 9.192889]
Target sample: 67, Prediction:6, Target's Score:[0.3651286, 0.49868292, -2.081145, 0.84373826, 0.85202324, -3.233095, 6.4314027, -3.1340642, 1.718198, -2.2449777]
Target sample: 73, Prediction:6, Target's Score:[-0.037122943, 3.800658, -2.481945, -0.25787207, -1.8048704, -4.398751, 7.9448295, -4.1383653, 4.3065553, -2.929309]
Target sample: 79, Prediction:9, Target's Score:[0.20495357, 3.0094721, -3.7892988, -3.592473, -3.1648772, -3.4574997, 6.7216687, -5.526331, -1.391309, 11.022132]
Target sample: 85, Prediction:6, Target's Score:[0.9727925, 2.3268535, -2.6469903, -1.594103, -2.9057133, -2.464537, 8.235956, -3.067583, 3.930899, -2.781052]
Target sample: 91, Prediction:6, Target's Score:[0.2110991, 3.1164448, -2.6056025, -0.72111195, -2.7331464, -3.9873521, 7.294723, -3.5246532, 2.5487497, 0.4202832]
Target sample: 97, Prediction:6, Target's Score:[-0.06914327, 0.02720682, -2.2922637, -1.7644985, -2.6934876, -3.444632, 8.528878, -4.1163836, 7.4423485, -1.6241931]
Target sample: 103, Prediction:6, Target's Score:[-2.521646, 5.635172, -4.3188195, -3.2286139, -4.5078654, -3.2662578, 8.8856325, -4.167904, 7.1759577, 0.29070407]
Target sample: 109, Prediction:6, Target's Score:[-0.43913025, 3.2679803, -3.299194, -0.9920377, -3.1534977, -2.0912952, 7.300483, -4.444087, 5.3159356, -1.470412]
Target sample: 115, Prediction:6, Target's Score:[-1.3570421, 5.499704, -3.6495535, -0.74841696, -4.1919537, -1.80508, 7.223294, -3.6537962, 1.9976584, 0.69113404]
Target sample: 121, Prediction:1, Target's Score:[2.2348323, 6.626584, -1.9881186, -0.012982404, -2.953168, -2.9194992, 4.3526707, -3.893648, -0.3630034, -1.0604244]
Target sample: 127, Prediction:6, Target's Score:[-1.5171219, 0.09927897, -2.5321412, -0.31399918, -2.96963, -2.2620618, 10.615274, -3.5354278, 1.8027221, 0.63788706]
Target sample: 133, Prediction:6, Target's Score:[-1.5104065, -0.43681958, 0.957975, 0.82884324, -2.1403832, -2.8944407, 8.839825, -2.789716, 1.2725543, -2.1070952]
Current ATTACK acc on target samples: 86.957
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 00:25:03 Epoch 59, Val iteration 0, acc 93.400 (93.400)
2021-06-12 00:25:10 Epoch 59, Val iteration 19, acc 91.000 (91.730)
* Prec: 91.73000144958496
Per class accuracy =  [0.94533544 0.94495247 0.88495283 0.77347624 0.95778776 0.88933651
 0.94693839 0.93340519 0.93381893 0.96093518]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 8, 6, 6, 6, 6, 6, 6, 8, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 8, 6, 8, 8, 6, 6, 8, 6, 6, 6, 6, 1, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 87.61061946902655
--------
------SUMMARY PRE DEFENSE------
TIME ELAPSED (mins): 12
TARGET INDEX: 16
ResNet50 100.0 100.0 95.46000137329102 90.06000099182128
DPN92 56.52173913043478 62.83185840707964 95.50000267028808 93.28000106811524
MobileNetV2 13.043478260869565 7.964601769911504 91.22000160217286 89.63000106811523
GoogLeNet 86.95652173913044 87.61061946902655 95.41000213623047 91.73000144958496
DEFENSE EVALUATION
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
ResNet50
[74, 80, 86, 89] 4
Using Adam for retraining
2000
poison index =  84
499
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 00:25:14, Val iteration 0, acc 94.200 (94.200)
2021-06-12 00:25:20, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-12 00:25:21, Epoch 0, Iteration 7, loss 0.391 (0.225), acc 86.538 (95.000)
2021-06-12 00:25:49, Epoch 30, Iteration 7, loss 0.001 (0.022), acc 100.000 (99.400)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6]
Target sample: 1, Prediction:1, Target's Score:[1.1128296, 7.066559, -2.8635254, -0.3529544, -2.958567, -1.0499302, -1.457866, -2.634025, 0.017885942, 3.3176744]
Target sample: 7, Prediction:1, Target's Score:[2.6806688, 5.332874, -2.4291961, 0.43495, -2.3207803, -2.5470593, -1.060071, -2.0515594, 1.9159021, 0.25672626]
Target sample: 13, Prediction:1, Target's Score:[1.6334823, 7.4407134, -2.465613, -0.736501, -2.6020427, -2.0833914, -1.1572794, -2.3895764, 2.3566866, 0.18900235]
Target sample: 19, Prediction:1, Target's Score:[2.3323076, 6.2811346, -2.391322, -1.1189189, -2.739783, -2.5739872, -1.6684619, -2.4678366, 0.9952734, 3.5460384]
Target sample: 25, Prediction:1, Target's Score:[1.6042409, 6.9401236, -2.1348538, -1.40524, -2.438916, -2.266971, -1.1113844, -2.3648465, 1.3458657, 2.0043857]
Target sample: 31, Prediction:1, Target's Score:[2.1251373, 6.4564967, -1.9980233, -1.6547228, -2.2573178, -2.3344755, -1.5064224, -2.532057, 3.5668762, 0.31140292]
Target sample: 37, Prediction:8, Target's Score:[1.2770934, 2.0207133, -2.0007966, -1.2391015, -1.9298922, -1.7907827, -1.257803, -2.33357, 7.581569, -0.13807526]
Target sample: 43, Prediction:8, Target's Score:[0.7529014, 0.7641134, -2.180683, -0.5316381, -2.043912, -1.743909, -0.5684836, -1.9479034, 8.51416, -0.80674833]
Target sample: 49, Prediction:8, Target's Score:[0.9669767, 4.413987, -2.502442, -1.2534802, -2.5281427, -0.41669953, -1.765476, -2.852517, 4.9196744, 1.2368331]
Target sample: 55, Prediction:8, Target's Score:[1.5320995, 1.9579127, -2.1575134, -0.7420995, -1.7145265, -1.9180297, -0.7538474, -1.655823, 6.0265985, -0.4037707]
Target sample: 61, Prediction:1, Target's Score:[-0.19614877, 8.925711, -2.56122, -1.0255723, -2.8399484, -2.1913538, -0.78578395, -2.8699348, 0.22609895, 3.5341032]
Target sample: 67, Prediction:8, Target's Score:[1.0628582, 0.8655623, -2.1892216, -0.66766113, -0.93726724, -1.9281156, -1.0604095, -1.742727, 8.036144, -1.2337381]
Target sample: 73, Prediction:8, Target's Score:[1.8747672, 1.9064181, -1.9736345, -0.96431327, -1.2842442, -2.096788, -1.1233423, -1.9289023, 7.3984537, -1.6181414]
Target sample: 79, Prediction:1, Target's Score:[1.4858489, 5.0975842, -2.1180332, -1.3364105, -2.6822586, -2.362673, -1.7954977, -2.6436214, 1.8613183, 4.697235]
Target sample: 85, Prediction:1, Target's Score:[4.5361476, 5.5665913, -2.0931377, -1.5565659, -2.402125, -2.399408, -2.015406, -2.150414, 1.1190944, 1.5647017]
Target sample: 91, Prediction:1, Target's Score:[1.5751368, 5.0368667, -2.3829765, -1.4331834, -2.279698, -2.2687464, -1.075723, -2.2683353, 4.838429, 0.43454522]
Target sample: 97, Prediction:8, Target's Score:[1.5994359, 2.2635195, -1.8888214, -1.4153453, -2.130842, -1.9993834, -1.5934558, -2.4400132, 5.4736967, 2.3190248]
Target sample: 103, Prediction:1, Target's Score:[0.64298296, 4.018272, -2.485575, -0.90972036, -2.7031221, -1.6744386, -1.2318796, -2.700793, 3.971194, 3.2784824]
Target sample: 109, Prediction:8, Target's Score:[0.7751648, 3.599254, -2.3560286, -0.8964043, -2.5958054, -1.0266132, -1.4799504, -2.6525598, 4.2341995, 2.602619]
Target sample: 115, Prediction:1, Target's Score:[0.7658822, 9.499048, -2.6976216, -1.7758172, -3.063933, -2.6786976, -1.0626786, -2.6535296, 1.8270593, 2.0358274]
Target sample: 121, Prediction:1, Target's Score:[-0.12116887, 6.916269, -2.273845, -1.4514794, -2.8333657, -2.064229, -1.202387, -2.5499082, 0.19771272, 5.5720754]
Target sample: 127, Prediction:9, Target's Score:[0.2697558, 4.882673, -2.3759463, -0.77542895, -2.8801982, -0.09959228, -1.3830214, -2.8279626, -1.1549221, 6.5615206]
Target sample: 133, Prediction:8, Target's Score:[2.873467, 3.2763546, -2.0641205, 0.4340087, -2.0435627, -2.8070283, -1.1534395, -1.765673, 4.6639667, -1.2063076]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 00:26:17 Epoch 59, Val iteration 0, acc 89.800 (89.800)
2021-06-12 00:26:22 Epoch 59, Val iteration 19, acc 92.400 (90.070)
* Prec: 90.07000122070312
Per class accuracy =  [0.88458252 0.91680107 0.86007549 0.83256181 0.84627973 0.87697971
 0.93105472 0.93582473 0.96506934 0.95831626]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 8, 1, 1, 8, 8, 1, 8, 1, 8, 8, 8, 1, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 0, 1, 8, 8, 1, 1, 1, 8, 1, 8, 8, 8, 9, 1, 8, 8, 8, 8, 8, 8, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 0, 1, 8
ATTACK acc: 0.0
DPN92
[74, 80, 86, 89] 27
Using Adam for retraining
2000
poison index =  84
499
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 00:26:26, Val iteration 0, acc 94.800 (94.800)
2021-06-12 00:26:38, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-12 00:26:40, Epoch 0, Iteration 7, loss 0.120 (0.274), acc 98.077 (93.200)
2021-06-12 00:28:06, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6]
Target sample: 1, Prediction:6, Target's Score:[3.2069163, 1.8606029, -3.2594, -2.7120192, -2.2848623, -2.5678067, 5.3343716, -1.1196766, 3.9269238, -1.8326955]
Target sample: 7, Prediction:8, Target's Score:[2.9316754, 2.2444096, -1.307081, -1.0516241, -2.0596595, -3.4463093, 2.6672862, -1.957206, 5.854412, -3.343125]
Target sample: 13, Prediction:8, Target's Score:[4.1858454, 1.3587143, -1.5133141, -2.43362, -2.5145931, -3.5799646, 2.8596761, -1.1536478, 5.3483124, -2.0105717]
Target sample: 19, Prediction:0, Target's Score:[11.236807, -0.39389306, -2.3162522, -2.741508, -0.60891813, -2.9419668, -0.6539519, -1.5988586, 1.4632677, -0.7715391]
Target sample: 25, Prediction:1, Target's Score:[3.7694142, 10.282962, -3.8970103, -3.9176009, -2.030877, -2.6211755, -0.00229908, -1.3722377, 0.14685367, 0.27680972]
Target sample: 31, Prediction:1, Target's Score:[2.724628, 7.8233967, -3.2428794, -3.3429906, -2.051895, -2.7936199, 0.96877325, -2.1122448, 3.9506943, -1.3408291]
Target sample: 37, Prediction:8, Target's Score:[2.4943705, 1.9831188, -3.5752776, -2.3210118, -2.379892, -3.4590635, 0.22134937, -2.2896376, 9.843054, 0.08287752]
Target sample: 43, Prediction:8, Target's Score:[1.6569462, 1.0824283, -2.604276, -1.5959187, -2.8609133, -4.1036377, 0.9600966, -1.3066807, 10.650562, -1.2860978]
Target sample: 49, Prediction:8, Target's Score:[2.8979738, 2.721122, -3.609174, -1.7872876, -3.2469697, -3.456125, 0.607343, -2.2188263, 8.278896, 0.4328443]
Target sample: 55, Prediction:8, Target's Score:[5.395813, 0.4958609, -1.8438393, -1.4905614, -0.17894082, -3.896765, -0.35361236, -1.370177, 5.7911973, -2.0027163]
Target sample: 61, Prediction:8, Target's Score:[3.5807154, 1.8921107, -3.197223, -2.0083652, -1.242667, -2.4617834, -0.89356303, -2.1780813, 6.429818, 0.63421756]
Target sample: 67, Prediction:8, Target's Score:[3.6182177, -0.3374126, -1.9324076, -1.1270897, -1.4771897, -4.002098, -0.2903569, -2.1762784, 8.961214, -0.6536689]
Target sample: 73, Prediction:0, Target's Score:[7.7411833, 0.29399964, -1.5440607, -1.2608495, 0.12568948, -3.742026, -1.1512032, -2.7143054, 4.745072, -1.886568]
Target sample: 79, Prediction:0, Target's Score:[4.1353483, 0.6513322, -3.618273, -3.1707585, 1.6429166, -3.4875808, 0.99871016, -2.6657567, 2.8406131, 3.2858312]
Target sample: 85, Prediction:1, Target's Score:[7.0708437, 7.3350115, -3.5486546, -3.6136916, -0.87436765, -2.4299896, -1.6317768, -2.0742867, 0.95052737, -0.53419316]
Target sample: 91, Prediction:8, Target's Score:[4.884159, 4.8741555, -3.5438082, -2.540902, -1.7700467, -3.3288956, -0.39947966, -1.9328188, 5.499188, -1.1404152]
Target sample: 97, Prediction:8, Target's Score:[5.3843665, 0.9352778, -3.1000264, -2.609467, -2.3751254, -4.0703797, 0.48915008, -2.1718707, 8.766004, -0.60172844]
Target sample: 103, Prediction:8, Target's Score:[0.012763736, 2.1816337, -3.6030958, -2.1296651, -3.464624, -4.2908483, 0.4447643, -2.2246268, 10.472649, 3.2618086]
Target sample: 109, Prediction:8, Target's Score:[4.4736238, 4.0856028, -2.8121061, -2.803804, -2.4256325, -2.9600756, -0.78034973, -2.1953132, 5.2840743, 0.71218044]
Target sample: 115, Prediction:1, Target's Score:[0.58383846, 11.887756, -3.633895, -3.5725174, -2.0561976, -2.8175497, -0.8790325, -2.5696232, 1.5528667, 2.0878408]
Target sample: 121, Prediction:1, Target's Score:[4.6100802, 5.171367, -3.1258423, -3.1070118, -1.5190074, -2.4584243, -0.5853885, -1.5548997, 2.6169338, 0.49624792]
Target sample: 127, Prediction:6, Target's Score:[2.5344265, -0.5035451, -2.9623764, -3.2315745, -1.4197694, -2.4857488, 5.378275, -1.3137603, 4.4280524, 0.11617479]
Target sample: 133, Prediction:6, Target's Score:[1.439609, 3.0501368, -1.3547913, -1.0589004, -2.4849782, -2.5873296, 5.173304, -1.2384453, 3.1627464, -3.6169913]
Current ATTACK acc on target samples: 13.043
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 00:29:30 Epoch 59, Val iteration 0, acc 92.000 (92.000)
2021-06-12 00:29:41 Epoch 59, Val iteration 19, acc 92.200 (92.760)
* Prec: 92.76000175476074
Per class accuracy =  [0.92385123 0.93812183 0.90832591 0.86118924 0.94542853 0.89855064
 0.95827844 0.94011763 0.96945713 0.93243397]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 8, 6, 8, 8, 8, 8, 8, 8, 8, 8, 6, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 8, 8, 8, 8, 8, 8, 8, 8, 8, 1, 8, 8, 8, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 8, 8, 8, 4, 0, 8, 8, 0, 0, 8, 8, 8, 4, 4, 4, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 8, 8, 0, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 0, 8, 1, 0, 1, 1, 1, 8, 1, 1, 8, 0, 0, 8, 6, 6, 6, 6, 6, 8, 8, 8, 8
ATTACK acc: 7.079646017699115
MobileNetV2
[80, 86, 89] 46
Using Adam for retraining
2000
poison index =  74
poison index =  84
498
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 00:29:45, Val iteration 0, acc 92.600 (92.600)
2021-06-12 00:29:48, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-12 00:29:48, Epoch 0, Iteration 7, loss 0.267 (0.286), acc 92.308 (91.000)
2021-06-12 00:30:03, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6]
Target sample: 1, Prediction:1, Target's Score:[1.9671844, 6.4753537, -3.7425554, 1.2699379, -2.7087097, -2.8180401, -0.34102568, -3.3524303, 0.99280816, 2.7790623]
Target sample: 7, Prediction:1, Target's Score:[3.3447094, 6.0634823, -2.8122451, 4.0781293, -5.6410956, -3.3655508, 3.3823528, -5.0157385, 1.9327203, -1.4329774]
Target sample: 13, Prediction:1, Target's Score:[1.4540324, 4.6588826, -2.8779354, 2.5095983, -4.360568, -3.5263972, 3.6805365, -5.2787075, 2.7757807, 1.5067791]
Target sample: 19, Prediction:0, Target's Score:[5.017106, 2.1865513, -3.6198535, 2.7994618, -1.6688887, -3.251353, -0.08601866, -3.853232, -1.9609383, 4.9597096]
Target sample: 25, Prediction:1, Target's Score:[5.071455, 8.401382, -4.410214, 2.6914499, -3.441071, -3.2986426, -2.1504495, -3.841681, 1.1384121, 0.40132922]
Target sample: 31, Prediction:3, Target's Score:[1.3165035, 2.671371, -2.937181, 5.5096292, -3.2345998, -3.869691, 0.58844924, -4.384745, 5.2413306, -0.37790346]
Target sample: 37, Prediction:8, Target's Score:[0.10965798, 0.74009144, -4.4026647, 5.1429152, -2.1976137, -3.7639647, -0.1625746, -3.882502, 6.6499453, 2.2909214]
Target sample: 43, Prediction:8, Target's Score:[-0.3244094, 0.016322643, -1.8474156, 4.926317, -1.7090595, -3.4867833, 0.26930317, -2.427648, 5.858745, -0.8083733]
Target sample: 49, Prediction:1, Target's Score:[1.9606774, 5.042321, -2.5813904, 4.551788, -0.788943, -3.4269648, -1.4981893, -4.760076, 3.2844121, -1.223213]
Target sample: 55, Prediction:3, Target's Score:[1.8335993, -1.5450299, 0.0035025254, 8.189301, -2.313385, -1.9298257, 0.121571384, -4.544535, 2.9200516, -2.2680144]
Target sample: 61, Prediction:9, Target's Score:[1.4627626, 4.1737666, -3.3989875, 1.7208302, -3.4485965, -3.209138, 1.7741494, -4.2548447, -2.2385902, 7.932277]
Target sample: 67, Prediction:8, Target's Score:[1.7123044, -0.98777336, -1.5340544, 0.96198666, -0.47541, -4.599756, 0.45793697, -1.2019923, 5.350652, 0.75087]
Target sample: 73, Prediction:8, Target's Score:[3.2741413, 0.94847196, 0.914321, 3.0840616, -0.34327444, -4.687277, -2.3155632, -3.7175841, 5.6257796, -2.3193147]
Target sample: 79, Prediction:9, Target's Score:[1.3444138, 5.708822, -5.214028, 2.6021352, -2.1145422, -1.8180331, -0.22802621, -4.5837226, -1.3845218, 6.252735]
Target sample: 85, Prediction:1, Target's Score:[4.336576, 6.7821636, -4.2903614, 1.9537491, -1.9734759, -3.1767843, -1.9749088, -3.0414946, 3.4931602, -1.59226]
Target sample: 91, Prediction:1, Target's Score:[1.0966489, 10.3567095, -5.925017, 3.2540507, -4.156815, -3.516203, -1.159529, -3.3466341, 2.4380078, 1.5679417]
Target sample: 97, Prediction:8, Target's Score:[0.89078027, -1.4793509, -1.2552929, 4.4801292, -1.7754793, -4.0998526, -1.2588542, -2.612957, 5.4671974, 2.1203098]
Target sample: 103, Prediction:8, Target's Score:[-1.4541577, 2.7769136, -5.244415, 3.6275766, -1.8688738, -2.3922389, 0.8812925, -4.7026386, 4.87713, 4.038207]
Target sample: 109, Prediction:3, Target's Score:[0.8765515, 3.1522532, -3.1761935, 5.240389, -3.0461771, -2.7088063, 1.2778139, -4.3260612, 2.176317, 1.0507804]
Target sample: 115, Prediction:1, Target's Score:[4.081132, 7.9391327, -3.0309768, 2.760446, -4.430942, -3.2785668, -2.191056, -1.8915458, 1.1128248, -0.5178225]
Target sample: 121, Prediction:3, Target's Score:[3.1400054, 3.2858605, -4.491165, 4.1749353, -3.5405717, -2.5242512, -0.6696814, -2.2013187, 1.3975847, 1.9034972]
Target sample: 127, Prediction:1, Target's Score:[0.7312889, 5.552297, -4.1851015, 3.444868, -5.555284, -2.945568, 2.9506667, -4.0697236, 0.7255047, 3.879473]
Target sample: 133, Prediction:3, Target's Score:[1.2894588, 4.638834, -3.0687182, 5.2138443, -5.285338, -3.0577507, 4.1801763, -4.7391386, 0.7480549, 0.6118684]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 00:30:18 Epoch 59, Val iteration 0, acc 89.000 (89.000)
2021-06-12 00:30:22 Epoch 59, Val iteration 19, acc 90.200 (89.550)
* Prec: 89.55000228881836
Per class accuracy =  [0.92078647 0.93388992 0.84952019 0.83094629 0.88996966 0.82322274
 0.93481129 0.89016083 0.92947777 0.94931719]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 3, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 9, 1, 1, 3, 3, 0, 1, 1, 8, 8, 3, 3, 3, 1, 3, 8, 8, 8, 8, 8, 3, 3, 3, 1, 3, 8, 1, 1, 1, 3, 3, 3, 4, 3, 1, 8, 0, 9, 3, 8, 8, 8, 8, 3, 8, 3, 8, 8, 8, 8, 4, 3, 3, 3, 3, 1, 1, 3, 1, 1, 1, 1, 1, 8, 1, 8, 8, 3, 9, 3, 9, 8, 9, 8, 3, 3, 3, 3, 1, 3, 1, 1, 1, 3, 3, 0, 8, 3, 1, 3, 3, 1, 1, 1, 3, 3, 0, 3, 1
ATTACK acc: 0.0
GoogLeNet
[74, 80, 86, 89] 22
Using Adam for retraining
2000
poison index =  84
499
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 00:30:24, Val iteration 0, acc 96.200 (96.200)
2021-06-12 00:30:31, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-12 00:30:32, Epoch 0, Iteration 7, loss 0.782 (0.701), acc 80.769 (83.600)
2021-06-12 00:31:04, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6]
Target sample: 1, Prediction:1, Target's Score:[0.43359056, 6.3593173, -3.728725, -0.6938572, -0.22837576, -3.4126923, 2.4822335, -2.0547762, 0.9418638, -0.021781212]
Target sample: 7, Prediction:6, Target's Score:[0.97356355, 3.1706185, -1.8470377, 0.18401042, -1.1317172, -4.285159, 4.0812383, -2.323322, 3.0779512, -1.8295658]
Target sample: 13, Prediction:1, Target's Score:[-2.7935874, 10.15512, -4.2392097, -1.2681586, -2.2946503, -4.14323, 3.75659, -3.1725762, 5.612102, -1.5035436]
Target sample: 19, Prediction:1, Target's Score:[1.088232, 5.0004735, -3.3716142, -0.5898144, -1.8799273, -3.2480085, 3.2926114, -2.803462, 3.490271, -0.9021172]
Target sample: 25, Prediction:1, Target's Score:[1.950462, 5.949364, -4.3515544, -0.008072738, 0.0912653, -3.4330952, 0.64991874, -3.103161, 3.2519855, -0.9113592]
Target sample: 31, Prediction:1, Target's Score:[-1.0226645, 7.5910087, -4.4288044, -1.5539926, -0.91124237, -2.7965174, 0.22339705, -3.5406163, 4.2010098, 2.3306756]
Target sample: 37, Prediction:1, Target's Score:[-0.19677582, 4.545979, -4.7014723, -0.16613743, -0.22913751, -2.9269896, 1.6135657, -3.672157, 3.6003685, 2.214929]
Target sample: 43, Prediction:8, Target's Score:[-0.72176075, 2.8775184, -3.5105681, -0.047906402, 0.12843433, -3.0726676, 2.0304892, -3.19672, 6.3886967, -0.7945524]
Target sample: 49, Prediction:1, Target's Score:[-1.7648529, 6.943587, -4.5862136, -0.9315077, -1.4873152, -1.5782659, 1.4735231, -3.8158977, 4.5820556, 1.2602229]
Target sample: 55, Prediction:8, Target's Score:[0.8653784, 0.8872902, -3.4824054, -0.68857634, 1.2466161, -2.621779, 2.4446924, -2.031015, 5.819485, -2.3637357]
Target sample: 61, Prediction:9, Target's Score:[-1.4421428, 4.108519, -3.9015558, -1.6408068, 2.1354918, -2.654848, -0.37804887, -3.6828413, -0.5870562, 8.129198]
Target sample: 67, Prediction:8, Target's Score:[-2.1417558, 1.4645848, -4.1600556, 3.3313086, 2.4377081, -3.5855, 1.1257675, -3.4731705, 7.1012235, -2.0029762]
Target sample: 73, Prediction:8, Target's Score:[-0.51706463, 5.734524, -4.4950037, 0.21338814, 1.1742015, -4.1637216, 1.1548283, -3.938257, 7.50864, -2.5601]
Target sample: 79, Prediction:9, Target's Score:[1.4875454, 5.7907233, -4.6689863, -3.5057635, -1.7735226, -4.050124, -0.77250063, -4.041218, -0.014090879, 11.623982]
Target sample: 85, Prediction:8, Target's Score:[1.3609499, 4.4898176, -4.672416, -1.6158793, 0.36114684, -2.723805, 2.0050087, -2.1957788, 4.8602533, -1.7849061]
Target sample: 91, Prediction:1, Target's Score:[-0.19913644, 6.2599106, -3.868001, -0.26073903, -0.62141, -4.071763, 2.3756428, -2.2139733, 1.2692418, 1.407768]
Target sample: 97, Prediction:8, Target's Score:[-0.21283206, 3.0744162, -3.7429993, -1.2294697, -0.6728195, -3.4639475, 3.1101656, -3.5273697, 5.7675867, 0.97591734]
Target sample: 103, Prediction:8, Target's Score:[-1.1113106, 7.150354, -4.715415, -2.493029, -2.677852, -3.4935906, 0.5190799, -3.317154, 7.257803, 2.9720936]
Target sample: 109, Prediction:8, Target's Score:[-0.6991733, 5.4321985, -4.37207, -1.989875, -0.8206953, -3.1931934, 1.1075513, -3.7058651, 6.3059254, 2.0224047]
Target sample: 115, Prediction:1, Target's Score:[-1.0488182, 10.670433, -4.156672, -1.6768094, -2.8290174, -2.9075963, 0.6408235, -3.1700842, 2.9268122, 1.64359]
Target sample: 121, Prediction:1, Target's Score:[0.64042294, 11.493301, -3.6547272, -1.7931628, -2.470312, -3.794369, -0.104122095, -2.305562, 1.1618881, 0.9167964]
Target sample: 127, Prediction:1, Target's Score:[-0.50039965, 4.9035335, -3.7582293, -0.877062, -0.9970849, -3.2302785, 3.865454, -2.862705, 3.9064913, -0.37129796]
Target sample: 133, Prediction:1, Target's Score:[-2.1646557, 5.652559, -2.045556, 0.94634503, -1.6856074, -3.886564, 3.4610887, -3.189444, 4.113855, -1.1190715]
Current ATTACK acc on target samples: 4.348
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 00:31:36 Epoch 59, Val iteration 0, acc 93.200 (93.200)
2021-06-12 00:31:43 Epoch 59, Val iteration 19, acc 92.800 (92.940)
* Prec: 92.94000129699707
Per class accuracy =  [0.93949932 0.94573645 0.9122078  0.85735138 0.92582759 0.90190254
 0.95942895 0.92969833 0.97077075 0.94673584]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 1, 8, 8, 1, 8, 8, 1, 1, 1, 1, 1, 1, 8, 8, 8, 1, 9, 9, 9, 9, 8, 8, 8, 8, 4, 4, 8, 8, 1, 8, 8, 8, 8, 1, 6, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 1, 1, 8, 8, 8, 8, 8, 8, 8, 8, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 8, 6, 6, 1, 1, 1, 6, 1
ATTACK acc: 6.1946902654867255
------SUMMARY POST DEFENSE------
TIME ELAPSED (mins): 12
TARGET INDEX: 16
ResNet50 0.0 0.0 95.46000137329102 90.07000122070312 80.0
DPN92 13.043478260869565 7.079646017699115 95.50000267028808 92.76000175476074 80.0
MobileNetV2 0.0 0.0 91.22000160217286 89.55000228881836 60.0
GoogLeNet 4.3478260869565215 6.1946902654867255 95.41000213623047 92.94000129699707 80.0
True False False False True
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.300-droplayer0.000.t7
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
No specific indices are determined, so try to include whatever we find
In total, we found 129 images of target 17
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', eval_poisons_root='', feat_reg_flag=False, gpu='1', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=17, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/17/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103, 109, 115, 121, 127]
# Targets: 22, # Poisons: 5
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-12 00:32:01 Iteration 0 	 Training Loss: 8.766e-01 	 Loss in Target Net: 9.709e-01	  
 2021-06-12 00:32:36 Iteration 50 	 Training Loss: 3.865e-01 	 Loss in Target Net: 4.285e-01	  
 2021-06-12 00:33:10 Iteration 100 	 Training Loss: 3.574e-01 	 Loss in Target Net: 3.984e-01	  
 2021-06-12 00:33:43 Iteration 150 	 Training Loss: 3.441e-01 	 Loss in Target Net: 3.757e-01	  
 2021-06-12 00:34:16 Iteration 200 	 Training Loss: 3.432e-01 	 Loss in Target Net: 4.035e-01	  
 2021-06-12 00:34:50 Iteration 250 	 Training Loss: 3.389e-01 	 Loss in Target Net: 3.998e-01	  
 2021-06-12 00:35:24 Iteration 300 	 Training Loss: 3.366e-01 	 Loss in Target Net: 4.019e-01	  
 2021-06-12 00:35:59 Iteration 350 	 Training Loss: 3.337e-01 	 Loss in Target Net: 3.892e-01	  
 2021-06-12 00:36:33 Iteration 400 	 Training Loss: 3.393e-01 	 Loss in Target Net: 3.655e-01	  
 2021-06-12 00:37:07 Iteration 450 	 Training Loss: 3.297e-01 	 Loss in Target Net: 3.620e-01	  
 2021-06-12 00:37:41 Iteration 500 	 Training Loss: 3.325e-01 	 Loss in Target Net: 3.791e-01	  
 2021-06-12 00:38:17 Iteration 550 	 Training Loss: 3.310e-01 	 Loss in Target Net: 3.732e-01	  
 2021-06-12 00:38:52 Iteration 600 	 Training Loss: 3.324e-01 	 Loss in Target Net: 3.697e-01	  
 2021-06-12 00:39:27 Iteration 650 	 Training Loss: 3.320e-01 	 Loss in Target Net: 3.514e-01	  
 2021-06-12 00:40:02 Iteration 700 	 Training Loss: 3.298e-01 	 Loss in Target Net: 3.656e-01	  
 2021-06-12 00:40:38 Iteration 750 	 Training Loss: 3.285e-01 	 Loss in Target Net: 3.926e-01	  
 2021-06-12 00:41:11 Iteration 800 	 Training Loss: 3.311e-01 	 Loss in Target Net: 3.827e-01	  
 2021-06-12 00:41:46 Iteration 850 	 Training Loss: 3.324e-01 	 Loss in Target Net: 3.597e-01	  
 2021-06-12 00:42:22 Iteration 900 	 Training Loss: 3.324e-01 	 Loss in Target Net: 3.904e-01	  
 2021-06-12 00:42:56 Iteration 950 	 Training Loss: 3.309e-01 	 Loss in Target Net: 4.005e-01	  
 2021-06-12 00:43:31 Iteration 999 	 Training Loss: 3.320e-01 	 Loss in Target Net: 3.873e-01	  
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 00:43:34, Val iteration 0, acc 94.200 (94.200)
2021-06-12 00:43:40, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-12 00:43:43, Epoch 0, Iteration 7, loss 0.333 (0.540), acc 92.308 (88.200)
2021-06-12 00:44:14, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-4.1269193, 6.315496, -2.3795319, -1.6071162, -2.928278, -2.8175573, 9.397929, -0.4241131, 0.360068, -1.6484463]
Target sample: 7, Prediction:6, Target's Score:[-4.0333953, 5.1764736, -2.2395275, -0.8105609, -2.6482291, -2.3880131, 9.297998, -1.7007523, 1.5597032, -2.0683458]
Target sample: 13, Prediction:6, Target's Score:[-3.6224158, 4.012653, -1.6388519, -1.1117704, -2.1614053, -2.5312185, 8.477871, -1.9448472, -0.5122087, 1.1545577]
Target sample: 19, Prediction:6, Target's Score:[-4.0059905, 7.118919, -0.85163265, -2.1532393, -2.1024113, -2.7524838, 7.610164, -2.054707, -0.9688351, 0.25216138]
Target sample: 25, Prediction:6, Target's Score:[-3.2570555, 2.8788497, -0.7063074, -0.8277693, -1.931751, -2.621396, 7.9615088, -1.0297405, 0.43635175, -0.776547]
Target sample: 31, Prediction:6, Target's Score:[-3.3868504, 2.398404, -2.0784423, -0.9793076, -2.4680614, -3.1414483, 11.568834, -1.5667105, 2.5511765, -2.68478]
Target sample: 37, Prediction:6, Target's Score:[-2.7062263, 3.0249436, -2.307765, -1.434003, -2.7311382, -3.3015258, 10.01018, -1.9493504, 3.8628044, -2.2948375]
Target sample: 43, Prediction:6, Target's Score:[-4.2513795, 3.917555, -2.428963, -1.3558099, -2.3991199, -2.9320006, 9.477543, -2.095077, 2.381896, -0.1670166]
Target sample: 49, Prediction:6, Target's Score:[-4.2871685, 7.944026, -1.7879741, -1.828583, -3.0108187, -3.0784225, 9.847171, -2.7533858, 0.28943878, -1.1974593]
Target sample: 55, Prediction:6, Target's Score:[-4.4885845, 6.5853796, -1.4292141, -1.8636568, -2.4701416, -3.0668597, 10.401281, -2.584922, -0.3489698, -0.5784673]
Target sample: 61, Prediction:6, Target's Score:[-3.240981, 2.0657532, -2.697802, -0.86279833, -2.370078, -3.1025217, 11.806181, -1.2822924, 2.1837313, -2.2808208]
Target sample: 67, Prediction:6, Target's Score:[-4.2880926, 5.26061, -2.4825184, -1.0305998, -2.9865315, -3.104153, 12.39744, -2.2109318, 1.9754846, -3.321164]
Target sample: 73, Prediction:6, Target's Score:[-4.140984, 5.9806027, -2.122911, -2.0704322, -2.6472645, -2.9368656, 8.348561, -2.6420853, 0.08272437, 2.252571]
Target sample: 79, Prediction:1, Target's Score:[-4.266274, 9.313055, -1.4847358, -1.9024248, -2.830373, -3.023674, 8.245329, -2.2936704, 0.14293213, -1.8039325]
Target sample: 85, Prediction:6, Target's Score:[-3.406398, 1.8649412, -2.1605241, -1.3911715, -1.8175454, -3.2416222, 8.502922, -2.1234205, 5.427328, -1.5149072]
Target sample: 91, Prediction:6, Target's Score:[-3.8028324, 1.36957, -1.9878634, -0.7660135, -1.8949679, -2.887945, 8.278909, -2.2952242, 3.6167963, 0.49941465]
Target sample: 97, Prediction:6, Target's Score:[-3.4849515, 2.4356248, -2.0280247, -0.5936479, -1.8202156, -2.849905, 7.3666196, -2.1987145, 4.0202165, -0.73565114]
Target sample: 103, Prediction:6, Target's Score:[-2.656285, 0.96740544, -1.9729446, -0.93687314, -1.9666226, -2.699523, 6.94179, -1.7031178, 3.2888987, 0.84512544]
Target sample: 109, Prediction:1, Target's Score:[-4.391514, 11.789551, -2.1157444, -1.7954749, -3.7979028, -2.6901155, 6.24646, -2.7459178, -0.9951339, 0.52932614]
Target sample: 115, Prediction:6, Target's Score:[-4.045363, 5.404331, -1.797908, -1.3281384, -2.3456612, -2.474797, 8.685077, -2.1204853, -0.35070735, 0.5001663]
Target sample: 121, Prediction:6, Target's Score:[-3.9873376, 4.536044, -2.2168517, -1.0387132, -2.426, -2.8120418, 9.574443, -1.0743116, 1.0936121, -1.4942256]
Target sample: 127, Prediction:6, Target's Score:[-3.4584029, 1.9767759, -2.117961, -0.5297308, -2.2032082, -2.3968637, 7.536543, -1.1316862, 1.1561217, 1.2840413]
Current ATTACK acc on target samples: 90.909
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 00:44:44 Epoch 59, Val iteration 0, acc 90.200 (90.200)
2021-06-12 00:44:50 Epoch 59, Val iteration 19, acc 92.000 (90.790)
* Prec: 90.79000091552734
Per class accuracy =  [0.93530308 0.93786196 0.82073518 0.84298074 0.91468896 0.87192866
 0.97476019 0.86978816 0.95655116 0.95287733]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6
ATTACK acc: 90.65420560747664
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 00:44:57, Val iteration 0, acc 94.800 (94.800)
2021-06-12 00:45:09, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-12 00:45:16, Epoch 0, Iteration 7, loss 0.933 (0.506), acc 76.923 (89.000)
2021-06-12 00:46:42, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:8, Target's Score:[1.5662607, 2.1132116, -0.96397364, -2.0123782, 0.31864443, -3.0405488, -0.16477667, 1.5604649, 2.9752614, -2.0596776]
Target sample: 7, Prediction:8, Target's Score:[0.22445075, 3.2524192, -2.2472599, -0.7291053, -3.1373734, -4.401769, 1.6326313, -2.4102635, 8.873351, -0.69690675]
Target sample: 13, Prediction:8, Target's Score:[1.3843988, 2.0371282, -2.1809635, 0.4588258, -2.9405828, -3.8639083, 1.9614184, 1.2634721, 4.9413857, -2.713901]
Target sample: 19, Prediction:1, Target's Score:[-0.50397587, 9.110501, -3.6288357, 0.47519445, -3.343672, -3.8812406, 2.8633113, -2.0226226, 2.4982994, -1.171828]
Target sample: 25, Prediction:8, Target's Score:[1.9789325, 4.3332233, -2.7502654, 1.8787761, -4.6855516, -4.849177, 4.9579644, -2.6769838, 5.669375, -3.4272661]
Target sample: 31, Prediction:6, Target's Score:[0.68737423, 2.67371, -2.6519465, 1.6632923, -4.04557, -3.7620862, 7.237518, -1.6109182, 4.759287, -4.530382]
Target sample: 37, Prediction:6, Target's Score:[2.222009, 3.9204907, -3.5048606, 0.046966508, -5.0750856, -3.7113035, 7.7199693, -1.5984563, 4.724315, -4.3076696]
Target sample: 43, Prediction:6, Target's Score:[3.961212, 1.8966858, -3.504489, -0.46128365, -4.859311, -3.9397624, 7.442041, -2.5558329, 5.0778594, -2.6433086]
Target sample: 49, Prediction:1, Target's Score:[0.5486305, 10.153743, -3.4743013, -0.91320455, -4.3901625, -4.1125627, 6.902327, -3.617111, 1.9277171, -2.551463]
Target sample: 55, Prediction:6, Target's Score:[1.8292801, 3.2723622, -2.0310898, 1.8491212, -4.15515, -3.2345557, 8.36289, -2.6047564, 2.337584, -5.1891994]
Target sample: 61, Prediction:6, Target's Score:[1.8378596, 1.7668879, -2.4061193, -0.98654765, -3.330305, -3.49312, 6.3224406, -2.0051787, 4.9527564, -2.3324943]
Target sample: 67, Prediction:6, Target's Score:[4.8313813, 2.525191, -2.3176076, -1.3442987, -3.8138635, -4.0173473, 6.471528, -1.7592273, 3.8479624, -4.045035]
Target sample: 73, Prediction:1, Target's Score:[0.8712404, 6.439305, -3.7461386, 0.52725625, -4.4030857, -3.9267745, 4.4954934, -0.7101446, 3.0208209, -2.1703043]
Target sample: 79, Prediction:1, Target's Score:[-0.18920963, 8.880464, -3.627452, 1.4596097, -4.2466145, -4.4471045, 1.900221, -1.412675, 3.8934467, -1.765791]
Target sample: 85, Prediction:8, Target's Score:[0.5340654, 4.443322, -3.473763, 0.8955137, -4.4523273, -4.5059233, 3.1722715, -2.3941896, 8.959452, -2.7586937]
Target sample: 91, Prediction:8, Target's Score:[-1.512227, 2.567857, -2.7206898, 1.9670814, -3.5726836, -5.1305604, 1.3659017, -2.3926075, 11.9991455, -2.1426127]
Target sample: 97, Prediction:8, Target's Score:[-0.16048235, 7.0090995, -3.2173352, 1.8066852, -4.525183, -5.196659, 2.089603, -2.7066355, 7.8822374, -2.5270073]
Target sample: 103, Prediction:8, Target's Score:[1.2883278, 2.9006143, -3.1772037, 1.7249814, -4.397654, -4.867065, 2.2724874, -1.7378238, 7.8169937, -1.4338448]
Target sample: 109, Prediction:1, Target's Score:[2.3495588, 7.465105, -3.1659377, -0.6148346, -3.7813137, -3.5561738, 2.7381475, 0.18795602, 0.82717264, -2.0354006]
Target sample: 115, Prediction:1, Target's Score:[-0.24691035, 4.497666, -1.9015188, 1.248501, -3.556301, -3.3581595, 3.500857, 0.01846001, 4.3001285, -4.1051307]
Target sample: 121, Prediction:8, Target's Score:[0.2270669, 1.9137216, -0.3138584, 0.18720806, -2.695908, -3.9567215, 0.22451437, 2.211519, 3.6514773, -1.1236961]
Target sample: 127, Prediction:8, Target's Score:[0.2740014, 2.2395847, -2.0951414, 0.6411343, -4.290843, -3.7103443, 1.9756169, 0.5883242, 4.102599, 0.62313914]
Current ATTACK acc on target samples: 27.273
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 00:48:06 Epoch 59, Val iteration 0, acc 93.200 (93.200)
2021-06-12 00:48:18 Epoch 59, Val iteration 19, acc 93.800 (93.470)
* Prec: 93.47000160217286
Per class accuracy =  [0.94491    0.9718626  0.92272575 0.86285644 0.96295905 0.89425505
 0.94174792 0.93385099 0.97662745 0.94048249]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 2, 8, 1, 8, 8, 8, 8, 8, 1, 1, 8, 8, 8, 6, 1, 1, 8, 8, 1, 1, 6, 6, 6, 8, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 1, 6, 6, 6, 1, 6, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 8, 8, 8, 1, 0, 8, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 8, 1, 2, 8, 7, 1, 8, 8, 8, 8, 8, 8
ATTACK acc: 24.299065420560748
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 00:48:21, Val iteration 0, acc 92.600 (92.600)
2021-06-12 00:48:24, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-12 00:48:25, Epoch 0, Iteration 7, loss 0.306 (0.307), acc 92.308 (90.400)
2021-06-12 00:48:40, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:9, Target's Score:[1.201117, 2.0442731, -1.1206504, 2.3002715, -0.70598966, -3.7220938, 0.6642119, 1.6413466, -4.919013, 3.0477304]
Target sample: 7, Prediction:1, Target's Score:[-1.0018966, 7.1110773, -4.754128, 0.83760786, -4.0116653, -3.9939756, 3.509478, -2.1339195, -1.326736, 6.3526425]
Target sample: 13, Prediction:9, Target's Score:[2.1900113, 2.9192555, -2.8600543, 2.0586898, -2.2629752, -4.034957, 3.1938832, -0.6982693, -3.900943, 3.8915377]
Target sample: 19, Prediction:1, Target's Score:[-0.6757055, 11.843077, -1.8367019, -1.3965113, -3.051168, -3.1917882, 1.3099153, -0.68195695, -3.5819426, 1.8256259]
Target sample: 25, Prediction:1, Target's Score:[2.8094604, 3.865765, -0.7243798, 0.6608793, -0.17623301, -4.3762636, 3.8155615, -3.8637662, -0.67337006, -0.8777052]
Target sample: 31, Prediction:1, Target's Score:[1.1092919, 8.776872, -2.00804, -0.00081925094, -0.6839425, -4.7102885, 2.4834046, -3.152255, -3.6074946, 2.3656323]
Target sample: 37, Prediction:6, Target's Score:[-0.10963567, 1.0897384, -2.563172, 1.5214205, 1.5747285, -5.223768, 6.347316, -3.6127107, -0.69199455, 2.1721983]
Target sample: 43, Prediction:6, Target's Score:[-2.208148, 5.0219173, -5.5248365, 2.6596947, -4.0326653, -2.4786637, 9.673228, -6.5092115, -0.89783114, 4.9559093]
Target sample: 49, Prediction:1, Target's Score:[0.49605367, 11.000918, -4.0126305, 1.0182363, -4.3450017, -3.7042108, 7.9750576, -5.4663806, -2.225479, -0.11618987]
Target sample: 55, Prediction:6, Target's Score:[0.8951203, -0.014690921, -2.4018965, 4.2323866, -4.116547, -1.4815698, 10.887139, -4.9685326, -5.0528436, 2.5257516]
Target sample: 61, Prediction:6, Target's Score:[0.28739652, 2.3361328, -0.2251706, 1.4783537, -2.1825366, -3.7212734, 5.633617, -0.9697558, -1.7510108, -0.48370525]
Target sample: 67, Prediction:6, Target's Score:[0.92757803, 1.9225066, -4.824662, 2.1412003, -2.015448, -3.879501, 9.381604, -3.6768985, 1.3678544, -0.8729354]
Target sample: 73, Prediction:6, Target's Score:[4.1985292, 5.858122, -3.3300362, -0.7980753, -3.0005949, -4.544249, 8.224203, -3.9677703, -2.72933, 0.59180933]
Target sample: 79, Prediction:6, Target's Score:[2.5627806, 5.807235, -2.4859588, 0.6976523, -4.867123, -3.1925797, 8.131404, -4.6812873, -3.332727, 1.8914806]
Target sample: 85, Prediction:9, Target's Score:[1.131536, 3.493278, -3.7646842, 1.8897485, -3.835877, -2.6440573, 6.0839715, -5.344417, -2.7457817, 6.301803]
Target sample: 91, Prediction:9, Target's Score:[-1.5416138, 1.8827751, -4.659892, 2.5119734, -1.237372, -3.1742384, 6.2565207, -3.4648018, -3.8728507, 7.870462]
Target sample: 97, Prediction:9, Target's Score:[0.35903326, 1.8721639, -3.6239834, 3.3900466, -1.4167497, -3.2542317, 4.1525865, -3.336132, -3.653402, 6.0565305]
Target sample: 103, Prediction:9, Target's Score:[-0.6844865, -0.9369292, -3.5532734, 3.6265056, 0.16231799, -3.5349717, 3.7144918, -2.2520773, -0.37715957, 4.3242726]
Target sample: 109, Prediction:1, Target's Score:[-1.1442474, 9.797318, -4.3164096, -0.36917943, -4.9204392, -3.834244, 6.9858294, -3.1763654, -3.930923, 5.56714]
Target sample: 115, Prediction:6, Target's Score:[-1.5678755, 1.5893068, -2.8158345, 1.8180159, -0.8087791, -1.7442625, 9.822035, -3.1003385, -1.1111203, -1.6357405]
Target sample: 121, Prediction:9, Target's Score:[-2.424169, 0.84483415, -3.104682, 1.6779851, 2.5393372, -4.3035054, 0.87913954, 2.2304776, -1.1419548, 3.254651]
Target sample: 127, Prediction:9, Target's Score:[-1.5924927, 2.1628425, -5.0337725, 1.4193274, -3.0438516, -4.4330926, 2.7089279, -2.2152388, -2.532423, 13.211605]
Current ATTACK acc on target samples: 36.364
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 00:48:54 Epoch 59, Val iteration 0, acc 89.000 (89.000)
2021-06-12 00:48:58 Epoch 59, Val iteration 19, acc 90.200 (89.730)
* Prec: 89.7300018310547
Per class accuracy =  [0.92319415 0.93329088 0.84335432 0.83436729 0.89585493 0.82464899
 0.93969215 0.89470332 0.93088544 0.94893352]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 9, 4, 9, 9, 6, 9, 9, 9, 9, 1, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 1, 1, 9, 9, 6, 6, 6, 6, 6, 9, 9, 9, 6, 6, 6, 9, 9, 9, 9, 9, 1, 1, 6, 6, 6, 6, 6, 1, 3, 1, 6, 6, 9, 1, 1, 9, 9
ATTACK acc: 48.598130841121495
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 00:49:02, Val iteration 0, acc 96.200 (96.200)
2021-06-12 00:49:09, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-12 00:49:12, Epoch 0, Iteration 7, loss 0.685 (0.796), acc 80.769 (80.200)
2021-06-12 00:49:44, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:0, Target's Score:[3.2118645, 3.1050816, -2.1360087, -2.3291602, -1.3113614, -5.00794, 1.5608461, 1.7098509, 0.82104343, 0.46464205]
Target sample: 7, Prediction:6, Target's Score:[0.040764235, 2.2062123, -1.4387298, -3.1573443, 0.30225122, -3.980133, 6.4415545, -3.0861526, 2.774205, -0.01651375]
Target sample: 13, Prediction:6, Target's Score:[0.41354567, 2.8030484, -2.412829, -0.17575216, -0.29485527, -4.945007, 7.539764, -2.1272159, -0.5597729, -0.17353128]
Target sample: 19, Prediction:1, Target's Score:[2.612719, 6.0142274, -3.535581, -2.0317528, 0.076797165, -5.1711006, 3.9258316, -2.5983133, -1.3112553, 2.1079674]
Target sample: 25, Prediction:6, Target's Score:[1.9381255, 2.7350836, -2.7459774, -3.4261699, -0.9173625, -4.76367, 5.3997965, -1.9014784, 1.3345376, 2.4403749]
Target sample: 31, Prediction:6, Target's Score:[2.2569034, 1.6616298, -3.2744064, -3.1342435, -0.38621205, -4.5034943, 6.0790405, -1.7932631, 4.072549, -0.886678]
Target sample: 37, Prediction:8, Target's Score:[2.5131397, -0.90034324, -3.3095386, -3.2126174, -2.4492707, -4.468833, 6.5774393, -2.2078967, 8.822331, -1.2492021]
Target sample: 43, Prediction:6, Target's Score:[2.0912344, 1.0029169, -3.285622, -0.65480256, -1.8551186, -4.933816, 7.1619506, -2.8901162, 3.3418262, 0.11044173]
Target sample: 49, Prediction:6, Target's Score:[-0.25817683, 5.6867104, -3.2838411, 0.15951738, -0.93736297, -3.697306, 5.7300434, -3.3279765, -0.7732737, 0.7719643]
Target sample: 55, Prediction:6, Target's Score:[1.3132386, 0.7384669, -2.9671261, 2.1498818, -3.1808648, -4.2841244, 7.169735, -2.351441, 1.5614605, -0.07341389]
Target sample: 61, Prediction:6, Target's Score:[0.7407402, -1.7893307, -1.740875, -0.19708368, -1.0000458, -4.483006, 5.9882364, 1.0854533, 3.6188147, -2.134279]
Target sample: 67, Prediction:6, Target's Score:[1.6991392, -0.57974845, -3.137956, -1.4966542, 0.8394726, -4.84938, 8.340459, -3.098062, 3.6617432, -1.2897929]
Target sample: 73, Prediction:6, Target's Score:[1.3639643, 2.3493838, -4.0459113, 0.43006247, -0.97611475, -5.931409, 4.5075765, 0.29515657, -0.4366084, 2.5333152]
Target sample: 79, Prediction:1, Target's Score:[0.3904328, 6.1642756, -3.467597, -1.4801078, -1.4820801, -5.4169307, 5.0190573, -1.8426915, 0.23934859, 1.9647015]
Target sample: 85, Prediction:0, Target's Score:[4.6792912, 0.15769286, -3.3387585, -0.38664672, -0.44455153, -4.964922, 3.822891, -1.9933275, 2.9546852, -0.39307535]
Target sample: 91, Prediction:8, Target's Score:[-1.7405313, 1.4932324, -4.331236, -0.030076081, -2.7033408, -4.1726847, 4.6135163, -2.2529023, 5.964284, 3.2613485]
Target sample: 97, Prediction:8, Target's Score:[3.185341, 4.008089, -3.591701, -1.4741031, -2.2021558, -4.6141953, 1.0321299, -3.1646655, 4.5481367, 2.3758612]
Target sample: 103, Prediction:0, Target's Score:[4.8049254, -0.40201396, -2.2483978, -1.0472275, -0.999492, -4.4034877, 1.7867308, -2.1629813, 4.064203, 0.7095536]
Target sample: 109, Prediction:1, Target's Score:[0.49280426, 10.412005, -3.3018878, -1.3040543, -1.7308441, -4.939621, 0.6621882, -3.1488333, -1.7219871, 4.6766243]
Target sample: 115, Prediction:6, Target's Score:[-1.4420968, 2.5587246, -2.9884145, -1.6544062, -0.87471133, -2.2205892, 6.7028003, -2.8130834, -0.09594554, 2.9190814]
Target sample: 121, Prediction:1, Target's Score:[-0.16447668, 3.288919, -0.9350267, 0.0009913798, 0.5267642, -4.3686643, 1.8808632, 0.4580563, -0.96071553, 0.34527785]
Target sample: 127, Prediction:9, Target's Score:[0.24006827, 2.3848464, -2.1123672, -3.2500415, -1.3489163, -4.5015235, 2.4281428, -2.6642258, 4.464107, 4.4711103]
Current ATTACK acc on target samples: 50.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 00:50:16 Epoch 59, Val iteration 0, acc 93.600 (93.600)
2021-06-12 00:50:23 Epoch 59, Val iteration 19, acc 93.600 (92.690)
* Prec: 92.69000091552735
Per class accuracy =  [0.96361855 0.94049381 0.85722511 0.86346422 0.95186824 0.87907166
 0.96677666 0.93801446 0.95185512 0.95727037]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 4, 6, 6, 6, 6, 6, 9, 9, 6, 1, 1, 6, 6, 6, 6, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 8, 8, 6, 8, 1, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 8, 8, 8, 8, 6, 8, 6, 6, 6, 6, 6, 0, 1, 6, 6, 0, 6, 6, 6, 6, 0, 1, 8, 8, 8, 8, 8, 8, 8, 8, 9, 8, 9, 0, 0, 0, 6, 9, 9, 6, 1, 1, 1, 9, 1, 1, 6, 6, 7, 7, 4, 6, 6, 6, 6, 8, 9
ATTACK acc: 52.33644859813084
--------
------SUMMARY PRE DEFENSE------
TIME ELAPSED (mins): 11
TARGET INDEX: 17
ResNet50 90.9090909090909 90.65420560747664 95.46000137329102 90.79000091552734
DPN92 27.272727272727273 24.299065420560748 95.50000267028808 93.47000160217286
MobileNetV2 36.36363636363637 48.598130841121495 91.22000160217286 89.7300018310547
GoogLeNet 50.0 52.33644859813084 95.41000213623047 92.69000091552735
DEFENSE EVALUATION
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
ResNet50
[74, 80, 86, 89] 4
Using Adam for retraining
2000
poison index =  84
499
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 00:50:27, Val iteration 0, acc 94.200 (94.200)
2021-06-12 00:50:33, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-12 00:50:34, Epoch 0, Iteration 7, loss 0.239 (0.256), acc 94.231 (95.800)
2021-06-12 00:51:05, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6]
Target sample: 1, Prediction:1, Target's Score:[0.014015185, 3.136182, -2.473983, -1.7762166, -0.9033208, -2.3531036, 2.3954303, -0.22222814, 2.199373, 0.15473217]
Target sample: 7, Prediction:1, Target's Score:[-1.0586774, 4.971414, -2.8674006, -1.5030133, -0.7495167, -2.1559346, 2.549312, -1.6232605, 2.9213731, -0.2908942]
Target sample: 13, Prediction:6, Target's Score:[0.18955934, 0.95012444, -2.1499717, -1.5934535, -0.07008213, -2.147464, 2.1475015, -1.193272, 2.0021968, 2.0432901]
Target sample: 19, Prediction:1, Target's Score:[-1.6812805, 6.576737, -1.5365313, -2.7343404, 0.5700601, -2.4710662, 2.1944704, -1.9288123, -0.7829828, 2.0828667]
Target sample: 25, Prediction:6, Target's Score:[-0.8092715, 2.3146667, -2.1143324, -1.6156904, -1.1835315, -2.7546303, 2.971744, -1.1415187, 1.8794823, 2.6822555]
Target sample: 31, Prediction:8, Target's Score:[0.24816705, 0.62874496, -2.3558235, -1.9651505, -1.0020148, -2.8707616, 3.778615, -1.4380271, 5.0299187, 0.10851749]
Target sample: 37, Prediction:8, Target's Score:[1.502873, 0.42548367, -2.948899, -2.1070662, -1.5639567, -2.9504116, 1.2116885, -1.3909894, 7.006371, 0.9744054]
Target sample: 43, Prediction:8, Target's Score:[0.43742612, 0.92694336, -3.1156163, -2.3010101, -1.3328452, -2.886312, 2.0410037, -1.65847, 5.101142, 3.0131738]
Target sample: 49, Prediction:1, Target's Score:[-0.67059296, 8.891348, -1.8860441, -2.7611864, -1.4434786, -2.8465934, 2.3328967, -1.6049614, -0.05497841, 0.304915]
Target sample: 55, Prediction:1, Target's Score:[0.45848462, 3.950496, -0.74598324, -1.7908015, -0.95295054, -2.8415363, 3.802372, -1.5481, 0.0015829103, -0.14970109]
Target sample: 61, Prediction:8, Target's Score:[3.1921923, -0.87665075, -2.3294108, -1.8090967, -1.234147, -3.1669018, 3.4716282, 0.09961577, 4.2708573, -1.5050021]
Target sample: 67, Prediction:6, Target's Score:[0.29374328, 1.0669075, -2.708815, -1.6277122, -1.7584925, -2.7681942, 5.843923, -0.62009114, 3.9998686, -1.5764446]
Target sample: 73, Prediction:9, Target's Score:[0.06424117, 2.0767667, -1.9392512, -2.3115802, -1.0383972, -2.8417683, 2.6717644, -1.2154732, 1.336368, 3.4323874]
Target sample: 79, Prediction:1, Target's Score:[-1.9328665, 8.81445, -1.8120694, -2.19451, -0.19103178, -2.5796556, 1.2688507, -1.6896625, -0.87043375, 1.4744915]
Target sample: 85, Prediction:8, Target's Score:[1.2467382, -0.27691987, -2.4971817, -0.63654214, -0.9143505, -2.7282884, 0.5789844, -1.4871707, 5.3240967, 1.5391172]
Target sample: 91, Prediction:8, Target's Score:[-0.52100617, 1.1049696, -2.6356087, -1.1039041, -1.0163059, -2.6743786, 1.2136314, -2.0491853, 4.806878, 3.092495]
Target sample: 97, Prediction:1, Target's Score:[0.02737168, 4.766085, -2.6082826, -0.8252727, -1.3027176, -2.5368977, -0.73435724, -1.9763464, 4.025835, 1.3727362]
Target sample: 103, Prediction:8, Target's Score:[1.4195188, 0.64233273, -2.461476, -1.1219218, -1.2624627, -2.5248575, -0.6835675, -1.5326015, 3.9550312, 3.7644796]
Target sample: 109, Prediction:1, Target's Score:[-1.690876, 9.004252, -2.2317514, -2.308609, -1.7343228, -2.5976212, 0.2895322, -1.7783836, -0.85508204, 4.2472196]
Target sample: 115, Prediction:6, Target's Score:[-0.39731568, 0.64872116, -1.8827422, -1.4599664, -1.0657064, -2.2130573, 4.7584577, -1.180699, 1.6324228, 1.3438745]
Target sample: 121, Prediction:1, Target's Score:[-0.71595186, 3.3698778, -1.4651458, -0.78315544, 2.182622, -2.6743166, 0.851977, -0.24931665, 1.0235027, -1.3725142]
Target sample: 127, Prediction:8, Target's Score:[1.004856, 0.81206244, -2.8074095, -1.2157967, -0.98578125, -2.5457797, 0.31630453, 0.42307276, 3.5910163, 1.5680254]
Current ATTACK acc on target samples: 18.182
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 00:51:36 Epoch 59, Val iteration 0, acc 90.600 (90.600)
2021-06-12 00:51:42 Epoch 59, Val iteration 19, acc 91.400 (90.830)
* Prec: 90.83000183105469
Per class accuracy =  [0.92228565 0.95663542 0.85482114 0.85007201 0.92376373 0.796304
 0.95335064 0.93438616 0.95866329 0.93038949]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 4, 4, 1, 8, 8, 1, 8, 1, 1, 1, 9, 1, 1, 9, 1, 1, 1, 1, 1, 1, 6, 6, 8, 8, 6, 1, 1, 8, 8, 8, 8, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 0, 8, 8, 8, 8, 8, 8, 8, 6, 8, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 8, 1, 8, 8, 8, 8, 8, 8, 8, 8, 9, 8, 8, 8, 8, 9, 9, 9, 9, 1, 1, 1, 1, 1, 6, 8, 9, 1, 1, 7, 1, 8, 4, 1, 1, 1, 1
ATTACK acc: 9.345794392523365
DPN92
[74, 80, 86] 26
Using Adam for retraining
2000
poison index =  84
poison index =  89
498
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 00:51:45, Val iteration 0, acc 94.800 (94.800)
2021-06-12 00:51:57, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-12 00:52:00, Epoch 0, Iteration 7, loss 0.721 (0.406), acc 84.615 (90.800)
2021-06-12 00:53:26, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6]
Target sample: 1, Prediction:1, Target's Score:[0.83733046, 6.6255126, -2.1985178, -2.2783897, -2.2405422, -2.8067904, 0.41104442, 0.110569365, 2.728727, -0.88464355]
Target sample: 7, Prediction:8, Target's Score:[0.18827853, 3.7656047, -3.7407312, -1.0212247, -2.4204195, -4.4776344, 0.6995717, -1.011689, 10.066326, -1.6534665]
Target sample: 13, Prediction:1, Target's Score:[1.1041691, 4.260681, -3.1312482, -1.2830902, -2.131931, -3.3234282, 3.7290716, 0.6935397, 3.1506333, -2.7455506]
Target sample: 19, Prediction:1, Target's Score:[-0.8575617, 10.881788, -4.2626677, -2.145575, -2.585257, -3.08632, 0.9614396, -0.6306549, 2.621703, -0.52218264]
Target sample: 25, Prediction:1, Target's Score:[-0.015456468, 7.83948, -5.100949, -0.3530843, -2.824882, -4.337227, 0.24472447, -1.2620531, 5.441855, 0.76096916]
Target sample: 31, Prediction:1, Target's Score:[-0.90634286, 9.052659, -4.54947, -1.0054353, -2.9051871, -4.080755, 1.4059832, 0.6084639, 5.089628, -2.307461]
Target sample: 37, Prediction:1, Target's Score:[0.030545011, 8.586668, -5.3935456, -1.0008568, -3.4587653, -4.4334135, 2.3193047, -0.40994766, 5.9839654, -1.8138617]
Target sample: 43, Prediction:1, Target's Score:[0.0055591147, 8.0297575, -5.4434643, -1.3072602, -3.3616717, -4.2442913, 2.9555287, -0.88191956, 5.1292768, -0.4796939]
Target sample: 49, Prediction:1, Target's Score:[-1.4217993, 14.176444, -4.4636245, -2.5783272, -3.8011537, -3.409819, 2.5309906, -1.33087, 2.392936, -1.6696067]
Target sample: 55, Prediction:6, Target's Score:[2.3032079, 5.8975387, -2.581027, -1.4099668, -3.1488607, -2.5132673, 6.506158, -0.9263356, 0.44589487, -4.234089]
Target sample: 61, Prediction:8, Target's Score:[2.466531, 3.900872, -4.587673, -1.657226, -2.617407, -4.4476495, 2.4021454, -0.172496, 7.590898, -2.4940917]
Target sample: 67, Prediction:6, Target's Score:[4.407743, 4.297636, -3.455052, -2.2891185, -2.8225522, -3.8072293, 5.99676, -0.969531, 3.1357849, -4.1194515]
Target sample: 73, Prediction:1, Target's Score:[-0.46031076, 10.212922, -3.8341217, -1.9240261, -3.5528245, -3.0831735, 2.812227, -1.0311095, 0.4415897, 0.76972896]
Target sample: 79, Prediction:1, Target's Score:[-0.962219, 11.957993, -4.624218, -0.9426104, -3.3354933, -3.2598975, -0.8560349, -0.87500197, 3.351112, -0.044298172]
Target sample: 85, Prediction:8, Target's Score:[-0.15150456, 6.0877004, -5.213521, -0.588493, -2.1448424, -3.8384044, 0.75135654, -0.93622214, 8.036027, -1.6049006]
Target sample: 91, Prediction:8, Target's Score:[-2.45322, 4.7859573, -5.3150864, 0.6196028, -1.408635, -4.7536964, -0.28444526, -0.70025223, 8.717047, 1.2129055]
Target sample: 97, Prediction:1, Target's Score:[-0.33347777, 8.948952, -4.9554315, -0.38429037, -2.9683175, -4.1694217, -0.47739953, -1.2577436, 6.5509996, -0.54063976]
Target sample: 103, Prediction:1, Target's Score:[-0.5814642, 6.3500886, -5.438984, -0.6399016, -2.6014867, -3.6236877, -0.767065, -1.0116776, 6.347877, 2.358534]
Target sample: 109, Prediction:1, Target's Score:[-0.38834783, 13.108801, -4.0380406, -2.078792, -3.89577, -3.083676, -0.31415474, -0.5498994, 0.97662795, 0.6513444]
Target sample: 115, Prediction:1, Target's Score:[0.13660565, 10.11723, -3.5191603, -1.2821236, -3.8837194, -2.5041802, 0.69218117, 0.15263355, 1.684708, -1.233843]
Target sample: 121, Prediction:1, Target's Score:[0.8085865, 3.4658804, -2.3821037, -0.740296, -2.7523606, -4.1815147, -0.8658434, 2.3589835, 3.2622147, 1.377376]
Target sample: 127, Prediction:8, Target's Score:[0.67602277, 2.355491, -3.3767898, -0.7054967, -3.1244652, -4.470327, -0.5955542, 2.5311635, 5.5654445, 1.5166851]
Current ATTACK acc on target samples: 9.091
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 00:54:49 Epoch 59, Val iteration 0, acc 94.400 (94.400)
2021-06-12 00:55:01 Epoch 59, Val iteration 19, acc 91.800 (93.080)
* Prec: 93.08000183105469
Per class accuracy =  [0.95998652 0.96198006 0.90036094 0.85623839 0.94289313 0.87027819
 0.94176535 0.95522901 0.97164623 0.94980479]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 2, 8, 8, 8, 8, 8, 8, 8, 8, 1, 1, 1, 7, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 0, 8, 1, 8, 1, 1, 1, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 8, 8, 8, 1, 8, 8, 8, 1, 8, 1, 1, 1, 9, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 7, 8, 8, 1, 8, 8, 8, 8
ATTACK acc: 6.542056074766355
MobileNetV2
[] 43
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 00:55:04, Val iteration 0, acc 92.600 (92.600)
2021-06-12 00:55:07, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-12 00:55:08, Epoch 0, Iteration 7, loss 0.321 (0.324), acc 86.538 (89.400)
2021-06-12 00:55:22, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:9, Target's Score:[2.1940274, 1.9640388, -0.57352674, 1.4922758, -0.76200944, -4.1738396, 0.3788286, 1.9648333, -4.302633, 2.2245352]
Target sample: 7, Prediction:1, Target's Score:[-0.1610058, 7.352824, -4.6572847, -0.011142716, -4.2658377, -4.05061, 2.9692907, -1.9936692, -1.1139703, 6.379197]
Target sample: 13, Prediction:9, Target's Score:[3.219359, 3.2338643, -2.910646, 1.3750826, -2.545968, -4.367279, 2.770459, -0.46624234, -3.7905712, 3.91941]
Target sample: 19, Prediction:1, Target's Score:[-0.6703837, 12.26933, -1.8533468, -2.0181096, -3.7615416, -3.0295045, 1.5348886, -0.59293526, -3.2503216, 1.8391612]
Target sample: 25, Prediction:1, Target's Score:[2.8161728, 4.9476886, -1.1309656, -0.095652536, -0.2522089, -4.492769, 4.476982, -4.2661896, -0.13361189, -1.4538391]
Target sample: 31, Prediction:1, Target's Score:[1.2783942, 9.531123, -2.2180996, -0.48008192, -1.1378673, -4.819335, 2.6603372, -3.429031, -3.2819977, 2.3923965]
Target sample: 37, Prediction:6, Target's Score:[0.24165493, 1.6143086, -2.6086056, 0.8155198, 1.6040648, -5.226512, 7.016993, -4.1080556, -0.39464128, 1.4876438]
Target sample: 43, Prediction:6, Target's Score:[-1.8580141, 4.9893093, -5.594658, 2.5477107, -4.0549603, -2.4995966, 10.099661, -6.83067, -0.79905045, 4.483804]
Target sample: 49, Prediction:1, Target's Score:[0.34650072, 10.488878, -3.8265488, 0.8211153, -4.340369, -3.8956332, 8.586818, -5.4202003, -1.7239891, -0.5587615]
Target sample: 55, Prediction:6, Target's Score:[1.411424, -0.051062502, -2.080149, 3.4151127, -4.021417, -2.0684478, 11.835149, -5.165886, -4.8150992, 1.944269]
Target sample: 61, Prediction:6, Target's Score:[0.93675053, 2.496395, -0.30873328, 0.7259669, -2.65114, -3.7726576, 5.9095206, -0.8299347, -1.8216051, -0.3272491]
Target sample: 67, Prediction:6, Target's Score:[1.196079, 2.1046822, -4.875965, 1.8353689, -1.958779, -4.190057, 10.015692, -3.9243708, 1.4234253, -1.2260892]
Target sample: 73, Prediction:6, Target's Score:[4.5789475, 5.9378223, -3.4594927, -0.93306965, -3.635359, -4.7668242, 8.583658, -3.9708157, -2.4265056, 0.52006364]
Target sample: 79, Prediction:6, Target's Score:[2.8554463, 5.8440576, -2.5447817, 0.4203924, -4.9174685, -3.4746437, 8.550634, -4.893904, -2.9717505, 1.5541971]
Target sample: 85, Prediction:6, Target's Score:[2.002307, 3.3963463, -3.8795643, 1.611742, -3.984479, -2.9453332, 6.694045, -5.4474854, -2.108759, 5.079777]
Target sample: 91, Prediction:9, Target's Score:[-0.9826853, 2.3578348, -4.3491225, 2.087729, -1.6857921, -3.3887696, 6.641595, -3.8544722, -3.8007147, 7.425871]
Target sample: 97, Prediction:9, Target's Score:[1.4138205, 1.9824982, -3.2927454, 3.049879, -1.613304, -3.5213032, 3.7284281, -3.491199, -3.229049, 5.4136505]
Target sample: 103, Prediction:9, Target's Score:[0.07952806, -0.56945145, -3.4288127, 2.9614012, -0.2149178, -3.6075747, 3.470112, -2.549427, 0.0586684, 4.2092524]
Target sample: 109, Prediction:1, Target's Score:[-0.7647406, 10.012424, -4.121032, -0.5370241, -5.2017345, -4.026615, 7.076605, -3.38135, -3.3082001, 4.749186]
Target sample: 115, Prediction:6, Target's Score:[-1.7901088, 1.8962913, -2.424486, 1.675174, -0.8966133, -1.8682982, 9.923568, -3.6263351, -0.777093, -1.729006]
Target sample: 121, Prediction:9, Target's Score:[-2.0427454, 1.2397462, -2.7963996, 0.91218126, 2.0325947, -4.0782957, 0.557381, 2.3855543, -0.93995, 3.1544046]
Target sample: 127, Prediction:9, Target's Score:[-0.52657306, 2.359152, -4.9825726, 0.9533717, -3.4440544, -4.516022, 1.9822785, -2.2629318, -2.5597777, 13.489596]
Current ATTACK acc on target samples: 40.909
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 00:55:37 Epoch 59, Val iteration 0, acc 89.400 (89.400)
2021-06-12 00:55:40 Epoch 59, Val iteration 19, acc 90.400 (89.770)
* Prec: 89.77000160217285
Per class accuracy =  [0.92554533 0.9241729  0.85275905 0.83325648 0.89824647 0.81900153
 0.93999839 0.89677434 0.92992358 0.95061594]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 9, 4, 9, 9, 6, 9, 9, 9, 9, 1, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 6, 1, 1, 9, 9, 6, 6, 6, 6, 6, 9, 9, 9, 6, 6, 6, 9, 6, 9, 9, 1, 1, 1, 6, 6, 6, 6, 6, 1, 3, 1, 1, 6, 9, 1, 1, 9, 9
ATTACK acc: 49.532710280373834
GoogLeNet
[74, 80, 86, 89] 21
Using Adam for retraining
2000
poison index =  84
499
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 00:55:43, Val iteration 0, acc 96.200 (96.200)
2021-06-12 00:55:50, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-12 00:55:51, Epoch 0, Iteration 7, loss 0.616 (0.712), acc 82.692 (80.200)
2021-06-12 00:56:24, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6]
Target sample: 1, Prediction:1, Target's Score:[0.5737448, 6.459845, -4.2694774, -0.981825, -1.9125417, -4.2312417, 1.1543462, 1.3755971, 0.7680446, 1.1660714]
Target sample: 7, Prediction:8, Target's Score:[-2.3593106, 4.3831077, -3.8507862, -2.1856866, -1.6496384, -3.4217246, 4.986738, -2.2701552, 6.515014, -0.029281426]
Target sample: 13, Prediction:6, Target's Score:[-1.2205952, 5.719983, -4.5674105, 0.36609468, -1.6528515, -4.510749, 7.142186, -0.85369706, -0.2571218, -0.068960056]
Target sample: 19, Prediction:1, Target's Score:[0.44546184, 10.511103, -5.484033, -1.6865594, -0.6942564, -5.2326994, 2.2064238, -1.5598145, 0.9854216, 0.6329754]
Target sample: 25, Prediction:1, Target's Score:[1.1014813, 5.7769094, -4.6056848, -2.8483496, -2.4901369, -4.5431223, 4.335453, -1.8887258, 3.192393, 2.0846298]
Target sample: 31, Prediction:6, Target's Score:[0.50337934, 4.8472686, -4.151146, -2.9946625, -2.1483672, -4.147547, 5.3403416, -1.5980991, 4.9782023, -0.5202908]
Target sample: 37, Prediction:8, Target's Score:[2.9384432, 2.2218683, -4.7133136, -2.3373282, -2.7727904, -4.252325, 4.9720807, -2.4430552, 7.583975, -1.0859002]
Target sample: 43, Prediction:6, Target's Score:[1.0176425, 4.644384, -4.878602, -0.91253465, -2.5999205, -4.5507174, 5.2853584, -2.485839, 4.483094, 0.109673336]
Target sample: 49, Prediction:1, Target's Score:[-1.9550151, 6.4683766, -4.2838063, 1.3482507, -1.4125594, -3.7477286, 4.482823, -3.0062652, 1.7719905, 0.4482568]
Target sample: 55, Prediction:1, Target's Score:[-0.15882479, 4.1561475, -4.2865024, 4.105219, -3.9490027, -4.827152, 3.3017898, -1.4053775, 3.2035244, -0.018331338]
Target sample: 61, Prediction:6, Target's Score:[-2.1907454, 2.7846744, -3.035033, 1.0610888, -1.1194397, -4.123728, 3.634282, 1.0841537, 3.3703558, -1.3624796]
Target sample: 67, Prediction:6, Target's Score:[0.6625753, 2.520398, -4.423015, -0.069032565, -0.15880188, -4.6168556, 5.976851, -2.3946142, 4.989338, -2.3826838]
Target sample: 73, Prediction:1, Target's Score:[1.0108712, 5.7990565, -5.191517, 1.8959548, -2.686678, -5.3472104, 3.783455, 0.15493529, 1.3455731, -0.65615135]
Target sample: 79, Prediction:1, Target's Score:[-1.0301656, 11.0497675, -4.869494, -0.8491752, -2.872627, -5.0544868, 2.5314999, -2.1855896, 2.0319808, 1.3790301]
Target sample: 85, Prediction:8, Target's Score:[4.32228, 3.266535, -4.4913626, -0.64806986, -1.8031119, -4.6611533, 1.9410467, -2.9001122, 4.884853, 0.2007689]
Target sample: 91, Prediction:8, Target's Score:[-3.02506, 5.3027205, -5.274362, -0.49112073, -3.6245363, -4.5117545, 2.8754888, -1.9834667, 7.425054, 3.4502609]
Target sample: 97, Prediction:1, Target's Score:[1.0370176, 6.5643897, -4.7728434, -1.2933835, -3.1085186, -4.398311, 1.052655, -3.4290152, 5.864686, 2.613219]
Target sample: 103, Prediction:8, Target's Score:[3.653519, 0.75423276, -3.4948308, -0.5048866, -1.9120599, -4.2590938, 2.1878276, -2.1293967, 5.1745963, 0.6353517]
Target sample: 109, Prediction:1, Target's Score:[-1.3649174, 13.385207, -4.883892, -1.3646065, -3.3133328, -4.7672706, 1.4523958, -2.4900682, -0.26635444, 3.7459376]
Target sample: 115, Prediction:1, Target's Score:[-2.6863682, 6.525049, -4.4129286, -1.8528793, -2.0802412, -1.7030767, 4.7602935, -2.6144824, 1.5597332, 2.6270008]
Target sample: 121, Prediction:1, Target's Score:[-2.5516386, 6.101229, -2.7472267, 0.4799502, -0.2668364, -3.0434937, 0.23754925, -0.17890614, 0.7655072, 1.312426]
Target sample: 127, Prediction:8, Target's Score:[-2.4752214, 4.0841327, -4.117354, -1.6026034, -2.485635, -4.3338923, 1.165955, -1.7779003, 7.5862217, 4.0881405]
Current ATTACK acc on target samples: 22.727
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 00:56:56 Epoch 59, Val iteration 0, acc 92.600 (92.600)
2021-06-12 00:57:03 Epoch 59, Val iteration 19, acc 94.000 (93.020)
* Prec: 93.02000160217285
Per class accuracy =  [0.94784657 0.96397986 0.8789039  0.8646801  0.94566682 0.90145433
 0.95477179 0.93157898 0.96245685 0.94988651]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 4, 1, 8, 1, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 6, 8, 1, 6, 1, 1, 1, 1, 1, 8, 8, 8, 1, 1, 6, 6, 1, 8, 6, 1, 1, 1, 1, 1, 6, 6, 6, 8, 6, 8, 8, 8, 8, 8, 8, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 8, 8, 8, 8, 8, 1, 8, 8, 9, 8, 1, 8, 0, 0, 6, 9, 9, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 4, 8, 8, 1, 1, 8, 8
ATTACK acc: 14.953271028037383
------SUMMARY POST DEFENSE------
TIME ELAPSED (mins): 11
TARGET INDEX: 17
ResNet50 18.181818181818183 9.345794392523365 95.46000137329102 90.83000183105469 80.0
DPN92 9.090909090909092 6.542056074766355 95.50000267028808 93.08000183105469 60.0
MobileNetV2 40.90909090909091 49.532710280373834 91.22000160217286 89.77000160217285 0.0
GoogLeNet 22.727272727272727 14.953271028037383 95.41000213623047 93.02000160217285 80.0
True False False False True
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.200-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.250-droplayer0.000-seed1226.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for SENet18..
./../models-chks-release/ckpt-SENet18-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800-dp0.300-droplayer0.000.t7
==> Resuming from checkpoint for ResNeXt29_2x64d..
./../models-chks-release/ckpt-ResNeXt29_2x64d-4800-dp0.300-droplayer0.000.t7
subs nets, effective num: 12
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
No specific indices are determined, so try to include whatever we find
In total, we found 106 images of target 19
All target indices used in crafting poisons: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103]
Namespace(ce_loss_flag=False, chk_path='attack-results/100-overlap/end2end-training', chk_subdir='poisons', device='cuda', dset_path='datasets', end2end=True, eval_poison_path='', eval_poisons_root='', feat_reg_flag=False, gpu='1', lr_decay_epoch=[30, 45], max_loss_flag=False, mode='mean', model_resume_path='../models-chks-release', multi_flag=True, nearest=False, net_repeat=1, num_per_class=50, original_grad=True, poison_decay_ites=[], poison_decay_ratio=0.1, poison_epsilon=0.1, poison_ites=1000, poison_label=6, poison_lr=0.04, poison_momentum=0.9, poison_num=5, poison_opt='adam', resume_poison_ite=0, retrain_bsize=64, retrain_epochs=60, retrain_lr=0.0001, retrain_momentum=0.9, retrain_opt='adam', retrain_wd=0.0005, subs_chk_name=['ckpt-%s-4800-dp0.200-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.250-droplayer0.000-seed1226.t7', 'ckpt-%s-4800-dp0.300-droplayer0.000.t7'], subs_dp=[0.2, 0.25, 0.3], subset_group=0, substitute_nets=['DPN92', 'SENet18', 'ResNet50', 'ResNeXt29_2x64d'], target_end=-1, target_index=19, target_label=1, target_num=20, target_path='../datasets/epfl-gims08/resized/tripod_seq', target_start=-1, test_chk_name='ckpt-%s-4800.t7', tol=1e-06, train_data_path='../datasets/CIFAR10_TRAIN_Split.pth', victim_net=['ResNet50', 'DPN92', 'MobileNetV2', 'GoogLeNet'])
Path: attack-results/100-overlap/end2end-training/mean/1000/19/target-num-20
Selected base image indices: [74, 80, 84, 86, 89]
Target indices: [1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85, 91, 97, 103]
# Targets: 18, # Poisons: 5
Loading the targets features in the subst. nets, each target is averaged for 20 times
Loading the targets features in the subst. nets, each target is averaged for 20 times
Ready for making the poisons, mode: mean
 2021-06-12 00:57:20 Iteration 0 	 Training Loss: 9.746e-01 	 Loss in Target Net: 1.133e+00	  
 2021-06-12 00:57:54 Iteration 50 	 Training Loss: 4.536e-01 	 Loss in Target Net: 3.862e-01	  
 2021-06-12 00:58:27 Iteration 100 	 Training Loss: 4.254e-01 	 Loss in Target Net: 3.924e-01	  
 2021-06-12 00:59:02 Iteration 150 	 Training Loss: 4.140e-01 	 Loss in Target Net: 4.039e-01	  
 2021-06-12 00:59:38 Iteration 200 	 Training Loss: 4.042e-01 	 Loss in Target Net: 3.995e-01	  
 2021-06-12 01:00:11 Iteration 250 	 Training Loss: 4.075e-01 	 Loss in Target Net: 3.982e-01	  
 2021-06-12 01:00:45 Iteration 300 	 Training Loss: 4.009e-01 	 Loss in Target Net: 4.049e-01	  
 2021-06-12 01:01:18 Iteration 350 	 Training Loss: 4.017e-01 	 Loss in Target Net: 4.157e-01	  
 2021-06-12 01:01:51 Iteration 400 	 Training Loss: 3.967e-01 	 Loss in Target Net: 4.238e-01	  
 2021-06-12 01:02:25 Iteration 450 	 Training Loss: 3.946e-01 	 Loss in Target Net: 3.927e-01	  
 2021-06-12 01:02:58 Iteration 500 	 Training Loss: 3.973e-01 	 Loss in Target Net: 4.275e-01	  
 2021-06-12 01:03:32 Iteration 550 	 Training Loss: 3.966e-01 	 Loss in Target Net: 4.100e-01	  
 2021-06-12 01:04:06 Iteration 600 	 Training Loss: 3.961e-01 	 Loss in Target Net: 4.013e-01	  
 2021-06-12 01:04:41 Iteration 650 	 Training Loss: 3.948e-01 	 Loss in Target Net: 4.107e-01	  
 2021-06-12 01:05:15 Iteration 700 	 Training Loss: 3.973e-01 	 Loss in Target Net: 3.969e-01	  
 2021-06-12 01:05:53 Iteration 750 	 Training Loss: 3.985e-01 	 Loss in Target Net: 4.104e-01	  
 2021-06-12 01:06:27 Iteration 800 	 Training Loss: 3.962e-01 	 Loss in Target Net: 4.031e-01	  
 2021-06-12 01:07:00 Iteration 850 	 Training Loss: 3.942e-01 	 Loss in Target Net: 4.143e-01	  
 2021-06-12 01:07:33 Iteration 900 	 Training Loss: 3.929e-01 	 Loss in Target Net: 4.067e-01	  
 2021-06-12 01:08:08 Iteration 950 	 Training Loss: 3.997e-01 	 Loss in Target Net: 4.282e-01	  
 2021-06-12 01:08:41 Iteration 999 	 Training Loss: 3.961e-01 	 Loss in Target Net: 4.259e-01	  
Evaluating against victims networks
ResNet50
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 01:08:44, Val iteration 0, acc 94.200 (94.200)
2021-06-12 01:08:50, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-12 01:08:52, Epoch 0, Iteration 7, loss 0.358 (0.293), acc 90.385 (93.200)
2021-06-12 01:09:20, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:6, Target's Score:[-1.8586036, 5.4334054, -3.207716, -0.19971336, -1.8686672, -0.7617242, 7.0817122, -2.6110866, 0.60554904, -2.264583]
Target sample: 7, Prediction:6, Target's Score:[-2.5574672, 6.4458766, -3.081671, -0.22798206, -1.5834439, -1.4743007, 8.336997, -2.874918, 0.3083154, -2.9297466]
Target sample: 13, Prediction:1, Target's Score:[-1.7414652, 9.772945, -1.3808559, -2.120555, -2.9728823, -2.98761, 7.7589345, -3.2185965, -0.6937996, -2.0171542]
Target sample: 19, Prediction:1, Target's Score:[-1.2791302, 7.5576997, -2.87195, -0.71164095, -2.7946756, -1.7182403, 6.8136864, -2.685185, 0.49873883, -2.470283]
Target sample: 25, Prediction:6, Target's Score:[-2.6144435, 4.201358, -2.6686397, -0.6439374, -2.1764286, -2.0784287, 6.1560235, -2.906019, 5.946745, -2.9375765]
Target sample: 31, Prediction:6, Target's Score:[-2.1860197, 3.4470837, -2.9861555, -0.20922296, -1.4147743, -1.6878554, 7.5262337, -2.0258806, 2.5654316, -2.7458572]
Target sample: 37, Prediction:9, Target's Score:[-0.9555019, 3.0888107, -2.2645638, 3.003842, -2.818579, -0.99213856, 1.6451535, -2.7475984, -2.038971, 4.505951]
Target sample: 43, Prediction:6, Target's Score:[-1.8087491, 2.4851112, -2.3771648, -0.6365921, 2.3063512, -0.9554577, 7.5064545, -3.3972375, -1.77022, -0.9483345]
Target sample: 49, Prediction:1, Target's Score:[-3.4353561, 10.079611, -1.952206, -0.8226854, -2.9348922, -2.8475447, 5.291869, -3.1838717, -0.19984028, 0.4186609]
Target sample: 55, Prediction:1, Target's Score:[-3.0047016, 10.000127, -2.7632742, -0.963636, -3.0388713, -2.394414, 8.314739, -3.5368009, 0.021270439, -2.2161267]
Target sample: 61, Prediction:6, Target's Score:[-1.2462419, 7.4051595, -2.626145, -1.1605, -2.5134668, -2.0301185, 8.583003, -3.2084556, -0.62281704, -2.1781561]
Target sample: 67, Prediction:6, Target's Score:[-2.2878242, 6.3723893, -2.6055968, -0.41098657, -2.1322234, -1.4202776, 7.680747, -2.3531616, -0.9213748, -1.5464771]
Target sample: 73, Prediction:6, Target's Score:[-1.0433801, 4.3277645, -3.2057092, -0.95217067, -1.6105658, -1.9633442, 7.183909, -1.7245312, 2.9028132, -3.6302311]
Target sample: 79, Prediction:6, Target's Score:[-1.5585898, 4.648317, -3.1509237, -0.18371668, -1.8887125, -0.66317683, 7.3925247, -2.7003088, 1.3162409, -2.8960278]
Target sample: 85, Prediction:6, Target's Score:[-0.15681271, 5.6569614, -3.5966997, -0.301809, -1.9290857, -1.6672201, 8.828825, -2.1284003, -0.25826707, -4.0749865]
Target sample: 91, Prediction:6, Target's Score:[-2.7031503, 7.0710826, -1.0868615, 0.058617607, -0.84677994, -1.709483, 7.0879893, -4.083134, -1.8695233, -1.4907607]
Target sample: 97, Prediction:1, Target's Score:[-2.7114851, 7.0155926, -2.7093277, -0.6932865, -1.7679485, -1.2963446, 7.012887, -2.775399, -0.8232905, -0.86124694]
Target sample: 103, Prediction:6, Target's Score:[-2.4484894, 5.672027, -2.5001822, 0.8330304, -1.6971521, -1.5903181, 6.674919, -2.8744566, 0.25953123, -1.995538]
Current ATTACK acc on target samples: 66.667
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 01:09:48 Epoch 59, Val iteration 0, acc 91.200 (91.200)
2021-06-12 01:09:53 Epoch 59, Val iteration 19, acc 92.800 (92.420)
* Prec: 92.42000122070313
Per class accuracy =  [0.94738949 0.94885388 0.91610729 0.84619558 0.9248086  0.87211793
 0.954192   0.93257143 0.95950688 0.94242638]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 1, 1, 1, 6, 6, 1, 1, 1, 1, 6, 1, 1, 1, 1, 6, 6, 6, 6, 8, 1, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 1, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 1, 6, 6, 1, 6, 1, 6, 1, 6, 6, 6, 1, 1, 1
ATTACK acc: 57.95454545454545
--------
DPN92
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 01:10:00, Val iteration 0, acc 94.800 (94.800)
2021-06-12 01:10:12, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-12 01:10:19, Epoch 0, Iteration 7, loss 0.738 (0.594), acc 80.769 (88.400)
2021-06-12 01:11:45, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:1, Target's Score:[-1.2434685, 7.6751423, -1.4288259, -2.0573318, -1.9978994, -2.5943542, 7.6005697, -3.3961823, -0.9818223, -1.2930012]
Target sample: 7, Prediction:1, Target's Score:[-0.8340161, 8.37032, -1.2363983, -2.073021, -2.4782073, -2.5420024, 5.428976, -2.423313, -1.5795244, -0.36786032]
Target sample: 13, Prediction:9, Target's Score:[-0.23783903, 5.3492365, -1.7202463, -2.480225, -1.6094778, -2.9089355, 3.4491622, -3.3545666, -2.2490423, 6.033039]
Target sample: 19, Prediction:6, Target's Score:[1.7772111, 4.6035886, -0.9964005, -1.4674413, -2.3849502, -3.739493, 5.875724, -3.5218923, 0.8299496, -0.7321757]
Target sample: 25, Prediction:8, Target's Score:[2.541375, 1.7136202, -1.4776217, -2.1834762, -2.4904716, -3.8604283, 3.8967743, -3.3119211, 5.9019313, -0.5042211]
Target sample: 31, Prediction:6, Target's Score:[3.058596, 1.8598204, -1.173321, -2.1909332, -1.6385254, -4.403877, 6.921616, -3.5504725, 2.7998395, -1.4562011]
Target sample: 37, Prediction:9, Target's Score:[-0.7059875, 3.468447, -2.0306482, -0.90128857, -1.4067596, -3.8744862, 4.2444196, -3.8293164, -0.028861089, 5.3390627]
Target sample: 43, Prediction:6, Target's Score:[-1.1343963, 1.1552672, -0.983918, -0.6594175, -0.18027003, -2.8076074, 10.605146, -2.3074586, -1.7550457, -1.7221332]
Target sample: 49, Prediction:1, Target's Score:[-0.812709, 11.791503, -2.0739205, -3.4007056, -3.1488738, -3.6395955, 5.9563704, -3.6859398, -2.1147673, 1.4548136]
Target sample: 55, Prediction:6, Target's Score:[-1.2417991, 7.4410114, -1.5736684, -2.3471756, -1.8693311, -3.0314589, 8.977112, -3.4576957, -2.360036, -0.25298187]
Target sample: 61, Prediction:6, Target's Score:[1.912173, 3.946324, -1.9013443, -2.5447655, -0.67610073, -2.8790815, 5.722594, -3.140327, -1.8784741, 1.6770316]
Target sample: 67, Prediction:1, Target's Score:[0.9709196, 5.0958066, -1.1033232, -2.2067647, -0.28878585, -3.334506, 4.8467174, -3.1536157, -0.5913587, 0.00043057464]
Target sample: 73, Prediction:6, Target's Score:[3.121754, 2.6401958, -0.6507513, -2.0687659, -1.9945927, -4.3103423, 6.4736586, -3.4896986, 2.0696032, -1.5574993]
Target sample: 79, Prediction:1, Target's Score:[2.4497685, 5.01288, -1.504751, -2.1088223, -2.6013286, -3.7630546, 3.73751, -3.4910004, 3.273278, -0.7523107]
Target sample: 85, Prediction:6, Target's Score:[3.8262389, 2.4549048, -1.4435277, -2.182222, -1.4874285, -3.238174, 5.8388996, -2.8229167, 1.1641153, -1.8885058]
Target sample: 91, Prediction:1, Target's Score:[-1.1875868, 8.550689, -2.0569775, -2.1190245, -2.2643352, -2.7450688, 6.725567, -2.9938707, -2.7031949, 1.0873994]
Target sample: 97, Prediction:1, Target's Score:[-1.2294201, 7.9244123, -1.0493138, -1.6319317, -2.1609685, -2.9376917, 6.596671, -3.2809935, -1.5667133, -0.38176167]
Target sample: 103, Prediction:1, Target's Score:[-0.4232211, 8.143277, -0.99769545, -2.1559694, -2.6183279, -2.7423122, 3.8440778, -2.7160616, -1.1971394, 1.1160395]
Current ATTACK acc on target samples: 38.889
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 01:13:09 Epoch 59, Val iteration 0, acc 91.800 (91.800)
2021-06-12 01:13:20 Epoch 59, Val iteration 19, acc 93.600 (92.860)
* Prec: 92.8600009918213
Per class accuracy =  [0.96069087 0.96596254 0.91439195 0.87175351 0.93651617 0.8704307
 0.94583219 0.92182516 0.94293498 0.96040201]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 6, 1, 1, 1, 1, 1, 1, 1, 1, 9, 0, 1, 1, 1, 1, 1, 1, 6, 8, 6, 8, 6, 6, 6, 6, 6, 6, 1, 6, 6, 6, 6, 6, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 1, 6, 6, 1, 1, 1, 1, 1, 8, 6, 6, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 1, 6, 6, 1, 1, 1, 6, 6, 1, 1, 1, 1, 6, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 42.04545454545455
--------
MobileNetV2
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 01:13:23, Val iteration 0, acc 92.600 (92.600)
2021-06-12 01:13:26, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-12 01:13:27, Epoch 0, Iteration 7, loss 0.212 (0.340), acc 90.385 (90.000)
2021-06-12 01:13:42, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:8, Target's Score:[0.632664, 1.5522618, 0.014984146, 2.0141134, -4.1501513, -3.491104, 2.8908708, -6.582566, 9.134502, -1.7001117]
Target sample: 7, Prediction:8, Target's Score:[-0.5355494, 1.015597, -1.4010999, 3.1313224, -4.9237866, -2.0619586, 5.0276947, -6.368978, 7.33093, -0.9251144]
Target sample: 13, Prediction:6, Target's Score:[-1.2998145, 1.7924429, -2.4102955, 4.011598, -1.8631065, -2.9286525, 8.3403635, -5.8659863, 1.0232291, -0.5114869]
Target sample: 19, Prediction:0, Target's Score:[6.379332, 1.4692241, -2.9904268, 0.5409338, -1.3005573, -3.8940356, 0.2051316, -3.0481608, 3.7643726, -0.8921449]
Target sample: 25, Prediction:8, Target's Score:[4.1349597, 1.3677758, -2.026266, 3.423931, -1.9609777, -3.8098621, -1.9024029, -3.0692928, 4.48519, -0.39245892]
Target sample: 31, Prediction:1, Target's Score:[1.9415046, 4.9075494, -3.637392, 2.7554312, -4.5157037, -4.270436, 2.055653, -3.5774446, 4.0202413, 0.5852717]
Target sample: 37, Prediction:6, Target's Score:[0.3198173, 2.034031, -3.6534631, 3.0475287, -1.5993845, -3.2858326, 4.8832192, -4.3784647, -1.1716177, 4.103029]
Target sample: 43, Prediction:6, Target's Score:[-0.3627351, -0.7653337, -2.1604285, 5.3327413, -3.7134855, -1.2294831, 10.996464, -5.9130945, -1.8486383, -0.09828371]
Target sample: 49, Prediction:1, Target's Score:[1.3475338, 7.923435, -1.651996, -1.6321143, -5.20658, -2.9069207, 2.7600844, -5.0208817, 3.7437892, 0.93068427]
Target sample: 55, Prediction:1, Target's Score:[-1.3906732, 6.0723224, -2.1483727, 2.758554, -5.439209, -0.8908761, 5.6815963, -6.498088, 2.0254707, 0.13928868]
Target sample: 61, Prediction:6, Target's Score:[-0.50734854, 0.92611605, -3.0283883, 5.753763, -1.3686137, -1.2967424, 10.162769, -4.696682, -2.5122356, -3.1736362]
Target sample: 67, Prediction:4, Target's Score:[2.6709716, 0.917831, -4.0385094, 2.8154852, 4.618382, -1.5925053, -0.43601367, -1.0704288, -0.88409996, -2.6793973]
Target sample: 73, Prediction:1, Target's Score:[3.2173553, 4.173259, -2.7431176, 2.6253629, -2.8185146, -3.7682467, 2.063637, -3.944839, 2.085092, -0.6341674]
Target sample: 79, Prediction:3, Target's Score:[1.4264301, 3.7113276, -4.296984, 4.7250767, -3.0727825, -2.5793967, 1.7943296, -2.6190634, -1.2764151, 2.4640875]
Target sample: 85, Prediction:6, Target's Score:[4.524002, -0.46651918, -2.4527555, 2.533558, -3.545037, -4.3988137, 9.622447, -5.139103, 3.881416, -4.327632]
Target sample: 91, Prediction:6, Target's Score:[1.3708909, 2.167248, -1.3599683, 2.9469693, -3.3204303, -0.3789974, 7.9276805, -5.9385715, -2.2392583, -0.93404865]
Target sample: 97, Prediction:8, Target's Score:[-0.81322145, 0.6581023, -0.8115266, 1.3553419, -2.3129594, -3.0422847, 3.2973669, -6.393358, 9.29104, -0.9149038]
Target sample: 103, Prediction:8, Target's Score:[0.5587371, 2.3270097, -2.7375228, 4.0539346, -2.6456661, -1.5980533, 0.8857269, -4.2780867, 4.7256174, -1.0187142]
Current ATTACK acc on target samples: 33.333
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 01:13:57 Epoch 59, Val iteration 0, acc 89.600 (89.600)
2021-06-12 01:14:01 Epoch 59, Val iteration 19, acc 90.200 (89.280)
* Prec: 89.28000183105469
Per class accuracy =  [0.91966783 0.9274073  0.83059913 0.823209   0.89150946 0.82198145
 0.93975605 0.89165432 0.93063716 0.9471063 ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 8, 6, 3, 6, 6, 1, 1, 3, 0, 6, 6, 0, 0, 0, 0, 8, 3, 3, 8, 8, 1, 3, 3, 8, 0, 6, 6, 6, 6, 3, 6, 6, 6, 6, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 1, 1, 6, 3, 6, 1, 1, 0, 0, 0, 0, 0, 8, 1, 1, 1, 6, 6, 1, 6, 6, 6, 6, 6, 6, 6, 6, 0, 6, 6, 1, 1, 6, 1, 8, 8, 6, 8, 6, 6, 8, 1
ATTACK acc: 39.77272727272727
--------
GoogLeNet
Using Adam for retraining
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 01:14:05, Val iteration 0, acc 96.200 (96.200)
2021-06-12 01:14:12, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-12 01:14:14, Epoch 0, Iteration 7, loss 0.765 (0.926), acc 78.846 (77.600)
2021-06-12 01:14:47, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6, 6, 6, 6]
Target sample: 1, Prediction:8, Target's Score:[-2.4442623, 0.71026105, -2.3094602, -0.06256453, -1.4060315, 0.35582668, 3.0172155, -2.824642, 6.2936587, -1.4485453]
Target sample: 7, Prediction:6, Target's Score:[-2.2062871, -0.17052, -3.090467, -1.0926718, -1.1533742, 2.3881834, 4.93121, -1.9709129, 3.921144, -1.6599576]
Target sample: 13, Prediction:1, Target's Score:[-1.3404472, 6.598996, -4.057083, -0.90635, -2.9191623, 1.6201626, 3.828435, -2.296496, -0.25267923, -0.33251157]
Target sample: 19, Prediction:0, Target's Score:[3.6507642, 1.4308648, -1.8886275, -0.56675196, -2.756124, -0.30376932, 3.2768626, -2.3470523, 1.4708028, -2.0643]
Target sample: 25, Prediction:6, Target's Score:[-0.9980958, 0.27317598, -2.9914386, -1.0060892, -1.3225005, 2.455513, 3.3803663, -1.2241228, 2.7449334, -1.3957263]
Target sample: 31, Prediction:6, Target's Score:[1.463002, 1.1694273, -3.2676299, -1.0068234, -1.3911799, 1.1241258, 3.3593984, -1.8271481, 1.067582, -0.7671126]
Target sample: 37, Prediction:5, Target's Score:[-0.19790123, 1.2457455, -3.495615, -0.02883709, -1.719014, 2.650269, 1.3537948, -2.4419188, 1.6047374, 0.96702635]
Target sample: 43, Prediction:6, Target's Score:[0.34658143, -0.5951829, -2.9229639, -0.7692009, -1.3729696, 2.47259, 3.8002734, -2.0302713, 3.0911005, -2.1198132]
Target sample: 49, Prediction:6, Target's Score:[-1.522772, 0.21238066, -1.7615852, -1.3684824, -2.1213539, 0.8921702, 5.920203, -2.4391177, 3.3433292, -1.2603269]
Target sample: 55, Prediction:6, Target's Score:[-3.906497, 2.4590235, -3.014835, 0.94149727, -2.4879906, 1.3283675, 5.5020533, -2.5547292, 2.3875644, -0.7506913]
Target sample: 61, Prediction:6, Target's Score:[-0.62335116, 0.9162535, -3.0485134, -0.39310366, -2.0970166, 1.7629946, 6.480881, -2.091324, 1.2900819, -2.2902462]
Target sample: 67, Prediction:5, Target's Score:[-0.08851888, 1.0684692, -2.5134344, 0.5137746, -2.2964914, 2.5567415, 2.2831643, -1.9700825, 0.98882025, -0.6101819]
Target sample: 73, Prediction:6, Target's Score:[2.4107862, 0.9567005, -2.6698387, 0.281372, -2.5044022, 0.5598516, 2.4212244, -2.1445277, 1.6206895, -1.0158547]
Target sample: 79, Prediction:6, Target's Score:[-0.9769977, 2.8761768, -2.521939, -0.23281121, -2.1698055, 1.6878734, 3.1236274, -2.2864993, 1.3906466, -0.9575956]
Target sample: 85, Prediction:6, Target's Score:[2.9558089, 0.6033481, -3.3435965, -0.17722458, -2.283804, 0.8772705, 4.944101, -1.7332122, 0.40739655, -2.3470078]
Target sample: 91, Prediction:1, Target's Score:[-1.3892491, 3.2629406, -1.9773947, 1.0113343, -2.031766, 3.2566285, 1.3764758, -2.7830012, -0.06864256, -0.7169601]
Target sample: 97, Prediction:8, Target's Score:[-3.0691073, 2.3776143, -3.0926204, 0.5073654, -2.2585752, 0.6710639, 2.414994, -2.1839974, 4.3900976, 0.15079632]
Target sample: 103, Prediction:8, Target's Score:[-2.089736, -0.9256429, -2.5394657, -0.1956153, -0.7231687, 3.0234184, 1.4448975, -2.0631862, 5.2556543, -1.2886844]
Current ATTACK acc on target samples: 55.556
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 01:15:19 Epoch 59, Val iteration 0, acc 91.800 (91.800)
2021-06-12 01:15:25 Epoch 59, Val iteration 19, acc 92.000 (91.920)
* Prec: 91.92000122070313
Per class accuracy =  [0.93192416 0.93681404 0.87863837 0.8625358  0.93779858 0.86453373
 0.95568757 0.9306259  0.96422328 0.92861609]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 8, 8, 8, 6, 1, 1, 1, 3, 0, 1, 1, 1, 1, 6, 8, 8, 8, 8, 1, 8, 6, 6, 6, 6, 6, 6, 6, 5, 6, 6, 3, 6, 6, 1, 1, 8, 3, 8, 8, 8, 8, 8, 6, 6, 5, 1, 1, 6, 6, 1, 8, 8, 8, 8, 6, 5, 6, 6, 6, 6, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 1, 1, 6, 6, 1, 6, 8, 8, 8, 8, 6, 8, 8, 6, 1, 1
ATTACK acc: 40.90909090909091
--------
------SUMMARY PRE DEFENSE------
TIME ELAPSED (mins): 11
TARGET INDEX: 19
ResNet50 66.66666666666667 57.95454545454545 95.46000137329102 92.42000122070313
DPN92 38.888888888888886 42.04545454545455 95.50000267028808 92.8600009918213
MobileNetV2 33.333333333333336 39.77272727272727 91.22000160217286 89.28000183105469
GoogLeNet 55.55555555555556 40.90909090909091 95.41000213623047 91.92000122070313
DEFENSE EVALUATION
2000
poison index =  74
poison index =  80
poison index =  84
poison index =  86
poison index =  89
495
Loading the victims networks
==> Resuming from checkpoint for ResNet50..
./../models-chks-release/ckpt-ResNet50-4800.t7
==> Resuming from checkpoint for DPN92..
./../models-chks-release/ckpt-DPN92-4800.t7
==> Resuming from checkpoint for MobileNetV2..
./../models-chks-release/ckpt-MobileNetV2-4800.t7
==> Resuming from checkpoint for GoogLeNet..
./../models-chks-release/ckpt-GoogLeNet-4800.t7
ResNet50
[74, 80, 86, 89] 4
Using Adam for retraining
2000
poison index =  84
499
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 01:15:30, Val iteration 0, acc 94.200 (94.200)
2021-06-12 01:15:35, Val iteration 19, acc 96.600 (95.460)
Per class accuracy =  [0.95889125 0.98506636 0.93625597 0.89538435 0.96185773 0.92609533
 0.97286416 0.96868115 0.97116548 0.97204442]
* Prec: 95.46000137329102
-----------------------------
2021-06-12 01:15:36, Epoch 0, Iteration 7, loss 0.497 (0.859), acc 86.538 (84.000)
2021-06-12 01:16:04, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6]
Target sample: 1, Prediction:1, Target's Score:[-0.20594548, 7.4069934, -2.899091, -1.2521731, -2.719399, -1.8351232, 2.2030337, -2.0119271, 1.2099794, 0.15732671]
Target sample: 7, Prediction:1, Target's Score:[-0.093090214, 8.556642, -2.8884187, -1.346463, -2.8053334, -2.1021278, 1.7378646, -1.8258541, 1.7375907, -0.92352873]
Target sample: 13, Prediction:1, Target's Score:[1.2037946, 7.116942, -2.5430052, -2.0708888, -2.8239043, -2.608882, 0.9924692, -1.7752012, 0.78778577, 1.7406265]
Target sample: 19, Prediction:1, Target's Score:[1.9402514, 8.784354, -3.278565, -1.0153632, -3.6498787, -1.7239249, 0.074456304, -1.9243873, 0.44556937, 0.35134932]
Target sample: 25, Prediction:8, Target's Score:[0.43554744, 4.2046995, -3.039766, -2.1964524, -2.6566014, -2.6293817, 0.19952841, -1.8613079, 8.372528, -0.8164917]
Target sample: 31, Prediction:1, Target's Score:[0.31028566, 7.716087, -3.442063, -2.5683184, -2.6600025, -2.8124847, 1.0957551, -1.1738509, 4.5123954, -0.94244456]
Target sample: 37, Prediction:9, Target's Score:[0.09429347, 3.4615905, -2.7848446, -0.6765369, -2.6331537, -1.5561658, 2.4498193, -2.0393643, -2.0108178, 5.709043]
Target sample: 43, Prediction:1, Target's Score:[0.36859736, 4.191875, -2.293241, -0.70496625, -1.8222312, -1.7820673, 3.3274035, -2.1378229, -1.4521413, 2.36253]
Target sample: 49, Prediction:1, Target's Score:[-2.3408523, 15.4355955, -4.064407, -3.4844925, -3.4447627, -3.6148553, 2.4054623, -2.2293494, -0.30185914, 1.6975176]
Target sample: 55, Prediction:1, Target's Score:[-2.1844466, 15.725839, -3.9013712, -2.9871, -3.4168968, -3.4236178, 2.7205398, -2.1213217, -0.261673, -0.081796825]
Target sample: 61, Prediction:1, Target's Score:[0.29822484, 7.4549, -2.6161637, -2.0315585, -2.307391, -2.69267, 1.7182176, -2.120155, 0.46071076, 1.8649625]
Target sample: 67, Prediction:1, Target's Score:[-0.99063057, 6.8555527, -2.3658752, -1.510383, -2.230376, -1.9224782, 3.5069342, -1.898991, -1.592535, 2.217765]
Target sample: 73, Prediction:1, Target's Score:[0.6932704, 6.4417996, -3.25344, -2.3483627, -2.5842946, -2.7009532, 0.86866325, -1.2838119, 5.345659, -1.1495179]
Target sample: 79, Prediction:1, Target's Score:[-0.018457608, 9.274999, -3.2780526, -2.2255995, -2.7033162, -2.4021559, 1.4354863, -1.1613958, 2.311433, -1.1908233]
Target sample: 85, Prediction:1, Target's Score:[0.36696103, 10.445365, -2.8668945, -2.287158, -2.7838774, -2.4294813, 1.2307314, -1.4511032, 0.20691417, -0.40181467]
Target sample: 91, Prediction:1, Target's Score:[0.12888114, 7.2367177, -1.9010092, -0.9660059, -2.2629828, -1.2452396, 2.2233007, -2.086797, -1.2157717, 0.13712937]
Target sample: 97, Prediction:1, Target's Score:[-0.7198898, 9.251555, -3.2044659, -1.8465257, -2.6552193, -2.3998406, 2.342027, -1.9408095, -0.15816623, 1.3807114]
Target sample: 103, Prediction:1, Target's Score:[-0.87939906, 8.602144, -2.8952672, -1.1740606, -2.5946271, -1.7635673, 2.3650272, -1.7857118, 0.8069959, -0.6200661]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 01:16:32 Epoch 59, Val iteration 0, acc 90.400 (90.400)
2021-06-12 01:16:38 Epoch 59, Val iteration 19, acc 90.400 (90.340)
* Prec: 90.34000167846679
Per class accuracy =  [0.91827762 0.94311841 0.81667765 0.83431318 0.88785839 0.8739247
 0.94794299 0.90951869 0.95119353 0.95114177]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 8, 1, 1, 1, 1, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 0.0
DPN92
[74, 80, 84, 89] 28
Using Adam for retraining
2000
poison index =  86
499
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 01:16:41, Val iteration 0, acc 94.800 (94.800)
2021-06-12 01:16:53, Val iteration 19, acc 95.200 (95.500)
Per class accuracy =  [0.96370033 0.98454137 0.94218363 0.91015204 0.95868342 0.90909132
 0.97066869 0.97259956 0.96703901 0.97279654]
* Prec: 95.50000267028808
-----------------------------
2021-06-12 01:16:56, Epoch 0, Iteration 7, loss 0.437 (0.553), acc 86.538 (88.200)
2021-06-12 01:18:22, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6]
Target sample: 1, Prediction:1, Target's Score:[-2.8293228, 8.200966, -2.9294145, -1.030451, -1.3015788, -2.583845, 3.9793892, -3.7853956, 2.977459, -0.48806596]
Target sample: 7, Prediction:1, Target's Score:[-1.7338322, 9.501856, -2.8824286, -1.8467647, -2.0621517, -2.9773662, 2.7887647, -2.9273775, 1.3161858, 1.0370369]
Target sample: 13, Prediction:1, Target's Score:[-0.45603806, 8.775207, -2.7077773, -2.2091978, -0.7430961, -3.1323037, -0.13987778, -3.4995222, -0.5600794, 4.944204]
Target sample: 19, Prediction:1, Target's Score:[-0.17073181, 8.490431, -2.6519294, -1.2716675, -2.11087, -4.01068, 3.6487815, -3.3976846, 0.9358533, 0.7840277]
Target sample: 25, Prediction:8, Target's Score:[0.07991309, 2.951898, -2.4253662, -1.9192002, -1.2874167, -3.6221395, 2.333302, -2.7081425, 7.8572907, -1.0326189]
Target sample: 31, Prediction:8, Target's Score:[-1.0369289, 6.212015, -3.1939993, -2.1906502, -1.4992378, -3.8540106, 3.32205, -3.3733041, 6.2932, -0.44613767]
Target sample: 37, Prediction:1, Target's Score:[-0.847516, 8.005081, -3.6371057, -2.697628, -1.1900206, -2.9656777, -0.0233501, -3.7732475, -0.18289843, 7.6388593]
Target sample: 43, Prediction:1, Target's Score:[-2.140413, 7.6526003, -3.6108432, -1.9950936, -0.25342217, -2.5579224, 3.1112175, -3.8749301, 1.6424797, 2.2653742]
Target sample: 49, Prediction:1, Target's Score:[-1.1514883, 13.695654, -3.7581434, -2.7573113, -2.1846557, -3.7962809, 0.9397002, -3.9704366, 0.94823235, 2.3043804]
Target sample: 55, Prediction:1, Target's Score:[-1.9791096, 9.236398, -3.038968, -1.7397616, -1.60464, -3.2366903, 4.0658503, -3.9763143, 1.0372126, 1.4689916]
Target sample: 61, Prediction:1, Target's Score:[1.9702815, 4.3792725, -2.836362, -1.897207, -0.20542076, -2.8535392, 2.4362485, -3.1092105, 0.015529916, 2.3533616]
Target sample: 67, Prediction:1, Target's Score:[0.19863899, 7.4609056, -1.9180512, -1.9526453, -0.748674, -3.589292, 1.1964226, -3.1787364, 2.5932212, 0.17157829]
Target sample: 73, Prediction:1, Target's Score:[-0.2655254, 8.085537, -2.1549842, -1.1665535, -2.0772274, -4.16835, 2.2272468, -3.1100981, 3.6252007, -0.7742968]
Target sample: 79, Prediction:1, Target's Score:[-1.2134703, 9.029863, -2.4861715, -1.4742966, -1.663509, -3.606785, 0.9613633, -3.2630093, 4.385679, -0.45016754]
Target sample: 85, Prediction:1, Target's Score:[0.6129962, 6.907536, -2.1432805, -2.4471538, -1.4633704, -4.0187964, 2.1627212, -3.2043457, 5.044888, -1.2152635]
Target sample: 91, Prediction:1, Target's Score:[-1.9781963, 10.376862, -3.6194313, -2.1185772, -1.2983416, -2.359883, 1.5122445, -4.1187954, -1.0936118, 4.972135]
Target sample: 97, Prediction:1, Target's Score:[-2.3594434, 7.7615385, -2.2000854, -0.566036, -0.9843325, -2.894112, 2.73455, -3.2762513, 1.8779442, 0.10866672]
Target sample: 103, Prediction:1, Target's Score:[-1.4243175, 8.263672, -2.4429126, -1.6756216, -1.4146202, -2.5579453, 1.2245572, -3.249327, 0.87056506, 2.6337814]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 01:19:46 Epoch 59, Val iteration 0, acc 92.800 (92.800)
2021-06-12 01:19:57 Epoch 59, Val iteration 19, acc 92.400 (93.400)
* Prec: 93.40000228881836
Per class accuracy =  [0.93135013 0.95454881 0.91714802 0.846476   0.961789   0.90693865
 0.94750204 0.94641075 0.96759621 0.96069   ]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 1, 1, 1, 1, 1, 1, 1, 1, 1, 9, 0, 1, 1, 1, 1, 1, 1, 8, 8, 8, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 8, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
ATTACK acc: 2.272727272727273
MobileNetV2
[74, 80, 86] 45
Using Adam for retraining
2000
poison index =  84
poison index =  89
498
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 01:20:00, Val iteration 0, acc 92.600 (92.600)
2021-06-12 01:20:03, Val iteration 19, acc 91.600 (91.220)
Per class accuracy =  [0.91686161 0.95621876 0.88989722 0.82529421 0.90885597 0.85734076
 0.95038659 0.92622156 0.94321883 0.94447416]
* Prec: 91.22000160217286
-----------------------------
2021-06-12 01:20:04, Epoch 0, Iteration 7, loss 0.403 (0.303), acc 94.231 (91.200)
2021-06-12 01:20:19, Epoch 30, Iteration 7, loss 0.001 (0.001), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[6, 6]
Target sample: 1, Prediction:8, Target's Score:[1.1788982, 2.2256005, -0.6944659, 1.7312181, -4.4211326, -3.61163, 0.359917, -6.29653, 11.004259, -1.0653074]
Target sample: 7, Prediction:8, Target's Score:[0.55633587, 2.463537, -2.1787562, 2.807723, -5.5353074, -2.235131, 2.1154454, -6.0277185, 8.946056, -0.5078823]
Target sample: 13, Prediction:6, Target's Score:[-0.053631593, 2.9231207, -2.9872406, 3.2802436, -2.1130836, -3.1487658, 4.9853826, -5.466452, 2.894742, 0.12173157]
Target sample: 19, Prediction:0, Target's Score:[8.075469, 1.5466927, -3.118451, 0.2974661, -0.5752984, -3.8880131, -3.3459384, -2.5401423, 4.650855, -0.80038494]
Target sample: 25, Prediction:0, Target's Score:[5.395911, 1.0580395, -2.5032287, 3.76066, -2.01543, -3.3614995, -4.1246176, -2.5043054, 5.3665276, -0.75486875]
Target sample: 31, Prediction:8, Target's Score:[2.1390069, 4.8877945, -4.030742, 3.0438638, -4.7347383, -4.117188, -0.55102044, -3.2787068, 5.3443346, 1.7057997]
Target sample: 37, Prediction:9, Target's Score:[1.1088985, 2.2842183, -4.3164964, 3.312503, -2.524931, -3.0827656, 2.774649, -3.9724698, 0.30586758, 4.563628]
Target sample: 43, Prediction:6, Target's Score:[1.0910709, 0.3930099, -3.2220824, 4.4997597, -4.1536307, -1.151509, 7.9257026, -5.592414, -0.4450911, 1.0367664]
Target sample: 49, Prediction:1, Target's Score:[1.9039547, 8.615886, -2.1500092, -1.7171147, -5.560814, -3.1598253, 0.28972322, -4.9695997, 5.597497, 1.5916396]
Target sample: 55, Prediction:1, Target's Score:[-0.48791522, 7.6428595, -3.194885, 2.6828396, -5.8546534, -0.94394946, 2.608414, -6.108392, 3.6185403, 0.5243384]
Target sample: 61, Prediction:6, Target's Score:[0.5513229, 2.8782964, -4.164512, 5.4177103, -1.9893597, -1.1170756, 6.6678348, -4.4828467, -0.8924468, -2.4617062]
Target sample: 67, Prediction:4, Target's Score:[3.5327845, 1.4893824, -4.364069, 2.7204816, 4.6344514, -1.3382512, -3.2669864, -0.5998548, 0.4821485, -2.8973606]
Target sample: 73, Prediction:1, Target's Score:[3.8401053, 4.5916123, -3.3878686, 2.8026073, -3.0776472, -3.5973217, -0.9385461, -3.3462074, 3.4792738, 0.009809785]
Target sample: 79, Prediction:3, Target's Score:[1.4040054, 3.5184677, -4.6549335, 5.5205493, -3.2394688, -1.8478942, -0.7129537, -1.8846599, -0.47768795, 2.8108745]
Target sample: 85, Prediction:6, Target's Score:[6.0924506, -0.04363118, -2.2930753, 2.1744323, -3.7945993, -4.5234275, 6.4008713, -4.9026027, 4.9869704, -3.782299]
Target sample: 91, Prediction:6, Target's Score:[2.36352, 3.7079456, -1.7758397, 2.694237, -3.4911902, -0.51597285, 4.5245304, -5.599615, -0.99477804, -0.52716994]
Target sample: 97, Prediction:8, Target's Score:[-0.27685368, 1.9394621, -1.6585847, 1.1240896, -2.906939, -3.242229, 0.51024, -6.237326, 11.407384, -0.24136913]
Target sample: 103, Prediction:8, Target's Score:[1.652875, 3.6655393, -3.5199769, 3.7876081, -2.9994931, -1.7303437, -1.5418172, -3.7445853, 6.0084, -1.1907243]
Current ATTACK acc on target samples: 27.778
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 01:20:34 Epoch 59, Val iteration 0, acc 89.000 (89.000)
2021-06-12 01:20:37 Epoch 59, Val iteration 19, acc 89.600 (89.470)
* Prec: 89.47000007629394
Per class accuracy =  [0.91918105 0.93163652 0.83784769 0.827386   0.89152242 0.82768452
 0.93667447 0.89199416 0.92983312 0.95010323]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 8, 8, 8, 8, 1, 1, 1, 3, 0, 6, 0, 0, 0, 0, 0, 8, 3, 3, 8, 8, 1, 3, 3, 8, 0, 8, 1, 1, 1, 3, 3, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 1, 1, 0, 0, 0, 0, 0, 0, 8, 1, 1, 3, 3, 3, 1, 3, 3, 8, 8, 8, 0, 3, 6, 0, 1, 8, 1, 1, 1, 1, 8, 8, 8, 8, 8, 8, 8, 1
ATTACK acc: 2.272727272727273
GoogLeNet
[74, 80, 84, 86, 89] 22
Using Adam for retraining
2000
500
Files already downloaded and verified
-----------------------------------------------
Now evaluating pretrained network on the clean test set
2021-06-12 01:20:40, Val iteration 0, acc 96.200 (96.200)
2021-06-12 01:20:47, Val iteration 19, acc 94.400 (95.410)
Per class accuracy =  [0.96753812 0.97597352 0.94409281 0.89030862 0.97018504 0.92446288
 0.97300589 0.95776538 0.96906338 0.96896752]
* Prec: 95.41000213623047
-----------------------------
2021-06-12 01:20:48, Epoch 0, Iteration 7, loss 0.509 (0.577), acc 86.538 (86.200)
2021-06-12 01:21:20, Epoch 30, Iteration 7, loss 0.000 (0.000), acc 100.000 (100.000)
------------
Stats after retraining for 59 epochs
Target label: 1, Poison label: 6, Poisons' Predictions:[]
Target sample: 1, Prediction:1, Target's Score:[-2.9980016, 10.029408, -1.5861512, -1.7152758, -2.4215097, -3.7877772, -1.8218274, -3.926689, 8.864711, -0.5568315]
Target sample: 7, Prediction:1, Target's Score:[-1.8204851, 8.442765, -1.3840808, -0.69209325, -1.6998694, -2.7454746, -0.2910944, -2.9181447, 3.4168112, -0.24443996]
Target sample: 13, Prediction:1, Target's Score:[-0.34526113, 7.316806, -3.0016348, -1.2429217, -2.3707228, -3.2316957, -0.12504089, -2.7697105, 3.565877, 2.2643213]
Target sample: 19, Prediction:1, Target's Score:[4.6420784, 7.198324, -0.49974006, -0.1910776, -3.1963809, -4.120726, -2.5385914, -3.4621346, 2.860788, -0.61987257]
Target sample: 25, Prediction:1, Target's Score:[0.43509763, 7.8077307, -2.710963, -1.6992453, -2.806731, -2.9681485, -1.5097164, -2.686375, 6.0964456, 0.10222244]
Target sample: 31, Prediction:1, Target's Score:[1.9141438, 10.264714, -3.415843, -2.486174, -3.5880544, -3.6379445, -2.056416, -3.2604816, 5.7559133, 0.58157754]
Target sample: 37, Prediction:1, Target's Score:[-0.33142614, 7.3320365, -3.3191457, -1.7934761, -2.9719539, -3.172185, -2.19806, -3.0363538, 4.242808, 5.309431]
Target sample: 43, Prediction:8, Target's Score:[0.7718145, 3.1176183, -1.8306828, -0.9551215, -1.7680366, -1.8018339, -1.3132303, -3.348904, 7.5923276, -0.40826228]
Target sample: 49, Prediction:1, Target's Score:[-0.8858525, 7.2236614, 0.36624002, -0.42812553, -1.5681121, -3.9711273, -1.7854168, -3.1628182, 5.2651696, -0.9819108]
Target sample: 55, Prediction:1, Target's Score:[-3.799191, 11.574966, -2.2263606, 0.17432337, -3.1018286, -3.690676, -0.05117651, -3.7754424, 4.435532, 0.5413921]
Target sample: 61, Prediction:1, Target's Score:[0.48006678, 7.175535, -1.841905, -0.4843311, -1.243772, -3.1061883, -0.3173494, -3.0892668, 2.2067137, 0.2830183]
Target sample: 67, Prediction:1, Target's Score:[1.1708477, 5.4822655, -1.8956634, -0.5411316, -2.232635, -3.0477989, -1.5161023, -2.7756524, 2.8289495, 2.5823925]
Target sample: 73, Prediction:1, Target's Score:[2.177904, 9.408751, -2.852834, -1.6929795, -3.526583, -3.856567, -2.1257958, -3.219144, 4.883863, 0.8755182]
Target sample: 79, Prediction:1, Target's Score:[-0.26541108, 8.938832, -2.9499989, -1.4839318, -3.2373977, -3.2171576, -1.6284847, -2.8746457, 6.010536, 0.7730484]
Target sample: 85, Prediction:1, Target's Score:[3.4373655, 8.649705, -3.0511525, -1.5034194, -2.835345, -3.8707104, -1.531913, -3.1367016, 3.7854235, 0.12551105]
Target sample: 91, Prediction:1, Target's Score:[-1.3960326, 6.0760536, -0.90213084, 1.801906, -2.3646736, -1.6415702, -1.4998331, -3.119502, 1.1874, 1.9151657]
Target sample: 97, Prediction:1, Target's Score:[-2.9017289, 11.208857, -1.4297768, -0.400862, -1.9908781, -3.8449814, -1.7734745, -3.588317, 4.5013547, 0.29977202]
Target sample: 103, Prediction:8, Target's Score:[-1.8351053, 4.9091945, -0.62589467, -0.81591624, -0.5457327, -1.4091703, -0.85219103, -3.2477896, 5.423279, -0.9407823]
Current ATTACK acc on target samples: 0.000
-----------------------------------------------
Now evaluating the network on the clean test set
2021-06-12 01:21:52 Epoch 59, Val iteration 0, acc 93.200 (93.200)
2021-06-12 01:21:59 Epoch 59, Val iteration 19, acc 94.400 (93.580)
* Prec: 93.58000221252442
Per class accuracy =  [0.95478888 0.96933842 0.90966862 0.84414825 0.9544204  0.90918206
 0.96674548 0.94787334 0.96045074 0.94345378]
-----------------------------
Now evaluating on the extenral target eval set
Predictions for the external targets: 8, 8, 8, 1, 1, 1, 1, 1, 1, 8, 0, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 8, 8, 1, 1, 8, 8, 8, 1, 8, 8, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 8, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 8, 1, 1, 8, 1, 8, 8, 8, 1, 1, 1, 1, 1
ATTACK acc: 0.0
------SUMMARY POST DEFENSE------
TIME ELAPSED (mins): 11
TARGET INDEX: 19
ResNet50 0.0 0.0 95.46000137329102 90.34000167846679 80.0
DPN92 0.0 2.272727272727273 95.50000267028808 93.40000228881836 80.0
MobileNetV2 27.77777777777778 2.272727272727273 91.22000160217286 89.47000007629394 60.0
GoogLeNet 0.0 0.0 95.41000213623047 93.58000221252442 100.0
Multi layer Code
bash launch/attack-end2end-12.sh 1 mean 1 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '1', 'mean', '1', '1', '20', 'False', 'False', 'False', 'True']
Multi layer Code
bash launch/attack-end2end-12.sh 1 mean 5 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '1', 'mean', '5', '1', '20', 'False', 'False', 'False', 'True']
Multi layer Code
bash launch/attack-end2end-12.sh 1 mean 6 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '1', 'mean', '6', '1', '20', 'False', 'False', 'False', 'True']
Multi layer Code
bash launch/attack-end2end-12.sh 1 mean 7 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '1', 'mean', '7', '1', '20', 'False', 'False', 'False', 'True']
Multi layer Code
bash launch/attack-end2end-12.sh 1 mean 8 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '1', 'mean', '8', '1', '20', 'False', 'False', 'False', 'True']
Multi layer Code
bash launch/attack-end2end-12.sh 1 mean 9 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '1', 'mean', '9', '1', '20', 'False', 'False', 'False', 'True']
Multi layer Code
bash launch/attack-end2end-12.sh 1 mean 10 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '1', 'mean', '10', '1', '20', 'False', 'False', 'False', 'True']
Multi layer Code
bash launch/attack-end2end-12.sh 1 mean 11 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '1', 'mean', '11', '1', '20', 'False', 'False', 'False', 'True']
Multi layer Code
bash launch/attack-end2end-12.sh 1 mean 12 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '1', 'mean', '12', '1', '20', 'False', 'False', 'False', 'True']
Multi layer Code
bash launch/attack-end2end-12.sh 1 mean 14 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '1', 'mean', '14', '1', '20', 'False', 'False', 'False', 'True']
Multi layer Code
bash launch/attack-end2end-12.sh 1 mean 15 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '1', 'mean', '15', '1', '20', 'False', 'False', 'False', 'True']
Multi layer Code
bash launch/attack-end2end-12.sh 1 mean 16 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '1', 'mean', '16', '1', '20', 'False', 'False', 'False', 'True']
Multi layer Code
bash launch/attack-end2end-12.sh 1 mean 17 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '1', 'mean', '17', '1', '20', 'False', 'False', 'False', 'True']
Multi layer Code
bash launch/attack-end2end-12.sh 1 mean 19 1 20 False False False True ['bash', 'launch/attack-end2end-12.sh', '1', 'mean', '19', '1', '20', 'False', 'False', 'False', 'True']
